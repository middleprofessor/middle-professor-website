which_rows <- c(control_cases,treated_cases)
which_traits <- c(2,3,4,5,6)
r <- cor(std_data[which_rows,],use='pairwise.complete.obs')
cor_eda_traits <- r[which_traits,1]
# compute vector of standardized selection differentials
which_traits <- c(2,3,4,5,6)
dxy <- apply(std_data,2,selection_differential,y=mydata[,treatment])[which_traits]
n <- length(control_cases)
xtx <- t(std_data[control_cases,which_traits])%*%std_data[control_cases,which_traits]/(n-1) #not = to cor_eda_traits because that threw out incomplete rows
xtxi <- solve(xtx)
bxy <- xtxi%*%dxy
bxy.mr <- do.call(rbind,apply(complex.size_free.std,2,mendelian_randomization,y=mydata[,treatment], z=eda.scores.std))
bxy.tsls <- apply(complex.size_free.std,2,TSLS,y=mydata[,treatment],z=eda.scores.std)
table1 <- data.frame(cor_eda=cor_eda_traits,dxy=dxy,bxy=bxy,bxy.mr=bxy.mr[,'mr'])
table1
#bootstrap table 1
# compute composite armor score as the weighted sum of the complex
weights.1 <- c(1,1,1,1,1) # all traits
# not that plates and dorsal spines are correlated with each other and with eda but pelvic
# complex much less so, this suggests a weighting is...
weights.2 <- c(1,1,0,0,1) # dorsal spines & lateral plates but not pelvic complex
# weight as PC1
inc <- c(1,2,5)
pc <- eigen(cor(complex.size_free.std[,inc]))$vectors[1:3,1]
weights.3 <- weights.2
weights.3[1:2] <- pc[1:2]
weights.3[5] <- pc[3]
armor_score.2 <- complex.size_free.std%*%weights.2
armor_score.2 <- armor_score.2/sd(armor_score.2[control_cases])
cor_eda_composite.2 <- cor(eda.scores.std[control_cases],armor_score.2[control_cases],use='complete.obs')
Fstat <- summary(lm(armor_score.2[control_cases]~eda.scores.std[control_cases]))$fstatistic
beta.xy.mr.2 <- mendelian_randomization(armor_score.2,mydata[,treatment],eda.scores.std,TRUE,niter=4999)
beta.xy.mr.2.quants <- sapply(beta.xy.mr.2,quantile,c(0.025,0.975))
cor_composite_traits <- cor(data.frame(armor=armor_score.2, complex.size_free.std)[control_cases,],use='complete.obs')
armor_score.3 <- complex.size_free.std%*%weights.3
armor_score.3 <- armor_score.3/sd(armor_score.3[control_cases])
cor_eda_composite.3 <- cor(eda.scores.std[control_cases],armor_score.3[control_cases],use='complete.obs')
Fstat <- summary(lm(armor_score.3[control_cases]~eda.scores.std[control_cases]))$fstatistic
beta.xy.mr.3 <- mendelian_randomization(armor_score.3,mydata[,treatment],eda.scores.std,TRUE,niter=4999)
beta.xy.mr.3.quants <- sapply(beta.xy.mr.3,quantile,c(0.025,0.975))
cor_composite_traits <- cor(data.frame(armor=armor_score.3, complex.size_free.std)[control_cases,],use='complete.obs')
#individual parts of MR
beta.xy <- mean(armor_score.2[treated_cases],na.rm=TRUE) - mean(armor_score.2[control_cases],na.rm=TRUE)
beta.zy <- mean(eda.scores.std[treated_cases],na.rm=TRUE) - mean(eda.scores.std[control_cases],na.rm=TRUE)
beta.zx <- summary(lm(armor_score.2[control_cases]~eda.scores.std[control_cases]))$coefficients[2]
cor.zy <- cor(armor_score.2[control_cases],eda.scores.std[control_cases],use='complete.obs')
mr <- beta.zy/beta.zx
armor_score.2 <- complex.size_free.std%*%weights.2
armor_score.2 <- armor_score.2/sd(armor_score.2[control_cases])
cor_eda_composite.2 <- cor(eda.scores.std[control_cases], armor_score.2[control_cases],use='complete.obs')
beta.xy.mr.2 <- mendelian_randomization(armor_score.2,mydata[,treatment],eda.scores.std,FALSE)
armor_score.3 <- complex.size_free.std%*%weights.3
armor_score.3 <- armor_score.3/sd(armor_score.3[control_cases])
cor_eda_composite.3 <- cor(eda.scores.std[control_cases],armor_score.3[control_cases],use='complete.obs')
beta.xy.mr.3 <- mendelian_randomization(armor_score.3,mydata[,treatment],eda.scores.std,FALSE)
beta.xy.mr.3
blogdown:::serve_site()
?annotate
library(ggplot2)
library(data.table)
?annotate
fd <- data.table(x<-seq(1:3), y=seq(0:5))
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet")
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Dietary animal fat") +
annotate(geom="text", x=1, y=2, label="Lunch Break") +
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet") +
annotate(geom="text", x=1, y=2, label="Siesta") +
annotate(geom="text", x=3, y=3, label="CVD")
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet") +
annotate(geom="text", x=1, y=2, label="Siesta") +
annotate(geom="text", x=3, y=3, label="CVD") +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet") +
annotate(geom="text", x=1, y=2, label="Siesta") +
annotate(geom="text", x=3, y=3, label="CVD") +
geom_segmentaes(aes(x = 1, y = 4, xend = 3, yend = 3, colour = "red"), arrow = arrow(length = unit(0.1,"cm"))) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet") +
annotate(geom="text", x=1, y=2, label="Siesta") +
annotate(geom="text", x=3, y=3, label="CVD") +
geom_segment(aes(x = 1, y = 4, xend = 3, yend = 3, colour = "red"), arrow = arrow(length = unit(0.1,"cm"))) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet") +
annotate(geom="text", x=1, y=2, label="Siesta") +
annotate(geom="text", x=3, y=3, label="CVD") +
geom_segment(aes(x = 1+.25, y = 4, xend = 3, yend = 3-.25, colour = "red"), arrow = arrow(length = unit(0.1,"cm"))) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet") +
annotate(geom="text", x=1, y=2, label="Siesta") +
annotate(geom="text", x=3, y=3, label="CVD") +
geom_segment(aes(x = 1+.15, y = 4, xend = 3-.25, yend = 3, colour = "red"), arrow = arrow(length = unit(0.1,"cm"))) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet") +
annotate(geom="text", x=1, y=2, label="Siesta") +
annotate(geom="text", x=3, y=3, label="CVD") +
geom_segment(aes(x = 1+.05, y = 4, xend = 3-.05, yend = 3, colour = "red"), arrow = arrow(length = unit(0.1,"cm"))) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet") +
annotate(geom="text", x=1, y=2, label="Siesta") +
annotate(geom="text", x=3, y=3, label="CVD") +
geom_segment(aes(x = 1+.05, y = 4, xend = 3-.05, yend = 3, colour = "red"), arrow = arrow(length = unit(0.5,"cm"))) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=3, label="Diet") +
annotate(geom="text", x=1, y=1, label="Siesta") +
annotate(geom="text", x=2, y=2, label="CVD") +
geom_segment(aes(x = 1+.05, y = 3, xend = 3-.05, yend = 3, colour = "red"), arrow = arrow(length = unit(0.5,"cm"))) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet") +
annotate(geom="text", x=1, y=2, label="Siesta") +
annotate(geom="text", x=3, y=3, label="CVD") +
geom_segment(aes(x = 1+.05, y = 4, xend = 3-.05, yend = 3, colour = "red"), arrow = arrow(length = unit(0.1,"cm"))) +
theme_minimal() +
theme(base_size=18)
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet") +
annotate(geom="text", x=1, y=2, label="Siesta") +
annotate(geom="text", x=3, y=3, label="CVD") +
geom_segment(aes(x = 1+.05, y = 4, xend = 3-.05, yend = 3, colour = "red"), arrow = arrow(length = unit(0.1,"cm")), size=2) +
theme_minimal() +
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet") +
annotate(geom="text", x=1, y=2, label="Siesta") +
annotate(geom="text", x=3, y=3, label="CVD") +
geom_segment(aes(x = 1+.05, y = 4, xend = 3-.05, yend = 3, colour = "red"), arrow = arrow(length = unit(0.1,"cm")), size=2) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet", size=2) +
annotate(geom="text", x=1, y=2, label="Siesta", size=2) +
annotate(geom="text", x=3, y=3, label="CVD", size=2) +
geom_segment(aes(x = 1+.05, y = 4, xend = 3-.05, yend = 3, colour = "red"), arrow = arrow(length = unit(0.1,"cm"))) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet", size=2) +
annotate(geom="text", x=1, y=2, label="Siesta", size=2) +
annotate(geom="text", x=3, y=3, label="CVD", size=11) +
geom_segment(aes(x = 1+.05, y = 4, xend = 3-.05, yend = 3, colour = "red"), arrow = arrow(length = unit(0.1,"cm"))) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=1, y=4, label="Diet", size=18) +
annotate(geom="text", x=1, y=2, label="Siesta", size=18) +
annotate(geom="text", x=3, y=3, label="CVD", size=18) +
geom_segment(aes(x = 1+.05, y = 4, xend = 3-.05, yend = 3, colour = "red"), arrow = arrow(length = unit(0.1,"cm"))) +
theme_minimal()
gg
x1 <- 'Diet'
x1.h <- 1
x1.b <- 4
x2 <- 'Siesta'
x2.h <- 1
x2.v <- 2
y <- 'CVD'
y.h <- 2
y.v <- 3
base <- 18
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+.05, y = x1.v, xend = y.h-.05, yend = y.v, colour = "red"), arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h, y = x1.v, xend = x2.h, yend = x2.v), curvature = 1, arrow = arrow(length = unit(0.4,"cm"))) +
theme_minimal()
gg
x1 <- 'Diet'
x1.h <- 1
x1.v <- 4
x2 <- 'Siesta'
x2.h <- 1
x2.v <- 2
y <- 'CVD'
y.h <- 2
y.v <- 3
base <- 18
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+.05, y = x1.v, xend = y.h-.05, yend = y.v, colour = "red"), arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h, y = x1.v, xend = x2.h, yend = x2.v), curvature = 1, arrow = arrow(length = unit(0.4,"cm"))) +
theme_minimal()
gg
x1 <- 'Diet'
x1.h <- 1
x1.v <- 4
x2 <- 'Siesta'
x2.h <- 1
x2.v <- 2
y <- 'CVD'
y.h <- 2
y.v <- 3
base <- 18
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+.05, y = x1.v, xend = y.h-.05, yend = y.v, colour = "red"), arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h, y = x1.v, xend = x2.h, yend = x2.v), curvature = 1, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0,3) +
ylim(0,4) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+.05, y = x1.v, xend = y.h-.05, yend = y.v, colour = "red"), arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h, y = x1.v, xend = x2.h, yend = x2.v), curvature = 1, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0,2.75) +
ylim(0.5,4.5) +
theme_minimal()
gg
x1.h <- 1
x1.v <- 3
x2 <- 'Siesta'
x2.h <- 1
x2.v <- 1
y <- 'CVD'
y.h <- 2
y.v <- 2
base <- 18
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+.05, y = x1.v, xend = y.h-.05, yend = y.v, colour = "red"), arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h, y = x1.v, xend = x2.h, yend = x2.v), curvature = 1, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0,2.75) +
ylim(0.5,4.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+.05, y = x1.v, xend = y.h-.05, yend = y.v, colour = "red"), arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h, y = x1.v, xend = x2.h, yend = x2.v), curvature = 1, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0, 2.75) +
ylim(0.5, 3.5) +
theme_minimal()
gg
y.h <- 3
y.v <- 2
base <- 18
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+.05, y = x1.v, xend = y.h-.05, yend = y.v, colour = "red"), arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h, y = x1.v, xend = x2.h, yend = x2.v), curvature = 1, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0, 2.75) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+.05, y = x1.v, xend = y.h-.05, yend = y.v, colour = "red"), arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h, y = x1.v, xend = x2.h, yend = x2.v), curvature = 1, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0, 3.5) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+.05, y = x1.v, xend = y.h-.05, yend = y.v, colour = "red"), arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h, y = x1.v, xend = x2.h, yend = x2.v), curvature = 1, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, 3.5) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+.05, y = x1.v, xend = y.h-.05, yend = y.v, colour = "red"), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h, y = x1.v, xend = x2.h, yend = x2.v), curvature = 1, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, 3.5) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+.05, y = x1.v, xend = y.h-.05, yend = y.v, colour = "red"), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h, y = x1.v, xend = x2.h, yend = x2.v), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, 3.5) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h, y = x1.v - 0.25, xend = y.h, yend = y.v+0.25, colour = "red"), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h, y = x1.v - 0.25, xend = x2.h, yend = x2.v+0.25), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, 3.5) +
ylim(0.5, 3.5) +
theme_minimal()
gg
base <- 14
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h, y = x1.v - 0.25, xend = y.h, yend = y.v+0.25, colour = "red"), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h, y = x1.v - 0.25, xend = x2.h, yend = x2.v+0.25), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, 3.5) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h, y = x1.v - 0.25, xend = y.h-0.5, yend = y.v+0.05, colour = "red"), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.1, y = x1.v - 0.05, xend = x2.h-0.1, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, 3.5) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.05, xend = y.h-0.5, yend = y.v+0.05, colour = "red"), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.1, y = x1.v - 0.05, xend = x2.h-0.1, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, 3.5) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.05, xend = y.h-0.5, yend = y.v+0.05, colour = "red"), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.5, y = x1.v - 0.05, xend = x2.h-0.6, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, 3.5) +
ylim(0.5, 3.5) +
theme_minimal()
gg
x1 <- 'Diet'
x1.h <- 1
x1.v <- 3
x2 <- 'Siesta'
x2.h <- 1
x2.v <- 1
y <- 'CVD'
y.h <- 3.5
y.v <- 2
base <- 14
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.05, xend = y.h-0.5, yend = y.v+0.05), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.5, y = x1.v - 0.05, xend = x2.h-0.6, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, 3.5) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.05, xend = y.h-0.5, yend = y.v+0.05), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.5, y = x1.v - 0.05, xend = x2.h-0.6, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, (y.h + 0.75)) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.05, xend = y.h-0.5, yend = y.v+0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.5, y = x1.v - 0.05, xend = x2.h-0.6, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, (y.h + 0.5)) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.05, xend = y.h-0.5, yend = y.v+0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_segment(aes(x = x2.h+0.5, y = x1.v + 0.05, xend = y.h-0.5, yend = y.v-0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.5, y = x1.v - 0.05, xend = x2.h-0.6, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, (y.h + 0.5)) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.05, xend = y.h-0.5, yend = y.v+0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_segment(aes(x = x2.h+0.5, y = x2.v + 0.05, xend = y.h-0.5, yend = y.v-0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.5, y = x1.v - 0.05, xend = x2.h-0.6, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, (y.h + 0.5)) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.05, xend = y.h-0.5, yend = y.v+0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_segment(aes(x = x2.h+0.5, y = x2.v + 0.05, xend = y.h-0.5, yend = y.v-0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.6, y = x1.v - 0.05, xend = x2.h-0.6, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, (y.h + 0.5)) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.05, xend = y.h-0.5, yend = y.v+0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_segment(aes(x = x2.h+0.6, y = x2.v + 0.05, xend = y.h-0.5, yend = y.v-0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.7, y = x1.v - 0.05, xend = x2.h-0.6, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, (y.h + 0.5)) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.00, xend = y.h-0.5, yend = y.v+0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_segment(aes(x = x2.h+0.6, y = x2.v + 0.00, xend = y.h-0.5, yend = y.v-0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.7, y = x1.v - 0.05, xend = x2.h-0.6, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, (y.h + 0.5)) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.00, xend = y.h-0.5, yend = y.v+0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_segment(aes(x = x2.h+0.6, y = x2.v + 0.00, xend = y.h-0.5, yend = y.v-0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.5, y = x1.v - 0.05, xend = x2.h-0.7, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, (y.h + 0.5)) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.00, xend = y.h-0.5, yend = y.v+0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_segment(aes(x = x2.h+0.7, y = x2.v + 0.00, xend = y.h-0.5, yend = y.v-0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.5, y = x1.v - 0.05, xend = x2.h-0.7, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, (y.h + 0.5)) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.00, xend = y.h-0.5, yend = y.v+0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_segment(aes(x = x2.h+0.7, y = x2.v + 0.00, xend = y.h-0.5, yend = y.v-0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.5, y = x1.v - 0.05, xend = x2.h-0.7, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(xend = x1.h-0.5, yend = x1.v - 0.05, x = x2.h-0.7, y = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, (y.h + 0.5)) +
ylim(0.5, 3.5) +
theme_minimal()
gg
gg <- ggplot(data=fd, aes(x=x, y=y)) +
annotate(geom="text", x=x1.h, y=x1.v, label=x1, size=base) +
annotate(geom="text", x=x2.h, y=x2.v, label=x2, size=base) +
annotate(geom="text", x=y.h, y=y.v, label=y, size=base) +
geom_segment(aes(x = x1.h+0.5, y = x1.v - 0.00, xend = y.h-0.5, yend = y.v+0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_segment(aes(x = x2.h+0.7, y = x2.v + 0.00, xend = y.h-0.5, yend = y.v-0.1), size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(x = x1.h-0.5, y = x1.v - 0.05, xend = x2.h-0.7, yend = x2.v+0.05), curvature = 0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
geom_curve(aes(xend = x1.h-0.5, yend = x1.v - 0.05, x = x2.h-0.7, y = x2.v+0.05), curvature = -0.5, size=2, arrow = arrow(length = unit(0.4,"cm"))) +
xlim(0-0.5, (y.h + 0.5)) +
ylim(0.5, 3.5) +
theme_minimal()
gg
