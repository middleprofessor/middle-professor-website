fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
x1 <- 0.5*z + sqrt(1-0.5^2)*rnorm(n)
x2 <- 0.5*z + sqrt(1-0.5^2)*rnorm(n)
epsilon <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*0.5^2)*rnorm(n)
y <- 0.4*x1 -0.8*x2 + epsilon
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y <- 0.4*x1 -0.8*x2 + epsilon
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y <- 0.4*x1 -0.8*x2 + epsilon
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y <- 0.4*x1 -0.8*x2 + epsilon
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y <- 0.4*x1 -0.8*x2 + epsilon
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y <- 0.4*x1 -0.8*x2 + epsilon
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y <- 0.4*x1 -0.8*x2 + epsilon
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y <- 0.4*x1 -0.8*x2 + epsilon
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y <- 0.4*x1 -0.8*x2 + epsilon
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y <- 0.4*x1 -0.8*x2 + epsilon
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y <- 0.4*x1 -0.8*x2 + epsilon
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y <- 0.4*x1 -0.8*x2 + epsilon
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y <- 0.4*x1 -0.8*x2 + epsilon
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
cor(x1,e)
cor(x1, epsilon)
n <- 10^4
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon1 <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y1 <- 0.4*x1 - 0.8*x2 + epsilon1
epsilon2 <- -0.8*x2 + epsilon1
y2 <- 0.4*x1 + epsilon2
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y~x1))
e <- residuals(fit)
head(data.frame(y1=y1, y2=y2))
cor(x1,e)
cor(x1, epsilon)
cor(x1, epsilon2)
predict(fit)
fit$fitted_values
fit$fitted.values
names(fit)
names(summary(fit))
summary(fit)
fit
summary(fit)
fitted.values(fit)
?fitted.values
fitted(fit)
y
n <- 10^2
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon1 <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y1 <- 0.4*x1 - 0.8*x2 + epsilon1
epsilon2 <- -0.8*x2 + epsilon1
y2 <- 0.4*x1 + epsilon2
coefficients(summary(lm(y~x1+x2)))
fit <- summary(lm(y2~x1))
e <- residuals(fit)
head(data.frame(y1=y1, y2=y2))
cor(x1,e)
cor(x1, epsilon)
cor(x1, epsilon2)
s2 <- var(y2)
ssm <- predict(fit, new)
fit <- lm(y2~x1)
e <- residuals(fit)
head(data.frame(y1=y1, y2=y2))
cor(x1,e)
cor(x1, epsilon)
cor(x1, epsilon2)
fit <- lm(y2~x1)
e <- residuals(fit)
head(data.frame(y1=y1, y2=y2))
cor(x1,e)
cor(x1, epsilon1)
cor(x1, epsilon2)
fit <- lm(y2~x1)
e <- residuals(fit)
head(data.frame(y1=y1, y2=y2))
cor(x1,e)
cor(x1, epsilon1)
cor(x1, epsilon2)
s2 <- var(y2)
ssm <- fitted(fit)
s2 <- var(y2)
sst <- s2*(n-1)
ssm <- sum((fitted(fit) - mean(y))^2)
sse <- sum((y - fitted(fit))^2)
sst
ssm + sse
n <- 10^2
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon1 <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y1 <- 0.4*x1 - 0.8*x2 + epsilon1
epsilon2 <- -0.8*x2 + epsilon1
y2 <- 0.4*x1 + epsilon2
coefficients(summary(lm(y~x1+x2)))
fit <- lm(y2~x1)
e <- residuals(fit)
head(data.frame(y1=y1, y2=y2))
cor(x1,e)
cor(x1, epsilon1)
cor(x1, epsilon2)
s2 <- var(y)
sst <- s2*(n-1)
ssm <- sum((fitted(fit) - mean(y2))^2)
sse <- sum((y2 - fitted(fit))^2)
sst2 <- (y2 - mean(y2))
sst
ssm + sse
n <- 10^2
z <- rnorm(n)
rho <- 0.7
alpha <- sqrt(rho)
x1 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
x2 <- alpha*z + sqrt(1-alpha^2)*rnorm(n)
epsilon1 <- sqrt(1-0.4^2-0.8^2-2*(0.4)*(-0.8)*rho)*rnorm(n)
y1 <- 0.4*x1 - 0.8*x2 + epsilon1
epsilon2 <- -0.8*x2 + epsilon1
y2 <- 0.4*x1 + epsilon2
coefficients(summary(lm(y~x1+x2)))
fit <- lm(y2~x1)
e <- residuals(fit)
head(data.frame(y1=y1, y2=y2))
cor(x1,e)
cor(x1, epsilon1)
cor(x1, epsilon2)
s2 <- var(y2)
sst <- s2*(n-1)
ssm <- sum((fitted(fit) - mean(y2))^2)
sse <- sum((y2 - fitted(fit))^2)
sst2 <- sum((y2 - mean(y2))^2)
sst
sst2
ssm + sse
blogdown:::new_post_addin()
blogdown:::serve_site()
n <- 100
logx <- rnorm(n)
n <- 100
logx <- rnorm(n)
x <- exp(logx)
n <- 100
logx <- rnorm(n)
x <- exp(logx)
qplot(x)
library(ggplot2)
library(data.table)
n <- 100
logx <- rnorm(n)
x <- exp(logx)
qplot(x)
library(ggplot2)
library(data.table)
n <- 100
logx <- rnorm(n, sd=0.5)
x <- 7 + exp(logx)
qplot(x)
n <- 100
logweight <- rnorm(n, sd=0.5)
weight <- 7 + exp(logweight)
qplot(weight)
logsmr <- 0.895*logx
smr <- exp(logsmr)
qplot(x=smr, y=weight)
qplot(x=weight, y=smr)
n <- 100
logweight <- rnorm(n, sd=0.5)
weight <- 7 + exp(logweight)
qplot(weight)
logsmr <- 0.895*logweight
smr <- exp(logsmr)
qplot(x=weight, y=smr)
n <- 100
logweight <- rnorm(n, sd=0.5)
weight <- 7 + exp(logweight)
qplot(weight)
b <- 0.895
logsmr <- b*logweight
smr <- exp(logsmr)
qplot(x=weight, y=smr)
logamr <- b*logweight + 1
amr <- exp(smr)
qplot(x=weight, y=amr)
n <- 100
logweight <- rnorm(n, sd=0.5)
weight <- 7 + exp(logweight)
qplot(weight)
b <- 0.895
logsmr <- b*logweight - 2
smr <- exp(logsmr)
qplot(x=weight, y=smr)
logamr <- b*logweight - 1
amr <- exp(smr)
qplot(x=weight, y=amr)
cos <- amr-smr
qplot(x=weight, y=cos)
cos <- amr/smr
qplot(x=weight, y=cos)
380/180
406/106
exp(.1)
# model fig 2
freq <- c(0, .1, .2, 0.3)
amp <- c(1, 1.5, 2)
b1 <- 0.5
b2 <- 0.5
b12 <- 0.5
x <- expand.grid(freq, amp)
x
x <- expand.grid(freq=freq, amp=amp)
x
?expand.grid
combo <- expand.grid(freq=freq, amp=amp)
x <- rep(combo, each=5)
x
x <- expand.grid(freq=rep(freq, each=5), amp=rep(amp,each=5))
x
x <- expand.grid(freq=rep(freq, each=5), amp=rep(amp))
x
x <- cbind(int=1, x)
x
b0 <- 0
b1 <- 0.5
b2 <- 0.5
b12 <- 0.5
freqamp <- x$freq * x$amp
x <- cbind(int=1, x, freqamp=freqamp)
x
freq <- c(0, .1, .2, 0.3)
amp <- c(1, 1.5, 2)
b0 <- 0
b1 <- 0.5
b2 <- 0.5
b12 <- 0.5
b <- c(b0, b1, b2, b12)
x <- expand.grid(freq=rep(freq, each=5), amp=rep(amp))
n <- nrow(x)
freqamp <- x$freq * x$amp
x <- cbind(int=1, x, freqamp=freqamp)
y <- x%*%b + rnorm(n)
is.matrix(x)
freq <- c(0, .1, .2, 0.3)
amp <- c(1, 1.5, 2)
b0 <- 0
b1 <- 0.5
b2 <- 0.5
b12 <- 0.5
b <- c(b0, b1, b2, b12)
x <- expand.grid(freq=rep(freq, each=5), amp=rep(amp))
n <- nrow(x)
freqamp <- x$freq * x$amp
x <- as.matrix(cbind(int=1, x, freqamp=freqamp))
y <- x%*%b + rnorm(n)
freq <- c(0, .1, .2, 0.3)
amp <- c(1, 1.5, 2)
b0 <- 0
b1 <- 0.5
b2 <- 0.5
b12 <- 0.5
b <- c(b0, b1, b2, b12)
x <- expand.grid(freq=rep(freq, each=5), amp=rep(amp))
n <- nrow(x)
freqamp <- x$freq * x$amp
X <- as.matrix(cbind(int=1, x, freqamp=freqamp))
y <- X%*%b + rnorm(n)
dt < - data.table(x, y)
library(ggplot2)
library(data.table)
# model fig 2
freq <- c(0, .1, .2, 0.3)
amp <- c(1, 1.5, 2)
b0 <- 0
b1 <- 0.5
b2 <- 0.5
b12 <- 0.5
b <- c(b0, b1, b2, b12)
x <- expand.grid(freq=rep(freq, each=5), amp=rep(amp))
n <- nrow(x)
freqamp <- x$freq * x$amp
X <- as.matrix(cbind(int=1, x, freqamp=freqamp))
y <- X%*%b + rnorm(n)
dt < - data.table(x, y)
x
y
y <- as.numeric(X%*%b + rnorm(n))
dt < - data.table(x, y)
y
x
is.matrix(x)
is.data.frame(x)
dt < - data.table(x, y=y)
dt <- data.table(x, y=y)
dt
library(ggplot2)
library(data.table)
# model fig 2
freq <- c(0, .1, .2, 0.3)
amp <- c(1, 1.5, 2)
b0 <- 0
b1 <- 0.5
b2 <- 0.5
b12 <- 0.5
b <- c(b0, b1, b2, b12)
x <- expand.grid(freq=rep(freq, each=5), amp=rep(amp))
n <- nrow(x)
freqamp <- x$freq * x$amp
X <- as.matrix(cbind(int=1, x, freqamp=freqamp))
y <- as.numeric(X%*%b + rnorm(n))
dt <- data.table(x, y=y)
dt[, freqcat:=factor(freq)]
dt[, ampcat:=factor(amp)]
anova(lm(y ~ freq*amp, data=dt))
anova(lm(y ~ freqcat*ampcat, data=dt))
# model fig 2
freq <- c(0, .1, .2, 0.3)
amp <- c(1, 1.5, 2)
b0 <- 0
b1 <- 0.5
b2 <- 0.5
b12 <- 1
b <- c(b0, b1, b2, b12)
x <- expand.grid(freq=rep(freq, each=5), amp=rep(amp))
n <- nrow(x)
freqamp <- x$freq * x$amp
X <- as.matrix(cbind(int=1, x, freqamp=freqamp))
y <- as.numeric(X%*%b + rnorm(n))
dt <- data.table(x, y=y)
dt[, freqcat:=factor(freq)]
dt[, ampcat:=factor(amp)]
anova(lm(y ~ freq*amp, data=dt))
anova(lm(y ~ freqcat*ampcat, data=dt))
# model fig 2
freq <- c(0, .1, .2, 0.3)
amp <- c(1, 1.5, 2)
b0 <- 0
b1 <- 0.5
b2 <- 0.5
b12 <- 1
b <- c(b0, b1, b2, b12)
x <- expand.grid(freq=rep(freq, each=5), amp=rep(amp))
n <- nrow(x)
freqamp <- x$freq * x$amp
X <- as.matrix(cbind(int=1, x, freqamp=freqamp))
y <- as.numeric(X%*%b + rnorm(n))
dt <- data.table(x, y=y)
dt[, freqcat:=factor(freq)]
dt[, ampcat:=factor(amp)]
anova(lm(y ~ freq*amp, data=dt))
anova(lm(y ~ freqcat*ampcat, data=dt))
prob of 1 false pos = .95
# prob of 2 false
1 - .95^2
