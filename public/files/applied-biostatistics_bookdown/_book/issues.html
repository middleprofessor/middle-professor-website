<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Issues in inference | Statistics for the Bench Biologist</title>
  <meta name="description" content="An introduction to statistical modeling for experimental biology researchers" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Issues in inference | Statistics for the Bench Biologist" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Issues in inference | Statistics for the Bench Biologist" />
  
  <meta name="twitter:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="violations.html"/>
<link rel="next" href="part-v-more-than-one-x-multivariable-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistics for the Experimental Biologist</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#linear-models"><i class="fa fa-check"></i>Linear Models</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#arent-t-tests-and-anova-good-enough"><i class="fa fa-check"></i>Aren’t <em>t</em>-tests and ANOVA good enough?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-unusual-about-this-book"><i class="fa fa-check"></i>What is unusual about this book?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-table-of-models.html"><a href="a-table-of-models.html"><i class="fa fa-check"></i>A Table of Models</a>
<ul>
<li class="chapter" data-level="" data-path="a-table-of-models.html"><a href="a-table-of-models.html#including-mapping-between-linear-models-and-classical-tests"><i class="fa fa-check"></i>including mapping between linear models and classical tests</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ask1-intro.html"><a href="ask1-intro.html"><i class="fa fa-check"></i><b>1</b> Analyzing experimental data with a linear model</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ask1-intro.html"><a href="ask1-intro.html#this-text-is-about-using-linear-models-to-estimate-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect"><i class="fa fa-check"></i><b>1.1</b> This text is about using linear models to estimate treatment effects and the uncertainty in our estimates. This, raises the question, what is “an effect”?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-getting-started.html"><a href="part-i-getting-started.html"><i class="fa fa-check"></i>Part I: Getting Started</a></li>
<li class="chapter" data-level="2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html"><i class="fa fa-check"></i><b>2</b> Getting Started – R Projects and R Markdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-vs-r-studio"><i class="fa fa-check"></i><b>2.1</b> R vs R Studio</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#download-and-install-r-and-r-studio"><i class="fa fa-check"></i><b>2.2</b> Download and install R and R studio</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#open-r-studio-and-modify-the-workspace-preference"><i class="fa fa-check"></i><b>2.3</b> Open R Studio and modify the workspace preference</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it"><i class="fa fa-check"></i><b>2.4</b> If you didn’t modify the workspace preferences from the previous section, go back and do it</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-markdown-in-a-nutshell"><i class="fa fa-check"></i><b>2.5</b> R Markdown in a nutshell</a></li>
<li class="chapter" data-level="2.6" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#install-r-markdown"><i class="fa fa-check"></i><b>2.6</b> Install R Markdown</a></li>
<li class="chapter" data-level="2.7" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#importing-packages"><i class="fa fa-check"></i><b>2.7</b> Importing Packages</a></li>
<li class="chapter" data-level="2.8" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#setup-create-project"><i class="fa fa-check"></i><b>2.8</b> Create an R Studio Project for this textbook</a></li>
<li class="chapter" data-level="2.9" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#working-on-a-project-in-a-nutshell"><i class="fa fa-check"></i><b>2.9</b> Working on a project, in a nutshell</a></li>
<li class="chapter" data-level="2.10" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#setup-create-rmd"><i class="fa fa-check"></i><b>2.10</b> Create and setup an R Markdown document (Rmd)</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#modify-the-yaml-header"><i class="fa fa-check"></i><b>2.10.1</b> Modify the yaml header</a></li>
<li class="chapter" data-level="2.10.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#modify-the-setup-chunk"><i class="fa fa-check"></i><b>2.10.2</b> Modify the “setup” chunk</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#lets-play-around-with-an-r-markdown-file"><i class="fa fa-check"></i><b>2.11</b> Let’s play around with an R Markdown file</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-fake-data-chunk"><i class="fa fa-check"></i><b>2.11.1</b> Create a “fake-data” chunk</a></li>
<li class="chapter" data-level="2.11.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-plot-chunk"><i class="fa fa-check"></i><b>2.11.2</b> Create a “plot” chunk</a></li>
<li class="chapter" data-level="2.11.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#knit-the-rmd"><i class="fa fa-check"></i><b>2.11.3</b> Knit the Rmd</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-r-fundamentals.html"><a href="part-ii-r-fundamentals.html"><i class="fa fa-check"></i>Part II: R fundamentals</a></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data – Reading, Wrangling, and Writing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#data-long"><i class="fa fa-check"></i><b>3.1</b> Long data format – the way data should be</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#data-here"><i class="fa fa-check"></i><b>3.2</b> Use the here function to construct the file path</a></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#learning-from-this-chapter"><i class="fa fa-check"></i><b>3.3</b> Learning from this chapter</a></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#data-working-in-r"><i class="fa fa-check"></i><b>3.4</b> Working in R</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data.html"><a href="data.html#importing-data"><i class="fa fa-check"></i><b>3.4.1</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data.html"><a href="data.html#data-wrangling"><i class="fa fa-check"></i><b>3.5</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data.html"><a href="data.html#reshaping-data-wide-to-long"><i class="fa fa-check"></i><b>3.5.1</b> Reshaping data – Wide to long</a></li>
<li class="chapter" data-level="3.5.2" data-path="data.html"><a href="data.html#reshaping-data-transpose-turning-the-columns-into-rows"><i class="fa fa-check"></i><b>3.5.2</b> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li class="chapter" data-level="3.5.3" data-path="data.html"><a href="data.html#combining-data"><i class="fa fa-check"></i><b>3.5.3</b> Combining data</a></li>
<li class="chapter" data-level="3.5.4" data-path="data.html"><a href="data.html#data-subset"><i class="fa fa-check"></i><b>3.5.4</b> Subsetting data</a></li>
<li class="chapter" data-level="3.5.5" data-path="data.html"><a href="data.html#wrangling-columns"><i class="fa fa-check"></i><b>3.5.5</b> Wrangling columns</a></li>
<li class="chapter" data-level="3.5.6" data-path="data.html"><a href="data.html#missing-data"><i class="fa fa-check"></i><b>3.5.6</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data.html"><a href="data.html#saving-data"><i class="fa fa-check"></i><b>3.6</b> Saving data</a></li>
<li class="chapter" data-level="3.7" data-path="data.html"><a href="data.html#exercises"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting-models.html"><a href="plotting-models.html"><i class="fa fa-check"></i><b>4</b> Plotting Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data"><i class="fa fa-check"></i><b>4.1</b> Pretty good plots show the model and the data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot"><i class="fa fa-check"></i><b>4.1.1</b> Pretty good plot component 1: Modeled effects plot</a></li>
<li class="chapter" data-level="4.1.2" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot"><i class="fa fa-check"></i><b>4.1.2</b> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li class="chapter" data-level="4.1.3" data-path="plotting-models.html"><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><i class="fa fa-check"></i><b>4.1.3</b> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
<li class="chapter" data-level="4.1.4" data-path="plotting-models.html"><a href="plotting-models.html#some-comments-on-plot-components"><i class="fa fa-check"></i><b>4.1.4</b> Some comments on plot components</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="plotting-models.html"><a href="plotting-models.html#working-in-r"><i class="fa fa-check"></i><b>4.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="plotting-models.html"><a href="plotting-models.html#source-data"><i class="fa fa-check"></i><b>4.2.1</b> Source data</a></li>
<li class="chapter" data-level="4.2.2" data-path="plotting-models.html"><a href="plotting-models.html#how-to-plot-the-model"><i class="fa fa-check"></i><b>4.2.2</b> How to plot the model</a></li>
<li class="chapter" data-level="4.2.3" data-path="plotting-models.html"><a href="plotting-models.html#be-sure-ggplot_the_model-is-in-your-r-folder"><i class="fa fa-check"></i><b>4.2.3</b> Be sure ggplot_the_model is in your R folder</a></li>
<li class="chapter" data-level="4.2.4" data-path="plotting-models.html"><a href="plotting-models.html#how-to-use-the-plot-the-model-functions"><i class="fa fa-check"></i><b>4.2.4</b> How to use the Plot the Model functions</a></li>
<li class="chapter" data-level="4.2.5" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-a-response-plot-using-ggpubr"><i class="fa fa-check"></i><b>4.2.5</b> How to generate a Response Plot using ggpubr</a></li>
<li class="chapter" data-level="4.2.6" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2"><i class="fa fa-check"></i><b>4.2.6</b> How to generate a Response Plot with a grid of treatments using ggplot2</a></li>
<li class="chapter" data-level="4.2.7" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-an-effects-plot"><i class="fa fa-check"></i><b>4.2.7</b> How to generate an Effects Plot</a></li>
<li class="chapter" data-level="4.2.8" data-path="plotting-models.html"><a href="plotting-models.html#how-to-combine-the-response-and-effects-plots"><i class="fa fa-check"></i><b>4.2.8</b> How to combine the response and effects plots</a></li>
<li class="chapter" data-level="4.2.9" data-path="plotting-models.html"><a href="plotting-models.html#how-to-add-the-interaction-effect-to-response-and-effects-plots"><i class="fa fa-check"></i><b>4.2.9</b> How to add the interaction effect to response and effects plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-some-fundamentals-of-statistical-modeling.html"><a href="part-iii-some-fundamentals-of-statistical-modeling.html"><i class="fa fa-check"></i>Part III: Some Fundamentals of Statistical Modeling</a></li>
<li class="chapter" data-level="5" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>5</b> Variability and Uncertainty (Standard Deviations, Standard Errors, and Confidence Intervals)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="uncertainty.html"><a href="uncertainty.html#standard-errors-are-used-to-compute-p-values-and-confidence-intervals"><i class="fa fa-check"></i><b>5.1</b> Standard errors are used to compute <em>p</em>-values and confidence intervals</a></li>
<li class="chapter" data-level="5.2" data-path="uncertainty.html"><a href="uncertainty.html#background"><i class="fa fa-check"></i><b>5.2</b> Background</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="uncertainty.html"><a href="uncertainty.html#sample-standard-deviation"><i class="fa fa-check"></i><b>5.2.1</b> Sample standard deviation</a></li>
<li class="chapter" data-level="5.2.2" data-path="uncertainty.html"><a href="uncertainty.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.2.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="uncertainty.html"><a href="uncertainty.html#simulations-using-fake-data-as-an-intuition-pump"><i class="fa fa-check"></i><b>5.3</b> Simulations – using fake data as an intuition pump</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="uncertainty.html"><a href="uncertainty.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.3.1</b> Using Google Sheets to generate fake data to explore the standard error</a></li>
<li class="chapter" data-level="5.3.2" data-path="uncertainty.html"><a href="uncertainty.html#using-r-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.3.2</b> Using R to generate fake data to explore the standard error</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="uncertainty.html"><a href="uncertainty.html#bootstrap"><i class="fa fa-check"></i><b>5.4</b> Bootstrapped standard errors</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="uncertainty.html"><a href="uncertainty.html#an-example-of-bootstrapped-standard-errors"><i class="fa fa-check"></i><b>5.4.1</b> An example of bootstrapped standard errors</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="uncertainty.html"><a href="uncertainty.html#confidence-intervals"><i class="fa fa-check"></i><b>5.5</b> Confidence Intervals</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="uncertainty.html"><a href="uncertainty.html#just-the-math"><i class="fa fa-check"></i><b>5.5.1</b> Just the math</a></li>
<li class="chapter" data-level="5.5.2" data-path="uncertainty.html"><a href="uncertainty.html#interpretation-of-a-confidence-interval"><i class="fa fa-check"></i><b>5.5.2</b> Interpretation of a confidence interval</a></li>
<li class="chapter" data-level="5.5.3" data-path="uncertainty.html"><a href="uncertainty.html#bootstrap-confidence-interval"><i class="fa fa-check"></i><b>5.5.3</b> Bootstrap confidence interval</a></li>
<li class="chapter" data-level="5.5.4" data-path="uncertainty.html"><a href="uncertainty.html#a-plot-of-a-parametric-ci-vs.-bootstrap-ci-of-the-means"><i class="fa fa-check"></i><b>5.5.4</b> A plot of a “parametric” CI vs. bootstrap CI of the means</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="uncertainty.html"><a href="uncertainty.html#standard-error-of-a-difference-between-means"><i class="fa fa-check"></i><b>5.6</b> Standard error of a difference between means</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="uncertainty.html"><a href="uncertainty.html#the-standard-error-of-a-difference-between-means-is-the-standard-deviation-of-the-sampling-distribution-of-the-difference"><i class="fa fa-check"></i><b>5.6.1</b> The standard error of a difference between means is the standard deviation of the sampling distribution of the difference</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="uncertainty.html"><a href="uncertainty.html#confidence-limits-of-a-difference-between-means"><i class="fa fa-check"></i><b>5.7</b> Confidence limits of a difference between means</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="uncertainty.html"><a href="uncertainty.html#of-95-cis-of-the-difference-include-the-true-difference"><i class="fa fa-check"></i><b>5.7.1</b> 95% of 95% CIs of the difference include the true difference</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="uncertainty.html"><a href="uncertainty.html#hidden-code"><i class="fa fa-check"></i><b>5.8</b> Hidden code</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="uncertainty.html"><a href="uncertainty.html#import-exp3b"><i class="fa fa-check"></i><b>5.8.1</b> Import exp3b</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="p-values.html"><a href="p-values.html"><i class="fa fa-check"></i><b>6</b> P-values</a>
<ul>
<li class="chapter" data-level="6.1" data-path="p-values.html"><a href="p-values.html#a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution"><i class="fa fa-check"></i><b>6.1</b> A <em>p</em>-value is the probability of sampling a value as or more extreme than the test statistic if sampling from a null distribution</a></li>
<li class="chapter" data-level="6.2" data-path="p-values.html"><a href="p-values.html#pump-your-intuition-creating-a-null-distribution"><i class="fa fa-check"></i><b>6.2</b> Pump your intuition – Creating a null distribution</a></li>
<li class="chapter" data-level="6.3" data-path="p-values.html"><a href="p-values.html#a-null-distribution-of-t-values-the-t-distribution"><i class="fa fa-check"></i><b>6.3</b> A null distribution of <em>t</em>-values – the <em>t</em> distribution</a></li>
<li class="chapter" data-level="6.4" data-path="p-values.html"><a href="p-values.html#p-values-from-the-perspective-of-permutation"><i class="fa fa-check"></i><b>6.4</b> P-values from the perspective of permutation</a></li>
<li class="chapter" data-level="6.5" data-path="p-values.html"><a href="p-values.html#parametric-vs.-non-parametric-statistics"><i class="fa fa-check"></i><b>6.5</b> Parametric vs. non-parametric statistics</a></li>
<li class="chapter" data-level="6.6" data-path="p-values.html"><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values"><i class="fa fa-check"></i><b>6.6</b> frequentist probability and the interpretation of p-values</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="p-values.html"><a href="p-values.html#background-1"><i class="fa fa-check"></i><b>6.6.1</b> Background</a></li>
<li class="chapter" data-level="6.6.2" data-path="p-values.html"><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><i class="fa fa-check"></i><b>6.6.2</b> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li class="chapter" data-level="6.6.3" data-path="p-values.html"><a href="p-values.html#two-interpretations-of-the-p-value"><i class="fa fa-check"></i><b>6.6.3</b> Two interpretations of the <em>p</em>-value</a></li>
<li class="chapter" data-level="6.6.4" data-path="p-values.html"><a href="p-values.html#nhst"><i class="fa fa-check"></i><b>6.6.4</b> NHST</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="p-values.html"><a href="p-values.html#some-major-misconceptions-of-the-p-value"><i class="fa fa-check"></i><b>6.7</b> Some major misconceptions of the <em>p</em>-value</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="p-values.html"><a href="p-values.html#misconception-p-0.05-means-there-is-no-effect-of-treatment"><i class="fa fa-check"></i><b>6.7.1</b> Misconception: <span class="math inline">\(p &gt; 0.05\)</span> means there is no effect of treatment</a></li>
<li class="chapter" data-level="6.7.2" data-path="p-values.html"><a href="p-values.html#misconception-a-p-value-is-repeatable"><i class="fa fa-check"></i><b>6.7.2</b> Misconception: a <em>p</em>-value is repeatable</a></li>
<li class="chapter" data-level="6.7.3" data-path="p-values.html"><a href="p-values.html#misconception-0.05-is-the-lifetime-rate-of-false-discoveries"><i class="fa fa-check"></i><b>6.7.3</b> Misconception: 0.05 is the lifetime rate of false discoveries</a></li>
<li class="chapter" data-level="6.7.4" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-an-important-effect"><i class="fa fa-check"></i><b>6.7.4</b> Misconception: a low <em>p</em>-value indicates an important effect</a></li>
<li class="chapter" data-level="6.7.5" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity"><i class="fa fa-check"></i><b>6.7.5</b> Misconception: a low <em>p</em>-value indicates high model fit or high predictive capacity</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="p-values.html"><a href="p-values.html#what-the-p-value-does-not-mean"><i class="fa fa-check"></i><b>6.8</b> What the <em>p</em>-value does not mean</a></li>
<li class="chapter" data-level="6.9" data-path="p-values.html"><a href="p-values.html#on-using-p-values-in-experimental-biology"><i class="fa fa-check"></i><b>6.9</b> On using <em>p</em>-values in experimental biology</a></li>
<li class="chapter" data-level="6.10" data-path="p-values.html"><a href="p-values.html#better-reproducibility"><i class="fa fa-check"></i><b>6.10</b> Better reproducibility</a></li>
<li class="chapter" data-level="6.11" data-path="p-values.html"><a href="p-values.html#multiple-testing-and-controlling-for-false-positives"><i class="fa fa-check"></i><b>6.11</b> Multiple testing and controlling for false positives</a>
<ul>
<li class="chapter" data-level="6.11.1" data-path="p-values.html"><a href="p-values.html#controlling-the-family-wise-error-rate-when-all-tests-are-testing-the-same-hypothesis"><i class="fa fa-check"></i><b>6.11.1</b> Controlling the family-wise error rate when all tests are testing the same hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="6.12" data-path="p-values.html"><a href="p-values.html#recommendations"><i class="fa fa-check"></i><b>6.12</b> Recommendations</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="p-values.html"><a href="p-values.html#primary-sources-for-recommendations"><i class="fa fa-check"></i><b>6.12.1</b> Primary sources for recommendations</a></li>
</ul></li>
<li class="chapter" data-level="6.13" data-path="p-values.html"><a href="p-values.html#problems"><i class="fa fa-check"></i><b>6.13</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="errors-in-inference.html"><a href="errors-in-inference.html"><i class="fa fa-check"></i><b>7</b> Errors in inference</a>
<ul>
<li class="chapter" data-level="7.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#classical-nhst-concepts-of-wrong"><i class="fa fa-check"></i><b>7.1</b> Classical NHST concepts of wrong</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-i-error"><i class="fa fa-check"></i><b>7.1.1</b> Type I error</a></li>
<li class="chapter" data-level="7.1.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#power"><i class="fa fa-check"></i><b>7.1.2</b> Power</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#a-non-neyman-pearson-concept-of-power"><i class="fa fa-check"></i><b>7.2</b> A non-Neyman-Pearson concept of power</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#estimation-error"><i class="fa fa-check"></i><b>7.2.1</b> Estimation error</a></li>
<li class="chapter" data-level="7.2.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#coverage"><i class="fa fa-check"></i><b>7.2.2</b> Coverage</a></li>
<li class="chapter" data-level="7.2.3" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-s-error"><i class="fa fa-check"></i><b>7.2.3</b> Type S error</a></li>
<li class="chapter" data-level="7.2.4" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-m-error"><i class="fa fa-check"></i><b>7.2.4</b> Type M error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iv-introduction-to-linear-models.html"><a href="part-iv-introduction-to-linear-models.html"><i class="fa fa-check"></i>Part IV: Introduction to Linear Models</a></li>
<li class="chapter" data-level="8" data-path="intro-linear-models.html"><a href="intro-linear-models.html"><i class="fa fa-check"></i><b>8</b> An introduction to linear models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#lm-specifications"><i class="fa fa-check"></i><b>8.1</b> Two specifications of a linear model</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#the-error-draw-specification"><i class="fa fa-check"></i><b>8.1.1</b> The “error draw” specification</a></li>
<li class="chapter" data-level="8.1.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#the-conditional-draw-specification"><i class="fa fa-check"></i><b>8.1.2</b> The “conditional draw” specification</a></li>
<li class="chapter" data-level="8.1.3" data-path="intro-linear-models.html"><a href="intro-linear-models.html#comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model"><i class="fa fa-check"></i><b>8.1.3</b> Comparing the error-draw and conditional-draw ways of specifying the linear model</a></li>
<li class="chapter" data-level="8.1.4" data-path="intro-linear-models.html"><a href="intro-linear-models.html#anova-notation-of-a-linear-model"><i class="fa fa-check"></i><b>8.1.4</b> ANOVA notation of a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"><i class="fa fa-check"></i><b>8.2</b> A linear model can be fit to data with continuous, discrete, or categorical <span class="math inline">\(X\)</span> variables</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete"><i class="fa fa-check"></i><b>8.2.1</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is continuous or discrete</a></li>
<li class="chapter" data-level="8.2.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#slope"><i class="fa fa-check"></i><b>8.2.2</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is categorical</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="intro-linear-models.html"><a href="intro-linear-models.html#statistical-models-are-used-for-prediction-explanation-and-description"><i class="fa fa-check"></i><b>8.3</b> Statistical models are used for prediction, explanation, and description</a></li>
<li class="chapter" data-level="8.4" data-path="intro-linear-models.html"><a href="intro-linear-models.html#what-is-the-interpretation-of-a-regression-coefficient"><i class="fa fa-check"></i><b>8.4</b> What is the interpretation of a regression coefficient?</a></li>
<li class="chapter" data-level="8.5" data-path="intro-linear-models.html"><a href="intro-linear-models.html#what-do-we-call-the-x-and-y-variables"><i class="fa fa-check"></i><b>8.5</b> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li class="chapter" data-level="8.6" data-path="intro-linear-models.html"><a href="intro-linear-models.html#modeling-strategy"><i class="fa fa-check"></i><b>8.6</b> Modeling strategy</a></li>
<li class="chapter" data-level="8.7" data-path="intro-linear-models.html"><a href="intro-linear-models.html#predictions-from-the-model"><i class="fa fa-check"></i><b>8.7</b> Predictions from the model</a></li>
<li class="chapter" data-level="8.8" data-path="intro-linear-models.html"><a href="intro-linear-models.html#inference-from-the-model"><i class="fa fa-check"></i><b>8.8</b> Inference from the model</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#assumptions-for-inference-with-a-statistical-model"><i class="fa fa-check"></i><b>8.8.1</b> Assumptions for inference with a statistical model</a></li>
<li class="chapter" data-level="8.8.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model"><i class="fa fa-check"></i><b>8.8.2</b> Specific assumptions for inference with a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="intro-linear-models.html"><a href="intro-linear-models.html#linear-modelregression-model-or-statistical-model"><i class="fa fa-check"></i><b>8.9</b> “linear model,”regression model”, or “statistical model”?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> Linear models with a single, continuous <em>X</em> (“regression”)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><i class="fa fa-check"></i><b>9.1</b> A linear model with a single, continuous <em>X</em> is classical “regression”</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="regression.html"><a href="regression.html#analysis-of-green-down-data"><i class="fa fa-check"></i><b>9.1.1</b> Analysis of “green-down” data</a></li>
<li class="chapter" data-level="9.1.2" data-path="regression.html"><a href="regression.html#learning-from-the-green-down-example"><i class="fa fa-check"></i><b>9.1.2</b> Learning from the green-down example</a></li>
<li class="chapter" data-level="9.1.3" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-explanation-causal-models"><i class="fa fa-check"></i><b>9.1.3</b> Using a regression model for “explanation” – causal models</a></li>
<li class="chapter" data-level="9.1.4" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-prediction-prediction-models"><i class="fa fa-check"></i><b>9.1.4</b> Using a regression model for prediction – prediction models</a></li>
<li class="chapter" data-level="9.1.5" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data"><i class="fa fa-check"></i><b>9.1.5</b> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</a></li>
<li class="chapter" data-level="9.1.6" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-for-calibration"><i class="fa fa-check"></i><b>9.1.6</b> Using a regression model for for calibration</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#working-in-r-1"><i class="fa fa-check"></i><b>9.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="plotting-models.html"><a href="plotting-models.html#fit-the-model"><i class="fa fa-check"></i><b>9.2.1</b> Fitting the linear model</a></li>
<li class="chapter" data-level="9.2.2" data-path="regression.html"><a href="regression.html#getting-to-know-the-linear-model-the-summary-function"><i class="fa fa-check"></i><b>9.2.2</b> Getting to know the linear model: the <code>summary</code> function</a></li>
<li class="chapter" data-level="9.2.3" data-path="regression.html"><a href="regression.html#inference-the-coefficient-table"><i class="fa fa-check"></i><b>9.2.3</b> Inference – the coefficient table</a></li>
<li class="chapter" data-level="9.2.4" data-path="regression.html"><a href="regression.html#how-good-is-our-model-model-checking"><i class="fa fa-check"></i><b>9.2.4</b> How good is our model? – Model checking</a></li>
<li class="chapter" data-level="9.2.5" data-path="regression.html"><a href="regression.html#plotting-models-with-continuous-x"><i class="fa fa-check"></i><b>9.2.5</b> Plotting models with continuous <em>X</em></a></li>
<li class="chapter" data-level="9.2.6" data-path="regression.html"><a href="regression.html#creating-a-table-of-predicted-values-and-95-prediction-intervals"><i class="fa fa-check"></i><b>9.2.6</b> Creating a table of predicted values and 95% prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="regression.html"><a href="regression.html#hidden-code-1"><i class="fa fa-check"></i><b>9.3</b> Hidden code</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="regression.html"><a href="regression.html#import-and-plot-of-fig2c-ecosystem-warming-experimental-data"><i class="fa fa-check"></i><b>9.3.1</b> Import and plot of fig2c (ecosystem warming experimental) data</a></li>
<li class="chapter" data-level="9.3.2" data-path="regression.html"><a href="regression.html#import-and-plot-efig_3d-ecosysem-warming-observational-data"><i class="fa fa-check"></i><b>9.3.2</b> Import and plot efig_3d (Ecosysem warming observational) data</a></li>
<li class="chapter" data-level="9.3.3" data-path="regression.html"><a href="regression.html#import-and-plot-of-fig1f-methionine-restriction-data"><i class="fa fa-check"></i><b>9.3.3</b> Import and plot of fig1f (methionine restriction) data</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="regression.html"><a href="regression.html#try-it"><i class="fa fa-check"></i><b>9.4</b> Try it</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="regression.html"><a href="regression.html#a-prediction-model-from-the-literature"><i class="fa fa-check"></i><b>9.4.1</b> A prediction model from the literature</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="regression.html"><a href="regression.html#intuition-pumps"><i class="fa fa-check"></i><b>9.5</b> Intuition pumps</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="regression.html"><a href="regression.html#correlation-and-r2"><i class="fa fa-check"></i><b>9.5.1</b> Correlation and $R^2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="oneway.html"><a href="oneway.html"><i class="fa fa-check"></i><b>10</b> Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="oneway.html"><a href="oneway.html#oneway-data"><i class="fa fa-check"></i><b>10.1</b> A linear model with a single factor (categorical <em>X</em>variable) estimates the effects of the levels of factor on the response</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="oneway.html"><a href="oneway.html#oneway-example1"><i class="fa fa-check"></i><b>10.1.1</b> Example 1 (fig3d) – two treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.2" data-path="oneway.html"><a href="oneway.html#understanding-the-analysis-with-two-treatment-levels"><i class="fa fa-check"></i><b>10.1.2</b> Understanding the analysis with two treatment levels</a></li>
<li class="chapter" data-level="10.1.3" data-path="oneway.html"><a href="oneway.html#oneway-example2"><i class="fa fa-check"></i><b>10.1.3</b> Example 2 – three treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.4" data-path="oneway.html"><a href="oneway.html#understanding-the-analysis-with-three-or-more-treatment-levels"><i class="fa fa-check"></i><b>10.1.4</b> Understanding the analysis with three (or more) treatment levels</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="oneway.html"><a href="oneway.html#working-in-r-2"><i class="fa fa-check"></i><b>10.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="oneway.html"><a href="oneway.html#fit-the-model-1"><i class="fa fa-check"></i><b>10.2.1</b> Fit the model</a></li>
<li class="chapter" data-level="10.2.2" data-path="oneway.html"><a href="oneway.html#controlling-the-output-in-tables-using-the-coefficient-table-as-an-example"><i class="fa fa-check"></i><b>10.2.2</b> Controlling the output in tables using the coefficient table as an example</a></li>
<li class="chapter" data-level="10.2.3" data-path="oneway.html"><a href="oneway.html#using-the-emmeans-function"><i class="fa fa-check"></i><b>10.2.3</b> Using the emmeans function</a></li>
<li class="chapter" data-level="10.2.4" data-path="oneway.html"><a href="oneway.html#using-the-contrast-function"><i class="fa fa-check"></i><b>10.2.4</b> Using the contrast function</a></li>
<li class="chapter" data-level="10.2.5" data-path="oneway.html"><a href="oneway.html#how-to-generate-anova-tables"><i class="fa fa-check"></i><b>10.2.5</b> How to generate ANOVA tables</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="oneway.html"><a href="oneway.html#hidden-code-2"><i class="fa fa-check"></i><b>10.3</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="oneway.html"><a href="oneway.html#importing-and-wrangling-the-fig3d-data-for-example-1"><i class="fa fa-check"></i><b>10.3.1</b> Importing and wrangling the fig3d data for example 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="oneway.html"><a href="oneway.html#importing-and-wrangling-the-fig2a-data-for-example-2"><i class="fa fa-check"></i><b>10.3.2</b> Importing and wrangling the fig2a data for example 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>11</b> Model Checking</a>
<ul>
<li class="chapter" data-level="11.1" data-path="model-checking.html"><a href="model-checking.html#check-check"><i class="fa fa-check"></i><b>11.1</b> All statistical analyses should be followed by model checking</a></li>
<li class="chapter" data-level="11.2" data-path="model-checking.html"><a href="model-checking.html#linear-model-assumptions"><i class="fa fa-check"></i><b>11.2</b> Linear model assumptions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="model-checking.html"><a href="model-checking.html#a-bit-about-iid"><i class="fa fa-check"></i><b>11.2.1</b> A bit about IID</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="model-checking.html"><a href="model-checking.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>11.3</b> Diagnostic plots use the residuals from the model fit</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="model-checking.html"><a href="model-checking.html#residuals"><i class="fa fa-check"></i><b>11.3.1</b> Residuals</a></li>
<li class="chapter" data-level="11.3.2" data-path="model-checking.html"><a href="model-checking.html#normal-qq"><i class="fa fa-check"></i><b>11.3.2</b> A Normal Q-Q plot is used to check for characteristic departures from Normality</a></li>
<li class="chapter" data-level="11.3.3" data-path="model-checking.html"><a href="model-checking.html#mapping-qq-plot-departures-from-normality"><i class="fa fa-check"></i><b>11.3.3</b> Mapping QQ-plot departures from Normality</a></li>
<li class="chapter" data-level="11.3.4" data-path="model-checking.html"><a href="model-checking.html#model-checking-spread-level"><i class="fa fa-check"></i><b>11.3.4</b> Model checking homoskedasticity</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="model-checking.html"><a href="model-checking.html#using-r"><i class="fa fa-check"></i><b>11.4</b> Using R</a></li>
<li class="chapter" data-level="11.5" data-path="model-checking.html"><a href="model-checking.html#hidden-code-3"><i class="fa fa-check"></i><b>11.5</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="model-checking.html"><a href="model-checking.html#normal-q-q-plots"><i class="fa fa-check"></i><b>11.5.1</b> Normal Q-Q plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="violations.html"><a href="violations.html"><i class="fa fa-check"></i><b>12</b> Violations of independence, homogeneity, or Normality</a>
<ul>
<li class="chapter" data-level="12.1" data-path="violations.html"><a href="violations.html#oneway-paired-t"><i class="fa fa-check"></i><b>12.1</b> Lack of independence</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="violations.html"><a href="violations.html#violations-paired-t"><i class="fa fa-check"></i><b>12.1.1</b> Example 1 (exp1b) – a paired t-test is a special case of a linear mixed model</a></li>
<li class="chapter" data-level="12.1.2" data-path="violations.html"><a href="violations.html#violations-rmanova"><i class="fa fa-check"></i><b>12.1.2</b> Example 2 (diHOME exp2a) – A repeated measures ANOVA is a special case of a linear mixed model</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="violations.html"><a href="violations.html#oneway-welch"><i class="fa fa-check"></i><b>12.2</b> Heterogeneity of variances</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="violations.html"><a href="violations.html#when-groups-of-the-focal-test-have-variance"><i class="fa fa-check"></i><b>12.2.1</b> When groups of the focal test have &gt;&gt; variance</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="violations.html"><a href="violations.html#the-conditional-response-isnt-normal"><i class="fa fa-check"></i><b>12.3</b> The conditional response isn’t Normal</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="violations.html"><a href="violations.html#violations-6f"><i class="fa fa-check"></i><b>12.3.1</b> Example 1 (fig6f) – Linear models for non-normal count data</a></li>
<li class="chapter" data-level="12.3.2" data-path="violations.html"><a href="violations.html#my-data-arent-normal-what-is-the-best-practice"><i class="fa fa-check"></i><b>12.3.2</b> My data aren’t normal, what is the best practice?</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="violations.html"><a href="violations.html#hidden-code-4"><i class="fa fa-check"></i><b>12.4</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-exp1b-data"><i class="fa fa-check"></i><b>12.4.1</b> Importing and wrangling the exp1b data</a></li>
<li class="chapter" data-level="12.4.2" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-exp2a-data"><i class="fa fa-check"></i><b>12.4.2</b> Importing and wrangling the exp2a data</a></li>
<li class="chapter" data-level="12.4.3" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-fig6f-data"><i class="fa fa-check"></i><b>12.4.3</b> Importing and wrangling the fig6f data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="issues.html"><a href="issues.html"><i class="fa fa-check"></i><b>13</b> Issues in inference</a>
<ul>
<li class="chapter" data-level="13.1" data-path="issues.html"><a href="issues.html#replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means"><i class="fa fa-check"></i><b>13.1</b> Replicated experiments – include <span class="math inline">\(\texttt{Experiment}\)</span> as a random factor (better than one-way ANOVA of means)</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="issues.html"><a href="issues.html#issues-exp4d"><i class="fa fa-check"></i><b>13.1.1</b> Multiple experiments Example 1 (wound healing Exp4d)</a></li>
<li class="chapter" data-level="13.1.2" data-path="issues.html"><a href="issues.html#issues-combined-experiments"><i class="fa fa-check"></i><b>13.1.2</b> Models for combining replicated experiments</a></li>
<li class="chapter" data-level="13.1.3" data-path="issues.html"><a href="issues.html#understanding-model-exp4d_m1"><i class="fa fa-check"></i><b>13.1.3</b> Understanding Model <code>exp4d_m1</code></a></li>
<li class="chapter" data-level="13.1.4" data-path="issues.html"><a href="issues.html#the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2"><i class="fa fa-check"></i><b>13.1.4</b> The univariate model is equivalent to a linear mixed model of the aggregated data (Model exp4d_m2)</a></li>
<li class="chapter" data-level="13.1.5" data-path="issues.html"><a href="issues.html#a-linear-mixed-model-of-the-full-data"><i class="fa fa-check"></i><b>13.1.5</b> A linear mixed model of the full data</a></li>
<li class="chapter" data-level="13.1.6" data-path="issues.html"><a href="issues.html#analysis-of-the-experiment-means-has-less-precision-and-power"><i class="fa fa-check"></i><b>13.1.6</b> Analysis of the experiment means has less precision and power</a></li>
<li class="chapter" data-level="13.1.7" data-path="issues.html"><a href="issues.html#dont-do-this-a-t-testfixed-effect-anova-of-the-full-data"><i class="fa fa-check"></i><b>13.1.7</b> Don’t do this – a t-test/fixed-effect ANOVA of the full data</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="issues.html"><a href="issues.html#issues-pre-post"><i class="fa fa-check"></i><b>13.2</b> Comparing change from baseline (pre-post)</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="issues.html"><a href="issues.html#pre-post-example-1-dpp4-fig4c"><i class="fa fa-check"></i><b>13.2.1</b> Pre-post example 1 (DPP4 fig4c)</a></li>
<li class="chapter" data-level="13.2.2" data-path="issues.html"><a href="issues.html#what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure"><i class="fa fa-check"></i><b>13.2.2</b> What if the data in example 1 were from from an experiment where the treatment was applied prior to the baseline measure?</a></li>
<li class="chapter" data-level="13.2.3" data-path="issues.html"><a href="issues.html#pre-post-example-2-xx-males-fig1c"><i class="fa fa-check"></i><b>13.2.3</b> Pre-post example 2 (XX males fig1c)</a></li>
<li class="chapter" data-level="13.2.4" data-path="issues.html"><a href="issues.html#issues-regression-to-mean"><i class="fa fa-check"></i><b>13.2.4</b> Regression to the mean</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="issues.html"><a href="issues.html#longitudinal-designs-with-more-than-one-post-baseline-measure"><i class="fa fa-check"></i><b>13.3</b> Longitudinal designs with more than one-post baseline measure</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="issues.html"><a href="issues.html#issues-auc"><i class="fa fa-check"></i><b>13.3.1</b> Area under the curve (AUC)</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="issues.html"><a href="issues.html#normalization-the-analysis-of-ratios"><i class="fa fa-check"></i><b>13.4</b> Normalization – the analysis of ratios</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="issues.html"><a href="issues.html#kinds-of-ratios-in-experimental-biology"><i class="fa fa-check"></i><b>13.4.1</b> Kinds of ratios in experimental biology</a></li>
<li class="chapter" data-level="13.4.2" data-path="issues.html"><a href="issues.html#issues-offset"><i class="fa fa-check"></i><b>13.4.2</b> Example 1 – The ratio is a density (number of something per area)</a></li>
<li class="chapter" data-level="13.4.3" data-path="issues.html"><a href="issues.html#issues-size"><i class="fa fa-check"></i><b>13.4.3</b> Example 2 – The ratio is normalizing for size differences</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="issues.html"><a href="issues.html#dont-do-this-stuff"><i class="fa fa-check"></i><b>13.5</b> Don’t do this stuff</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="issues.html"><a href="issues.html#normalize-the-response-so-that-all-control-values-are-equal-to-1."><i class="fa fa-check"></i><b>13.5.1</b> Normalize the response so that all control values are equal to 1.</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="issues.html"><a href="issues.html#a-difference-in-significance-is-not-necessarily-significant"><i class="fa fa-check"></i><b>13.6</b> A difference in significance is not necessarily significant</a></li>
<li class="chapter" data-level="13.7" data-path="issues.html"><a href="issues.html#researcher-degrees-of-freedom"><i class="fa fa-check"></i><b>13.7</b> Researcher degrees of freedom</a></li>
<li class="chapter" data-level="13.8" data-path="issues.html"><a href="issues.html#hidden-code-5"><i class="fa fa-check"></i><b>13.8</b> Hidden code</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="issues.html"><a href="issues.html#import-exp4d-vimentin-cell-count-data-replicate-experiments-example"><i class="fa fa-check"></i><b>13.8.1</b> Import exp4d vimentin cell count data (replicate experiments example)</a></li>
<li class="chapter" data-level="13.8.2" data-path="issues.html"><a href="issues.html#import-fig4c-data"><i class="fa fa-check"></i><b>13.8.2</b> Import Fig4c data</a></li>
<li class="chapter" data-level="13.8.3" data-path="issues.html"><a href="issues.html#xx-males-fig1c"><i class="fa fa-check"></i><b>13.8.3</b> XX males fig1c</a></li>
<li class="chapter" data-level="13.8.4" data-path="issues.html"><a href="issues.html#generation-of-fake-data-to-illustrate-regression-to-the-mean"><i class="fa fa-check"></i><b>13.8.4</b> Generation of fake data to illustrate regression to the mean</a></li>
<li class="chapter" data-level="13.8.5" data-path="issues.html"><a href="issues.html#import-fig3f"><i class="fa fa-check"></i><b>13.8.5</b> Import fig3f</a></li>
<li class="chapter" data-level="13.8.6" data-path="issues.html"><a href="issues.html#issues-import-exp3b"><i class="fa fa-check"></i><b>13.8.6</b> Import exp3b</a></li>
<li class="chapter" data-level="13.8.7" data-path="issues.html"><a href="issues.html#issues-exp3b-plot"><i class="fa fa-check"></i><b>13.8.7</b> Plot the model of exp3b (glm offset data)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-more-than-one-x-multivariable-models.html"><a href="part-v-more-than-one-x-multivariable-models.html"><i class="fa fa-check"></i>Part V: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li class="chapter" data-level="14" data-path="covariates.html"><a href="covariates.html"><i class="fa fa-check"></i><b>14</b> Linear models with added covariates (“ANCOVA”)</a>
<ul>
<li class="chapter" data-level="14.1" data-path="covariates.html"><a href="covariates.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><i class="fa fa-check"></i><b>14.1</b> Adding covariates can increases the precision of the effect of interest</a></li>
<li class="chapter" data-level="14.2" data-path="covariates.html"><a href="covariates.html#understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data"><i class="fa fa-check"></i><b>14.2</b> Understanding a linear model with an added covariate – heart necrosis data</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="covariates.html"><a href="covariates.html#fit-the-model-5"><i class="fa fa-check"></i><b>14.2.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.2.2" data-path="covariates.html"><a href="covariates.html#plot-the-model-2"><i class="fa fa-check"></i><b>14.2.2</b> Plot the model</a></li>
<li class="chapter" data-level="14.2.3" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-model-coefficients"><i class="fa fa-check"></i><b>14.2.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.2.4" data-path="covariates.html"><a href="covariates.html#everything-adds-up"><i class="fa fa-check"></i><b>14.2.4</b> Everything adds up</a></li>
<li class="chapter" data-level="14.2.5" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-estimated-marginal-means"><i class="fa fa-check"></i><b>14.2.5</b> Interpretation of the estimated marginal means</a></li>
<li class="chapter" data-level="14.2.6" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-contrasts"><i class="fa fa-check"></i><b>14.2.6</b> Interpretation of the contrasts</a></li>
<li class="chapter" data-level="14.2.7" data-path="covariates.html"><a href="covariates.html#adding-the-covariate-improves-inference"><i class="fa fa-check"></i><b>14.2.7</b> Adding the covariate improves inference</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="covariates.html"><a href="covariates.html#understanding-interaction-effects-with-covariates"><i class="fa fa-check"></i><b>14.3</b> Understanding interaction effects with covariates</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="covariates.html"><a href="covariates.html#fit-the-model-6"><i class="fa fa-check"></i><b>14.3.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.3.2" data-path="covariates.html"><a href="covariates.html#plot-the-model-with-interaction-effect"><i class="fa fa-check"></i><b>14.3.2</b> Plot the model with interaction effect</a></li>
<li class="chapter" data-level="14.3.3" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-model-coefficients-1"><i class="fa fa-check"></i><b>14.3.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.3.4" data-path="covariates.html"><a href="covariates.html#what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends."><i class="fa fa-check"></i><b>14.3.4</b> What is the effect of a treatment, if interactions are modeled? – it depends.</a></li>
<li class="chapter" data-level="14.3.5" data-path="covariates.html"><a href="covariates.html#which-model-do-we-use-mathcalm_1-or-mathcalm_2"><i class="fa fa-check"></i><b>14.3.5</b> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="covariates.html"><a href="covariates.html#understanding-ancova-tables"><i class="fa fa-check"></i><b>14.4</b> Understanding ANCOVA tables</a></li>
<li class="chapter" data-level="14.5" data-path="covariates.html"><a href="covariates.html#working-in-r-3"><i class="fa fa-check"></i><b>14.5</b> Working in R</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="covariates.html"><a href="covariates.html#importing-the-heart-necrosis-data"><i class="fa fa-check"></i><b>14.5.1</b> Importing the heart necrosis data</a></li>
<li class="chapter" data-level="14.5.2" data-path="covariates.html"><a href="covariates.html#fitting-the-model"><i class="fa fa-check"></i><b>14.5.2</b> Fitting the model</a></li>
<li class="chapter" data-level="14.5.3" data-path="covariates.html"><a href="covariates.html#using-the-emmeans-function-1"><i class="fa fa-check"></i><b>14.5.3</b> Using the emmeans function</a></li>
<li class="chapter" data-level="14.5.4" data-path="covariates.html"><a href="covariates.html#ancova-tables"><i class="fa fa-check"></i><b>14.5.4</b> ANCOVA tables</a></li>
<li class="chapter" data-level="14.5.5" data-path="covariates.html"><a href="covariates.html#plotting-the-model"><i class="fa fa-check"></i><b>14.5.5</b> Plotting the model</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="covariates.html"><a href="covariates.html#best-practices"><i class="fa fa-check"></i><b>14.6</b> Best practices</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="covariates.html"><a href="covariates.html#do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate"><i class="fa fa-check"></i><b>14.6.1</b> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</a></li>
<li class="chapter" data-level="14.6.2" data-path="covariates.html"><a href="covariates.html#do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate"><i class="fa fa-check"></i><b>14.6.2</b> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</a></li>
<li class="chapter" data-level="14.6.3" data-path="covariates.html"><a href="covariates.html#do-not-test-for-balance-of-baseline-measures"><i class="fa fa-check"></i><b>14.6.3</b> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="covariates.html"><a href="covariates.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><i class="fa fa-check"></i><b>14.7</b> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="factorial.html"><a href="factorial.html"><i class="fa fa-check"></i><b>15</b> Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</a>
<ul>
<li class="chapter" data-level="15.1" data-path="factorial.html"><a href="factorial.html#a-linear-model-with-crossed-factors-estimates-interaction-effects"><i class="fa fa-check"></i><b>15.1</b> A linear model with crossed factors estimates interaction effects</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="factorial.html"><a href="factorial.html#an-interaction-is-a-difference-in-simple-effects"><i class="fa fa-check"></i><b>15.1.1</b> An interaction is a difference in simple effects</a></li>
<li class="chapter" data-level="15.1.2" data-path="factorial.html"><a href="factorial.html#a-linear-model-with-crossed-factors-includes-interaction-effects"><i class="fa fa-check"></i><b>15.1.2</b> A linear model with crossed factors includes interaction effects</a></li>
<li class="chapter" data-level="15.1.3" data-path="factorial.html"><a href="factorial.html#factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature"><i class="fa fa-check"></i><b>15.1.3</b> factorial experiments are frequently analyzed as flattened linear models in the experimental biology literature</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="factorial.html"><a href="factorial.html#example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data"><i class="fa fa-check"></i><b>15.2</b> Example 1 – Estimation of a treatment effect relative to a control effect (“Something different”) (Experiment 2j glucose uptake data)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="factorial.html"><a href="factorial.html#twoway-understand1"><i class="fa fa-check"></i><b>15.2.1</b> Understand the experimental design</a></li>
<li class="chapter" data-level="15.2.2" data-path="factorial.html"><a href="factorial.html#fit-the-linear-model"><i class="fa fa-check"></i><b>15.2.2</b> Fit the linear model</a></li>
<li class="chapter" data-level="15.2.3" data-path="factorial.html"><a href="factorial.html#twoway-exp2j-inf"><i class="fa fa-check"></i><b>15.2.3</b> Inference</a></li>
<li class="chapter" data-level="15.2.4" data-path="factorial.html"><a href="factorial.html#plot-the-model-3"><i class="fa fa-check"></i><b>15.2.4</b> Plot the model</a></li>
<li class="chapter" data-level="15.2.5" data-path="factorial.html"><a href="factorial.html#alternaplot-the-model"><i class="fa fa-check"></i><b>15.2.5</b> alternaPlot the model</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-1"><i class="fa fa-check"></i><b>15.3</b> Understanding the linear model with crossed factors 1</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="factorial.html"><a href="factorial.html#twoway-what-coefs-are"><i class="fa fa-check"></i><b>15.3.1</b> What the coefficients are</a></li>
<li class="chapter" data-level="15.3.2" data-path="factorial.html"><a href="factorial.html#the-interaction-effect-is-something-different"><i class="fa fa-check"></i><b>15.3.2</b> The interaction effect is something different</a></li>
<li class="chapter" data-level="15.3.3" data-path="factorial.html"><a href="factorial.html#why-we-want-to-compare-the-treatment-effect-to-a-control-effect"><i class="fa fa-check"></i><b>15.3.3</b> Why we want to compare the treatment effect to a control effect</a></li>
<li class="chapter" data-level="15.3.4" data-path="factorial.html"><a href="factorial.html#the-order-of-the-factors-in-the-model-tells-the-same-story-differently"><i class="fa fa-check"></i><b>15.3.4</b> The order of the factors in the model tells the same story differently</a></li>
<li class="chapter" data-level="15.3.5" data-path="factorial.html"><a href="factorial.html#power-for-the-interaction-effect-is-less-than-that-for-simple-effects"><i class="fa fa-check"></i><b>15.3.5</b> Power for the interaction effect is less than that for simple effects</a></li>
<li class="chapter" data-level="15.3.6" data-path="factorial.html"><a href="factorial.html#planned-comparisons-vs.-post-hoc-tests"><i class="fa fa-check"></i><b>15.3.6</b> Planned comparisons vs. post-hoc tests</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="factorial.html"><a href="factorial.html#example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data"><i class="fa fa-check"></i><b>15.4</b> Example 2: Estimation of the effect of background condition on an effect (“it depends”) (Experiment 3e lesian area data)</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="factorial.html"><a href="factorial.html#understand-the-experimental-design"><i class="fa fa-check"></i><b>15.4.1</b> Understand the experimental design</a></li>
<li class="chapter" data-level="15.4.2" data-path="factorial.html"><a href="factorial.html#fit-the-linear-model-1"><i class="fa fa-check"></i><b>15.4.2</b> Fit the linear model</a></li>
<li class="chapter" data-level="15.4.3" data-path="factorial.html"><a href="factorial.html#check-the-model-1"><i class="fa fa-check"></i><b>15.4.3</b> Check the model</a></li>
<li class="chapter" data-level="15.4.4" data-path="factorial.html"><a href="factorial.html#inference-from-the-model-2"><i class="fa fa-check"></i><b>15.4.4</b> Inference from the model</a></li>
<li class="chapter" data-level="15.4.5" data-path="factorial.html"><a href="factorial.html#plot-the-model-4"><i class="fa fa-check"></i><b>15.4.5</b> Plot the model</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-2"><i class="fa fa-check"></i><b>15.5</b> Understanding the linear model with crossed factors 2</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="factorial.html"><a href="factorial.html#twoway-marginal-means"><i class="fa fa-check"></i><b>15.5.1</b> Conditional and marginal means</a></li>
<li class="chapter" data-level="15.5.2" data-path="factorial.html"><a href="factorial.html#simple-conditional-effects"><i class="fa fa-check"></i><b>15.5.2</b> Simple (conditional) effects</a></li>
<li class="chapter" data-level="15.5.3" data-path="factorial.html"><a href="factorial.html#twoway-marginal-effects"><i class="fa fa-check"></i><b>15.5.3</b> Marginal effects</a></li>
<li class="chapter" data-level="15.5.4" data-path="factorial.html"><a href="factorial.html#the-additive-model"><i class="fa fa-check"></i><b>15.5.4</b> The additive model</a></li>
<li class="chapter" data-level="15.5.5" data-path="factorial.html"><a href="factorial.html#twoway-reduce"><i class="fa fa-check"></i><b>15.5.5</b> Reduce models for the right reason</a></li>
<li class="chapter" data-level="15.5.6" data-path="factorial.html"><a href="factorial.html#the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird"><i class="fa fa-check"></i><b>15.5.6</b> The marginal means of an additive linear model with two factors can be weird</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="factorial.html"><a href="factorial.html#example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data"><i class="fa fa-check"></i><b>15.6</b> Example 3: Estimation of synergy (“More than the sum of the parts”) (Experiment 1c JA data)</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="factorial.html"><a href="factorial.html#examine-the-data"><i class="fa fa-check"></i><b>15.6.1</b> Examine the data</a></li>
<li class="chapter" data-level="15.6.2" data-path="factorial.html"><a href="factorial.html#fit-the-model-7"><i class="fa fa-check"></i><b>15.6.2</b> Fit the model</a></li>
<li class="chapter" data-level="15.6.3" data-path="factorial.html"><a href="factorial.html#model-check"><i class="fa fa-check"></i><b>15.6.3</b> Model check</a></li>
<li class="chapter" data-level="15.6.4" data-path="factorial.html"><a href="factorial.html#inference-from-the-model-3"><i class="fa fa-check"></i><b>15.6.4</b> Inference from the model</a></li>
<li class="chapter" data-level="15.6.5" data-path="factorial.html"><a href="factorial.html#plot-the-model-5"><i class="fa fa-check"></i><b>15.6.5</b> Plot the model</a></li>
<li class="chapter" data-level="15.6.6" data-path="factorial.html"><a href="factorial.html#alternative-plot"><i class="fa fa-check"></i><b>15.6.6</b> Alternative plot</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-3"><i class="fa fa-check"></i><b>15.7</b> Understanding the linear model with crossed factors 3</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="factorial.html"><a href="factorial.html#thinking-about-the-coefficients-of-the-linear-model"><i class="fa fa-check"></i><b>15.7.1</b> Thinking about the coefficients of the linear model</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="factorial.html"><a href="factorial.html#issues-in-inference"><i class="fa fa-check"></i><b>15.8</b> Issues in inference</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="factorial.html"><a href="factorial.html#for-pairwise-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><i class="fa fa-check"></i><b>15.8.1</b> For pairwise contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li class="chapter" data-level="15.8.2" data-path="factorial.html"><a href="factorial.html#for-interaction-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><i class="fa fa-check"></i><b>15.8.2</b> For interaction contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li class="chapter" data-level="15.8.3" data-path="factorial.html"><a href="factorial.html#twoway-multiple-tests"><i class="fa fa-check"></i><b>15.8.3</b> Adjusting <em>p</em>-values for multiple tests</a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="factorial.html"><a href="factorial.html#two-way-anova"><i class="fa fa-check"></i><b>15.9</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="15.9.1" data-path="factorial.html"><a href="factorial.html#how-to-read-a-two-way-anova-table"><i class="fa fa-check"></i><b>15.9.1</b> How to read a two-way ANOVA table</a></li>
<li class="chapter" data-level="15.9.2" data-path="factorial.html"><a href="factorial.html#what-do-the-main-effects-in-an-anova-table-mean"><i class="fa fa-check"></i><b>15.9.2</b> What do the main effects in an ANOVA table mean?</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="factorial.html"><a href="factorial.html#more-issues-in-inference"><i class="fa fa-check"></i><b>15.10</b> More issues in inference</a>
<ul>
<li class="chapter" data-level="15.10.1" data-path="factorial.html"><a href="factorial.html#longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova"><i class="fa fa-check"></i><b>15.10.1</b> Longitudinal experiments – include Time as a random factor (better than repeated measures ANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="factorial.html"><a href="factorial.html#working-in-r-4"><i class="fa fa-check"></i><b>15.11</b> Working in R</a>
<ul>
<li class="chapter" data-level="15.11.1" data-path="factorial.html"><a href="factorial.html#model-formula"><i class="fa fa-check"></i><b>15.11.1</b> Model formula</a></li>
<li class="chapter" data-level="15.11.2" data-path="factorial.html"><a href="factorial.html#using-the-emmeans-function-2"><i class="fa fa-check"></i><b>15.11.2</b> Using the emmeans function</a></li>
<li class="chapter" data-level="15.11.3" data-path="factorial.html"><a href="factorial.html#contrasts"><i class="fa fa-check"></i><b>15.11.3</b> Contrasts</a></li>
<li class="chapter" data-level="15.11.4" data-path="factorial.html"><a href="factorial.html#practice-safe-anova"><i class="fa fa-check"></i><b>15.11.4</b> Practice safe ANOVA</a></li>
<li class="chapter" data-level="15.11.5" data-path="factorial.html"><a href="factorial.html#better-to-avoid-these"><i class="fa fa-check"></i><b>15.11.5</b> Better to avoid these</a></li>
</ul></li>
<li class="chapter" data-level="15.12" data-path="factorial.html"><a href="factorial.html#hidden-code-6"><i class="fa fa-check"></i><b>15.12</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="15.12.1" data-path="factorial.html"><a href="factorial.html#import-exp2j-example-1"><i class="fa fa-check"></i><b>15.12.1</b> Import exp2j (Example 1)</a></li>
<li class="chapter" data-level="15.12.2" data-path="factorial.html"><a href="factorial.html#import-exp3e-lesian-area-data-example-2"><i class="fa fa-check"></i><b>15.12.2</b> Import exp3e lesian area data (Example 2)</a></li>
<li class="chapter" data-level="15.12.3" data-path="factorial.html"><a href="factorial.html#import-exp1c-ja-data-example-3"><i class="fa fa-check"></i><b>15.12.3</b> Import Exp1c JA data (Example 3)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-vi-expanding-the-linear-model.html"><a href="part-vi-expanding-the-linear-model.html"><i class="fa fa-check"></i>Part VI – Expanding the Linear Model</a></li>
<li class="chapter" data-level="16" data-path="lmm.html"><a href="lmm.html"><i class="fa fa-check"></i><b>16</b> Models for non-independence – linear mixed models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="lmm.html"><a href="lmm.html#liberal-inference-from-pseudoreplication"><i class="fa fa-check"></i><b>16.1</b> Liberal inference from pseudoreplication</a></li>
<li class="chapter" data-level="16.2" data-path="lmm.html"><a href="lmm.html#conservative-inference-from-failure-to-identify-blocks"><i class="fa fa-check"></i><b>16.2</b> Conservative inference from failure to identify blocks</a></li>
<li class="chapter" data-level="16.3" data-path="lmm.html"><a href="lmm.html#introduction-to-models-for-non-independent-data-linear-mixed-models"><i class="fa fa-check"></i><b>16.3</b> Introduction to models for non-independent data (linear mixed models)</a></li>
<li class="chapter" data-level="16.4" data-path="lmm.html"><a href="lmm.html#experimental-designs-in-experimental-bench-biology"><i class="fa fa-check"></i><b>16.4</b> Experimental designs in experimental bench biology</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="lmm.html"><a href="lmm.html#notation-for-models"><i class="fa fa-check"></i><b>16.4.1</b> Notation for models</a></li>
<li class="chapter" data-level="16.4.2" data-path="lmm.html"><a href="lmm.html#completely-randomized-design-crd"><i class="fa fa-check"></i><b>16.4.2</b> Completely Randomized Design (CRD)</a></li>
<li class="chapter" data-level="16.4.3" data-path="lmm.html"><a href="lmm.html#completely-randomized-design-with-subsampling-crds-or-nested-design"><i class="fa fa-check"></i><b>16.4.3</b> Completely Randomized Design with Subsampling (CRDS) or “Nested Design”</a></li>
<li class="chapter" data-level="16.4.4" data-path="lmm.html"><a href="lmm.html#randomized-complete-block-design-rcbd"><i class="fa fa-check"></i><b>16.4.4</b> Randomized Complete Block Design (RCBD)</a></li>
<li class="chapter" data-level="16.4.5" data-path="lmm.html"><a href="lmm.html#randomized-split-plot-design-rspd"><i class="fa fa-check"></i><b>16.4.5</b> Randomized Split Plot Design (RSPD)</a></li>
<li class="chapter" data-level="16.4.6" data-path="lmm.html"><a href="lmm.html#generalized-randomized-complete-block-design-grcbd"><i class="fa fa-check"></i><b>16.4.6</b> Generalized Randomized Complete Block Design (GRCBD)</a></li>
<li class="chapter" data-level="16.4.7" data-path="lmm.html"><a href="lmm.html#nested-randomized-complete-block-design-nrcbd"><i class="fa fa-check"></i><b>16.4.7</b> Nested Randomized Complete Block Design (NRCBD)</a></li>
<li class="chapter" data-level="16.4.8" data-path="lmm.html"><a href="lmm.html#longitudinal-randomized-complete-block-design-lrcbd"><i class="fa fa-check"></i><b>16.4.8</b> Longitudinal Randomized Complete Block Design (LRCBD)</a></li>
<li class="chapter" data-level="16.4.9" data-path="lmm.html"><a href="lmm.html#variations-due-to-multiple-measures-of-the-response-variable"><i class="fa fa-check"></i><b>16.4.9</b> Variations due to multiple measures of the response variable</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="lmm.html"><a href="lmm.html#building-the-linear-mixed-model-for-clustered-data"><i class="fa fa-check"></i><b>16.5</b> Building the linear (mixed) model for clustered data</a></li>
<li class="chapter" data-level="16.6" data-path="lmm.html"><a href="lmm.html#lmm-demo"><i class="fa fa-check"></i><b>16.6</b> Example 1 – A random intercepts and slopes explainer (demo1)</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="lmm.html"><a href="lmm.html#batched-measurements-result-in-clustered-residuals"><i class="fa fa-check"></i><b>16.6.1</b> Batched measurements result in clustered residuals</a></li>
<li class="chapter" data-level="16.6.2" data-path="lmm.html"><a href="lmm.html#lmm-corerr"><i class="fa fa-check"></i><b>16.6.2</b> Clustered residuals result in correlated error</a></li>
<li class="chapter" data-level="16.6.3" data-path="lmm.html"><a href="lmm.html#in-blocked-designs-clustered-residuals-adds-a-variance-component-that-masks-treatment-effects"><i class="fa fa-check"></i><b>16.6.3</b> In blocked designs, clustered residuals adds a variance component that masks treatment effects</a></li>
<li class="chapter" data-level="16.6.4" data-path="lmm.html"><a href="lmm.html#linear-mixed-models-are-linear-models-with-added-random-factors"><i class="fa fa-check"></i><b>16.6.4</b> Linear mixed models are linear models with added random factors</a></li>
<li class="chapter" data-level="16.6.5" data-path="lmm.html"><a href="lmm.html#what-the-random-effects-are"><i class="fa fa-check"></i><b>16.6.5</b> What the random effects are</a></li>
<li class="chapter" data-level="16.6.6" data-path="lmm.html"><a href="lmm.html#in-a-blocked-design-a-linear-model-with-added-random-effects-increases-precision-of-treatment-effects"><i class="fa fa-check"></i><b>16.6.6</b> In a blocked design, a linear model with added random effects increases precision of treatment effects</a></li>
<li class="chapter" data-level="16.6.7" data-path="lmm.html"><a href="lmm.html#lmm-varcorr"><i class="fa fa-check"></i><b>16.6.7</b> The correlation among random intercepts and slopes</a></li>
<li class="chapter" data-level="16.6.8" data-path="lmm.html"><a href="lmm.html#clustered-residuals-create-heterogeneity-among-treatments"><i class="fa fa-check"></i><b>16.6.8</b> Clustered residuals create heterogeneity among treatments</a></li>
<li class="chapter" data-level="16.6.9" data-path="lmm.html"><a href="lmm.html#linear-mixed-models-are-flexible"><i class="fa fa-check"></i><b>16.6.9</b> Linear mixed models are flexible</a></li>
<li class="chapter" data-level="16.6.10" data-path="lmm.html"><a href="lmm.html#a-random-intercept-only-model"><i class="fa fa-check"></i><b>16.6.10</b> A random intercept only model</a></li>
<li class="chapter" data-level="16.6.11" data-path="lmm.html"><a href="lmm.html#a-model-including-an-interaction-intercept"><i class="fa fa-check"></i><b>16.6.11</b> A model including an interaction intercept</a></li>
<li class="chapter" data-level="16.6.12" data-path="lmm.html"><a href="lmm.html#lmm-demo-aic"><i class="fa fa-check"></i><b>16.6.12</b> AIC and model selection – which model to report?</a></li>
<li class="chapter" data-level="16.6.13" data-path="lmm.html"><a href="lmm.html#the-specification-of-random-effects-matters"><i class="fa fa-check"></i><b>16.6.13</b> The specification of random effects matters</a></li>
<li class="chapter" data-level="16.6.14" data-path="lmm.html"><a href="lmm.html#mixed-effect-and-repeated-measures-anova"><i class="fa fa-check"></i><b>16.6.14</b> Mixed Effect and Repeated Measures ANOVA</a></li>
<li class="chapter" data-level="16.6.15" data-path="lmm.html"><a href="lmm.html#pseudoreplication"><i class="fa fa-check"></i><b>16.6.15</b> Pseudoreplication</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="lmm.html"><a href="lmm.html#lmm-example2"><i class="fa fa-check"></i><b>16.7</b> Example 2 – experiments without subsampling replication (exp6g)</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="lmm.html"><a href="lmm.html#understand-the-data"><i class="fa fa-check"></i><b>16.7.1</b> Understand the data</a></li>
<li class="chapter" data-level="16.7.2" data-path="lmm.html"><a href="lmm.html#model-fit-and-inference"><i class="fa fa-check"></i><b>16.7.2</b> Model fit and inference</a></li>
<li class="chapter" data-level="16.7.3" data-path="lmm.html"><a href="lmm.html#the-model-exp6g_m1-adds-a-random-intercept-but-not-a-random-slope"><i class="fa fa-check"></i><b>16.7.3</b> The model exp6g_m1 adds a random intercept but not a random slope</a></li>
<li class="chapter" data-level="16.7.4" data-path="lmm.html"><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp6g_m1"><i class="fa fa-check"></i><b>16.7.4</b> The fixed effect coefficients of model exp6g_m1</a></li>
<li class="chapter" data-level="16.7.5" data-path="lmm.html"><a href="lmm.html#the-random-intercept-coefficients-of-exp6g_m1"><i class="fa fa-check"></i><b>16.7.5</b> The random intercept coefficients of exp6g_m1</a></li>
<li class="chapter" data-level="16.7.6" data-path="lmm.html"><a href="lmm.html#the-random-and-residual-variance-and-the-intraclass-correlation-of-model-exp6g_m1"><i class="fa fa-check"></i><b>16.7.6</b> The random and residual variance and the intraclass correlation of model exp6g_m1</a></li>
<li class="chapter" data-level="16.7.7" data-path="lmm.html"><a href="lmm.html#the-linear-mixed-model-exp6g_m1-increases-precision-of-treatment-effects-relative-to-a-fixed-effects-model"><i class="fa fa-check"></i><b>16.7.7</b> The linear mixed model exp6g_m1 increases precision of treatment effects, relative to a fixed effects model</a></li>
<li class="chapter" data-level="16.7.8" data-path="lmm.html"><a href="lmm.html#lmm-exp6g-alt"><i class="fa fa-check"></i><b>16.7.8</b> Alternative models for exp6g</a></li>
<li class="chapter" data-level="16.7.9" data-path="lmm.html"><a href="lmm.html#paired-t-tests-and-repeated-measures-anova-are-special-cases-of-linear-mixed-models"><i class="fa fa-check"></i><b>16.7.9</b> Paired t-tests and repeated measures ANOVA are special cases of linear mixed models</a></li>
<li class="chapter" data-level="16.7.10" data-path="lmm.html"><a href="lmm.html#lmm-exp6g-rmanova"><i class="fa fa-check"></i><b>16.7.10</b> Classical (“univariate model”) repeated measures ANOVA of exp6g</a></li>
<li class="chapter" data-level="16.7.11" data-path="lmm.html"><a href="lmm.html#lmm-exp6g-rmanova-multi"><i class="fa fa-check"></i><b>16.7.11</b> “Multivariate model” repeated measures ANOVA</a></li>
<li class="chapter" data-level="16.7.12" data-path="lmm.html"><a href="lmm.html#linear-mixed-models-vs-repeated-measures-anova"><i class="fa fa-check"></i><b>16.7.12</b> Linear mixed models vs repeated measures ANOVA</a></li>
<li class="chapter" data-level="16.7.13" data-path="lmm.html"><a href="lmm.html#modeling-textttmouse_id-as-a-fixed-effect"><i class="fa fa-check"></i><b>16.7.13</b> Modeling <span class="math inline">\(\texttt{mouse_id}\)</span> as a fixed effect</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="lmm.html"><a href="lmm.html#example-3-factorial-experiments-and-no-subsampling-replicates-exp5c"><i class="fa fa-check"></i><b>16.8</b> Example 3 – Factorial experiments and no subsampling replicates (exp5c)</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="lmm.html"><a href="lmm.html#understand-the-data-1"><i class="fa fa-check"></i><b>16.8.1</b> Understand the data</a></li>
<li class="chapter" data-level="16.8.2" data-path="lmm.html"><a href="lmm.html#examine-the-data-1"><i class="fa fa-check"></i><b>16.8.2</b> Examine the data</a></li>
<li class="chapter" data-level="16.8.3" data-path="lmm.html"><a href="lmm.html#lmm-exp5c-m1"><i class="fa fa-check"></i><b>16.8.3</b> Model fit and inference</a></li>
<li class="chapter" data-level="16.8.4" data-path="lmm.html"><a href="lmm.html#why-we-care-about-modeling-batch-in-exp5c"><i class="fa fa-check"></i><b>16.8.4</b> Why we care about modeling batch in exp5c</a></li>
<li class="chapter" data-level="16.8.5" data-path="lmm.html"><a href="lmm.html#the-linear-mixed-model-exp5c_m1-adds-two-random-intercepts"><i class="fa fa-check"></i><b>16.8.5</b> The linear mixed model exp5c_m1 adds two random intercepts</a></li>
<li class="chapter" data-level="16.8.6" data-path="lmm.html"><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp5c_m1"><i class="fa fa-check"></i><b>16.8.6</b> The fixed effect coefficients of model exp5c_m1</a></li>
<li class="chapter" data-level="16.8.7" data-path="lmm.html"><a href="lmm.html#the-random-effect-coefficients-of-model-exp5c_m1"><i class="fa fa-check"></i><b>16.8.7</b> The random effect coefficients of model exp5c_m1</a></li>
<li class="chapter" data-level="16.8.8" data-path="lmm.html"><a href="lmm.html#lmm-exp5c-alt"><i class="fa fa-check"></i><b>16.8.8</b> Alternative models for exp5c</a></li>
<li class="chapter" data-level="16.8.9" data-path="lmm.html"><a href="lmm.html#lmm-rmanova-5c"><i class="fa fa-check"></i><b>16.8.9</b> Classical (“univariate model”) repeated measures ANOVA</a></li>
<li class="chapter" data-level="16.8.10" data-path="lmm.html"><a href="lmm.html#lmm-rmanova-5c-multi"><i class="fa fa-check"></i><b>16.8.10</b> “Multivariate model” repeated measures ANOVA of exp5c</a></li>
<li class="chapter" data-level="16.8.11" data-path="lmm.html"><a href="lmm.html#modeling-textttdonor-as-a-fixed-effect"><i class="fa fa-check"></i><b>16.8.11</b> Modeling <span class="math inline">\(\texttt{donor}\)</span> as a fixed effect</a></li>
</ul></li>
<li class="chapter" data-level="16.9" data-path="lmm.html"><a href="lmm.html#lmm-example4"><i class="fa fa-check"></i><b>16.9</b> Example 4 – Experiments with subsampling replication (exp1g)</a>
<ul>
<li class="chapter" data-level="16.9.1" data-path="lmm.html"><a href="lmm.html#understand-the-data-2"><i class="fa fa-check"></i><b>16.9.1</b> Understand the data</a></li>
<li class="chapter" data-level="16.9.2" data-path="lmm.html"><a href="lmm.html#examine-the-data-2"><i class="fa fa-check"></i><b>16.9.2</b> Examine the data</a></li>
<li class="chapter" data-level="16.9.3" data-path="lmm.html"><a href="lmm.html#fit-the-model-9"><i class="fa fa-check"></i><b>16.9.3</b> Fit the model</a></li>
<li class="chapter" data-level="16.9.4" data-path="lmm.html"><a href="lmm.html#inference-from-the-model-6"><i class="fa fa-check"></i><b>16.9.4</b> Inference from the model</a></li>
<li class="chapter" data-level="16.9.5" data-path="lmm.html"><a href="lmm.html#plot-the-model-6"><i class="fa fa-check"></i><b>16.9.5</b> Plot the model</a></li>
<li class="chapter" data-level="16.9.6" data-path="lmm.html"><a href="lmm.html#alternaplot-the-model-3"><i class="fa fa-check"></i><b>16.9.6</b> Alternaplot the model</a></li>
<li class="chapter" data-level="16.9.7" data-path="lmm.html"><a href="lmm.html#understanding-the-alternative-models"><i class="fa fa-check"></i><b>16.9.7</b> Understanding the alternative models</a></li>
<li class="chapter" data-level="16.9.8" data-path="lmm.html"><a href="lmm.html#the-varcorr-matrix-of-models-exp1g_m1a-and-exp1g_m1b"><i class="fa fa-check"></i><b>16.9.8</b> The VarCorr matrix of models exp1g_m1a and exp1g_m1b</a></li>
<li class="chapter" data-level="16.9.9" data-path="lmm.html"><a href="lmm.html#the-linear-mixed-model-has-more-precision-and-power-than-the-fixed-effect-model-of-batch-means"><i class="fa fa-check"></i><b>16.9.9</b> The linear mixed model has more precision and power than the fixed effect model of batch means</a></li>
<li class="chapter" data-level="16.9.10" data-path="lmm.html"><a href="lmm.html#fixed-effect-models-and-pseudoreplication"><i class="fa fa-check"></i><b>16.9.10</b> Fixed effect models and pseudoreplication</a></li>
<li class="chapter" data-level="16.9.11" data-path="lmm.html"><a href="lmm.html#mixed-effect-anova"><i class="fa fa-check"></i><b>16.9.11</b> Mixed-effect ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="16.10" data-path="lmm.html"><a href="lmm.html#statistical-models-for-experimental-designs"><i class="fa fa-check"></i><b>16.10</b> Statistical models for experimental designs</a>
<ul>
<li class="chapter" data-level="16.10.1" data-path="lmm.html"><a href="lmm.html#models-for-completely-randomized-designs-crd"><i class="fa fa-check"></i><b>16.10.1</b> Models for Completely Randomized Designs (CRD)</a></li>
<li class="chapter" data-level="16.10.2" data-path="lmm.html"><a href="lmm.html#models-for-batched-data-crds-rcbd-rspd-grcbd-nrcbd"><i class="fa fa-check"></i><b>16.10.2</b> Models for batched data (CRDS, RCBD, RSPD, GRCBD, NRCBD)</a></li>
</ul></li>
<li class="chapter" data-level="16.11" data-path="lmm.html"><a href="lmm.html#which-model-and-why"><i class="fa fa-check"></i><b>16.11</b> Which model and why?</a>
<ul>
<li class="chapter" data-level="16.11.1" data-path="lmm.html"><a href="lmm.html#crd"><i class="fa fa-check"></i><b>16.11.1</b> CRD</a></li>
<li class="chapter" data-level="16.11.2" data-path="lmm.html"><a href="lmm.html#crds"><i class="fa fa-check"></i><b>16.11.2</b> CRDS</a></li>
<li class="chapter" data-level="16.11.3" data-path="lmm.html"><a href="lmm.html#rcbd"><i class="fa fa-check"></i><b>16.11.3</b> RCBD</a></li>
<li class="chapter" data-level="16.11.4" data-path="lmm.html"><a href="lmm.html#rspd"><i class="fa fa-check"></i><b>16.11.4</b> RSPD</a></li>
<li class="chapter" data-level="16.11.5" data-path="lmm.html"><a href="lmm.html#rcbds"><i class="fa fa-check"></i><b>16.11.5</b> RCBDS</a></li>
<li class="chapter" data-level="16.11.6" data-path="lmm.html"><a href="lmm.html#grcbd"><i class="fa fa-check"></i><b>16.11.6</b> GRCBD</a></li>
<li class="chapter" data-level="16.11.7" data-path="lmm.html"><a href="lmm.html#grcbds"><i class="fa fa-check"></i><b>16.11.7</b> GRCBDS</a></li>
</ul></li>
<li class="chapter" data-level="16.12" data-path="lmm.html"><a href="lmm.html#working-in-r-5"><i class="fa fa-check"></i><b>16.12</b> Working in R</a>
<ul>
<li class="chapter" data-level="16.12.1" data-path="lmm.html"><a href="lmm.html#plotting-models-fit-to-batched-data"><i class="fa fa-check"></i><b>16.12.1</b> Plotting models fit to batched data</a></li>
<li class="chapter" data-level="16.12.2" data-path="lmm.html"><a href="lmm.html#repeated-measures-anova-randomized-complete-block-with-no-subsampling"><i class="fa fa-check"></i><b>16.12.2</b> Repeated measures ANOVA (randomized complete block with no subsampling)</a></li>
</ul></li>
<li class="chapter" data-level="16.13" data-path="lmm.html"><a href="lmm.html#hidden-code-7"><i class="fa fa-check"></i><b>16.13</b> Hidden code</a>
<ul>
<li class="chapter" data-level="16.13.1" data-path="lmm.html"><a href="lmm.html#import-exp5c"><i class="fa fa-check"></i><b>16.13.1</b> Import exp5c</a></li>
<li class="chapter" data-level="16.13.2" data-path="lmm.html"><a href="lmm.html#import-exp1g"><i class="fa fa-check"></i><b>16.13.2</b> Import exp1g</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="pre-post.html"><a href="pre-post.html"><i class="fa fa-check"></i><b>17</b> Linear models for longitudinal experiments – I. pre-post designs</a>
<ul>
<li class="chapter" data-level="17.1" data-path="pre-post.html"><a href="pre-post.html#best-practice-models"><i class="fa fa-check"></i><b>17.1</b> Best practice models</a></li>
<li class="chapter" data-level="17.2" data-path="pre-post.html"><a href="pre-post.html#common-alternatives-that-are-not-recommended"><i class="fa fa-check"></i><b>17.2</b> Common alternatives that are not recommended</a></li>
<li class="chapter" data-level="17.3" data-path="pre-post.html"><a href="pre-post.html#advanced-models"><i class="fa fa-check"></i><b>17.3</b> Advanced models</a></li>
<li class="chapter" data-level="17.4" data-path="pre-post.html"><a href="pre-post.html#understanding-the-alternative-models-1"><i class="fa fa-check"></i><b>17.4</b> Understanding the alternative models</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="pre-post.html"><a href="pre-post.html#m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model"><i class="fa fa-check"></i><b>17.4.1</b> (M1) Linear model with the baseline measure as the covariate (ANCOVA model)</a></li>
<li class="chapter" data-level="17.4.2" data-path="pre-post.html"><a href="pre-post.html#m2-linear-model-of-the-change-score-change-score-model"><i class="fa fa-check"></i><b>17.4.2</b> (M2) Linear model of the change score (change-score model)</a></li>
<li class="chapter" data-level="17.4.3" data-path="pre-post.html"><a href="pre-post.html#m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model"><i class="fa fa-check"></i><b>17.4.3</b> (M3) Linear model of post-baseline values without the baseline as a covariate (post model)</a></li>
<li class="chapter" data-level="17.4.4" data-path="pre-post.html"><a href="pre-post.html#m4-linear-model-with-factorial-fixed-effects-fixed-effects-model"><i class="fa fa-check"></i><b>17.4.4</b> (M4) Linear model with factorial fixed effects (fixed-effects model)</a></li>
<li class="chapter" data-level="17.4.5" data-path="pre-post.html"><a href="pre-post.html#m5-repeated-measures-anova"><i class="fa fa-check"></i><b>17.4.5</b> (M5) Repeated measures ANOVA</a></li>
<li class="chapter" data-level="17.4.6" data-path="pre-post.html"><a href="pre-post.html#m6-linear-mixed-model"><i class="fa fa-check"></i><b>17.4.6</b> (M6) Linear mixed model</a></li>
<li class="chapter" data-level="17.4.7" data-path="pre-post.html"><a href="pre-post.html#m7-linear-model-with-correlated-error"><i class="fa fa-check"></i><b>17.4.7</b> (M7) Linear model with correlated error</a></li>
<li class="chapter" data-level="17.4.8" data-path="pre-post.html"><a href="pre-post.html#m8-constrained-fixed-effects-model-with-correlated-error-clda-model"><i class="fa fa-check"></i><b>17.4.8</b> (M8) Constrained fixed effects model with correlated error (cLDA model)</a></li>
<li class="chapter" data-level="17.4.9" data-path="pre-post.html"><a href="pre-post.html#comparison-table"><i class="fa fa-check"></i><b>17.4.9</b> Comparison table</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="pre-post.html"><a href="pre-post.html#example-1-a-single-post-baseline-measure-pre-post-design"><i class="fa fa-check"></i><b>17.5</b> Example 1 – a single post-baseline measure (pre-post design)</a></li>
<li class="chapter" data-level="17.6" data-path="pre-post.html"><a href="pre-post.html#working-in-r-6"><i class="fa fa-check"></i><b>17.6</b> Working in R</a></li>
<li class="chapter" data-level="17.7" data-path="pre-post.html"><a href="pre-post.html#hidden-code-8"><i class="fa fa-check"></i><b>17.7</b> Hidden code</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="pre-post.html"><a href="pre-post.html#import-and-wrangle-mouse-sociability-data"><i class="fa fa-check"></i><b>17.7.1</b> Import and wrangle mouse sociability data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="counts.html"><a href="counts.html"><i class="fa fa-check"></i><b>18</b> Linear models for counts, binary responses, skewed responses, and ratios – Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="18.1" data-path="counts.html"><a href="counts.html#glm-counts"><i class="fa fa-check"></i><b>18.1</b> Introducing Generalized Linear Models using count data examples</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="counts.html"><a href="counts.html#the-generalized-linear-model-glm"><i class="fa fa-check"></i><b>18.1.1</b> The Generalized Linear Model (GLM)</a></li>
<li class="chapter" data-level="18.1.2" data-path="counts.html"><a href="counts.html#kinds-of-data-that-are-modeled-by-a-glm"><i class="fa fa-check"></i><b>18.1.2</b> Kinds of data that are modeled by a GLM</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="counts.html"><a href="counts.html#glm-1"><i class="fa fa-check"></i><b>18.2</b> Example 1 – GLM models for count responses (“angiogenic sprouts” fig3a)</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="counts.html"><a href="counts.html#understand-the-data-3"><i class="fa fa-check"></i><b>18.2.1</b> Understand the data</a></li>
<li class="chapter" data-level="18.2.2" data-path="counts.html"><a href="counts.html#model-fit-and-inference-1"><i class="fa fa-check"></i><b>18.2.2</b> Model fit and inference</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="counts.html"><a href="counts.html#understanding-example-1"><i class="fa fa-check"></i><b>18.3</b> Understanding Example 1</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="counts.html"><a href="counts.html#modeling-strategy-1"><i class="fa fa-check"></i><b>18.3.1</b> Modeling strategy</a></li>
<li class="chapter" data-level="18.3.2" data-path="counts.html"><a href="counts.html#model-checking-fits-to-count-data"><i class="fa fa-check"></i><b>18.3.2</b> Model checking fits to count data</a></li>
<li class="chapter" data-level="18.3.3" data-path="counts.html"><a href="counts.html#biological-count-data-are-rarely-fit-well-by-a-poisson-glm.-instead-fit-a-quasi-poisson-or-negative-binomial-glm-model."><i class="fa fa-check"></i><b>18.3.3</b> Biological count data are rarely fit well by a Poisson GLM. Instead, fit a quasi-poisson or negative binomial GLM model.</a></li>
<li class="chapter" data-level="18.3.4" data-path="counts.html"><a href="counts.html#a-glm-is-a-linear-model-on-the-link-scale"><i class="fa fa-check"></i><b>18.3.4</b> A GLM is a linear model on the link scale</a></li>
<li class="chapter" data-level="18.3.5" data-path="counts.html"><a href="counts.html#coeffecients-of-a-generalized-linear-model-with-a-log-link-function-are-on-the-link-scale."><i class="fa fa-check"></i><b>18.3.5</b> Coeffecients of a Generalized Linear Model with a log-link function are on the link scale.</a></li>
<li class="chapter" data-level="18.3.6" data-path="counts.html"><a href="counts.html#modeled-means-in-the-emmeans-table-of-a-generalized-linear-model-can-be-on-the-link-scale-or-response-scale-report-the-response-scale"><i class="fa fa-check"></i><b>18.3.6</b> Modeled means in the emmeans table of a Generalized Linear Model can be on the link scale or response scale – Report the response scale</a></li>
<li class="chapter" data-level="18.3.7" data-path="counts.html"><a href="counts.html#some-consequences-of-fitting-a-linear-model-to-count-data"><i class="fa fa-check"></i><b>18.3.7</b> Some consequences of fitting a linear model to count data</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="counts.html"><a href="counts.html#example-2-use-a-glm-with-an-offset-instead-of-a-ratio-of-some-measurement-per-total-dna-damage-data-fig3b-glm_offset"><i class="fa fa-check"></i><b>18.4</b> Example 2 – Use a GLM with an offset instead of a ratio of some measurement per total (“dna damage” data fig3b) #glm_offset</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="counts.html"><a href="counts.html#fig3b-dna-damage-data"><i class="fa fa-check"></i><b>18.4.1</b> fig3b (“dna damage”) data</a></li>
<li class="chapter" data-level="18.4.2" data-path="counts.html"><a href="counts.html#understand-the-data-4"><i class="fa fa-check"></i><b>18.4.2</b> Understand the data</a></li>
<li class="chapter" data-level="18.4.3" data-path="counts.html"><a href="counts.html#model-fit-and-inference-2"><i class="fa fa-check"></i><b>18.4.3</b> Model fit and inference</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="counts.html"><a href="counts.html#understanding-example-2"><i class="fa fa-check"></i><b>18.5</b> Understanding Example 2</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="counts.html"><a href="counts.html#an-offset-is-an-added-covariate-with-a-coefficient-fixed-at-1"><i class="fa fa-check"></i><b>18.5.1</b> An offset is an added covariate with a coefficient fixed at 1</a></li>
<li class="chapter" data-level="18.5.2" data-path="counts.html"><a href="counts.html#glm-rate"><i class="fa fa-check"></i><b>18.5.2</b> A count GLM with an offset models the area-normalized means</a></li>
<li class="chapter" data-level="18.5.3" data-path="counts.html"><a href="counts.html#compare-an-offset-to-an-added-covariate-with-an-estimated-coefficient"><i class="fa fa-check"></i><b>18.5.3</b> Compare an offset to an added covariate with an estimated coefficient</a></li>
<li class="chapter" data-level="18.5.4" data-path="counts.html"><a href="counts.html#issues-with-plotting"><i class="fa fa-check"></i><b>18.5.4</b> Issues with plotting</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="counts.html"><a href="counts.html#example-3-glm-models-for-binary-responses"><i class="fa fa-check"></i><b>18.6</b> Example 3 – GLM models for binary responses</a></li>
<li class="chapter" data-level="18.7" data-path="counts.html"><a href="counts.html#working-in-r-7"><i class="fa fa-check"></i><b>18.7</b> Working in R</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="counts.html"><a href="counts.html#fitting-glms-to-count-data"><i class="fa fa-check"></i><b>18.7.1</b> Fitting GLMs to count data</a></li>
<li class="chapter" data-level="18.7.2" data-path="counts.html"><a href="counts.html#fitting-a-glm-to-a-continuous-conditional-response-with-right-skew."><i class="fa fa-check"></i><b>18.7.2</b> Fitting a GLM to a continuous conditional response with right skew.</a></li>
<li class="chapter" data-level="18.7.3" data-path="counts.html"><a href="counts.html#fitting-a-glm-to-a-binary-success-or-failure-presence-or-absence-survived-or-died-response"><i class="fa fa-check"></i><b>18.7.3</b> Fitting a GLM to a binary (success or failure, presence or absence, survived or died) response</a></li>
<li class="chapter" data-level="18.7.4" data-path="counts.html"><a href="counts.html#fitting-generalized-linear-mixed-models"><i class="fa fa-check"></i><b>18.7.4</b> Fitting Generalized Linear Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="counts.html"><a href="counts.html#model-checking-glms"><i class="fa fa-check"></i><b>18.8</b> Model checking GLMs</a></li>
<li class="chapter" data-level="18.9" data-path="counts.html"><a href="counts.html#hidden-code-9"><i class="fa fa-check"></i><b>18.9</b> Hidden code</a>
<ul>
<li class="chapter" data-level="18.9.1" data-path="counts.html"><a href="counts.html#import-example-1-data-fig3a-angiogenic-sprouts"><i class="fa fa-check"></i><b>18.9.1</b> Import Example 1 data (fig3a – “angiogenic sprouts”)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="gls.html"><a href="gls.html"><i class="fa fa-check"></i><b>19</b> Linear models with heterogenous variance</a></li>
<li class="chapter" data-level="" data-path="appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models.html"><a href="appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models.html"><i class="fa fa-check"></i>Appendix: An example set of analyses of experimental data with linear models</a></li>
<li class="chapter" data-level="20" data-path="ask1-bio.html"><a href="ask1-bio.html"><i class="fa fa-check"></i><b>20</b> Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li class="chapter" data-level="21" data-path="ask1-report.html"><a href="ask1-report.html"><i class="fa fa-check"></i><b>21</b> Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a>
<ul>
<li class="chapter" data-level="21.1" data-path="ask1-report.html"><a href="ask1-report.html#setup"><i class="fa fa-check"></i><b>21.1</b> Setup</a></li>
<li class="chapter" data-level="21.2" data-path="ask1-report.html"><a href="ask1-report.html#data-source"><i class="fa fa-check"></i><b>21.2</b> Data source</a></li>
<li class="chapter" data-level="21.3" data-path="ask1-report.html"><a href="ask1-report.html#control-the-color-palette"><i class="fa fa-check"></i><b>21.3</b> control the color palette</a></li>
<li class="chapter" data-level="21.4" data-path="ask1-report.html"><a href="ask1-report.html#useful-functions"><i class="fa fa-check"></i><b>21.4</b> useful functions</a></li>
<li class="chapter" data-level="21.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2b-effect-of-ask1-deletion-on-growth-body-weight"><i class="fa fa-check"></i><b>21.5</b> figure 2b – effect of ASK1 deletion on growth (body weight)</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2b-import"><i class="fa fa-check"></i><b>21.5.1</b> figure 2b – import</a></li>
<li class="chapter" data-level="21.5.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2b-exploratory-plots"><i class="fa fa-check"></i><b>21.5.2</b> figure 2b – exploratory plots</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-effect-of-ask1-deletion-on-final-body-weight"><i class="fa fa-check"></i><b>21.6</b> Figure 2c – Effect of ASK1 deletion on final body weight</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-import"><i class="fa fa-check"></i><b>21.6.1</b> Figure 2c – import</a></li>
<li class="chapter" data-level="21.6.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-check-own-computation-of-weight-change-v-imported-value"><i class="fa fa-check"></i><b>21.6.2</b> Figure 2c – check own computation of weight change v imported value</a></li>
<li class="chapter" data-level="21.6.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-exploratory-plots"><i class="fa fa-check"></i><b>21.6.3</b> Figure 2c – exploratory plots</a></li>
<li class="chapter" data-level="21.6.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-fit-the-model-m1-lm"><i class="fa fa-check"></i><b>21.6.4</b> Figure 2c – fit the model: m1 (lm)</a></li>
<li class="chapter" data-level="21.6.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-check-the-model-m1"><i class="fa fa-check"></i><b>21.6.5</b> Figure 2c – check the model: m1</a></li>
<li class="chapter" data-level="21.6.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-fit-the-model-m2-gamma-glm"><i class="fa fa-check"></i><b>21.6.6</b> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li class="chapter" data-level="21.6.7" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-check-the-model-m2"><i class="fa fa-check"></i><b>21.6.7</b> Figure 2c – check the model, m2</a></li>
<li class="chapter" data-level="21.6.8" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-inference-from-the-model"><i class="fa fa-check"></i><b>21.6.8</b> Figure 2c – inference from the model</a></li>
<li class="chapter" data-level="21.6.9" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-plot-the-model"><i class="fa fa-check"></i><b>21.6.9</b> Figure 2c – plot the model</a></li>
<li class="chapter" data-level="21.6.10" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-report"><i class="fa fa-check"></i><b>21.6.10</b> Figure 2c – report</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><i class="fa fa-check"></i><b>21.7</b> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a>
<ul>
<li class="chapter" data-level="21.7.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-import"><i class="fa fa-check"></i><b>21.7.1</b> Figure 2d – Import</a></li>
<li class="chapter" data-level="21.7.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-exploratory-plots"><i class="fa fa-check"></i><b>21.7.2</b> Figure 2d – exploratory plots</a></li>
<li class="chapter" data-level="21.7.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-fit-the-model"><i class="fa fa-check"></i><b>21.7.3</b> Figure 2d – fit the model</a></li>
<li class="chapter" data-level="21.7.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-check-the-model"><i class="fa fa-check"></i><b>21.7.4</b> Figure 2d – check the model</a></li>
<li class="chapter" data-level="21.7.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-inference"><i class="fa fa-check"></i><b>21.7.5</b> Figure 2d – inference</a></li>
<li class="chapter" data-level="21.7.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-plot-the-model"><i class="fa fa-check"></i><b>21.7.6</b> Figure 2d – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.8" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure"><i class="fa fa-check"></i><b>21.8</b> Figure 2e – Effect of ASK1 deletion on glucose tolerance (summary measure)</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-message-the-data"><i class="fa fa-check"></i><b>21.8.1</b> Figure 2e – message the data</a></li>
<li class="chapter" data-level="21.8.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-exploratory-plots"><i class="fa fa-check"></i><b>21.8.2</b> Figure 2e – exploratory plots</a></li>
<li class="chapter" data-level="21.8.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-fit-the-model"><i class="fa fa-check"></i><b>21.8.3</b> Figure 2e – fit the model</a></li>
<li class="chapter" data-level="21.8.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-check-the-model"><i class="fa fa-check"></i><b>21.8.4</b> Figure 2e – check the model</a></li>
<li class="chapter" data-level="21.8.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-inference-from-the-model"><i class="fa fa-check"></i><b>21.8.5</b> Figure 2e – inference from the model</a></li>
<li class="chapter" data-level="21.8.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-plot-the-model"><i class="fa fa-check"></i><b>21.8.6</b> Figure 2e – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate"><i class="fa fa-check"></i><b>21.9</b> Figure 2f – Effect of ASK1 deletion on glucose infusion rate</a>
<ul>
<li class="chapter" data-level="21.9.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-import"><i class="fa fa-check"></i><b>21.9.1</b> Figure 2f – import</a></li>
<li class="chapter" data-level="21.9.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-exploratory-plots"><i class="fa fa-check"></i><b>21.9.2</b> Figure 2f – exploratory plots</a></li>
<li class="chapter" data-level="21.9.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-fit-the-model"><i class="fa fa-check"></i><b>21.9.3</b> Figure 2f – fit the model</a></li>
<li class="chapter" data-level="21.9.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-check-the-model"><i class="fa fa-check"></i><b>21.9.4</b> Figure 2f – check the model</a></li>
<li class="chapter" data-level="21.9.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-inference"><i class="fa fa-check"></i><b>21.9.5</b> Figure 2f – inference</a></li>
<li class="chapter" data-level="21.9.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-plot-the-model"><i class="fa fa-check"></i><b>21.9.6</b> Figure 2f – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.10" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake"><i class="fa fa-check"></i><b>21.10</b> Figure 2g – Effect of ASK1 deletion on tissue-specific glucose uptake</a>
<ul>
<li class="chapter" data-level="21.10.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-import"><i class="fa fa-check"></i><b>21.10.1</b> Figure 2g – import</a></li>
<li class="chapter" data-level="21.10.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-exploratory-plots"><i class="fa fa-check"></i><b>21.10.2</b> Figure 2g – exploratory plots</a></li>
<li class="chapter" data-level="21.10.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-fit-the-model"><i class="fa fa-check"></i><b>21.10.3</b> Figure 2g – fit the model</a></li>
<li class="chapter" data-level="21.10.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-check-the-model"><i class="fa fa-check"></i><b>21.10.4</b> Figure 2g – check the model</a></li>
<li class="chapter" data-level="21.10.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-inference"><i class="fa fa-check"></i><b>21.10.5</b> Figure 2g – inference</a></li>
<li class="chapter" data-level="21.10.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-plot-the-model"><i class="fa fa-check"></i><b>21.10.6</b> Figure 2g – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.11" data-path="ask1-report.html"><a href="ask1-report.html#figure-2h"><i class="fa fa-check"></i><b>21.11</b> Figure 2h</a></li>
<li class="chapter" data-level="21.12" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-effect-of-ask1-deletion-on-liver-tg"><i class="fa fa-check"></i><b>21.12</b> Figure 2i – Effect of ASK1 deletion on liver TG</a>
<ul>
<li class="chapter" data-level="21.12.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-fit-the-model"><i class="fa fa-check"></i><b>21.12.1</b> Figure 2i – fit the model</a></li>
<li class="chapter" data-level="21.12.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-check-the-model"><i class="fa fa-check"></i><b>21.12.2</b> Figure 2i – check the model</a></li>
<li class="chapter" data-level="21.12.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-inference"><i class="fa fa-check"></i><b>21.12.3</b> Figure 2i – inference</a></li>
<li class="chapter" data-level="21.12.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-plot-the-model"><i class="fa fa-check"></i><b>21.12.4</b> Figure 2i – plot the model</a></li>
<li class="chapter" data-level="21.12.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-report-the-model"><i class="fa fa-check"></i><b>21.12.5</b> Figure 2i – report the model</a></li>
</ul></li>
<li class="chapter" data-level="21.13" data-path="ask1-report.html"><a href="ask1-report.html#figure-2j"><i class="fa fa-check"></i><b>21.13</b> Figure 2j</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="count-sim.html"><a href="count-sim.html"><i class="fa fa-check"></i><b>22</b> Simulations – Count data (alternatives to a t-test)</a>
<ul>
<li class="chapter" data-level="22.1" data-path="count-sim.html"><a href="count-sim.html#use-data-similar-to-figure-6f-from-example-1"><i class="fa fa-check"></i><b>22.1</b> Use data similar to Figure 6f from Example 1</a></li>
<li class="chapter" data-level="22.2" data-path="count-sim.html"><a href="count-sim.html#functions"><i class="fa fa-check"></i><b>22.2</b> Functions</a></li>
<li class="chapter" data-level="22.3" data-path="count-sim.html"><a href="count-sim.html#simulations"><i class="fa fa-check"></i><b>22.3</b> Simulations</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="count-sim.html"><a href="count-sim.html#type-i-pseudo-normal-distribution"><i class="fa fa-check"></i><b>22.3.1</b> Type I, Pseudo-Normal distribution</a></li>
<li class="chapter" data-level="22.3.2" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-equal-n"><i class="fa fa-check"></i><b>22.3.2</b> Type I, neg binom, equal n</a></li>
<li class="chapter" data-level="22.3.3" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-equal-n-small-theta"><i class="fa fa-check"></i><b>22.3.3</b> Type I, neg binom, equal n, small theta</a></li>
<li class="chapter" data-level="22.3.4" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-unequal-n"><i class="fa fa-check"></i><b>22.3.4</b> Type I, neg binom, unequal n</a></li>
<li class="chapter" data-level="22.3.5" data-path="count-sim.html"><a href="count-sim.html#power-pseudo-normal-distribution-equal-n"><i class="fa fa-check"></i><b>22.3.5</b> Power, Pseudo-Normal distribution, equal n</a></li>
<li class="chapter" data-level="22.3.6" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-equal-n"><i class="fa fa-check"></i><b>22.3.6</b> Power, neg binom, equal n</a></li>
<li class="chapter" data-level="22.3.7" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-small-theta"><i class="fa fa-check"></i><b>22.3.7</b> Power, neg binom, small theta</a></li>
<li class="chapter" data-level="22.3.8" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-unequal-n"><i class="fa fa-check"></i><b>22.3.8</b> Power, neg binom, unequal n</a></li>
<li class="chapter" data-level="22.3.9" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-unequal-n-unequal-theta"><i class="fa fa-check"></i><b>22.3.9</b> Power, neg binom, unequal n, unequal theta</a></li>
<li class="chapter" data-level="22.3.10" data-path="count-sim.html"><a href="count-sim.html#type-1-neg-binom-equal-n-unequal-theta"><i class="fa fa-check"></i><b>22.3.10</b> Type 1, neg binom, equal n, unequal theta</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="count-sim.html"><a href="count-sim.html#save-it-read-it"><i class="fa fa-check"></i><b>22.4</b> Save it, Read it</a></li>
<li class="chapter" data-level="22.5" data-path="count-sim.html"><a href="count-sim.html#analysis"><i class="fa fa-check"></i><b>22.5</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html"><i class="fa fa-check"></i>Appendix 1: Getting Started with R</a>
<ul>
<li class="chapter" data-level="22.6" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready"><i class="fa fa-check"></i><b>22.6</b> Get your computer ready</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-here"><i class="fa fa-check"></i><b>22.6.1</b> Start here</a></li>
<li class="chapter" data-level="22.6.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r"><i class="fa fa-check"></i><b>22.6.2</b> Install R</a></li>
<li class="chapter" data-level="22.6.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-studio"><i class="fa fa-check"></i><b>22.6.3</b> Install R Studio</a></li>
<li class="chapter" data-level="22.6.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-markdown-1"><i class="fa fa-check"></i><b>22.6.4</b> Install R Markdown</a></li>
<li class="chapter" data-level="22.6.5" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#optional-alternative-latex-installations"><i class="fa fa-check"></i><b>22.6.5</b> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-learning-r-studio"><i class="fa fa-check"></i><b>22.7</b> Start learning R Studio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><i class="fa fa-check"></i>Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics for the Bench Biologist</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="issues" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> Issues in inference<a href="issues.html#issues" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div style="background-color:#fde0dd; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>All updates to this book are now at <a href="https://middleprofessor.github.io/benchbiostats/">https://middleprofessor.github.io/benchbiostats/</a></p>
</div>
<div id="replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Replicated experiments – include <span class="math inline">\(\texttt{Experiment}\)</span> as a random factor (better than one-way ANOVA of means)<a href="issues.html#replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Replicated experiments are the norm in bench biology. Researchers most commonly 1) analyze the mean response from each replicate, 2) pool all the data, ignoring that they come from multiple, independent experiments, or 3) analyze a “representive” experiment.</p>
<p>The best practice for analyzing data from multiple, independent experiments, one that is almost never used outside of certain subfields where pipelines for this alternative exist, is a <strong>linear mixed model</strong> with the experiment id added as a random factor. A <strong>mixed-effect</strong> or <strong>repeated measures</strong> ANOVA is equivalent to one version of this kind of linear model. The analysis of data from pooled independent experiments with a linear mixed model is a best practice because it increases precision and power relative to a <em>t</em>-test/ANOVA of experiment means and avoids <strong>pseudoreplication</strong>.</p>
<p>It’s important to understand the assumptions of the different models for analyzing replicated experiments. In a study with multiple, replicated experiments, the replications are “independent” – solutions are re-made, instruments have drifted and are re-calibrated, the grad student doing the work has lived another day. Each experiment has a unique set of factors that contribute to the error variance of the response variable. All measures within an experiment share the component of the error variance unique to that experiment and, as a consequence, the error (residuals) within an experiment are more similar to each other than they are to the residuals between experiments. This is a violation of the independent sampling assumption of the linear model and the lack of independence creates <strong>correlated error</strong>. The consequences of this on the three analyses are:</p>
<ol style="list-style-type: decimal">
<li>Linear model/<em>t</em>-test/ANOVA of pooled data ignoring experiment. This model assumes perfect replication between experiments, that essentially, the world was exactly the same for each. If this assumption is true, each replicate within each experiment is an <em>independent</em> data point. A study with n = 5 mice per treatment replicated five times has n = 25. If there are two treatment levels, the <em>t</em>-test will have 48 df. But, if the measures within an experiment share a common source contributing to the variance of the response within that experiment (the temperature in the room was 1°C cooler causing a machine to give a slightly different reading), there are not 25 independent measures because the five measures within each experiment are not independendent. The true df will be less than 48, how much less depends on the magnitude of the correlated error resulting from the non-independence. Pooling data across experiments with correlated error creates an incorrectly small standard error of the mean, resulting in incorrectly narrow confidence intervals and incorrectly small <em>p</em>-values. Pooling data inflates false discovery.</li>
<li>Linear model/<em>t</em>-test/ANOVA of experiment means. Analysis of the means violates the independence assumption because the means of the treatment levels within an independent experiment are expected to share common sources of measure variability of that experiment. Instead of inflating false discovery, this correlated error generally works against discovery. The correlated error among the means can be modeled to increase precision and gain power.</li>
<li>Linear model of the experiment means with <span class="math inline">\(\texttt{experiment_id}\)</span> added as a random factor to account for correlated error due to the unique sources of variance within each experiment. This model is equivalent to a <strong>mixed effect ANOVA</strong> of the full data set.</li>
</ol>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>Reproducibility blues. Researchers are improving best practices by archiving data on public servers. Nevertheless, it is extremely rare to find the full data for many experiments. For analyses of the means from multiple experiments, researchers almost always archive the means – the data are <strong>means pooled</strong> – and not the full set of measurements from each experiment. Or, the full data are archived but the experiment id is not included – the data are <strong>complete pooled</strong>. There is no way to truly replicate a result if only the means are archived (were the means computed correctly?). And, there is no way to re-analyze the data with alternative models that require the full data with the experiment identified.</p>
</div>
<div id="issues-exp4d" class="section level3 hasAnchor" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Multiple experiments Example 1 (wound healing Exp4d)<a href="issues.html#issues-exp4d" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Article source: <a href="https://elifesciences.org/articles/45976" target="_blank">Distinct inflammatory and wound healing responses to complex caudal fin injuries of larval zebrafish</a></p>
<p><a href="https://elifesciences.org/download/aHR0cHM6Ly9jZG4uZWxpZmVzY2llbmNlcy5vcmcvYXJ0aWNsZXMvNDU5NzYvZWxpZmUtNDU5NzYtZmlnNC1kYXRhMi12MS54bHN4/elife-45976-fig4-data2-v1.xlsx?_hash=Rr9mVyxyYK07xI0hnatjGDQjIMXR4LNrn01cfekuF%2B0%3D">data source</a></p>
<p>The experiment was designed to estimate the effect of a STAT3(<a href="https://en.wikipedia.org/wiki/STAT3" class="uri">https://en.wikipedia.org/wiki/STAT3</a>){target=“_blank”} <a href="https://en.wikipedia.org/wiki/Gene_knockout" target="_blank">knockout</a> on the number of cells expressing the cytoskeletal protein <a href="https://en.wikipedia.org/wiki/Vimentin" target="_blank">vimentin</a> in the wounded tissue.</p>
<p>Following Fisher, we can be more confident of an effect if we consistently get small <em>p</em>-values from replicate experiments.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="issues.html#cb347-1" tabindex="-1"></a>ids <span class="ot">&lt;-</span> <span class="fu">levels</span>(exp4d[, experiment_id])</span>
<span id="cb347-2"><a href="issues.html#cb347-2" tabindex="-1"></a>n_exp <span class="ot">&lt;-</span> <span class="fu">length</span>(ids)</span>
<span id="cb347-3"><a href="issues.html#cb347-3" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb347-4"><a href="issues.html#cb347-4" tabindex="-1"></a><span class="cf">for</span>(exp_i <span class="cf">in</span> ids){</span>
<span id="cb347-5"><a href="issues.html#cb347-5" tabindex="-1"></a>  exp4d_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(vimentin_cells <span class="sc">~</span> genotype,</span>
<span id="cb347-6"><a href="issues.html#cb347-6" tabindex="-1"></a>           <span class="at">data =</span> exp4d[experiment_id <span class="sc">==</span> exp_i,]) <span class="co"># subset</span></span>
<span id="cb347-7"><a href="issues.html#cb347-7" tabindex="-1"></a>  exp4d_m1_test <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(exp4d_m1))</span>
<span id="cb347-8"><a href="issues.html#cb347-8" tabindex="-1"></a>  p[[exp_i]] <span class="ot">&lt;-</span> exp4d_m1_test[<span class="st">&quot;genotypeSTAT3_ko&quot;</span>, <span class="st">&quot;Pr(&gt;|t|)&quot;</span>]</span>
<span id="cb347-9"><a href="issues.html#cb347-9" tabindex="-1"></a>}</span>
<span id="cb347-10"><a href="issues.html#cb347-10" tabindex="-1"></a></span>
<span id="cb347-11"><a href="issues.html#cb347-11" tabindex="-1"></a><span class="fu">data.table</span>(</span>
<span id="cb347-12"><a href="issues.html#cb347-12" tabindex="-1"></a>  <span class="at">experiment =</span> ids,</span>
<span id="cb347-13"><a href="issues.html#cb347-13" tabindex="-1"></a>  <span class="at">p =</span> <span class="fu">unlist</span>(p)</span>
<span id="cb347-14"><a href="issues.html#cb347-14" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb347-15"><a href="issues.html#cb347-15" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb347-16"><a href="issues.html#cb347-16" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;P-values from the three independent experients of the exp4d data.&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb347-17"><a href="issues.html#cb347-17" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:issues-combined-p-values">Table 13.1: </span><span id="tab:issues-combined-p-values">Table 13.2: </span>P-values from the three independent experients of the exp4d data.
</caption>
<thead>
<tr>
<th style="text-align:left;">
experiment
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Exp1
</td>
<td style="text-align:right;">
0.023
</td>
</tr>
<tr>
<td style="text-align:left;">
Exp2
</td>
<td style="text-align:right;">
0.022
</td>
</tr>
<tr>
<td style="text-align:left;">
Exp3
</td>
<td style="text-align:right;">
0.017
</td>
</tr>
</tbody>
</table>
<p>There are methods for <em>combining p-values</em> but we do not need to do this because we have the raw data.</p>
</div>
<div id="issues-combined-experiments" class="section level3 hasAnchor" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> Models for combining replicated experiments<a href="issues.html#issues-combined-experiments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A linear mixed model for combining replicated experiments is most easily fit using the <code>aov_4</code> function from the afex package. The <code>aov_4</code> function fits a <strong>mixed-effects ANOVA</strong> model, which is a factorial ANOVA that includes both fixed and random factors. In the Experiment 4d data, the variable <span class="math inline">\(\texttt{genotype}\)</span> is a fixed factor and the variable <span class="math inline">\(\texttt{experiment_id}\)</span> is a random factor. More information on fixed and random factors is given in the <a href="lmm.html#lmm">Linear Mixed Model chapter</a>.</p>
<p>The mixed-effect ANOVA models fit by <code>aov_4</code> are not linear mixed models but inference is equivalent in balanced designs – I give more detail below. The <code>aov_4</code> function uses a linear mixed model formula interface and is a useful substitute for actually fitting the equivalent linear mixed model because fitting a linear mixed model can be sensitive to the data and sometimes fails, even if the mixed-effect ANOVA model “works”.</p>
<p><strong>fit the model</strong></p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="issues.html#cb348-1" tabindex="-1"></a>exp4d_m1 <span class="ot">&lt;-</span> <span class="fu">aov_4</span>(vimentin_cells <span class="sc">~</span> genotype <span class="sc">+</span> (genotype <span class="sc">|</span> experiment_id),</span>
<span id="cb348-2"><a href="issues.html#cb348-2" tabindex="-1"></a>           <span class="at">data =</span> exp4d)</span></code></pre></div>
<p><strong>inference from the model</strong></p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="issues.html#cb349-1" tabindex="-1"></a>exp4d_m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(exp4d_m1, <span class="at">specs =</span> <span class="st">&quot;genotype&quot;</span>)</span>
<span id="cb349-2"><a href="issues.html#cb349-2" tabindex="-1"></a></span>
<span id="cb349-3"><a href="issues.html#cb349-3" tabindex="-1"></a>exp4d_m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(exp4d_m1_emm,</span>
<span id="cb349-4"><a href="issues.html#cb349-4" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb349-5"><a href="issues.html#cb349-5" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="issues.html#cb350-1" tabindex="-1"></a>exp4d_m1_pairs <span class="sc">%&gt;%</span></span>
<span id="cb350-2"><a href="issues.html#cb350-2" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb350-3"><a href="issues.html#cb350-3" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
STAT3_ko - STAT3_wt
</td>
<td style="text-align:right;">
-3.5
</td>
<td style="text-align:right;">
0.048
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-3.7
</td>
<td style="text-align:right;">
-3.29
</td>
<td style="text-align:right;">
-72.5
</td>
<td style="text-align:right;">
0.00019
</td>
</tr>
</tbody>
</table>
<p><strong>plot the model</strong></p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="issues.html#cb351-1" tabindex="-1"></a><span class="co"># wrangling to get this to work</span></span>
<span id="cb351-2"><a href="issues.html#cb351-2" tabindex="-1"></a><span class="co"># ggplot_the_response doesn&#39;t like the fit object from afex. That&#39;s okay,</span></span>
<span id="cb351-3"><a href="issues.html#cb351-3" tabindex="-1"></a><span class="co"># we use it only to get the individual points</span></span>
<span id="cb351-4"><a href="issues.html#cb351-4" tabindex="-1"></a>exp4d_m0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(vimentin_cells <span class="sc">~</span> genotype,</span>
<span id="cb351-5"><a href="issues.html#cb351-5" tabindex="-1"></a>           <span class="at">data =</span> exp4d)</span>
<span id="cb351-6"><a href="issues.html#cb351-6" tabindex="-1"></a>exp4d_m0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(vimentin_cells <span class="sc">~</span> genotype <span class="sc">*</span> experiment_id,</span>
<span id="cb351-7"><a href="issues.html#cb351-7" tabindex="-1"></a>           <span class="at">data =</span> exp4d)</span>
<span id="cb351-8"><a href="issues.html#cb351-8" tabindex="-1"></a>exp4d_m0_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(exp4d_m0, <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">&quot;genotype&quot;</span>, <span class="st">&quot;experiment_id&quot;</span>))</span>
<span id="cb351-9"><a href="issues.html#cb351-9" tabindex="-1"></a></span>
<span id="cb351-10"><a href="issues.html#cb351-10" tabindex="-1"></a><span class="fu">ggplot_the_response</span>(<span class="at">fit =</span> exp4d_m0,</span>
<span id="cb351-11"><a href="issues.html#cb351-11" tabindex="-1"></a>                    <span class="at">fit_emm =</span> exp4d_m0_emm,</span>
<span id="cb351-12"><a href="issues.html#cb351-12" tabindex="-1"></a>                    <span class="at">fit_pairs =</span> exp4d_m1_pairs,</span>
<span id="cb351-13"><a href="issues.html#cb351-13" tabindex="-1"></a>                    <span class="at">y_label =</span> <span class="st">&quot;vimGFP+ cell count&quot;</span>,</span>
<span id="cb351-14"><a href="issues.html#cb351-14" tabindex="-1"></a>                    <span class="at">palette =</span> pal_okabe_ito_blue)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/issues-exp4d-plot-1.png" width="576" /></p>
</div>
<div id="understanding-model-exp4d_m1" class="section level3 hasAnchor" number="13.1.3">
<h3><span class="header-section-number">13.1.3</span> Understanding Model <code>exp4d_m1</code><a href="issues.html#understanding-model-exp4d_m1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>The univariate and multivariate models fit by <code>AOV_4</code> gives researchers an easy tool in R for replicating ANOVA results from other software, such as Graphpad Prism or JMP. But it is really the contrasts that we want, not the ANOVA table, and we can get these contrasts by passing the <code>aov_4</code> object to <code>emmeans</code>.</li>
<li>The formula in Model <code>exp4d_m1</code> is misleading. The formula specifies a linear mixed model with a random intercept and a random slope (see <a href="#lmm%7D">Models with random factors – Blocking and pseudoreplication</a> but this is not the model that is fit.</li>
<li>The <code>aov_4</code> function actually fits two models.</li>
</ol>
<ul>
<li>A linear model of the aggregated data with adjusted degrees of freedom (the “aov” or <strong>univariate</strong> model). “Aggregated” data are the means of each treatment level within each experiment (the means-pooled data).</li>
<li>A <strong>multivariate</strong> linear model (the multivariate model) of the aggregated data. A multivariate model has multiple <em>Y</em> variables. For the exp4d data, each experiment (containing the means for each treatments) is a seperate <span class="math inline">\(Y\)</span> variable.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>The default output is the univariate model but the researcher can choose the multivariate model.</li>
</ol>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="issues.html#cb352-1" tabindex="-1"></a>exp4d_m1_pairs_multi <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(exp4d_m1,</span>
<span id="cb352-2"><a href="issues.html#cb352-2" tabindex="-1"></a>                                <span class="at">specs =</span> <span class="st">&quot;genotype&quot;</span>,</span>
<span id="cb352-3"><a href="issues.html#cb352-3" tabindex="-1"></a>                                <span class="at">model =</span> <span class="st">&quot;multivariate&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb352-4"><a href="issues.html#cb352-4" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb352-5"><a href="issues.html#cb352-5" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-157">Table 13.3: </span><span id="tab:unnamed-chunk-157">Table 13.4: </span>Contrasts from the univariate and multivarate models fit to the exp4d data.
</caption>
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr grouplength="1">
<td colspan="8" style="border-bottom: 1px solid;">
<strong>univariate model (m1)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
STAT3_ko - STAT3_wt
</td>
<td style="text-align:right;">
-3.5
</td>
<td style="text-align:right;">
0.048
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-3.7
</td>
<td style="text-align:right;">
-3.29
</td>
<td style="text-align:right;">
-72.52
</td>
<td style="text-align:right;">
0.00019
</td>
</tr>
<tr grouplength="1">
<td colspan="8" style="border-bottom: 1px solid;">
<strong>multivarite model (m2)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
STAT3_ko - STAT3_wt
</td>
<td style="text-align:right;">
-3.5
</td>
<td style="text-align:right;">
0.048
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-3.7
</td>
<td style="text-align:right;">
-3.29
</td>
<td style="text-align:right;">
-72.52
</td>
<td style="text-align:right;">
0.00019
</td>
</tr>
</tbody>
</table>
<ol start="5" style="list-style-type: decimal">
<li>The univariate and multivariate models are the same when there is only a single factor with two treatment levels, as with these data. Otherwise the two differ. See Section <a href="lmm.html#lmm-exp6g-rmanova">16.7.10</a> in the Linear Mixed Models chapter.</li>
<li>The univariate model is equivalent to the linear mixed model <code>exp4d_m2</code> (see next section) of the aggregated data if there are no missing data.</li>
<li>If there are the same number of replicates within all treatment by experiment combinations, then the univariate model is equivalent to the linear mixed model <code>exp4d_m3</code> of the full (not aggregated) data.</li>
</ol>
</div>
<div id="the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2" class="section level3 hasAnchor" number="13.1.4">
<h3><span class="header-section-number">13.1.4</span> The univariate model is equivalent to a linear mixed model of the aggregated data (Model exp4d_m2)<a href="issues.html#the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>aggregate the data</strong></p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="issues.html#cb353-1" tabindex="-1"></a><span class="co"># compute the experiment means</span></span>
<span id="cb353-2"><a href="issues.html#cb353-2" tabindex="-1"></a>exp4d_means <span class="ot">&lt;-</span> exp4d[, .(<span class="at">vimentin_cells =</span> <span class="fu">mean</span>(vimentin_cells)),</span>
<span id="cb353-3"><a href="issues.html#cb353-3" tabindex="-1"></a>                     by <span class="ot">=</span> .(genotype, experiment_id)]</span></code></pre></div>
<p><strong>fit the model</strong></p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="issues.html#cb354-1" tabindex="-1"></a>exp4d_m2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(vimentin_cells <span class="sc">~</span> genotype <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> experiment_id),</span>
<span id="cb354-2"><a href="issues.html#cb354-2" tabindex="-1"></a>                 <span class="at">data =</span> exp4d_means)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:issues-exp4d-m2-show">Table 13.5: </span><span id="tab:issues-exp4d-m2-show">Table 13.6: </span>Contrasts from the univariate model fit by AOV_4 (exp4d_m1) and the linear mixed model of the aggregated data (exp4d_m2)
</caption>
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr grouplength="1">
<td colspan="8" style="border-bottom: 1px solid;">
<strong>univariate model (exp4d_m1)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
STAT3_ko - STAT3_wt
</td>
<td style="text-align:right;">
-3.5
</td>
<td style="text-align:right;">
0.048
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-3.7
</td>
<td style="text-align:right;">
-3.29
</td>
<td style="text-align:right;">
-72.52
</td>
<td style="text-align:right;">
0.00019
</td>
</tr>
<tr grouplength="1">
<td colspan="8" style="border-bottom: 1px solid;">
<strong>linear mixed model (exp4d_m2)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
STAT3_ko - STAT3_wt
</td>
<td style="text-align:right;">
-3.5
</td>
<td style="text-align:right;">
0.048
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-3.7
</td>
<td style="text-align:right;">
-3.29
</td>
<td style="text-align:right;">
-72.52
</td>
<td style="text-align:right;">
0.00019
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The univariate model is equivalent to Model <code>exp4d_m2</code> only if there is no missing data (for example, one treatment has no data in experiment 2).
2.The factor <span class="math inline">\(\texttt{experiment_id}\)</span> is added as a <strong>random intercept</strong> using the formula notation <code>(1 | experiment_id)</code>. This random intercept models common variation shared within experiments.</li>
<li>Random intercepts were introduced in <a href="violations.html#violations-paired-t">Example 1 (exp1b) – a paired t-test is a special case of a linear mixed model</a> in the Violations chapter and are described in more detail in <a href="lmm.html#lmm-demo">Example 1 – A random intercepts and slopes explainer (demo1)</a> in the Linear Mixed Model chapter.</li>
</ol>
</div>
<div id="a-linear-mixed-model-of-the-full-data" class="section level3 hasAnchor" number="13.1.5">
<h3><span class="header-section-number">13.1.5</span> A linear mixed model of the full data<a href="issues.html#a-linear-mixed-model-of-the-full-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="issues.html#cb355-1" tabindex="-1"></a>exp4d_m3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(vimentin_cells <span class="sc">~</span> genotype <span class="sc">+</span></span>
<span id="cb355-2"><a href="issues.html#cb355-2" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">|</span>experiment_id) <span class="sc">+</span></span>
<span id="cb355-3"><a href="issues.html#cb355-3" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">|</span>experiment_id<span class="sc">:</span>genotype),</span>
<span id="cb355-4"><a href="issues.html#cb355-4" tabindex="-1"></a>           <span class="at">data =</span> exp4d)</span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>Model <code>exp4d_m3</code> is equivalent to the univariate mixed-effect ANOVA (<code>exp4d_m1</code>) and the linear mixed model of the aggregated data (<code>exp4d_m2</code>) if there are the same number of subsamples in every genotype by experiment combination.</li>
<li>Model <code>exp4d_m3</code> is a linear mixed model with the random factor added as two random intercepts.</li>
<li>The <code>(1|experiment_id)</code> intercept models common variation shared within experiments.</li>
<li>The <code>(1|experiment_id:genotype)</code> is an <strong>interaction intercept</strong> that models common variation shared within experiment by genotype combinations.</li>
<li>The function <code>lmer</code> returns the “boundary (singular) fit” message, which is a warning to researchers to use caution if using the model for inference. This message will not be rare when the the number of experiments is small (2-4).</li>
</ol>
<p>Note 5 raises the question, why bother with the linear mixed model of the full data when the <code>aov_4</code> function always “works” and is the same when the design is balanced? The short answer is, just use the <code>aov_4</code> model with the default (univariate model) outputs. The long answer is, read chapter <a href="lmm.html#lmm">Models with random factors – linear mixed models</a>.</p>
</div>
<div id="analysis-of-the-experiment-means-has-less-precision-and-power" class="section level3 hasAnchor" number="13.1.6">
<h3><span class="header-section-number">13.1.6</span> Analysis of the experiment means has less precision and power<a href="issues.html#analysis-of-the-experiment-means-has-less-precision-and-power" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Compare inference from the mixed-ANOVA <code>exp4d_m1</code> or the linear mixed model <code>exp4d_m2</code> (these are the same) to a linear model of the experiment means (equivalent to a <em>t</em>-test/ANOVA)</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="issues.html#cb356-1" tabindex="-1"></a>exp4d_m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(vimentin_cells <span class="sc">~</span> genotype, <span class="at">data =</span> exp4d_means)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:issues-exp4d-ttest-show">Table 13.7: </span><span id="tab:issues-exp4d-ttest-show">Table 13.8: </span>Contrasts from the univariate model fit by AOV_4 (exp4d_m1) and the linear model of the experiment means (exp4d_m4)
</caption>
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr grouplength="1">
<td colspan="8" style="border-bottom: 1px solid;">
<strong>univariate model (exp4d_m1)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
STAT3_ko - STAT3_wt
</td>
<td style="text-align:right;">
-3.5
</td>
<td style="text-align:right;">
0.048
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-3.70
</td>
<td style="text-align:right;">
-3.29
</td>
<td style="text-align:right;">
-72.52
</td>
<td style="text-align:right;">
0.00019
</td>
</tr>
<tr grouplength="1">
<td colspan="8" style="border-bottom: 1px solid;">
<strong>linear model (exp4d_m4)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
STAT3_ko - STAT3_wt
</td>
<td style="text-align:right;">
-3.5
</td>
<td style="text-align:right;">
0.486
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-4.84
</td>
<td style="text-align:right;">
-2.15
</td>
<td style="text-align:right;">
-7.20
</td>
<td style="text-align:right;">
0.00197
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>Model <code>exp4d_m4</code> violates the independence assumption because residuals within an experiment are expected to be more similar. Analyzing the experiment means does not fix this. With the aggregated data, this correlated error masks the true effect.</li>
<li>The SE for the estimate of the <span class="math inline">\(\texttt{genotype}\)</span> effect is much smaller for the mixed ANOVA/random intercept model than for the fixed effect model of experiment means.</li>
<li>The degrees of freedom for the fixed effect model is slighly larger than that for the mixed model <code>exp4d_m1</code>. Degrees of freedom is a measure of <em>independent</em> variation – the fixed effect model assumes that every measure is independent. They aren’t. The inflated degrees of freedom is <strong>pseudoreplication</strong>.</li>
<li>Despite the (slightly) inflated degrees of freedom of the fixed effects model, the mixed model has much more narrow CIs and smaller p-value. This is because of item 2.</li>
<li>The increased precision and power of the mixed model relative to the fixed effect model of the experiment means is a general result and not one specific to this example.</li>
</ol>
</div>
<div id="dont-do-this-a-t-testfixed-effect-anova-of-the-full-data" class="section level3 hasAnchor" number="13.1.7">
<h3><span class="header-section-number">13.1.7</span> Don’t do this – a t-test/fixed-effect ANOVA of the full data<a href="issues.html#dont-do-this-a-t-testfixed-effect-anova-of-the-full-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>exp4d_m5</code> is a fixed effect model (there are no added random factors).</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="issues.html#cb357-1" tabindex="-1"></a>exp4d_m5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(vimentin_cells <span class="sc">~</span> genotype, <span class="at">data =</span> exp4d)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:issues-exp4d_m5-show)(#tab:issues-exp4d_m5-show)Contrasts from the univariate model fit by AOV_4 (exp4d_m1) and the linear model of the full data (exp4d_m5)
</caption>
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr grouplength="1">
<td colspan="8" style="border-bottom: 1px solid;">
<strong>univariate model (exp4d_m1)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
STAT3_ko - STAT3_wt
</td>
<td style="text-align:right;">
-3.50
</td>
<td style="text-align:right;">
0.048
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-3.70
</td>
<td style="text-align:right;">
-3.29
</td>
<td style="text-align:right;">
-72.52
</td>
<td style="text-align:right;">
0.00019
</td>
</tr>
<tr grouplength="1">
<td colspan="8" style="border-bottom: 1px solid;">
<strong>linear model (exp4d_m5)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
STAT3_ko - STAT3_wt
</td>
<td style="text-align:right;">
-3.49
</td>
<td style="text-align:right;">
0.789
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
-5.07
</td>
<td style="text-align:right;">
-1.91
</td>
<td style="text-align:right;">
-4.42
</td>
<td style="text-align:right;">
0.00004
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>Model <code>exp4d_m4</code> violates the independence assumption because residuals within an experiment are expected to be more similar.</li>
<li>The SE for the estimate of the <span class="math inline">\(\texttt{genotype}\)</span> effect is much smaller for the mixed ANOVA/random intercept model than for the fixed effect model <em>but</em> the degrees of freedom for the fixed effect model is much greater than that for the mixed model <code>exp4d_m1</code>. Degrees of freedom is a measure of <em>independent</em> variation – the fixed effect model assumes that every measure is independent. They aren’t. The inflated degrees of freedom is <strong>pseudoreplication</strong>.</li>
<li>The consequence of the pseudoreplication is a too-small <em>p</em>-value. Pseudoreplication leads to more false discovery.</li>
</ol>
</div>
</div>
<div id="issues-pre-post" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Comparing change from baseline (pre-post)<a href="issues.html#issues-pre-post" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="figure"><span style="display:block;" id="fig:issues-fig4c-fig"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/issues-fig4c-fig-1.png" alt="Serum DPP4 levels at baseline and 3 months in two groups. (A) The actual experiment: the two treatment levels are randomly allocated to treatment at baseline. We are interested in the effect of DMAB at 3 months and use the baseline measure to increase precision. (B) A thought experiment: the two treatment levels are different groups at baseline. We give DMAB to both groups at baseline to estimate the difference in response." width="576" />
<p class="caption">
Figure 13.1: Serum DPP4 levels at baseline and 3 months in two groups. (A) The actual experiment: the two treatment levels are randomly allocated to treatment at baseline. We are interested in the effect of DMAB at 3 months and use the baseline measure to increase precision. (B) A thought experiment: the two treatment levels are different groups at baseline. We give DMAB to both groups at baseline to estimate the difference in response.
</p>
</div>
<p>In a <strong>longitudinal experiment</strong>, the response variable is measured on the same individuals both before (baseline) and after (post-baseline) some condition is applied. Experiments in which only one post-baseline measure is taken are known as pre-post experiments. For simplicity, I call the baseline measure <span class="math inline">\(\texttt{pre}\)</span> and the post-baseline measure <span class="math inline">\(\texttt{post}\)</span>.</p>
<p>Researchers often analyze pre-post data by comparing the <strong>change score</strong> (<span class="math inline">\(\texttt{post} - \texttt{pre}\)</span>) between the groups using a <span class="math inline">\(t\)</span>-test or one-way ANOVA (or a non-parametric equivalent such as Mann-Whitney-Wilcoxon). The linear model form of the <em>t</em>-test is</p>
<p><span class="math display">\[
\texttt{post} - \texttt{pre} = \beta_{0} + \beta_{1}(\texttt{treatment}_{\texttt{tr}}) + \varepsilon
\]</span></p>
<p>This is the <strong>change score model</strong>. A similar analysis is a <em>t</em>-test or ANOVA using the percent change from baseline as the response:</p>
<p><span class="math display">\[
\frac{\texttt{post} - \texttt{pre}}{\texttt{pre}} \times 100 = \beta_{0} + \beta_{1}(\texttt{treatment}_{\texttt{tr}}) + \varepsilon
\]</span></p>
<p>The best practice for how to estimate the treatment effect depends very much on when the treatment is applied relative to the baseline (<span class="math inline">\(\texttt{pre}\)</span>) measure. Consider the two experiments in Figure <a href="issues.html#fig:issues-fig4c-fig">13.1</a></p>
<ol style="list-style-type: decimal">
<li><p>In <a href="issues.html#fig:issues-fig4c-fig">13.1</a>A, the individuals are randomized into the “Placebo” and the “Denosumab” groups. Plasma DPP4 is measured at baseline, the treatment is applied, and, three months later, plasma DPP4 is re-measured. The treatment is “Denosumab” and we want to compare this to “Placebo”. The key feature of this design is the individuals are from the same initial group and have been treated the same up until the baseline measure. Consequently, the expected difference in means for any measure at baseline is zero.</p></li>
<li><p>In <a href="issues.html#fig:issues-fig4c-fig">13.1</a>B, the treatment of interest (knockout) was applied prior to baseline, DPP4 is measured at baseline without Denosumab and then both groups are given Denosumab and measured again three months later. The treatment is not Denosumab but “knockout” and we want to compare this to “wild type” in the two different conditions. The key here is that individuals are randomly sampled from two different groups (wild type and knockout). Consequently, we cannot expect the expected difference in means for any measure at baseline to be zero.</p></li>
</ol>
<p>The best practice for Design 2 is the change score model given above (or equivalents discussed below). The best practice for Design 1 is not the change score model but a linear model in which the baseline measure is added as a covariate.</p>
<p><span class="math display">\[
\texttt{post} = \beta_{0} + \beta_{1}(\texttt{treatment}_{\texttt{tr}}) + \beta_{2}(\texttt{pre}) + \varepsilon
\]</span></p>
<p>This model is commonly known as the <strong>ANCOVA model</strong> (Analysis of Covariance) even if no ANOVA table is generated. The explanation for this best practice is given below, in the section <a href="issues.html#issues-regression-to-mean">regression to the mean</a>. The ANCOVA linear model is common in clinical medicine and pharmacology, where researchers are frequently warned about regression to the mean from statisticians. By contrast, the ANCOVA linear model is rare in basic science experimental biology. The analysis of linear models with added covariates is the focus of the chapter <a href="covariates.html#covariates">Linear models with added covariates</a>.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>Alert! If the individuals are sampled from the same population and treatment is randomized at baseline, do not test for a difference in means of the response variable at baseline and then use the ANCOVA linear model if <span class="math inline">\(p &gt; 0.05\)</span> and the change score model <span class="math inline">\(p &lt; 0.05\)</span>. The best practice is only a function of the design, which leads to the expectation of the difference in means at baseline.</p>
</div>
<ol style="list-style-type: decimal">
<li>If the individuals are sampled from the same population and treatment is randomized at baseline, the expected difference at baseline is zero.</li>
</ol>
<ul>
<li>Use the ANCOVA linear model.</li>
<li>What can go wrong if we use the change score model? <a href="issues.html#issues-regression-to-mean">Regression to the mean</a>.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>If the individuals are sampled from the two populations because the treatment was applied prior to baseline, we cannot expect the difference at baseline to be zero (even if the treatment is magic).</li>
</ol>
<ul>
<li>Use the change score model.</li>
<li>What can go wrong if we use the ANCOVA linear model? Two things. First, the ANCOVA linear model computes a biased estimate of the true effect, meaning that as the sample size increases the estimate does not converge on the true value but the true value plus some bias. Second, the change score has more power than the ANCOVA linear model under the assumption of sampling from different populations at baseline.</li>
</ul>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>Alert! Researchers also use two-way ANOVA or repeated measures ANOVA to analyze data like these. Two-way ANOVA is invalid because the multiple measures on each individual violates the independence assumption. Repeated measures ANOVA will give equivalent results for a pre-post experiment but not for better practice methods that are available when there are more than one post-baseline measure.</p>
<p>The better practice methods are linear models for correlated error, including GLS and linear mixed models. For a pre-post design, these models give equivalent results to the change score model <em>but also</em> allows the estimate of additional effects of interest (see below). For more detail on the analysis of pre-post experiments, see the <a href="pre-post.html#pre-post">Linear models for longitudinal experiments – I. pre-post designs</a> chapter.</p>
</div>
<div id="pre-post-example-1-dpp4-fig4c" class="section level3 hasAnchor" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> Pre-post example 1 (DPP4 fig4c)<a href="issues.html#pre-post-example-1-dpp4-fig4c" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>source: <a href="https://www.nature.com/articles/s41467-019-14003-6" target="_blank">Identification of osteoclast-osteoblast coupling factors in humans reveals links between bone and energy metabolism</a></p>
<p>The data in the left panel of Figure <a href="issues.html#fig:issues-fig4c-fig">13.1</a> are from an experiment to estimate the effect of Denosumab on the plasma levels of the enzyme <a href="https://en.wikipedia.org/wiki/Dipeptidyl_peptidase-4" target="_blank">DPP4</a> in humans. <a href="https://en.wikipedia.org/wiki/Denosumab" target="_blank">Denosumab</a> is a monocolonal antibody that inhibits osteoclast maturation and survival. Osteoclasts secrete the enzyme DPP4.</p>
<div id="for-the-ancova-linear-model-the-data-need-to-be-in-wide-format" class="section level4 hasAnchor" number="13.2.1.1">
<h4><span class="header-section-number">13.2.1.1</span> For the ANCOVA linear model, the data need to be in wide format<a href="issues.html#for-the-ancova-linear-model-the-data-need-to-be-in-wide-format" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the ANCOVA linear model, the baseline measure is added as a covariate and thought of as a separate variable and not a “response”. This makes sense – how could it be a “response” to treatment when the treatment hasn’t been applied? This means the baseline and post-baseline measures of DPP4 have to be in separate columns of the data (Table <a href="issues.html#tab:issues-fig4c-view">13.9</a>.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:issues-fig4c-view">Table 13.9: </span><span id="tab:issues-fig4c-view">Table 13.10: </span>First six rows of the DPP4 data in wide format showing the baseline and post-baseline measures of DPP4 as separate variables.
</caption>
<thead>
<tr>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:right;">
DPP4_baseline
</th>
<th style="text-align:right;">
DPP4_post
</th>
<th style="text-align:left;">
id
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Denosumab
</td>
<td style="text-align:right;">
436
</td>
<td style="text-align:right;">
405
</td>
<td style="text-align:left;">
human_1
</td>
</tr>
<tr>
<td style="text-align:left;">
Denosumab
</td>
<td style="text-align:right;">
434
</td>
<td style="text-align:right;">
392
</td>
<td style="text-align:left;">
human_2
</td>
</tr>
<tr>
<td style="text-align:left;">
Denosumab
</td>
<td style="text-align:right;">
534
</td>
<td style="text-align:right;">
480
</td>
<td style="text-align:left;">
human_3
</td>
</tr>
<tr>
<td style="text-align:left;">
Denosumab
</td>
<td style="text-align:right;">
317
</td>
<td style="text-align:right;">
266
</td>
<td style="text-align:left;">
human_4
</td>
</tr>
<tr>
<td style="text-align:left;">
Denosumab
</td>
<td style="text-align:right;">
440
</td>
<td style="text-align:right;">
397
</td>
<td style="text-align:left;">
human_5
</td>
</tr>
<tr>
<td style="text-align:left;">
Denosumab
</td>
<td style="text-align:right;">
336
</td>
<td style="text-align:right;">
370
</td>
<td style="text-align:left;">
human_6
</td>
</tr>
</tbody>
</table>
</div>
<div id="fit-the-ancova-model" class="section level4 hasAnchor" number="13.2.1.2">
<h4><span class="header-section-number">13.2.1.2</span> Fit the ANCOVA model<a href="issues.html#fit-the-ancova-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="issues.html#cb358-1" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(DPP4_post <span class="sc">~</span> treatment <span class="sc">+</span> DPP4_baseline,</span>
<span id="cb358-2"><a href="issues.html#cb358-2" tabindex="-1"></a>         <span class="at">data =</span> fig4c)</span></code></pre></div>
</div>
<div id="inference-2" class="section level4 hasAnchor" number="13.2.1.3">
<h4><span class="header-section-number">13.2.1.3</span> Inference<a href="issues.html#inference-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>The coefficient table</strong></p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="issues.html#cb359-1" tabindex="-1"></a>m1_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(m1)),</span>
<span id="cb359-2"><a href="issues.html#cb359-2" tabindex="-1"></a>                 <span class="fu">confint</span>(m1))</span>
<span id="cb359-3"><a href="issues.html#cb359-3" tabindex="-1"></a></span>
<span id="cb359-4"><a href="issues.html#cb359-4" tabindex="-1"></a>m1_coef <span class="sc">%&gt;%</span></span>
<span id="cb359-5"><a href="issues.html#cb359-5" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb359-6"><a href="issues.html#cb359-6" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std. Error
</th>
<th style="text-align:right;">
t value
</th>
<th style="text-align:right;">
Pr(&gt;&amp;#124;t&amp;#124;)
</th>
<th style="text-align:right;">
2.5 %
</th>
<th style="text-align:right;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
70.4
</td>
<td style="text-align:right;">
24.85
</td>
<td style="text-align:right;">
2.83
</td>
<td style="text-align:right;">
0.0070
</td>
<td style="text-align:right;">
20.2
</td>
<td style="text-align:right;">
120.5
</td>
</tr>
<tr>
<td style="text-align:left;">
treatmentDenosumab
</td>
<td style="text-align:right;">
-27.0
</td>
<td style="text-align:right;">
10.25
</td>
<td style="text-align:right;">
-2.63
</td>
<td style="text-align:right;">
0.0117
</td>
<td style="text-align:right;">
-47.7
</td>
<td style="text-align:right;">
-6.3
</td>
</tr>
<tr>
<td style="text-align:left;">
DPP4_baseline
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
14.08
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0.7
</td>
<td style="text-align:right;">
0.9
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>Here, we care only about the <span class="math inline">\(\texttt{treatmentDenosumab}\)</span> row. This is the estimated effect of Denosumab on serum DPP4 <em>adjusted</em> for baseline (do not use the word “control” as the baseline values were not controlled in any manipulative sense).</li>
<li>Chapter <a href="covariates.html#covariates">Linear models with added covariates</a> explains the interpretation of these coefficients in more detail.</li>
</ol>
<p><strong>The emmeans table</strong></p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="issues.html#cb360-1" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb360-2"><a href="issues.html#cb360-2" tabindex="-1"></a></span>
<span id="cb360-3"><a href="issues.html#cb360-3" tabindex="-1"></a>m1_emm <span class="sc">%&gt;%</span></span>
<span id="cb360-4"><a href="issues.html#cb360-4" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span></span>
<span id="cb360-5"><a href="issues.html#cb360-5" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb360-6"><a href="issues.html#cb360-6" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:right;">
emmean
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Placebo
</td>
<td style="text-align:right;">
403.5
</td>
<td style="text-align:right;">
7.09
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
389.2
</td>
<td style="text-align:right;">
417.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Denosumab
</td>
<td style="text-align:right;">
376.5
</td>
<td style="text-align:right;">
7.40
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
361.6
</td>
<td style="text-align:right;">
391.4
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The means are conditional on treatment <em>and</em> a value of <span class="math inline">\(\texttt{DPP4_baseline}\)</span>. <code>emmeans</code> uses the grand mean of <span class="math inline">\(\texttt{DPP4_baseline}\)</span> to compute the conditional means. The conditional means are <em>adjusted</em> for baseline DPP4. Note that these means <em>are not</em> equal to the sample means.</li>
</ol>
<p><strong>The contrast table</strong></p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="issues.html#cb361-1" tabindex="-1"></a>m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb361-2"><a href="issues.html#cb361-2" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb361-3"><a href="issues.html#cb361-3" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb361-4"><a href="issues.html#cb361-4" tabindex="-1"></a></span>
<span id="cb361-5"><a href="issues.html#cb361-5" tabindex="-1"></a>m1_pairs <span class="sc">%&gt;%</span></span>
<span id="cb361-6"><a href="issues.html#cb361-6" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb361-7"><a href="issues.html#cb361-7" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Denosumab - Placebo
</td>
<td style="text-align:right;">
-27.003
</td>
<td style="text-align:right;">
10.25
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
-47.7
</td>
<td style="text-align:right;">
-6.3
</td>
<td style="text-align:right;">
-2.6
</td>
<td style="text-align:right;">
0.012
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>As in the coefficient table, the contrast is the estimated effect of Denosumab on serum DPP4. It is the difference in means <em>adjusted</em> (not controlled!) for baseline values.</li>
</ol>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="issues.html#cb362-1" tabindex="-1"></a><span class="fu">ggplot_the_model</span>(m1,</span>
<span id="cb362-2"><a href="issues.html#cb362-2" tabindex="-1"></a>                 m1_emm,</span>
<span id="cb362-3"><a href="issues.html#cb362-3" tabindex="-1"></a>                 m1_pairs,</span>
<span id="cb362-4"><a href="issues.html#cb362-4" tabindex="-1"></a>                 <span class="at">y_label =</span> <span class="st">&quot;Serum DPP4 (ng/mL)&quot;</span>,</span>
<span id="cb362-5"><a href="issues.html#cb362-5" tabindex="-1"></a>                 <span class="at">effect_label =</span> <span class="st">&quot;Effect (ng/mL)&quot;</span>,</span>
<span id="cb362-6"><a href="issues.html#cb362-6" tabindex="-1"></a>                 <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb362-7"><a href="issues.html#cb362-7" tabindex="-1"></a>                 <span class="at">legend_position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:issues-dpp4-fig4c"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/issues-dpp4-fig4c-1.png" alt="Estimated effect of Denosumab on serum DPP4 relative to placebo." width="576" />
<p class="caption">
Figure 13.2: Estimated effect of Denosumab on serum DPP4 relative to placebo.
</p>
</div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The treatment means in Figure <a href="issues.html#fig:issues-dpp4-fig4c">13.2</a> are conditional means adjusted for the baseline measure and are, therefore, not equal to the sample means. The estimated effect <em>is</em> the difference between the conditional means and not the sample means and the inferential statistics (CI, <em>p</em>-value) are based on this difference between the conditional and not the sample means.</li>
</ol>
</div>
</div>
<div id="what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure" class="section level3 hasAnchor" number="13.2.2">
<h3><span class="header-section-number">13.2.2</span> What if the data in example 1 were from from an experiment where the treatment was applied prior to the baseline measure?<a href="issues.html#what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="fit-the-change-score-model" class="section level4 hasAnchor" number="13.2.2.1">
<h4><span class="header-section-number">13.2.2.1</span> Fit the change score model<a href="issues.html#fit-the-change-score-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="issues.html#cb363-1" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(DPP4_post <span class="sc">-</span> DPP4_baseline <span class="sc">~</span> genotype,</span>
<span id="cb363-2"><a href="issues.html#cb363-2" tabindex="-1"></a>         <span class="at">data =</span> fig4c_fake)</span>
<span id="cb363-3"><a href="issues.html#cb363-3" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="st">&quot;genotype&quot;</span>)</span>
<span id="cb363-4"><a href="issues.html#cb363-4" tabindex="-1"></a>m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb363-5"><a href="issues.html#cb363-5" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>)</span>
<span id="cb363-6"><a href="issues.html#cb363-6" tabindex="-1"></a>m1_pairs <span class="sc">%&gt;%</span></span>
<span id="cb363-7"><a href="issues.html#cb363-7" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb363-8"><a href="issues.html#cb363-8" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ko - wt
</td>
<td style="text-align:right;">
-25.83333
</td>
<td style="text-align:right;">
11.53394
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
-2.239766
</td>
<td style="text-align:right;">
0.0302079
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The change score is created on the LHS of the model formula. Alternatively, the change score could be created as a variable in the <code>fig4c_fake</code> data.table using <code>fig4c_fake[, change := DPP4_post - DPP4_baseline]</code>. Making the change in the model formula shows the flexibility of the model formula method of fitting linear models in R.</li>
</ol>
</div>
<div id="issues-interaction" class="section level4 hasAnchor" number="13.2.2.2">
<h4><span class="header-section-number">13.2.2.2</span> Rethinking a change score as an interaction<a href="issues.html#issues-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If the treatment is randomized at baseline, a researcher should focus on the effect of treatment (the difference between the post-basline measures), adjusted for the baseline measures. The addition of the baseline variable as a covariate increases the precision of the treatment effects and the power of the significance test.</p>
<p>If the treatment is generated prior to baseline, a researcher should focus on the difference in the change from baseline to post-baseline, which is</p>
<p><span class="math display">\[
effect = (post_{ko} - pre_{ko}) - (post_{wt} - pre_{wt})
\]</span></p>
<p>This is the difference in change scores, which is a difference of differences. This difference of differences is the <strong>interaction effect</strong> between the genotype (“wt” or “ko”) and the time period of the measurement of DPP4 (baseline or post-baseline). The more usual way to estimate interaction effects is a <strong>linear model with two crossed factors</strong>, which is covered in more detail in the chapter # <a href="factorial.html#factorial">Linear models with two categorical X – Factorial designs (“two-way ANOVA”)</a>. The interaction effect (equal to the difference among the mean of the change scores) can be estimated with the model</p>
<p><span class="math display">\[
\texttt{dpp4} = \beta_{0} + \beta_{1}(\texttt{genotype}_{\texttt{ko}}) + \beta_{2}(\texttt{time}_{\texttt{post}}) + \beta_{3}(\texttt{genotype}_{\texttt{ko}} \times \texttt{time}_{\texttt{post}}) + \epsilon
\]</span></p>
<p>The R script for this looks like this</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="issues.html#cb364-1" tabindex="-1"></a>m2_fixed <span class="ot">&lt;-</span> <span class="fu">lm</span>(dpp4 <span class="sc">~</span> genotype<span class="sc">*</span>time,</span>
<span id="cb364-2"><a href="issues.html#cb364-2" tabindex="-1"></a>               <span class="at">data =</span> fig4c_fake_long)</span></code></pre></div>
<p>This model has two factors (<span class="math inline">\(\texttt{genotype}\)</span> and <span class="math inline">\(\texttt{time}\)</span>), each with two levels. The two levels of <span class="math inline">\(\texttt{time}\)</span> are “pre” and “post”. <span class="math inline">\(genotype_{ko}\)</span> is an indicator variable for “ko” and <span class="math inline">\(time_{post}\)</span> is an indicator variable for “post”</p>
<p>Don’t fit this model – the data violate the independence assumption! This violation arises because <span class="math inline">\(\texttt{dpp4}\)</span> is measured twice in each individual and both these measures are components of the response (both <span class="math inline">\(\texttt{dpp4}\)</span> measures are stacked into a single column). This violation doesn’t arise in the ANCOVA linear model because the baseline measures are a covariate and not a response (remember that the independence assumption only applies to the response variable).</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>Alert! It is pretty common to see this model fit to pre-post and other longitudinal data. The consequence of the violation is invalid (too large) degrees of freedom for computing standard errors and <em>p</em>-values. This is a kind of pseudoreplication.</p>
</div>
<p>To model the correlated error due to the two measures per individual, we use a linear mixed model using <span class="math inline">\(\texttt{id}\)</span> as the added random factor. Linear mixed models were introduced in the <a href="violations.html#violations">Violations of independence, homogeneity, or Normality</a> chapter and are covered in more detail in the <a href="lmm.html#lmm">Models with random factors – Blocking and pseudoreplication</a> chapter.</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="issues.html#cb365-1" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(dpp4 <span class="sc">~</span> genotype<span class="sc">*</span>time <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id),</span>
<span id="cb365-2"><a href="issues.html#cb365-2" tabindex="-1"></a>           <span class="at">data =</span> fig4c_fake_long)</span>
<span id="cb365-3"><a href="issues.html#cb365-3" tabindex="-1"></a>m2_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m2,</span>
<span id="cb365-4"><a href="issues.html#cb365-4" tabindex="-1"></a>                  <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">&quot;genotype&quot;</span>, <span class="st">&quot;time&quot;</span>),</span>
<span id="cb365-5"><a href="issues.html#cb365-5" tabindex="-1"></a>                  <span class="at">lmer.df =</span> <span class="st">&quot;Satterthwaite&quot;</span>)</span>
<span id="cb365-6"><a href="issues.html#cb365-6" tabindex="-1"></a>m2_ixn <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m2_emm,</span>
<span id="cb365-7"><a href="issues.html#cb365-7" tabindex="-1"></a>                   <span class="at">interaction =</span> <span class="st">&quot;revpairwise&quot;</span>)</span>
<span id="cb365-8"><a href="issues.html#cb365-8" tabindex="-1"></a>m2_ixn <span class="sc">%&gt;%</span></span>
<span id="cb365-9"><a href="issues.html#cb365-9" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb365-10"><a href="issues.html#cb365-10" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
genotype_revpairwise
</th>
<th style="text-align:left;">
time_revpairwise
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ko - wt
</td>
<td style="text-align:left;">
post - baseline
</td>
<td style="text-align:right;">
-25.83333
</td>
<td style="text-align:right;">
11.53394
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
-2.239766
</td>
<td style="text-align:right;">
0.0302079
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>This is the same result as that for the change score score model.</li>
<li>The interaction effect is one of the coefficients in the model but to get the same CIs as those in the change score model, we need to use Satterthwaite’s formula for the degrees of freedom. We pass this to the <code>emmeans</code> function using <code>lmer.df = "Satterthwaite"</code></li>
<li>The interaction contrast is computed using the <code>contrast</code> function but using <code>interaction = "revpairwise"</code> instead of <code>method = "revpairwise"</code>.</li>
</ol>
</div>
<div id="the-linear-mixed-model-estimates-additional-effects-that-we-might-want" class="section level4 hasAnchor" number="13.2.2.3">
<h4><span class="header-section-number">13.2.2.3</span> The linear mixed model estimates additional effects that we might want<a href="issues.html#the-linear-mixed-model-estimates-additional-effects-that-we-might-want" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>While the linear mixed model and change score model give the same result for the effect of treatment in response to the different conditions, the linear mixed model estimates additional effects that may be of interest. I use a real example (Example 2) to demonstrate this.</p>
</div>
</div>
<div id="pre-post-example-2-xx-males-fig1c" class="section level3 hasAnchor" number="13.2.3">
<h3><span class="header-section-number">13.2.3</span> Pre-post example 2 (XX males fig1c)<a href="issues.html#pre-post-example-2-xx-males-fig1c" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Source: <a href="https://www.nature.com/articles/s41467-019-10462-z" target="_blank">AlSiraj, Y., Chen, X., Thatcher, S.E., Temel, R.E., Cai, L., Blalock, E., Katz, W., Ali, H.M., Petriello, M., Deng, P. and Morris, A.J., 2019. XX sex chromosome complement promotes atherosclerosis in mice. Nature communications, 10(1), pp.1-13.</a></p>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/issues-xxmice-init-plot-1.png" width="576" />
The experiments in this paper were designed to measure the independent effects of the sex chromosome complement (X or y) and gonads on phenotypic variables related to fat storage, fat metabolism, and cardiovascular disease.</p>
<p><strong>Response variable</strong> – <span class="math inline">\(\texttt{fat_mass}\)</span>. Fat mass was measured in each mouse at baseline (exposed to the standard chow diet) and after one week on a western diet.</p>
<p><strong>Fixed factor</strong> – The design is two crossed factors (sex chromosome complement and gonad type) each with two levels but here I collapse the four treatment combinations into a single factor <span class="math inline">\(\texttt{treatment}\)</span> with four levels: “female_xx”, “female_xy”, “male_xx”, “male_xy”. Male and female are not the typical sex that is merely observed but are constructed by the presence or absence of <em>SRY</em> on an autosome using the Four Core Genotype mouse model. <em>SRY</em> determines the gonad that develops (ovary or testis). Females do not have the autosome with <em>SRY</em>. Males do. Similarly, the chromosome complement is not observed but manipulated. In “xx”, neither chromosome has <em>SRY</em> as the natural condition because there are two X chromosomes. In “xy”, <em>SRY</em> has been removed from the Y chromosome.</p>
<p><strong>Random factor</strong> <span class="math inline">\(\texttt{id}\)</span>. The identification of the individual mouse.</p>
<p><strong>Planned comparisons</strong></p>
<ol style="list-style-type: decimal">
<li>“female_xy” - “female_xx” at baseline (chow diet)</li>
<li>“male_xx” - “male_xy” at baseline (chow diet)</li>
<li>“female_xy” - “female_xx” at one week (western diet)</li>
<li>“male_xx” - “male_xy” at one week (western diet)</li>
<li>the interaction contrast (3 - 1) which addresses, is the effect of the chromosome complement in females conditional on diet</li>
<li>the interaction contrast (4 - 2) which addresses, is the effect of the chromosome complement in males conditional on diet</li>
</ol>
<div id="fit-the-change-score-model-1" class="section level4 hasAnchor" number="13.2.3.1">
<h4><span class="header-section-number">13.2.3.1</span> Fit the change score model<a href="issues.html#fit-the-change-score-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The change score model only estimates planned comparisons 5 and 6.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="issues.html#cb366-1" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(week_1 <span class="sc">-</span> baseline <span class="sc">~</span> treatment,</span>
<span id="cb366-2"><a href="issues.html#cb366-2" tabindex="-1"></a>         <span class="at">data =</span> fig1c_wide)</span></code></pre></div>
<p><strong>Inference from the change score model</strong></p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="issues.html#cb367-1" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb367-2"><a href="issues.html#cb367-2" tabindex="-1"></a></span>
<span id="cb367-3"><a href="issues.html#cb367-3" tabindex="-1"></a>m1_planned <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb367-4"><a href="issues.html#cb367-4" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb367-5"><a href="issues.html#cb367-5" tabindex="-1"></a>                       <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb367-6"><a href="issues.html#cb367-6" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb367-7"><a href="issues.html#cb367-7" tabindex="-1"></a></span>
<span id="cb367-8"><a href="issues.html#cb367-8" tabindex="-1"></a>m1_planned[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>),] <span class="sc">%&gt;%</span></span>
<span id="cb367-9"><a href="issues.html#cb367-9" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb367-10"><a href="issues.html#cb367-10" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
female_xy - female_xx
</td>
<td style="text-align:right;">
-0.54
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
-1.55
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
-1.13
</td>
<td style="text-align:right;">
0.277
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
male_xy - male_xx
</td>
<td style="text-align:right;">
-1.00
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
-2.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-2.09
</td>
<td style="text-align:right;">
0.053
</td>
</tr>
</tbody>
</table>
</div>
<div id="using-the-linear-mixed-model-to-compute-all-six-planned-comparisons" class="section level4 hasAnchor" number="13.2.3.2">
<h4><span class="header-section-number">13.2.3.2</span> Using the linear mixed model to compute all six planned comparisons<a href="issues.html#using-the-linear-mixed-model-to-compute-all-six-planned-comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="issues.html#cb368-1" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(fat_mass <span class="sc">~</span> treatment<span class="sc">*</span>time <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id), <span class="at">data =</span> fig1c)</span></code></pre></div>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="issues.html#cb369-1" tabindex="-1"></a>m2_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m2,</span>
<span id="cb369-2"><a href="issues.html#cb369-2" tabindex="-1"></a>                  <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;time&quot;</span>),</span>
<span id="cb369-3"><a href="issues.html#cb369-3" tabindex="-1"></a>                  <span class="at">lmer.df =</span> <span class="st">&quot;Satterthwaite&quot;</span>)</span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>important to add <code>lmer.df = "Satterthwaite"</code> argument</li>
</ol>
<p><strong>interaction contrasts</strong></p>
<p>The interaction contrasts estimate planned comparisons 5 and 6.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="issues.html#cb370-1" tabindex="-1"></a>m2_ixn <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m2_emm,</span>
<span id="cb370-2"><a href="issues.html#cb370-2" tabindex="-1"></a>         <span class="at">interaction =</span> <span class="fu">c</span>(<span class="st">&quot;revpairwise&quot;</span>),</span>
<span id="cb370-3"><a href="issues.html#cb370-3" tabindex="-1"></a>         <span class="at">by =</span> <span class="cn">NULL</span>,</span>
<span id="cb370-4"><a href="issues.html#cb370-4" tabindex="-1"></a>         <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb370-5"><a href="issues.html#cb370-5" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb370-6"><a href="issues.html#cb370-6" tabindex="-1"></a></span>
<span id="cb370-7"><a href="issues.html#cb370-7" tabindex="-1"></a>m2_planned_ixn <span class="ot">&lt;-</span> m2_ixn[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>), ] <span class="sc">%&gt;%</span></span>
<span id="cb370-8"><a href="issues.html#cb370-8" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb370-9"><a href="issues.html#cb370-9" tabindex="-1"></a></span>
<span id="cb370-10"><a href="issues.html#cb370-10" tabindex="-1"></a>m2_planned_ixn <span class="sc">%&gt;%</span></span>
<span id="cb370-11"><a href="issues.html#cb370-11" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb370-12"><a href="issues.html#cb370-12" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
treatment_revpairwise
</th>
<th style="text-align:left;">
time_revpairwise
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
female_xy - female_xx
</td>
<td style="text-align:left;">
week_1 - baseline
</td>
<td style="text-align:right;">
-0.54
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
-1.55
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
-1.13
</td>
<td style="text-align:right;">
0.277
</td>
</tr>
<tr>
<td style="text-align:left;">
male_xy - male_xx
</td>
<td style="text-align:left;">
week_1 - baseline
</td>
<td style="text-align:right;">
-1.00
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
-2.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-2.09
</td>
<td style="text-align:right;">
0.053
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>These are same results as those using the change scores.</li>
</ol>
<p><strong>Simple effects</strong></p>
<p>The simple effects estimate planned comparisons 1-4.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="issues.html#cb371-1" tabindex="-1"></a><span class="co"># get simple effects from model</span></span>
<span id="cb371-2"><a href="issues.html#cb371-2" tabindex="-1"></a></span>
<span id="cb371-3"><a href="issues.html#cb371-3" tabindex="-1"></a>m2_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m2_emm,</span>
<span id="cb371-4"><a href="issues.html#cb371-4" tabindex="-1"></a>         <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;revpairwise&quot;</span>),</span>
<span id="cb371-5"><a href="issues.html#cb371-5" tabindex="-1"></a>         <span class="at">simple =</span> <span class="st">&quot;each&quot;</span>,</span>
<span id="cb371-6"><a href="issues.html#cb371-6" tabindex="-1"></a>         <span class="at">combine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb371-7"><a href="issues.html#cb371-7" tabindex="-1"></a>         <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb371-8"><a href="issues.html#cb371-8" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb371-9"><a href="issues.html#cb371-9" tabindex="-1"></a></span>
<span id="cb371-10"><a href="issues.html#cb371-10" tabindex="-1"></a><span class="co"># reduce to planned contrasts</span></span>
<span id="cb371-11"><a href="issues.html#cb371-11" tabindex="-1"></a>m2_planned_simple <span class="ot">&lt;-</span> m2_pairs[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">12</span>),] <span class="sc">%&gt;%</span></span>
<span id="cb371-12"><a href="issues.html#cb371-12" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb371-13"><a href="issues.html#cb371-13" tabindex="-1"></a></span>
<span id="cb371-14"><a href="issues.html#cb371-14" tabindex="-1"></a><span class="co"># clarify contrast</span></span>
<span id="cb371-15"><a href="issues.html#cb371-15" tabindex="-1"></a>m2_planned_simple[, contrast <span class="sc">:=</span> <span class="fu">paste</span>(time, contrast, <span class="at">sep =</span> <span class="st">&quot;: &quot;</span>)]</span>
<span id="cb371-16"><a href="issues.html#cb371-16" tabindex="-1"></a></span>
<span id="cb371-17"><a href="issues.html#cb371-17" tabindex="-1"></a><span class="co"># dump first two cols</span></span>
<span id="cb371-18"><a href="issues.html#cb371-18" tabindex="-1"></a>keep_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(m2_planned_simple)[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]</span>
<span id="cb371-19"><a href="issues.html#cb371-19" tabindex="-1"></a>m2_planned_simple <span class="ot">&lt;-</span> m2_planned_simple[, .SD, .SDcols <span class="ot">=</span> keep_cols]</span>
<span id="cb371-20"><a href="issues.html#cb371-20" tabindex="-1"></a></span>
<span id="cb371-21"><a href="issues.html#cb371-21" tabindex="-1"></a>m2_planned_simple <span class="sc">%&gt;%</span></span>
<span id="cb371-22"><a href="issues.html#cb371-22" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb371-23"><a href="issues.html#cb371-23" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
baseline: female_xy - female_xx
</td>
<td style="text-align:right;">
-0.046
</td>
<td style="text-align:right;">
0.502
</td>
<td style="text-align:right;">
24.6
</td>
<td style="text-align:right;">
-1.08
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.92766
</td>
</tr>
<tr>
<td style="text-align:left;">
baseline: male_xy - male_xx
</td>
<td style="text-align:right;">
-1.422
</td>
<td style="text-align:right;">
0.502
</td>
<td style="text-align:right;">
24.6
</td>
<td style="text-align:right;">
-2.46
</td>
<td style="text-align:right;">
-0.39
</td>
<td style="text-align:right;">
-2.84
</td>
<td style="text-align:right;">
0.00902
</td>
</tr>
<tr>
<td style="text-align:left;">
week_1: female_xy - female_xx
</td>
<td style="text-align:right;">
-0.582
</td>
<td style="text-align:right;">
0.502
</td>
<td style="text-align:right;">
24.6
</td>
<td style="text-align:right;">
-1.62
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
-1.16
</td>
<td style="text-align:right;">
0.25701
</td>
</tr>
<tr>
<td style="text-align:left;">
week_1: male_xy - male_xx
</td>
<td style="text-align:right;">
-2.418
</td>
<td style="text-align:right;">
0.502
</td>
<td style="text-align:right;">
24.6
</td>
<td style="text-align:right;">
-3.45
</td>
<td style="text-align:right;">
-1.38
</td>
<td style="text-align:right;">
-4.82
</td>
<td style="text-align:right;">
0.00006
</td>
</tr>
</tbody>
</table>
<p>We can combine the six planned comparisons into a single table.</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="issues.html#cb372-1" tabindex="-1"></a><span class="co"># create contrast table for ixns</span></span>
<span id="cb372-2"><a href="issues.html#cb372-2" tabindex="-1"></a>m2_planned_ixn[, contrast <span class="sc">:=</span> <span class="fu">paste0</span>(<span class="st">&quot;ixn: &quot;</span>, treatment_revpairwise)]</span>
<span id="cb372-3"><a href="issues.html#cb372-3" tabindex="-1"></a></span>
<span id="cb372-4"><a href="issues.html#cb372-4" tabindex="-1"></a><span class="co"># dump first two cols</span></span>
<span id="cb372-5"><a href="issues.html#cb372-5" tabindex="-1"></a>keep_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(m2_planned_ixn)[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]</span>
<span id="cb372-6"><a href="issues.html#cb372-6" tabindex="-1"></a>m2_planned_ixn <span class="ot">&lt;-</span> m2_planned_ixn[, .SD, .SDcols <span class="ot">=</span> keep_cols]</span>
<span id="cb372-7"><a href="issues.html#cb372-7" tabindex="-1"></a></span>
<span id="cb372-8"><a href="issues.html#cb372-8" tabindex="-1"></a><span class="co"># row bind -- smart enought to recognize column order</span></span>
<span id="cb372-9"><a href="issues.html#cb372-9" tabindex="-1"></a>m2_planned <span class="ot">&lt;-</span> <span class="fu">rbind</span>(m2_planned_simple,</span>
<span id="cb372-10"><a href="issues.html#cb372-10" tabindex="-1"></a>                    m2_planned_ixn)</span>
<span id="cb372-11"><a href="issues.html#cb372-11" tabindex="-1"></a></span>
<span id="cb372-12"><a href="issues.html#cb372-12" tabindex="-1"></a>m2_planned <span class="sc">%&gt;%</span></span>
<span id="cb372-13"><a href="issues.html#cb372-13" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb372-14"><a href="issues.html#cb372-14" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
baseline: female_xy - female_xx
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
24.6
</td>
<td style="text-align:right;">
-1.08
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.92766
</td>
</tr>
<tr>
<td style="text-align:left;">
baseline: male_xy - male_xx
</td>
<td style="text-align:right;">
-1.42
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
24.6
</td>
<td style="text-align:right;">
-2.46
</td>
<td style="text-align:right;">
-0.39
</td>
<td style="text-align:right;">
-2.84
</td>
<td style="text-align:right;">
0.00902
</td>
</tr>
<tr>
<td style="text-align:left;">
week_1: female_xy - female_xx
</td>
<td style="text-align:right;">
-0.58
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
24.6
</td>
<td style="text-align:right;">
-1.62
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
-1.16
</td>
<td style="text-align:right;">
0.25701
</td>
</tr>
<tr>
<td style="text-align:left;">
week_1: male_xy - male_xx
</td>
<td style="text-align:right;">
-2.42
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
24.6
</td>
<td style="text-align:right;">
-3.45
</td>
<td style="text-align:right;">
-1.38
</td>
<td style="text-align:right;">
-4.82
</td>
<td style="text-align:right;">
0.00006
</td>
</tr>
<tr>
<td style="text-align:left;">
ixn: female_xy - female_xx
</td>
<td style="text-align:right;">
-0.54
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
16.0
</td>
<td style="text-align:right;">
-1.55
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
-1.13
</td>
<td style="text-align:right;">
0.27697
</td>
</tr>
<tr>
<td style="text-align:left;">
ixn: male_xy - male_xx
</td>
<td style="text-align:right;">
-1.00
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
16.0
</td>
<td style="text-align:right;">
-2.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-2.09
</td>
<td style="text-align:right;">
0.05280
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="issues-regression-to-mean" class="section level3 hasAnchor" number="13.2.4">
<h3><span class="header-section-number">13.2.4</span> Regression to the mean<a href="issues.html#issues-regression-to-mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Regression to the mean is the phenomenon that if an extreme value is sampled, the next sample will likely be less extreme – it is closer to the mean. This makes sense. If we randomly sample a single human male and that individual is 6’10” (about four standard deviations above the mean), the height of the next human male that we randomly sample will almost certainly be closer to the mean (about 5’10” in the united states). This phenomenon also applies to sampling a mean. If we randomly sample five human males and the mean height in the group is 5’6” (about 3 SEM below the mean), the mean height of the next sample of five human males that we measure will almost certainly be closer to the mean. And, this phenomenon applies to sampling a difference in means. If we randomly sample two groups of five human males and the difference between the mean heights is 5.7” (about 3 SED), then the difference in mean height in the next sample of two groups of human males that we measure will almost certainly be closer to zero.</p>
<p>How does regression to the mean apply to the analysis of change scores in a pre-post experiment? Consider an experiment where the response is body weight in mice. In a pre-post experiment, mice are randomized to treatment group at baseline. Weight is measured at baseline and at post-baseline. We expect the difference in means at baseline to be zero. If there is no treatment effect, we expect the difference in means at post-baseline to be zero. Because of sampling error there is a difference in weight at baseline. Do we expect the mean difference to be the same post-baseline? No. Even if taken after only 1 hour, the post-baseline weight of each mouse would not equal the baseline weight because of variation in water intake and loss, food intake, fecal weight, and other variables that affect body weight (this is a within-mouse variance). There is a correlation between the pre and post measures – individual mice that weigh more than the mean at baseline will generally weigh more than the mean at post-baseline. But, the bigger this within-mouse variance (or, the longer the time difference between baseline and post-baseline), the smaller this correlation. The consequence is that all these uncontrolled variables contribute to the sampling variance of the means and the difference in means at baseline and post-baseline. If the difference is unusually large at baseline <em>because of these uncontrolled factors contribution to within mouse variance</em>, we expect the difference at post-baseline to be less large – there is regression to the mean (Figure <a href="issues.html#fig:issues-rtm-plot">13.3</a>A). This regression to the mean between the baseline and post-baseline measures will emerge as a treatment by time interaction, or, equivalently, a difference in the mean change score between treatments (Figure <a href="issues.html#fig:issues-rtm-plot">13.3</a>B).</p>
<div class="figure"><span style="display:block;" id="fig:issues-rtm-plot"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/issues-rtm-plot-1.png" alt="Regression to the mean. The individual values in (A) are fake data sampled from a normal distribution with true mean equal to 30 at baseline (gray line) or 35 at post-baseline(gray line). The unusually large different in means at baseline is an extreme event. Consequently, the difference at post-baseline is much smaller. This regression to the mean is easily visualized by the lines that converge at the post-baseline value. (B) The results of a linear model (or *t*-test) fit to the data in (A) using change scores as the response variable. The apparent treatment effect is due to regression to the mean." width="576" />
<p class="caption">
Figure 13.3: Regression to the mean. The individual values in (A) are fake data sampled from a normal distribution with true mean equal to 30 at baseline (gray line) or 35 at post-baseline(gray line). The unusually large different in means at baseline is an extreme event. Consequently, the difference at post-baseline is much smaller. This regression to the mean is easily visualized by the lines that converge at the post-baseline value. (B) The results of a linear model (or <em>t</em>-test) fit to the data in (A) using change scores as the response variable. The apparent treatment effect is due to regression to the mean.
</p>
</div>
</div>
</div>
<div id="longitudinal-designs-with-more-than-one-post-baseline-measure" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Longitudinal designs with more than one-post baseline measure<a href="issues.html#longitudinal-designs-with-more-than-one-post-baseline-measure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A rigorous analysis of longitudinal data typically requires sophisticated statistical models but for many purposes, longitudinal data can be analyzed with simple statistical models using <strong>summary statistics</strong> of the longitud data. Summary statistics include the slope of a line for a response that is fairly linear or the Area Under the Curve (AUC) for humped responses.</p>
<div id="issues-auc" class="section level3 hasAnchor" number="13.3.1">
<h3><span class="header-section-number">13.3.1</span> Area under the curve (AUC)<a href="issues.html#issues-auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An AUC (Area under the curve) is a common and simple summary statistic for analyzing data from a glucose tolerance test and many other longitudinal experiments. Here I use the AUC of glucose tolerance tests (GTT) as an example.</p>
<div id="auc-and-iauc" class="section level4 hasAnchor" number="13.3.1.1">
<h4><span class="header-section-number">13.3.1.1</span> AUC and iAUC<a href="issues.html#auc-and-iauc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s generate and plot fake GTT data for a single individual in order to clarify some AUC measurements and define new ones.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="issues.html#cb373-1" tabindex="-1"></a>fake_auc <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb373-2"><a href="issues.html#cb373-2" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">120</span>),</span>
<span id="cb373-3"><a href="issues.html#cb373-3" tabindex="-1"></a>  <span class="at">glucose =</span> <span class="fu">c</span>(<span class="dv">116</span>, <span class="dv">268</span>, <span class="dv">242</span>, <span class="dv">155</span>, <span class="dv">121</span>)</span>
<span id="cb373-4"><a href="issues.html#cb373-4" tabindex="-1"></a>)</span>
<span id="cb373-5"><a href="issues.html#cb373-5" tabindex="-1"></a>fake_auc[, glucose_change <span class="sc">:=</span> glucose <span class="sc">-</span> glucose[<span class="dv">1</span>]]</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:issues-auc-plot"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/issues-auc-plot-1.png" alt="Glucose tolerance curve measures for the fake GTT data. A. Glucose values for an individual, B. The glucose values shifted so the baseline value is zero. The post-baseline values are change scores (glucose - baseline), or change from baseline. The filled area is the AUC in (A) and the iAUC in (B). The dashed line is the mean glucose over the test period in (A) and the mean change from baseline over the test period in (B)." width="576" />
<p class="caption">
Figure 13.4: Glucose tolerance curve measures for the fake GTT data. A. Glucose values for an individual, B. The glucose values shifted so the baseline value is zero. The post-baseline values are change scores (glucose - baseline), or change from baseline. The filled area is the AUC in (A) and the iAUC in (B). The dashed line is the mean glucose over the test period in (A) and the mean change from baseline over the test period in (B).
</p>
</div>
<p><strong>AUC</strong> – The glucose tolerance curve for an individual is a connected set of straight lines that serves as a proxy for the continuous change of glucose over the period (Figure <a href="issues.html#fig:issues-auc-plot">13.4</a>A). The AUC is the area under this set of straight lines (Figure <a href="issues.html#fig:issues-auc-plot">13.4</a>A) and is conveniently computed as the sum of the areas of each of the connected trapezoids created by the connected lines.</p>
<p><strong>iAUC</strong> – the incremental AUC (iAUC) is the baseline-zeroed AUC. It can be visualized as the area under the connected lines that have been rigidly shifted down so that the baseline value is zero (Figure <a href="issues.html#fig:issues-auc-plot">13.4</a>B). The iAUC is computed using the trapezoid rule after first subtracting the individual’s baseline value from all of the individual’s values (including the baseline).</p>
</div>
<div id="issues-iauc-change-score" class="section level4 hasAnchor" number="13.3.1.2">
<h4><span class="header-section-number">13.3.1.2</span> Rethinking the iAUC as a change-score<a href="issues.html#issues-iauc-change-score" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The baseline-zeroed values of glucose used to compute iAUC are <strong>change scores</strong> from the baseline measure. This makes the iAUC a change score – it is the AUC minus the area under the baseline.</p>
</div>
<div id="rethinking-a-t-test-of-the-auc-as-a-t-test-of-the-glucuose-concentration-averaged-over-the-test-period" class="section level4 hasAnchor" number="13.3.1.3">
<h4><span class="header-section-number">13.3.1.3</span> Rethinking a <em>t</em>-test of the AUC as a <em>t</em>-test of the glucuose concentration averaged over the test period<a href="issues.html#rethinking-a-t-test-of-the-auc-as-a-t-test-of-the-glucuose-concentration-averaged-over-the-test-period" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The glucose concentration averaged over the post-baseline period for an individual is <span class="math inline">\(glucose_{gtt-post} = \frac{AUC}{Period}\)</span>. Importantly, a <em>t</em>-test of <span class="math inline">\(glucose_{gtt-post}\)</span> is equivalent to a <em>t</em>-test of <span class="math inline">\(AUC\)</span> because the mean glucose values are simply the AUC values times the same constant (the test period) for all individuals.</p>
</div>
<div id="rethinking-a-t-test-of-the-iauc-as-a-t-test-of-the-change-from-baseline-change-score-averaged-over-the-test-period" class="section level4 hasAnchor" number="13.3.1.4">
<h4><span class="header-section-number">13.3.1.4</span> Rethinking a <em>t</em>-test of the iAUC as a <em>t</em>-test of the change from baseline (change score) averaged over the test period<a href="issues.html#rethinking-a-t-test-of-the-iauc-as-a-t-test-of-the-change-from-baseline-change-score-averaged-over-the-test-period" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The change from baseline (change score) averaged over the test period for an individual is <span class="math inline">\(glucose_{gtt-change} = \frac{iAUC}{Period}\)</span>. As above, a <em>t</em>-test of <span class="math inline">\(glucose_{gtt-change}\)</span> is equivalent to a <em>t</em>-test of <span class="math inline">\(iAUC\)</span> because the <span class="math inline">\(glucose_{gtt-change}\)</span> values are simply the iAUC values times the same constant (the test period) for all individuals.</p>
</div>
<div id="rethinking-auc-as-a-pre-post-design." class="section level4 hasAnchor" number="13.3.1.5">
<h4><span class="header-section-number">13.3.1.5</span> Rethinking AUC as a pre-post design.<a href="issues.html#rethinking-auc-as-a-pre-post-design." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can now rethink data used to construct an AUC as a pre-post design using the baseline value (<span class="math inline">\(glucose_0\)</span>) as a measure of <span class="math inline">\(pre\)</span>, <span class="math inline">\(glucose_{gtt-post}\)</span> as a measure of <span class="math inline">\(post\)</span> and <span class="math inline">\(glucose_{gtt-change}\)</span> as a measure of <span class="math inline">\(post - pre\)</span> (note that <span class="math inline">\(glucose_{gtt-change} = glucose_{gtt-post} - glucose_0\)</span>). And, we can use the principles outlined in <a href="issues.html#issues-pre-post">Comparing change from baseline (pre-post)</a> above to determine best practices.</p>
</div>
<div id="issues-auc-best" class="section level4 hasAnchor" number="13.3.1.6">
<h4><span class="header-section-number">13.3.1.6</span> Best practice strategies for analyzing AUC<a href="issues.html#issues-auc-best" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>If the treatment was applied prior to the baseline measure, then use the change score model (Or use the linear mixed model if you want to estimate the effect at baseline). <strong>This is the most common kind of design in the experimental biology literature</strong>
<ol style="list-style-type: lower-alpha">
<li><code>glucose_gtt_post - glucose_0 ~ treatment</code></li>
<li><code>iauc ~ treatment</code>. The <em>t</em> and <em>p</em> values are equivalent to those in 1a</li>
<li><code>glucose ~ treatment*time + (1|id)</code>. This is a linear mixed model that allows the computation of both the effect of treatment at baseline and the effect of treatment on the change in the response to the condition (the interaction effect). This is <em>not</em> a LMM of the glucose values at all time periods but a pre-post LMM with the values of <span class="math inline">\(\texttt{glucose_0}\)</span> and <span class="math inline">\(\texttt{glucose_gtt_post}\)</span> stacked in the data column <span class="math inline">\(\texttt{glucose}\)</span>. The <em>t</em> and <em>p</em> values for the interaction effect are equivalent to those in 1a and 1b.</li>
</ol></li>
<li>If treatment is randomized at baseline, use the ANCOVA linear model.
<ol style="list-style-type: lower-alpha">
<li><code>glucose_post ~ treatment + glucose_0</code>.</li>
<li><code>auc ~ treatment + glucose_0</code>. The <em>t</em> and <em>p</em> values are equivalent to those in 2a but the units of the response or the effect.</li>
</ol></li>
</ol>
</div>
<div id="the-difference-in-iauc-between-groups-is-an-interaction-effect.-this-is-an-important-recognition." class="section level4 hasAnchor" number="13.3.1.7">
<h4><span class="header-section-number">13.3.1.7</span> The difference in iAUC between groups is an interaction effect. This is an important recognition.<a href="issues.html#the-difference-in-iauc-between-groups-is-an-interaction-effect.-this-is-an-important-recognition." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If the treatment was not randomized at baseline, then the potential effects in a glucose tolerance test are:</p>
<ol style="list-style-type: decimal">
<li>the effect of treatment at baseline, which is a measure of what is going on independent of added glucose. This is the baseline effect.</li>
<li>the effect of glucose infusion, which is a measure of the physiological response during the absorptive state. This effect in each treatment level are the change scores. Researchers typically are not interested in this effect (we know glucose levels rise then fall).</li>
<li>the difference in the change from baseline to the new condition (glucose infusion), which is equivalent to the difference in the change scores. This is the interaction effect. An interaction effect is evidence that the difference between treatment and control during the post-baseline (absorptive state) period is not <em>more of the same</em> difference occurring at baseline (fasted state) but <em>something different</em> (Figure <a href="issues.html#fig:issues-gg-something-different-plot">13.5</a>).</li>
</ol>
<div class="figure"><span style="display:block;" id="fig:issues-gg-something-different-plot"></span>
&lt;img src=“images/issues-something_different.png” alt=“Effects in a glucose tolerance data in an experiment in which the treatment is not randomized at baseline.”something different is the interaction effect”. It is the difference in the change from baseline (or the difference in the change scores).” width=“80%” /&gt;
<p class="caption">
Figure 13.5: Effects in a glucose tolerance data in an experiment in which the treatment is not randomized at baseline. “something different is the interaction effect”. It is the difference in the change from baseline (or the difference in the change scores).
</p>
</div>
<p>iAUC is a change score (see <a href="issues.html#issues-iauc-change-score">Rethinking the iAUC as a change-score</a> above). Recall (or re-read) from section <a href="issues.html#issues-interaction">13.2.2.2</a> above that the difference in the mean change-score between two groups is the interaction effect of the linear model with two factors $} (“cn” and “tr”) and $} (“pre” and “post”) and their interaction.</p>
<p><span class="math display">\[
\texttt{glucose} = \beta_0 + \beta_1 (\texttt{treatment}_\texttt{tr}) + \beta_2 (\texttt{time}_\texttt{post}) + \beta_3 (\texttt{treatment}_\texttt{tr} \times \texttt{time}_\texttt{post}) + \varepsilon
\]</span></p>
<p>This means a <em>t</em>-test of iAUC is equivalent to the<em>t</em>-test of the interaction effect of treatment by time.</p>
<p>This recognition adds an important perspective to the controversy of using iAUC in the analysis of glucose tolerance curves. iAUC is often used in place of AUC to “adjust” for baseline variation in glucose with the belief that this adjustment makes the AUC measure independent of (uncorrelated with) baseline glucose. As <a href="https://care.diabetesjournals.org/content/18/2/245.short" target="_blank">Allison et al.</a> note, a change score doesn’t do this for us. The correct way to adjust for baseline variation is adding the baseline measure as a covariate in the linear model (Section <a href="issues.html#issues-pre-post">13.2</a> above).</p>
<p><span class="math display">\[
\texttt{glucose_mean_post} = \beta_0 + \beta_1 (\texttt{treatment}_\texttt{tr}) + \beta_2 (\texttt{glucose_0}) + \varepsilon
\]</span></p>
<p>Nevertheless, in a pre-post design, if the treatment is applied prior to the baseline measure, it is the interaction effect that we want as the measure of the treatment effect and not the difference between post-baseline means conditional on (adjusted for) baseline. That is we want the change score model and not the ANCOVA linear model.</p>
</div>
<div id="issues-in-the-analysis-of-designs-where-the-treatment-is-applied-prior-to-the-baseline-measure" class="section level4 hasAnchor" number="13.3.1.8">
<h4><span class="header-section-number">13.3.1.8</span> Issues in the analysis of designs where the treatment is applied prior to the baseline measure<a href="issues.html#issues-in-the-analysis-of-designs-where-the-treatment-is-applied-prior-to-the-baseline-measure" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Almost all glucose tolerance tests in the experimental biology literature have designs where the treatment (genotype, diet, exercise) was applied prior to the baseline measure and we cannot expect the difference in means to be zero at baseline. In these, it is common, but far from standard, for researchers to analyze the data using <em>t</em> tests or post-hoc tests with the AUC adjusted for baseline as the response. This is equivalent to the recommended linear model in 1b.</p>
<p>Two common alternative analyses with potential consequences that can severely mislead the researcher because of conflated effects are</p>
<ol style="list-style-type: decimal">
<li>Separate <em>t</em> tests at each time point.</li>
<li><em>t</em> test/post-hoc tests of <span class="math inline">\(\texttt{auc}\)</span> (the standard AUC)</li>
</ol>
<p>The reason that these can mislead is because the results <strong>conflate the baseline effect and the interaction effect</strong> (Figure <a href="issues.html#fig:issues-gg-something-different-plot">13.5</a>). Both the baseline effect and the interaction effect are of physiological interest. The difference in the mean of the AUC combines these two effects. The difference in the means at any post-baseline time point combines these two effects. A <em>t</em>-test of the AUC or separate <em>t</em>-tests at the post-baseline time points conflate these effects. The conflated results muddle the physiology. If a researcher wants to simply conclude “The knockout causes glucose intolerance” then the full AUC is okay but the researcher should recognize that this is the question they are trying to answer. But if a researcher is asking, “is the difference between treatment groups in the absorptive (post-baseline) state something different, or more of the same, as the difference between treatment groups in the fasted (baseline) state?”, then the researcher should avoid <em>t</em>-tests of the AUC or the separate <em>t</em>-tests at post-baseline times.</p>
<p>Two common, alternative analyses that can mislead because of model assumptions that are more severely violated than best practice models are</p>
<ol start="3" style="list-style-type: decimal">
<li>two-way ANOVA with treatment and time as the factors, followed by post-hoc tests. The advantage of this analysis is the ability to estimate the effect at baseline <em>and</em> the interaction effect. But, the correlated error due to the multiple measures on each individual violates the independence assumption. Inference from this model will generally be optimisitic – the CIs will be too narrow and the <em>p</em>-values too small. This is an example of pseudoreplication. The correlated error can be modeled with a GLS linear model or a Linear Mixed Model.</li>
<li>repeated measures ANOVA with treatment and time as the factors, followed by post-hoc tests. Like the two-way ANOVA, a repeated measures ANOVA can be used to estimate both the baseline and interaction effects. Unlike the two-way ANOVA, a repeated measures ANOVA models the correlated error. But the model for the correlated error is too unrealistic. The better alternatives for modeling the correlated error are the GLS linear model or the Linear Mixed Model.</li>
</ol>
</div>
<div id="auc-example-1-treatment-applied-prior-to-baseline" class="section level4 hasAnchor" number="13.3.1.9">
<h4><span class="header-section-number">13.3.1.9</span> AUC Example 1 – Treatment applied prior to baseline<a href="issues.html#auc-example-1-treatment-applied-prior-to-baseline" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Source: <a href="https://idp.nature.com/authorize/casa?redirect_uri=https://www.nature.com/articles/s41586-019-1156-9&amp;casa_token=vnFIQyig4UoAAAAA:3hBrakzgGdZ7hYaUBmTHj7dyD2PxQp6iCQXmTJNeFQnIETrRhg_gZwVDPwteGOOf3sFxS9M_Tfa45w4t">Innervation of thermogenic adipose tissue via a calsyntenin 3β–S100b axis</a></p>
<p>Source data: Fig. 3f</p>
<div id="an-initial-plot" class="section level5 hasAnchor" number="13.3.1.9.1">
<h5><span class="header-section-number">13.3.1.9.1</span> An initial plot<a href="issues.html#an-initial-plot" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-162-1.png" width="576" /></p>
</div>
<div id="inference-3" class="section level5 hasAnchor" number="13.3.1.9.2">
<h5><span class="header-section-number">13.3.1.9.2</span> Inference<a href="issues.html#inference-3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><strong>change-score linear model</strong> (<a href="issues.html#issues-auc-best">model 1a</a>), which estimates the interaction effect (the effect of treatment on the difference in the change from baseline to post-baseline).</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="issues.html#cb374-1" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose_gtt_post <span class="sc">-</span> glucose_0 <span class="sc">~</span> treatment,</span>
<span id="cb374-2"><a href="issues.html#cb374-2" tabindex="-1"></a>         <span class="at">data =</span> fig3f_wide)</span>
<span id="cb374-3"><a href="issues.html#cb374-3" tabindex="-1"></a></span>
<span id="cb374-4"><a href="issues.html#cb374-4" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb374-5"><a href="issues.html#cb374-5" tabindex="-1"></a>m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb374-6"><a href="issues.html#cb374-6" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb374-7"><a href="issues.html#cb374-7" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb374-8"><a href="issues.html#cb374-8" tabindex="-1"></a></span>
<span id="cb374-9"><a href="issues.html#cb374-9" tabindex="-1"></a>m1_pairs <span class="sc">%&gt;%</span></span>
<span id="cb374-10"><a href="issues.html#cb374-10" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb374-11"><a href="issues.html#cb374-11" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
KO - WT
</td>
<td style="text-align:right;">
48.304
</td>
<td style="text-align:right;">
36.904
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
-32.104
</td>
<td style="text-align:right;">
128.711
</td>
<td style="text-align:right;">
1.309
</td>
<td style="text-align:right;">
0.215
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="issues.html#cb375-1" tabindex="-1"></a><span class="co"># increased digits to compare with lmm below</span></span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The estimate is not the average difference over the period but the difference in the average change from baseline. The knockout has an average change from baseline that is 48.3 mg/dL larger than the average change from baseline of the wildtype. Over the period, blood glucose in the knockout is 48.3 mg/dL larger than the expected difference if the only mechanisms generating a difference post-baseline are the same as the mechanisms generating the differences at baseline.</li>
<li>This is equivalent to a <em>t</em> test of the AUC adjusted for baseline ($)</li>
</ol>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="issues.html#cb376-1" tabindex="-1"></a>m1_t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(iauc <span class="sc">~</span> treatment,</span>
<span id="cb376-2"><a href="issues.html#cb376-2" tabindex="-1"></a>       <span class="at">data =</span> fig3f_wide,</span>
<span id="cb376-3"><a href="issues.html#cb376-3" tabindex="-1"></a>       <span class="at">var.equal =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb376-4"><a href="issues.html#cb376-4" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb376-5"><a href="issues.html#cb376-5" tabindex="-1"></a></span>
<span id="cb376-6"><a href="issues.html#cb376-6" tabindex="-1"></a>m1_t[<span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>)]</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   estimate statistic p.value parameter conf.low conf.high
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1   -5796.     -1.31   0.215        12  -15445.     3852.</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The estimate of the effect is the average change from baseline over the period times the period. Can anyone look at this number and claim with sincerity, wow that is huge!. The estimate from the change-score model, which is simply the difference in the average change from baseline over the period is a number that should be interpretable.</li>
<li>The change-score model (or the analysis of the AUC adjusted for baseline) does not estimate the effect of treatment at baseline (the effect in the fasted state). Researchers probably want this. For this we need a linear model with correlated error such as a linear mixed model.</li>
</ol>
<p><strong>Linear mixed model</strong> (<a href="issues.html#issues-auc-best">model 1c</a>), which estimates the interaction effect and the baseline effect.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="issues.html#cb378-1" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(glucose <span class="sc">~</span> treatment<span class="sc">*</span>time <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id),</span>
<span id="cb378-2"><a href="issues.html#cb378-2" tabindex="-1"></a>           <span class="at">data =</span> fig3f_long)</span>
<span id="cb378-3"><a href="issues.html#cb378-3" tabindex="-1"></a>m2_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m2,</span>
<span id="cb378-4"><a href="issues.html#cb378-4" tabindex="-1"></a>                  <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;time&quot;</span>),</span>
<span id="cb378-5"><a href="issues.html#cb378-5" tabindex="-1"></a>                  <span class="at">lmer.df =</span> <span class="st">&quot;Satterthwaite&quot;</span>)</span>
<span id="cb378-6"><a href="issues.html#cb378-6" tabindex="-1"></a>m2_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m2_emm,</span>
<span id="cb378-7"><a href="issues.html#cb378-7" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb378-8"><a href="issues.html#cb378-8" tabindex="-1"></a>                     <span class="at">simple =</span> <span class="st">&quot;each&quot;</span>,</span>
<span id="cb378-9"><a href="issues.html#cb378-9" tabindex="-1"></a>                     <span class="at">combine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb378-10"><a href="issues.html#cb378-10" tabindex="-1"></a>                     <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb378-11"><a href="issues.html#cb378-11" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb378-12"><a href="issues.html#cb378-12" tabindex="-1"></a>m2_ixn <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m2_emm,</span>
<span id="cb378-13"><a href="issues.html#cb378-13" tabindex="-1"></a>                   <span class="at">interaction =</span> <span class="st">&quot;trt.vs.ctrl&quot;</span>,</span>
<span id="cb378-14"><a href="issues.html#cb378-14" tabindex="-1"></a>                   <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb378-15"><a href="issues.html#cb378-15" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb378-16"><a href="issues.html#cb378-16" tabindex="-1"></a></span>
<span id="cb378-17"><a href="issues.html#cb378-17" tabindex="-1"></a>m2_pairs <span class="sc">%&gt;%</span></span>
<span id="cb378-18"><a href="issues.html#cb378-18" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb378-19"><a href="issues.html#cb378-19" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
time
</th>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
glucose_0
</td>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
KO - WT
</td>
<td style="text-align:right;">
111.571
</td>
<td style="text-align:right;">
37.454
</td>
<td style="text-align:right;">
18.976
</td>
<td style="text-align:right;">
33.172
</td>
<td style="text-align:right;">
189.970
</td>
<td style="text-align:right;">
2.979
</td>
<td style="text-align:right;">
0.008
</td>
</tr>
<tr>
<td style="text-align:left;">
glucose_gtt_post
</td>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
KO - WT
</td>
<td style="text-align:right;">
159.875
</td>
<td style="text-align:right;">
37.454
</td>
<td style="text-align:right;">
18.976
</td>
<td style="text-align:right;">
81.476
</td>
<td style="text-align:right;">
238.274
</td>
<td style="text-align:right;">
4.269
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
WT
</td>
<td style="text-align:left;">
glucose_gtt_post - glucose_0
</td>
<td style="text-align:right;">
191.518
</td>
<td style="text-align:right;">
26.095
</td>
<td style="text-align:right;">
12.000
</td>
<td style="text-align:right;">
134.661
</td>
<td style="text-align:right;">
248.375
</td>
<td style="text-align:right;">
7.339
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
KO
</td>
<td style="text-align:left;">
glucose_gtt_post - glucose_0
</td>
<td style="text-align:right;">
239.821
</td>
<td style="text-align:right;">
26.095
</td>
<td style="text-align:right;">
12.000
</td>
<td style="text-align:right;">
182.965
</td>
<td style="text-align:right;">
296.678
</td>
<td style="text-align:right;">
9.190
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="issues.html#cb379-1" tabindex="-1"></a>m2_ixn <span class="sc">%&gt;%</span></span>
<span id="cb379-2"><a href="issues.html#cb379-2" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb379-3"><a href="issues.html#cb379-3" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
treatment_trt.vs.ctrl
</th>
<th style="text-align:left;">
time_trt.vs.ctrl
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
KO - WT
</td>
<td style="text-align:left;">
glucose_gtt_post - glucose_0
</td>
<td style="text-align:right;">
48.304
</td>
<td style="text-align:right;">
36.904
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
-32.104
</td>
<td style="text-align:right;">
128.711
</td>
<td style="text-align:right;">
1.309
</td>
<td style="text-align:right;">
0.215
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="issues.html#cb380-1" tabindex="-1"></a><span class="co"># increased digits to compare to change-score model above</span></span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The treatment effect at baseline is in the first row of the <code>m2_pairs</code> contrast table from the linear mixed model.</li>
<li>The interaction effect (the effect of treatment on the change from baseline) is in the <code>m2_ixn</code> contrast table from the linear mixed model. The estimate, SE, confidence intervals, <em>t</em>-value, and <em>p</em>-value are the same as those from the change score model in <code>m1_pairs</code>.</li>
</ol>
</div>
<div id="a-t-test-of-the-auc-or-separate-t-tests-at-each-time-point-result-in-ambiguous-inference" class="section level5 hasAnchor" number="13.3.1.9.3">
<h5><span class="header-section-number">13.3.1.9.3</span> A <em>t</em> test of the AUC or separate <em>t</em>-tests at each time point result in ambiguous inference<a href="issues.html#a-t-test-of-the-auc-or-separate-t-tests-at-each-time-point-result-in-ambiguous-inference" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><strong>t-test of the AUC</strong></p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="issues.html#cb381-1" tabindex="-1"></a>m3_t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(auc <span class="sc">~</span> treatment,</span>
<span id="cb381-2"><a href="issues.html#cb381-2" tabindex="-1"></a>       <span class="at">data =</span> fig3f_wide,</span>
<span id="cb381-3"><a href="issues.html#cb381-3" tabindex="-1"></a>       <span class="at">var.equal =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb381-4"><a href="issues.html#cb381-4" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb381-5"><a href="issues.html#cb381-5" tabindex="-1"></a></span>
<span id="cb381-6"><a href="issues.html#cb381-6" tabindex="-1"></a>m3_t[<span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>)]</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   estimate statistic p.value parameter conf.low conf.high
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1   -19185     -3.52 0.00422        12  -31057.    -7313.</code></pre>
<p><strong>Separate t-tests at each time point</strong></p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="issues.html#cb383-1" tabindex="-1"></a>m4_t0 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(time_0 <span class="sc">~</span> treatment, <span class="at">data =</span> fig3f_wide, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb383-2"><a href="issues.html#cb383-2" tabindex="-1"></a>m4_t30 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(time_30 <span class="sc">~</span> treatment, <span class="at">data =</span> fig3f_wide, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb383-3"><a href="issues.html#cb383-3" tabindex="-1"></a>m4_t60 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(time_60 <span class="sc">~</span> treatment, <span class="at">data =</span> fig3f_wide, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb383-4"><a href="issues.html#cb383-4" tabindex="-1"></a>m4_t90 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(time_90 <span class="sc">~</span> treatment, <span class="at">data =</span> fig3f_wide, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb383-5"><a href="issues.html#cb383-5" tabindex="-1"></a>m4_t120 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(time_120 <span class="sc">~</span> treatment, <span class="at">data =</span> fig3f_wide, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb383-6"><a href="issues.html#cb383-6" tabindex="-1"></a></span>
<span id="cb383-7"><a href="issues.html#cb383-7" tabindex="-1"></a>m4_t <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb383-8"><a href="issues.html#cb383-8" tabindex="-1"></a>  <span class="at">Time =</span> times,</span>
<span id="cb383-9"><a href="issues.html#cb383-9" tabindex="-1"></a>  <span class="at">p.value =</span> <span class="fu">c</span>(m4_t0<span class="sc">$</span>p.value,</span>
<span id="cb383-10"><a href="issues.html#cb383-10" tabindex="-1"></a>              m4_t30<span class="sc">$</span>p.value,</span>
<span id="cb383-11"><a href="issues.html#cb383-11" tabindex="-1"></a>              m4_t60<span class="sc">$</span>p.value,</span>
<span id="cb383-12"><a href="issues.html#cb383-12" tabindex="-1"></a>              m4_t90<span class="sc">$</span>p.value,</span>
<span id="cb383-13"><a href="issues.html#cb383-13" tabindex="-1"></a>              m4_t120<span class="sc">$</span>p.value</span>
<span id="cb383-14"><a href="issues.html#cb383-14" tabindex="-1"></a>  )</span>
<span id="cb383-15"><a href="issues.html#cb383-15" tabindex="-1"></a>)</span>
<span id="cb383-16"><a href="issues.html#cb383-16" tabindex="-1"></a></span>
<span id="cb383-17"><a href="issues.html#cb383-17" tabindex="-1"></a>m4_t <span class="sc">%&gt;%</span></span>
<span id="cb383-18"><a href="issues.html#cb383-18" tabindex="-1"></a>  kable <span class="sc">%&gt;%</span></span>
<span id="cb383-19"><a href="issues.html#cb383-19" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
Time
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0014957
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
0.0006251
</td>
</tr>
<tr>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
0.0096282
</td>
</tr>
<tr>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
0.0137238
</td>
</tr>
<tr>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
0.0263193
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="normalization-the-analysis-of-ratios" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Normalization – the analysis of ratios<a href="issues.html#normalization-the-analysis-of-ratios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="kinds-of-ratios-in-experimental-biology" class="section level3 hasAnchor" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Kinds of ratios in experimental biology<a href="issues.html#kinds-of-ratios-in-experimental-biology" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>The ratio is a density (count per length/area/volume) or a rate (count/time).</li>
</ol>
<ul>
<li>Example: number of marked cells per area of tissue.</li>
<li>Best practice: GLM for count data with an <strong>offset</strong> in the model, where an offset is the denominator of the ratio.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>The ratio is relative to a standard (“normalized”).
Example: expression of focal mRNA relative to expression of a standard mRNA that is thought not to be affected by treatment.
Best practice: GLM for count data with an <strong>offset</strong> in the model, where an offset is the denominator of the ratio.</li>
<li>The ratio is a proportion (or percent).</li>
</ol>
<ul>
<li>Example: Number of marked cells per total number of cells.</li>
<li>Best practice: GLM logistic.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>The ratio is relative to a whole and both the thing in the numerator and the thing in the denominator grow (<strong>allometric data</strong>).</li>
</ol>
<ul>
<li>Example: adipose mass relative to total lean body mass.</li>
<li>Best practice: ANCOVA linear model.</li>
<li><strong>Alert!</strong> – It has been known for more than 100 years, and repeatedly broadcasted, that inference from ratios of allometric data range from merely wrong (the inferred effect size is in the right direction, but wrong) to absurd (the direction of the inferred effect is opposite that of the true effect).</li>
</ul>
</div>
<div id="issues-offset" class="section level3 hasAnchor" number="13.4.2">
<h3><span class="header-section-number">13.4.2</span> Example 1 – The ratio is a density (number of something per area)<a href="issues.html#issues-offset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Researchers frequently count objects and compare the counts among treatments. A problem that often arises is that the counts are made in samples with different areas or volumes of tissue. As a consequence, the variation in treatment response is confounded with tissue size – samples with higher counts may have higher counts because of a different response to treatment, a larger amount of tissue, or some combination. The common practice in experimental biology is to adjust for tissue size variation by constructing the ratio <span class="math inline">\(\frac{count}{area}\)</span> and then testing for a difference in the ratio using either a linear model NHST (<em>t</em>-test/ANOVA) or a non-parametric NHST (Mann-Whitney-Wilcoxan). The issue is, the initial counts will have some kind of count distribution (Poisson or negative binomial) that can sometimes look like a sample from a normal distribution (see <a href="counts.html#glm-counts">Introducing Generalized Linear Models using a count data example</a>). The ratio will have some kind of <a href="https://en.wikipedia.org/wiki/Ratio_distribution" target="_blank">ratio distribution</a> that is hard to model correctly.</p>
<p>A better practice is to model the count using a <strong>Generalized Linear Model</strong> (GLM) and an <strong>offset</strong> that adjusts for differences in the area of the sample. NHST of the ratios will perform okay in the sense of Type I error that is close to nominal but will have relatively low power compared to a generalized linear model with offset. If the researcher is interested in best practices including the reporting of uncertainty of estimated effects, a GLM will have more useful confidence intervals – for example CIs from linear model assuming Normal error can often include absurd values such as ratios less than zero.</p>
<p>Source article (Fernández, Álvaro F., et al. “Disruption of the beclin 1–BCL2 autophagy regulatory complex promotes longevity in mice.” Nature 558.7708 (2018): 136-140.)<span target="_blank"><a href="https://www.nature.com/articles/s41586-018-0162-7" class="uri">https://www.nature.com/articles/s41586-018-0162-7</a></span></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5992097/" target="_blank">Public source</a></p>
<p><a href="https://www.nature.com/articles/s41586-018-0162-7#Sec15" target="_blank">Source data for Fig. 3</a></p>
<p>The example here is from Fig 3b.</p>
<p>Response variable – number of <a href="https://en.wikipedia.org/wiki/TUNEL_assay" target="_blank">TUNEL+</a> cells measured in kidney tissue, where a positive marker indicates nuclear DNA damage.</p>
<p>Background. The experiments in Figure 3 were designed to measure the effect of a knock-in mutation in the gene for the <a href="https://en.wikipedia.org/wiki/BECN1" target="_blank">beclin 1 protein</a> on autophagy and tissue health in the kidney and heart. The researchers were interested in autophagy because there is evidence in many non-mammalian model organisms that increased autophagy reduces age-related damage to tissues and increases health and lifespan. <a href="https://en.wikipedia.org/wiki/Bcl-2" target="_blank">BCL2</a> is an autophagy inhibitor. Initial experiments showed that the knock-in mutation in beclin 1 inhibits BCL2. Inhibiting BCL2 with the knock-in mutation should increase autophagy and, as a consequence, reduce age-related tissue damage.</p>
<p>The researchers measured Tunel+ cells in both 2 month old and 20 month old mice in order to look at age related effects. This design is <strong>factorial</strong> with two factors (<span class="math inline">\(\texttt{age}\)</span> and <span class="math inline">\(\texttt{genotype}\)</span>. Because we haven’t covered factorial designs in this text, I limit the analysis to the 20 month old mice.</p>
<p>Design - single factor <span class="math inline">\(\texttt{genotype}\)</span> with levels “WT” (wildtype) and “KI” (knock-in).</p>
<p>The code for importing the exp3b data is in Section <a href="issues.html#issues-import-exp3b">13.8.6</a> below.</p>
<div id="fit-the-models" class="section level4 hasAnchor" number="13.4.2.1">
<h4><span class="header-section-number">13.4.2.1</span> Fit the models<a href="issues.html#fit-the-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="issues.html#cb384-1" tabindex="-1"></a>exp3b_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(count_per_area <span class="sc">~</span> genotype, <span class="at">data =</span> exp3b)</span>
<span id="cb384-2"><a href="issues.html#cb384-2" tabindex="-1"></a></span>
<span id="cb384-3"><a href="issues.html#cb384-3" tabindex="-1"></a>exp3b_m2 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(positive_nuclei <span class="sc">~</span> genotype <span class="sc">+</span></span>
<span id="cb384-4"><a href="issues.html#cb384-4" tabindex="-1"></a>                     <span class="fu">offset</span>(<span class="fu">log</span>(area_mm2)),</span>
<span id="cb384-5"><a href="issues.html#cb384-5" tabindex="-1"></a>                   <span class="at">data =</span> exp3b)</span>
<span id="cb384-6"><a href="issues.html#cb384-6" tabindex="-1"></a></span>
<span id="cb384-7"><a href="issues.html#cb384-7" tabindex="-1"></a>exp3b_m3 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(count_per_area <span class="sc">~</span> genotype, <span class="at">data =</span> exp3b)</span></code></pre></div>
</div>
<div id="check-the-models" class="section level4 hasAnchor" number="13.4.2.2">
<h4><span class="header-section-number">13.4.2.2</span> Check the models<a href="issues.html#check-the-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="issues.html#cb385-1" tabindex="-1"></a><span class="fu">ggcheck_the_model</span>(exp3b_m1)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/issues-exp3b_m1-check-1.png" width="576" /></p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="issues.html#cb386-1" tabindex="-1"></a>exp3b_m2_simulation <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> exp3b_m2, <span class="at">n =</span> <span class="dv">250</span>)</span>
<span id="cb386-2"><a href="issues.html#cb386-2" tabindex="-1"></a><span class="fu">plot</span>(exp3b_m2_simulation, <span class="at">asFactor =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/issues-exp3b_m2_simulation-1.png" width="576" /></p>
</div>
<div id="issues-exp3a-m3-inference" class="section level4 hasAnchor" number="13.4.2.3">
<h4><span class="header-section-number">13.4.2.3</span> Inference from the model<a href="issues.html#issues-exp3a-m3-inference" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="issues.html#cb387-1" tabindex="-1"></a>exp3b_m2_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(exp3b_m2)),</span>
<span id="cb387-2"><a href="issues.html#cb387-2" tabindex="-1"></a>                       <span class="fu">confint</span>(exp3b_m2))</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std. Error
</th>
<th style="text-align:right;">
z value
</th>
<th style="text-align:right;">
Pr(&gt;&amp;#124;z&amp;#124;)
</th>
<th style="text-align:right;">
2.5 %
</th>
<th style="text-align:right;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.295
</td>
<td style="text-align:right;">
2.7
</td>
<td style="text-align:right;">
0.007
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
1.43
</td>
</tr>
<tr>
<td style="text-align:left;">
genotypeKI
</td>
<td style="text-align:right;">
-0.76
</td>
<td style="text-align:right;">
0.393
</td>
<td style="text-align:right;">
-1.9
</td>
<td style="text-align:right;">
0.053
</td>
<td style="text-align:right;">
-1.55
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="issues.html#cb388-1" tabindex="-1"></a>exp3b_m2_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(exp3b_m2,</span>
<span id="cb388-2"><a href="issues.html#cb388-2" tabindex="-1"></a>                        <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">&quot;genotype&quot;</span>),</span>
<span id="cb388-3"><a href="issues.html#cb388-3" tabindex="-1"></a>                        <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
genotype
</th>
<th style="text-align:right;">
response
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
asymp.LCL
</th>
<th style="text-align:right;">
asymp.UCL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
WT
</td>
<td style="text-align:right;">
58.6
</td>
<td style="text-align:right;">
17.25
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
32.9
</td>
<td style="text-align:right;">
104.32
</td>
</tr>
<tr>
<td style="text-align:left;">
KI
</td>
<td style="text-align:right;">
27.4
</td>
<td style="text-align:right;">
7.12
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
16.5
</td>
<td style="text-align:right;">
45.63
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="issues.html#cb389-1" tabindex="-1"></a>exp3b_m2_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(exp3b_m2_emm,</span>
<span id="cb389-2"><a href="issues.html#cb389-2" tabindex="-1"></a>                             <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb389-3"><a href="issues.html#cb389-3" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
ratio
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
asymp.LCL
</th>
<th style="text-align:right;">
asymp.UCL
</th>
<th style="text-align:right;">
null
</th>
<th style="text-align:right;">
z.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
KI / WT
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.184
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
1.01
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1.93266
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
</div>
<div id="plot-the-model-1" class="section level4 hasAnchor" number="13.4.2.4">
<h4><span class="header-section-number">13.4.2.4</span> Plot the model<a href="issues.html#plot-the-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/issues-exp3b-plot_the_model-1.png" width="576" /></p>
<p>The code for this plot is in Section <a href="issues.html#issues-exp3b-plot">13.8.7</a> below.</p>
</div>
</div>
<div id="issues-size" class="section level3 hasAnchor" number="13.4.3">
<h3><span class="header-section-number">13.4.3</span> Example 2 – The ratio is normalizing for size differences<a href="issues.html#issues-size" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="issues.html#cb390-1" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;A big-data approach to understanding metabolic rate and response to obesity in laboratory mice&quot;</span></span>
<span id="cb390-2"><a href="issues.html#cb390-2" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;mmpc_all_phases.csv&quot;</span></span>
<span id="cb390-3"><a href="issues.html#cb390-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb390-4"><a href="issues.html#cb390-4" tabindex="-1"></a></span>
<span id="cb390-5"><a href="issues.html#cb390-5" tabindex="-1"></a>geometric_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb390-6"><a href="issues.html#cb390-6" tabindex="-1"></a>  gm <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(x)))</span>
<span id="cb390-7"><a href="issues.html#cb390-7" tabindex="-1"></a>  <span class="fu">return</span>(gm)</span>
<span id="cb390-8"><a href="issues.html#cb390-8" tabindex="-1"></a>}</span>
<span id="cb390-9"><a href="issues.html#cb390-9" tabindex="-1"></a>exp1 <span class="ot">&lt;-</span> <span class="fu">fread</span>(file_path)</span>
<span id="cb390-10"><a href="issues.html#cb390-10" tabindex="-1"></a>exp1 <span class="ot">&lt;-</span> exp1[acclimation <span class="sc">==</span> <span class="st">&quot;TRUE&quot;</span>, ]</span>
<span id="cb390-11"><a href="issues.html#cb390-11" tabindex="-1"></a></span>
<span id="cb390-12"><a href="issues.html#cb390-12" tabindex="-1"></a>exp1[, resid_mass <span class="sc">:=</span> total_mass <span class="sc">-</span> fat_mass <span class="sc">-</span> lean_mass]</span>
<span id="cb390-13"><a href="issues.html#cb390-13" tabindex="-1"></a>exp1[, nonfat_mass <span class="sc">:=</span> total_mass <span class="sc">-</span> fat_mass]</span>
<span id="cb390-14"><a href="issues.html#cb390-14" tabindex="-1"></a></span>
<span id="cb390-15"><a href="issues.html#cb390-15" tabindex="-1"></a>size_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;fat_mass&quot;</span>, <span class="st">&quot;lean_mass&quot;</span>, <span class="st">&quot;resid_mass&quot;</span>)</span>
<span id="cb390-16"><a href="issues.html#cb390-16" tabindex="-1"></a>exp1[, size <span class="sc">:=</span> <span class="fu">apply</span>(exp1[, .SD, <span class="at">.SDcols =</span> size_cols], <span class="dv">1</span>, geometric_mean)]</span>
<span id="cb390-17"><a href="issues.html#cb390-17" tabindex="-1"></a>size_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;fat_mass&quot;</span>, <span class="st">&quot;lean_mass&quot;</span>, <span class="st">&quot;resid_mass&quot;</span>, <span class="st">&quot;total_mass&quot;</span>, <span class="st">&quot;size&quot;</span>)</span>
<span id="cb390-18"><a href="issues.html#cb390-18" tabindex="-1"></a><span class="fu">cor</span>(exp1[, .SD, <span class="at">.SDcols =</span> size_cols])</span></code></pre></div>
<pre><code>##              fat_mass  lean_mass  resid_mass total_mass      size
## fat_mass    1.0000000  0.6486331 -0.03980370 0.94096284 0.8192087
## lean_mass   0.6486331  1.0000000 -0.41585035 0.78512117 0.4214359
## resid_mass -0.0398037 -0.4158503  1.00000000 0.05819842 0.4595406
## total_mass  0.9409628  0.7851212  0.05819842 1.00000000 0.8589070
## size        0.8192087  0.4214359  0.45954060 0.85890700 1.0000000</code></pre>
</div>
</div>
<div id="dont-do-this-stuff" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Don’t do this stuff<a href="issues.html#dont-do-this-stuff" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="normalize-the-response-so-that-all-control-values-are-equal-to-1." class="section level3 hasAnchor" number="13.5.1">
<h3><span class="header-section-number">13.5.1</span> Normalize the response so that all control values are equal to 1.<a href="issues.html#normalize-the-response-so-that-all-control-values-are-equal-to-1." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In many experiments, the response variable is a measure with units that are not readily interpretable biologically. In these experiments, researchers often normalize the response by the mean of the reference group.</p>
<p><span class="math display">\[
y_i \; \mathrm{(normalized)} = \frac{y_i}{\overline{y}_{ref}}
\]</span></p>
<p>The normalized response variable is a multiple of (or a fraction) of the mean response of the reference group.</p>
<p>Less often, researchers normalize by the value of the reference within a batch – for example, the mean of the control group within each independent experiment – and then analyze the batch means with a <em>t</em>-test or ANOVA. If the goal of this by-experiment_id normalization is to adjust for the variance among the experiments, the proper way to do this is <a href="issues-combined-experiments">Linear mixed model for combining replicated experiments</a> above.</p>
<p>Regardless of the goal, don’t do this. There is no variance in the reference group as all <em>n</em> values are 1. A researcher is telling the <em>t</em>-test or ANOVA that there is no natural variability in the reference group (<em>and</em> the values were measured without measurement error). A classical (Student) <em>t</em>-test or ANOVA will have an incorrectly small error variance (<span class="math inline">\(\sigma\)</span>) because this zero-variance will go into the computation of the pooled (modeled) variance. The consequence is incorrectly small standard errors, confidence intervals, and <em>p</em>-values, and inflated false discovery.</p>
<p>Let’s do this, to show why we don’t do this. All examples that I’ve found in the literature only archive the batch-normalized data and not the raw data so I’m using fake data for this.</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="issues.html#cb392-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9</span>)</span>
<span id="cb392-2"><a href="issues.html#cb392-2" tabindex="-1"></a>n_exp <span class="ot">&lt;-</span> <span class="dv">8</span> <span class="co"># number of experiments</span></span>
<span id="cb392-3"><a href="issues.html#cb392-3" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb392-4"><a href="issues.html#cb392-4" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="co"># genotype effect as a multiple</span></span>
<span id="cb392-5"><a href="issues.html#cb392-5" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(beta_0, beta_0<span class="sc">*</span>beta_1)</span>
<span id="cb392-6"><a href="issues.html#cb392-6" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> (beta_1 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>beta_0 <span class="co"># iid error</span></span>
<span id="cb392-7"><a href="issues.html#cb392-7" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="co"># correlated error</span></span>
<span id="cb392-8"><a href="issues.html#cb392-8" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(sigma<span class="sc">^</span><span class="dv">2</span>, rho<span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>, rho<span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>, sigma<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb392-9"><a href="issues.html#cb392-9" tabindex="-1"></a>                <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb392-10"><a href="issues.html#cb392-10" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="cn">NULL</span>)</span>
<span id="cb392-11"><a href="issues.html#cb392-11" tabindex="-1"></a>fake_data[, genotype <span class="sc">:=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;ko&quot;</span>), <span class="at">each =</span> n_exp)]</span>
<span id="cb392-12"><a href="issues.html#cb392-12" tabindex="-1"></a>fake_data[, genotype <span class="sc">:=</span> <span class="fu">factor</span>(genotype,</span>
<span id="cb392-13"><a href="issues.html#cb392-13" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;ko&quot;</span>))]</span>
<span id="cb392-14"><a href="issues.html#cb392-14" tabindex="-1"></a></span>
<span id="cb392-15"><a href="issues.html#cb392-15" tabindex="-1"></a>fake_data[, experiment_id <span class="sc">:=</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&quot;exp_&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_exp), <span class="dv">2</span>)]</span>
<span id="cb392-16"><a href="issues.html#cb392-16" tabindex="-1"></a></span>
<span id="cb392-17"><a href="issues.html#cb392-17" tabindex="-1"></a><span class="co"># modeling the experiment means</span></span>
<span id="cb392-18"><a href="issues.html#cb392-18" tabindex="-1"></a>raw <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(n_exp, <span class="at">mean =</span> mu, <span class="at">sigma =</span> Sigma)</span>
<span id="cb392-19"><a href="issues.html#cb392-19" tabindex="-1"></a>fake_data[, y <span class="sc">:=</span> <span class="fu">c</span>(raw)]</span>
<span id="cb392-20"><a href="issues.html#cb392-20" tabindex="-1"></a></span>
<span id="cb392-21"><a href="issues.html#cb392-21" tabindex="-1"></a><span class="co"># mean-normalize by the mean of the experiment means of wt group</span></span>
<span id="cb392-22"><a href="issues.html#cb392-22" tabindex="-1"></a>fake_data[, y_correct <span class="sc">:=</span> <span class="fu">c</span>(raw<span class="sc">/</span><span class="fu">mean</span>(raw[,<span class="dv">1</span>]))]</span>
<span id="cb392-23"><a href="issues.html#cb392-23" tabindex="-1"></a></span>
<span id="cb392-24"><a href="issues.html#cb392-24" tabindex="-1"></a><span class="co"># id-normalize by experiment mean of wt group for each experiment_id</span></span>
<span id="cb392-25"><a href="issues.html#cb392-25" tabindex="-1"></a>fake_data[, y_wrong <span class="sc">:=</span> <span class="fu">c</span>(raw<span class="sc">/</span>raw[,<span class="dv">1</span>])]</span></code></pre></div>
<p>The best practice is a linear mixed model using the mean-normalized response (the paired <em>t</em>-test is a specific case of this).</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="issues.html#cb393-1" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(y_correct <span class="sc">~</span> genotype <span class="sc">+</span></span>
<span id="cb393-2"><a href="issues.html#cb393-2" tabindex="-1"></a>             (<span class="dv">1</span><span class="sc">|</span>experiment_id),</span>
<span id="cb393-3"><a href="issues.html#cb393-3" tabindex="-1"></a>           <span class="at">data =</span> fake_data)</span>
<span id="cb393-4"><a href="issues.html#cb393-4" tabindex="-1"></a></span>
<span id="cb393-5"><a href="issues.html#cb393-5" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="st">&quot;genotype&quot;</span>)</span>
<span id="cb393-6"><a href="issues.html#cb393-6" tabindex="-1"></a>m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb393-7"><a href="issues.html#cb393-7" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb393-8"><a href="issues.html#cb393-8" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The common practice is a linear model using the mean-normalized response (the Student <em>t</em>-test is a specific case of this). This model violates the independence assumption but this violation usually results in less precision and lower power.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="issues.html#cb394-1" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_correct <span class="sc">~</span> genotype,</span>
<span id="cb394-2"><a href="issues.html#cb394-2" tabindex="-1"></a>           <span class="at">data =</span> fake_data)</span>
<span id="cb394-3"><a href="issues.html#cb394-3" tabindex="-1"></a></span>
<span id="cb394-4"><a href="issues.html#cb394-4" tabindex="-1"></a>m2_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m2, <span class="at">specs =</span> <span class="st">&quot;genotype&quot;</span>)</span>
<span id="cb394-5"><a href="issues.html#cb394-5" tabindex="-1"></a>m2_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m2_emm,</span>
<span id="cb394-6"><a href="issues.html#cb394-6" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb394-7"><a href="issues.html#cb394-7" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The incorrect practice is a linear model (or <em>t</em>-test or ANOVA) using the id-normalized response. This model violates heterogeneity and estimates the error variance using a group with zero variation.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="issues.html#cb395-1" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_wrong <span class="sc">~</span> genotype,</span>
<span id="cb395-2"><a href="issues.html#cb395-2" tabindex="-1"></a>           <span class="at">data =</span> fake_data)</span>
<span id="cb395-3"><a href="issues.html#cb395-3" tabindex="-1"></a></span>
<span id="cb395-4"><a href="issues.html#cb395-4" tabindex="-1"></a>m3_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m3, <span class="at">specs =</span> <span class="st">&quot;genotype&quot;</span>)</span>
<span id="cb395-5"><a href="issues.html#cb395-5" tabindex="-1"></a>m3_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m3_emm,</span>
<span id="cb395-6"><a href="issues.html#cb395-6" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb395-7"><a href="issues.html#cb395-7" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>A summary table of the three models …</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
method
</th>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
paired t
</td>
<td style="text-align:left;">
ko - wt
</td>
<td style="text-align:right;">
0.206
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
2.42
</td>
<td style="text-align:right;">
0.0459
</td>
</tr>
<tr>
<td style="text-align:left;">
student t
</td>
<td style="text-align:left;">
ko - wt
</td>
<td style="text-align:right;">
0.206
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
1.33
</td>
<td style="text-align:right;">
0.2047
</td>
</tr>
<tr>
<td style="text-align:left;">
dont do this t
</td>
<td style="text-align:left;">
ko - wt
</td>
<td style="text-align:right;">
0.318
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
2.40
</td>
<td style="text-align:right;">
0.0308
</td>
</tr>
</tbody>
</table>
<p>and a plot of the mean-normalized and id-normalized data and modeled means and CIs.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="issues.html#cb396-1" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> <span class="fu">ggplot_the_response</span>(m1, m1_emm, m1_pairs)</span>
<span id="cb396-2"><a href="issues.html#cb396-2" tabindex="-1"></a>gg2 <span class="ot">&lt;-</span> <span class="fu">ggplot_the_response</span>(m3,</span>
<span id="cb396-3"><a href="issues.html#cb396-3" tabindex="-1"></a>                           m3_emm,</span>
<span id="cb396-4"><a href="issues.html#cb396-4" tabindex="-1"></a>                           m3_pairs,</span>
<span id="cb396-5"><a href="issues.html#cb396-5" tabindex="-1"></a>                           <span class="at">dots =</span> <span class="st">&quot;jitter&quot;</span>)</span>
<span id="cb396-6"><a href="issues.html#cb396-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb396-7"><a href="issues.html#cb396-7" tabindex="-1"></a><span class="fu">plot_grid</span>(gg1, gg2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="st">&quot;AUTO&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:issues-normalize-to-1-plot"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/issues-normalize-to-1-plot-1.png" alt="Plot of the fake normalized data and modeled means and CI from A) model m1, the linear mixed model with experiment_id as a random factor and B) model m3, the linear model of the response normalized to each experiment mean." width="576" />
<p class="caption">
Figure 13.6: Plot of the fake normalized data and modeled means and CI from A) model m1, the linear mixed model with experiment_id as a random factor and B) model m3, the linear model of the response normalized to each experiment mean.
</p>
</div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
</div>
</div>
<div id="a-difference-in-significance-is-not-necessarily-significant" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> A difference in significance is not necessarily significant<a href="issues.html#a-difference-in-significance-is-not-necessarily-significant" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Thermal stress induces glycolytic beige fat formation via a myogenic state</p>
<p>Figure 2j</p>
</div>
<div id="researcher-degrees-of-freedom" class="section level2 hasAnchor" number="13.7">
<h2><span class="header-section-number">13.7</span> Researcher degrees of freedom<a href="issues.html#researcher-degrees-of-freedom" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="hidden-code-5" class="section level2 hasAnchor" number="13.8">
<h2><span class="header-section-number">13.8</span> Hidden code<a href="issues.html#hidden-code-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="import-exp4d-vimentin-cell-count-data-replicate-experiments-example" class="section level3 hasAnchor" number="13.8.1">
<h3><span class="header-section-number">13.8.1</span> Import exp4d vimentin cell count data (replicate experiments example)<a href="issues.html#import-exp4d-vimentin-cell-count-data-replicate-experiments-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="issues.html#cb397-1" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Distinct inflammatory and wound healing responses to complex caudal fin injuries of larval zebrafish&quot;</span></span>
<span id="cb397-2"><a href="issues.html#cb397-2" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;elife-45976-fig4-data2-v1.xlsx&quot;</span></span>
<span id="cb397-3"><a href="issues.html#cb397-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb397-4"><a href="issues.html#cb397-4" tabindex="-1"></a></span>
<span id="cb397-5"><a href="issues.html#cb397-5" tabindex="-1"></a>exp4d_wide <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb397-6"><a href="issues.html#cb397-6" tabindex="-1"></a>                         <span class="at">sheet =</span> <span class="st">&quot;Sheet1&quot;</span>,</span>
<span id="cb397-7"><a href="issues.html#cb397-7" tabindex="-1"></a>                         <span class="at">range =</span> <span class="st">&quot;A16:C49&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb397-8"><a href="issues.html#cb397-8" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb397-9"><a href="issues.html#cb397-9" tabindex="-1"></a></span>
<span id="cb397-10"><a href="issues.html#cb397-10" tabindex="-1"></a>exp4d_wide[, experiment_id <span class="sc">:=</span> <span class="fu">nafill</span>(Replicate, <span class="at">type =</span> <span class="st">&quot;locf&quot;</span>)]</span>
<span id="cb397-11"><a href="issues.html#cb397-11" tabindex="-1"></a>exp4d_wide[, experiment_id <span class="sc">:=</span> <span class="fu">paste0</span>(<span class="st">&quot;Exp&quot;</span>, experiment_id)]</span>
<span id="cb397-12"><a href="issues.html#cb397-12" tabindex="-1"></a></span>
<span id="cb397-13"><a href="issues.html#cb397-13" tabindex="-1"></a>old_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;STAT3 +/+&quot;</span>, <span class="st">&quot;STAT3 -/-&quot;</span>)</span>
<span id="cb397-14"><a href="issues.html#cb397-14" tabindex="-1"></a>genotype_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;STAT3_wt&quot;</span>, <span class="st">&quot;STAT3_ko&quot;</span>)</span>
<span id="cb397-15"><a href="issues.html#cb397-15" tabindex="-1"></a><span class="fu">setnames</span>(exp4d_wide, <span class="at">old =</span> old_cols, <span class="at">new =</span> genotype_levels)</span>
<span id="cb397-16"><a href="issues.html#cb397-16" tabindex="-1"></a>exp4d <span class="ot">&lt;-</span> <span class="fu">melt</span>(exp4d_wide,</span>
<span id="cb397-17"><a href="issues.html#cb397-17" tabindex="-1"></a>              <span class="at">id.vars =</span> <span class="st">&quot;experiment_id&quot;</span>,</span>
<span id="cb397-18"><a href="issues.html#cb397-18" tabindex="-1"></a>              <span class="at">measure.vars =</span> genotype_levels,</span>
<span id="cb397-19"><a href="issues.html#cb397-19" tabindex="-1"></a>              <span class="at">variable.name =</span> <span class="st">&quot;genotype&quot;</span>,</span>
<span id="cb397-20"><a href="issues.html#cb397-20" tabindex="-1"></a>              <span class="at">value.name =</span> <span class="st">&quot;vimentin_cells&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># cell count</span></span>
<span id="cb397-21"><a href="issues.html#cb397-21" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb397-22"><a href="issues.html#cb397-22" tabindex="-1"></a>exp4d[, genotype <span class="sc">:=</span> <span class="fu">factor</span>(genotype,</span>
<span id="cb397-23"><a href="issues.html#cb397-23" tabindex="-1"></a>                           <span class="at">levels =</span> genotype_levels)]</span></code></pre></div>
</div>
<div id="import-fig4c-data" class="section level3 hasAnchor" number="13.8.2">
<h3><span class="header-section-number">13.8.2</span> Import Fig4c data<a href="issues.html#import-fig4c-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="issues.html#cb398-1" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Identification of osteoclast-osteoblast coupling factors in humans reveals links between bone and energy metabolism&quot;</span></span>
<span id="cb398-2"><a href="issues.html#cb398-2" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41467_2019_14003_MOESM6_ESM.xlsx&quot;</span></span>
<span id="cb398-3"><a href="issues.html#cb398-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb398-4"><a href="issues.html#cb398-4" tabindex="-1"></a></span>
<span id="cb398-5"><a href="issues.html#cb398-5" tabindex="-1"></a>fig4c_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;text&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">8</span>))</span>
<span id="cb398-6"><a href="issues.html#cb398-6" tabindex="-1"></a>fig4c <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb398-7"><a href="issues.html#cb398-7" tabindex="-1"></a>                   <span class="at">sheet =</span> <span class="st">&quot;Fig4C and 4E&quot;</span>,</span>
<span id="cb398-8"><a href="issues.html#cb398-8" tabindex="-1"></a>                   <span class="at">range =</span> <span class="st">&quot;A3:I48&quot;</span>,</span>
<span id="cb398-9"><a href="issues.html#cb398-9" tabindex="-1"></a>                   <span class="at">col_names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb398-10"><a href="issues.html#cb398-10" tabindex="-1"></a>                   col_types <span class="ot">&lt;-</span> fig4c_type) <span class="sc">%&gt;%</span></span>
<span id="cb398-11"><a href="issues.html#cb398-11" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb398-12"><a href="issues.html#cb398-12" tabindex="-1"></a></span>
<span id="cb398-13"><a href="issues.html#cb398-13" tabindex="-1"></a><span class="co"># DPP4 (ng/mL), GLP-1 (pM), Glucose (mmol/L),   Insulin (uIU/mL)</span></span>
<span id="cb398-14"><a href="issues.html#cb398-14" tabindex="-1"></a>measures <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DPP4&quot;</span>, <span class="st">&quot;GLP1&quot;</span>, <span class="st">&quot;Glucose&quot;</span>, <span class="st">&quot;Insulin&quot;</span>)</span>
<span id="cb398-15"><a href="issues.html#cb398-15" tabindex="-1"></a><span class="co"># post is 3 months post treatment</span></span>
<span id="cb398-16"><a href="issues.html#cb398-16" tabindex="-1"></a>period <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;baseline&quot;</span>, <span class="st">&quot;post&quot;</span>)</span>
<span id="cb398-17"><a href="issues.html#cb398-17" tabindex="-1"></a>new_colnames <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">rep</span>(measures, <span class="dv">2</span>),</span>
<span id="cb398-18"><a href="issues.html#cb398-18" tabindex="-1"></a>                      <span class="fu">rep</span>(period, <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb398-19"><a href="issues.html#cb398-19" tabindex="-1"></a>                      <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb398-20"><a href="issues.html#cb398-20" tabindex="-1"></a></span>
<span id="cb398-21"><a href="issues.html#cb398-21" tabindex="-1"></a>old_colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(fig4c)</span>
<span id="cb398-22"><a href="issues.html#cb398-22" tabindex="-1"></a><span class="fu">setnames</span>(fig4c,</span>
<span id="cb398-23"><a href="issues.html#cb398-23" tabindex="-1"></a>         <span class="at">old =</span> old_colnames,</span>
<span id="cb398-24"><a href="issues.html#cb398-24" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb398-25"><a href="issues.html#cb398-25" tabindex="-1"></a>                 new_colnames))</span>
<span id="cb398-26"><a href="issues.html#cb398-26" tabindex="-1"></a></span>
<span id="cb398-27"><a href="issues.html#cb398-27" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Placebo&quot;</span>, <span class="st">&quot;Denosumab&quot;</span>)</span>
<span id="cb398-28"><a href="issues.html#cb398-28" tabindex="-1"></a>fig4c[, treatment <span class="sc">:=</span> <span class="fu">factor</span>(treatment,</span>
<span id="cb398-29"><a href="issues.html#cb398-29" tabindex="-1"></a>                            <span class="at">levels =</span> treatment_levels)]</span>
<span id="cb398-30"><a href="issues.html#cb398-30" tabindex="-1"></a>fig4c[, id <span class="sc">:=</span> <span class="fu">paste0</span>(<span class="st">&quot;human_&quot;</span>, .I)] <span class="co"># .I inserts row number</span></span>
<span id="cb398-31"><a href="issues.html#cb398-31" tabindex="-1"></a><span class="co">#View(fig4c)</span></span></code></pre></div>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="issues.html#cb399-1" tabindex="-1"></a>fig4c_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(fig4c,</span>
<span id="cb399-2"><a href="issues.html#cb399-2" tabindex="-1"></a>                  <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;treatment&quot;</span>),</span>
<span id="cb399-3"><a href="issues.html#cb399-3" tabindex="-1"></a>                  <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">&quot;DPP4_baseline&quot;</span>, <span class="st">&quot;DPP4_post&quot;</span>),</span>
<span id="cb399-4"><a href="issues.html#cb399-4" tabindex="-1"></a>                  <span class="at">variable.name =</span> <span class="st">&quot;time&quot;</span>,</span>
<span id="cb399-5"><a href="issues.html#cb399-5" tabindex="-1"></a>                  <span class="at">value.name =</span> <span class="st">&quot;dpp4&quot;</span>)</span>
<span id="cb399-6"><a href="issues.html#cb399-6" tabindex="-1"></a></span>
<span id="cb399-7"><a href="issues.html#cb399-7" tabindex="-1"></a>fig4c_long[, time <span class="sc">:=</span> <span class="fu">substr</span>(<span class="fu">as.character</span>(time),</span>
<span id="cb399-8"><a href="issues.html#cb399-8" tabindex="-1"></a>                             <span class="dv">6</span>,</span>
<span id="cb399-9"><a href="issues.html#cb399-9" tabindex="-1"></a>                             <span class="fu">nchar</span>(<span class="fu">as.character</span>(time)))]</span>
<span id="cb399-10"><a href="issues.html#cb399-10" tabindex="-1"></a>fig4c_long[, time <span class="sc">:=</span> <span class="fu">factor</span>(time,</span>
<span id="cb399-11"><a href="issues.html#cb399-11" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;baseline&quot;</span>, <span class="st">&quot;post&quot;</span>))]</span>
<span id="cb399-12"><a href="issues.html#cb399-12" tabindex="-1"></a></span>
<span id="cb399-13"><a href="issues.html#cb399-13" tabindex="-1"></a><span class="co"># View(fig4c_long)</span></span></code></pre></div>
</div>
<div id="xx-males-fig1c" class="section level3 hasAnchor" number="13.8.3">
<h3><span class="header-section-number">13.8.3</span> XX males fig1c<a href="issues.html#xx-males-fig1c" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="issues.html#cb400-1" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;XX sex chromosome complement promotes atherosclerosis in mice&quot;</span></span>
<span id="cb400-2"><a href="issues.html#cb400-2" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41467_2019_10462_MOESM6_ESM.xlsx&quot;</span></span>
<span id="cb400-3"><a href="issues.html#cb400-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb400-4"><a href="issues.html#cb400-4" tabindex="-1"></a>fig1c_1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb400-5"><a href="issues.html#cb400-5" tabindex="-1"></a>                         <span class="at">sheet =</span> <span class="st">&quot;Figure 1C&quot;</span>,</span>
<span id="cb400-6"><a href="issues.html#cb400-6" tabindex="-1"></a>                         <span class="at">range =</span> <span class="st">&quot;C3:G6&quot;</span>,</span>
<span id="cb400-7"><a href="issues.html#cb400-7" tabindex="-1"></a>                         <span class="at">col_names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb400-8"><a href="issues.html#cb400-8" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb400-9"><a href="issues.html#cb400-9" tabindex="-1"></a><span class="fu">setnames</span>(fig1c_1,</span>
<span id="cb400-10"><a href="issues.html#cb400-10" tabindex="-1"></a>         <span class="at">old =</span> <span class="fu">colnames</span>(fig1c_1),</span>
<span id="cb400-11"><a href="issues.html#cb400-11" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">paste</span>(<span class="st">&quot;mouse&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb400-12"><a href="issues.html#cb400-12" tabindex="-1"></a>fig1c_1[, time <span class="sc">:=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;baseline&quot;</span>, <span class="st">&quot;week_1&quot;</span>), <span class="at">each =</span> <span class="dv">2</span>)]</span>
<span id="cb400-13"><a href="issues.html#cb400-13" tabindex="-1"></a>fig1c_1[, sex <span class="sc">:=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>), <span class="dv">2</span>)]</span>
<span id="cb400-14"><a href="issues.html#cb400-14" tabindex="-1"></a></span>
<span id="cb400-15"><a href="issues.html#cb400-15" tabindex="-1"></a>fig1c_2 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb400-16"><a href="issues.html#cb400-16" tabindex="-1"></a>                         <span class="at">sheet =</span> <span class="st">&quot;Figure 1C&quot;</span>,</span>
<span id="cb400-17"><a href="issues.html#cb400-17" tabindex="-1"></a>                         <span class="at">range =</span> <span class="st">&quot;I3:M6&quot;</span>,</span>
<span id="cb400-18"><a href="issues.html#cb400-18" tabindex="-1"></a>                         <span class="at">col_names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb400-19"><a href="issues.html#cb400-19" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb400-20"><a href="issues.html#cb400-20" tabindex="-1"></a><span class="fu">setnames</span>(fig1c_2,</span>
<span id="cb400-21"><a href="issues.html#cb400-21" tabindex="-1"></a>         <span class="at">old =</span> <span class="fu">colnames</span>(fig1c_2),</span>
<span id="cb400-22"><a href="issues.html#cb400-22" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">paste</span>(<span class="st">&quot;mouse&quot;</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb400-23"><a href="issues.html#cb400-23" tabindex="-1"></a>fig1c_2[, time <span class="sc">:=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;baseline&quot;</span>, <span class="st">&quot;week_1&quot;</span>), <span class="at">each =</span> <span class="dv">2</span>)]</span>
<span id="cb400-24"><a href="issues.html#cb400-24" tabindex="-1"></a>fig1c_2[, sex <span class="sc">:=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>), <span class="dv">2</span>)]</span>
<span id="cb400-25"><a href="issues.html#cb400-25" tabindex="-1"></a></span>
<span id="cb400-26"><a href="issues.html#cb400-26" tabindex="-1"></a>fig1c <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.table</span>(<span class="at">chromosome =</span> <span class="st">&quot;xx&quot;</span>,</span>
<span id="cb400-27"><a href="issues.html#cb400-27" tabindex="-1"></a>                          <span class="fu">melt</span>(fig1c_1,</span>
<span id="cb400-28"><a href="issues.html#cb400-28" tabindex="-1"></a>                               <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;time&quot;</span>),</span>
<span id="cb400-29"><a href="issues.html#cb400-29" tabindex="-1"></a>                               <span class="at">variable.name =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb400-30"><a href="issues.html#cb400-30" tabindex="-1"></a>                               <span class="at">value.name =</span> <span class="st">&quot;fat_mass&quot;</span>)),</span>
<span id="cb400-31"><a href="issues.html#cb400-31" tabindex="-1"></a>               <span class="fu">data.table</span>(<span class="at">chromosome =</span> <span class="st">&quot;xy&quot;</span>,</span>
<span id="cb400-32"><a href="issues.html#cb400-32" tabindex="-1"></a>                          <span class="fu">melt</span>(fig1c_2,</span>
<span id="cb400-33"><a href="issues.html#cb400-33" tabindex="-1"></a>                               <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;time&quot;</span>),</span>
<span id="cb400-34"><a href="issues.html#cb400-34" tabindex="-1"></a>                               <span class="at">variable.name =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb400-35"><a href="issues.html#cb400-35" tabindex="-1"></a>                               <span class="at">value.name =</span> <span class="st">&quot;fat_mass&quot;</span>)))</span>
<span id="cb400-36"><a href="issues.html#cb400-36" tabindex="-1"></a><span class="co"># id is not unique</span></span>
<span id="cb400-37"><a href="issues.html#cb400-37" tabindex="-1"></a>fig1c[, id <span class="sc">:=</span> <span class="fu">paste</span>(sex, id, <span class="at">sep=</span><span class="st">&quot;_&quot;</span>)] <span class="co"># now it is</span></span>
<span id="cb400-38"><a href="issues.html#cb400-38" tabindex="-1"></a></span>
<span id="cb400-39"><a href="issues.html#cb400-39" tabindex="-1"></a>fig1c[, treatment <span class="sc">:=</span> <span class="fu">paste</span>(sex, chromosome, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)]</span>
<span id="cb400-40"><a href="issues.html#cb400-40" tabindex="-1"></a><span class="co"># unique(fig1c$treatment)</span></span>
<span id="cb400-41"><a href="issues.html#cb400-41" tabindex="-1"></a><span class="co"># &quot;female_xx&quot; &quot;male_xx&quot;   &quot;female_xy&quot; &quot;male_xy&quot;</span></span>
<span id="cb400-42"><a href="issues.html#cb400-42" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;female_xx&quot;</span>, <span class="st">&quot;female_xy&quot;</span>, <span class="st">&quot;male_xx&quot;</span>, <span class="st">&quot;male_xy&quot;</span>)</span>
<span id="cb400-43"><a href="issues.html#cb400-43" tabindex="-1"></a>fig1c[, treatment <span class="sc">:=</span> <span class="fu">factor</span>(treatment,</span>
<span id="cb400-44"><a href="issues.html#cb400-44" tabindex="-1"></a>                            <span class="at">levels =</span> treatment_levels)]</span>
<span id="cb400-45"><a href="issues.html#cb400-45" tabindex="-1"></a></span>
<span id="cb400-46"><a href="issues.html#cb400-46" tabindex="-1"></a>fig1c_wide <span class="ot">&lt;-</span> <span class="fu">dcast</span>(fig1c, chromosome <span class="sc">+</span> sex <span class="sc">+</span> id <span class="sc">+</span> treatment <span class="sc">~</span> time, <span class="at">value.var =</span> <span class="st">&quot;fat_mass&quot;</span>)</span>
<span id="cb400-47"><a href="issues.html#cb400-47" tabindex="-1"></a>fig1c_wide[, percent_change <span class="sc">:=</span> (week_1 <span class="sc">-</span> baseline)<span class="sc">/</span>baseline<span class="sc">*</span><span class="dv">100</span>]</span></code></pre></div>
</div>
<div id="generation-of-fake-data-to-illustrate-regression-to-the-mean" class="section level3 hasAnchor" number="13.8.4">
<h3><span class="header-section-number">13.8.4</span> Generation of fake data to illustrate regression to the mean<a href="issues.html#generation-of-fake-data-to-illustrate-regression-to-the-mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="issues.html#cb401-1" tabindex="-1"></a>n_iter <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb401-2"><a href="issues.html#cb401-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb401-3"><a href="issues.html#cb401-3" tabindex="-1"></a>np1 <span class="ot">&lt;-</span> n <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb401-4"><a href="issues.html#cb401-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb401-5"><a href="issues.html#cb401-5" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb401-6"><a href="issues.html#cb401-6" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb401-7"><a href="issues.html#cb401-7" tabindex="-1"></a>sigma_among <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb401-8"><a href="issues.html#cb401-8" tabindex="-1"></a>sigma_within <span class="ot">&lt;-</span> sigma_among<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb401-9"><a href="issues.html#cb401-9" tabindex="-1"></a>rho <span class="ot">&lt;-</span> sigma_among<span class="sc">/</span>(sigma_among <span class="sc">+</span> sigma_within)</span>
<span id="cb401-10"><a href="issues.html#cb401-10" tabindex="-1"></a>max_baseline_d <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">9999</span></span>
<span id="cb401-11"><a href="issues.html#cb401-11" tabindex="-1"></a></span>
<span id="cb401-12"><a href="issues.html#cb401-12" tabindex="-1"></a>time_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;post&quot;</span>)</span>
<span id="cb401-13"><a href="issues.html#cb401-13" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;cn&quot;</span>,<span class="st">&quot;tr&quot;</span>)</span>
<span id="cb401-14"><a href="issues.html#cb401-14" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb401-15"><a href="issues.html#cb401-15" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(treatment_levels, <span class="at">each =</span> n), <span class="dv">2</span>),</span>
<span id="cb401-16"><a href="issues.html#cb401-16" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(time_levels, <span class="at">each =</span> n<span class="sc">*</span><span class="dv">2</span>),</span>
<span id="cb401-17"><a href="issues.html#cb401-17" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&quot;mouse_0&quot;</span>, <span class="dv">1</span><span class="sc">:</span>N), <span class="dv">2</span>)</span>
<span id="cb401-18"><a href="issues.html#cb401-18" tabindex="-1"></a>)</span>
<span id="cb401-19"><a href="issues.html#cb401-19" tabindex="-1"></a>fake_data[, time <span class="sc">:=</span> <span class="fu">factor</span>(time,</span>
<span id="cb401-20"><a href="issues.html#cb401-20" tabindex="-1"></a>                           <span class="at">levels =</span> time_levels)]</span>
<span id="cb401-21"><a href="issues.html#cb401-21" tabindex="-1"></a>fake_data[, treatment <span class="sc">:=</span> <span class="fu">factor</span>(treatment,</span>
<span id="cb401-22"><a href="issues.html#cb401-22" tabindex="-1"></a>                                <span class="at">levels =</span> treatment_levels)]</span>
<span id="cb401-23"><a href="issues.html#cb401-23" tabindex="-1"></a>diff_pre <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb401-24"><a href="issues.html#cb401-24" tabindex="-1"></a>diff_post <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb401-25"><a href="issues.html#cb401-25" tabindex="-1"></a>ixn <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb401-26"><a href="issues.html#cb401-26" tabindex="-1"></a>ixn_p <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb401-27"><a href="issues.html#cb401-27" tabindex="-1"></a>p_ancova <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb401-28"><a href="issues.html#cb401-28" tabindex="-1"></a>p_change <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb401-29"><a href="issues.html#cb401-29" tabindex="-1"></a>seed_i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb401-30"><a href="issues.html#cb401-30" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_iter){</span>
<span id="cb401-31"><a href="issues.html#cb401-31" tabindex="-1"></a>  seed_i <span class="ot">&lt;-</span> seed_i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb401-32"><a href="issues.html#cb401-32" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed_i)</span>
<span id="cb401-33"><a href="issues.html#cb401-33" tabindex="-1"></a>  <span class="co"># the contribution to variance due to individual differences</span></span>
<span id="cb401-34"><a href="issues.html#cb401-34" tabindex="-1"></a>  mu_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma_among)</span>
<span id="cb401-35"><a href="issues.html#cb401-35" tabindex="-1"></a>  </span>
<span id="cb401-36"><a href="issues.html#cb401-36" tabindex="-1"></a>  <span class="co"># the contribution to variance due to variation within individual</span></span>
<span id="cb401-37"><a href="issues.html#cb401-37" tabindex="-1"></a>  mu_i_pre <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">sd =</span> sigma_within)</span>
<span id="cb401-38"><a href="issues.html#cb401-38" tabindex="-1"></a>  mu_i_post <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">sd =</span> sigma_within)</span>
<span id="cb401-39"><a href="issues.html#cb401-39" tabindex="-1"></a>  </span>
<span id="cb401-40"><a href="issues.html#cb401-40" tabindex="-1"></a>  pre <span class="ot">&lt;-</span> mu_i <span class="sc">+</span> mu_i_pre</span>
<span id="cb401-41"><a href="issues.html#cb401-41" tabindex="-1"></a>  post <span class="ot">&lt;-</span> mu_i <span class="sc">+</span> beta_1 <span class="sc">+</span> mu_i_post</span>
<span id="cb401-42"><a href="issues.html#cb401-42" tabindex="-1"></a>  fake_data[, weight <span class="sc">:=</span> <span class="fu">c</span>(pre, post)]</span>
<span id="cb401-43"><a href="issues.html#cb401-43" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> treatment<span class="sc">*</span>time, <span class="at">data =</span> fake_data)</span>
<span id="cb401-44"><a href="issues.html#cb401-44" tabindex="-1"></a>  diff_pre[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(pre[np1<span class="sc">:</span>N]) <span class="sc">-</span> <span class="fu">mean</span>(pre[<span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb401-45"><a href="issues.html#cb401-45" tabindex="-1"></a>  diff_post[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(post[np1<span class="sc">:</span>N]) <span class="sc">-</span> <span class="fu">mean</span>(post[<span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb401-46"><a href="issues.html#cb401-46" tabindex="-1"></a>  ixn[i] <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(fit))[<span class="dv">4</span>, <span class="st">&quot;Estimate&quot;</span>]</span>
<span id="cb401-47"><a href="issues.html#cb401-47" tabindex="-1"></a>  ixn_p[i] <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(fit))[<span class="dv">4</span>, <span class="st">&quot;Pr(&gt;|t|)&quot;</span>]</span>
<span id="cb401-48"><a href="issues.html#cb401-48" tabindex="-1"></a>  </span>
<span id="cb401-49"><a href="issues.html#cb401-49" tabindex="-1"></a>  fake_data_wide <span class="ot">&lt;-</span> <span class="fu">dcast</span>(fake_data,</span>
<span id="cb401-50"><a href="issues.html#cb401-50" tabindex="-1"></a>                          id <span class="sc">+</span> treatment <span class="sc">~</span> time,</span>
<span id="cb401-51"><a href="issues.html#cb401-51" tabindex="-1"></a>                          <span class="at">value.var =</span> <span class="st">&quot;weight&quot;</span>)</span>
<span id="cb401-52"><a href="issues.html#cb401-52" tabindex="-1"></a>  fake_data_wide[, change <span class="sc">:=</span> post<span class="sc">-</span>pre]</span>
<span id="cb401-53"><a href="issues.html#cb401-53" tabindex="-1"></a>  fake_data_wide[, percent <span class="sc">:=</span> (post<span class="sc">-</span>pre)<span class="sc">/</span>pre<span class="sc">*</span><span class="dv">100</span>]</span>
<span id="cb401-54"><a href="issues.html#cb401-54" tabindex="-1"></a>  p_ancova[i] <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(post <span class="sc">~</span> treatment <span class="sc">+</span> pre,</span>
<span id="cb401-55"><a href="issues.html#cb401-55" tabindex="-1"></a>                  <span class="at">data =</span> fake_data_wide)))[<span class="dv">2</span>, <span class="st">&quot;Pr(&gt;|t|)&quot;</span>]</span>
<span id="cb401-56"><a href="issues.html#cb401-56" tabindex="-1"></a>  p_change[i] <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(change <span class="sc">~</span> treatment,</span>
<span id="cb401-57"><a href="issues.html#cb401-57" tabindex="-1"></a>                  <span class="at">data =</span> fake_data_wide)))[<span class="dv">2</span>, <span class="st">&quot;Pr(&gt;|t|)&quot;</span>]</span>
<span id="cb401-58"><a href="issues.html#cb401-58" tabindex="-1"></a>  </span>
<span id="cb401-59"><a href="issues.html#cb401-59" tabindex="-1"></a>}</span>
<span id="cb401-60"><a href="issues.html#cb401-60" tabindex="-1"></a></span>
<span id="cb401-61"><a href="issues.html#cb401-61" tabindex="-1"></a>diverge_list <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(diff_pre) <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(diff_post) <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb401-62"><a href="issues.html#cb401-62" tabindex="-1"></a>converge_list <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(diff_pre) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(diff_post) <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb401-63"><a href="issues.html#cb401-63" tabindex="-1"></a>p_list <span class="ot">&lt;-</span> <span class="fu">which</span>(p_ancova <span class="sc">&gt;</span> <span class="fl">0.1</span> <span class="sc">&amp;</span> p_change <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span>
<span id="cb401-64"><a href="issues.html#cb401-64" tabindex="-1"></a>keep <span class="ot">&lt;-</span> <span class="fu">intersect</span>(converge_list, p_list)</span>
<span id="cb401-65"><a href="issues.html#cb401-65" tabindex="-1"></a></span>
<span id="cb401-66"><a href="issues.html#cb401-66" tabindex="-1"></a>max_seed_con <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(ixn) <span class="sc">==</span> <span class="fu">max</span>(<span class="fu">abs</span>(ixn)[converge_list]))</span>
<span id="cb401-67"><a href="issues.html#cb401-67" tabindex="-1"></a></span>
<span id="cb401-68"><a href="issues.html#cb401-68" tabindex="-1"></a><span class="co"># convergence ixn</span></span>
<span id="cb401-69"><a href="issues.html#cb401-69" tabindex="-1"></a><span class="fu">set.seed</span>(max_seed_con)</span>
<span id="cb401-70"><a href="issues.html#cb401-70" tabindex="-1"></a>mu_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma_among)</span>
<span id="cb401-71"><a href="issues.html#cb401-71" tabindex="-1"></a><span class="co"># the contribution to variance due to variation within individual</span></span>
<span id="cb401-72"><a href="issues.html#cb401-72" tabindex="-1"></a>mu_i_pre <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">sd =</span> sigma_within)</span>
<span id="cb401-73"><a href="issues.html#cb401-73" tabindex="-1"></a>mu_i_post <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">sd =</span> sigma_within)</span>
<span id="cb401-74"><a href="issues.html#cb401-74" tabindex="-1"></a>pre <span class="ot">&lt;-</span> mu_i <span class="sc">+</span> mu_i_pre</span>
<span id="cb401-75"><a href="issues.html#cb401-75" tabindex="-1"></a>post <span class="ot">&lt;-</span> mu_i <span class="sc">+</span> beta_1 <span class="sc">+</span> mu_i_post</span>
<span id="cb401-76"><a href="issues.html#cb401-76" tabindex="-1"></a>fake_data[, weight <span class="sc">:=</span> <span class="fu">c</span>(pre, post)]</span>
<span id="cb401-77"><a href="issues.html#cb401-77" tabindex="-1"></a>fake_data_wide <span class="ot">&lt;-</span> <span class="fu">dcast</span>(fake_data,</span>
<span id="cb401-78"><a href="issues.html#cb401-78" tabindex="-1"></a>                        id <span class="sc">+</span> treatment <span class="sc">~</span> time,</span>
<span id="cb401-79"><a href="issues.html#cb401-79" tabindex="-1"></a>                        <span class="at">value.var =</span> <span class="st">&quot;weight&quot;</span>)</span>
<span id="cb401-80"><a href="issues.html#cb401-80" tabindex="-1"></a>fake_data_wide[, change <span class="sc">:=</span> post<span class="sc">-</span>pre]</span>
<span id="cb401-81"><a href="issues.html#cb401-81" tabindex="-1"></a>fake_data_wide[, percent <span class="sc">:=</span> (post<span class="sc">-</span>pre)<span class="sc">/</span>pre<span class="sc">*</span><span class="dv">100</span>]</span>
<span id="cb401-82"><a href="issues.html#cb401-82" tabindex="-1"></a><span class="co"># coef(summary(lm(post ~ treatment + pre,</span></span>
<span id="cb401-83"><a href="issues.html#cb401-83" tabindex="-1"></a><span class="co">#                 data = fake_data_wide)))</span></span>
<span id="cb401-84"><a href="issues.html#cb401-84" tabindex="-1"></a><span class="co"># coef(summary(lm(change ~ treatment,</span></span>
<span id="cb401-85"><a href="issues.html#cb401-85" tabindex="-1"></a><span class="co">#                 data = fake_data_wide)))</span></span>
<span id="cb401-86"><a href="issues.html#cb401-86" tabindex="-1"></a><span class="co"># coef(summary(lm(percent ~ treatment,</span></span>
<span id="cb401-87"><a href="issues.html#cb401-87" tabindex="-1"></a><span class="co">#                 data = fake_data_wide)))</span></span>
<span id="cb401-88"><a href="issues.html#cb401-88" tabindex="-1"></a></span>
<span id="cb401-89"><a href="issues.html#cb401-89" tabindex="-1"></a></span>
<span id="cb401-90"><a href="issues.html#cb401-90" tabindex="-1"></a><span class="co"># not much we can do about divergence so limit to convergence</span></span>
<span id="cb401-91"><a href="issues.html#cb401-91" tabindex="-1"></a></span>
<span id="cb401-92"><a href="issues.html#cb401-92" tabindex="-1"></a>fake_means <span class="ot">&lt;-</span> fake_data[, .(<span class="at">weight =</span> <span class="fu">mean</span>(weight)),</span>
<span id="cb401-93"><a href="issues.html#cb401-93" tabindex="-1"></a>                        by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;treatment&quot;</span>)]</span></code></pre></div>
</div>
<div id="import-fig3f" class="section level3 hasAnchor" number="13.8.5">
<h3><span class="header-section-number">13.8.5</span> Import fig3f<a href="issues.html#import-fig3f" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="issues.html#cb402-1" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Innervation of thermogenic adipose tissue via a calsyntenin 3β–S100b axis&quot;</span></span>
<span id="cb402-2"><a href="issues.html#cb402-2" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41586_2019_1156_MOESM5_ESM.xlsx&quot;</span></span>
<span id="cb402-3"><a href="issues.html#cb402-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb402-4"><a href="issues.html#cb402-4" tabindex="-1"></a></span>
<span id="cb402-5"><a href="issues.html#cb402-5" tabindex="-1"></a>fig3f_wide <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb402-6"><a href="issues.html#cb402-6" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;Figure 3f&quot;</span>,</span>
<span id="cb402-7"><a href="issues.html#cb402-7" tabindex="-1"></a>                    <span class="at">range =</span> <span class="st">&quot;H2:M15&quot;</span>,</span>
<span id="cb402-8"><a href="issues.html#cb402-8" tabindex="-1"></a>                    <span class="at">col_names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb402-9"><a href="issues.html#cb402-9" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb402-10"><a href="issues.html#cb402-10" tabindex="-1"></a></span>
<span id="cb402-11"><a href="issues.html#cb402-11" tabindex="-1"></a>time_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>, <span class="dv">120</span>)</span>
<span id="cb402-12"><a href="issues.html#cb402-12" tabindex="-1"></a><span class="fu">setnames</span>(fig3f_wide,</span>
<span id="cb402-13"><a href="issues.html#cb402-13" tabindex="-1"></a>         <span class="at">old =</span> <span class="fu">names</span>(fig3f_wide),</span>
<span id="cb402-14"><a href="issues.html#cb402-14" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>, </span>
<span id="cb402-15"><a href="issues.html#cb402-15" tabindex="-1"></a>                 <span class="fu">paste0</span>(<span class="st">&quot;time_&quot;</span>, time_cols)))</span>
<span id="cb402-16"><a href="issues.html#cb402-16" tabindex="-1"></a></span>
<span id="cb402-17"><a href="issues.html#cb402-17" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;WT&quot;</span>, <span class="st">&quot;KO&quot;</span>)</span>
<span id="cb402-18"><a href="issues.html#cb402-18" tabindex="-1"></a>fig3f_wide[, treatment <span class="sc">:=</span> <span class="fu">factor</span>(<span class="fu">substr</span>(id, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb402-19"><a href="issues.html#cb402-19" tabindex="-1"></a>                                 treatment_levels)]</span>
<span id="cb402-20"><a href="issues.html#cb402-20" tabindex="-1"></a></span>
<span id="cb402-21"><a href="issues.html#cb402-21" tabindex="-1"></a>fig3f_wide[, glucose_0 <span class="sc">:=</span> time_0]</span>
<span id="cb402-22"><a href="issues.html#cb402-22" tabindex="-1"></a></span>
<span id="cb402-23"><a href="issues.html#cb402-23" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>, <span class="dv">120</span>)</span>
<span id="cb402-24"><a href="issues.html#cb402-24" tabindex="-1"></a>n_times <span class="ot">&lt;-</span> <span class="fu">length</span>(times)</span>
<span id="cb402-25"><a href="issues.html#cb402-25" tabindex="-1"></a>period_full <span class="ot">&lt;-</span> times[n_times] <span class="sc">-</span> times[<span class="dv">1</span>]</span>
<span id="cb402-26"><a href="issues.html#cb402-26" tabindex="-1"></a>period_post <span class="ot">&lt;-</span> times[n_times] <span class="sc">-</span> times[<span class="dv">2</span>]</span>
<span id="cb402-27"><a href="issues.html#cb402-27" tabindex="-1"></a></span>
<span id="cb402-28"><a href="issues.html#cb402-28" tabindex="-1"></a>time_cols <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;time_&quot;</span>, times)</span>
<span id="cb402-29"><a href="issues.html#cb402-29" tabindex="-1"></a>Y <span class="ot">&lt;-</span> fig3f_wide[, .SD, .SDcols <span class="ot">=</span> time_cols] <span class="sc">%&gt;%</span></span>
<span id="cb402-30"><a href="issues.html#cb402-30" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb402-31"><a href="issues.html#cb402-31" tabindex="-1"></a></span>
<span id="cb402-32"><a href="issues.html#cb402-32" tabindex="-1"></a><span class="co"># auc</span></span>
<span id="cb402-33"><a href="issues.html#cb402-33" tabindex="-1"></a>fig3f_wide[, auc <span class="sc">:=</span> <span class="fu">apply</span>(Y, <span class="dv">1</span>, trap.rule, <span class="at">x =</span> times)]</span>
<span id="cb402-34"><a href="issues.html#cb402-34" tabindex="-1"></a></span>
<span id="cb402-35"><a href="issues.html#cb402-35" tabindex="-1"></a><span class="co"># mean response over full period</span></span>
<span id="cb402-36"><a href="issues.html#cb402-36" tabindex="-1"></a>fig3f_wide[, glucose_gtt_post <span class="sc">:=</span> auc<span class="sc">/</span>period_full]</span>
<span id="cb402-37"><a href="issues.html#cb402-37" tabindex="-1"></a></span>
<span id="cb402-38"><a href="issues.html#cb402-38" tabindex="-1"></a><span class="co"># auc of the change. Equal to iauc of le Floch</span></span>
<span id="cb402-39"><a href="issues.html#cb402-39" tabindex="-1"></a>fig3f_wide[, iauc <span class="sc">:=</span> <span class="fu">apply</span>(Y <span class="sc">-</span> Y[,<span class="dv">1</span>], <span class="dv">1</span>, trap.rule, <span class="at">x =</span> times)]</span>
<span id="cb402-40"><a href="issues.html#cb402-40" tabindex="-1"></a></span>
<span id="cb402-41"><a href="issues.html#cb402-41" tabindex="-1"></a><span class="co"># mean change over full period</span></span>
<span id="cb402-42"><a href="issues.html#cb402-42" tabindex="-1"></a>fig3f_wide[, glucose_gtt_change <span class="sc">:=</span> iauc<span class="sc">/</span>period_full]</span>
<span id="cb402-43"><a href="issues.html#cb402-43" tabindex="-1"></a></span>
<span id="cb402-44"><a href="issues.html#cb402-44" tabindex="-1"></a><span class="co"># View(fig3f_wide)</span></span></code></pre></div>
<p>**convert fig3f to long format for LMM</p>
</div>
<div id="issues-import-exp3b" class="section level3 hasAnchor" number="13.8.6">
<h3><span class="header-section-number">13.8.6</span> Import exp3b<a href="issues.html#issues-import-exp3b" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="issues.html#cb403-1" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Disruption of the beclin 1–BCL2 autophagy regulatory complex promotes longevity in mice&quot;</span></span>
<span id="cb403-2"><a href="issues.html#cb403-2" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41586_2018_162_MOESM5_ESM.xlsx&quot;</span></span>
<span id="cb403-3"><a href="issues.html#cb403-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb403-4"><a href="issues.html#cb403-4" tabindex="-1"></a></span>
<span id="cb403-5"><a href="issues.html#cb403-5" tabindex="-1"></a>exp3b <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb403-6"><a href="issues.html#cb403-6" tabindex="-1"></a>                         <span class="at">sheet =</span> <span class="st">&quot;Fig. 3b&quot;</span>,</span>
<span id="cb403-7"><a href="issues.html#cb403-7" tabindex="-1"></a>                         <span class="at">range =</span> <span class="st">&quot;H4:K50&quot;</span>,</span>
<span id="cb403-8"><a href="issues.html#cb403-8" tabindex="-1"></a>                         <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb403-9"><a href="issues.html#cb403-9" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb403-10"><a href="issues.html#cb403-10" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(genotype) <span class="sc">%&gt;%</span></span>
<span id="cb403-11"><a href="issues.html#cb403-11" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb403-12"><a href="issues.html#cb403-12" tabindex="-1"></a>exp3b[, count_per_area <span class="sc">:=</span> positive_nuclei<span class="sc">/</span>area_mm2]</span>
<span id="cb403-13"><a href="issues.html#cb403-13" tabindex="-1"></a>genotype_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;WT&quot;</span>, <span class="st">&quot;KI&quot;</span>)</span>
<span id="cb403-14"><a href="issues.html#cb403-14" tabindex="-1"></a>exp3b[, genotype <span class="sc">:=</span> <span class="fu">factor</span>(genotype,</span>
<span id="cb403-15"><a href="issues.html#cb403-15" tabindex="-1"></a>      <span class="at">levels =</span> genotype_levels)]</span>
<span id="cb403-16"><a href="issues.html#cb403-16" tabindex="-1"></a>exp3b[, age <span class="sc">:=</span> <span class="st">&quot;Old&quot;</span>]</span></code></pre></div>
</div>
<div id="issues-exp3b-plot" class="section level3 hasAnchor" number="13.8.7">
<h3><span class="header-section-number">13.8.7</span> Plot the model of exp3b (glm offset data)<a href="issues.html#issues-exp3b-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="issues.html#cb404-1" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> <span class="fu">ggplot_the_effects</span>(exp3b_m2,</span>
<span id="cb404-2"><a href="issues.html#cb404-2" tabindex="-1"></a>                 exp3b_m2_pairs,</span>
<span id="cb404-3"><a href="issues.html#cb404-3" tabindex="-1"></a>                 <span class="at">effect_label =</span> <span class="st">&quot;Effect Ratio&quot;</span>)</span>
<span id="cb404-4"><a href="issues.html#cb404-4" tabindex="-1"></a><span class="co"># gg1</span></span>
<span id="cb404-5"><a href="issues.html#cb404-5" tabindex="-1"></a></span>
<span id="cb404-6"><a href="issues.html#cb404-6" tabindex="-1"></a>xdat_old <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb404-7"><a href="issues.html#cb404-7" tabindex="-1"></a>  <span class="at">area_mm2 =</span> <span class="fu">seq</span>(<span class="fu">min</span>(exp3b[age <span class="sc">==</span> <span class="st">&quot;Old&quot;</span>, area_mm2]),</span>
<span id="cb404-8"><a href="issues.html#cb404-8" tabindex="-1"></a>                 <span class="fu">max</span>(exp3b[age <span class="sc">==</span> <span class="st">&quot;Old&quot;</span>, area_mm2]),</span>
<span id="cb404-9"><a href="issues.html#cb404-9" tabindex="-1"></a>                 <span class="at">length.out =</span> <span class="dv">50</span>),</span>
<span id="cb404-10"><a href="issues.html#cb404-10" tabindex="-1"></a>  <span class="at">genotype =</span> genotype_levels,</span>
<span id="cb404-11"><a href="issues.html#cb404-11" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="st">&quot;Old&quot;</span>)</span>
<span id="cb404-12"><a href="issues.html#cb404-12" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb404-13"><a href="issues.html#cb404-13" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb404-14"><a href="issues.html#cb404-14" tabindex="-1"></a></span>
<span id="cb404-15"><a href="issues.html#cb404-15" tabindex="-1"></a>xdat_old[, y <span class="sc">:=</span> <span class="fu">predict</span>(exp3b_m2, xdat_old, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)]</span>
<span id="cb404-16"><a href="issues.html#cb404-16" tabindex="-1"></a></span>
<span id="cb404-17"><a href="issues.html#cb404-17" tabindex="-1"></a>gg2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> exp3b[age <span class="sc">==</span> <span class="st">&quot;Old&quot;</span>],</span>
<span id="cb404-18"><a href="issues.html#cb404-18" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> area_mm2,</span>
<span id="cb404-19"><a href="issues.html#cb404-19" tabindex="-1"></a>                  <span class="at">y =</span> positive_nuclei,</span>
<span id="cb404-20"><a href="issues.html#cb404-20" tabindex="-1"></a>                  <span class="at">color =</span> genotype)) <span class="sc">+</span></span>
<span id="cb404-21"><a href="issues.html#cb404-21" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb404-22"><a href="issues.html#cb404-22" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> xdat_old,</span>
<span id="cb404-23"><a href="issues.html#cb404-23" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> area_mm2,</span>
<span id="cb404-24"><a href="issues.html#cb404-24" tabindex="-1"></a>                <span class="at">y =</span> y,</span>
<span id="cb404-25"><a href="issues.html#cb404-25" tabindex="-1"></a>                <span class="at">color =</span> genotype)) <span class="sc">+</span></span>
<span id="cb404-26"><a href="issues.html#cb404-26" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Area (&quot;</span>, mm<span class="sc">^</span><span class="dv">2</span>, <span class="st">&quot;)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb404-27"><a href="issues.html#cb404-27" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;TUNEL+ nuclei&quot;</span>) <span class="sc">+</span></span>
<span id="cb404-28"><a href="issues.html#cb404-28" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> pal_okabe_ito_blue) <span class="sc">+</span></span>
<span id="cb404-29"><a href="issues.html#cb404-29" tabindex="-1"></a></span>
<span id="cb404-30"><a href="issues.html#cb404-30" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb404-31"><a href="issues.html#cb404-31" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;left&quot;</span>) <span class="sc">+</span></span>
<span id="cb404-32"><a href="issues.html#cb404-32" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb404-33"><a href="issues.html#cb404-33" tabindex="-1"></a></span>
<span id="cb404-34"><a href="issues.html#cb404-34" tabindex="-1"></a><span class="co">#gg2</span></span>
<span id="cb404-35"><a href="issues.html#cb404-35" tabindex="-1"></a></span>
<span id="cb404-36"><a href="issues.html#cb404-36" tabindex="-1"></a><span class="fu">plot_grid</span>(gg1, gg2,</span>
<span id="cb404-37"><a href="issues.html#cb404-37" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb404-38"><a href="issues.html#cb404-38" tabindex="-1"></a>          <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="dv">1</span>),</span>
<span id="cb404-39"><a href="issues.html#cb404-39" tabindex="-1"></a>          <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;v&quot;</span>),</span>
<span id="cb404-40"><a href="issues.html#cb404-40" tabindex="-1"></a>          <span class="at">axis =</span> <span class="st">&quot;lr&quot;</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/issues-exp3b-plot_the_model-show-1.png" width="576" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="violations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="part-v-more-than-one-x-multivariable-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/29-issues.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
