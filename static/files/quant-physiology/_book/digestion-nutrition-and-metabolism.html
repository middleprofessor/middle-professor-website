<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Problem Set 10 Digestion, Nutrition, and Metabolism | Quantitative Human Physiology</title>
  <meta name="description" content="xxx">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Problem Set 10 Digestion, Nutrition, and Metabolism | Quantitative Human Physiology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="xxx" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Problem Set 10 Digestion, Nutrition, and Metabolism | Quantitative Human Physiology" />
  
  <meta name="twitter:description" content="xxx" />
  

<meta name="author" content="Jeffrey A. Walker">


<meta name="date" content="2019-09-10">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="renal.html">
<link rel="next" href="cancer.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Human Physiology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Directions</a></li>
<li class="chapter" data-level="" data-path="bio-221.html"><a href="bio-221.html"><i class="fa fa-check"></i>BIO 221</a></li>
<li class="chapter" data-level="1" data-path="diffusion.html"><a href="diffusion.html"><i class="fa fa-check"></i><b>1</b> Diffusion</a><ul>
<li class="chapter" data-level="1.1" data-path="diffusion.html"><a href="diffusion.html#problems"><i class="fa fa-check"></i><b>1.1</b> Problems</a><ul>
<li class="chapter" data-level="1.1.1" data-path="diffusion.html"><a href="diffusion.html#compute-diffusion-times-for-chemicals-with-known-diffusion-coefficients"><i class="fa fa-check"></i><b>1.1.1</b> Compute diffusion times for chemicals with known diffusion coefficients</a></li>
<li class="chapter" data-level="1.1.2" data-path="diffusion.html"><a href="diffusion.html#compute-diffusion-time-for-a-chemical-with-an-unknown-diffusion-coefficient"><i class="fa fa-check"></i><b>1.1.2</b> Compute diffusion time for a chemical with an unknown diffusion coefficient</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="nernst-potential.html"><a href="nernst-potential.html"><i class="fa fa-check"></i><b>2</b> Nernst Potential</a></li>
<li class="chapter" data-level="3" data-path="muscle.html"><a href="muscle.html"><i class="fa fa-check"></i><b>3</b> Muscle</a></li>
<li class="chapter" data-level="4" data-path="skeleton.html"><a href="skeleton.html"><i class="fa fa-check"></i><b>4</b> Skeleton</a></li>
<li class="chapter" data-level="" data-path="bio-223.html"><a href="bio-223.html"><i class="fa fa-check"></i>BIO 223</a></li>
<li class="chapter" data-level="5" data-path="blood.html"><a href="blood.html"><i class="fa fa-check"></i><b>5</b> Blood</a><ul>
<li class="chapter" data-level="5.1" data-path="blood.html"><a href="blood.html#how-to-solve-an-estimation-problem"><i class="fa fa-check"></i><b>5.1</b> How to solve an estimation problem</a></li>
<li class="chapter" data-level="5.2" data-path="blood.html"><a href="blood.html#problem-set"><i class="fa fa-check"></i><b>5.2</b> Problem set</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="immune.html"><a href="immune.html"><i class="fa fa-check"></i><b>6</b> Immune</a><ul>
<li class="chapter" data-level="6.1" data-path="immune.html"><a href="immune.html#combinations"><i class="fa fa-check"></i><b>6.1</b> Combinations</a></li>
<li class="chapter" data-level="6.2" data-path="immune.html"><a href="immune.html#problem-set-1"><i class="fa fa-check"></i><b>6.2</b> Problem set</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="cardiovascular.html"><a href="cardiovascular.html"><i class="fa fa-check"></i><b>7</b> Cardiovascular</a><ul>
<li class="chapter" data-level="7.1" data-path="cardiovascular.html"><a href="cardiovascular.html#background"><i class="fa fa-check"></i><b>7.1</b> Background</a></li>
<li class="chapter" data-level="7.2" data-path="cardiovascular.html"><a href="cardiovascular.html#problems-1"><i class="fa fa-check"></i><b>7.2</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="resipiratory-why-we-need-hemoglobin.html"><a href="resipiratory-why-we-need-hemoglobin.html"><i class="fa fa-check"></i><b>8</b> Resipiratory – Why we need Hemoglobin</a><ul>
<li class="chapter" data-level="8.1" data-path="resipiratory-why-we-need-hemoglobin.html"><a href="resipiratory-why-we-need-hemoglobin.html#how-much-o2-can-dissolve-into-blood"><i class="fa fa-check"></i><b>8.1</b> How much O2 can dissolve into blood?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="renal.html"><a href="renal.html"><i class="fa fa-check"></i><b>9</b> Renal</a><ul>
<li class="chapter" data-level="9.1" data-path="renal.html"><a href="renal.html#a-back-of-the-envelope-calculation-of-gfr"><i class="fa fa-check"></i><b>9.1</b> A back of the envelope calculation of GFR</a></li>
<li class="chapter" data-level="9.2" data-path="renal.html"><a href="renal.html#using-renal-clearance-to-measure-gfr-in-an-indivudal"><i class="fa fa-check"></i><b>9.2</b> Using renal clearance to measure GFR in an indivudal</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html"><i class="fa fa-check"></i><b>10</b> Digestion, Nutrition, and Metabolism</a><ul>
<li class="chapter" data-level="10.1" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#estimating-causal-effects"><i class="fa fa-check"></i><b>10.1</b> Estimating Causal Effects</a></li>
<li class="chapter" data-level="10.2" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#simulation-1"><i class="fa fa-check"></i><b>10.2</b> Simulation 1</a><ul>
<li class="chapter" data-level="10.2.1" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#step-1.-set-up-the-parameters"><i class="fa fa-check"></i><b>10.2.1</b> Step 1. Set up the parameters</a></li>
<li class="chapter" data-level="10.2.2" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#step-2.-generate-fake-data"><i class="fa fa-check"></i><b>10.2.2</b> Step 2. Generate fake data</a></li>
<li class="chapter" data-level="10.2.3" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#step-3.-fake-data-check"><i class="fa fa-check"></i><b>10.2.3</b> Step 3. Fake data check</a></li>
<li class="chapter" data-level="10.2.4" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#step-4.-does-a-statistical-model-recover-the-known-effect"><i class="fa fa-check"></i><b>10.2.4</b> Step 4. Does a statistical model recover the known effect?</a></li>
<li class="chapter" data-level="10.2.5" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#what-you-did"><i class="fa fa-check"></i><b>10.2.5</b> What you did</a></li>
<li class="chapter" data-level="10.2.6" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#the-model-you-fit-is"><i class="fa fa-check"></i><b>10.2.6</b> The model you fit is</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#simulation-2"><i class="fa fa-check"></i><b>10.3</b> Simulation 2</a><ul>
<li class="chapter" data-level="10.3.1" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#step-5.-set-up-the-parameters"><i class="fa fa-check"></i><b>10.3.1</b> Step 5. Set up the parameters</a></li>
<li class="chapter" data-level="10.3.2" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#step-6.-generate-fake-data"><i class="fa fa-check"></i><b>10.3.2</b> Step 6. Generate fake data</a></li>
<li class="chapter" data-level="10.3.3" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#step-7.-fake-data-check"><i class="fa fa-check"></i><b>10.3.3</b> Step 7. Fake data check</a></li>
<li class="chapter" data-level="10.3.4" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#step-8.-does-a-statistical-model-recover-the-known-effect"><i class="fa fa-check"></i><b>10.3.4</b> Step 8. Does a statistical model recover the known effect?</a></li>
<li class="chapter" data-level="10.3.5" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#whats-going-on-is-the-whole-point-of-this-exercise"><i class="fa fa-check"></i><b>10.3.5</b> What’s going on is the whole point of this exercise</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#questions"><i class="fa fa-check"></i><b>10.4</b> Questions</a><ul>
<li class="chapter" data-level="10.4.1" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#simulation-1-1"><i class="fa fa-check"></i><b>10.4.1</b> Simulation 1</a></li>
<li class="chapter" data-level="10.4.2" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#simulation-2-1"><i class="fa fa-check"></i><b>10.4.2</b> Simulation 2</a></li>
<li class="chapter" data-level="10.4.3" data-path="digestion-nutrition-and-metabolism.html"><a href="digestion-nutrition-and-metabolism.html#simulation-2-with-new-parameters"><i class="fa fa-check"></i><b>10.4.3</b> Simulation 2 with new parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="cancer.html"><a href="cancer.html"><i class="fa fa-check"></i><b>11</b> Cancer</a><ul>
<li class="chapter" data-level="11.1" data-path="cancer.html"><a href="cancer.html#numerical-self-discovery"><i class="fa fa-check"></i><b>11.1</b> Numerical Self-Discovery</a><ul>
<li class="chapter" data-level="11.1.1" data-path="cancer.html"><a href="cancer.html#step-1"><i class="fa fa-check"></i><b>11.1.1</b> Step 1</a></li>
<li class="chapter" data-level="11.1.2" data-path="cancer.html"><a href="cancer.html#step-2"><i class="fa fa-check"></i><b>11.1.2</b> Step 2</a></li>
<li class="chapter" data-level="11.1.3" data-path="cancer.html"><a href="cancer.html#step-3"><i class="fa fa-check"></i><b>11.1.3</b> Step 3</a></li>
<li class="chapter" data-level="11.1.4" data-path="cancer.html"><a href="cancer.html#step-4"><i class="fa fa-check"></i><b>11.1.4</b> Step 4</a></li>
<li class="chapter" data-level="11.1.5" data-path="cancer.html"><a href="cancer.html#step-5"><i class="fa fa-check"></i><b>11.1.5</b> Step 5</a></li>
<li class="chapter" data-level="11.1.6" data-path="cancer.html"><a href="cancer.html#step-6"><i class="fa fa-check"></i><b>11.1.6</b> Step 6</a></li>
<li class="chapter" data-level="11.1.7" data-path="cancer.html"><a href="cancer.html#step-7"><i class="fa fa-check"></i><b>11.1.7</b> Step 7</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="cancer.html"><a href="cancer.html#stuff-to-explore"><i class="fa fa-check"></i><b>11.2</b> Stuff to explore</a><ul>
<li class="chapter" data-level="11.2.1" data-path="cancer.html"><a href="cancer.html#getting-to-know-the-model"><i class="fa fa-check"></i><b>11.2.1</b> Getting to know the model</a></li>
<li class="chapter" data-level="11.2.2" data-path="cancer.html"><a href="cancer.html#a-wee-bit-more-to-explore"><i class="fa fa-check"></i><b>11.2.2</b> A wee bit more to explore</a></li>
<li class="chapter" data-level="11.2.3" data-path="cancer.html"><a href="cancer.html#yet-more-stuff-to-explore"><i class="fa fa-check"></i><b>11.2.3</b> Yet more stuff to explore</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Human Physiology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="digestion-nutrition-and-metabolism" class="section level1">
<h1><span class="header-section-number">Problem Set 10</span> Digestion, Nutrition, and Metabolism</h1>
<div id="estimating-causal-effects" class="section level2">
<h2><span class="header-section-number">10.1</span> Estimating Causal Effects</h2>
<p>Think about headlines in human health, performance and disease: red wine decreases colon cancer, or coffee increases dementia, or oxygenated water increases marathon performance. These “conclusions” constantly seem to be flipping. To understand why, it is important to think about the problem with math. The <em>mathematical</em> way to think about these assertions is X -&gt; Y, or “X causes Y”. Importantly, if a scientist says something like “X causes Y”, this does not mean that X is the only cause of Y – other things may also cause Y. For example: vegetarian diet -&gt; low blood cholesterol AND running -&gt; low blood cholesterol AND statins -&gt; low blood cholesterol.</p>
<p>Most importantly “cause” is not binary (causes v. doesn’t cause) but has some magnitude (trivially small, or small, or big, or huge). Here, we use the greek letter <span class="math inline">\(\beta\)</span> (“beta”) to indicate effect size.</p>
<p>We are going to use Google Sheets to create fake data that were generated by a known causal process (known <span class="math inline">\(\beta\)</span>), and then use a <strong>statistical model</strong> to estimate the causal process (estimate <span class="math inline">\(\beta\)</span>) from the fake data. The statistical model is <strong>regression</strong>, which is the principle statistical method used in the biological sciences to estimate causal effects. We are purposefully using abstract notation (X and Y) instead of meaningful variables (dietary cholesterol and atherosclerotic plaque development) because it is good to be able to think abstractly.</p>
<p><img src="images/ovb_fig1.png" /><!-- --></p>
</div>
<div id="simulation-1" class="section level2">
<h2><span class="header-section-number">10.2</span> Simulation 1</h2>
<p>Open your Google spreadsheet and</p>
<div id="step-1.-set-up-the-parameters" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Step 1. Set up the parameters</h3>
<ol style="list-style-type: decimal">
<li>In column A, cells 2-4, insert “beta_0”, “beta_1”, “E[b1]” (see figure above)</li>
<li>In row 1, columns B and C, insert “True Value”, “Estimate”</li>
<li>In B2, insert a number (it doesn’t matter)</li>
<li>In B3, insert 0.5 (this is the true generating effect of X on Y)</li>
<li>In B4, insert =B3 (this is the expected value of the generating effect of X on Y given the statistical model)</li>
</ol>
</div>
<div id="step-2.-generate-fake-data" class="section level3">
<h3><span class="header-section-number">10.2.2</span> Step 2. Generate fake data</h3>
<ol style="list-style-type: decimal">
<li>In row 9, coumns A-C, insert “ID”, “X”, “Y”</li>
<li>In A10 insert “1”</li>
<li>In B10 insert <code>=normsinv(rand())</code></li>
<li>In C10 insert <code>=$B$2 + $B$3*B10 + sqrt(1-$B$3^2)*normsinv(rand())</code></li>
<li>In A11 insert <code>=A10 + 1</code></li>
<li>Highlight cells B10 and C10. Click on the handle on the lower right corner of the box and drag down 1 row. Your formulas from row 10 should now be in row 11.</li>
<li>Highlight cells A11, B11, C11. Click on the handle on the lower right corner of the box and drag down and down and down until you get to row 1000. You should have copied all three formuilas all the way down.</li>
</ol>
<p>What is step 2 doing? It is creating fake data. The value is caused by three things, the value in Cell B2, the product of B3 and X, and a random number. The value in B3 is the contribution of X to Y or how “X causes Y” or the “causal effect of X on Y”. If B3 is 0 then there is no causal effect. If B3 is 1 or -1, then the random component is zero.</p>
<p>You have just created fake data with a known generating mechanism! But it is imperative to check the the equations you entered don’t have bugs. If the equations were entered correctly, the standard deviation of the X and Y columns should both be one. Check this</p>
</div>
<div id="step-3.-fake-data-check" class="section level3">
<h3><span class="header-section-number">10.2.3</span> Step 3. Fake data check</h3>
<ol style="list-style-type: decimal">
<li>In A8, insert “sd”</li>
<li>In B8, insert <code>=stdev(B10:B1000)</code></li>
<li>Copy B8 and paste in C8.</li>
</ol>
<p>These numbers should be close to 1.0 (something is probably wrong if it is less than 0.95 or more than 1.05). Refresh the spread sheet by typing command-R (Mac) or control-R (Windows)</p>
</div>
<div id="step-4.-does-a-statistical-model-recover-the-known-effect" class="section level3">
<h3><span class="header-section-number">10.2.4</span> Step 4. Does a statistical model recover the known effect?</h3>
<ol style="list-style-type: decimal">
<li>In C3, insert <code>=slope(C10:C1000, B10:B1000)</code></li>
<li>In C3, round to three places after the decimal</li>
</ol>
<p>This is the slope of the regression (the statistical model) of Y on X. It is the <strong>estimate</strong> of the causal effect. The number should be very close to the true value.</p>
<p>This slope is the <strong>regression coefficient</strong> b1. The cell labeled “E[b1]” is the “expectation of b1” or the expected value of b1. Your estimate of beta_1 should also be very close to E(b1) since E(b1) is equal to the true generating effect (beta_1).</p>
</div>
<div id="what-you-did" class="section level3">
<h3><span class="header-section-number">10.2.5</span> What you did</h3>
<div id="in-a-nutshell" class="section level4">
<h4><span class="header-section-number">10.2.5.1</span> … in a nutshell</h4>
<p>you generated <span class="math inline">\(Y\)</span> using a “data generating” mechanism and then using the available data (X and Y), you used a statistical analysis to see if you could recover this data generating mechanism. The data generating mechanism is the set of two coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
</div>
<div id="the-data-generating-mechaniusm-in-a-little-more-detail" class="section level4">
<h4><span class="header-section-number">10.2.5.2</span> the data generating mechaniusm in a little more detail</h4>
<p>The fake data are two variables, X and Y. Y is caused by three things:</p>
<span class="math display">\[\begin{equation}
y_i = \beta_0 + \beta_1 x_i + \sigma_i
\end{equation}\]</span>
<p>the subscript is the “<span class="math inline">\(i\)</span>th” individual (if ID=7 then i=7). The three components generating <span class="math inline">\(y_i\)</span> are</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\beta_0\)</span> is “the intercept”; it is common to all <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(\beta_1 x_i\)</span> is the product of the effect (<span class="math inline">\(\beta_1\)</span>) and an individuals value of <span class="math inline">\(x\)</span>. <span class="math inline">\(\beta_1\)</span> is the same for all <span class="math inline">\(i\)</span> but the product is unique to each <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\sigma_i\)</span> is “the error”; this is the random variation due to other factors that “cause” Y but are unique to each <span class="math inline">\(i\)</span>. That is, these factors are <strong>not correlated</strong> with <span class="math inline">\(X\)</span>.</li>
</ol>
</div>
</div>
<div id="the-model-you-fit-is" class="section level3">
<h3><span class="header-section-number">10.2.6</span> The model you fit is</h3>
<span class="math display">\[\begin{equation}
y_i = b_0 + b_1 x_i + e_i
\end{equation}\]</span>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(b_0\)</span> is the intercept</li>
<li><span class="math inline">\(b_1\)</span> is the slope</li>
<li><span class="math inline">\(e_i\)</span> is the residual (the difference between the modeled value and the actual value)</li>
</ol>
<p>Notice that the statistical model is the same as the generating model. It is not at all surprising that the statistical model “recovers” the data generating mechanism (or the “true values”). <strong>The problem in science is, we don’t know the data generating model so we don’t know the correct statistical model</strong>. This will hopefully make more sense in the next exercise.</p>
</div>
</div>
<div id="simulation-2" class="section level2">
<h2><span class="header-section-number">10.3</span> Simulation 2</h2>
<div id="step-5.-set-up-the-parameters" class="section level3">
<h3><span class="header-section-number">10.3.1</span> Step 5. Set up the parameters</h3>
<ol style="list-style-type: decimal">
<li>In column E, rows 2-6, insert the labels “beta_0”, “beta_1”, “beta_2”, “r”, “E(b_1)”</li>
<li>In row 1, columns F and G, insert the labels “True Value”, “Estimate”</li>
<li>In F2, insert a number (it doesn’t matter) (this is the baseline value of generating model)</li>
<li>In F3, insert 0.5 (this is the true generating effect of <span class="math inline">\(X_1\)</span> on Y)</li>
<li>In F4, insert -0.7 (this is the true generating effect of <span class="math inline">\(X_2\)</span> on Y)</li>
<li>In F5, insert 0.7 (this is the true correlation between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>)</li>
</ol>
</div>
<div id="step-6.-generate-fake-data" class="section level3">
<h3><span class="header-section-number">10.3.2</span> Step 6. Generate fake data</h3>
<ol style="list-style-type: decimal">
<li>In row 9, coumns E-H, insert “Z”, “X1”, “X2”, “Y”</li>
<li>In E10 insert <code>=normsinv(rand())</code></li>
<li>In F10 insert <code>=sqrt($F$5)*$E10 + sqrt(1-$F$5)*normsinv(rand())</code></li>
<li>In G10, copy the equation from F10 and insert into G10</li>
<li>In H10, insert <code>=$F$2 + $F$3*F10 + $F$4*G10 + sqrt(1-$F$3^2 - $F$4^2 - 2*$F$3*$F$4*$F$5)*normsinv(rand())</code></li>
<li>Highlight cells E10 through H10. Click on the handle on the lower right corner of the box and drag down and down and down until you get to row 1000. You should have copied all four formuilas all the way down.</li>
</ol>
<p>What is step 6 doing? Like Step 2 in Simulation 1 above, it is creating fake data. But here the <span class="math inline">\(Y\)</span> value is caused by five things:</p>
<span class="math display">\[\begin{equation}
y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \sigma_i
\end{equation}\]</span>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\beta_0\)</span> is “the intercept”; it is common to all <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(\beta_1 x_{1i}\)</span> is the product of the effect (<span class="math inline">\(\beta_1\)</span>) and an individuals value of <span class="math inline">\(x_1\)</span>. <span class="math inline">\(\beta_1\)</span> is the same for all <span class="math inline">\(i\)</span> but the product is unique to each <span class="math inline">\(i\)</span>. This is the causal or generating effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span></li>
<li><span class="math inline">\(\beta_2 x_{2i}\)</span> is the product of the effect (<span class="math inline">\(\beta_2\)</span>) and an individuals value of <span class="math inline">\(x_2\)</span>. <span class="math inline">\(\beta_2\)</span> is the same for all <span class="math inline">\(i\)</span> but the product is unique to each <span class="math inline">\(i\)</span>. This is the causal or generating effect of <span class="math inline">\(X_2\)</span> on <span class="math inline">\(Y\)</span></li>
<li><span class="math inline">\(\sigma_i\)</span> is “the error”; this is the random variation due to other factors that “cause” <span class="math inline">\(Y\)</span> but are unique to each <span class="math inline">\(i\)</span>. That is, these factors are <strong>not correlated</strong> with <span class="math inline">\(X\)</span>.</li>
</ol>
<p>what is the 5th cause of <span class="math inline">\(Y\)</span>?</p>
<ol start="5" style="list-style-type: decimal">
<li><span class="math inline">\(r\)</span> – the correlation between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>. A correlation is a measures of association and is always between -1 and 1</li>
</ol>
</div>
<div id="step-7.-fake-data-check" class="section level3">
<h3><span class="header-section-number">10.3.3</span> Step 7. Fake data check</h3>
<ol style="list-style-type: decimal">
<li>Check the standard deviation of <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>, and <span class="math inline">\(Y\)</span> as in Step 3 above. All of these should be close to 1.0</li>
<li>insert <code>=correl(F10:F1000, G10:G1000)</code> in G5. This should be close to the true correlation in F5 (The starting correlation is 0.7, so the estimate should be 0.67-0.73)</li>
</ol>
</div>
<div id="step-8.-does-a-statistical-model-recover-the-known-effect" class="section level3">
<h3><span class="header-section-number">10.3.4</span> Step 8. Does a statistical model recover the known effect?</h3>
<ol style="list-style-type: decimal">
<li>In G3, insert <code>=slope(H10:H1000, F10:F1000)</code></li>
<li>In G3, round to three places after the decimal</li>
<li>In F6, insert <code>=F3 + F4*F5</code></li>
</ol>
<p>As in Step 4 in Siumulation 1 above, this is the slope of the regression (the statistical model) of <span class="math inline">\(Y\)</span> on X. It is the <strong>estimate</strong> of the causal effect. The number will not be very close to the true generating value (<span class="math inline">\(\beta_1\)</span>), at least using the default values specified in Step 5. But it should be close to E(b1) (the expected value of b1), given the statistical model. But, unlike simulation 1, E(b1) is not similar to <span class="math inline">\(\beta_1\)</span>, the true generating effect. Huh?</p>
<ol style="list-style-type: decimal">
<li>E(b1) should not equal the true value of beta_1 (at least using default values in Step 5), unlike in Simulation 1.</li>
<li>Your estimate of beta_1 should be very close to E(b1) but not to beta_1</li>
</ol>
</div>
<div id="whats-going-on-is-the-whole-point-of-this-exercise" class="section level3">
<h3><span class="header-section-number">10.3.5</span> What’s going on is the whole point of this exercise</h3>
<p>You have measured <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_1\)</span> but have not measured <span class="math inline">\(X_2\)</span>. Because you haven’t measured <span class="math inline">\(X_2\)</span>, it is <em>not</em> in your statistical model, so your statistical model is just like that in Simulation 1.</p>
<span class="math display">\[\begin{equation}
y_i = b_0 + b_1 x1_i + e_i
\end{equation}\]</span>
<p>But the generating model for <span class="math inline">\(Y\)</span> is</p>
<span class="math display">\[\begin{equation}
y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \sigma_i
\end{equation}\]</span>
<p>That is, your statistical model has an <strong>omitted causal variable</strong> (<span class="math inline">\(X_2\)</span>) and your estimate of the effect of <span class="math inline">\(X_1\)</span> is <strong>biased</strong>. This kind of bias is called <strong>omitted variable bias</strong>. The true effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> is <span class="math inline">\(\beta_1\)</span> but you are actually estimating E(b1) with the regression coefficient! Researchers often think their result will get closer to the truth as the sample size increases but if an causal effect is missing from a statistical model, the estimate of the effects of the factors in the model will never ever get closer to the truth - instead it gets closer to the wrong thing (the biased expectation of the effect given the model).</p>
</div>
</div>
<div id="questions" class="section level2">
<h2><span class="header-section-number">10.4</span> Questions</h2>
<div id="simulation-1-1" class="section level3">
<h3><span class="header-section-number">10.4.1</span> Simulation 1</h3>
<ol style="list-style-type: decimal">
<li>Given the default parameters specified above, what is the estimated effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> in Simulation 1?</li>
<li>What is the true effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> in Simulation 1?</li>
<li>If you increase your sample size, will the estimated effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> move toward the true effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> in Simulation 1?</li>
</ol>
</div>
<div id="simulation-2-1" class="section level3">
<h3><span class="header-section-number">10.4.2</span> Simulation 2</h3>
<ol start="4" style="list-style-type: decimal">
<li>Given the default parameters specified above, what is the estimated effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> in Simulation 2?</li>
<li>What is the true effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> in Simulation 2?</li>
<li>If you increase your sample size, will the estimated effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> move toward the true effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> in Simulation 2?</li>
<li>If you did a study of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> and the true generating model of <span class="math inline">\(Y\)</span> is that in Simulation 2, what would you conclude about the effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span>?</li>
</ol>
</div>
<div id="simulation-2-with-new-parameters" class="section level3">
<h3><span class="header-section-number">10.4.3</span> Simulation 2 with new parameters</h3>
<p>Redo Simulation 2 with the parameters: <span class="math inline">\(\beta_1 = 0.0\)</span>. Leave <span class="math inline">\(\beta_2 = -0.7\)</span> and <span class="math inline">\(r=0.7\)</span>.</p>
<ol start="8" style="list-style-type: decimal">
<li>What is the estimated effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span>?</li>
<li>What is the true effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> in Simulation 2?</li>
<li>If you did a study of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> and the true generating model of <span class="math inline">\(Y\)</span> is these new parameters in Simulation 2, what would you conclude about the effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span>?</li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="renal.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cancer.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/26-digestion.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["quant-physiology.pdf", "quant-physiology.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
