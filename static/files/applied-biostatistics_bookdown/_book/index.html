<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Elementary Statistical Modeling for Applied Biostatistics</title>
  <meta name="description" content="A first course in statistical modeling for biology students">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Elementary Statistical Modeling for Applied Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A first course in statistical modeling for biology students" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Elementary Statistical Modeling for Applied Biostatistics" />
  
  <meta name="twitter:description" content="A first course in statistical modeling for biology students" />
  

<meta name="author" content="Jeffrey A. Walker">


<meta name="date" content="2018-08-28">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  

<link rel="next" href="variability-and-uncertainty-standard-deviations-and-standard-errors.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Statistical Modeling</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#statistical-modeling-with-linear-models"><i class="fa fa-check"></i><b>1.1</b> Statistical modeling with linear models</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#linear-models-are-used-for-prediction-explanation-and-description"><i class="fa fa-check"></i><b>1.1.1</b> Linear models are used for prediction, explanation, and description</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#model-fitting"><i class="fa fa-check"></i><b>1.2</b> Model fitting</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#a-linear-model-with-a-single-continous-x"><i class="fa fa-check"></i><b>1.2.1</b> A linear model with a single, continous <span class="math inline">\(X\)</span></a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#linear-models-with-categorical-x-are-the-same-as-linear-models-with-continuous-x"><i class="fa fa-check"></i><b>1.2.2</b> Linear models with categorical <span class="math inline">\(X\)</span> are the same as linear models with continuous <span class="math inline">\(X\)</span></a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#statistical-model-not-regression-model"><i class="fa fa-check"></i><b>1.2.3</b> “Statistical model” not “regression model”</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#statistical-modeling-vs.null-hypothesis-testing"><i class="fa fa-check"></i><b>1.3</b> Statistical modeling vs. Null hypothesis testing</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#multilevel-models"><i class="fa fa-check"></i><b>1.4</b> Multilevel models</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#linear-models-versus-non-linear-models"><i class="fa fa-check"></i><b>1.5</b> Linear models versus non-linear models</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><i class="fa fa-check"></i><b>2</b> Variability and Uncertainty (Standard Deviations and Standard Errors)</a><ul>
<li class="chapter" data-level="2.1" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#the-sample-standard-deviation-vs.the-standard-error-of-the-mean"><i class="fa fa-check"></i><b>2.1</b> The sample standard deviation vs. the standard error of the mean</a><ul>
<li class="chapter" data-level="2.1.1" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#sample-standard-deviation"><i class="fa fa-check"></i><b>2.1.1</b> Sample standard deviation</a></li>
<li class="chapter" data-level="2.1.2" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>2.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#using-google-sheets-to-generate-fake-data-to-explore-uncertainty"><i class="fa fa-check"></i><b>2.2</b> Using Google Sheets to generate fake data to explore uncertainty</a><ul>
<li class="chapter" data-level="2.2.1" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#steps"><i class="fa fa-check"></i><b>2.2.1</b> Steps</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#using-r-to-generate-fake-data-to-explore-uncertainty"><i class="fa fa-check"></i><b>2.3</b> Using R to generate fake data to explore uncertainty</a><ul>
<li class="chapter" data-level="2.3.1" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#part-i"><i class="fa fa-check"></i><b>2.3.1</b> part I</a></li>
<li class="chapter" data-level="2.3.2" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#part-ii---means"><i class="fa fa-check"></i><b>2.3.2</b> part II - means</a></li>
<li class="chapter" data-level="2.3.3" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#part-iii---how-do-sd-and-se-change-as-sample-size-n-increases"><i class="fa fa-check"></i><b>2.3.3</b> part III - how do SD and SE change as sample size (n) increases?</a></li>
<li class="chapter" data-level="2.3.4" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#part-iv-generating-fake-data-with-for-loops"><i class="fa fa-check"></i><b>2.3.4</b> Part IV – Generating fake data with “for loops”</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html"><i class="fa fa-check"></i>Appendix 1: Getting Started with R</a><ul>
<li class="chapter" data-level="2.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready"><i class="fa fa-check"></i><b>2.4</b> Get your computer ready</a><ul>
<li class="chapter" data-level="2.4.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r"><i class="fa fa-check"></i><b>2.4.1</b> Install R</a></li>
<li class="chapter" data-level="2.4.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-studio"><i class="fa fa-check"></i><b>2.4.2</b> Install R Studio</a></li>
<li class="chapter" data-level="2.4.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#resources-for-installing-r-and-r-studio"><i class="fa fa-check"></i><b>2.4.3</b> Resources for installing R and R Studio</a></li>
<li class="chapter" data-level="2.4.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-latex"><i class="fa fa-check"></i><b>2.4.4</b> Install LaTeX</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-learning"><i class="fa fa-check"></i><b>2.5</b> Start learning</a><ul>
<li class="chapter" data-level="2.5.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-with-data-camp-introduction-to-r"><i class="fa fa-check"></i><b>2.5.1</b> Start with Data Camp Introduction to R</a></li>
<li class="chapter" data-level="2.5.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#then-move-to-introduction-to-r-studio"><i class="fa fa-check"></i><b>2.5.2</b> Then Move to Introduction to R Studio</a></li>
<li class="chapter" data-level="2.5.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#develop-your-project-with-an-r-studio-notebook"><i class="fa fa-check"></i><b>2.5.3</b> Develop your project with an R Studio Notebook</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#getting-data-into-r"><i class="fa fa-check"></i><b>2.6</b> Getting Data into R</a></li>
<li class="chapter" data-level="2.7" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#additional-r-learning-resources"><i class="fa fa-check"></i><b>2.7</b> Additional R learning resources</a></li>
<li class="chapter" data-level="2.8" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#packages-used-extensively-in-this-text"><i class="fa fa-check"></i><b>2.8</b> Packages used extensively in this text</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-online-resources-for-getting-started-with-linear-modeling-in-r.html"><a href="appendix-2-online-resources-for-getting-started-with-linear-modeling-in-r.html"><i class="fa fa-check"></i>Appendix 2: Online Resources for Getting Started with Linear Modeling in R</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Elementary Statistical Modeling for Applied Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Elementary Statistical Modeling for Applied Biostatistics</h1>
<h4 class="author"><em>Jeffrey A. Walker</em></h4>
<h4 class="date"><em>2018-08-28</em></h4>
</div>
<div id="statistical-modeling" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Statistical Modeling</h1>
<p><em>More cynically, one could also well ask “Why has medicine not adopted frequentist inference, even though everyone presents P-values and hypothesis tests?” My answer is: Because frequentist inference, like Bayesian inference, is not taught. Instead everyone gets taught a misleading pseudo-frequentism: a set of rituals and misinterpretations caricaturing frequentist inference, leading to all kinds of misunderstandings.</em> – Sander Greenland</p>
<p>We use statistics to learn from data with uncertainty. Traditional introductory textbooks in biostatistics implicitly or explicitly train students and researchers to “discover by p-value” using hypothesis tests (appendix xxx). Over the course of many chapters, the student is trained to use something like a dichotomous key to choose the correct “test” for the data at hand, compute a test statistic for their data, compute a <span class="math inline">\(p\)</span>-value based on the test statistic, and compares the <em>p</em>-value to 0.05. Textbooks typically give very little guidance about what can be concluded if <span class="math inline">\(p &lt; 0.05\)</span> or if <span class="math inline">\(p &gt; 0.05\)</span>, but many researchers conclude they have “discovered” something if <span class="math inline">\(p &lt; 0.05\)</span> but found “no effect” if <span class="math inline">\(p &gt; 0.05\)</span>.</p>
<p>Researchers learn almost nothing useful from a hypothesis test. If we are investigating the effects of an increasingly acidified ocean on coral growth, <span class="math inline">\(p=0.002\)</span> may be evidence that pH affects growth, but, from everything we know about pH and cell biology, it would be absurd to conclude from any data that ocean acidification does not affect growth. Instead, we want to know the magnitude of the effect and our uncertainty in estimating this magnitude. We can use this magnitude and uncertainty to make predictions about the future of coral reefs, under different scenarios of ocean acidification. We can use the estimated effects and uncertainty to model the consquences of the effects of acidification on coral growth on fish production or carbon cycling.</p>
<p>The “discovery by p-value” strategy, or Null-Hypothesis Significance Testing (NHST), has been criticized by statisticians for many, many decades. Nevertheless, introductory biostatistics textbooks written by both biologists and statisticians continue to organize textbooks around a collection of hypothesis tests, with little emphasis on estimation and uncertainty.</p>
<div id="statistical-modeling-with-linear-models" class="section level2">
<h2><span class="header-section-number">1.1</span> Statistical modeling with linear models</h2>
<p>This textbook is an introduction to the analysis of biological data using a statistical modeling approach. As an introduction, the focus will be linear models and extensions of the linear models including linear mixed models and generalized linear models. Here, I refer to all of these as “linear models” because all are a function of a linear predictor. Linear models are the engine behind many hypothesis tests but the emphasis in statistical modeling is estimation and uncertainty instead of test statistics and <span class="math inline">\(p\)</span>-values. A modeling view of statistics is also more coherent than a dichotomous key strategy.</p>
<blockquote>
<p><strong>Box</strong></p>
<p>linear mixed models are also known as multilevel models and hierarchical models. Generalized linear models (GLMs) are frequently called non-linear models. While it is true that the response (<span class="math inline">\(Y\)</span>) is usually a non-linear function of the <span class="math inline">\(X\)</span> in a GLM, the expected values of <span class="math inline">\(Y\)</span> are a non-linear transformation of a linear predictor function like that in equation <a href="index.html#eq:lm">(1.2)</a>. A common phrase is that GLMs are “linear in the parameters.”</p>
</blockquote>
<div class="figure"><span id="fig:line"></span>
<img src="bookdown-demo_files/figure-html/line-1.png" alt="A line vs. a linear model. (A) the line $y=-3.48X + 105.7 is drawn. (B) A linear model fit to the data. The model coefficients are numerically equal to the slope and intercept of the line in A." width="672" />
<p class="caption">
Figure 1.1: A line vs. a linear model. (A) the line $y=-3.48X + 105.7 is drawn. (B) A linear model fit to the data. The model coefficients are numerically equal to the slope and intercept of the line in A.
</p>
</div>
<p>All students are familiar with the idea of a linear model from learning the equation of a line, which is</p>
<span class="math display" id="eq:line">\[\begin{equation}
Y = mX + b
\tag{1.1}
\end{equation}\]</span>
<p>where <span class="math inline">\(m\)</span> is the slope of the line and <span class="math inline">\(b\)</span> is the <span class="math inline">\(Y\)</span>-intercept. It is useful to think of equation <a href="index.html#eq:line">(1.1)</a> as a function that maps values of <span class="math inline">\(X\)</span> to values of <span class="math inline">\(Y\)</span>. Using this function, if we input some value of <span class="math inline">\(X\)</span>, we always get the same value of Y as the output.</p>
<p>A linear model is a function, like that in equation <a href="index.html#eq:line">(1.1)</a>, that is fit to a set of data, often to model a process that generated the data or something like the data. The line in Figure <a href="index.html#fig:line">1.1</a>A is just that, a line, but the line in Figure <a href="index.html#fig:line">1.1</a>B is a model of the data in Figure <a href="index.html#fig:line">1.1</a>B. The basic structure of a linear model is</p>
<span class="math display" id="eq:lm">\[\begin{equation}
Y = \beta_0 + \beta_1 X + \varepsilon
\tag{1.2}
\end{equation}\]</span>
<p>A linear model has two parts: the “model” (<span class="math inline">\(Y = \beta_0 + \beta_1 X\)</span>) and the “error” (<span class="math inline">\(\varepsilon\)</span>). The model part looks like the equation for a line except that I’ve used <span class="math inline">\(\beta_0\)</span> for the intercept and <span class="math inline">\(\beta_1\)</span> for the slope and I’ve put the intercept term first. This re-labeling and re-arrangement make the notation for a linear model more flexible for more complicated linear models. For example <span class="math inline">\(Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \varepsilon\)</span> is a model where <span class="math inline">\(Y\)</span> is a function of two <span class="math inline">\(X\)</span> variables.</p>
<p>As with the equation for a line, the model part of a linear model is a function that maps a value of <span class="math inline">\(X\)</span> to a specific value of <span class="math inline">\(Y\)</span>. This mapped value is the <strong>expected value</strong> given a specific input value of <span class="math inline">\(X\)</span>. The error part of a linear model is a random variable that adds some random value to this expected value. Nothing about the model part of a linear model can predict its value.</p>
<p>The inputs to a linear model (the <span class="math inline">\(X\)</span> variables) have many names including “independent variables,” “predictor variables,”, “explanatory variables,” “treatment variables,” and “covariates”. The output of a linear model (the <span class="math inline">\(Y\)</span> variable or variables if the model is multivariate) is the “dependent variable,” “response,” or “outcome.” The <span class="math inline">\(\beta\)</span> in the linear model are model <strong>parameters</strong> There can be additional parameters in more sophisticated models. The coefficients of the <span class="math inline">\(X\)</span> in a linear model (<span class="math inline">\(\beta_1\)</span> in model <a href="index.html#eq:lm">(1.2)</a>) are often called “the effects” (so <span class="math inline">\(\beta_1\)</span> is the effect of <span class="math inline">\(X_1\)</span>).</p>
<p>Although a linear model is a model of a data-generating process, linear models are not typically used to actually generate any data. Instead, when we use a linear model to understand something about a real dataset, we think of our data as one realization of a process that generates data like ours. A linear model is a model of that process. That said, it is incredibly useful to use linear models to create fake datasets for at least two reasons: to probe our understanding of statistical modeling generally and, more specifically, to check that a model actually creates data like that in the real dataset that we are analyzing.</p>
<div id="linear-models-are-used-for-prediction-explanation-and-description" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Linear models are used for prediction, explanation, and description</h3>
<p>Researchers typically use linear models to understand relationships between one or more <span class="math inline">\(Y\)</span> variables and one or more <span class="math inline">\(X\)</span> variables. These relationships include</p>
<ol style="list-style-type: decimal">
<li><p>Descriptive modeling. Sometimes a researcher merely wants to describe the relationship between <span class="math inline">\(Y\)</span> and a set of <span class="math inline">\(X\)</span> variables, perhaps to discover patterns. For example, the arrival of a spring migrant bird (<span class="math inline">\(Y\)</span>) as a function of sex (<span class="math inline">\(X_1\)</span>) and age (<span class="math inline">\(X_2\)</span>) might show that males and younger individuals arrive earlier. Importantly, if another <span class="math inline">\(X\)</span> variable is added to the model (or one dropped), the coefficients, and therefore, the precise description, will change. That is, the interpretation of a coefficient as a descriptor is <em>conditional</em> on the other covariates (<span class="math inline">\(X\)</span> variables) in the model. In a descriptive model, there is no implication of causal effects and the goal is not prediction. Nevertheless, it is very hard for humans to discuss a descriptive model without using causal language, which probably means that it is hard for us to think of these models as <em>mere description</em>. Like natural history, descriptive models are useful as patterns in want of an explanation, using more explicit causal models including experiments.</p></li>
<li><p>Predictive modeling. Predictive modeling is very common in applied research. For example, fisheries researchers might model the relationship between population density and habitat variables to predict which subset of ponds in a region are most suitable for brook trout (<em>Salvelinus fontinalis</em>) reintroduction. The goal is to build a model with minimal prediction error, which is the error between predicted and actual values for a future sample. In predictive modeling, the <span class="math inline">\(X\)</span> (“predictor”) variables are largely instrumental – how these are related to <span class="math inline">\(Y\)</span> is not a goal of the modeling, although sometimes an investigator may be interested in the relative importance among the <span class="math inline">\(X\)</span> for predicting <span class="math inline">\(Y\)</span> (for example, collecting the data may be time consuming, or expensive, or enviromentally destructive, so know which subset of <span class="math inline">\(X\)</span> are most important for predicting <span class="math inline">\(Y\)</span> is a useful strategy).</p></li>
<li><p>Explanatory (causal) modeling. Very often, researchers are explicitly interested in <em>how</em> the <span class="math inline">\(X\)</span> variables are causally related to <span class="math inline">\(Y\)</span>. The fisheries researchers that want to reintroduce trout may want to develop and manage a set of ponds to maintain healthy trout populations. This active management requires intervention to change habitat traits in a direction, and with a magnitude, to cause the desired response. This model is predictive – a specific change in <span class="math inline">\(X\)</span> predicts a specific response in <span class="math inline">\(Y\)</span> – because the coefficients of the model provide knowledge on how the system functions – how changes in the inputs <em>cause</em> change in the output. Causal interpretation of model coefficients requires a set of strong assumptions about the <span class="math inline">\(X\)</span> variables in the model.</p></li>
</ol>
<p>Biologists are often not very explicit about which of these is the goal of the modeling and use a combination of descriptive, predictive, and causal language to describe and discuss results. By contrast, researchers in economics and other social sciences, as well as epidemiology and medicine more generally, are usually very explicit if their model is descriptive, predictive, or causal.</p>
</div>
</div>
<div id="model-fitting" class="section level2">
<h2><span class="header-section-number">1.2</span> Model fitting</h2>
<p>In order to use a linear model to describe, predict, or explain, we need to fit a model to data. Instead of using an abtract model like that in model <a href="index.html#eq:lm">(1.2)</a>, I will introduce model fitting using data from Dryad Data Repository.</p>
<div id="a-linear-model-with-a-single-continous-x" class="section level3">
<h3><span class="header-section-number">1.2.1</span> A linear model with a single, continous <span class="math inline">\(X\)</span></h3>
<p>The data are from <span class="citation">(<span class="citeproc-not-found" data-reference-id="Dantzer_xxx"><strong>???</strong></span>)</span>, who showed that North American red squirrel (<em>Tamiasciurus hudsonicus</em>) mothers from Yukon, Alaska produce faster growing pups in years with increased squirrel density. Remarkably, they even showed that perceived (but not actual) density results in faster growing pups. To begin to investigate how pregnant mothers control the future growth rate of pups, the researchers measured the relationship between local squirrel density and the amount of fecal cortisol metabolites from pregnant mothers. Cortisol is a hormone that is secreted as part of stress response. The researchers were interested in cortisol because it had previously been shownt that, in mammals, blood cortisol levels in pregnant mothers have numerous effects on offspring long past birth. If increased squirrel density causes increased blood cortisol levels then we would expect to find a positive relationship between <span class="math inline">\(Density\)</span> and</p>
<div class="figure"><span id="fig:squirrel"></span>
<img src="bookdown-demo_files/figure-html/squirrel-1.png" alt="A scatterplot of Fecal cortisol matabolites and squirrel density." width="672" />
<p class="caption">
Figure 1.2: A scatterplot of Fecal cortisol matabolites and squirrel density.
</p>
</div>
<p>Figure <a href="index.html#fig:squirrel">1.2</a> is a <strong>scatterplot</strong> of the data with the amount of cortisol metabolites in the feces on the <span class="math inline">\(Y\)</span> axis and local squirrel density on the <span class="math inline">\(X\)</span> axis. The line through the data is a graphical representation of a linear model fit to the data and the gray cloud around the line is a graphical representation of the uncertainty in the model. The researchers wanted to model the “effect” of squirrel density on the amount of cortisol metabolites in the feces of the pregnant mothers. Graphically, this effect is the slope of the line in Figure <a href="index.html#fig:squirrel">1.2</a>.</p>
<p>The model is</p>
<span class="math display" id="eq:regression">\[\begin{equation}
\textrm{E}[FCM|Density] = \beta_0 + \beta_1 Density
\tag{1.3}
\end{equation}\]</span>
<p>In words, model <a href="index.html#eq:regression">(1.3)</a> reads “the expected value of <span class="math inline">\(FCM\)</span> conditional on density is beta-knot plus beta-one times density”. An <strong>expected value</strong> is a long run average – if we were to sample lots and lots of red squirrel populations with <span class="math inline">\(Density=x\)</span> (where <span class="math inline">\(x\)</span> is a specific value), we’d expect the average <span class="math inline">\(FCM\)</span> across these samples to be <span class="math inline">\(\beta_0 + \beta_1 x\)</span>.</p>
<p>In model <a href="index.html#eq:regression">(1.3)</a>, there is a single <span class="math inline">\(X\)</span> variable (<span class="math inline">\(FCM\)</span>). While the <span class="math inline">\(X\)</span> variables are often called the “dependent” variables, in this model <span class="math inline">\(FCM\)</span> does not “depend” on the independent variable <span class="math inline">\(Density\)</span> in any causal sense – meaning if I were to intervene and set <span class="math inline">\(Density\)</span> to some value <span class="math inline">\(x\)</span>, I would expect <span class="math inline">\(FCM\)</span> to equal <span class="math inline">\(\beta_0 + \beta_1 x\)</span>. Rather, <span class="math inline">\(FCM\)</span> only “depends” on <span class="math inline">\(Density\)</span> in a probablistic sense – if <span class="math inline">\(Density = x\)</span> then the most probable value of <span class="math inline">\(FCM\)</span> is <span class="math inline">\(\beta_0 + \beta_1 x\)</span>. With some strong assumptions model <a href="index.html#eq:regression">(1.3)</a> can be turned into a model of causal dependency, which is the focus of chapter xxx.</p>
<p><span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are the <strong>parameters</strong> of model <a href="index.html#eq:regression">(1.3)</a>. Specifically <span class="math inline">\(\beta_0\)</span> is the model <strong>intercept</strong> and <span class="math inline">\(\beta_1\)</span> is the modeled <strong>effect</strong> of <span class="math inline">\(Density\)</span>. Again, the effect (<span class="math inline">\(\beta_1\)</span>) has a probabilistic, and not causal, interpretation. This interpretation is</p>
<span class="math display" id="eq:beta1">\[\begin{equation}
\beta_1 = \textrm{E}[FCM|Density=x+1] - \textrm{E}[FCM|Density=x] 
\tag{1.4}
\end{equation}\]</span>
<p>Or, in words, “beta-1 is the expected value of FCM when density equals x + 1 minus the expected value of FCM when the density equals x.” <span class="math inline">\(\beta_1\)</span> is simply the difference in expected values given a one unit difference in <span class="math inline">\(Density\)</span>.</p>
<div id="using-a-linear-model-to-estimate-effects" class="section level4">
<h4><span class="header-section-number">1.2.1.1</span> Using a linear model to estimate effects</h4>
<p>The goal of the statistical model here is to estimate <span class="math inline">\(\beta_1\)</span> – the probabalistic effect of <span class="math inline">\(Density\)</span> on <span class="math inline">\(FCM\)</span>. This estimate, and a measure of the uncertainty of this estimate, are in the table of coefficients of the fit model</p>
<pre><code>##             Estimate Std. Error  t value     Pr(&gt;|t|)
## (Intercept) 735.9604   331.9395 2.217152 0.0280776547
## Density     671.1380   178.8963 3.751549 0.0002483802</code></pre>
<p>where the entries in the column “Estimate” are estimates of the parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in model <a href="index.html#eq:regression">(1.3)</a>. The entries in the column “Std. Error” are the standard errors (SE) of the estimates, which are measures of the uncertainty of the estimates.</p>
<p>The parameter estimates in the table above are the coefficients of the fitted model</p>
<span class="math display" id="eq:fcmi">\[\begin{equation}
FCM_i = b_0 + b_1 Density_i + e_i
\tag{1.5}
\end{equation}\]</span>
<p>where the subscript <em>i</em> refers to the <em>i</em>th individual. The coefficients <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are the y-intercept and the slope of the line in Figure <a href="index.html#fig:squirrel">1.2</a>. The coefficient for <span class="math inline">\(Density\)</span> (<span class="math inline">\(b_1\)</span>) is 671.1, and (given the definition of the parameter <span class="math inline">\(\beta_1\)</span> in equation <a href="index.html#eq:beta1">(1.4)</a>) we expect squirrel mothers with a local density of 2 squirrels within a 150 m radius of her midden to average 671.1 more units of FCM (ng of fecal cortical metabolites per gram dry food) than mother squirrels with a local density of only 1 squirrel within a 150 m radius of her midden. Remember that this coefficient is estimating a probabilistic parameter. Consequently, the coefficient <span class="math inline">\(b_1\)</span> is simply a descriptor of a pattern of relationship between local density and fecal cortisol metabolites - no causal effect is implied. With the strong assumptions explained in chapter xxx, however, <span class="math inline">\(b_1\)</span> can estimate a causal effect.</p>
</div>
<div id="using-a-linear-model-for-prediction" class="section level4">
<h4><span class="header-section-number">1.2.1.2</span> Using a linear model for prediction</h4>
<p>Model <a href="index.html#eq:fcmi">(1.5)</a> gives the measured value of <em>FCM</em> for each squirrel. The equation includes the modeled part (<span class="math inline">\(b_0 + b_1 Density_i\)</span>) and the <strong>residual</strong> from the model (<span class="math inline">\(e_i\)</span>). The modeled part is the modeled or <strong>predicted value</strong>,</p>
<span class="math display" id="eq:fcmhat">\[\begin{equation}
\widehat{FCM} = b_0 + b_1 Density
\tag{1.6}
\end{equation}\]</span>
<p>where <span class="math inline">\(\widehat{FCM}\)</span> is read as “FCM hat”. Very often, we use the model part (equation <a href="index.html#eq:fcmhat">(1.6)</a>) to predict unknown or future values given different modeled inputs (the <span class="math inline">\(X\)</span>).</p>
</div>
</div>
<div id="linear-models-with-categorical-x-are-the-same-as-linear-models-with-continuous-x" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Linear models with categorical <span class="math inline">\(X\)</span> are the same as linear models with continuous <span class="math inline">\(X\)</span></h3>
<p>Singh et al. (xxx) studied the effect of parasite infection on the production of recombinant offspring in several lines of fruit fly <em>Drosophila melanogaster</em>. Recombinant offspring are those with allele combinations that do not occur in either parent.</p>
<div class="figure"><span id="fig:recombinantFlyPlot"></span>
<img src="bookdown-demo_files/figure-html/recombinantFlyPlot-1.png" alt="Harrell plot of fly data. The bottom part of the graph shows the data while the top part shows the effect estimate and a measure of uncertainty. The specifics of the plot will be explained in Chapter xxx. Briefly, the large black dots within the boxes in the bottom part are the group mean recombinant frequencies. The black dot in the top part of the plot is the difference in these group means (the effect)." width="672" />
<p class="caption">
Figure 1.3: Harrell plot of fly data. The bottom part of the graph shows the data while the top part shows the effect estimate and a measure of uncertainty. The specifics of the plot will be explained in Chapter xxx. Briefly, the large black dots within the boxes in the bottom part are the group mean recombinant frequencies. The black dot in the top part of the plot is the difference in these group means (the effect).
</p>
</div>
<p>Figure <a href="index.html#fig:recombinantFlyPlot">1.3</a>, shows the results of one of the experiments, specifically, the recombinant frequencies for each replicate of the <strong>treatment levels</strong> “Smarc” (flies who were parasitized by the bacteria <em>Serratia marcescens</em>) and “Wounded” (flies who were given a sterile wound as a control). The mean of each treatment level (or group) is shown with the large black dot within the group’s scatter of individual values, and the difference in the means is shown in the top part with the black dot in the top part. The top plot also shows a measure of the uncertainty in the estimate of this difference (the thick black line).</p>
<p>The means of the two treatment levels (groups) are</p>
<pre><code>##    Treatment      mean
## 1:     Smarc 0.1949128
## 2:   Wounded 0.1647802</code></pre>
<p>The difference between the means is 0.0301326. This is the estimate of the effect of <em>S. marcescens</em> parasitism on recombinant frequency. In general, we wouldn’t report these means or this difference in means to this precision because the raw measures are not this precise but I do it here because in order to compare this result to that of analzying the data with a linear model.</p>
<p>The effect of <span class="math inline">\(Treatment\)</span> can be modeled with the linear model</p>
<span class="math display" id="eq:categorical">\[\begin{equation}
\textrm{E}[Recombinant\_fraction|Treatment] = \beta_0 + \beta_1 Treatment
\tag{1.7}
\end{equation}\]</span>
<p>The left side of this equation is read as “the expected recombinant fraction conditional on Treatment” and can be thought of as “the expected recombinant fraction for a specific treatment level is equal to…”. Perhaps surprisingly, this is the same model as that used for the squirrel fecal cortical metabolites, which is, more generally <span class="math inline">\(\textrm{E}[Y|X] = \beta_0 + \beta_1 X\)</span>.</p>
<p>What are the estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>?</p>
<pre><code>##                  Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)    0.16478024 0.01129404 14.590016 8.719394e-32
## TreatmentSmarc 0.03013261 0.01570068  1.919191 5.663526e-02</code></pre>
<p>Compare the column “Estimate” with the group means and difference in means computed above. The estimate of the intercept is the mean of the Wounded group. The estimate of the <span class="math inline">\(Treatment\)</span> coefficient is the difference in means. That is,</p>
<p><strong>In a linear model with a categorical <span class="math inline">\(X\)</span>, the coefficients (<span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>) are a mean and a difference in means.</strong></p>
<p>The coefficients in the model with categorical <span class="math inline">\(X\)</span> are also an intercept and slope, and this is explored in the problems at the end of the chapter, but it is not especially useful to think of them in this way. In both kinds of models (categorical and continous <span class="math inline">\(X\)</span>), we are generally less interested in <span class="math inline">\(b_0\)</span> and more interested in <span class="math inline">\(b_1\)</span> – the effect of <span class="math inline">\(X\)</span>.</p>
<p>For the recombinant fly experiment, the effect of bacteria infection is 0.03, or 3 additional recombinants per 100 offspring. The SE of this effect (0.016) is our measure of uncertainty. The SE is used to compute the 95% confidence interval in the top part of figure <a href="index.html#fig:recombinantFlyPlot">1.3</a>. The interval contains the range of effects that are consistent with the data. This range includes values up to about 6% and down to about 0%. Importantly, negative values (other than very small ones) are not consistent with the data.</p>
</div>
<div id="statistical-model-not-regression-model" class="section level3">
<h3><span class="header-section-number">1.2.3</span> “Statistical model” not “regression model”</h3>
<p>Statistical modeling terminology can be confusing. The <span class="math inline">\(X\)</span> variables in a statistical model may be quantitative (continuous or integers) or categorical (names or qualitative amounts) or some mix of the two. Linear models with all quantitative independent variables are often called “regression models.” Linear models with all categorical independent variables are often called “ANOVA models”. Linear models with a mix of quantitative and categorical variables are often called “ANCOVA models” if the focus is on one of the categorical <span class="math inline">\(X\)</span> or “regression models” if there tend to be many independent variables. These names reflect the history of the development of the different kinds of linear models. I advocate using the term “statistical model” for general usage and “linear model” for more specific use, regardless of the combination of variable types.</p>
</div>
</div>
<div id="statistical-modeling-vs.null-hypothesis-testing" class="section level2">
<h2><span class="header-section-number">1.3</span> Statistical modeling vs. Null hypothesis testing</h2>
<p>Most biostatistics textbooks for biologists guide a student/researcher toward the “correct” statistical test for experimental data. The concept of a statistical test of inference is explored more in Appendix xxx but for now, a typical textbook would probably steer a researcher into analzying the recombinant fly data with a t-test of the difference between means.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fly_t &lt;-<span class="st"> </span><span class="kw">t.test</span>(Recombinant_fraction <span class="op">~</span><span class="st"> </span>Treatment, <span class="dt">data=</span>sub_fly, <span class="dt">var.equal=</span><span class="ot">TRUE</span>)
fly_t.p &lt;-<span class="st"> </span>fly_t<span class="op">$</span>p.value
fly_t.t &lt;-<span class="st"> </span><span class="kw">abs</span>(fly_t<span class="op">$</span>statistic)</code></pre></div>
<p>The output of a <em>t</em>-test is a test statistic (<em>t</em>) and a <em>p</em>-value, which, roughly, is the probability of finding a test statistic as large or larger than the observed test statistic if we were to repeat the experiment many, many times using hypothetical data in which there is no effect. This hypothetical data with no effect is the <strong>null hypothesis</strong>.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> A very small <em>p</em> (say 0.01 or 0.0001) would be unlikely if the null hypothesis were true, and, consequently, a very small <em>p</em> is evidence “against the null” (or evidence that a low-probability event occurred, but we don’t have additional evidence for this so this conclusion is generally dismissed). Again, researchers typically conclude that a difference is “statistically significant” if <em>p</em> is less than 0.05 and, consequently, the treatment has “an effect”.</p>
<p>The <em>t</em>-statistic for the fly recombinant data is 1.9191906 and the <em>p</em>-value is 0.0566353, which means there is a 5.6% probability of finding <em>t</em> <span class="math inline">\(\ge\)</span> 1.9191906 if “the null were true”. The <em>p</em>-value of 0.056 is a pretty small probability, and is close to but not smaller than 0.05, and so is not “statistically significant.” How is this reported? If the researchers have an <em>a priori</em> hypothesis of an effect, they will often report a <em>p</em>-value of 0.056 as “marginally significant” or worse “trending toward significant” (why not trending “away”?). But if the researchers have an <em>a priori</em> hypothesis of no effect, then they will often report a <em>p</em>-value of 0.056 as simply “not significant” or worse “no effect” (see xxx why a <em>p</em>-value is not evidence of no effect).</p>
<p>Most importantly, no part of null hypothesis testing is concerned with estimating the effect size and our uncertainty in this estimate. Test statistics and <em>p</em>-values are not measures of effect size even though each is a function of effect size. This is because each is also a function of sample size and variation. A large <em>t</em> and small <em>p</em> could result from a large effect, or a large sample, or small variability. Null hypothesis testing encourages a focus on the trivia (presence or absence of an effect) instead of the information that we need to model a system. If we want to model the biological consquences of an intervention, such as a drug, or of changing conditions, such as ocean ocidification, or if we just want to model relationships within a system, then we need measures of effect size and uncertainty from statistical models.</p>
<p>A <em>p</em>-value can is a useful, but limited tool, and a researcher can use the statistical model to test specific hypotheses if desired. The coefficients of the model are the simplest of these tests. Look at the column “Pr(&gt;|t|)” in the table of coefficients from the recombinant fly experiment above. This column contains the probability of a <em>t</em>-test for each coefficient. The <em>p</em> value for <span class="math inline">\(b_1\)</span> (the Smarc treatment) is precisely the <em>p</em>-value for the <em>t</em>-test of the means. This is because the math behind a <em>t</em>-test is a special case of the linear model in model <a href="index.html#eq:categorical">(1.7)</a>. And the math behind ANOVA is a special case of the linear model. And the math behind regression is a special case of the linear model. In other words, there is little reason to learn these special cases as unrelated tests. There is no reason to teach (or learn) the dichotomous key to the tests of inference.</p>
</div>
<div id="multilevel-models" class="section level2">
<h2><span class="header-section-number">1.4</span> Multilevel models</h2>
</div>
<div id="linear-models-versus-non-linear-models" class="section level2">
<h2><span class="header-section-number">1.5</span> Linear models versus non-linear models</h2>
<p>In this text, I use “linear model” for any model that is linear in the parameters, which means that the different components of the model are added together. Or, using the language of matrix algebra, the predictor is a simple dot product of the model matrix and the coefficients. For example, a cubic polynomial model</p>
<span class="math display">\[\begin{equation}
Y = \beta_0 + \beta_1 X + \beta_2 X^2 + \beta_3 X^3 + \varepsilon
\end{equation}\]</span>
<p>is a linear model, even though the function is non-linear, because the different components are added (or, using matrix algebra, the predictor is <span class="math inline">\(\mathbf{X}\boldsymbol{\beta}\)</span>).</p>
<p>A generalized linear model (GLM) has the form <span class="math inline">\(g(\mu_i) = \eta_i\)</span> where <span class="math inline">\(\eta\)</span> (the greek letter eta) is the linear predictor, which is linear in the parameters.</p>
<span class="math display">\[\begin{equation}
\eta = \mathbf{X}\boldsymbol{\beta} 
\end{equation}\]</span>
<p>Many sources do not consider a GLM to be a “linear model” but an “extension” of a linear model. Regardless, a GLM is linear in the parameters and in this textbook, I include GLMs under the “linear model” umbrella.</p>
<p>Non-linear models, in conrast to a GLM or classical linear model, are not linear in the parameters (the predictor is not a simple dot product of the model matrix and a vector of parameters). For example, the Michaelis-Menten model is a nonlinear model</p>
<span class="math display">\[\begin{equation}
Y = \frac{\beta_1 X}{\beta_2 + X} + \varepsilon
\end{equation}\]</span>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>The effect in the null hypotheses can be any pre-specified value. The nil null (zero effect) is the most common<a href="index.html#fnref1">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/index.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
