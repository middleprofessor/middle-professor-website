<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 A linear model with a single, categorical X | Elementary Statistical Modeling for Applied Biostatistics</title>
  <meta name="description" content="A first course in statistical modeling for biology students" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 A linear model with a single, categorical X | Elementary Statistical Modeling for Applied Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A first course in statistical modeling for biology students" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 A linear model with a single, categorical X | Elementary Statistical Modeling for Applied Biostatistics" />
  
  <meta name="twitter:description" content="A first course in statistical modeling for biology students" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-linear-model-with-a-single-continuous-x.html"/>
<link rel="next" href="model-checking-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#math"><i class="fa fa-check"></i><b>0.1</b> Math</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#r-and-programming"><i class="fa fa-check"></i><b>0.2</b> R and programming</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-r-fundamentals.html"><a href="part-i-r-fundamentals.html"><i class="fa fa-check"></i>Part I: R fundamentals</a></li>
<li class="chapter" data-level="1" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html"><i class="fa fa-check"></i><b>1</b> Organization – R Projects and R Notebooks</a><ul>
<li class="chapter" data-level="1.1" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#importing-packages"><i class="fa fa-check"></i><b>1.1</b> Importing Packages</a></li>
<li class="chapter" data-level="1.2" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-an-r-studio-project-for-this-class"><i class="fa fa-check"></i><b>1.2</b> Create an R Studio Project for this Class</a></li>
<li class="chapter" data-level="1.3" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#r-notebooks"><i class="fa fa-check"></i><b>1.3</b> R Notebooks</a><ul>
<li class="chapter" data-level="1.3.1" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-an-r-notebook-for-this-chapter"><i class="fa fa-check"></i><b>1.3.1</b> Create an R Notebook for this Chapter</a></li>
<li class="chapter" data-level="1.3.2" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-a-load-packages-chunk"><i class="fa fa-check"></i><b>1.3.2</b> Create a “load-packages” chunk</a></li>
<li class="chapter" data-level="1.3.3" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-a-simple-plot-chunk"><i class="fa fa-check"></i><b>1.3.3</b> Create a “simple plot” chunk</a></li>
<li class="chapter" data-level="1.3.4" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-more-r-chunks-and-explore-options-and-play-with-r-code"><i class="fa fa-check"></i><b>1.3.4</b> Create more R chunks and explore options and play with R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-reading-writing-and-wrangling.html"><a href="data-reading-writing-and-wrangling.html"><i class="fa fa-check"></i><b>2</b> Data – Reading, Writing, and Wrangling</a><ul>
<li class="chapter" data-level="2.1" data-path="data-reading-writing-and-wrangling.html"><a href="data-reading-writing-and-wrangling.html#create-new-notebook-for-this-chapter"><i class="fa fa-check"></i><b>2.1</b> Create new notebook for this chapter</a></li>
<li class="chapter" data-level="2.2" data-path="data-reading-writing-and-wrangling.html"><a href="data-reading-writing-and-wrangling.html#importing-data"><i class="fa fa-check"></i><b>2.2</b> Importing data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-reading-writing-and-wrangling.html"><a href="data-reading-writing-and-wrangling.html#excel-file"><i class="fa fa-check"></i><b>2.2.1</b> Excel file</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-reading-writing-and-wrangling.html"><a href="data-reading-writing-and-wrangling.html#text-file"><i class="fa fa-check"></i><b>2.2.2</b> Text file</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-reading-writing-and-wrangling.html"><a href="data-reading-writing-and-wrangling.html#data-wrangling"><i class="fa fa-check"></i><b>2.3</b> Data wrangling</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data-reading-writing-and-wrangling.html"><a href="data-reading-writing-and-wrangling.html#combining-data"><i class="fa fa-check"></i><b>2.3.1</b> Combining data</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-reading-writing-and-wrangling.html"><a href="data-reading-writing-and-wrangling.html#subsetting-data"><i class="fa fa-check"></i><b>2.3.2</b> Subsetting data</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-reading-writing-and-wrangling.html"><a href="data-reading-writing-and-wrangling.html#missing-data"><i class="fa fa-check"></i><b>2.3.3</b> missing data</a></li>
<li class="chapter" data-level="2.3.4" data-path="data-reading-writing-and-wrangling.html"><a href="data-reading-writing-and-wrangling.html#reshaping-data"><i class="fa fa-check"></i><b>2.3.4</b> Reshaping data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-reading-writing-and-wrangling.html"><a href="data-reading-writing-and-wrangling.html#saving-data"><i class="fa fa-check"></i><b>2.4</b> Saving data</a></li>
<li class="chapter" data-level="2.5" data-path="data-reading-writing-and-wrangling.html"><a href="data-reading-writing-and-wrangling.html#problems"><i class="fa fa-check"></i><b>2.5</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-some-fundamentals-of-statistical-modeling.html"><a href="part-ii-some-fundamentals-of-statistical-modeling.html"><i class="fa fa-check"></i>Part II: Some Fundamentals of Statistical Modeling</a></li>
<li class="chapter" data-level="3" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html"><i class="fa fa-check"></i><b>3</b> An Introduction to Statistical Modeling</a><ul>
<li class="chapter" data-level="3.1" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#two-specifications-of-a-linear-model"><i class="fa fa-check"></i><b>3.1</b> Two specifications of a linear model</a><ul>
<li class="chapter" data-level="3.1.1" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#the-error-draw-specification"><i class="fa fa-check"></i><b>3.1.1</b> The “error draw” specification</a></li>
<li class="chapter" data-level="3.1.2" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#the-conditional-draw-specification"><i class="fa fa-check"></i><b>3.1.2</b> The “conditional draw” specification</a></li>
<li class="chapter" data-level="3.1.3" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#comparing-the-two-ways-of-specifying-the-linear-model"><i class="fa fa-check"></i><b>3.1.3</b> Comparing the two ways of specifying the linear model</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#what-do-we-call-the-x-and-y-variables"><i class="fa fa-check"></i><b>3.2</b> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li class="chapter" data-level="3.3" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#statistical-models-are-used-for-prediction-explanation-and-description"><i class="fa fa-check"></i><b>3.3</b> Statistical models are used for prediction, explanation, and description</a></li>
<li class="chapter" data-level="3.4" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#modeling-strategy"><i class="fa fa-check"></i><b>3.4</b> Modeling strategy</a></li>
<li class="chapter" data-level="3.5" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#a-mean-is-the-simplest-model"><i class="fa fa-check"></i><b>3.5</b> A mean is the simplest model</a></li>
<li class="chapter" data-level="3.6" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#assumptions-for-inference-with-a-statistical-model"><i class="fa fa-check"></i><b>3.6</b> Assumptions for inference with a statistical model</a></li>
<li class="chapter" data-level="3.7" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#specific-assumptions-for-inference-with-a-linear-model"><i class="fa fa-check"></i><b>3.7</b> Specific assumptions for inference with a linear model</a></li>
<li class="chapter" data-level="3.8" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#statistical-model-or-regression-model"><i class="fa fa-check"></i><b>3.8</b> “Statistical model” or “regression model”?</a></li>
<li class="chapter" data-level="3.9" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#glm-vs.glm-vs.gls"><i class="fa fa-check"></i><b>3.9</b> GLM vs. GLM vs. GLS</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><i class="fa fa-check"></i><b>4</b> Variability and Uncertainty (Standard Deviations, Standard Errors, Confidence Intervals)</a><ul>
<li class="chapter" data-level="4.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#the-sample-standard-deviation-vs.the-standard-error-of-the-mean"><i class="fa fa-check"></i><b>4.1</b> The sample standard deviation vs. the standard error of the mean</a><ul>
<li class="chapter" data-level="4.1.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#sample-standard-deviation"><i class="fa fa-check"></i><b>4.1.1</b> Sample standard deviation</a></li>
<li class="chapter" data-level="4.1.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>4.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>4.2</b> Using Google Sheets to generate fake data to explore the standard error</a><ul>
<li class="chapter" data-level="4.2.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#steps"><i class="fa fa-check"></i><b>4.2.1</b> Steps</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#using-r-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>4.3</b> Using R to generate fake data to explore the standard error</a><ul>
<li class="chapter" data-level="4.3.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-i"><i class="fa fa-check"></i><b>4.3.1</b> part I</a></li>
<li class="chapter" data-level="4.3.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-ii---means"><i class="fa fa-check"></i><b>4.3.2</b> part II - means</a></li>
<li class="chapter" data-level="4.3.3" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-iii---how-do-sd-and-se-change-as-sample-size-n-increases"><i class="fa fa-check"></i><b>4.3.3</b> part III - how do SD and SE change as sample size (n) increases?</a></li>
<li class="chapter" data-level="4.3.4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-iv-generating-fake-data-with-for-loops"><i class="fa fa-check"></i><b>4.3.4</b> Part IV – Generating fake data with for-loops</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#bootstrapped-standard-errors"><i class="fa fa-check"></i><b>4.4</b> Bootstrapped standard errors</a></li>
<li class="chapter" data-level="4.5" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#confidence-interval"><i class="fa fa-check"></i><b>4.5</b> Confidence Interval</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html"><i class="fa fa-check"></i><b>5</b> Covariance and Correlation</a></li>
<li class="chapter" data-level="6" data-path="p-values.html"><a href="p-values.html"><i class="fa fa-check"></i><b>6</b> P-values</a><ul>
<li class="chapter" data-level="6.1" data-path="p-values.html"><a href="p-values.html#p-values-1"><i class="fa fa-check"></i><b>6.1</b> <span class="math inline">\(p\)</span>-values</a></li>
<li class="chapter" data-level="6.2" data-path="p-values.html"><a href="p-values.html#creating-a-null-distribution."><i class="fa fa-check"></i><b>6.2</b> Creating a null distribution.</a><ul>
<li class="chapter" data-level="6.2.1" data-path="p-values.html"><a href="p-values.html#the-null-distribution"><i class="fa fa-check"></i><b>6.2.1</b> the Null Distribution</a></li>
<li class="chapter" data-level="6.2.2" data-path="p-values.html"><a href="p-values.html#t-tests"><i class="fa fa-check"></i><b>6.2.2</b> t-tests</a></li>
<li class="chapter" data-level="6.2.3" data-path="p-values.html"><a href="p-values.html#p-values-from-the-perspective-of-permutation"><i class="fa fa-check"></i><b>6.2.3</b> P-values from the perspective of permutation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="p-values.html"><a href="p-values.html#statistical-modeling-instead-of-hypothesis-testing"><i class="fa fa-check"></i><b>6.3</b> Statistical modeling instead of hypothesis testing</a></li>
<li class="chapter" data-level="6.4" data-path="p-values.html"><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values"><i class="fa fa-check"></i><b>6.4</b> frequentist probability and the interpretation of p-values</a><ul>
<li class="chapter" data-level="6.4.1" data-path="p-values.html"><a href="p-values.html#background"><i class="fa fa-check"></i><b>6.4.1</b> Background</a></li>
<li class="chapter" data-level="6.4.2" data-path="p-values.html"><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><i class="fa fa-check"></i><b>6.4.2</b> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li class="chapter" data-level="6.4.3" data-path="p-values.html"><a href="p-values.html#two-interpretations-of-the-p-value"><i class="fa fa-check"></i><b>6.4.3</b> Two interpretations of the <em>p</em>-value</a></li>
<li class="chapter" data-level="6.4.4" data-path="p-values.html"><a href="p-values.html#nhst"><i class="fa fa-check"></i><b>6.4.4</b> NHST</a></li>
<li class="chapter" data-level="6.4.5" data-path="p-values.html"><a href="p-values.html#some-major-misconceptions-of-the-p-value"><i class="fa fa-check"></i><b>6.4.5</b> Some major misconceptions of the <span class="math inline">\(p\)</span>-value</a></li>
<li class="chapter" data-level="6.4.6" data-path="p-values.html"><a href="p-values.html#recommendations"><i class="fa fa-check"></i><b>6.4.6</b> Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="p-values.html"><a href="p-values.html#problems-1"><i class="fa fa-check"></i><b>6.5</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="creating-fake-data.html"><a href="creating-fake-data.html"><i class="fa fa-check"></i><b>7</b> Creating Fake Data</a><ul>
<li class="chapter" data-level="7.0.1" data-path="creating-fake-data.html"><a href="creating-fake-data.html#continuous-x-fake-observational-data"><i class="fa fa-check"></i><b>7.0.1</b> Continuous X (fake observational data)</a></li>
<li class="chapter" data-level="7.0.2" data-path="creating-fake-data.html"><a href="creating-fake-data.html#categorical-x-fake-experimental-data"><i class="fa fa-check"></i><b>7.0.2</b> Categorical X (fake experimental data)</a></li>
<li class="chapter" data-level="7.0.3" data-path="creating-fake-data.html"><a href="creating-fake-data.html#correlated-x-fake-observational-data"><i class="fa fa-check"></i><b>7.0.3</b> Correlated X (fake observational data)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-introduction-to-linear-models.html"><a href="part-iii-introduction-to-linear-models.html"><i class="fa fa-check"></i>Part III: Introduction to Linear Models</a></li>
<li class="chapter" data-level="8" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html"><i class="fa fa-check"></i><b>8</b> A linear model with a single, continuous <em>X</em></a><ul>
<li class="chapter" data-level="8.1" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><i class="fa fa-check"></i><b>8.1</b> A linear model with a single, continuous <em>X</em> is classical “regression”</a><ul>
<li class="chapter" data-level="8.1.1" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#using-a-linear-model-to-estimate-explanatory-effects"><i class="fa fa-check"></i><b>8.1.1</b> Using a linear model to estimate explanatory effects</a></li>
<li class="chapter" data-level="8.1.2" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#using-a-linear-model-for-prediction"><i class="fa fa-check"></i><b>8.1.2</b> Using a linear model for prediction</a></li>
<li class="chapter" data-level="8.1.3" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#reporting-results"><i class="fa fa-check"></i><b>8.1.3</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#working-in-r"><i class="fa fa-check"></i><b>8.2</b> Working in R</a><ul>
<li class="chapter" data-level="8.2.1" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#exploring-the-bivariate-relationship-between-y-and-x"><i class="fa fa-check"></i><b>8.2.1</b> Exploring the bivariate relationship between <em>Y</em> and <em>X</em></a></li>
<li class="chapter" data-level="8.2.2" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#fitting-the-linear-model"><i class="fa fa-check"></i><b>8.2.2</b> Fitting the linear model</a></li>
<li class="chapter" data-level="8.2.3" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#getting-to-know-the-linear-model-the-summary-function"><i class="fa fa-check"></i><b>8.2.3</b> Getting to know the linear model: the <code>summary</code> function</a></li>
<li class="chapter" data-level="8.2.4" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#display-an-alternative-to-summary"><i class="fa fa-check"></i><b>8.2.4</b> display: An alternative to summary</a></li>
<li class="chapter" data-level="8.2.5" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#confidence-intervals"><i class="fa fa-check"></i><b>8.2.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="8.2.6" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#how-good-is-our-model"><i class="fa fa-check"></i><b>8.2.6</b> How good is our model?</a></li>
<li class="chapter" data-level="8.2.7" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#exploring-a-lm-object"><i class="fa fa-check"></i><b>8.2.7</b> exploring a lm object</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#problems-2"><i class="fa fa-check"></i><b>8.3</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html"><i class="fa fa-check"></i><b>9</b> A linear model with a single, categorical <em>X</em></a><ul>
<li class="chapter" data-level="9.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#a-linear-model-with-a-single-categorical-x-estimates-the-effects-of-x-on-the-response."><i class="fa fa-check"></i><b>9.1</b> A linear model with a single, categorical <em>X</em> estimates the effects of <em>X</em> on the response.</a><ul>
<li class="chapter" data-level="9.1.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#table-of-model-coefficients"><i class="fa fa-check"></i><b>9.1.1</b> Table of model coefficients</a></li>
<li class="chapter" data-level="9.1.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#the-linear-model"><i class="fa fa-check"></i><b>9.1.2</b> The linear model</a></li>
<li class="chapter" data-level="9.1.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#reporting-results-1"><i class="fa fa-check"></i><b>9.1.3</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#comparing-the-results-of-a-linear-model-to-classical-hypothesis-tests"><i class="fa fa-check"></i><b>9.2</b> Comparing the results of a linear model to classical hypothesis tests</a><ul>
<li class="chapter" data-level="9.2.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#t-tests-are-special-cases-of-a-linear-model"><i class="fa fa-check"></i><b>9.2.1</b> t-tests are special cases of a linear model</a></li>
<li class="chapter" data-level="9.2.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#anova-is-a-special-case-of-a-linear-model"><i class="fa fa-check"></i><b>9.2.2</b> ANOVA is a special case of a linear model</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#working-in-r-1"><i class="fa fa-check"></i><b>9.3</b> Working in R</a><ul>
<li class="chapter" data-level="9.3.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#fitting-the-model"><i class="fa fa-check"></i><b>9.3.1</b> Fitting the model</a></li>
<li class="chapter" data-level="9.3.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#changing-the-reference-level"><i class="fa fa-check"></i><b>9.3.2</b> Changing the reference level</a></li>
<li class="chapter" data-level="9.3.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#an-introduction-to-contrasts"><i class="fa fa-check"></i><b>9.3.3</b> An introduction to contrasts</a></li>
<li class="chapter" data-level="9.3.4" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#harrell-plot"><i class="fa fa-check"></i><b>9.3.4</b> Harrell plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-checking-1.html"><a href="model-checking-1.html"><i class="fa fa-check"></i><b>10</b> Model Checking</a><ul>
<li class="chapter" data-level="10.1" data-path="model-checking-1.html"><a href="model-checking-1.html#do-coefficients-make-numeric-sense"><i class="fa fa-check"></i><b>10.1</b> Do coefficients make numeric sense?</a></li>
<li class="chapter" data-level="10.2" data-path="model-checking-1.html"><a href="model-checking-1.html#all-statistical-analyses-should-be-followed-by-model-checking"><i class="fa fa-check"></i><b>10.2</b> All statistical analyses should be followed by model checking</a></li>
<li class="chapter" data-level="10.3" data-path="model-checking-1.html"><a href="model-checking-1.html#linear-model-assumptions"><i class="fa fa-check"></i><b>10.3</b> Linear model assumptions</a></li>
<li class="chapter" data-level="10.4" data-path="model-checking-1.html"><a href="model-checking-1.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>10.4</b> Diagnostic plots use the residuals from the model fit</a><ul>
<li class="chapter" data-level="10.4.1" data-path="model-checking-1.html"><a href="model-checking-1.html#residuals"><i class="fa fa-check"></i><b>10.4.1</b> Residuals</a></li>
<li class="chapter" data-level="10.4.2" data-path="model-checking-1.html"><a href="model-checking-1.html#a-normal-q-q-plot-is-used-to-check-normality"><i class="fa fa-check"></i><b>10.4.2</b> A Normal Q-Q plot is used to check normality</a></li>
<li class="chapter" data-level="10.4.3" data-path="model-checking-1.html"><a href="model-checking-1.html#outliers---an-outlier-is-a-point-that-is-highly-unexpected-given-the-modeled-distribution."><i class="fa fa-check"></i><b>10.4.3</b> Outliers - an outlier is a point that is highly unexpected given the modeled distribution.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="model-checking-1.html"><a href="model-checking-1.html#model-checking-homoskedasticity"><i class="fa fa-check"></i><b>10.5</b> Model checking homoskedasticity</a></li>
<li class="chapter" data-level="10.6" data-path="model-checking-1.html"><a href="model-checking-1.html#model-checking-independence---hapiness-adverse-example."><i class="fa fa-check"></i><b>10.6</b> Model checking independence - hapiness adverse example.</a></li>
<li class="chapter" data-level="10.7" data-path="model-checking-1.html"><a href="model-checking-1.html#using-r"><i class="fa fa-check"></i><b>10.7</b> Using R</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html"><i class="fa fa-check"></i><b>11</b> Model Fitting and Model Fit (OLS)</a><ul>
<li class="chapter" data-level="11.1" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#least-squares-estimation-and-the-decomposition-of-variance"><i class="fa fa-check"></i><b>11.1</b> Least Squares Estimation and the Decomposition of Variance</a></li>
<li class="chapter" data-level="11.2" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#ols-regression"><i class="fa fa-check"></i><b>11.2</b> OLS regression</a></li>
<li class="chapter" data-level="11.3" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#how-well-does-the-model-fit-the-data-r2-and-variance-explained"><i class="fa fa-check"></i><b>11.3</b> How well does the model fit the data? <span class="math inline">\(R^2\)</span> and “variance explained”</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html"><i class="fa fa-check"></i><b>12</b> Best Practices – Issues in Inference</a><ul>
<li class="chapter" data-level="12.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#power"><i class="fa fa-check"></i><b>12.1</b> Power</a><ul>
<li class="chapter" data-level="12.1.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#types-of-error"><i class="fa fa-check"></i><b>12.1.1</b> “Types” of Error</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#multiple-testing"><i class="fa fa-check"></i><b>12.2</b> multiple testing</a><ul>
<li class="chapter" data-level="12.2.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#some-background"><i class="fa fa-check"></i><b>12.2.1</b> Some background</a></li>
<li class="chapter" data-level="12.2.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#multiple-testing-working-in-r"><i class="fa fa-check"></i><b>12.2.2</b> Multiple testing – working in R</a></li>
<li class="chapter" data-level="12.2.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#false-discovery-rate"><i class="fa fa-check"></i><b>12.2.3</b> False Discovery Rate</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#difference-in-p-is-not-different"><i class="fa fa-check"></i><b>12.3</b> difference in p is not different</a></li>
<li class="chapter" data-level="12.4" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#inference-when-data-are-not-normal"><i class="fa fa-check"></i><b>12.4</b> Inference when data are not Normal</a><ul>
<li class="chapter" data-level="12.4.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#working-in-r-2"><i class="fa fa-check"></i><b>12.4.1</b> Working in R</a></li>
<li class="chapter" data-level="12.4.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>12.4.2</b> Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="12.4.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#permutation-test"><i class="fa fa-check"></i><b>12.4.3</b> Permutation test</a></li>
<li class="chapter" data-level="12.4.4" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#non-parametric-tests"><i class="fa fa-check"></i><b>12.4.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="12.4.5" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#log-transformations"><i class="fa fa-check"></i><b>12.4.5</b> Log transformations</a></li>
<li class="chapter" data-level="12.4.6" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#performance-of-parametric-tests-and-alternatives"><i class="fa fa-check"></i><b>12.4.6</b> Performance of parametric tests and alternatives</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#max-vs.mean"><i class="fa fa-check"></i><b>12.5</b> max vs. mean</a></li>
<li class="chapter" data-level="12.6" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#pre-post-normalization"><i class="fa fa-check"></i><b>12.6</b> pre-post, normalization</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="plotting-models.html"><a href="plotting-models.html"><i class="fa fa-check"></i><b>13</b> Plotting Models</a><ul>
<li class="chapter" data-level="13.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data"><i class="fa fa-check"></i><b>13.1</b> Pretty good plots show the model and the data</a><ul>
<li class="chapter" data-level="13.1.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot"><i class="fa fa-check"></i><b>13.1.1</b> Pretty good plot component 1: Modeled effects plot</a></li>
<li class="chapter" data-level="13.1.2" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot-with-jittered-raw-data"><i class="fa fa-check"></i><b>13.1.2</b> Pretty good plot component 2: Modeled mean and CI plot with jittered raw data</a></li>
<li class="chapter" data-level="13.1.3" data-path="plotting-models.html"><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><i class="fa fa-check"></i><b>13.1.3</b> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="plotting-models.html"><a href="plotting-models.html#some-comments-on-plot-components"><i class="fa fa-check"></i><b>13.2</b> Some comments on plot components</a></li>
<li class="chapter" data-level="13.3" data-path="plotting-models.html"><a href="plotting-models.html#working-in-r-3"><i class="fa fa-check"></i><b>13.3</b> Working in R</a><ul>
<li class="chapter" data-level="13.3.1" data-path="plotting-models.html"><a href="plotting-models.html#unpooled-se-bars-and-confidence-intervals"><i class="fa fa-check"></i><b>13.3.1</b> Unpooled SE bars and confidence intervals</a></li>
<li class="chapter" data-level="13.3.2" data-path="plotting-models.html"><a href="plotting-models.html#adding-bootstrap-intervals"><i class="fa fa-check"></i><b>13.3.2</b> Adding bootstrap intervals</a></li>
<li class="chapter" data-level="13.3.3" data-path="plotting-models.html"><a href="plotting-models.html#adding-modeled-error-intervals"><i class="fa fa-check"></i><b>13.3.3</b> Adding modeled error intervals</a></li>
<li class="chapter" data-level="13.3.4" data-path="plotting-models.html"><a href="plotting-models.html#adding-p-values"><i class="fa fa-check"></i><b>13.3.4</b> Adding p-values</a></li>
<li class="chapter" data-level="13.3.5" data-path="plotting-models.html"><a href="plotting-models.html#adding-custom-p-values"><i class="fa fa-check"></i><b>13.3.5</b> Adding custom p-values</a></li>
<li class="chapter" data-level="13.3.6" data-path="plotting-models.html"><a href="plotting-models.html#plotting-two-factors"><i class="fa fa-check"></i><b>13.3.6</b> Plotting two factors</a></li>
<li class="chapter" data-level="13.3.7" data-path="plotting-models.html"><a href="plotting-models.html#interaction-plot"><i class="fa fa-check"></i><b>13.3.7</b> Interaction plot</a></li>
</ul></li>
</ul></li>
<li><a href="part-iv-more-than-one-x-multivariable-models.html#part-iv-more-than-one-x-multivariable-models">Part IV: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li class="chapter" data-level="14" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html"><i class="fa fa-check"></i><b>14</b> Adding covariates to a linear model</a><ul>
<li class="chapter" data-level="14.1" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><i class="fa fa-check"></i><b>14.1</b> Adding covariates can increases the precision of the effect of interest</a></li>
<li class="chapter" data-level="14.2" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-covariates-can-decrease-prediction-error-in-predictive-models"><i class="fa fa-check"></i><b>14.2</b> Adding covariates can decrease prediction error in predictive models</a></li>
<li class="chapter" data-level="14.3" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-covariates-can-reduce-bias-due-to-confounding-in-explanatory-models"><i class="fa fa-check"></i><b>14.3</b> Adding covariates can reduce bias due to confounding in explanatory models</a></li>
<li class="chapter" data-level="14.4" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#best-practices-1-a-pre-treatment-measure-of-the-response-should-be-a-covariate-and-not-subtracted-from-the-post-treatment-measure-regression-to-the-mean"><i class="fa fa-check"></i><b>14.4</b> Best practices 1: A pre-treatment measure of the response should be a covariate and not subtracted from the post-treatment measure (regression to the mean)</a><ul>
<li class="chapter" data-level="14.4.1" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#regression-to-the-mean-in-words"><i class="fa fa-check"></i><b>14.4.1</b> Regression to the mean in words</a></li>
<li class="chapter" data-level="14.4.2" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#regression-to-the-mean-in-pictures"><i class="fa fa-check"></i><b>14.4.2</b> Regression to the mean in pictures</a></li>
<li class="chapter" data-level="14.4.3" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#do-not-use-percent-change-believing-that-percents-account-for-effects-of-initial-weights"><i class="fa fa-check"></i><b>14.4.3</b> Do not use percent change, believing that percents account for effects of initial weights</a></li>
<li class="chapter" data-level="14.4.4" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#do-not-test-for-balance-of-baseline-measures"><i class="fa fa-check"></i><b>14.4.4</b> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><i class="fa fa-check"></i><b>14.5</b> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html"><i class="fa fa-check"></i><b>15</b> Two (or more) Categorical <span class="math inline">\(X\)</span> – Factorial designs</a><ul>
<li class="chapter" data-level="15.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#factorial-experiments"><i class="fa fa-check"></i><b>15.1</b> Factorial experiments</a><ul>
<li class="chapter" data-level="15.1.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#model-coefficients-an-interaction-effect-is-what-is-leftover-after-adding-the-treatment-effects-to-the-control"><i class="fa fa-check"></i><b>15.1.1</b> Model coefficients: an interaction effect is what is leftover after adding the treatment effects to the control</a></li>
<li class="chapter" data-level="15.1.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#what-is-the-biological-meaning-of-an-interaction-effect"><i class="fa fa-check"></i><b>15.1.2</b> What is the biological meaning of an interaction effect?</a></li>
<li class="chapter" data-level="15.1.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#the-interpretation-of-the-coefficients-in-a-factorial-model-is-entirely-dependent-on-the-reference"><i class="fa fa-check"></i><b>15.1.3</b> The interpretation of the coefficients in a factorial model is entirely dependent on the reference…</a></li>
<li class="chapter" data-level="15.1.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#estimated-marginal-means"><i class="fa fa-check"></i><b>15.1.4</b> Estimated marginal means</a></li>
<li class="chapter" data-level="15.1.5" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#in-a-factorial-model-there-are-multiple-effects-of-each-factor-simple-effects"><i class="fa fa-check"></i><b>15.1.5</b> In a factorial model, there are multiple effects of each factor (simple effects)</a></li>
<li class="chapter" data-level="15.1.6" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#marginal-effects"><i class="fa fa-check"></i><b>15.1.6</b> Marginal effects</a></li>
<li class="chapter" data-level="15.1.7" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#the-additive-model"><i class="fa fa-check"></i><b>15.1.7</b> The additive model</a></li>
<li class="chapter" data-level="15.1.8" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#reduce-models-for-the-right-reason"><i class="fa fa-check"></i><b>15.1.8</b> Reduce models for the right reason</a></li>
<li class="chapter" data-level="15.1.9" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#what-about-models-with-more-than-two-factors"><i class="fa fa-check"></i><b>15.1.9</b> What about models with more than two factors?</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#reporting-results-2"><i class="fa fa-check"></i><b>15.2</b> Reporting results</a><ul>
<li class="chapter" data-level="15.2.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#text-results"><i class="fa fa-check"></i><b>15.2.1</b> Text results</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#working-in-r-4"><i class="fa fa-check"></i><b>15.3</b> Working in R</a><ul>
<li class="chapter" data-level="15.3.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#model-formula"><i class="fa fa-check"></i><b>15.3.1</b> Model formula</a></li>
<li class="chapter" data-level="15.3.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#modeled-means"><i class="fa fa-check"></i><b>15.3.2</b> Modeled means</a></li>
<li class="chapter" data-level="15.3.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#marginal-means"><i class="fa fa-check"></i><b>15.3.3</b> Marginal means</a></li>
<li class="chapter" data-level="15.3.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#contrasts"><i class="fa fa-check"></i><b>15.3.4</b> Contrasts</a></li>
<li class="chapter" data-level="15.3.5" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#simple-effects"><i class="fa fa-check"></i><b>15.3.5</b> Simple effects</a></li>
<li class="chapter" data-level="15.3.6" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#marginal-effects-1"><i class="fa fa-check"></i><b>15.3.6</b> Marginal effects</a></li>
<li class="chapter" data-level="15.3.7" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#plotting-results"><i class="fa fa-check"></i><b>15.3.7</b> Plotting results</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#problems-3"><i class="fa fa-check"></i><b>15.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="anova-tables.html"><a href="anova-tables.html"><i class="fa fa-check"></i><b>16</b> ANOVA Tables</a><ul>
<li class="chapter" data-level="16.1" data-path="anova-tables.html"><a href="anova-tables.html#summary-of-usage"><i class="fa fa-check"></i><b>16.1</b> Summary of usage</a></li>
<li class="chapter" data-level="16.2" data-path="anova-tables.html"><a href="anova-tables.html#example-a-one-way-anova-using-the-vole-data"><i class="fa fa-check"></i><b>16.2</b> Example: a one-way ANOVA using the vole data</a></li>
<li class="chapter" data-level="16.3" data-path="anova-tables.html"><a href="anova-tables.html#example-a-two-way-anova-using-the-urchin-data"><i class="fa fa-check"></i><b>16.3</b> Example: a two-way ANOVA using the urchin data</a><ul>
<li class="chapter" data-level="16.3.1" data-path="anova-tables.html"><a href="anova-tables.html#how-to-read-an-anova-table"><i class="fa fa-check"></i><b>16.3.1</b> How to read an ANOVA table</a></li>
<li class="chapter" data-level="16.3.2" data-path="anova-tables.html"><a href="anova-tables.html#how-to-read-anova-results-reported-in-the-text"><i class="fa fa-check"></i><b>16.3.2</b> How to read ANOVA results reported in the text</a></li>
<li class="chapter" data-level="16.3.3" data-path="anova-tables.html"><a href="anova-tables.html#better-practice-estimates-and-their-uncertainty"><i class="fa fa-check"></i><b>16.3.3</b> Better practice – estimates and their uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="anova-tables.html"><a href="anova-tables.html#unbalanced-designs"><i class="fa fa-check"></i><b>16.4</b> Unbalanced designs</a><ul>
<li class="chapter" data-level="16.4.1" data-path="anova-tables.html"><a href="anova-tables.html#what-is-going-on-in-unbalanced-anova-type-i-ii-iii-sum-of-squares"><i class="fa fa-check"></i><b>16.4.1</b> What is going on in unbalanced ANOVA? – Type I, II, III sum of squares</a></li>
<li class="chapter" data-level="16.4.2" data-path="anova-tables.html"><a href="anova-tables.html#back-to-interpretation-of-main-effects"><i class="fa fa-check"></i><b>16.4.2</b> Back to interpretation of main effects</a></li>
<li class="chapter" data-level="16.4.3" data-path="anova-tables.html"><a href="anova-tables.html#the-anova-tables-for-type-i-ii-and-iii-sum-of-squares-are-the-same-if-the-design-is-balanced."><i class="fa fa-check"></i><b>16.4.3</b> The anova tables for Type I, II, and III sum of squares are the same if the design is balanced.</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="anova-tables.html"><a href="anova-tables.html#working-in-r-5"><i class="fa fa-check"></i><b>16.5</b> Working in R</a><ul>
<li class="chapter" data-level="16.5.1" data-path="anova-tables.html"><a href="anova-tables.html#type-i-sum-of-squares-in-r"><i class="fa fa-check"></i><b>16.5.1</b> Type I sum of squares in R</a></li>
<li class="chapter" data-level="16.5.2" data-path="anova-tables.html"><a href="anova-tables.html#type-ii-and-iii-sum-of-squares"><i class="fa fa-check"></i><b>16.5.2</b> Type II and III Sum of Squares</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="predictive-models.html"><a href="predictive-models.html"><i class="fa fa-check"></i><b>17</b> Predictive Models</a><ul>
<li class="chapter" data-level="17.1" data-path="predictive-models.html"><a href="predictive-models.html#overfitting"><i class="fa fa-check"></i><b>17.1</b> Overfitting</a></li>
<li class="chapter" data-level="17.2" data-path="predictive-models.html"><a href="predictive-models.html#model-building-vs.variable-selection-vs.model-selection"><i class="fa fa-check"></i><b>17.2</b> Model building vs. Variable selection vs. Model selection</a><ul>
<li class="chapter" data-level="17.2.1" data-path="predictive-models.html"><a href="predictive-models.html#stepwise-regression"><i class="fa fa-check"></i><b>17.2.1</b> Stepwise regression</a></li>
<li class="chapter" data-level="17.2.2" data-path="predictive-models.html"><a href="predictive-models.html#cross-validation"><i class="fa fa-check"></i><b>17.2.2</b> Cross-validation</a></li>
<li class="chapter" data-level="17.2.3" data-path="predictive-models.html"><a href="predictive-models.html#penalization"><i class="fa fa-check"></i><b>17.2.3</b> Penalization</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="predictive-models.html"><a href="predictive-models.html#shrinkage"><i class="fa fa-check"></i><b>17.3</b> Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"><a href="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"><i class="fa fa-check"></i>Part V: Expanding the Linear Model – Generalized Linear Models and Multilevel (Linear Mixed) Models</a></li>
<li class="chapter" data-level="18" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html"><i class="fa fa-check"></i><b>18</b> Generalized linear models I: Count data</a><ul>
<li class="chapter" data-level="18.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#the-generalized-linear-model"><i class="fa fa-check"></i><b>18.1</b> The generalized linear model</a></li>
<li class="chapter" data-level="18.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish"><i class="fa fa-check"></i><b>18.2</b> Count data example – number of trematode worm larvae in eyes of threespine stickleback fish</a><ul>
<li class="chapter" data-level="18.2.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#modeling-strategy-1"><i class="fa fa-check"></i><b>18.2.1</b> Modeling strategy</a></li>
<li class="chapter" data-level="18.2.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#checking-the-model-i-a-normal-q-q-plot"><i class="fa fa-check"></i><b>18.2.2</b> Checking the model I – a Normal Q-Q plot</a></li>
<li class="chapter" data-level="18.2.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#checking-the-model-ii-scale-location-plot-for-checking-homoskedasticity"><i class="fa fa-check"></i><b>18.2.3</b> Checking the model II – scale-location plot for checking homoskedasticity</a></li>
<li class="chapter" data-level="18.2.4" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#two-distributions-for-count-data-poisson-and-negative-binomial"><i class="fa fa-check"></i><b>18.2.4</b> Two distributions for count data – Poisson and Negative Binomial</a></li>
<li class="chapter" data-level="18.2.5" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-with-a-poisson-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>18.2.5</b> Fitting a GLM with a Poisson distribution to the worm data</a></li>
<li class="chapter" data-level="18.2.6" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#model-checking-fits-to-count-data"><i class="fa fa-check"></i><b>18.2.6</b> Model checking fits to count data</a></li>
<li class="chapter" data-level="18.2.7" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-with-a-negative-binomial-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>18.2.7</b> Fitting a GLM with a Negative Binomial distribution to the worm data</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#working-in-r-6"><i class="fa fa-check"></i><b>18.3</b> Working in R</a></li>
<li class="chapter" data-level="18.4" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#problems-4"><i class="fa fa-check"></i><b>18.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html"><i class="fa fa-check"></i><b>19</b> Linear mixed models</a><ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#random-effects"><i class="fa fa-check"></i><b>19.1</b> Random effects</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#random-effects-in-statistical-models"><i class="fa fa-check"></i><b>19.2</b> Random effects in statistical models</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#linear-mixed-models-are-flexible"><i class="fa fa-check"></i><b>19.3</b> Linear mixed models are flexible</a></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#visualizing-block-effects"><i class="fa fa-check"></i><b>19.4</b> Visualizing block effects</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#linear-mixed-models-can-increase-precision-of-point-estimates"><i class="fa fa-check"></i><b>19.5</b> Linear mixed models can increase precision of point estimates</a></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#linear-mixed-models-are-used-to-avoid-pseudoreplication"><i class="fa fa-check"></i><b>19.6</b> Linear mixed models are used to avoid pseudoreplication</a></li>
<li class="chapter" data-level="19.7" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#linear-mixed-models-shrink-coefficients-by-partial-pooling"><i class="fa fa-check"></i><b>19.7</b> Linear mixed models shrink coefficients by partial pooling</a></li>
<li class="chapter" data-level="19.8" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#working-in-r-7"><i class="fa fa-check"></i><b>19.8</b> Working in R</a><ul>
<li class="chapter" data-level="19.8.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#coral-data"><i class="fa fa-check"></i><b>19.8.1</b> coral data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="linear-models-with-heterogenous-variance.html"><a href="linear-models-with-heterogenous-variance.html"><i class="fa fa-check"></i><b>20</b> Linear models with heterogenous variance</a><ul>
<li class="chapter" data-level="20.1" data-path="linear-models-with-heterogenous-variance.html"><a href="linear-models-with-heterogenous-variance.html#gls"><i class="fa fa-check"></i><b>20.1</b> gls</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html"><i class="fa fa-check"></i>Appendix 1: Getting Started with R</a><ul>
<li class="chapter" data-level="20.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready"><i class="fa fa-check"></i><b>20.2</b> Get your computer ready</a><ul>
<li class="chapter" data-level="20.2.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r"><i class="fa fa-check"></i><b>20.2.1</b> Install R</a></li>
<li class="chapter" data-level="20.2.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-studio"><i class="fa fa-check"></i><b>20.2.2</b> Install R Studio</a></li>
<li class="chapter" data-level="20.2.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#resources-for-installing-r-and-r-studio"><i class="fa fa-check"></i><b>20.2.3</b> Resources for installing R and R Studio</a></li>
<li class="chapter" data-level="20.2.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-latex"><i class="fa fa-check"></i><b>20.2.4</b> Install LaTeX</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-learning"><i class="fa fa-check"></i><b>20.3</b> Start learning</a><ul>
<li class="chapter" data-level="20.3.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-with-data-camp-introduction-to-r"><i class="fa fa-check"></i><b>20.3.1</b> Start with Data Camp Introduction to R</a></li>
<li class="chapter" data-level="20.3.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#then-move-to-introduction-to-r-studio"><i class="fa fa-check"></i><b>20.3.2</b> Then Move to Introduction to R Studio</a></li>
<li class="chapter" data-level="20.3.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#develop-your-project-with-an-r-studio-notebook"><i class="fa fa-check"></i><b>20.3.3</b> Develop your project with an R Studio Notebook</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#getting-data-into-r"><i class="fa fa-check"></i><b>20.4</b> Getting Data into R</a></li>
<li class="chapter" data-level="20.5" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#additional-r-learning-resources"><i class="fa fa-check"></i><b>20.5</b> Additional R learning resources</a></li>
<li class="chapter" data-level="20.6" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#packages-used-extensively-in-this-text"><i class="fa fa-check"></i><b>20.6</b> Packages used extensively in this text</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><i class="fa fa-check"></i>Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Elementary Statistical Modeling for Applied Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-linear-model-with-a-single-categorical-x" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> A linear model with a single, categorical <em>X</em></h1>
<div id="a-linear-model-with-a-single-categorical-x-estimates-the-effects-of-x-on-the-response." class="section level2">
<h2><span class="header-section-number">9.1</span> A linear model with a single, categorical <em>X</em> estimates the effects of <em>X</em> on the response.</h2>
<p>To introduce modeling with a single, categorical <span class="math inline">\(X\)</span> variable, I’ll use the [Vole data] from Chapter 2. Normal cellular metabolism creates reactive oxygen species (ROS) that can disrupt cell function and potentially cause cell damage. Anti-oxidants are molecules that bind ROS, inhibiting their ability to disrupt cell activity. A working hypothesis for many years is that supplemental anti-oxidants should improve cell function and, scaling up, whole-animal function (such as lifespan). The vole data explores this with supplemental Vitamins C and E, which are anti-oxidants, in the diet of the short-tailed field vole (<em>Microtus agrestis</em>).</p>
<p>The goal of the study is to measure the effect of anti-oxidants on lifespan. The researchers randomly assigned the voles to one of thre treatment levels: “control”, “vitamin E”, and “vitamin C”. The variable <span class="math inline">\(treatment\)</span>, is a single, categorical <span class="math inline">\(X\)</span> variable. Categorical variables are often called <strong>factors</strong> and the treatment levels are often called <strong>factor levels</strong>. “Levels” is a strange usage of this word; a less formal name for levels is “groups”. There are no units to a categorical <span class="math inline">\(X\)</span> variable (even though a certain amount of each anti-oxidant was supplemented). The response (<span class="math inline">\(Y\)</span>) is <span class="math inline">\(lifespan\)</span> measured in days.</p>
<p>The linear model with a categorical <span class="math inline">\(X\)</span> variable with three levels is not immediately obvious, and so I don’t present the model until after showing the table of model coefficients. The verbal model is</p>
<span class="math display">\[\begin{equation}
lifespan \sim treatment
\end{equation}\]</span>
<p>which can be read as “lifespan as a function of treatment”.</p>
<div id="table-of-model-coefficients" class="section level3">
<h3><span class="header-section-number">9.1.1</span> Table of model coefficients</h3>
<p>The <em>table of coefficients</em> from a linear model fit to some data is critically important for understanding a linear model and interpreting results. Read this section carefully. The coefficient table for a linear model fit to the vole data is</p>
<table>
<caption><span id="tab:vole-table">Table 9.1: </span>Coefficient table of fit linear model of vole data.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="right">503.4</td>
<td align="right">27.4</td>
<td align="right">18.4</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td>treatmentvitamin_C</td>
<td align="right">-115.1</td>
<td align="right">54.5</td>
<td align="right">-2.1</td>
<td align="right">0.037</td>
</tr>
<tr class="odd">
<td>treatmentvitamin_E</td>
<td align="right">-89.9</td>
<td align="right">52.5</td>
<td align="right">-1.7</td>
<td align="right">0.090</td>
</tr>
</tbody>
</table>
<p>The table has three values in the column “Estimate”. The first estimate, that for “(intercept)” is the mean response in the reference level. Here, the reference level is the “control” group. The second estimate, that for “treatmentvitamin_C” is the difference between the mean of the vitamin C group and the the mean of the reference (control) group. The <em>direction</em> of this difference is important; it is <span class="math inline">\(\bar{Y}_{vitamin\_c} - \bar{Y}_{control}\)</span>, that is the non-reference level minus the reference level. The third estimate, that for “treatmentvitamin_E” is just like the second estimate, except for the vitamin E group. That is, it is <span class="math inline">\(\bar{Y}_{vitamin\_e} - \bar{Y}_{control}\)</span>. The 2nd and 3rd values in the “Estimate” columns are the “effects” in the model. These effects are “what happens” when we add a treatment, such as vitamin E supplementation. When we add the vitamin E supplement, we find the lifespan changes by -89.9 days, relative to the control.</p>
<p>So typically with categorical <span class="math inline">\(X\)</span>, when we speak of an <em>effect</em> we mean a difference in means, or a <strong>contrast</strong>.</p>
<div class="figure"><span id="fig:vole-mean-plot"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/vole-mean-plot-1.png" alt="What the coefficients of a linear model with a single categorical X mean. The means of the three treatment levels for the vole data are shown with the filled circles. The length of the double-headed arrows are differences in means. The intercept ($b_0$) is the mean of the reference treatment level. The coefficients ($b_1$ and $b_2$) are the differences between the treatment level's mean and the reference mean. As with a linear model with a continuous X, the coefficients are effects." width="576" />
<p class="caption">
Figure 9.1: What the coefficients of a linear model with a single categorical X mean. The means of the three treatment levels for the vole data are shown with the filled circles. The length of the double-headed arrows are differences in means. The intercept (<span class="math inline">\(b_0\)</span>) is the mean of the reference treatment level. The coefficients (<span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span>) are the differences between the treatment level’s mean and the reference mean. As with a linear model with a continuous X, the coefficients are effects.
</p>
</div>
</div>
<div id="the-linear-model" class="section level3">
<h3><span class="header-section-number">9.1.2</span> The linear model</h3>
<p>We can see an immediate difference between the coefficient table for a linear model fit to a single, categorical <span class="math inline">\(X\)</span> and that for a single, continuous <span class="math inline">\(X\)</span>. For the latter, there is a single coefficient for <span class="math inline">\(X\)</span>. For the former, there is a coefficient for each level of the categorical <span class="math inline">\(X\)</span> <em>except</em> the “reference” level.</p>
<p>The linear model for a single, categorical <span class="math inline">\(X\)</span> with three factor levels is</p>
<span class="math display">\[\begin{equation}
Y = \beta_0 + \beta_1 X_{group2} + \beta_2 X_{group3} + \varepsilon
\end{equation}\]</span>
<p>where <span class="math inline">\(group2\)</span> and <span class="math inline">\(group3\)</span> refer to the two non-reference groups.</p>
<p>For the vole data, “control” is the reference, so the model is</p>
<span class="math display">\[\begin{equation}
lifespan = \beta_0 + \beta_1 vitamin\_C + \beta_2 vitamin\_E + \varepsilon
\end{equation}\]</span>
<p><strong>The “estimates” in the coefficient table are the estimates of the parameters in this linear model. These estimates are the coefficients of the fit model,</strong></p>
<span class="math display" id="eq:model-cat-x">\[\begin{equation}
lifespan_i = b_0 + b_1 vitamin\_C_i + b_2 vitamin\_E_i + e_i
\tag{9.1}
\end{equation}\]</span>
<p>Given the interpretation of the estimates above, <span class="math inline">\(b_0\)</span> is the mean of the control group, <span class="math inline">\(b_1\)</span> is the difference in means between the vitamin C and control groups, and <span class="math inline">\(b_2\)</span> is the difference in means between the vitamin E and control groups. These estimates and their meaning are illustrated in Figure <a href="a-linear-model-with-a-single-categorical-x.html#fig:vole-mean-plot">9.1</a>. Take a while to memorize the bold-faced sentence above equation <a href="a-linear-model-with-a-single-categorical-x.html#eq:model-cat-x">(9.1)</a> and to understand this plot. Be able to “visualize” the meaning of the coefficients of a linear model in this way.</p>
<div id="a-linear-model-with-a-categorical-x-is-a-regression-model-with-the-treatment-levels-re-coded-as-numbers" class="section level4">
<h4><span class="header-section-number">9.1.2.1</span> A linear model with a categorical X is a regression model with the treatment levels re-coded as numbers</h4>
<p>Model <a href="a-linear-model-with-a-single-categorical-x.html#eq:model-cat-x">(9.1)</a> is a regression model. A regression model requires that the <span class="math inline">\(X\)</span> variables be numeric, so how can this model be a regression model? What are the numeric values of <span class="math inline">\(vitamin\_C\)</span> and <span class="math inline">\(vitamin\_E\)</span>? The answer is very clever: <span class="math inline">\(vitamin\_C\)</span> and <span class="math inline">\(vitamin\_C\)</span> are <strong>dummy variables</strong> that contain a one, if response <span class="math inline">\(i\)</span> is from that treatment level, and zero otherwise. This is called dummy coding or treatment coding. The <code>lm</code> function creates these dummy variables under the table, in something called the <strong>model matrix</strong>, which we’ll cover in another chapter. You won’t see these columns in your data. But if you did, it would look something like this</p>
<table>
<thead>
<tr class="header">
<th align="right">lifespan</th>
<th align="left">treatment</th>
<th align="right">vitamin_E</th>
<th align="right">vitamin_C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">621</td>
<td align="left">control</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">865</td>
<td align="left">control</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">583</td>
<td align="left">vitamin_E</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">561</td>
<td align="left">vitamin_E</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">315</td>
<td align="left">vitamin_C</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">157</td>
<td align="left">vitamin_C</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>There are alternative coding methods. Dummy coding is the default in R and it makes since when thinking about experimental data. Note that the method of coding can make a difference in an ANOVA table, and many published papers using R have published incorrect interpretations of ANOVA table outputs. This is both getting ahead of ourselves and somewhat moot, because I don’t advocate publishing ANOVA tables.</p>
</div>
<div id="some-math-to-convince-you-that-the-intercept-of-a-linear-model-with-a-categorical-x-is-the-mean-of-the-reference-group-and-the-intercept-of-a-line.-and-some-math-to-convince-you-that-the-coefficient-of-a-dummy-variable-in-a-linear-model-with-a-categorial-x-is-a-difference-in-means-and-a-slope." class="section level4">
<h4><span class="header-section-number">9.1.2.2</span> Some math to convince you that the intercept of a linear model with a categorical <span class="math inline">\(X\)</span> is the mean of the reference group <em>and</em> the intercept of a line. And some math to convince you that the coefficient of a dummy variable in a linear model with a categorial <span class="math inline">\(X\)</span> is a difference in means <em>and</em> a slope.</h4>
<p>The interecept of a model is the value of the model when all <span class="math inline">\(X\)</span>-variables are set to zero. The <span class="math inline">\(X\)</span> variables in the model (Equation <a href="a-linear-model-with-a-single-categorical-x.html#eq:model-cat-x">(9.1)</a>) are the dummy variables <span class="math inline">\(vitamin\_E\)</span> and <span class="math inline">\(vitamin\_C\)</span>. If we set vitamin_E$ and <span class="math inline">\(vitamin\_C\)</span> in Equation <a href="a-linear-model-with-a-single-categorical-x.html#eq:model-cat-x">(9.1)</a> to zero, the modeled (or expected) value reduces to</p>
<span class="math display">\[\begin{equation}
\mathrm{E}(lifespan|X_1=0, X_2=0) = b_0
\end{equation}\]</span>
<p>% Since both dummy variables are set to zero, we have modeled the expected value or mean of the control group.</p>
<p>The slope of a model is the difference in the modeled value given a one unit increase in <span class="math inline">\(X\)</span>. If we increase the dummy variable <span class="math inline">\(vitamin\_E\)</span> from zero to one (that is, if we are modeling the expected value of the vitamin E group), we get</p>
<span class="math display">\[\begin{equation}
\mathrm{E}(lifespan|X_1=1, X_2=0) = b_0 + b_1
\end{equation}\]</span>
<p>which can be re-arranged to</p>
<span class="math display">\[\begin{equation}
b_1 = \mathrm{E}(lifespan|X_1=1, X_2=0) - b_0
\end{equation}\]</span>
<p>and since <span class="math inline">\(\mathrm{E}(lifespan|X_1=0, X_2=0) = b_0\)</span> then</p>
<span class="math display">\[\begin{equation}
b_1 = \mathrm{E}(lifespan|X_1=1, X_2=0) - \mathrm{E}(lifespan|X_1=0, X_2=0)
\end{equation}\]</span>
<p>or, the coefficient of vitamin C is the difference in means between the vitamin C and control groups, which is also a slope since this is the expected difference given a one unit increase in <span class="math inline">\(vitamin\_C\)</span>.</p>
</div>
</div>
<div id="reporting-results-1" class="section level3">
<h3><span class="header-section-number">9.1.3</span> Reporting results</h3>
<p>What should be reported for the analyis of effects of anti-oxidant supplements on vole lifespan? Best practice includes reporting the raw data with a summary distribution and treatment effects with CIs. “Raw data” means the individual lifespans as a function of treatment level.</p>
<div id="harrell-plot-of-the-data" class="section level4">
<h4><span class="header-section-number">9.1.3.1</span> Harrell Plot of the data</h4>
<div class="figure"><span id="fig:harrellplot"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/harrellplot-1.png" alt="HarrellPlot of the raw data, distribution, and effects of the vole lifespan data." width="576" />
<p class="caption">
Figure 9.2: HarrellPlot of the raw data, distribution, and effects of the vole lifespan data.
</p>
</div>
<p>The raw data, the distributions within treatment level, and the effects (difference in means) of treatment can be combined into a single plot that I call a Harrell plot (Figure <a href="#fig:voles"><strong>??</strong></a>). Notice that the <em>x</em>-axis and <em>y</em> axes are flipped so that <span class="math inline">\(lifespan\)</span> is on the <em>x</em>-axis. It is still the “response” or “Y” variable! The Harrell plot contains two parts</p>
<ol style="list-style-type: decimal">
<li>The bottom contains a <strong>strip chart</strong> (often called a “dot plot”) of the raw response measures grouped by factor level. Superimposed over the strip chart is a <strong>box plot</strong> summarizing the distribution of each factor level. The line in the center of a box is the median <span class="math inline">\(lifespan\)</span> for that group, the left and right edges of the box are the 25% and 75% quantiles of <span class="math inline">\(lifespan\)</span> for that grop, and the lines extending to the left and right of the box are the “whiskers”, which are the smallest and largest value within <span class="math inline">\(1.5 IQR\)</span> (inter-quartile range, which is the interval bounded by box).</li>
<li>The top is a <strong>forest plot</strong> of the effects and the 95% CI of the effects. For categorical <span class="math inline">\(X\)</span>, the effects could be model coefficients or treatment <strong>contrasts</strong>, which are differences in means between treatment levels. Model coefficients are a subset of possible treatment contrasts.</li>
</ol>
<p>The Harrell plot above shows the effects as model coefficients, which (again!) are differences between the mean of the response in a specific treatment level and the mean of the response in a reference level. Here the reference level is the control group.</p>
</div>
<div id="in-text-reporting" class="section level4">
<h4><span class="header-section-number">9.1.3.2</span> In-text reporting</h4>
<p>“The mean lifespan of cold-reared voles supplemented with vitamin E was 89.9 days shorter than the mean lifespan for the control group (95% CI: -194.1, 14.3). The mean lifespan of cold-reared voles supplmented with vitamin C was 115.1 days shorter than the mean lifespan for the control group (95% CI: -223.2, -6.9).</p>
</div>
<div id="correct-interpretation-of-the-confidence-interval-is-key" class="section level4">
<h4><span class="header-section-number">9.1.3.3</span> Correct interpretation of the Confidence Interval is key</h4>
<p>Remember, that the CI contains the range of parameter values that are consistent with the data (in the sense that a t-test wouldn’t reject the hypothesis test). This means that a true value at the low end or the high end of the CI is consistent with the data. Your technical report/manuscript should discuss the consequences of this. For example, A small, increase in lifespan is consistant with the Vitamin E but not Vitamin C supplementation, if we use the 95% CI as a pretty good range for inferring “consistent with”. Both a 223 day and a 7 day decrease in lifespan are consistant with the Vitamin C effect. 223 days seems like a huge effect, especially for a short lived vole. 7 days is certainly a much smaller effect, but this doesn’t mean that it doesn’t have important ecological, behavioral, or fitness consequences.</p>
</div>
</div>
</div>
<div id="comparing-the-results-of-a-linear-model-to-classical-hypothesis-tests" class="section level2">
<h2><span class="header-section-number">9.2</span> Comparing the results of a linear model to classical hypothesis tests</h2>
<div id="t-tests-are-special-cases-of-a-linear-model" class="section level3">
<h3><span class="header-section-number">9.2.1</span> t-tests are special cases of a linear model</h3>
<p>There isn’t “a” <em>t</em>-test but several flavors of <em>t</em>-test including</p>
<ol style="list-style-type: decimal">
<li>Student’s <em>t</em>-test. The classical “two-sample” test for comparing the means between two groups</li>
<li>Welch’s <em>t</em>-test. A modification of Student’s test, which relaxes the assumption of equal variance between the groups.</li>
<li>paired <em>t</em>-test. A version of the test when values in the two groups are “paired”, for example, measuring weight in ten mice before treatment (at “baseline”), measuring weight in the same ten mice after treatment, then comparing the mean post-treatment to mean pre-treatment weight.</li>
</ol>
<p>All of these are special cases of the linear model. Welch’s and paired t-test are swept within a linear model in later chapters. Here, I focus on Student’s <em>t</em>-test.</p>
<p>First, let’s review <em>t</em>-values, which were introduced in Chapter 5 on <em>p</em>-values. A reminder, a <em>t</em>-value is a ratio of signal to noise, where the signal is an estimate of some parameter and the noise is the standard error of the estimate. The parameter of interest here is the difference in means between treatment and control, so <em>t</em> is</p>
<span class="math display" id="eq:lm-t-value">\[\begin{equation}
t = \frac{\bar{y}_t - \bar{y}_c}{s_{\bar{y}_t - \bar{y}_c}}
\tag{9.2}
\end{equation}\]</span>
<p>Note that the numerator and denominator in equation <a href="a-linear-model-with-a-single-categorical-x.html#eq:lm-t-value">(9.2)</a> are in the coefficient table of a linear model with categorical <span class="math inline">\(X\)</span> – the numerator is the estimate of the effect of a treatment and the denominator is the standard error of this estimate.</p>
<p>To explore these equalities, let’s use data from</p>
<p><strong>article</strong> Bak, A.M., Vendelbo, M.H., Christensen, B., Viggers, R., Bibby, B.M., Rungby, J., Jørgensen, J.O.L., Møller, N. and Jessen, N., 2018. Prolonged fasting-induced metabolic signatures in human skeletal muscle of lean and obese men. PloS one, 13(9), p.e0200817.</p>
<p><strong>data source</strong> <a href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.6121hj7" class="uri">https://datadryad.org/stash/dataset/doi:10.5061/dryad.6121hj7</a></p>
<p>The data are from a randomized <strong>crossover</strong> design where 18 men (9 lean and 9 obese) were measured for multiple metabolic markers at two times: 1) in a post-absorptive state after 12 hours overnight fast, and 2) in a prolonged fasting state after 72 hours of fasting. In addition, at each time point, metabolic markers were measured prior to and after an insulin infusion.</p>
<div id="a-student-t-test-is-equivalant-to-the-t-value-and-p-value-in-a-coefficient-table-of-a-linear-model-if-there-are-only-two-levels-in-the-treatment-factor" class="section level4">
<h4><span class="header-section-number">9.2.1.1</span> A student t-test is equivalant to the t-value and p-value in a coefficient table of a linear model <em>if</em> there are only two levels in the treatment factor</h4>
<p>Here I compare pre-insulin infusion blood levels of free fatty acids (ffa) between obese and lean subjects at 12h. The data are in Table 2 and the response is the column “ffa_t_210_min_m_m”. The assigment of lean or obese is in Table 1, which needs to be merged with Table 2 in order to subset the lean subjects.</p>
<p>Coefficient table from the linear model</p>
<pre><code>##             Estimate Std. Error  t value     Pr(&gt;|t|)
## (Intercept) 0.417625 0.04433893 9.418923 1.950636e-07
## groupobese  0.105625 0.06270472 1.684482 1.142414e-01</code></pre>
<p>The <em>t</em>-value and <em>p</em>-value of the effect of obesity on free-fatty acids <em>is</em> a t-test. The numerator of <em>t</em> is the difference in free-fatty acids between obese and lean subjects (the “Estimate” in the coefficient table). The denominator of <em>t</em> if the standard error of this estimate (The “Std. Error” in the coefficient table).</p>
<p>To confirm that that the the <em>t</em>and <em>p</em>-values of the effect of obesity on free-fatty acids <em>is</em> a t-test, let’s compare the coefficient table to the output of a t-test.</p>
<pre><code>## 
##  Two Sample t-test
## 
## data:  ffa_t_210_min_m_m by group
## t = -1.6845, df = 14, p-value = 0.1142
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.24011325  0.02886325
## sample estimates:
##  mean in group lean mean in group obese 
##            0.417625            0.523250</code></pre>
<p>The <em>t</em>-value in the t.test output is the same as the <em>t</em>-value of the effect of obesity (“groupobese”) in the coefficient table of the linear model, except it has the opposite sign. This sign is arbitrary and simply reflects which mean is subtracted from which. The <em>p</em>-value for both is the same.</p>
</div>
<div id="a-student-t-test-is-not-equivalant-to-the-t-value-and-p-value-in-a-coefficient-table-of-a-linear-model-if-there-are-more-than-two-levels-in-the-treatment-factor.-this-is-a-feture-of-a-linear-model-not-a-bug." class="section level4">
<h4><span class="header-section-number">9.2.1.2</span> A student t-test is <em>not</em> equivalant to the t-value and p-value in a coefficient table of a linear model <em>if</em> there are more than two levels in the treatment factor. This is a feture of a linear model, not a bug.</h4>
<p>Let’s return to the vole data. The <em>t</em> and <em>p</em> values of the effects of vitamin C and vitamin E in the coefficient table of the linear model of <span class="math inline">\(lifespan \sim treatment\)</span> are</p>
<table>
<thead>
<tr class="header">
<th align="left">Level</th>
<th align="right">t</th>
<th align="right">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">vitamin_C</td>
<td align="right">-2.113</td>
<td align="right">0.037</td>
</tr>
<tr class="even">
<td align="left">vitamin_E</td>
<td align="right">-1.713</td>
<td align="right">0.090</td>
</tr>
</tbody>
</table>
<p>while the <em>t</em>-tests between the two supplement levels and the control are</p>
<table>
<thead>
<tr class="header">
<th align="left">Level</th>
<th align="right">t</th>
<th align="right">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">vitamin_C</td>
<td align="right">-1.981</td>
<td align="right">0.051</td>
</tr>
<tr class="even">
<td align="left">vitamin_E</td>
<td align="right">-1.628</td>
<td align="right">0.108</td>
</tr>
<tr class="odd">
<td align="left">The <em>t</em>-test</td>
<td align="right">statisti</td>
<td align="right">cs differ from those of the linear model because the two use <em>different</em> standard errors in the denominator of <em>t</em>. Both denominators are computed from a <strong>pooled variance</strong>, which estimates the population variance using a weighted average of the variances of each of the groups in the model. The linear model contains all three levels (groups) of <span class="math inline">\(treatment\)</span> and, consequently, the pooled variance is computed from the variances of all three groups. The <em>t</em>-test uses the pooled variance averaged over only the two levels compared.</td>
</tr>
</tbody>
</table>
<p>If the linear model uses a pooled variance over all three levels, this raises the question of why the standard error of the vitamin C and vitamin E effects differs (see the full table above). The reason is the vitamin C and vitamin E groups have different sample sizes, so while the standard errors in the table are computed using a common variance, they are computed using different <span class="math inline">\(n\)</span>.</p>
</div>
<div id="feature-not-a-bug" class="section level4">
<h4><span class="header-section-number">9.2.1.3</span> Feature not a bug</h4>
</div>
<div id="use-the-linear-model-not-a-t-test." class="section level4">
<h4><span class="header-section-number">9.2.1.4</span> Use the linear model, not a t-test.</h4>
</div>
</div>
<div id="anova-is-a-special-case-of-a-linear-model" class="section level3">
<h3><span class="header-section-number">9.2.2</span> ANOVA is a special case of a linear model</h3>
</div>
</div>
<div id="working-in-r-1" class="section level2">
<h2><span class="header-section-number">9.3</span> Working in R</h2>
<p>Import the vole data from the Dryad repository using the information above and in Chapter 2 section [Vole data].</p>
<div id="fitting-the-model" class="section level3">
<h3><span class="header-section-number">9.3.1</span> Fitting the model</h3>
<p>As with a single, continuous <span class="math inline">\(X\)</span>, we fit the model using the <code>lm</code> function and with the model formula of the form <code>y ~ x</code>. Note that the R formula can use the single categorical variable <span class="math inline">\(treatment\)</span>. The code underneath lm will note that <span class="math inline">\(treatment\)</span> is a factor with three levels and will automatically create the two dummy variables noted above in the linear model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span><span class="kw">lm</span>(lifespan <span class="op">~</span><span class="st"> </span>treatment, <span class="dt">data=</span>vole)</code></pre></div>
<p>All of the same scripts to access the information in <code>fit</code> that we used with the continuous <span class="math inline">\(X\)</span> analysis are the same. For example, the base R <code>summary</code> function gives the same information as in the continuous <span class="math inline">\(X\)</span> example. Other useful functions on the lm object (“fit”) are</p>
<ol style="list-style-type: decimal">
<li><code>coefficients(fit)</code> and <code>coefficients(summary(fit))</code>. Note the difference between these. The first is useful if we just want to extract the coefficient. The second if we want the addtional information. These can both be shortened using <code>coef</code> in place of <code>coefficients</code>.</li>
</ol>
<p>Let’s look at the coefficient table</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(<span class="kw">summary</span>(fit))</code></pre></div>
<pre><code>##                      Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)         503.39286   27.40978 18.365445 1.078296e-32
## treatmentvitamin_C -115.07707   54.45772 -2.113145 3.726632e-02
## treatmentvitamin_E  -89.91667   52.48574 -1.713164 9.001428e-02</code></pre>
<p>The reference level is “control” – we know this because there are estimates of the effects for the other two levels.</p>
</div>
<div id="changing-the-reference-level" class="section level3">
<h3><span class="header-section-number">9.3.2</span> Changing the reference level</h3>
<p>R assigns the order of the levels of a factor alphabetically, so the order of the levels of treatment are “control”, “vitamin_C”, “vitamin_E”. The first of these is the reference level. Remember the intercept is the mean of the reference group and the remaining estimates are the differences in means from this reference. If we want to make some other level the reference, we can change the order of the factor levels using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vole[, treatment<span class="op">:</span><span class="er">=</span><span class="kw">factor</span>(treatment, 
                         <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;vitamin_C&quot;</span>, <span class="st">&quot;vitamin_E&quot;</span>, <span class="st">&quot;control&quot;</span>))]</code></pre></div>
<p>The order of the levels in the levels argument sets the new order for any further analysis. Refit the model to see how this re-ordering changes the coefficients</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(lifespan <span class="op">~</span><span class="st"> </span>treatment, <span class="dt">data=</span>vole)
<span class="kw">coef</span>(<span class="kw">summary</span>(fit2))</code></pre></div>
<pre><code>##                    Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)        388.3158   47.05685 8.2520573 1.005619e-12
## treatmentvitamin_E  25.1604   64.94462 0.3874132 6.993356e-01
## treatmentcontrol   115.0771   54.45772 2.1131453 3.726632e-02</code></pre>
<p>Understand why the values of these coefficients differ from those in the coefficient table above.</p>
<p>Here, I’m returning the factors back to the original order.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># put factors back to original</span>
vole[, treatment<span class="op">:</span><span class="er">=</span><span class="kw">factor</span>(treatment, 
                         <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;vitamin_C&quot;</span>, <span class="st">&quot;vitamin_E&quot;</span>))]</code></pre></div>
</div>
<div id="an-introduction-to-contrasts" class="section level3">
<h3><span class="header-section-number">9.3.3</span> An introduction to contrasts</h3>
<p>We often want to compare more than just the non-reference levels to the reference level. For example, we might want to compare the effects of the vitamin E supplementation to vitamin C supplementation. Or, we might want to combine (or “pool”) vitamin C and vitamin E levels effects into a single “anti-oxidant” level and compare to the control. These comparisons of means are called linear <strong>contrasts</strong>. The emmeans package is a good package for obtaining contrasts for both simple linear models computed with <code>lm</code> and for more complicated statistical models. If you haven’t already, download the emmeans package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit.em &lt;-<span class="st"> </span><span class="kw">emmeans</span>(fit, <span class="dt">specs=</span><span class="st">&quot;treatment&quot;</span>)
fit.em</code></pre></div>
<pre><code>##  treatment emmean   SE df lower.CL upper.CL
##  control      503 27.4 93      449      558
##  vitamin_C    388 47.1 93      295      482
##  vitamin_E    413 44.8 93      325      502
## 
## Confidence level used: 0.95</code></pre>
<p>The <code>emmeans()</code> function returns various estimated means, depending on what is specified with the <code>spec=</code> parameter. Here the grouping variable “treatment” is specified, so the means returned are estimates of <span class="math inline">\(\mathrm{E}(lifespan | treatment)\)</span>, the modeled means for each level of treatment. For this simple analysis, the modeled means are simply the group means. Note that the default value returned is a table with the standard error and 95% confidence limits of the estimates.</p>
<p>Let’s use the emmeans object to get the contrasts for all combinations of treatment levels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">contrast</span>(fit.em, <span class="dt">method=</span><span class="st">&quot;revpairwise&quot;</span>, <span class="dt">adjust=</span><span class="st">&quot;none&quot;</span>), <span class="dt">infer=</span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>))</code></pre></div>
<pre><code>##  contrast              estimate   SE df lower.CL upper.CL t.ratio p.value
##  vitamin_C - control     -115.1 54.5 93     -223    -6.93 -2.113  0.0373 
##  vitamin_E - control      -89.9 52.5 93     -194    14.31 -1.713  0.0900 
##  vitamin_E - vitamin_C     25.2 64.9 93     -104   154.13  0.387  0.6993 
## 
## Confidence level used: 0.95</code></pre>
<ol style="list-style-type: decimal">
<li>method=“revpairwise”. <code>contrast</code> can create different combinations of differences between means. Here I’ve specified all pairwise differences (the “rev” reverses the order of the subtraction). Notice that the statistics (estimate, SE, etc) are equal to the same statistics for <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> of the linear model. I said earlier that these coefficients are contrasts!</li>
<li>adjust=“none”. In classical frequentist hypothesis testing, the p-value of a contrast in what are called “post-hoc tests” is adjusted to reflect “multiple testing” (more than one p-value is being computed). This adjustment is almost standard in biology, but the practice is hugely controversial. The concept of multiple testing is important, and we will return to this in a future chapter, but here I have chosen to show the unadjusted p-value. The reason is that I want the unadjusted confidence interval and the adjustment would adjust these as well. If deleted <code>adjust=&quot;none&quot;</code> from the script, the contrast function would default to the <strong>Tukey HSD</strong> (Honestly Significant Difference) test. There are literally dozens and dozens of post-hoc tests, which largely reflects the misplaced emphasis on “better” <span class="math inline">\(p\)</span>-values rather than parameter estimates and their uncertainty.</li>
<li>infer=c(TRUE, TRUE). This parameter controls what kind of inference to put in the table. The first value specifies the inclusion of the CI (emmeans uses “CL” for confidence limit), the second value specifies the inclusion of <span class="math inline">\(t\)</span> and <span class="math inline">\(p\)</span>-values.</li>
</ol>
</div>
<div id="harrell-plot" class="section level3">
<h3><span class="header-section-number">9.3.4</span> Harrell plot</h3>
<div id="installing-the-harrellplot-package" class="section level4">
<h4><span class="header-section-number">9.3.4.1</span> Installing the harrellplot package</h4>
<p>The harrellplot package is available on github but not a cran repository and, therefore, takes a little more work to install. To install a package from a github repository, 1. load library(devtools) – this may need to be installed first using the R Studio Tools &gt; Install Packages… tool 2. install harrellplot from github. In the console, type</p>
<p><code>install_github(&quot;middleprofessor/harrellplot&quot;)</code></p>
<ol start="3" style="list-style-type: decimal">
<li>load the harrellplot package</li>
<li>harrellplot requires other packages including broom, Hmisc, car, lme4, and lmerTest. If you haven’t installed these do. load these with the library() function at the start of your notebook.</li>
</ol>
</div>
<div id="using-harrellplot-to-make-a-nice-publishable-plot-of-treatment-effects" class="section level4">
<h4><span class="header-section-number">9.3.4.2</span> Using harrellplot to make a nice, publishable plot of treatment effects</h4>
<p>In the console type <code>?harrellplot</code> to see the many parameters. Unlike ggplot2, variable names need to be specified with quotes in the harrellplot function. The harrellplot function is a list with several elements.</p>
<p>Here is the default plot</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vole.harrellplot &lt;-<span class="st"> </span><span class="kw">harrellplot</span>(<span class="dt">x=</span><span class="st">&quot;treatment&quot;</span>, <span class="dt">y=</span><span class="st">&quot;lifespan&quot;</span>, <span class="dt">data=</span>vole)
vole.harrellplot<span class="op">$</span>gg <span class="co"># gg is the plot object</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-46-1.png" width="576" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-linear-model-with-a-single-continuous-x.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-checking-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/24-categorical_X.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
