<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Plotting Models | Applied Statistics for Experimental Biology</title>
  <meta name="description" content="An introduction to statistical modeling for experimental biology researchers" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Plotting Models | Applied Statistics for Experimental Biology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Plotting Models | Applied Statistics for Experimental Biology" />
  
  <meta name="twitter:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data.html"/>
<link rel="next" href="part-iv-some-fundamentals-of-statistical-modeling.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li><a href="index.html#why-bother-with-linear-models-arent-t-tests-and-anova-good-enough">Why bother with linear models – aren’t <em>t</em>-tests and ANOVA good enough?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-unusual-about-this-book"><i class="fa fa-check"></i>What is unusual about this book?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-table-of-models.html"><a href="a-table-of-models.html"><i class="fa fa-check"></i>A Table of Models</a>
<ul>
<li class="chapter" data-level="" data-path="a-table-of-models.html"><a href="a-table-of-models.html#including-mapping-between-linear-models-and-classical-tests"><i class="fa fa-check"></i>including mapping between linear models and classical tests</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="analyzing-experimental-data-with-a-linear-model.html"><a href="analyzing-experimental-data-with-a-linear-model.html"><i class="fa fa-check"></i><b>1</b> Analyzing experimental data with a linear model</a>
<ul>
<li class="chapter" data-level="1.1" data-path="analyzing-experimental-data-with-a-linear-model.html"><a href="analyzing-experimental-data-with-a-linear-model.html#this-text-is-about-using-linear-models-to-estimate-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect"><i class="fa fa-check"></i><b>1.1</b> This text is about using linear models to estimate treatment effects and the uncertainty in our estimates. This, raises the question, what is “an effect?”</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-getting-started.html"><a href="part-i-getting-started.html"><i class="fa fa-check"></i>Part I: Getting Started</a></li>
<li class="chapter" data-level="2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html"><i class="fa fa-check"></i><b>2</b> Getting Started – R Projects and R Markdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-vs-r-studio"><i class="fa fa-check"></i><b>2.1</b> R vs R Studio</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#download-and-install-r-and-r-studio"><i class="fa fa-check"></i><b>2.2</b> Download and install R and R studio</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#open-r-studio-and-modify-the-workspace-preference"><i class="fa fa-check"></i><b>2.3</b> Open R Studio and modify the workspace preference</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it"><i class="fa fa-check"></i><b>2.4</b> If you didn’t modify the workspace preferences from the previous section, go back and do it</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-markdown-in-a-nutshell"><i class="fa fa-check"></i><b>2.5</b> R Markdown in a nutshell</a></li>
<li class="chapter" data-level="2.6" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#install-r-markdown"><i class="fa fa-check"></i><b>2.6</b> Install R Markdown</a></li>
<li class="chapter" data-level="2.7" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#importing-packages"><i class="fa fa-check"></i><b>2.7</b> Importing Packages</a></li>
<li class="chapter" data-level="2.8" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#setup-create-project"><i class="fa fa-check"></i><b>2.8</b> Create an R Studio Project for this textbook</a></li>
<li class="chapter" data-level="2.9" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#working-on-a-project-in-a-nutshell"><i class="fa fa-check"></i><b>2.9</b> Working on a project, in a nutshell</a></li>
<li class="chapter" data-level="2.10" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-an-r-markdown-file-for-this-chapter"><i class="fa fa-check"></i><b>2.10</b> Create an R Markdown file for this Chapter</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#modify-the-yaml-header"><i class="fa fa-check"></i><b>2.10.1</b> Modify the yaml header</a></li>
<li class="chapter" data-level="2.10.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#modify-the-setup-chunk"><i class="fa fa-check"></i><b>2.10.2</b> Modify the “setup” chunk</a></li>
<li class="chapter" data-level="2.10.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-fake-data-chunk"><i class="fa fa-check"></i><b>2.10.3</b> Create a “fake-data” chunk</a></li>
<li class="chapter" data-level="2.10.4" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-plot-chunk"><i class="fa fa-check"></i><b>2.10.4</b> Create a “plot” chunk</a></li>
<li class="chapter" data-level="2.10.5" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#knit"><i class="fa fa-check"></i><b>2.10.5</b> Knit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-r-fundamentals.html"><a href="part-iii-r-fundamentals.html"><i class="fa fa-check"></i>Part III: R fundamentals</a></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data – Reading, Wrangling, and Writing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#the-way-data-should-be"><i class="fa fa-check"></i><b>3.1</b> The way data should be</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#importing-best-practices"><i class="fa fa-check"></i><b>3.2</b> Importing – best practices</a></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#learning-from-this-chapter"><i class="fa fa-check"></i><b>3.3</b> Learning from this chapter</a></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#data-working-in-r"><i class="fa fa-check"></i><b>3.4</b> Working in R</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data.html"><a href="data.html#importing-data"><i class="fa fa-check"></i><b>3.4.1</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data.html"><a href="data.html#data-wrangling"><i class="fa fa-check"></i><b>3.5</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data.html"><a href="data.html#reshaping-data-wide-to-long"><i class="fa fa-check"></i><b>3.5.1</b> Reshaping data – Wide to long</a></li>
<li class="chapter" data-level="3.5.2" data-path="data.html"><a href="data.html#reshaping-data-transpose-turning-the-columns-into-rows"><i class="fa fa-check"></i><b>3.5.2</b> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li class="chapter" data-level="3.5.3" data-path="data.html"><a href="data.html#combining-data"><i class="fa fa-check"></i><b>3.5.3</b> Combining data</a></li>
<li class="chapter" data-level="3.5.4" data-path="data.html"><a href="data.html#subsetting-data"><i class="fa fa-check"></i><b>3.5.4</b> Subsetting data</a></li>
<li class="chapter" data-level="3.5.5" data-path="data.html"><a href="data.html#wrangling-columns"><i class="fa fa-check"></i><b>3.5.5</b> Wrangling columns</a></li>
<li class="chapter" data-level="3.5.6" data-path="data.html"><a href="data.html#missing-data"><i class="fa fa-check"></i><b>3.5.6</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data.html"><a href="data.html#saving-data"><i class="fa fa-check"></i><b>3.6</b> Saving data</a></li>
<li class="chapter" data-level="3.7" data-path="data.html"><a href="data.html#exercises"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting-models.html"><a href="plotting-models.html"><i class="fa fa-check"></i><b>4</b> Plotting Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data"><i class="fa fa-check"></i><b>4.1</b> Pretty good plots show the model and the data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot"><i class="fa fa-check"></i><b>4.1.1</b> Pretty good plot component 1: Modeled effects plot</a></li>
<li class="chapter" data-level="4.1.2" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot"><i class="fa fa-check"></i><b>4.1.2</b> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li class="chapter" data-level="4.1.3" data-path="plotting-models.html"><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><i class="fa fa-check"></i><b>4.1.3</b> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
<li class="chapter" data-level="4.1.4" data-path="plotting-models.html"><a href="plotting-models.html#some-comments-on-plot-components"><i class="fa fa-check"></i><b>4.1.4</b> Some comments on plot components</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="plotting-models.html"><a href="plotting-models.html#working-in-r"><i class="fa fa-check"></i><b>4.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="plotting-models.html"><a href="plotting-models.html#source-data"><i class="fa fa-check"></i><b>4.2.1</b> Source data</a></li>
<li class="chapter" data-level="4.2.2" data-path="plotting-models.html"><a href="plotting-models.html#how-to-plot-the-model"><i class="fa fa-check"></i><b>4.2.2</b> How to plot the model</a></li>
<li class="chapter" data-level="4.2.3" data-path="plotting-models.html"><a href="plotting-models.html#be-sure-ggplot_the_model-is-in-your-r-folder"><i class="fa fa-check"></i><b>4.2.3</b> Be sure ggplot_the_model is in your R folder</a></li>
<li class="chapter" data-level="4.2.4" data-path="plotting-models.html"><a href="plotting-models.html#how-to-use-the-plot-the-model-functions"><i class="fa fa-check"></i><b>4.2.4</b> How to use the Plot the Model functions</a></li>
<li class="chapter" data-level="4.2.5" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-a-response-plot-using-ggpubr"><i class="fa fa-check"></i><b>4.2.5</b> How to generate a Response Plot using ggpubr</a></li>
<li class="chapter" data-level="4.2.6" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2"><i class="fa fa-check"></i><b>4.2.6</b> How to generate a Response Plot with a grid of treatments using ggplot2</a></li>
<li class="chapter" data-level="4.2.7" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-an-effects-plot"><i class="fa fa-check"></i><b>4.2.7</b> How to generate an Effects Plot</a></li>
<li class="chapter" data-level="4.2.8" data-path="plotting-models.html"><a href="plotting-models.html#how-to-combine-the-response-and-effects-plots"><i class="fa fa-check"></i><b>4.2.8</b> How to combine the response and effects plots</a></li>
<li class="chapter" data-level="4.2.9" data-path="plotting-models.html"><a href="plotting-models.html#how-to-add-the-interaction-effect-to-response-and-effects-plots"><i class="fa fa-check"></i><b>4.2.9</b> How to add the interaction effect to response and effects plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iv-some-fundamentals-of-statistical-modeling.html"><a href="part-iv-some-fundamentals-of-statistical-modeling.html"><i class="fa fa-check"></i>Part IV: Some Fundamentals of Statistical Modeling</a></li>
<li class="chapter" data-level="5" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>5</b> Variability and Uncertainty (Standard Deviations, Standard Errors, Confidence Intervals)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="uncertainty.html"><a href="uncertainty.html#the-sample-standard-deviation-vs.-the-standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.1</b> The sample standard deviation vs. the standard error of the mean</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="uncertainty.html"><a href="uncertainty.html#sample-standard-deviation"><i class="fa fa-check"></i><b>5.1.1</b> Sample standard deviation</a></li>
<li class="chapter" data-level="5.1.2" data-path="uncertainty.html"><a href="uncertainty.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="uncertainty.html"><a href="uncertainty.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.2</b> Using Google Sheets to generate fake data to explore the standard error</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="uncertainty.html"><a href="uncertainty.html#steps"><i class="fa fa-check"></i><b>5.2.1</b> Steps</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="uncertainty.html"><a href="uncertainty.html#using-r-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.3</b> Using R to generate fake data to explore the standard error</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="uncertainty.html"><a href="uncertainty.html#part-i"><i class="fa fa-check"></i><b>5.3.1</b> part I</a></li>
<li class="chapter" data-level="5.3.2" data-path="uncertainty.html"><a href="uncertainty.html#part-ii---means"><i class="fa fa-check"></i><b>5.3.2</b> part II - means</a></li>
<li class="chapter" data-level="5.3.3" data-path="uncertainty.html"><a href="uncertainty.html#part-iii---how-do-sd-and-se-change-as-sample-size-n-increases"><i class="fa fa-check"></i><b>5.3.3</b> part III - how do SD and SE change as sample size (n) increases?</a></li>
<li class="chapter" data-level="5.3.4" data-path="uncertainty.html"><a href="uncertainty.html#part-iv-generating-fake-data-with-for-loops"><i class="fa fa-check"></i><b>5.3.4</b> Part IV – Generating fake data with for-loops</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="uncertainty.html"><a href="uncertainty.html#bootstrap"><i class="fa fa-check"></i><b>5.4</b> Bootstrapped standard errors</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="uncertainty.html"><a href="uncertainty.html#an-example-of-bootstrapped-standard-errors-using-vole-data"><i class="fa fa-check"></i><b>5.4.1</b> An example of bootstrapped standard errors using vole data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="uncertainty.html"><a href="uncertainty.html#confidence-interval"><i class="fa fa-check"></i><b>5.5</b> Confidence Interval</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="uncertainty.html"><a href="uncertainty.html#interpretation-of-a-confidence-interval"><i class="fa fa-check"></i><b>5.5.1</b> Interpretation of a confidence interval</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="p-values.html"><a href="p-values.html"><i class="fa fa-check"></i><b>6</b> P-values</a>
<ul>
<li class="chapter" data-level="6.1" data-path="p-values.html"><a href="p-values.html#a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution"><i class="fa fa-check"></i><b>6.1</b> A <em>p</em>-value is the probability of sampling a value as or more extreme than the test statistic if sampling from a null distribution</a></li>
<li class="chapter" data-level="6.2" data-path="p-values.html"><a href="p-values.html#pump-your-intuition-creating-a-null-distribution"><i class="fa fa-check"></i><b>6.2</b> Pump your intuition – Creating a null distribution</a></li>
<li class="chapter" data-level="6.3" data-path="p-values.html"><a href="p-values.html#a-null-distribution-of-t-values-the-t-distribution"><i class="fa fa-check"></i><b>6.3</b> A null distribution of <em>t</em>-values – the <em>t</em> distribution</a></li>
<li class="chapter" data-level="6.4" data-path="p-values.html"><a href="p-values.html#p-values-from-the-perspective-of-permutation"><i class="fa fa-check"></i><b>6.4</b> P-values from the perspective of permutation</a></li>
<li class="chapter" data-level="6.5" data-path="p-values.html"><a href="p-values.html#parametric-vs.-non-parametric-statistics"><i class="fa fa-check"></i><b>6.5</b> Parametric vs. non-parametric statistics</a></li>
<li class="chapter" data-level="6.6" data-path="p-values.html"><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values"><i class="fa fa-check"></i><b>6.6</b> frequentist probability and the interpretation of p-values</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="p-values.html"><a href="p-values.html#background"><i class="fa fa-check"></i><b>6.6.1</b> Background</a></li>
<li class="chapter" data-level="6.6.2" data-path="p-values.html"><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><i class="fa fa-check"></i><b>6.6.2</b> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li class="chapter" data-level="6.6.3" data-path="p-values.html"><a href="p-values.html#two-interpretations-of-the-p-value"><i class="fa fa-check"></i><b>6.6.3</b> Two interpretations of the <em>p</em>-value</a></li>
<li class="chapter" data-level="6.6.4" data-path="p-values.html"><a href="p-values.html#nhst"><i class="fa fa-check"></i><b>6.6.4</b> NHST</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="p-values.html"><a href="p-values.html#some-major-misconceptions-of-the-p-value"><i class="fa fa-check"></i><b>6.7</b> Some major misconceptions of the <em>p</em>-value</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="p-values.html"><a href="p-values.html#misconception-p-is-the-probability-that-the-null-is-true-and-1-p-is-probability-that-the-alternative-is-true"><i class="fa fa-check"></i><b>6.7.1</b> Misconception: <em>p</em> is the probability that the null is true <em>and</em> <span class="math inline">\(1-p\)</span> is probability that the alternative is true</a></li>
<li class="chapter" data-level="6.7.2" data-path="p-values.html"><a href="p-values.html#misconception-a-p-value-is-repeatable"><i class="fa fa-check"></i><b>6.7.2</b> Misconception: a <em>p</em>-value is repeatable</a></li>
<li class="chapter" data-level="6.7.3" data-path="p-values.html"><a href="p-values.html#misconception-0.05-is-the-lifetime-rate-of-false-discoveries"><i class="fa fa-check"></i><b>6.7.3</b> Misconception: 0.05 is the lifetime rate of false discoveries</a></li>
<li class="chapter" data-level="6.7.4" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-an-important-effect"><i class="fa fa-check"></i><b>6.7.4</b> Misconception: a low <em>p</em>-value indicates an important effect</a></li>
<li class="chapter" data-level="6.7.5" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity"><i class="fa fa-check"></i><b>6.7.5</b> Misconception: a low <em>p</em>-value indicates high model fit or high predictive capacity</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="p-values.html"><a href="p-values.html#what-the-p-value-does-not-mean"><i class="fa fa-check"></i><b>6.8</b> What the <em>p</em>-value does not mean</a></li>
<li class="chapter" data-level="6.9" data-path="p-values.html"><a href="p-values.html#recommendations"><i class="fa fa-check"></i><b>6.9</b> Recommendations</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="p-values.html"><a href="p-values.html#primary-sources-for-recommendations"><i class="fa fa-check"></i><b>6.9.1</b> Primary sources for recommendations</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="p-values.html"><a href="p-values.html#problems"><i class="fa fa-check"></i><b>6.10</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="errors-in-inference.html"><a href="errors-in-inference.html"><i class="fa fa-check"></i><b>7</b> Errors in inference</a>
<ul>
<li class="chapter" data-level="7.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#classical-nhst-concepts-of-wrong"><i class="fa fa-check"></i><b>7.1</b> Classical NHST concepts of wrong</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-i-error"><i class="fa fa-check"></i><b>7.1.1</b> Type I error</a></li>
<li class="chapter" data-level="7.1.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#power"><i class="fa fa-check"></i><b>7.1.2</b> Power</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#a-non-neyman-pearson-concept-of-power"><i class="fa fa-check"></i><b>7.2</b> A non-Neyman-Pearson concept of power</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#estimation-error"><i class="fa fa-check"></i><b>7.2.1</b> Estimation error</a></li>
<li class="chapter" data-level="7.2.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#coverage"><i class="fa fa-check"></i><b>7.2.2</b> Coverage</a></li>
<li class="chapter" data-level="7.2.3" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-s-error"><i class="fa fa-check"></i><b>7.2.3</b> Type S error</a></li>
<li class="chapter" data-level="7.2.4" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-m-error"><i class="fa fa-check"></i><b>7.2.4</b> Type M error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-introduction-to-linear-models.html"><a href="part-v-introduction-to-linear-models.html"><i class="fa fa-check"></i>Part V: Introduction to Linear Models</a></li>
<li class="chapter" data-level="8" data-path="intro-linear-models.html"><a href="intro-linear-models.html"><i class="fa fa-check"></i><b>8</b> An introduction to linear models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#lm-specifications"><i class="fa fa-check"></i><b>8.1</b> Two specifications of a linear model</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#the-error-draw-specification"><i class="fa fa-check"></i><b>8.1.1</b> The “error draw” specification</a></li>
<li class="chapter" data-level="8.1.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#the-conditional-draw-specification"><i class="fa fa-check"></i><b>8.1.2</b> The “conditional draw” specification</a></li>
<li class="chapter" data-level="8.1.3" data-path="intro-linear-models.html"><a href="intro-linear-models.html#comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model"><i class="fa fa-check"></i><b>8.1.3</b> Comparing the error-draw and conditional-draw ways of specifying the linear model</a></li>
<li class="chapter" data-level="8.1.4" data-path="intro-linear-models.html"><a href="intro-linear-models.html#anova-notation-of-a-linear-model"><i class="fa fa-check"></i><b>8.1.4</b> ANOVA notation of a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"><i class="fa fa-check"></i><b>8.2</b> A linear model can be fit to data with continuous, discrete, or categorical <span class="math inline">\(X\)</span> variables</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete"><i class="fa fa-check"></i><b>8.2.1</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is continuous or discrete</a></li>
<li class="chapter" data-level="8.2.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#slope"><i class="fa fa-check"></i><b>8.2.2</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is categorical</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="intro-linear-models.html"><a href="intro-linear-models.html#statistical-models-are-used-for-prediction-explanation-and-description"><i class="fa fa-check"></i><b>8.3</b> Statistical models are used for prediction, explanation, and description</a></li>
<li class="chapter" data-level="8.4" data-path="intro-linear-models.html"><a href="intro-linear-models.html#what-do-we-call-the-x-and-y-variables"><i class="fa fa-check"></i><b>8.4</b> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li class="chapter" data-level="8.5" data-path="intro-linear-models.html"><a href="intro-linear-models.html#modeling-strategy"><i class="fa fa-check"></i><b>8.5</b> Modeling strategy</a></li>
<li class="chapter" data-level="8.6" data-path="intro-linear-models.html"><a href="intro-linear-models.html#predictions-from-the-model"><i class="fa fa-check"></i><b>8.6</b> Predictions from the model</a></li>
<li class="chapter" data-level="8.7" data-path="intro-linear-models.html"><a href="intro-linear-models.html#inference-from-the-model"><i class="fa fa-check"></i><b>8.7</b> Inference from the model</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#assumptions-for-inference-with-a-statistical-model"><i class="fa fa-check"></i><b>8.7.1</b> Assumptions for inference with a statistical model</a></li>
<li class="chapter" data-level="8.7.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model"><i class="fa fa-check"></i><b>8.7.2</b> Specific assumptions for inference with a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="intro-linear-models.html"><a href="intro-linear-models.html#linear-modelregression-model-orstatistical-model"><i class="fa fa-check"></i><b>8.8</b> “linear model,”regression model“, or”statistical model"?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> Linear models with a single, continuous <em>X</em> (“regression”)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><i class="fa fa-check"></i><b>9.1</b> A linear model with a single, continuous <em>X</em> is classical “regression”</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="regression.html"><a href="regression.html#analysis-of-green-down-data"><i class="fa fa-check"></i><b>9.1.1</b> Analysis of “green-down” data</a></li>
<li class="chapter" data-level="9.1.2" data-path="regression.html"><a href="regression.html#learning-from-the-green-down-example"><i class="fa fa-check"></i><b>9.1.2</b> Learning from the green-down example</a></li>
<li class="chapter" data-level="9.1.3" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-explanation-causal-models"><i class="fa fa-check"></i><b>9.1.3</b> Using a regression model for “explanation” – causal models</a></li>
<li class="chapter" data-level="9.1.4" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-prediction-prediction-models"><i class="fa fa-check"></i><b>9.1.4</b> Using a regression model for prediction – prediction models</a></li>
<li class="chapter" data-level="9.1.5" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data"><i class="fa fa-check"></i><b>9.1.5</b> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</a></li>
<li class="chapter" data-level="9.1.6" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-for-calibration"><i class="fa fa-check"></i><b>9.1.6</b> Using a regression model for for calibration</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#working-in-r-1"><i class="fa fa-check"></i><b>9.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="plotting-models.html"><a href="plotting-models.html#fit-the-model"><i class="fa fa-check"></i><b>9.2.1</b> Fitting the linear model</a></li>
<li class="chapter" data-level="9.2.2" data-path="regression.html"><a href="regression.html#getting-to-know-the-linear-model-the-summary-function"><i class="fa fa-check"></i><b>9.2.2</b> Getting to know the linear model: the <code>summary</code> function</a></li>
<li class="chapter" data-level="9.2.3" data-path="regression.html"><a href="regression.html#inference-the-coefficient-table"><i class="fa fa-check"></i><b>9.2.3</b> Inference – the coefficient table</a></li>
<li class="chapter" data-level="9.2.4" data-path="regression.html"><a href="regression.html#how-good-is-our-model-model-checking"><i class="fa fa-check"></i><b>9.2.4</b> How good is our model? – Model checking</a></li>
<li class="chapter" data-level="9.2.5" data-path="regression.html"><a href="regression.html#plotting-models-with-continuous-x"><i class="fa fa-check"></i><b>9.2.5</b> Plotting models with continuous <em>X</em></a></li>
<li class="chapter" data-level="9.2.6" data-path="regression.html"><a href="regression.html#creating-a-table-of-predicted-values-and-95-prediction-intervals"><i class="fa fa-check"></i><b>9.2.6</b> Creating a table of predicted values and 95% prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="regression.html"><a href="regression.html#hidden-code"><i class="fa fa-check"></i><b>9.3</b> Hidden code</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="regression.html"><a href="regression.html#import-and-plot-of-fig2c-ecosystem-warming-experimental-data"><i class="fa fa-check"></i><b>9.3.1</b> Import and plot of fig2c (ecosystem warming experimental) data</a></li>
<li class="chapter" data-level="9.3.2" data-path="regression.html"><a href="regression.html#import-and-plot-efig_3d-ecosysem-warming-observational-data"><i class="fa fa-check"></i><b>9.3.2</b> Import and plot efig_3d (Ecosysem warming observational) data</a></li>
<li class="chapter" data-level="9.3.3" data-path="regression.html"><a href="regression.html#import-and-plot-of-fig1f-methionine-restriction-data"><i class="fa fa-check"></i><b>9.3.3</b> Import and plot of fig1f (methionine restriction) data</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="regression.html"><a href="regression.html#try-it"><i class="fa fa-check"></i><b>9.4</b> Try it</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="regression.html"><a href="regression.html#a-prediction-model-from-the-literature"><i class="fa fa-check"></i><b>9.4.1</b> A prediction model from the literature</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="regression.html"><a href="regression.html#intuition-pumps"><i class="fa fa-check"></i><b>9.5</b> Intuition pumps</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="regression.html"><a href="regression.html#correlation-and-r2"><i class="fa fa-check"></i><b>9.5.1</b> Correlation and $R^2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="oneway.html"><a href="oneway.html"><i class="fa fa-check"></i><b>10</b> Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="oneway.html"><a href="oneway.html#oneway-data"><i class="fa fa-check"></i><b>10.1</b> A linear model with a single, categorical <em>X</em> variable estimates the effects of the levels of <em>X</em> on the response</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="oneway.html"><a href="oneway.html#oneway-example1"><i class="fa fa-check"></i><b>10.1.1</b> Example 1 (fig3d) – two treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.2" data-path="oneway.html"><a href="oneway.html#understanding-the-analysis-with-two-treatment-levels"><i class="fa fa-check"></i><b>10.1.2</b> Understanding the analysis with two treatment levels</a></li>
<li class="chapter" data-level="10.1.3" data-path="oneway.html"><a href="oneway.html#oneway-example2"><i class="fa fa-check"></i><b>10.1.3</b> Example 2 – three treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.4" data-path="oneway.html"><a href="oneway.html#understanding-the-analysis-with-three-or-more-treatment-levels"><i class="fa fa-check"></i><b>10.1.4</b> Understanding the analysis with three (or more) treatment levels</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="oneway.html"><a href="oneway.html#working-in-r-2"><i class="fa fa-check"></i><b>10.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="oneway.html"><a href="oneway.html#fit-the-model-1"><i class="fa fa-check"></i><b>10.2.1</b> Fit the model</a></li>
<li class="chapter" data-level="10.2.2" data-path="oneway.html"><a href="oneway.html#controlling-the-output-in-tables-using-the-coefficient-table-as-an-example"><i class="fa fa-check"></i><b>10.2.2</b> Controlling the output in tables using the coefficient table as an example</a></li>
<li class="chapter" data-level="10.2.3" data-path="oneway.html"><a href="oneway.html#using-the-emmeans-function"><i class="fa fa-check"></i><b>10.2.3</b> Using the emmeans function</a></li>
<li class="chapter" data-level="10.2.4" data-path="oneway.html"><a href="oneway.html#using-the-contrast-function"><i class="fa fa-check"></i><b>10.2.4</b> Using the contrast function</a></li>
<li class="chapter" data-level="10.2.5" data-path="oneway.html"><a href="oneway.html#how-to-generate-anova-tables"><i class="fa fa-check"></i><b>10.2.5</b> How to generate ANOVA tables</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="oneway.html"><a href="oneway.html#hidden-code-1"><i class="fa fa-check"></i><b>10.3</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="oneway.html"><a href="oneway.html#importing-and-wrangling-the-fig_3d-data-for-example-1"><i class="fa fa-check"></i><b>10.3.1</b> Importing and wrangling the fig_3d data for example 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="oneway.html"><a href="oneway.html#importing-and-wrangling-the-fig2a-data-for-example-2"><i class="fa fa-check"></i><b>10.3.2</b> Importing and wrangling the fig2a data for example 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>11</b> Model Checking</a>
<ul>
<li class="chapter" data-level="11.1" data-path="model-checking.html"><a href="model-checking.html#check-check"><i class="fa fa-check"></i><b>11.1</b> All statistical analyses should be followed by model checking</a></li>
<li class="chapter" data-level="11.2" data-path="model-checking.html"><a href="model-checking.html#linear-model-assumptions"><i class="fa fa-check"></i><b>11.2</b> Linear model assumptions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="model-checking.html"><a href="model-checking.html#a-bit-about-iid"><i class="fa fa-check"></i><b>11.2.1</b> A bit about IID</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="model-checking.html"><a href="model-checking.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>11.3</b> Diagnostic plots use the residuals from the model fit</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="model-checking.html"><a href="model-checking.html#residuals"><i class="fa fa-check"></i><b>11.3.1</b> Residuals</a></li>
<li class="chapter" data-level="11.3.2" data-path="model-checking.html"><a href="model-checking.html#normal-qq"><i class="fa fa-check"></i><b>11.3.2</b> A Normal Q-Q plot is used to check for characteristic departures from Normality</a></li>
<li class="chapter" data-level="11.3.3" data-path="model-checking.html"><a href="model-checking.html#mapping-qq-plot-departures-from-normality"><i class="fa fa-check"></i><b>11.3.3</b> Mapping QQ-plot departures from Normality</a></li>
<li class="chapter" data-level="11.3.4" data-path="model-checking.html"><a href="model-checking.html#model-checking-spread-level"><i class="fa fa-check"></i><b>11.3.4</b> Model checking homoskedasticity</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="model-checking.html"><a href="model-checking.html#using-r"><i class="fa fa-check"></i><b>11.4</b> Using R</a></li>
<li class="chapter" data-level="11.5" data-path="model-checking.html"><a href="model-checking.html#hidden-code-2"><i class="fa fa-check"></i><b>11.5</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="model-checking.html"><a href="model-checking.html#normal-q-q-plots"><i class="fa fa-check"></i><b>11.5.1</b> Normal Q-Q plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="violations.html"><a href="violations.html"><i class="fa fa-check"></i><b>12</b> Violations of independence, homogeneity, or Normality</a>
<ul>
<li class="chapter" data-level="12.1" data-path="violations.html"><a href="violations.html#oneway-paired-t"><i class="fa fa-check"></i><b>12.1</b> Lack of independence</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="violations.html"><a href="violations.html#violations-paired-t"><i class="fa fa-check"></i><b>12.1.1</b> Example 1 (exp1b) – a paired t-test is a special case of a linear mixed model</a></li>
<li class="chapter" data-level="12.1.2" data-path="violations.html"><a href="violations.html#violations-rmanova"><i class="fa fa-check"></i><b>12.1.2</b> Example 2 (diHOME exp2a) – A repeated measures ANOVA is a special case of a linear mixed model</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="violations.html"><a href="violations.html#oneway-welch"><i class="fa fa-check"></i><b>12.2</b> Heterogeneity of variances</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="violations.html"><a href="violations.html#when-groups-of-the-focal-test-have-variance"><i class="fa fa-check"></i><b>12.2.1</b> When groups of the focal test have &gt;&gt; variance</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="violations.html"><a href="violations.html#the-conditional-response-isnt-normal"><i class="fa fa-check"></i><b>12.3</b> The conditional response isn’t Normal</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="violations.html"><a href="violations.html#violations-6f"><i class="fa fa-check"></i><b>12.3.1</b> Example 1 (fig6f) – Linear models for non-normal count data</a></li>
<li class="chapter" data-level="12.3.2" data-path="violations.html"><a href="violations.html#my-data-arent-normal-what-is-the-best-practice"><i class="fa fa-check"></i><b>12.3.2</b> My data aren’t normal, what is the best practice?</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="violations.html"><a href="violations.html#hidden-code-3"><i class="fa fa-check"></i><b>12.4</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-exp1b-data"><i class="fa fa-check"></i><b>12.4.1</b> Importing and wrangling the exp1b data</a></li>
<li class="chapter" data-level="12.4.2" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-exp2a-data"><i class="fa fa-check"></i><b>12.4.2</b> Importing and wrangling the exp2a data</a></li>
<li class="chapter" data-level="12.4.3" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-fig6f-data"><i class="fa fa-check"></i><b>12.4.3</b> Importing and wrangling the fig6f data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="issues.html"><a href="issues.html"><i class="fa fa-check"></i><b>13</b> Issues in inference</a>
<ul>
<li class="chapter" data-level="13.1" data-path="issues.html"><a href="issues.html#replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means"><i class="fa fa-check"></i><b>13.1</b> Replicated experiments – include <span class="math inline">\(\texttt{Experiment}\)</span> as a random factor (better than one-way ANOVA of means)</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="issues.html"><a href="issues.html#issues-exp4d"><i class="fa fa-check"></i><b>13.1.1</b> Multiple experiments Example 1 (wound healing Exp4d)</a></li>
<li class="chapter" data-level="13.1.2" data-path="issues.html"><a href="issues.html#issues-combined-experiments"><i class="fa fa-check"></i><b>13.1.2</b> Models for combining replicated experiments</a></li>
<li class="chapter" data-level="13.1.3" data-path="issues.html"><a href="issues.html#understanding-model-exp4d_m1"><i class="fa fa-check"></i><b>13.1.3</b> Understanding Model <code>exp4d_m1</code></a></li>
<li class="chapter" data-level="13.1.4" data-path="issues.html"><a href="issues.html#the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2"><i class="fa fa-check"></i><b>13.1.4</b> The univariate model is equivalent to a linear mixed model of the aggregated data (Model exp4d_m2)</a></li>
<li class="chapter" data-level="13.1.5" data-path="issues.html"><a href="issues.html#a-linear-mixed-model-of-the-full-data"><i class="fa fa-check"></i><b>13.1.5</b> A linear mixed model of the full data</a></li>
<li class="chapter" data-level="13.1.6" data-path="issues.html"><a href="issues.html#analysis-of-the-experiment-means-has-less-precision-and-power"><i class="fa fa-check"></i><b>13.1.6</b> Analysis of the experiment means has less precision and power</a></li>
<li class="chapter" data-level="13.1.7" data-path="issues.html"><a href="issues.html#dont-do-this-a-t-testfixed-effect-anova-of-the-full-data"><i class="fa fa-check"></i><b>13.1.7</b> Don’t do this – a t-test/fixed-effect ANOVA of the full data</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="issues.html"><a href="issues.html#issues-pre-post"><i class="fa fa-check"></i><b>13.2</b> Comparing change from baseline (pre-post)</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="issues.html"><a href="issues.html#pre-post-example-1-dpp4-fig4c"><i class="fa fa-check"></i><b>13.2.1</b> Pre-post example 1 (DPP4 fig4c)</a></li>
<li class="chapter" data-level="13.2.2" data-path="issues.html"><a href="issues.html#what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure"><i class="fa fa-check"></i><b>13.2.2</b> What if the data in example 1 were from from an experiment where the treatment was applied prior to the baseline measure?</a></li>
<li class="chapter" data-level="13.2.3" data-path="issues.html"><a href="issues.html#pre-post-example-2-xx-males-fig1c"><i class="fa fa-check"></i><b>13.2.3</b> Pre-post example 2 (XX males fig1c)</a></li>
<li class="chapter" data-level="13.2.4" data-path="issues.html"><a href="issues.html#issues-regression-to-mean"><i class="fa fa-check"></i><b>13.2.4</b> Regression to the mean</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="issues.html"><a href="issues.html#longitudinal-designs-with-more-than-one-post-baseline-measure"><i class="fa fa-check"></i><b>13.3</b> Longitudinal designs with more than one-post baseline measure</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="issues.html"><a href="issues.html#issues-auc"><i class="fa fa-check"></i><b>13.3.1</b> Area under the curve (AUC)</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="issues.html"><a href="issues.html#normalization-the-analysis-of-ratios"><i class="fa fa-check"></i><b>13.4</b> Normalization – the analysis of ratios</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="issues.html"><a href="issues.html#kinds-of-ratios-in-experimental-biology"><i class="fa fa-check"></i><b>13.4.1</b> Kinds of ratios in experimental biology</a></li>
<li class="chapter" data-level="13.4.2" data-path="issues.html"><a href="issues.html#issues-offset"><i class="fa fa-check"></i><b>13.4.2</b> Example 1 – The ratio is a density (number of something per area)</a></li>
<li class="chapter" data-level="13.4.3" data-path="issues.html"><a href="issues.html#issues-size"><i class="fa fa-check"></i><b>13.4.3</b> Example 2 – The ratio is normalizing for size differences</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="issues.html"><a href="issues.html#dont-do-this-stuff"><i class="fa fa-check"></i><b>13.5</b> Don’t do this stuff</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="issues.html"><a href="issues.html#normalize-the-response-so-that-all-control-values-are-equal-to-1."><i class="fa fa-check"></i><b>13.5.1</b> Normalize the response so that all control values are equal to 1.</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="issues.html"><a href="issues.html#a-difference-in-significance-is-not-necessarily-significant"><i class="fa fa-check"></i><b>13.6</b> A difference in significance is not necessarily significant</a></li>
<li class="chapter" data-level="13.7" data-path="issues.html"><a href="issues.html#researcher-degrees-of-freedom"><i class="fa fa-check"></i><b>13.7</b> Researcher degrees of freedom</a></li>
<li class="chapter" data-level="13.8" data-path="issues.html"><a href="issues.html#hidden-code-4"><i class="fa fa-check"></i><b>13.8</b> Hidden code</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="issues.html"><a href="issues.html#import-exp4d-vimentin-cell-count-data-replicate-experiments-example"><i class="fa fa-check"></i><b>13.8.1</b> Import exp4d vimentin cell count data (replicate experiments example)</a></li>
<li class="chapter" data-level="13.8.2" data-path="issues.html"><a href="issues.html#import-fig4c-data"><i class="fa fa-check"></i><b>13.8.2</b> Import Fig4c data</a></li>
<li class="chapter" data-level="13.8.3" data-path="issues.html"><a href="issues.html#xx-males-fig1c"><i class="fa fa-check"></i><b>13.8.3</b> XX males fig1c</a></li>
<li class="chapter" data-level="13.8.4" data-path="issues.html"><a href="issues.html#generation-of-fake-data-to-illustrate-regression-to-the-mean"><i class="fa fa-check"></i><b>13.8.4</b> Generation of fake data to illustrate regression to the mean</a></li>
<li class="chapter" data-level="13.8.5" data-path="issues.html"><a href="issues.html#import-fig3f"><i class="fa fa-check"></i><b>13.8.5</b> Import fig3f</a></li>
<li class="chapter" data-level="13.8.6" data-path="issues.html"><a href="issues.html#issues-import-exp3b"><i class="fa fa-check"></i><b>13.8.6</b> Import exp3b</a></li>
<li class="chapter" data-level="13.8.7" data-path="issues.html"><a href="issues.html#issues-exp3b-plot"><i class="fa fa-check"></i><b>13.8.7</b> Plot the model of exp3b (glm offset data)</a></li>
</ul></li>
</ul></li>
<li><a href="part-vi-more-than-one-x-multivariable-models.html#part-vi-more-than-one-x-multivariable-models">Part VI: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li class="chapter" data-level="14" data-path="covariates.html"><a href="covariates.html"><i class="fa fa-check"></i><b>14</b> Linear models with added covariates (“ANCOVA”)</a>
<ul>
<li class="chapter" data-level="14.1" data-path="covariates.html"><a href="covariates.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><i class="fa fa-check"></i><b>14.1</b> Adding covariates can increases the precision of the effect of interest</a></li>
<li class="chapter" data-level="14.2" data-path="covariates.html"><a href="covariates.html#understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data"><i class="fa fa-check"></i><b>14.2</b> Understanding a linear model with an added covariate – heart necrosis data</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="covariates.html"><a href="covariates.html#fit-the-model-5"><i class="fa fa-check"></i><b>14.2.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.2.2" data-path="covariates.html"><a href="covariates.html#plot-the-model-2"><i class="fa fa-check"></i><b>14.2.2</b> Plot the model</a></li>
<li class="chapter" data-level="14.2.3" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-model-coefficients"><i class="fa fa-check"></i><b>14.2.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.2.4" data-path="covariates.html"><a href="covariates.html#everything-adds-up"><i class="fa fa-check"></i><b>14.2.4</b> Everything adds up</a></li>
<li class="chapter" data-level="14.2.5" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-estimated-marginal-means"><i class="fa fa-check"></i><b>14.2.5</b> Interpretation of the estimated marginal means</a></li>
<li class="chapter" data-level="14.2.6" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-contrasts"><i class="fa fa-check"></i><b>14.2.6</b> Interpretation of the contrasts</a></li>
<li class="chapter" data-level="14.2.7" data-path="covariates.html"><a href="covariates.html#adding-the-covariate-improves-inference"><i class="fa fa-check"></i><b>14.2.7</b> Adding the covariate improves inference</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="covariates.html"><a href="covariates.html#understanding-interaction-effects-with-covariates"><i class="fa fa-check"></i><b>14.3</b> Understanding interaction effects with covariates</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="covariates.html"><a href="covariates.html#fit-the-model-6"><i class="fa fa-check"></i><b>14.3.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.3.2" data-path="covariates.html"><a href="covariates.html#plot-the-model-with-interaction-effect"><i class="fa fa-check"></i><b>14.3.2</b> Plot the model with interaction effect</a></li>
<li class="chapter" data-level="14.3.3" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-model-coefficients-1"><i class="fa fa-check"></i><b>14.3.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.3.4" data-path="covariates.html"><a href="covariates.html#what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends."><i class="fa fa-check"></i><b>14.3.4</b> What is the effect of a treatment, if interactions are modeled? – it depends.</a></li>
<li class="chapter" data-level="14.3.5" data-path="covariates.html"><a href="covariates.html#which-model-do-we-use-mathcalm_1-or-mathcalm_2"><i class="fa fa-check"></i><b>14.3.5</b> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="covariates.html"><a href="covariates.html#understanding-ancova-tables"><i class="fa fa-check"></i><b>14.4</b> Understanding ANCOVA tables</a></li>
<li class="chapter" data-level="14.5" data-path="covariates.html"><a href="covariates.html#working-in-r-3"><i class="fa fa-check"></i><b>14.5</b> Working in R</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="covariates.html"><a href="covariates.html#importing-the-heart-necrosis-data"><i class="fa fa-check"></i><b>14.5.1</b> Importing the heart necrosis data</a></li>
<li class="chapter" data-level="14.5.2" data-path="covariates.html"><a href="covariates.html#fitting-the-model"><i class="fa fa-check"></i><b>14.5.2</b> Fitting the model</a></li>
<li class="chapter" data-level="14.5.3" data-path="covariates.html"><a href="covariates.html#using-the-emmeans-function-1"><i class="fa fa-check"></i><b>14.5.3</b> Using the emmeans function</a></li>
<li class="chapter" data-level="14.5.4" data-path="covariates.html"><a href="covariates.html#ancova-tables"><i class="fa fa-check"></i><b>14.5.4</b> ANCOVA tables</a></li>
<li class="chapter" data-level="14.5.5" data-path="covariates.html"><a href="covariates.html#plotting-the-model"><i class="fa fa-check"></i><b>14.5.5</b> Plotting the model</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="covariates.html"><a href="covariates.html#best-practices"><i class="fa fa-check"></i><b>14.6</b> Best practices</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="covariates.html"><a href="covariates.html#do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate"><i class="fa fa-check"></i><b>14.6.1</b> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</a></li>
<li class="chapter" data-level="14.6.2" data-path="covariates.html"><a href="covariates.html#do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate"><i class="fa fa-check"></i><b>14.6.2</b> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</a></li>
<li class="chapter" data-level="14.6.3" data-path="covariates.html"><a href="covariates.html#do-not-test-for-balance-of-baseline-measures"><i class="fa fa-check"></i><b>14.6.3</b> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="covariates.html"><a href="covariates.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><i class="fa fa-check"></i><b>14.7</b> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="factorial.html"><a href="factorial.html"><i class="fa fa-check"></i><b>15</b> Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</a>
<ul>
<li class="chapter" data-level="15.1" data-path="factorial.html"><a href="factorial.html#a-linear-model-with-crossed-factors-estimates-interaction-effects"><i class="fa fa-check"></i><b>15.1</b> A linear model with crossed factors estimates interaction effects</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="factorial.html"><a href="factorial.html#an-interaction-is-a-difference-in-simple-effects"><i class="fa fa-check"></i><b>15.1.1</b> An interaction is a difference in simple effects</a></li>
<li class="chapter" data-level="15.1.2" data-path="factorial.html"><a href="factorial.html#a-linear-model-with-crossed-factors-includes-interaction-effects"><i class="fa fa-check"></i><b>15.1.2</b> A linear model with crossed factors includes interaction effects</a></li>
<li class="chapter" data-level="15.1.3" data-path="factorial.html"><a href="factorial.html#factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature"><i class="fa fa-check"></i><b>15.1.3</b> factorial experiments are frequently analyzed as flattened linear models in the experimental biology literature</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="factorial.html"><a href="factorial.html#example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data"><i class="fa fa-check"></i><b>15.2</b> Example 1 – Estimation of a treatment effect relative to a control effect (“Something different”) (Experiment 2j glucose uptake data)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="factorial.html"><a href="factorial.html#twoway-understand1"><i class="fa fa-check"></i><b>15.2.1</b> Understand the experimental design</a></li>
<li class="chapter" data-level="15.2.2" data-path="factorial.html"><a href="factorial.html#fit-the-linear-model"><i class="fa fa-check"></i><b>15.2.2</b> Fit the linear model</a></li>
<li class="chapter" data-level="15.2.3" data-path="factorial.html"><a href="factorial.html#twoway-exp2j-inf"><i class="fa fa-check"></i><b>15.2.3</b> Inference</a></li>
<li class="chapter" data-level="15.2.4" data-path="factorial.html"><a href="factorial.html#plot-the-model-3"><i class="fa fa-check"></i><b>15.2.4</b> Plot the model</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-1"><i class="fa fa-check"></i><b>15.3</b> Understanding the linear model with crossed factors 1</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="factorial.html"><a href="factorial.html#twoway-what-coefs-are"><i class="fa fa-check"></i><b>15.3.1</b> What the coefficients are</a></li>
<li class="chapter" data-level="15.3.2" data-path="factorial.html"><a href="factorial.html#the-interaction-effect-is-something-different"><i class="fa fa-check"></i><b>15.3.2</b> The interaction effect is something different</a></li>
<li class="chapter" data-level="15.3.3" data-path="factorial.html"><a href="factorial.html#why-we-want-to-compare-the-treatment-effect-to-a-control-effect"><i class="fa fa-check"></i><b>15.3.3</b> Why we want to compare the treatment effect to a control effect</a></li>
<li class="chapter" data-level="15.3.4" data-path="factorial.html"><a href="factorial.html#the-order-of-the-factors-in-the-model-tells-the-same-story-differently"><i class="fa fa-check"></i><b>15.3.4</b> The order of the factors in the model tells the same story differently</a></li>
<li class="chapter" data-level="15.3.5" data-path="factorial.html"><a href="factorial.html#power-for-the-interaction-effect-is-less-than-that-for-simple-effects"><i class="fa fa-check"></i><b>15.3.5</b> Power for the interaction effect is less than that for simple effects</a></li>
<li class="chapter" data-level="15.3.6" data-path="factorial.html"><a href="factorial.html#planned-comparisons-vs.-post-hoc-tests"><i class="fa fa-check"></i><b>15.3.6</b> Planned comparisons vs. post-hoc tests</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="factorial.html"><a href="factorial.html#example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data"><i class="fa fa-check"></i><b>15.4</b> Example 2: Estimation of the effect of background condition on an effect (“it depends”) (Experiment 3e lesian area data)</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="factorial.html"><a href="factorial.html#understand-the-experimental-design"><i class="fa fa-check"></i><b>15.4.1</b> Understand the experimental design</a></li>
<li class="chapter" data-level="15.4.2" data-path="factorial.html"><a href="factorial.html#fit-the-linear-model-1"><i class="fa fa-check"></i><b>15.4.2</b> Fit the linear model</a></li>
<li class="chapter" data-level="15.4.3" data-path="factorial.html"><a href="factorial.html#check-the-model-1"><i class="fa fa-check"></i><b>15.4.3</b> Check the model</a></li>
<li class="chapter" data-level="15.4.4" data-path="factorial.html"><a href="factorial.html#inference-from-the-model-2"><i class="fa fa-check"></i><b>15.4.4</b> Inference from the model</a></li>
<li class="chapter" data-level="15.4.5" data-path="factorial.html"><a href="factorial.html#plot-the-model-4"><i class="fa fa-check"></i><b>15.4.5</b> Plot the model</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-2"><i class="fa fa-check"></i><b>15.5</b> Understanding the linear model with crossed factors 2</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="factorial.html"><a href="factorial.html#twoway-marginal-means"><i class="fa fa-check"></i><b>15.5.1</b> Conditional and marginal means</a></li>
<li class="chapter" data-level="15.5.2" data-path="factorial.html"><a href="factorial.html#simple-conditional-effects"><i class="fa fa-check"></i><b>15.5.2</b> Simple (conditional) effects</a></li>
<li class="chapter" data-level="15.5.3" data-path="factorial.html"><a href="factorial.html#twoway-marginal-effects"><i class="fa fa-check"></i><b>15.5.3</b> Marginal effects</a></li>
<li class="chapter" data-level="15.5.4" data-path="factorial.html"><a href="factorial.html#the-additive-model"><i class="fa fa-check"></i><b>15.5.4</b> The additive model</a></li>
<li class="chapter" data-level="15.5.5" data-path="factorial.html"><a href="factorial.html#twoway-reduce"><i class="fa fa-check"></i><b>15.5.5</b> Reduce models for the right reason</a></li>
<li class="chapter" data-level="15.5.6" data-path="factorial.html"><a href="factorial.html#the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird"><i class="fa fa-check"></i><b>15.5.6</b> The marginal means of an additive linear model with two factors can be weird</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="factorial.html"><a href="factorial.html#example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data"><i class="fa fa-check"></i><b>15.6</b> Example 3: Estimation of synergy (“More than the sum of the parts”) (Experiment 1c JA data)</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="factorial.html"><a href="factorial.html#examine-the-data"><i class="fa fa-check"></i><b>15.6.1</b> Examine the data</a></li>
<li class="chapter" data-level="15.6.2" data-path="factorial.html"><a href="factorial.html#fit-the-model-7"><i class="fa fa-check"></i><b>15.6.2</b> Fit the model</a></li>
<li class="chapter" data-level="15.6.3" data-path="factorial.html"><a href="factorial.html#model-check"><i class="fa fa-check"></i><b>15.6.3</b> Model check</a></li>
<li class="chapter" data-level="15.6.4" data-path="factorial.html"><a href="factorial.html#inference-from-the-model-3"><i class="fa fa-check"></i><b>15.6.4</b> Inference from the model</a></li>
<li class="chapter" data-level="15.6.5" data-path="factorial.html"><a href="factorial.html#plot-the-model-5"><i class="fa fa-check"></i><b>15.6.5</b> Plot the model</a></li>
<li class="chapter" data-level="15.6.6" data-path="factorial.html"><a href="factorial.html#alternative-plot"><i class="fa fa-check"></i><b>15.6.6</b> Alternative plot</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-3"><i class="fa fa-check"></i><b>15.7</b> Understanding the linear model with crossed factors 3</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="factorial.html"><a href="factorial.html#thinking-about-the-coefficients-of-the-linear-model"><i class="fa fa-check"></i><b>15.7.1</b> Thinking about the coefficients of the linear model</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="factorial.html"><a href="factorial.html#issues-in-inference"><i class="fa fa-check"></i><b>15.8</b> Issues in inference</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="factorial.html"><a href="factorial.html#for-pairwise-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><i class="fa fa-check"></i><b>15.8.1</b> For pairwise contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li class="chapter" data-level="15.8.2" data-path="factorial.html"><a href="factorial.html#for-interaction-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><i class="fa fa-check"></i><b>15.8.2</b> For interaction contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li class="chapter" data-level="15.8.3" data-path="factorial.html"><a href="factorial.html#twoway-multiple-tests"><i class="fa fa-check"></i><b>15.8.3</b> Adjusting <em>p</em>-values for multiple tests</a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="factorial.html"><a href="factorial.html#two-way-anova"><i class="fa fa-check"></i><b>15.9</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="15.9.1" data-path="factorial.html"><a href="factorial.html#how-to-read-a-two-way-anova-table"><i class="fa fa-check"></i><b>15.9.1</b> How to read a two-way ANOVA table</a></li>
<li class="chapter" data-level="15.9.2" data-path="factorial.html"><a href="factorial.html#what-do-the-main-effects-in-an-anova-table-mean"><i class="fa fa-check"></i><b>15.9.2</b> What do the main effects in an ANOVA table mean?</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="factorial.html"><a href="factorial.html#more-issues-in-inference"><i class="fa fa-check"></i><b>15.10</b> More issues in inference</a>
<ul>
<li class="chapter" data-level="15.10.1" data-path="factorial.html"><a href="factorial.html#longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova"><i class="fa fa-check"></i><b>15.10.1</b> Longitudinal experiments – include Time as a random factor (better than repeated measures ANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="factorial.html"><a href="factorial.html#working-in-r-4"><i class="fa fa-check"></i><b>15.11</b> Working in R</a>
<ul>
<li class="chapter" data-level="15.11.1" data-path="factorial.html"><a href="factorial.html#model-formula"><i class="fa fa-check"></i><b>15.11.1</b> Model formula</a></li>
<li class="chapter" data-level="15.11.2" data-path="factorial.html"><a href="factorial.html#using-the-emmeans-function-2"><i class="fa fa-check"></i><b>15.11.2</b> Using the emmeans function</a></li>
<li class="chapter" data-level="15.11.3" data-path="factorial.html"><a href="factorial.html#contrasts"><i class="fa fa-check"></i><b>15.11.3</b> Contrasts</a></li>
<li class="chapter" data-level="15.11.4" data-path="factorial.html"><a href="factorial.html#practice-safe-anova"><i class="fa fa-check"></i><b>15.11.4</b> Practice safe ANOVA</a></li>
<li class="chapter" data-level="15.11.5" data-path="factorial.html"><a href="factorial.html#better-to-avoid-these"><i class="fa fa-check"></i><b>15.11.5</b> Better to avoid these</a></li>
</ul></li>
<li class="chapter" data-level="15.12" data-path="factorial.html"><a href="factorial.html#hidden-code-5"><i class="fa fa-check"></i><b>15.12</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="15.12.1" data-path="factorial.html"><a href="factorial.html#import-exp2j-example-1"><i class="fa fa-check"></i><b>15.12.1</b> Import exp2j (Example 1)</a></li>
<li class="chapter" data-level="15.12.2" data-path="factorial.html"><a href="factorial.html#import-exp3e-lesian-area-data-example-2"><i class="fa fa-check"></i><b>15.12.2</b> Import exp3e lesian area data (Example 2)</a></li>
<li class="chapter" data-level="15.12.3" data-path="factorial.html"><a href="factorial.html#import-exp1c-ja-data-example-3"><i class="fa fa-check"></i><b>15.12.3</b> Import Exp1c JA data (Example 3)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-vii-expanding-the-linear-model.html"><a href="part-vii-expanding-the-linear-model.html"><i class="fa fa-check"></i>Part VII – Expanding the Linear Model</a></li>
<li class="chapter" data-level="16" data-path="lmm.html"><a href="lmm.html"><i class="fa fa-check"></i><b>16</b> Models with random factors – linear mixed models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="lmm.html"><a href="lmm.html#lmm-demo"><i class="fa fa-check"></i><b>16.1</b> Example 1 – A random intercepts and slopes explainer (demo1)</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="lmm.html"><a href="lmm.html#batched-measurements-result-in-clustered-residuals"><i class="fa fa-check"></i><b>16.1.1</b> Batched measurements result in clustered residuals</a></li>
<li class="chapter" data-level="16.1.2" data-path="lmm.html"><a href="lmm.html#lmm-corerr"><i class="fa fa-check"></i><b>16.1.2</b> Clustered residuals result in correlated error</a></li>
<li class="chapter" data-level="16.1.3" data-path="lmm.html"><a href="lmm.html#in-blocked-designs-clustered-residuals-adds-a-variance-component-that-masks-treatment-effects"><i class="fa fa-check"></i><b>16.1.3</b> In blocked designs, clustered residuals adds a variance component that masks treatment effects</a></li>
<li class="chapter" data-level="16.1.4" data-path="lmm.html"><a href="lmm.html#linear-mixed-models-are-linear-models-with-added-random-factors"><i class="fa fa-check"></i><b>16.1.4</b> Linear mixed models are linear models with added random factors</a></li>
<li class="chapter" data-level="16.1.5" data-path="lmm.html"><a href="lmm.html#what-the-random-effects-are"><i class="fa fa-check"></i><b>16.1.5</b> What the random effects are</a></li>
<li class="chapter" data-level="16.1.6" data-path="lmm.html"><a href="lmm.html#in-a-blocked-design-a-linear-model-with-added-random-effects-increases-precision-of-treatment-effects"><i class="fa fa-check"></i><b>16.1.6</b> In a blocked design, a linear model with added random effects increases precision of treatment effects</a></li>
<li class="chapter" data-level="16.1.7" data-path="lmm.html"><a href="lmm.html#lmm-varcorr"><i class="fa fa-check"></i><b>16.1.7</b> The correlation among random intercepts and slopes</a></li>
<li class="chapter" data-level="16.1.8" data-path="lmm.html"><a href="lmm.html#clustered-residuals-create-heterogeneity-among-treatments"><i class="fa fa-check"></i><b>16.1.8</b> Clustered residuals create heterogeneity among treatments</a></li>
<li class="chapter" data-level="16.1.9" data-path="lmm.html"><a href="lmm.html#linear-mixed-models-are-flexible"><i class="fa fa-check"></i><b>16.1.9</b> Linear mixed models are flexible</a></li>
<li class="chapter" data-level="16.1.10" data-path="lmm.html"><a href="lmm.html#a-random-intercept-only-model"><i class="fa fa-check"></i><b>16.1.10</b> A random intercept only model</a></li>
<li class="chapter" data-level="16.1.11" data-path="lmm.html"><a href="lmm.html#a-model-including-an-interaction-intercept"><i class="fa fa-check"></i><b>16.1.11</b> A model including an interaction intercept</a></li>
<li class="chapter" data-level="16.1.12" data-path="lmm.html"><a href="lmm.html#lmm-demo-aic"><i class="fa fa-check"></i><b>16.1.12</b> AIC and model selection – which model to report?</a></li>
<li class="chapter" data-level="16.1.13" data-path="lmm.html"><a href="lmm.html#the-specification-of-random-effects-matters"><i class="fa fa-check"></i><b>16.1.13</b> The specification of random effects matters</a></li>
<li class="chapter" data-level="16.1.14" data-path="lmm.html"><a href="lmm.html#mixed-effect-and-repeated-measures-anova"><i class="fa fa-check"></i><b>16.1.14</b> Mixed Effect and Repeated Measures ANOVA</a></li>
<li class="chapter" data-level="16.1.15" data-path="lmm.html"><a href="lmm.html#pseudoreplication"><i class="fa fa-check"></i><b>16.1.15</b> Pseudoreplication</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="lmm.html"><a href="lmm.html#lmm-example2"><i class="fa fa-check"></i><b>16.2</b> Example 2 – experiments without subsampling replication (exp6g)</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="lmm.html"><a href="lmm.html#understand-the-data"><i class="fa fa-check"></i><b>16.2.1</b> Understand the data</a></li>
<li class="chapter" data-level="16.2.2" data-path="lmm.html"><a href="lmm.html#model-fit-and-inference"><i class="fa fa-check"></i><b>16.2.2</b> Model fit and inference</a></li>
<li class="chapter" data-level="16.2.3" data-path="lmm.html"><a href="lmm.html#the-model-exp6g_m1-adds-a-random-intercept-but-not-a-random-slope"><i class="fa fa-check"></i><b>16.2.3</b> The model exp6g_m1 adds a random intercept but not a random slope</a></li>
<li class="chapter" data-level="16.2.4" data-path="lmm.html"><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp6g_m1"><i class="fa fa-check"></i><b>16.2.4</b> The fixed effect coefficients of model exp6g_m1</a></li>
<li class="chapter" data-level="16.2.5" data-path="lmm.html"><a href="lmm.html#the-random-intercept-coefficients-of-exp6g_m1"><i class="fa fa-check"></i><b>16.2.5</b> The random intercept coefficients of exp6g_m1</a></li>
<li class="chapter" data-level="16.2.6" data-path="lmm.html"><a href="lmm.html#the-random-and-residual-variance-and-the-intraclass-correlation-of-model-exp6g_m1"><i class="fa fa-check"></i><b>16.2.6</b> The random and residual variance and the intraclass correlation of model exp6g_m1</a></li>
<li class="chapter" data-level="16.2.7" data-path="lmm.html"><a href="lmm.html#the-linear-mixed-model-exp6g_m1-increases-precision-of-treatment-effects-relative-to-a-fixed-effects-model"><i class="fa fa-check"></i><b>16.2.7</b> The linear mixed model exp6g_m1 increases precision of treatment effects, relative to a fixed effects model</a></li>
<li class="chapter" data-level="16.2.8" data-path="lmm.html"><a href="lmm.html#lmm-exp6g-alt"><i class="fa fa-check"></i><b>16.2.8</b> Alternative models for exp6g</a></li>
<li class="chapter" data-level="16.2.9" data-path="lmm.html"><a href="lmm.html#paired-t-tests-and-repeated-measures-anova-are-special-cases-of-linear-mixed-models"><i class="fa fa-check"></i><b>16.2.9</b> Paired t-tests and repeated measures ANOVA are special cases of linear mixed models</a></li>
<li class="chapter" data-level="16.2.10" data-path="lmm.html"><a href="lmm.html#lmm-exp6g-rmanova"><i class="fa fa-check"></i><b>16.2.10</b> Classical (“univariate model”) repeated measures ANOVA of exp6g</a></li>
<li class="chapter" data-level="16.2.11" data-path="lmm.html"><a href="lmm.html#lmm-exp6g-rmanova-multi"><i class="fa fa-check"></i><b>16.2.11</b> “Multivariate model” repeated measures ANOVA</a></li>
<li class="chapter" data-level="16.2.12" data-path="lmm.html"><a href="lmm.html#linear-mixed-models-vs-repeated-measures-anova"><i class="fa fa-check"></i><b>16.2.12</b> Linear mixed models vs repeated measures ANOVA</a></li>
<li class="chapter" data-level="16.2.13" data-path="lmm.html"><a href="lmm.html#modeling-textttmouse_id-as-a-fixed-effect"><i class="fa fa-check"></i><b>16.2.13</b> Modeling <span class="math inline">\(\texttt{mouse_id}\)</span> as a fixed effect</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="lmm.html"><a href="lmm.html#example-3-factorial-experiments-and-no-subsampling-replicates-exp5c"><i class="fa fa-check"></i><b>16.3</b> Example 3 – Factorial experiments and no subsampling replicates (exp5c)</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="lmm.html"><a href="lmm.html#understand-the-data-1"><i class="fa fa-check"></i><b>16.3.1</b> Understand the data</a></li>
<li class="chapter" data-level="16.3.2" data-path="lmm.html"><a href="lmm.html#examine-the-data-1"><i class="fa fa-check"></i><b>16.3.2</b> Examine the data</a></li>
<li class="chapter" data-level="16.3.3" data-path="lmm.html"><a href="lmm.html#lmm-exp5c-m1"><i class="fa fa-check"></i><b>16.3.3</b> Model fit and inference</a></li>
<li class="chapter" data-level="16.3.4" data-path="lmm.html"><a href="lmm.html#why-we-care-about-modeling-batch-in-exp5c"><i class="fa fa-check"></i><b>16.3.4</b> Why we care about modeling batch in exp5c</a></li>
<li class="chapter" data-level="16.3.5" data-path="lmm.html"><a href="lmm.html#the-linear-mixed-model-exp5c_m1-adds-two-random-intercepts"><i class="fa fa-check"></i><b>16.3.5</b> The linear mixed model exp5c_m1 adds two random intercepts</a></li>
<li class="chapter" data-level="16.3.6" data-path="lmm.html"><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp5c_m1"><i class="fa fa-check"></i><b>16.3.6</b> The fixed effect coefficients of model exp5c_m1</a></li>
<li class="chapter" data-level="16.3.7" data-path="lmm.html"><a href="lmm.html#the-random-effect-coefficients-of-model-exp5c_m1"><i class="fa fa-check"></i><b>16.3.7</b> The random effect coefficients of model exp5c_m1</a></li>
<li class="chapter" data-level="16.3.8" data-path="lmm.html"><a href="lmm.html#lmm-exp5c-alt"><i class="fa fa-check"></i><b>16.3.8</b> Alternative models for exp5c</a></li>
<li class="chapter" data-level="16.3.9" data-path="lmm.html"><a href="lmm.html#lmm-rmanova-5c"><i class="fa fa-check"></i><b>16.3.9</b> Classical (“univariate model”) repeated measures ANOVA</a></li>
<li class="chapter" data-level="16.3.10" data-path="lmm.html"><a href="lmm.html#lmm-rmanova-5c-multi"><i class="fa fa-check"></i><b>16.3.10</b> “Multivariate model” repeated measures ANOVA of exp5c</a></li>
<li class="chapter" data-level="16.3.11" data-path="lmm.html"><a href="lmm.html#modeling-textttdonor-as-a-fixed-effect"><i class="fa fa-check"></i><b>16.3.11</b> Modeling <span class="math inline">\(\texttt{donor}\)</span> as a fixed effect</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="lmm.html"><a href="lmm.html#lmm-example4"><i class="fa fa-check"></i><b>16.4</b> Example 4 – Experiments with subsampling replication (exp1g)</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="lmm.html"><a href="lmm.html#understand-the-data-2"><i class="fa fa-check"></i><b>16.4.1</b> Understand the data</a></li>
<li class="chapter" data-level="16.4.2" data-path="lmm.html"><a href="lmm.html#examine-the-data-2"><i class="fa fa-check"></i><b>16.4.2</b> Examine the data</a></li>
<li class="chapter" data-level="16.4.3" data-path="lmm.html"><a href="lmm.html#fit-the-model-9"><i class="fa fa-check"></i><b>16.4.3</b> Fit the model</a></li>
<li class="chapter" data-level="16.4.4" data-path="lmm.html"><a href="lmm.html#inference-from-the-model-6"><i class="fa fa-check"></i><b>16.4.4</b> Inference from the model</a></li>
<li class="chapter" data-level="16.4.5" data-path="lmm.html"><a href="lmm.html#plot-the-model-6"><i class="fa fa-check"></i><b>16.4.5</b> Plot the model</a></li>
<li class="chapter" data-level="16.4.6" data-path="lmm.html"><a href="lmm.html#alternaplot-the-model-2"><i class="fa fa-check"></i><b>16.4.6</b> Alternaplot the model</a></li>
<li class="chapter" data-level="16.4.7" data-path="lmm.html"><a href="lmm.html#understanding-the-alternative-models"><i class="fa fa-check"></i><b>16.4.7</b> Understanding the alternative models</a></li>
<li class="chapter" data-level="16.4.8" data-path="lmm.html"><a href="lmm.html#the-varcorr-matrix-of-models-exp1g_m1a-and-exp1g_m1b"><i class="fa fa-check"></i><b>16.4.8</b> The VarCorr matrix of models exp1g_m1a and exp1g_m1b</a></li>
<li class="chapter" data-level="16.4.9" data-path="lmm.html"><a href="lmm.html#the-linear-mixed-model-has-more-precision-and-power-than-the-fixed-effect-model-of-batch-means"><i class="fa fa-check"></i><b>16.4.9</b> The linear mixed model has more precision and power than the fixed effect model of batch means</a></li>
<li class="chapter" data-level="16.4.10" data-path="lmm.html"><a href="lmm.html#fixed-effect-models-and-pseudoreplication"><i class="fa fa-check"></i><b>16.4.10</b> Fixed effect models and pseudoreplication</a></li>
<li class="chapter" data-level="16.4.11" data-path="lmm.html"><a href="lmm.html#mixed-effect-anova"><i class="fa fa-check"></i><b>16.4.11</b> Mixed-effect ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="lmm.html"><a href="lmm.html#working-in-r-5"><i class="fa fa-check"></i><b>16.5</b> Working in R</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="lmm.html"><a href="lmm.html#fitting-linear-mixed-models"><i class="fa fa-check"></i><b>16.5.1</b> Fitting linear mixed models</a></li>
<li class="chapter" data-level="16.5.2" data-path="lmm.html"><a href="lmm.html#plotting-models-fit-to-batched-data"><i class="fa fa-check"></i><b>16.5.2</b> Plotting models fit to batched data</a></li>
<li class="chapter" data-level="16.5.3" data-path="lmm.html"><a href="lmm.html#repeated-measures-anova-randomized-complete-block-with-no-subsampling"><i class="fa fa-check"></i><b>16.5.3</b> Repeated measures ANOVA (randomized complete block with no subsampling)</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="lmm.html"><a href="lmm.html#hidden-code-6"><i class="fa fa-check"></i><b>16.6</b> Hidden code</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="lmm.html"><a href="lmm.html#import-exp5c"><i class="fa fa-check"></i><b>16.6.1</b> Import exp5c</a></li>
<li class="chapter" data-level="16.6.2" data-path="lmm.html"><a href="lmm.html#import-exp1g"><i class="fa fa-check"></i><b>16.6.2</b> Import exp1g</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="pre-post.html"><a href="pre-post.html"><i class="fa fa-check"></i><b>17</b> Linear models for longitudinal experiments – I. pre-post designs</a>
<ul>
<li class="chapter" data-level="17.1" data-path="pre-post.html"><a href="pre-post.html#best-practice-models"><i class="fa fa-check"></i><b>17.1</b> Best practice models</a></li>
<li class="chapter" data-level="17.2" data-path="pre-post.html"><a href="pre-post.html#common-alternatives-that-are-not-recommended"><i class="fa fa-check"></i><b>17.2</b> Common alternatives that are not recommended</a></li>
<li class="chapter" data-level="17.3" data-path="pre-post.html"><a href="pre-post.html#advanced-models"><i class="fa fa-check"></i><b>17.3</b> Advanced models</a></li>
<li class="chapter" data-level="17.4" data-path="pre-post.html"><a href="pre-post.html#understanding-the-alternative-models-1"><i class="fa fa-check"></i><b>17.4</b> Understanding the alternative models</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="pre-post.html"><a href="pre-post.html#m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model"><i class="fa fa-check"></i><b>17.4.1</b> (M1) Linear model with the baseline measure as the covariate (ANCOVA model)</a></li>
<li class="chapter" data-level="17.4.2" data-path="pre-post.html"><a href="pre-post.html#m2-linear-model-of-the-change-score-change-score-model"><i class="fa fa-check"></i><b>17.4.2</b> (M2) Linear model of the change score (change-score model)</a></li>
<li class="chapter" data-level="17.4.3" data-path="pre-post.html"><a href="pre-post.html#m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model"><i class="fa fa-check"></i><b>17.4.3</b> (M3) Linear model of post-baseline values without the baseline as a covariate (post model)</a></li>
<li class="chapter" data-level="17.4.4" data-path="pre-post.html"><a href="pre-post.html#m4-linear-model-with-factorial-fixed-effects-fixed-effects-model"><i class="fa fa-check"></i><b>17.4.4</b> (M4) Linear model with factorial fixed effects (fixed-effects model)</a></li>
<li class="chapter" data-level="17.4.5" data-path="pre-post.html"><a href="pre-post.html#m5-repeated-measures-anova"><i class="fa fa-check"></i><b>17.4.5</b> (M5) Repeated measures ANOVA</a></li>
<li class="chapter" data-level="17.4.6" data-path="pre-post.html"><a href="pre-post.html#m6-linear-mixed-model"><i class="fa fa-check"></i><b>17.4.6</b> (M6) Linear mixed model</a></li>
<li class="chapter" data-level="17.4.7" data-path="pre-post.html"><a href="pre-post.html#m7-linear-model-with-correlated-error"><i class="fa fa-check"></i><b>17.4.7</b> (M7) Linear model with correlated error</a></li>
<li class="chapter" data-level="17.4.8" data-path="pre-post.html"><a href="pre-post.html#m8-constrained-fixed-effects-model-with-correlated-error-clda-model"><i class="fa fa-check"></i><b>17.4.8</b> (M8) Constrained fixed effects model with correlated error (cLDA model)</a></li>
<li class="chapter" data-level="17.4.9" data-path="pre-post.html"><a href="pre-post.html#comparison-table"><i class="fa fa-check"></i><b>17.4.9</b> Comparison table</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="pre-post.html"><a href="pre-post.html#example-1-a-single-post-baseline-measure-pre-post-design"><i class="fa fa-check"></i><b>17.5</b> Example 1 – a single post-baseline measure (pre-post design)</a></li>
<li class="chapter" data-level="17.6" data-path="pre-post.html"><a href="pre-post.html#working-in-r-6"><i class="fa fa-check"></i><b>17.6</b> Working in R</a></li>
<li class="chapter" data-level="17.7" data-path="pre-post.html"><a href="pre-post.html#hidden-code-7"><i class="fa fa-check"></i><b>17.7</b> Hidden code</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="pre-post.html"><a href="pre-post.html#import-and-wrangle-mouse-sociability-data"><i class="fa fa-check"></i><b>17.7.1</b> Import and wrangle mouse sociability data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="counts.html"><a href="counts.html"><i class="fa fa-check"></i><b>18</b> Linear models for counts, binary responses, skewed responses, and ratios – Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="18.1" data-path="counts.html"><a href="counts.html#glm-counts"><i class="fa fa-check"></i><b>18.1</b> Introducing Generalized Linear Models using count data examples</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="counts.html"><a href="counts.html#the-generalized-linear-model-glm"><i class="fa fa-check"></i><b>18.1.1</b> The Generalized Linear Model (GLM)</a></li>
<li class="chapter" data-level="18.1.2" data-path="counts.html"><a href="counts.html#kinds-of-data-that-are-modeled-by-a-glm"><i class="fa fa-check"></i><b>18.1.2</b> Kinds of data that are modeled by a GLM</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="counts.html"><a href="counts.html#glm-1"><i class="fa fa-check"></i><b>18.2</b> Example 1 – GLM models for count responses (“angiogenic sprouts” exp3a)</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="counts.html"><a href="counts.html#understand-the-data-3"><i class="fa fa-check"></i><b>18.2.1</b> Understand the data</a></li>
<li class="chapter" data-level="18.2.2" data-path="counts.html"><a href="counts.html#model-fit-and-inference-1"><i class="fa fa-check"></i><b>18.2.2</b> Model fit and inference</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="counts.html"><a href="counts.html#understanding-example-1"><i class="fa fa-check"></i><b>18.3</b> Understanding Example 1</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="counts.html"><a href="counts.html#modeling-strategy-1"><i class="fa fa-check"></i><b>18.3.1</b> Modeling strategy</a></li>
<li class="chapter" data-level="18.3.2" data-path="counts.html"><a href="counts.html#model-checking-fits-to-count-data"><i class="fa fa-check"></i><b>18.3.2</b> Model checking fits to count data</a></li>
<li class="chapter" data-level="18.3.3" data-path="counts.html"><a href="counts.html#biological-count-data-are-rarely-fit-well-by-a-poisson-glm.-instead-fit-a-quasi-poisson-or-negative-binomial-glm-model."><i class="fa fa-check"></i><b>18.3.3</b> Biological count data are rarely fit well by a Poisson GLM. Instead, fit a quasi-poisson or negative binomial GLM model.</a></li>
<li class="chapter" data-level="18.3.4" data-path="counts.html"><a href="counts.html#a-glm-is-a-linear-model-on-the-link-scale"><i class="fa fa-check"></i><b>18.3.4</b> A GLM is a linear model on the link scale</a></li>
<li class="chapter" data-level="18.3.5" data-path="counts.html"><a href="counts.html#coeffecients-of-a-generalized-linear-model-with-a-log-link-function-are-on-the-link-scale."><i class="fa fa-check"></i><b>18.3.5</b> Coeffecients of a Generalized Linear Model with a log-link function are on the link scale.</a></li>
<li class="chapter" data-level="18.3.6" data-path="counts.html"><a href="counts.html#modeled-means-in-the-emmeans-table-of-a-generalized-linear-model-can-be-on-the-link-scale-or-response-scale-report-the-response-scale"><i class="fa fa-check"></i><b>18.3.6</b> Modeled means in the emmeans table of a Generalized Linear Model can be on the link scale or response scale – Report the response scale</a></li>
<li class="chapter" data-level="18.3.7" data-path="counts.html"><a href="counts.html#some-consequences-of-fitting-a-linear-model-to-count-data"><i class="fa fa-check"></i><b>18.3.7</b> Some consequences of fitting a linear model to count data</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="counts.html"><a href="counts.html#example-2-use-a-glm-with-an-offset-instead-of-a-ratio-of-some-measurement-per-area-dna-damage-data-exp3b"><i class="fa fa-check"></i><b>18.4</b> Example 2 – Use a GLM with an offset instead of a ratio of some measurement per area (“dna damage” data exp3b)</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="counts.html"><a href="counts.html#exp3b-dna-damage-data"><i class="fa fa-check"></i><b>18.4.1</b> exp3b (“dna damage”) data</a></li>
<li class="chapter" data-level="18.4.2" data-path="counts.html"><a href="counts.html#understand-the-data-4"><i class="fa fa-check"></i><b>18.4.2</b> Understand the data</a></li>
<li class="chapter" data-level="18.4.3" data-path="counts.html"><a href="counts.html#model-fit-and-inference-2"><i class="fa fa-check"></i><b>18.4.3</b> Model fit and inference</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="counts.html"><a href="counts.html#understanding-example-2"><i class="fa fa-check"></i><b>18.5</b> Understanding Example 2</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="counts.html"><a href="counts.html#an-offset-is-an-added-covariate-with-a-coefficient-fixed-at-1"><i class="fa fa-check"></i><b>18.5.1</b> An offset is an added covariate with a coefficient fixed at 1</a></li>
<li class="chapter" data-level="18.5.2" data-path="counts.html"><a href="counts.html#glm-rate"><i class="fa fa-check"></i><b>18.5.2</b> A count GLM with an offset models the area-normalized means</a></li>
<li class="chapter" data-level="18.5.3" data-path="counts.html"><a href="counts.html#compare-an-offset-to-an-added-covariate-with-an-estimated-coefficient"><i class="fa fa-check"></i><b>18.5.3</b> Compare an offset to an added covariate with an estimated coefficient</a></li>
<li class="chapter" data-level="18.5.4" data-path="counts.html"><a href="counts.html#issues-with-plotting"><i class="fa fa-check"></i><b>18.5.4</b> Issues with plotting</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="counts.html"><a href="counts.html#example-3-glm-models-for-binary-responses"><i class="fa fa-check"></i><b>18.6</b> Example 3 – GLM models for binary responses</a></li>
<li class="chapter" data-level="18.7" data-path="counts.html"><a href="counts.html#working-in-r-7"><i class="fa fa-check"></i><b>18.7</b> Working in R</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="counts.html"><a href="counts.html#fitting-glms-to-count-data"><i class="fa fa-check"></i><b>18.7.1</b> Fitting GLMs to count data</a></li>
<li class="chapter" data-level="18.7.2" data-path="counts.html"><a href="counts.html#fitting-a-glm-to-a-continuous-conditional-response-with-right-skew."><i class="fa fa-check"></i><b>18.7.2</b> Fitting a GLM to a continuous conditional response with right skew.</a></li>
<li class="chapter" data-level="18.7.3" data-path="counts.html"><a href="counts.html#fitting-a-glm-to-a-binary-success-or-failure-presence-or-absence-survived-or-died-response"><i class="fa fa-check"></i><b>18.7.3</b> Fitting a GLM to a binary (success or failure, presence or absence, survived or died) response</a></li>
<li class="chapter" data-level="18.7.4" data-path="counts.html"><a href="counts.html#fitting-generalized-linear-mixed-models"><i class="fa fa-check"></i><b>18.7.4</b> Fitting Generalized Linear Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="counts.html"><a href="counts.html#model-checking-glms"><i class="fa fa-check"></i><b>18.8</b> Model checking GLMs</a></li>
<li class="chapter" data-level="18.9" data-path="counts.html"><a href="counts.html#hidden-code-8"><i class="fa fa-check"></i><b>18.9</b> Hidden code</a>
<ul>
<li class="chapter" data-level="18.9.1" data-path="counts.html"><a href="counts.html#import-example-1-data-exp3a-angiogenic-sprouts"><i class="fa fa-check"></i><b>18.9.1</b> Import Example 1 data (exp3a – “angiogenic sprouts”)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="gls.html"><a href="gls.html"><i class="fa fa-check"></i><b>19</b> Linear models with heterogenous variance</a></li>
<li class="chapter" data-level="" data-path="appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models.html"><a href="appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models.html"><i class="fa fa-check"></i>Appendix: An example set of analyses of experimental data with linear models</a></li>
<li class="chapter" data-level="20" data-path="ask1-bio.html"><a href="ask1-bio.html"><i class="fa fa-check"></i><b>20</b> Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li class="chapter" data-level="21" data-path="ask1-report.html"><a href="ask1-report.html"><i class="fa fa-check"></i><b>21</b> Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a>
<ul>
<li class="chapter" data-level="21.1" data-path="ask1-report.html"><a href="ask1-report.html#setup"><i class="fa fa-check"></i><b>21.1</b> Setup</a></li>
<li class="chapter" data-level="21.2" data-path="ask1-report.html"><a href="ask1-report.html#data-source"><i class="fa fa-check"></i><b>21.2</b> Data source</a></li>
<li class="chapter" data-level="21.3" data-path="ask1-report.html"><a href="ask1-report.html#control-the-color-palette"><i class="fa fa-check"></i><b>21.3</b> control the color palette</a></li>
<li class="chapter" data-level="21.4" data-path="ask1-report.html"><a href="ask1-report.html#useful-functions"><i class="fa fa-check"></i><b>21.4</b> useful functions</a></li>
<li class="chapter" data-level="21.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2b-effect-of-ask1-deletion-on-growth-body-weight"><i class="fa fa-check"></i><b>21.5</b> figure 2b – effect of ASK1 deletion on growth (body weight)</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2b-import"><i class="fa fa-check"></i><b>21.5.1</b> figure 2b – import</a></li>
<li class="chapter" data-level="21.5.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2b-exploratory-plots"><i class="fa fa-check"></i><b>21.5.2</b> figure 2b – exploratory plots</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-effect-of-ask1-deletion-on-final-body-weight"><i class="fa fa-check"></i><b>21.6</b> Figure 2c – Effect of ASK1 deletion on final body weight</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-import"><i class="fa fa-check"></i><b>21.6.1</b> Figure 2c – import</a></li>
<li class="chapter" data-level="21.6.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-check-own-computation-of-weight-change-v-imported-value"><i class="fa fa-check"></i><b>21.6.2</b> Figure 2c – check own computation of weight change v imported value</a></li>
<li class="chapter" data-level="21.6.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-exploratory-plots"><i class="fa fa-check"></i><b>21.6.3</b> Figure 2c – exploratory plots</a></li>
<li class="chapter" data-level="21.6.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-fit-the-model-m1-lm"><i class="fa fa-check"></i><b>21.6.4</b> Figure 2c – fit the model: m1 (lm)</a></li>
<li class="chapter" data-level="21.6.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-check-the-model-m1"><i class="fa fa-check"></i><b>21.6.5</b> Figure 2c – check the model: m1</a></li>
<li class="chapter" data-level="21.6.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-fit-the-model-m2-gamma-glm"><i class="fa fa-check"></i><b>21.6.6</b> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li class="chapter" data-level="21.6.7" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-check-the-model-m2"><i class="fa fa-check"></i><b>21.6.7</b> Figure 2c – check the model, m2</a></li>
<li class="chapter" data-level="21.6.8" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-inference-from-the-model"><i class="fa fa-check"></i><b>21.6.8</b> Figure 2c – inference from the model</a></li>
<li class="chapter" data-level="21.6.9" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-plot-the-model"><i class="fa fa-check"></i><b>21.6.9</b> Figure 2c – plot the model</a></li>
<li class="chapter" data-level="21.6.10" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-report"><i class="fa fa-check"></i><b>21.6.10</b> Figure 2c – report</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><i class="fa fa-check"></i><b>21.7</b> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a>
<ul>
<li class="chapter" data-level="21.7.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-import"><i class="fa fa-check"></i><b>21.7.1</b> Figure 2d – Import</a></li>
<li class="chapter" data-level="21.7.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-exploratory-plots"><i class="fa fa-check"></i><b>21.7.2</b> Figure 2d – exploratory plots</a></li>
<li class="chapter" data-level="21.7.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-fit-the-model"><i class="fa fa-check"></i><b>21.7.3</b> Figure 2d – fit the model</a></li>
<li class="chapter" data-level="21.7.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-check-the-model"><i class="fa fa-check"></i><b>21.7.4</b> Figure 2d – check the model</a></li>
<li class="chapter" data-level="21.7.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-inference"><i class="fa fa-check"></i><b>21.7.5</b> Figure 2d – inference</a></li>
<li class="chapter" data-level="21.7.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-plot-the-model"><i class="fa fa-check"></i><b>21.7.6</b> Figure 2d – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.8" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure"><i class="fa fa-check"></i><b>21.8</b> Figure 2e – Effect of ASK1 deletion on glucose tolerance (summary measure)</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-message-the-data"><i class="fa fa-check"></i><b>21.8.1</b> Figure 2e – message the data</a></li>
<li class="chapter" data-level="21.8.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-exploratory-plots"><i class="fa fa-check"></i><b>21.8.2</b> Figure 2e – exploratory plots</a></li>
<li class="chapter" data-level="21.8.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-fit-the-model"><i class="fa fa-check"></i><b>21.8.3</b> Figure 2e – fit the model</a></li>
<li class="chapter" data-level="21.8.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-check-the-model"><i class="fa fa-check"></i><b>21.8.4</b> Figure 2e – check the model</a></li>
<li class="chapter" data-level="21.8.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-inference-from-the-model"><i class="fa fa-check"></i><b>21.8.5</b> Figure 2e – inference from the model</a></li>
<li class="chapter" data-level="21.8.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-plot-the-model"><i class="fa fa-check"></i><b>21.8.6</b> Figure 2e – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate"><i class="fa fa-check"></i><b>21.9</b> Figure 2f – Effect of ASK1 deletion on glucose infusion rate</a>
<ul>
<li class="chapter" data-level="21.9.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-import"><i class="fa fa-check"></i><b>21.9.1</b> Figure 2f – import</a></li>
<li class="chapter" data-level="21.9.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-exploratory-plots"><i class="fa fa-check"></i><b>21.9.2</b> Figure 2f – exploratory plots</a></li>
<li class="chapter" data-level="21.9.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-fit-the-model"><i class="fa fa-check"></i><b>21.9.3</b> Figure 2f – fit the model</a></li>
<li class="chapter" data-level="21.9.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-check-the-model"><i class="fa fa-check"></i><b>21.9.4</b> Figure 2f – check the model</a></li>
<li class="chapter" data-level="21.9.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-inference"><i class="fa fa-check"></i><b>21.9.5</b> Figure 2f – inference</a></li>
<li class="chapter" data-level="21.9.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-plot-the-model"><i class="fa fa-check"></i><b>21.9.6</b> Figure 2f – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.10" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake"><i class="fa fa-check"></i><b>21.10</b> Figure 2g – Effect of ASK1 deletion on tissue-specific glucose uptake</a>
<ul>
<li class="chapter" data-level="21.10.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-import"><i class="fa fa-check"></i><b>21.10.1</b> Figure 2g – import</a></li>
<li class="chapter" data-level="21.10.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-exploratory-plots"><i class="fa fa-check"></i><b>21.10.2</b> Figure 2g – exploratory plots</a></li>
<li class="chapter" data-level="21.10.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-fit-the-model"><i class="fa fa-check"></i><b>21.10.3</b> Figure 2g – fit the model</a></li>
<li class="chapter" data-level="21.10.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-check-the-model"><i class="fa fa-check"></i><b>21.10.4</b> Figure 2g – check the model</a></li>
<li class="chapter" data-level="21.10.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-inference"><i class="fa fa-check"></i><b>21.10.5</b> Figure 2g – inference</a></li>
<li class="chapter" data-level="21.10.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-plot-the-model"><i class="fa fa-check"></i><b>21.10.6</b> Figure 2g – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.11" data-path="ask1-report.html"><a href="ask1-report.html#figure-2h"><i class="fa fa-check"></i><b>21.11</b> Figure 2h</a></li>
<li class="chapter" data-level="21.12" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-effect-of-ask1-deletion-on-liver-tg"><i class="fa fa-check"></i><b>21.12</b> Figure 2i – Effect of ASK1 deletion on liver TG</a>
<ul>
<li class="chapter" data-level="21.12.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-fit-the-model"><i class="fa fa-check"></i><b>21.12.1</b> Figure 2i – fit the model</a></li>
<li class="chapter" data-level="21.12.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-check-the-model"><i class="fa fa-check"></i><b>21.12.2</b> Figure 2i – check the model</a></li>
<li class="chapter" data-level="21.12.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-inference"><i class="fa fa-check"></i><b>21.12.3</b> Figure 2i – inference</a></li>
<li class="chapter" data-level="21.12.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-plot-the-model"><i class="fa fa-check"></i><b>21.12.4</b> Figure 2i – plot the model</a></li>
<li class="chapter" data-level="21.12.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-report-the-model"><i class="fa fa-check"></i><b>21.12.5</b> Figure 2i – report the model</a></li>
</ul></li>
<li class="chapter" data-level="21.13" data-path="ask1-report.html"><a href="ask1-report.html#figure-2j"><i class="fa fa-check"></i><b>21.13</b> Figure 2j</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="count-sim.html"><a href="count-sim.html"><i class="fa fa-check"></i><b>22</b> Simulations – Count data (alternatives to a t-test)</a>
<ul>
<li class="chapter" data-level="22.1" data-path="count-sim.html"><a href="count-sim.html#use-data-similar-to-figure-6f-from-example-1"><i class="fa fa-check"></i><b>22.1</b> Use data similar to Figure 6f from Example 1</a></li>
<li class="chapter" data-level="22.2" data-path="count-sim.html"><a href="count-sim.html#functions"><i class="fa fa-check"></i><b>22.2</b> Functions</a></li>
<li class="chapter" data-level="22.3" data-path="count-sim.html"><a href="count-sim.html#simulations"><i class="fa fa-check"></i><b>22.3</b> Simulations</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="count-sim.html"><a href="count-sim.html#type-i-pseudo-normal-distribution"><i class="fa fa-check"></i><b>22.3.1</b> Type I, Pseudo-Normal distribution</a></li>
<li class="chapter" data-level="22.3.2" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-equal-n"><i class="fa fa-check"></i><b>22.3.2</b> Type I, neg binom, equal n</a></li>
<li class="chapter" data-level="22.3.3" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-equal-n-small-theta"><i class="fa fa-check"></i><b>22.3.3</b> Type I, neg binom, equal n, small theta</a></li>
<li class="chapter" data-level="22.3.4" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-unequal-n"><i class="fa fa-check"></i><b>22.3.4</b> Type I, neg binom, unequal n</a></li>
<li class="chapter" data-level="22.3.5" data-path="count-sim.html"><a href="count-sim.html#power-pseudo-normal-distribution-equal-n"><i class="fa fa-check"></i><b>22.3.5</b> Power, Pseudo-Normal distribution, equal n</a></li>
<li class="chapter" data-level="22.3.6" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-equal-n"><i class="fa fa-check"></i><b>22.3.6</b> Power, neg binom, equal n</a></li>
<li class="chapter" data-level="22.3.7" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-small-theta"><i class="fa fa-check"></i><b>22.3.7</b> Power, neg binom, small theta</a></li>
<li class="chapter" data-level="22.3.8" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-unequal-n"><i class="fa fa-check"></i><b>22.3.8</b> Power, neg binom, unequal n</a></li>
<li class="chapter" data-level="22.3.9" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-unequal-n-unequal-theta"><i class="fa fa-check"></i><b>22.3.9</b> Power, neg binom, unequal n, unequal theta</a></li>
<li class="chapter" data-level="22.3.10" data-path="count-sim.html"><a href="count-sim.html#type-1-neg-binom-equal-n-unequal-theta"><i class="fa fa-check"></i><b>22.3.10</b> Type 1, neg binom, equal n, unequal theta</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="count-sim.html"><a href="count-sim.html#save-it-read-it"><i class="fa fa-check"></i><b>22.4</b> Save it, Read it</a></li>
<li class="chapter" data-level="22.5" data-path="count-sim.html"><a href="count-sim.html#analysis"><i class="fa fa-check"></i><b>22.5</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html"><i class="fa fa-check"></i>Appendix 1: Getting Started with R</a>
<ul>
<li class="chapter" data-level="22.6" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready"><i class="fa fa-check"></i><b>22.6</b> Get your computer ready</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-here"><i class="fa fa-check"></i><b>22.6.1</b> Start here</a></li>
<li class="chapter" data-level="22.6.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r"><i class="fa fa-check"></i><b>22.6.2</b> Install R</a></li>
<li class="chapter" data-level="22.6.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-studio"><i class="fa fa-check"></i><b>22.6.3</b> Install R Studio</a></li>
<li class="chapter" data-level="22.6.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-markdown-1"><i class="fa fa-check"></i><b>22.6.4</b> Install R Markdown</a></li>
<li class="chapter" data-level="22.6.5" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#optional-alternative-latex-installations"><i class="fa fa-check"></i><b>22.6.5</b> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-learning-r-studio"><i class="fa fa-check"></i><b>22.7</b> Start learning R Studio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><i class="fa fa-check"></i>Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics for Experimental Biology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-models" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Plotting Models</h1>
<p><em>So, along the lines of Sarah Susanka’s “Not So Big House,” Kolbert asks the group, “What would a Pretty Good House look like?”</em> – Michael Maines<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>Plots should be the focus of both the reader and researcher. Instead of mindless plotting, a researcher should ask a series of questions of every plot</p>
<ol style="list-style-type: decimal">
<li>What is the point of each element in a plot?</li>
<li>Are these the points that I most want to communicate?</li>
<li>Are there better practices for communicating these points?</li>
<li>Are the points that I want to communicate that are not covered by these elements?</li>
</ol>
<p>The answer to these questions should inform what is and what is not plotted. The result is a pretty good plot. The idea of a pretty good plot is borrowed from the “pretty good house” concept that grew out of a collaborative group of builders and architects in Northern New England. The “pretty good house” combines best practices for building an earth friendly, high performance home at a reasonable cost. There is no pretty good house governing body that awards certificates of achievement but, instead, a set of metrics and a collection of building practices that can achieve these.</p>
<p>A typical pretty good plot contains some combination of</p>
<ol style="list-style-type: decimal">
<li>Modeled effects with confidence intervals. “Effects” are differences between groups in response to treatment – the <em>raison d’etre</em> of an experiment.</li>
<li>Modeled means and confidence intervals.</li>
<li>Individual data points or a summary distribution of these.</li>
</ol>
<div id="pretty-good-plots-show-the-model-and-the-data" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Pretty good plots show the model and the data</h2>
<p>The data to introduce best practices in plotting come from Figure 2d and Figure 2e from “ASK1 inhibits browning of white adipose tissue in obesity,” introduced in the introductor chapter (Analyzing experimental data with a linear model)</p>
<div id="pretty-good-plot-component-1-modeled-effects-plot" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Pretty good plot component 1: Modeled effects plot</h3>
<div class="figure"><span id="fig:plots-fig2e-gg-effects"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-fig2e-gg-effects-1.png" alt="Effects plot of glucose AUC data" width="576" />
<p class="caption">
Figure 4.1: Effects plot of glucose AUC data
</p>
</div>
<p>Biologists infer the biological consequences of a treatment by interpreting the magnitude and sign of treatment “effects,” such as the differences in means among treatment levels. Why then do we mostly plot treatment level means, where effect magnitude and sign can only be inferred <em>indirectly</em>, by mentally computing differences in means? A pretty good plot <em>directly</em> communicates treatment effects and the uncertainty in the estimates of these effects using an <strong>effects plot</strong>.</p>
<p>Figure <a href="#plots-fig2e-gg-effects"><strong>??</strong></a> is an effects plot of the linear model fit to the glucose tolerance data. The effects plot is “flipped.” The y-axis is the categorical variable – it contains the labels identifying the pair of groups in the contrast and the direction of the difference. In addition to the pairwise comparisons, I include the interaction effect on the y-axis. The x-axis is the continuous variable – it contains the <strong>simple effects</strong>, which is the difference in means between the two groups identified by the y-axis labels. Additionally, the y-axis includes the estimate of the <span class="math inline">\(diet \time genotype\)</span> interaction effect. The bars are 95% confidence intervals of the effects (either simple effects or interaction effect), which is the range of values that are compatible with the observed data at the 95% level.</p>
<p>We can use the effects and CIs of the effects to evaluate the treatment effects. For example, when on a high fat diet (HFD), the mean, post-baseline plasma glucose level in the ASK1<span class="math inline">\(\Delta\)</span>adipo is 3.5 mmol/L less than that for the control (ASK1F/F). Differences less than 5.3 mmol/L less than ASK1F/F levels or greater than 1.7 mmol/L less than ASK1F/F levels are not very compatible with the data. It is up to the research community to decide if 1.7 mmol/L or 3.5 mmol/L differences are physiologically meaningful effects.</p>
</div>
<div id="pretty-good-plot-component-2-modeled-mean-and-ci-plot" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Pretty good plot component 2: Modeled mean and CI plot</h3>
<div class="figure"><span id="fig:plots-fig2-gg-response-adjusted"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-fig2-gg-response-adjusted-1.png" alt="Response plot" width="576" />
<p class="caption">
Figure 4.2: Response plot
</p>
</div>
<p>The response plot in Figure <a href="plotting-models.html#fig:plots-fig2-gg-response-adjusted">4.2</a> “shows the model” – by this I mean the plot shows the <em>modeled</em> means, represented by the large circles, the <em>modeled</em> 95% confidence intervals of each mean, represented by the error bars, and the <em>model-adjusted</em> individual response values, represented by the small colored dots. What do I mean by <em>modeled</em> means, modeled error intervals, and model-adjusted responses?</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
ask1
</th>
<th style="text-align:left;">
diet
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
Sample mean
</th>
<th style="text-align:right;">
Sample sigma
</th>
<th style="text-align:right;">
Sample SE
</th>
<th style="text-align:right;">
Model mean
</th>
<th style="text-align:right;">
Model sigma
</th>
<th style="text-align:right;">
Model SE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ASK1F/F
</td>
<td style="text-align:left;">
chow
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
14.35
</td>
<td style="text-align:right;">
1.48
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
14.35
</td>
<td style="text-align:right;">
1.85
</td>
<td style="text-align:right;">
0.59
</td>
</tr>
<tr>
<td style="text-align:left;">
ASK1F/F
</td>
<td style="text-align:left;">
HFD
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
19.40
</td>
<td style="text-align:right;">
3.60
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
18.63
</td>
<td style="text-align:right;">
1.85
</td>
<td style="text-align:right;">
0.52
</td>
</tr>
<tr>
<td style="text-align:left;">
ASK1Δadipo
</td>
<td style="text-align:left;">
chow
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
13.87
</td>
<td style="text-align:right;">
1.26
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
14.01
</td>
<td style="text-align:right;">
1.85
</td>
<td style="text-align:right;">
0.66
</td>
</tr>
<tr>
<td style="text-align:left;">
ASK1Δadipo
</td>
<td style="text-align:left;">
HFD
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
15.92
</td>
<td style="text-align:right;">
1.73
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
15.53
</td>
<td style="text-align:right;">
1.85
</td>
<td style="text-align:right;">
0.49
</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>The modeled means and error intervals are estimated from the statistical model. Many published plots show the sample means and sample error intervals, which are computed within each group independently of the data in the other groups and are not adjusted for any covariates or for any hierarchical structure to the data.</li>
<li>A modeled mean will often be equal to the raw mean, but this will not always be the case. Here, the modeled means for the non-reference groups in Figure <a href="#fig:lots-fig2-gg-response-adjusted"><strong>??</strong></a> do not equal the sample means because the modeled means are adjusted for the baseline measures of glucose (Table <a href="#tab:plots-model-means-table"><strong>??</strong></a>) (specifically, the modeled means are conditional on the baseline being equal to the mean of the baseline in the reference group).</li>
<li>For most of the analyses in this text, modeled error intervals are not the same as the sample error intervals and are commonly conspicuously different. For the glucose tolerance data, the modeled error intervals are calculated from a pooled estimate of <span class="math inline">\(\sigma\)</span> while the sample error intervals are estimated from sample-specific estimates of <span class="math inline">\(\sigma\)</span> (Table <a href="#tab:plots-model-means-table"><strong>??</strong></a>).</li>
<li>Model-adjusted responses are responses that are adjusted for covariates in the model. If there are no covariates in the model, the model-adjusted responses are the same as the raw response. In the glucose tolerance data, the model-adjusted responses are the modeled, individual response measures if all individuals had the same baseline glucose (the covariate).</li>
</ol>
<p>Modeled means, error intervals, and responses are not commonly plotted but it is these values that are consistent with our inferences from the statistical model. There are many data sets in experimental biology where a plot of sample means, error intervals, and responses give a very distorted view of inference from the model.</p>
<p>The response plot in Figure <a href="plotting-models.html#fig:plots-fig2-gg-response-adjusted">4.2</a> also “shows the data” by plotting response values as “jittered” dots. Showing the data</p>
<ol style="list-style-type: decimal">
<li>allows the reader to get a sense of the underlying sample size and distribution including outliers, which can be used to mentally model check the published statistical analysis. Adding a box plot, violin plot, or dot plot augments the communication of the distributions if there are enough data to justify the addition.</li>
<li>allows a reader to see the overlap in individual responses among groups and to evaluate the biological consequences of this overlap.</li>
</ol>
</div>
<div id="combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot." class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</h3>
<div class="figure"><span id="fig:plots-fig2e-ggplot"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-fig2e-ggplot-1.png" alt="Effect of diet and ASK1 deletion on post-baseline glucose. Top: effects plot of 2 X 2 simple effects (difference in means) and of the diet X genotype interaction. Bars are 95% confidence intervals of the effects. Unadjusted p-values from the linear model are given. Bottom: response plot of the means and 95% confidence interval of each diet X genotype combination." width="576" />
<p class="caption">
Figure 4.3: Effect of diet and ASK1 deletion on post-baseline glucose. Top: effects plot of 2 X 2 simple effects (difference in means) and of the diet X genotype interaction. Bars are 95% confidence intervals of the effects. Unadjusted p-values from the linear model are given. Bottom: response plot of the means and 95% confidence interval of each diet X genotype combination.
</p>
</div>
<p>Combining the effects and response plots into a single plot is an easy solution to issues that arise if only one or the other is used. What are these issues?</p>
<p>While a response plot like that in Figure <a href="plotting-models.html#fig:plots-fig2-gg-response-adjusted">4.2</a> is standard in biology, it fails to show the effects, and the uncertainty in the effects, <em>explicitly</em>. To infer the effects from the plot, a reader must perform mental math – either compute the difference or the ratio between pairs of means. This mental math is easy enough if the comparisons are between individual treatment levels but much harder if the comparisons are between pooled sets of treatment levels, for example in a factorial experimental design. The mental math that is excessively difficult is the reconstruction of some kind of error interval of the contrasts, for example the 95% confidence intervals in Figure <a href="#plots-fig2e-gg-effects"><strong>??</strong></a> and it is these intervals that are necessary for a researcher to infer the range of biological consequences that are compatible with the experiment’s results. The inclusion of the <em>p</em>-values for all pairwise comparisons in a response plot gives the significance level of these contrasts, but of the kinds of summary results that we could present (contrasts, error intervals, <em>p</em>-values), the <em>p</em>-values are the least informative.</p>
<p>Effects plots are very uncommon in most of biology outside of meta-analysis and clinical medicine more generally. An effects plot alone fails to communicate anything about the sample size or conditional distribution of the data. Equally important, response values are often meaningful and researchers working in the field should be familiar with usual and unusual values. This can be useful for interpreting biological consequences of treatment effects but also for researchers and readers to asses the credibility of the data (for example, I have twice, once in my own data and once in a colleagues data, found mistakes in the measurement of an entire data set of response variable because the plotted values weren’t credible).</p>
</div>
<div id="some-comments-on-plot-components" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Some comments on plot components</h3>
<ol style="list-style-type: decimal">
<li>Several recent criticisms of bar plots have advocated box plots or violin plots as alternatives. Box plots and violin plots are useful alternatives to jittered dots if there are sufficient data to capture the distribution but I wouldn’t advocate replacing the plot of modeled means and confidence intervals with box or violin plots, as these communicate different things. More importantly, box and violin plots do not communicate the treatment effects.</li>
<li>Almost all plots in biology report the error bars that represent the sample standard error. As described above, sample standard error bars do not reflect the fit model and can be highly misleading, at least if interpreting as if they do reflect the model. Also, sample standard error bars can explicitly include absurd values or imply absurd confidence intervals. For example, I sometimes see standard error bars cross <span class="math inline">\(y=0\)</span> for a response that cannot be negative, such as a count. Even if the standard error bar doesn’t cross zero, it is common to see standard error bars that imply (but do not explicitly show) 95% confidence intervals that cross zero, again for responses that cannot be negative. A standard error bar or confidence interval that crosses zero implies that negative means are compatible with the data. This is an absurd implication for responses that cannot have negative values (or are “bounded by” zero). Explicit or implicit error bars that cross zero are especially common for count responses with small means. <em>If</em> a researcher plots confidence intervals, these should be computed using a method that avoids absurd implications, such methods include the bootstrap and generalized linear models.</li>
<li>Significance stars are okay, the actual <em>p</em>-value is better, effects plots are best. Many researchers add star symbols to a plot indicating the level of significance of a particular paired comparison. Stars are okay in the sense that there is no inferential difference between <span class="math inline">\(p = 0.015\)</span> and <span class="math inline">\(p = 0.045\)</span>. There’s also no inferential difference between <span class="math inline">\(p = 0.0085\)</span> and <span class="math inline">\(p = 0.015\)</span>, which highlights the weakness of -chotomizing any continuous variable. For this reason, a better, alternative would be to add the actual p-value (as above). A more serious criticism of stars is that it encourages researchers and readers to focus on statistical significance instead of effect size and uncertainty. A more valuable alternative, then, is to report the effects and uncertainty in an effects plot or a combined effects-and-response plot.</li>
</ol>
</div>
</div>
<div id="working-in-r" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Working in R</h2>
<p>A reasonable goal of any research project should be a script to generate the final plots entirely within the R environment and not rely on external drawing software to add finishing features. This section covers some of the basics of using R packages to create plots. Later chapters cover some of the details that are specific to the analyses in that chapter.</p>
<p><a href="https://ggplot2.tidyverse.org">ggplot2</a> is one of the major plotting environments in R and the one that seems to have the strongest following, especially among new R users. ggplot2 has the ability to generate extremely personalized and finished plots. However, ggplot2 has a long learning curve and until one is pretty comfortable with its implementation of the grammar of graphics, creating a plot with multiple layers (mean points, error intervals, raw data points, p-values, text annotations) and modified aesthetics (axis text, point colors) can often require many hours of googling.</p>
<p><a href="https://cran.r-project.org/web/packages/ggpubr/index.html">ggpubr</a> is an extension to ggplot2 (it calls ggplot2 functions under the hood) and provides many canned functions for producing the kinds of ggplots that are published in biological journals. With one line of script, a researcher can generate a publishable plot.</p>
<p><strong>ggplot_the_model</strong> and related functions in this chapter are my attempts to create a simple function for creating publication ready plots that highlight effect size and uncertainty.</p>
<p>Some of the basics for using ggpubr, ggplot2, and ggplot_the_model are outlined here. More specific examples are in each chapter.</p>
<div id="source-data" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Source data</h3>
<p>Data source: <a href="https://www.nature.com/articles/s41467-020-15483-7" target="_blank">ASK1 inhibits browning of white adipose tissue in obesity</a></p>
<p>The source data are that for Figure 2E. The response is <span class="math inline">\(glucose\_auc\)</span> the “area under the curve” of repeated measures of blood glucose during the 120 minutes of a glucose tolerance test. Glucose AUC is a measure of glucose tolerance, the higher the area, the higher the blood glucose over the two hours, and the worse the physiological response to a sudden rise in blood glucose. There are two treatment factor variables: 1) <span class="math inline">\(Diet\)</span>, with levels “chow” and “HFD,” where “chow” is normal mouse chow and “HFD” is a high fat diet, and 2) <span class="math inline">\(ask1\)</span>, with levels “ASK1F/F” and “ASK1Δadipo” where “ASK1F/F” is the control level and “ASK1Δadipo” is the ASK1 adipose-deletion mouse described in Chapter 1.</p>
<div id="import" class="section level4" number="4.2.1.1">
<h4><span class="header-section-number">4.2.1.1</span> Import</h4>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="plotting-models.html#cb79-1" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;ASK1 inhibits browning of white adipose tissue in obesity&quot;</span></span>
<span id="cb79-2"><a href="plotting-models.html#cb79-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41467_2020_15483_MOESM4_ESM.xlsx&quot;</span></span>
<span id="cb79-3"><a href="plotting-models.html#cb79-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb79-4"><a href="plotting-models.html#cb79-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-5"><a href="plotting-models.html#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the data are in &quot;tranposed&quot; format -- each row contains the n</span></span>
<span id="cb79-6"><a href="plotting-models.html#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># measures of a treatment level. Read, then transpose</span></span>
<span id="cb79-7"><a href="plotting-models.html#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="co"># to make the treatment levels the columns</span></span>
<span id="cb79-8"><a href="plotting-models.html#cb79-8" aria-hidden="true" tabindex="-1"></a>fig2e_wide <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb79-9"><a href="plotting-models.html#cb79-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sheet =</span> <span class="st">&quot;Source Date_Figure 2&quot;</span>,</span>
<span id="cb79-10"><a href="plotting-models.html#cb79-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">range =</span> <span class="fu">c</span>(<span class="st">&quot;A233:O236&quot;</span>), <span class="co"># lot of NA</span></span>
<span id="cb79-11"><a href="plotting-models.html#cb79-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col_names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-12"><a href="plotting-models.html#cb79-12" aria-hidden="true" tabindex="-1"></a>  data.table <span class="sc">%&gt;%</span></span>
<span id="cb79-13"><a href="plotting-models.html#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transpose</span>(<span class="at">make.names =</span> <span class="dv">1</span>) <span class="co"># turn data onto </span></span>
<span id="cb79-14"><a href="plotting-models.html#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="plotting-models.html#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="co"># melt the four columns into a single &quot;glucose_auc&quot; column</span></span>
<span id="cb79-16"><a href="plotting-models.html#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="co"># and create a new column containing treatment level.</span></span>
<span id="cb79-17"><a href="plotting-models.html#cb79-17" aria-hidden="true" tabindex="-1"></a>y_cols <span class="ot">&lt;-</span> <span class="fu">colnames</span>(fig2e_wide)</span>
<span id="cb79-18"><a href="plotting-models.html#cb79-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-19"><a href="plotting-models.html#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="co"># melt</span></span>
<span id="cb79-20"><a href="plotting-models.html#cb79-20" aria-hidden="true" tabindex="-1"></a>fig2e <span class="ot">&lt;-</span> <span class="fu">melt</span>(fig2e_wide,</span>
<span id="cb79-21"><a href="plotting-models.html#cb79-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">measure.vars =</span> y_cols,</span>
<span id="cb79-22"><a href="plotting-models.html#cb79-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">value.name =</span> <span class="st">&quot;glucose_auc&quot;</span>,</span>
<span id="cb79-23"><a href="plotting-models.html#cb79-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">variable.name =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb79-24"><a href="plotting-models.html#cb79-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-25"><a href="plotting-models.html#cb79-25" aria-hidden="true" tabindex="-1"></a><span class="co"># create two new columns that are the split of treatment</span></span>
<span id="cb79-26"><a href="plotting-models.html#cb79-26" aria-hidden="true" tabindex="-1"></a>fig2e[, <span class="fu">c</span>(<span class="st">&quot;ask1&quot;</span>, <span class="st">&quot;diet&quot;</span>) <span class="sc">:</span><span class="er">=</span> <span class="fu">tstrsplit</span>(treatment,</span>
<span id="cb79-27"><a href="plotting-models.html#cb79-27" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot; &quot;</span>,</span>
<span id="cb79-28"><a href="plotting-models.html#cb79-28" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">fixed=</span><span class="cn">TRUE</span>)]</span>
<span id="cb79-29"><a href="plotting-models.html#cb79-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-30"><a href="plotting-models.html#cb79-30" aria-hidden="true" tabindex="-1"></a><span class="co"># since glucose_auc is the only response variable in this</span></span>
<span id="cb79-31"><a href="plotting-models.html#cb79-31" aria-hidden="true" tabindex="-1"></a><span class="co"># data.table, omit all rows with any NA</span></span>
<span id="cb79-32"><a href="plotting-models.html#cb79-32" aria-hidden="true" tabindex="-1"></a>fig2e <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(fig2e)</span>
<span id="cb79-33"><a href="plotting-models.html#cb79-33" aria-hidden="true" tabindex="-1"></a><span class="co"># View(fig2e)</span></span></code></pre></div>
</div>
</div>
<div id="how-to-plot-the-model" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> How to plot the model</h3>
<p>The steps throughout the text for plotting the model fit to experimental data are</p>
<ol style="list-style-type: decimal">
<li>fit the statistical model</li>
<li>use the fit model to estimate the modeled means and confidence limits using <code>emmeans</code> from the <a href="https://cran.r-project.org/web/packages/emmeans/index.html">emmeans package</a>.</li>
<li>use the <code>emmeans</code> object to estimate the contrasts of interests using the <code>contrast</code> function from emmeans.</li>
<li>Plot the individual points. If covariates are in the model, use the fit model from step 1 to plot the adjusted values of the points.</li>
<li>Use the values from step 2 to plot the modeled means and error intervals.</li>
<li>If including p-value brackets, use the values from step 3.</li>
</ol>
<p>If you are using ggplot_the_model functions, then steps 4-6 are done for you.</p>
<p>Here, I fit a linear model to the fig2e data and compute the use the <code>emmeans</code> and <code>contrast</code> functions without comment. The details of these functions are in the chapters that follow. The fit model and construction of the plots is simplified from those above.</p>
<div id="fit-the-model" class="section level4" number="4.2.2.1">
<h4><span class="header-section-number">4.2.2.1</span> Fit the model</h4>
<p>The response is the glucose AUC, which is the area under the curve of the data from the glucose tolerance test. The model is a factorial linear model with <em>ask1</em> genotype and <em>diet</em> as the two factors.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="plotting-models.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># glucose_auc is the AUC of the glucose tolerance curves computed using trapezoidal algorithm</span></span>
<span id="cb80-2"><a href="plotting-models.html#cb80-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose_auc <span class="sc">~</span> ask1<span class="sc">*</span>diet,</span>
<span id="cb80-3"><a href="plotting-models.html#cb80-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> fig2e)</span></code></pre></div>
</div>
<div id="compute-the-modeled-means-table-of-estimated-means-and-confidence-intervals" class="section level4" number="4.2.2.2">
<h4><span class="header-section-number">4.2.2.2</span> Compute the modeled means table of estimated means and confidence intervals</h4>
<p>Modeled means are computed by passing the model object (<code>m1</code>) to the <code>emmeans</code> function and specifying the columns containing the groups using the <code>specs =</code> argument`.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="plotting-models.html#cb81-1" aria-hidden="true" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">&quot;ask1&quot;</span>, <span class="st">&quot;diet&quot;</span>))</span>
<span id="cb81-2"><a href="plotting-models.html#cb81-2" aria-hidden="true" tabindex="-1"></a>m1_emm</span></code></pre></div>
<pre><code>##  ask1       diet emmean   SE df lower.CL upper.CL
##  ASK1F/F    chow   1691 83.4 41     1523     1859
##  ASK1Δadipo chow   1637 93.2 41     1449     1826
##  ASK1F/F    HFD    2257 73.1 41     2110     2405
##  ASK1Δadipo HFD    1871 70.5 41     1728     2013
## 
## Confidence level used: 0.95</code></pre>
</div>
<div id="compute-the-contrasts-table-of-estimated-effects-with-confidence-intervals-and-p-values" class="section level4" number="4.2.2.3">
<h4><span class="header-section-number">4.2.2.3</span> Compute the contrasts table of estimated effects with confidence intervals and p-values</h4>
<p>Contrasts among levels, or combinations of levels, are computed by passing the emmeans object (<code>m1.emm</code>) to the <code>contrast</code> function. There are many important variations of this step. This text advocates computing planned comparisons, which requires expert knowledge and forthought. Here I limit the computation to the four simple effects (the effects of one factor in each of the levels of the other factor).</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="plotting-models.html#cb83-1" aria-hidden="true" tabindex="-1"></a>m1_simple <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb83-2"><a href="plotting-models.html#cb83-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb83-3"><a href="plotting-models.html#cb83-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">simple =</span> <span class="st">&quot;each&quot;</span>,</span>
<span id="cb83-4"><a href="plotting-models.html#cb83-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">combine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb83-5"><a href="plotting-models.html#cb83-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-6"><a href="plotting-models.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-7"><a href="plotting-models.html#cb83-7" aria-hidden="true" tabindex="-1"></a>m1_simple</span></code></pre></div>
<pre><code>##  diet ask1       contrast               estimate  SE df lower.CL upper.CL
##  chow .          ASK1Δadipo - (ASK1F/F)    -53.6 125 41  -306.21      199
##  HFD  .          ASK1Δadipo - (ASK1F/F)   -386.7 102 41  -591.85     -182
##  .    ASK1F/F    HFD - chow                566.5 111 41   342.48      790
##  .    ASK1Δadipo HFD - chow                233.3 117 41    -2.67      469
##  t.ratio p.value
##  -0.429  0.6703 
##  -3.808  0.0005 
##   5.107  &lt;.0001 
##   1.997  0.0525 
## 
## Confidence level used: 0.95</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>I often use <code>m1_pairs</code> as the name of the contrast table. Here I use <code>m1_simple</code> to remind me that I’ve limited the comparison to the four simple effects. If I only compute planned comparisons, I might use <code>m1_planned</code>.</li>
</ol>
</div>
</div>
<div id="be-sure-ggplot_the_model-is-in-your-r-folder" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Be sure ggplot_the_model is in your R folder</h3>
<p>If you skipped <a href="getting-started-r-projects-and-r-markdown.html#setup-create-project">Create an R Studio Project for this textbook</a>, then download and move the file <a href="https://raw.githubusercontent.com/middleprofessor/applied-biostats/master/R/ggplot_the_model.R">ggplot_the_model.R</a> into the R folder in your Project folder.</p>
</div>
<div id="how-to-use-the-plot-the-model-functions" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> How to use the Plot the Model functions</h3>
<p>The philosophy underneath these functions is to use the model fitted by the researcher to make the plots. The functions require information from three objects:</p>
<ol style="list-style-type: decimal">
<li>the data frame containing the modeled data</li>
<li>the modeled means and CIs from <code>emmeans</code></li>
<li>the modeled effects, CIs and <em>p</em>-values from <code>emmeans::contrast</code>.</li>
</ol>
<p>This philosophy strikes a balance between functions in which all of the statistical modeling is hidden and the researcher only sees the output and manually building ggplots. Actually, I strongly encourage researchers to learn how to build these plots and to not rely on canned functions, and I outline this after introducing the ggplot_the_model functions</p>
<p>These functions require the fit model object (<code>m1</code>), the emmeans object of modeled means (<code>m1_emm</code>) and the contrast object of modeled effects (<code>m1_simple</code>).</p>
<div id="ggplot_the_response" class="section level4" number="4.2.4.1">
<h4><span class="header-section-number">4.2.4.1</span> ggplot_the_response</h4>
<p>For the response plot only, use <code>ggplot_the_response</code>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="plotting-models.html#cb85-1" aria-hidden="true" tabindex="-1"></a>m1_response_plot <span class="ot">&lt;-</span> <span class="fu">ggplot_the_response</span>(</span>
<span id="cb85-2"><a href="plotting-models.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> m1,</span>
<span id="cb85-3"><a href="plotting-models.html#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit_emm =</span> m1_emm,</span>
<span id="cb85-4"><a href="plotting-models.html#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit_pairs =</span> m1_simple,</span>
<span id="cb85-5"><a href="plotting-models.html#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb85-6"><a href="plotting-models.html#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;mmol &quot;</span>, l<span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot; min&quot;</span>)),</span>
<span id="cb85-7"><a href="plotting-models.html#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">g_label =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb85-8"><a href="plotting-models.html#cb85-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-9"><a href="plotting-models.html#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="plotting-models.html#cb85-10" aria-hidden="true" tabindex="-1"></a>m1_response_plot</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-ggplot_the_response-1.png" width="576" />
<code>ggplot_the_response</code> arguments:</p>
<p><strong>fit</strong> model object from lm, lmer, nlme, glmmTMB</p>
<p><strong>fit_emm</strong> object from ‘emmeans.’ Or, a data frame that looks like this object, with modeled factor variables in columns 1 and 2 (if a 2nd factor is in the model), a column of means with name “emmean,” and columns of error intervals named “lower.CL” and “upper.CL”</p>
<p><strong>fit_pairs</strong> object from <code>emmeans:contrast</code>. Or, a data frame that looks like this object.</p>
<p><strong>wrap_col = NULL</strong> Not used at the moment</p>
<p><strong>x_label = “none”</strong> A character variable used for the X-axis title.</p>
<p><strong>y_label = “Response (units)”</strong> A character variable used for the Y-axis title. Use <code>expression(paste())</code> method for math.</p>
<p><strong>g_label = NULL</strong> A character variable used for the grouping variable (the 2nd factor) title. Use “none” to remove</p>
<p><strong>dots = “sina”</strong> controls the plotting of individual points. sina from ggforce package. Alternatives are “jitter” and “dotplot”</p>
<p><strong>dodge_width = 0.8</strong> controls spacing between group means for models with a 2nd factor (the grouping variable)</p>
<p><strong>adjust = 0.5</strong> controls spread of dots if using <code>dots = "sina"</code></p>
<p><strong>contrast_rows = “all”</strong> controls which rows of fit_pairs to use for <em>p</em>-value brackets. Use “none” to hide.</p>
<p><strong>y_pos = NULL</strong> manual control of the y-coordinates for p-value brackets</p>
<p><strong>palette = pal_okabe_ito</strong> allows control of the color palette. The default pal_okabe_ito palette is a color blind palette.</p>
<p><strong>legend_position = “top”</strong> controls position of the legend for the grouping variable (the 2nd factor in a two-factor model)</p>
<p><strong>flip_horizontal = FALSE</strong> controls the orientation of the axes.</p>
<p><strong>group_lines = FALSE</strong> used for plotting lines connecting group means. Not yet implemented.</p>
</div>
<div id="ggplot_the_effects" class="section level4" number="4.2.4.2">
<h4><span class="header-section-number">4.2.4.2</span> ggplot_the_effects</h4>
<p>For the effects plot only, use <code>ggplot_the_effects</code>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="plotting-models.html#cb86-1" aria-hidden="true" tabindex="-1"></a>m1_effects_plot <span class="ot">&lt;-</span> <span class="fu">ggplot_the_effects</span>(</span>
<span id="cb86-2"><a href="plotting-models.html#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> m1,</span>
<span id="cb86-3"><a href="plotting-models.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit_pairs =</span> m1_simple,</span>
<span id="cb86-4"><a href="plotting-models.html#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">effect_label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Effect (mmol &quot;</span>, l<span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot; min)&quot;</span>))</span>
<span id="cb86-5"><a href="plotting-models.html#cb86-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-6"><a href="plotting-models.html#cb86-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-7"><a href="plotting-models.html#cb86-7" aria-hidden="true" tabindex="-1"></a>m1_effects_plot</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-ggplot_the_effects-1.png" width="576" /></p>
<p><code>ggplot_the_effects</code> arguments</p>
<p><strong>fit</strong> model object from lm, lmer, nlme, glmmTMB</p>
<p><strong>fit_pairs</strong> object from <code>emmeans:contrast</code>. Or, a data frame that looks like this object.</p>
<p><strong>contrast_rows = “all”</strong> controls which rows of fit_pairs to include in plot.</p>
<p><strong>show_p = TRUE</strong> controls show/hide of <em>p</em>-values</p>
<p><strong>effect_label = “Effect (units)”</strong> character variable for the title of the effects axis title.</p>
</div>
<div id="ggplot_the_model" class="section level4" number="4.2.4.3">
<h4><span class="header-section-number">4.2.4.3</span> ggplot_the_model</h4>
<p>For the combined response and effects plot, use <code>ggplot_the_model</code>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="plotting-models.html#cb87-1" aria-hidden="true" tabindex="-1"></a>m1_plot <span class="ot">&lt;-</span> <span class="fu">ggplot_the_model</span>(</span>
<span id="cb87-2"><a href="plotting-models.html#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> m1,</span>
<span id="cb87-3"><a href="plotting-models.html#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit_emm =</span> m1_emm,</span>
<span id="cb87-4"><a href="plotting-models.html#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit_pairs =</span> m1_simple,</span>
<span id="cb87-5"><a href="plotting-models.html#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb87-6"><a href="plotting-models.html#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;mmol &quot;</span>, l<span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot; min&quot;</span>)),</span>
<span id="cb87-7"><a href="plotting-models.html#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">g_label =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb87-8"><a href="plotting-models.html#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">effect_label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Effect (mmol &quot;</span>, l<span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot; min)&quot;</span>))</span>
<span id="cb87-9"><a href="plotting-models.html#cb87-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-10"><a href="plotting-models.html#cb87-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-11"><a href="plotting-models.html#cb87-11" aria-hidden="true" tabindex="-1"></a>m1_plot</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-ggplot_the_model-1.png" width="576" />
<code>ggplot_the_model</code> arguments</p>
<p><strong>fit</strong> same as for <code>ggplot_the_response</code></p>
<p><strong>fit_emm</strong> same as for <code>ggplot_the_response</code></p>
<p><strong>fit_pairs</strong> same as for <code>ggplot_the_response</code></p>
<p><strong>wrap_col = NULL</strong> same as for <code>ggplot_the_response</code></p>
<p><strong>x_label = “none”</strong> same as for <code>ggplot_the_response</code></p>
<p><strong>y_label = “Response (units)”</strong> same as for <code>ggplot_the_response</code></p>
<p><strong>g_label = NULL</strong> same as for <code>ggplot_the_response</code></p>
<p><strong>effect_label = “Effect (units)”</strong> same as for <code>ggplot_the_effect</code></p>
<p><strong>dots = “sina”</strong> same as for <code>ggplot_the_response</code></p>
<p><strong>dodge_width = 0.8</strong> same as for <code>ggplot_the_response</code></p>
<p><strong>adjust = 0.5</strong> same as for <code>ggplot_the_response</code></p>
<p><strong>contrast_rows = “all”</strong> same as for <code>ggplot_the_response</code></p>
<p><strong>y_pos = NULL</strong> same as for <code>ggplot_the_response</code></p>
<p><strong>palette = pal_okabe_ito</strong> same as for <code>ggplot_the_response</code></p>
<p><strong>legend_position = “bottom”</strong> Except for default, same as for <code>ggplot_the_response</code></p>
<p><strong>flip_horizontal = TRUE</strong> Except for default, same as for <code>ggplot_the_response</code></p>
<p><strong>group_lines = FALSE</strong> used for plotting lines connecting group means. Not yet implemented.</p>
<p><strong>rel_heights = c(1,1)</strong> used to control relative heights of the effects and response plot</p>
</div>
<div id="ggplot_the_treatments" class="section level4" number="4.2.4.4">
<h4><span class="header-section-number">4.2.4.4</span> ggplot_the_treatments</h4>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="plotting-models.html#cb88-1" aria-hidden="true" tabindex="-1"></a>x_levels <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb88-2"><a href="plotting-models.html#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ASK1 =</span> <span class="fu">c</span>(<span class="st">&quot;F/F&quot;</span>, <span class="st">&quot;Δadipo&quot;</span>, <span class="st">&quot;F/F&quot;</span>, <span class="st">&quot;Δadipo&quot;</span>),</span>
<span id="cb88-3"><a href="plotting-models.html#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Diet =</span> <span class="fu">c</span>(<span class="st">&quot;chow&quot;</span>, <span class="st">&quot;chow&quot;</span>, <span class="st">&quot;HFD&quot;</span>, <span class="st">&quot;HFD&quot;</span>)</span>
<span id="cb88-4"><a href="plotting-models.html#cb88-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-5"><a href="plotting-models.html#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="plotting-models.html#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the same code as above but hiding </span></span>
<span id="cb88-7"><a href="plotting-models.html#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co"># legend position</span></span>
<span id="cb88-8"><a href="plotting-models.html#cb88-8" aria-hidden="true" tabindex="-1"></a>m1_response_plot_base <span class="ot">&lt;-</span> <span class="fu">ggplot_the_response</span>(</span>
<span id="cb88-9"><a href="plotting-models.html#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> m1,</span>
<span id="cb88-10"><a href="plotting-models.html#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit_emm =</span> m1_emm,</span>
<span id="cb88-11"><a href="plotting-models.html#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit_pairs =</span> m1_simple,</span>
<span id="cb88-12"><a href="plotting-models.html#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb88-13"><a href="plotting-models.html#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;mmol &quot;</span>, l<span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot; min&quot;</span>)),</span>
<span id="cb88-14"><a href="plotting-models.html#cb88-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">g_label =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb88-15"><a href="plotting-models.html#cb88-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend_position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb88-16"><a href="plotting-models.html#cb88-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-17"><a href="plotting-models.html#cb88-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-18"><a href="plotting-models.html#cb88-18" aria-hidden="true" tabindex="-1"></a>m1_response_plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot_the_treatments</span>(</span>
<span id="cb88-19"><a href="plotting-models.html#cb88-19" aria-hidden="true" tabindex="-1"></a>  m1_response_plot_base,</span>
<span id="cb88-20"><a href="plotting-models.html#cb88-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_levels =</span> x_levels,</span>
<span id="cb88-21"><a href="plotting-models.html#cb88-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">text_size =</span> <span class="fl">3.5</span>,</span>
<span id="cb88-22"><a href="plotting-models.html#cb88-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>)</span>
<span id="cb88-23"><a href="plotting-models.html#cb88-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-24"><a href="plotting-models.html#cb88-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-25"><a href="plotting-models.html#cb88-25" aria-hidden="true" tabindex="-1"></a>m1_response_plot2</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-ggplot_the_treatments-1.png" width="576" /></p>
<p>If you prefer plus and minus symbols, use <code>minus &lt;- "\u2013"</code> for the minus sign instead of the hyphen “-”</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="plotting-models.html#cb89-1" aria-hidden="true" tabindex="-1"></a>minus <span class="ot">&lt;-</span> <span class="st">&quot;\u2013&quot;</span> <span class="co"># good to put this in the setup chunk</span></span>
<span id="cb89-2"><a href="plotting-models.html#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="plotting-models.html#cb89-3" aria-hidden="true" tabindex="-1"></a>x_levels <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb89-4"><a href="plotting-models.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  Δ<span class="at">adipo =</span> <span class="fu">c</span>(minus, <span class="st">&quot;+&quot;</span>, minus, <span class="st">&quot;+&quot;</span>),</span>
<span id="cb89-5"><a href="plotting-models.html#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">HFD =</span> <span class="fu">c</span>(minus, minus, <span class="st">&quot;+&quot;</span>, <span class="st">&quot;+&quot;</span>)</span>
<span id="cb89-6"><a href="plotting-models.html#cb89-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-7"><a href="plotting-models.html#cb89-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-8"><a href="plotting-models.html#cb89-8" aria-hidden="true" tabindex="-1"></a>m1_response_plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot_the_treatments</span>(</span>
<span id="cb89-9"><a href="plotting-models.html#cb89-9" aria-hidden="true" tabindex="-1"></a>  m1_response_plot_base,</span>
<span id="cb89-10"><a href="plotting-models.html#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_levels =</span> x_levels,</span>
<span id="cb89-11"><a href="plotting-models.html#cb89-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">text_size =</span> <span class="fl">3.5</span>,</span>
<span id="cb89-12"><a href="plotting-models.html#cb89-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>)</span>
<span id="cb89-13"><a href="plotting-models.html#cb89-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-14"><a href="plotting-models.html#cb89-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-15"><a href="plotting-models.html#cb89-15" aria-hidden="true" tabindex="-1"></a>m1_response_plot2</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-ggplot_the_treatments-minus-1.png" width="576" /></p>
</div>
</div>
<div id="how-to-generate-a-response-plot-using-ggpubr" class="section level3" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> How to generate a Response Plot using ggpubr</h3>
<p>Steps 1-3 were completed above.</p>
<div id="plot-individual-points" class="section level4" number="4.2.5.1">
<h4><span class="header-section-number">4.2.5.1</span> Step 4: Plot the individual points</h4>
<p><strong>Using ggplot</strong></p>
<p>I’m going to show how to create the initial, base plot of points using ggplot2 in order to outline <strong>very briefly</strong> how ggplot2 works.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="plotting-models.html#cb90-1" aria-hidden="true" tabindex="-1"></a>m1_response <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb90-2"><a href="plotting-models.html#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fig2e,</span>
<span id="cb90-3"><a href="plotting-models.html#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="co"># these 2 lines define the axes</span></span>
<span id="cb90-4"><a href="plotting-models.html#cb90-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> glucose_auc,</span>
<span id="cb90-5"><a href="plotting-models.html#cb90-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> ask1 <span class="co"># define the grouping variable</span></span>
<span id="cb90-6"><a href="plotting-models.html#cb90-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb90-7"><a href="plotting-models.html#cb90-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-8"><a href="plotting-models.html#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># surprisingly, the code above doesn&#39;t plot anything</span></span>
<span id="cb90-9"><a href="plotting-models.html#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this adds the points as a layer</span></span>
<span id="cb90-10"><a href="plotting-models.html#cb90-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb90-11"><a href="plotting-models.html#cb90-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-12"><a href="plotting-models.html#cb90-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change the title of the y-axis</span></span>
<span id="cb90-13"><a href="plotting-models.html#cb90-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (mmol &quot;</span>, l<span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot; min)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb90-14"><a href="plotting-models.html#cb90-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-15"><a href="plotting-models.html#cb90-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change the theme</span></span>
<span id="cb90-16"><a href="plotting-models.html#cb90-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb90-17"><a href="plotting-models.html#cb90-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-18"><a href="plotting-models.html#cb90-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># these theme modifications need to be added after re-setting</span></span>
<span id="cb90-19"><a href="plotting-models.html#cb90-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the theme</span></span>
<span id="cb90-20"><a href="plotting-models.html#cb90-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb90-21"><a href="plotting-models.html#cb90-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="co"># remove legend</span></span>
<span id="cb90-22"><a href="plotting-models.html#cb90-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>() <span class="co"># remove the x-axis title</span></span>
<span id="cb90-23"><a href="plotting-models.html#cb90-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb90-24"><a href="plotting-models.html#cb90-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-25"><a href="plotting-models.html#cb90-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-26"><a href="plotting-models.html#cb90-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change the colors palette for the points</span></span>
<span id="cb90-27"><a href="plotting-models.html#cb90-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> pal_okabe_ito_blue) <span class="sc">+</span></span>
<span id="cb90-28"><a href="plotting-models.html#cb90-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-29"><a href="plotting-models.html#cb90-29" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb90-30"><a href="plotting-models.html#cb90-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-31"><a href="plotting-models.html#cb90-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-32"><a href="plotting-models.html#cb90-32" aria-hidden="true" tabindex="-1"></a>m1_response</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plot-ggplot-base-1.png" width="576" />
Notes</p>
<ol style="list-style-type: decimal">
<li>The <code>ggplot</code> function requires a data frame passed to <code>data</code> containing the data to plot and an aesthetic (<code>aes</code>), which passes the column names that set the x and y axes. These column names must be in the data frame passed to <code>data</code>. <code>color =</code> is an aesthetic that sets the grouping variable used to assign the different colors.</li>
<li>The x-axis is discrete but is numeric. The x-axis values are 1, 2, 3, 4. But instead of using these numbers as the labels for the x-axis values, ggplot uses the names of the groups (the four values of the column “treatment”)</li>
</ol>
<p><strong>Using ggpubr</strong></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="plotting-models.html#cb91-1" aria-hidden="true" tabindex="-1"></a>m1_response <span class="ot">&lt;-</span> <span class="fu">ggstripchart</span>(</span>
<span id="cb91-2"><a href="plotting-models.html#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fig2e,</span>
<span id="cb91-3"><a href="plotting-models.html#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb91-4"><a href="plotting-models.html#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">&quot;glucose_auc&quot;</span>,</span>
<span id="cb91-5"><a href="plotting-models.html#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">&quot;ask1&quot;</span>,</span>
<span id="cb91-6"><a href="plotting-models.html#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb91-7"><a href="plotting-models.html#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (mmol &quot;</span>, l<span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot; min)&quot;</span>)),</span>
<span id="cb91-8"><a href="plotting-models.html#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb91-9"><a href="plotting-models.html#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb91-10"><a href="plotting-models.html#cb91-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb91-11"><a href="plotting-models.html#cb91-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-12"><a href="plotting-models.html#cb91-12" aria-hidden="true" tabindex="-1"></a>m1_response</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plot-ggpubr-base-1.png" width="576" /></p>
</div>
<div id="step-5-plot-the-modeled-means-and-95-error-intervals" class="section level4" number="4.2.5.2">
<h4><span class="header-section-number">4.2.5.2</span> Step 5: Plot the modeled means and 95% error intervals</h4>
<p>To add points and error bars to <code>m1_response</code>, we need to tell ggplot the x-axis positions (or coordinates). These positions are the values of the “treatment” column in <code>fig2e</code>. The modeled means and and 95% CIs are in the <code>m1_emm</code> object but there is no “treatment” column, or any column with these values. We, therefore have to make this column before we can add the modeled means and CIs to the plot.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="plotting-models.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert m1_emm to a data.table</span></span>
<span id="cb92-2"><a href="plotting-models.html#cb92-2" aria-hidden="true" tabindex="-1"></a>m1_emm_dt <span class="ot">&lt;-</span> <span class="fu">summary</span>(m1_emm) <span class="sc">%&gt;%</span></span>
<span id="cb92-3"><a href="plotting-models.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb92-4"><a href="plotting-models.html#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="plotting-models.html#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create treatment column</span></span>
<span id="cb92-6"><a href="plotting-models.html#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co"># make sure it matches values in the two factor columns</span></span>
<span id="cb92-7"><a href="plotting-models.html#cb92-7" aria-hidden="true" tabindex="-1"></a>m1_emm_dt[, treatment <span class="sc">:</span><span class="er">=</span> <span class="fu">c</span>(<span class="st">&quot;ASK1F/F chow&quot;</span>,</span>
<span id="cb92-8"><a href="plotting-models.html#cb92-8" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;ASK1Δadipo chow&quot;</span>,</span>
<span id="cb92-9"><a href="plotting-models.html#cb92-9" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;ASK1F/F HFD&quot;</span>,</span>
<span id="cb92-10"><a href="plotting-models.html#cb92-10" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;ASK1Δadipo HFD&quot;</span>)]</span></code></pre></div>
<p>Now add the modeled means and CIs</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="plotting-models.html#cb93-1" aria-hidden="true" tabindex="-1"></a>m1_response <span class="ot">&lt;-</span> m1_response <span class="sc">+</span> </span>
<span id="cb93-2"><a href="plotting-models.html#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="plotting-models.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add layer containing means</span></span>
<span id="cb93-4"><a href="plotting-models.html#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> m1_emm_dt,</span>
<span id="cb93-5"><a href="plotting-models.html#cb93-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> emmean,</span>
<span id="cb93-6"><a href="plotting-models.html#cb93-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> ask1), </span>
<span id="cb93-7"><a href="plotting-models.html#cb93-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb93-8"><a href="plotting-models.html#cb93-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-9"><a href="plotting-models.html#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add layer containing error bars</span></span>
<span id="cb93-10"><a href="plotting-models.html#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> m1_emm_dt, </span>
<span id="cb93-11"><a href="plotting-models.html#cb93-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">y =</span> emmean,</span>
<span id="cb93-12"><a href="plotting-models.html#cb93-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> lower.CL, </span>
<span id="cb93-13"><a href="plotting-models.html#cb93-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> upper.CL,</span>
<span id="cb93-14"><a href="plotting-models.html#cb93-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> ask1), </span>
<span id="cb93-15"><a href="plotting-models.html#cb93-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb93-16"><a href="plotting-models.html#cb93-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-17"><a href="plotting-models.html#cb93-17" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb93-18"><a href="plotting-models.html#cb93-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-19"><a href="plotting-models.html#cb93-19" aria-hidden="true" tabindex="-1"></a>m1_response</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plot-mean-ci-1.png" width="576" /></p>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li><code>m1_response</code> generated by <code>ggpubr::stripchart</code> is a <code>ggplot2</code> object. This means modifications of the plot are implemented by adding these with the “+” sign.</li>
<li>The modeled means are in the column “emmean” in the data frame <code>m1_emm_dt</code>. We need to tell <code>geom_point</code> where to find the data using the <code>data =</code> argument. <code>geom_point()</code> (and other geoms) assumes that the points that we want to plot are defined by the same x and y column names used to create the plot – if these don’t exist, we need to state the x and y column names in the aesthetic function <code>aes</code>. Since we created a “treatment” column in <code>m1_emm_dt</code> that contains the x-axis coordiantes (1, 2, 3, 4), we do not need to tell ggplot where to find the x-values. But there is no “glucose_auc” column in <code>m1_emm_dt</code> so we need to tell <code>geom_point()</code> where to find the y values using <code>aes(y = "emmean")</code>.</li>
<li>Adding the modeled error intervals using <code>geom_errorbar</code> follows the same logic as adding the modeled means. Importantly, and interestingly, <code>y = emmean</code> has to be passed even though no information from this column is used to plot the error bars.</li>
<li>Note that column names passed to a <code>ggpubr</code> function must be in quotes but column names passed to a <code>ggplot2</code> function cannot be in quotes</li>
</ol>
</div>
<div id="step-6-adding-p-values" class="section level4" number="4.2.5.3">
<h4><span class="header-section-number">4.2.5.3</span> Step 6: Adding p-values</h4>
<p><em>p</em>-value brackets are added to a response plot using <code>stat_pvalue_manual</code> from the <code>ggpubr</code> package. This function needs a column of p-values, and a pair of columns that define the left and right x-axis positions of the bracket.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="plotting-models.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert m1_simple to a data.table</span></span>
<span id="cb94-2"><a href="plotting-models.html#cb94-2" aria-hidden="true" tabindex="-1"></a>m1_simple_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(m1_simple)</span>
<span id="cb94-3"><a href="plotting-models.html#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="plotting-models.html#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create group1 -- column containing x-position</span></span>
<span id="cb94-5"><a href="plotting-models.html#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co"># of the left side of the bracket</span></span>
<span id="cb94-6"><a href="plotting-models.html#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co"># need to look at m1_simple_dt to construct this.</span></span>
<span id="cb94-7"><a href="plotting-models.html#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;ASK1F/F chow&quot;, &quot;ASK1Δadipo chow&quot; ,&quot;ASK1F/F HFD&quot;, &quot;ASK1Δadipo HFD&quot; </span></span>
<span id="cb94-8"><a href="plotting-models.html#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="plotting-models.html#cb94-9" aria-hidden="true" tabindex="-1"></a>m1_simple_dt[, group1 <span class="sc">:</span><span class="er">=</span> <span class="fu">c</span>(<span class="st">&quot;ASK1Δadipo chow&quot;</span>,</span>
<span id="cb94-10"><a href="plotting-models.html#cb94-10" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;ASK1Δadipo HFD&quot;</span>,</span>
<span id="cb94-11"><a href="plotting-models.html#cb94-11" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;ASK1F/F HFD&quot;</span>,</span>
<span id="cb94-12"><a href="plotting-models.html#cb94-12" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;ASK1Δadipo HFD&quot;</span>)]</span>
<span id="cb94-13"><a href="plotting-models.html#cb94-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-14"><a href="plotting-models.html#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="co"># create group2 -- column containing x-position</span></span>
<span id="cb94-15"><a href="plotting-models.html#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="co"># of the right side of the bracket</span></span>
<span id="cb94-16"><a href="plotting-models.html#cb94-16" aria-hidden="true" tabindex="-1"></a><span class="co"># need to look at m1_simple_dt to construct this.</span></span>
<span id="cb94-17"><a href="plotting-models.html#cb94-17" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;ASK1F/F chow&quot;, &quot;ASK1Δadipo chow&quot; ,&quot;ASK1F/F HFD&quot;, &quot;ASK1Δadipo HFD&quot; </span></span>
<span id="cb94-18"><a href="plotting-models.html#cb94-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-19"><a href="plotting-models.html#cb94-19" aria-hidden="true" tabindex="-1"></a>m1_simple_dt[, group2 <span class="sc">:</span><span class="er">=</span> <span class="fu">c</span>(<span class="st">&quot;ASK1F/F chow&quot;</span>,</span>
<span id="cb94-20"><a href="plotting-models.html#cb94-20" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;ASK1F/F HFD&quot;</span>,</span>
<span id="cb94-21"><a href="plotting-models.html#cb94-21" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;ASK1F/F chow&quot;</span>,</span>
<span id="cb94-22"><a href="plotting-models.html#cb94-22" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;ASK1Δadipo chow&quot;</span>)]</span>
<span id="cb94-23"><a href="plotting-models.html#cb94-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-24"><a href="plotting-models.html#cb94-24" aria-hidden="true" tabindex="-1"></a>m1_simple_dt[, p_rounded <span class="sc">:</span><span class="er">=</span> <span class="fu">p_round</span>(p.value,</span>
<span id="cb94-25"><a href="plotting-models.html#cb94-25" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">digits =</span> <span class="dv">2</span>)]</span>
<span id="cb94-26"><a href="plotting-models.html#cb94-26" aria-hidden="true" tabindex="-1"></a>m1_simple_dt[, p_pretty <span class="sc">:</span><span class="er">=</span> <span class="fu">p_format</span>(p_rounded,</span>
<span id="cb94-27"><a href="plotting-models.html#cb94-27" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb94-28"><a href="plotting-models.html#cb94-28" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">accuracy =</span> <span class="fl">1e-04</span>,</span>
<span id="cb94-29"><a href="plotting-models.html#cb94-29" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">add.p =</span> <span class="cn">TRUE</span>)]</span></code></pre></div>
<p>Now add the p-values</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="plotting-models.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simply assigning this to a new plot with new name</span></span>
<span id="cb95-2"><a href="plotting-models.html#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># because I want to re-use the base plot in the next chunk</span></span>
<span id="cb95-3"><a href="plotting-models.html#cb95-3" aria-hidden="true" tabindex="-1"></a>m1_response_p <span class="ot">&lt;-</span> m1_response <span class="sc">+</span></span>
<span id="cb95-4"><a href="plotting-models.html#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_pvalue_manual</span>(</span>
<span id="cb95-5"><a href="plotting-models.html#cb95-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> m1_simple_dt,</span>
<span id="cb95-6"><a href="plotting-models.html#cb95-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;p_pretty&quot;</span>,</span>
<span id="cb95-7"><a href="plotting-models.html#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y.position =</span> <span class="fu">c</span>(<span class="dv">3300</span>, <span class="dv">3300</span>, <span class="dv">3450</span>, <span class="dv">3600</span>),</span>
<span id="cb95-8"><a href="plotting-models.html#cb95-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tip.length =</span> <span class="fl">0.01</span>)</span>
<span id="cb95-9"><a href="plotting-models.html#cb95-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-10"><a href="plotting-models.html#cb95-10" aria-hidden="true" tabindex="-1"></a>m1_response_p</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plot-manual-p-values-1.png" width="576" /></p>
<p>Notes on adding <em>p</em>-values to the plot:</p>
<ol style="list-style-type: decimal">
<li>The <code>y.position</code> argument in <code>stat_pvalue_manual()</code> contains the position on the y-axis for the p-value brackets. I typically choose these values “by eye.” Essentially, I look at the maximum y-value on the plot and then choose a value just above this for the first bracket. This may take some trial-and-error to position the brackets satisfactorily.</li>
<li>Use base R indexing to specify a subset. For example</li>
</ol>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="plotting-models.html#cb96-1" aria-hidden="true" tabindex="-1"></a>m1_response_p <span class="ot">&lt;-</span> m1_response <span class="sc">+</span></span>
<span id="cb96-2"><a href="plotting-models.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_pvalue_manual</span>(</span>
<span id="cb96-3"><a href="plotting-models.html#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> m1_simple_dt[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), ], <span class="co"># only rows 2, 4</span></span>
<span id="cb96-4"><a href="plotting-models.html#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;p_pretty&quot;</span>,</span>
<span id="cb96-5"><a href="plotting-models.html#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y.position =</span> <span class="fu">c</span>(<span class="dv">3300</span>, <span class="dv">3450</span>),</span>
<span id="cb96-6"><a href="plotting-models.html#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">tip.length =</span> <span class="fl">0.01</span>)</span>
<span id="cb96-7"><a href="plotting-models.html#cb96-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-8"><a href="plotting-models.html#cb96-8" aria-hidden="true" tabindex="-1"></a>m1_response_p</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plot-manual-p-values-subset-1.png" width="576" /></p>
<ol start="3" style="list-style-type: decimal">
<li><code>ggpubr::stat_compare_means</code> automates the process somewhat but the function is too limited for statistics on anything but the simplest experiments. I don’t advocate it’s use.</li>
</ol>
</div>
<div id="a-variation-for-factorial-models" class="section level4" number="4.2.5.4">
<h4><span class="header-section-number">4.2.5.4</span> A variation for factorial models</h4>
<p>The experiment in Fig2e has a factorial design and was analyzed (here, not in the original paper) using a factorial model. The factorial design can be represented in the plot by clustering the levels.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="plotting-models.html#cb97-1" aria-hidden="true" tabindex="-1"></a>dodge_width <span class="ot">=</span> <span class="fl">0.4</span></span>
<span id="cb97-2"><a href="plotting-models.html#cb97-2" aria-hidden="true" tabindex="-1"></a>jitter_width <span class="ot">=</span> <span class="fl">0.2</span></span>
<span id="cb97-3"><a href="plotting-models.html#cb97-3" aria-hidden="true" tabindex="-1"></a>m1_simple_dt[, xmin <span class="sc">:</span><span class="er">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>dodge_width<span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb97-4"><a href="plotting-models.html#cb97-4" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">2</span><span class="sc">-</span>dodge_width<span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb97-5"><a href="plotting-models.html#cb97-5" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">1</span><span class="sc">-</span>dodge_width<span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb97-6"><a href="plotting-models.html#cb97-6" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">1</span><span class="sc">+</span>dodge_width<span class="sc">/</span><span class="dv">4</span>)]</span>
<span id="cb97-7"><a href="plotting-models.html#cb97-7" aria-hidden="true" tabindex="-1"></a>m1_simple_dt[, xmax <span class="sc">:</span><span class="er">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">+</span>dodge_width<span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb97-8"><a href="plotting-models.html#cb97-8" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">2</span><span class="sc">+</span>dodge_width<span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb97-9"><a href="plotting-models.html#cb97-9" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">2</span><span class="sc">-</span>dodge_width<span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb97-10"><a href="plotting-models.html#cb97-10" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">2</span><span class="sc">+</span>dodge_width<span class="sc">/</span><span class="dv">4</span>)]</span>
<span id="cb97-11"><a href="plotting-models.html#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="plotting-models.html#cb97-12" aria-hidden="true" tabindex="-1"></a>m1_response_fac <span class="ot">&lt;-</span> <span class="fu">ggstripchart</span>(</span>
<span id="cb97-13"><a href="plotting-models.html#cb97-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fig2e,</span>
<span id="cb97-14"><a href="plotting-models.html#cb97-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">&quot;diet&quot;</span>,</span>
<span id="cb97-15"><a href="plotting-models.html#cb97-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">&quot;glucose_auc&quot;</span>,</span>
<span id="cb97-16"><a href="plotting-models.html#cb97-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">&quot;ask1&quot;</span>,</span>
<span id="cb97-17"><a href="plotting-models.html#cb97-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">&quot;ask1&quot;</span>,</span>
<span id="cb97-18"><a href="plotting-models.html#cb97-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (mmol &quot;</span>, l<span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot; min)&quot;</span>)),</span>
<span id="cb97-19"><a href="plotting-models.html#cb97-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb97-20"><a href="plotting-models.html#cb97-20" aria-hidden="true" tabindex="-1"></a><span class="co">#  position = position_dodge(width = dodge_width)</span></span>
<span id="cb97-21"><a href="plotting-models.html#cb97-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">dodge.width =</span> dodge_width,</span>
<span id="cb97-22"><a href="plotting-models.html#cb97-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">jitter.width =</span> jitter_width)</span>
<span id="cb97-23"><a href="plotting-models.html#cb97-23" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb97-24"><a href="plotting-models.html#cb97-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-25"><a href="plotting-models.html#cb97-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rremove</span>(<span class="st">&quot;xlab&quot;</span>) <span class="sc">+</span> <span class="co">#ggpubr function</span></span>
<span id="cb97-26"><a href="plotting-models.html#cb97-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-27"><a href="plotting-models.html#cb97-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add layer containing means</span></span>
<span id="cb97-28"><a href="plotting-models.html#cb97-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> m1_emm_dt,</span>
<span id="cb97-29"><a href="plotting-models.html#cb97-29" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> emmean,</span>
<span id="cb97-30"><a href="plotting-models.html#cb97-30" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> ask1), </span>
<span id="cb97-31"><a href="plotting-models.html#cb97-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb97-32"><a href="plotting-models.html#cb97-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> dodge_width)) <span class="sc">+</span></span>
<span id="cb97-33"><a href="plotting-models.html#cb97-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-34"><a href="plotting-models.html#cb97-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add layer containing error bars</span></span>
<span id="cb97-35"><a href="plotting-models.html#cb97-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> m1_emm_dt, </span>
<span id="cb97-36"><a href="plotting-models.html#cb97-36" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">y =</span> emmean,</span>
<span id="cb97-37"><a href="plotting-models.html#cb97-37" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> lower.CL, </span>
<span id="cb97-38"><a href="plotting-models.html#cb97-38" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> upper.CL,</span>
<span id="cb97-39"><a href="plotting-models.html#cb97-39" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> ask1), </span>
<span id="cb97-40"><a href="plotting-models.html#cb97-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.05</span>,</span>
<span id="cb97-41"><a href="plotting-models.html#cb97-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> dodge_width)) <span class="sc">+</span></span>
<span id="cb97-42"><a href="plotting-models.html#cb97-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-43"><a href="plotting-models.html#cb97-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add p-value brackets</span></span>
<span id="cb97-44"><a href="plotting-models.html#cb97-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_pvalue_manual</span>(</span>
<span id="cb97-45"><a href="plotting-models.html#cb97-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> m1_simple_dt,</span>
<span id="cb97-46"><a href="plotting-models.html#cb97-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;p_pretty&quot;</span>,</span>
<span id="cb97-47"><a href="plotting-models.html#cb97-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="st">&quot;xmin&quot;</span>,</span>
<span id="cb97-48"><a href="plotting-models.html#cb97-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="st">&quot;xmax&quot;</span>,</span>
<span id="cb97-49"><a href="plotting-models.html#cb97-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">y.position =</span> <span class="fu">c</span>(<span class="dv">3300</span>, <span class="dv">3300</span>, <span class="dv">3450</span>, <span class="dv">3600</span>),</span>
<span id="cb97-50"><a href="plotting-models.html#cb97-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">tip.length =</span> <span class="fl">0.01</span>,</span>
<span id="cb97-51"><a href="plotting-models.html#cb97-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb97-52"><a href="plotting-models.html#cb97-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-53"><a href="plotting-models.html#cb97-53" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb97-54"><a href="plotting-models.html#cb97-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-55"><a href="plotting-models.html#cb97-55" aria-hidden="true" tabindex="-1"></a>m1_response_fac</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plot-factorial-response-plot-1.png" width="576" /></p>
</div>
<div id="how-to-add-treatment-combinations-to-a-ggpubr-plot" class="section level4" number="4.2.5.5">
<h4><span class="header-section-number">4.2.5.5</span> How to add treatment combinations to a ggpubr plot</h4>
<p>Many researchers in bench biology insert a grid of treatments below the x-axis of a plot. This is time consuming if we are using some external software to add to this. A much leaner workflow would be to add the treatment grid in the same step as generating the plot itself. Here is a kludgy way to do this using a ggpubr plot. A much more elegant method is described below</p>
<div id="variant-1-fake-axes" class="section level5" number="4.2.5.5.1">
<h5><span class="header-section-number">4.2.5.5.1</span> Variant 1 – Fake axes</h5>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="plotting-models.html#cb98-1" aria-hidden="true" tabindex="-1"></a>use_this <span class="ot">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># if false use +/- symbols</span></span>
<span id="cb98-2"><a href="plotting-models.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(use_this <span class="sc">==</span> <span class="cn">TRUE</span>){</span>
<span id="cb98-3"><a href="plotting-models.html#cb98-3" aria-hidden="true" tabindex="-1"></a>  x_levels <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb98-4"><a href="plotting-models.html#cb98-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;ASK1:&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;F/F&quot;</span>, <span class="st">&quot;Δadipo&quot;</span>, <span class="st">&quot;F/F&quot;</span>, <span class="st">&quot;Δadipo&quot;</span>),</span>
<span id="cb98-5"><a href="plotting-models.html#cb98-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Diet:&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;chow&quot;</span>, <span class="st">&quot;chow&quot;</span>, <span class="st">&quot;HFD&quot;</span>, <span class="st">&quot;HFD&quot;</span>)</span>
<span id="cb98-6"><a href="plotting-models.html#cb98-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb98-7"><a href="plotting-models.html#cb98-7" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb98-8"><a href="plotting-models.html#cb98-8" aria-hidden="true" tabindex="-1"></a>  minus <span class="ot">&lt;-</span> <span class="st">&quot;\u2013&quot;</span> <span class="co"># good to put this in the setup chunk</span></span>
<span id="cb98-9"><a href="plotting-models.html#cb98-9" aria-hidden="true" tabindex="-1"></a>  x_levels <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb98-10"><a href="plotting-models.html#cb98-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Δadipo:&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(minus, <span class="st">&quot;+&quot;</span>, minus, <span class="st">&quot;+&quot;</span>),</span>
<span id="cb98-11"><a href="plotting-models.html#cb98-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;HFD: &quot;</span> <span class="ot">=</span> <span class="fu">c</span>(minus, minus, <span class="st">&quot;+&quot;</span>, <span class="st">&quot;+&quot;</span>)</span>
<span id="cb98-12"><a href="plotting-models.html#cb98-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb98-13"><a href="plotting-models.html#cb98-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-14"><a href="plotting-models.html#cb98-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-15"><a href="plotting-models.html#cb98-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-16"><a href="plotting-models.html#cb98-16" aria-hidden="true" tabindex="-1"></a>x_levels_text <span class="ot">&lt;-</span> <span class="fu">apply</span>(x_levels, <span class="dv">2</span>, paste0, <span class="at">collapse=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb98-17"><a href="plotting-models.html#cb98-17" aria-hidden="true" tabindex="-1"></a>x_levels_title <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">row.names</span>(x_levels), <span class="at">collapse=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb98-18"><a href="plotting-models.html#cb98-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-19"><a href="plotting-models.html#cb98-19" aria-hidden="true" tabindex="-1"></a>x_axis_min <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb98-20"><a href="plotting-models.html#cb98-20" aria-hidden="true" tabindex="-1"></a>x_axis_max <span class="ot">&lt;-</span> <span class="fl">4.5</span></span>
<span id="cb98-21"><a href="plotting-models.html#cb98-21" aria-hidden="true" tabindex="-1"></a>y_plot_min <span class="ot">&lt;-</span> <span class="dv">1200</span></span>
<span id="cb98-22"><a href="plotting-models.html#cb98-22" aria-hidden="true" tabindex="-1"></a>y_axis_min <span class="ot">&lt;-</span> <span class="dv">1350</span></span>
<span id="cb98-23"><a href="plotting-models.html#cb98-23" aria-hidden="true" tabindex="-1"></a>y_axis_max <span class="ot">&lt;-</span> <span class="dv">3500</span></span>
<span id="cb98-24"><a href="plotting-models.html#cb98-24" aria-hidden="true" tabindex="-1"></a>y_breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1500</span>, <span class="dv">3500</span>, <span class="at">by =</span> <span class="dv">500</span>)</span>
<span id="cb98-25"><a href="plotting-models.html#cb98-25" aria-hidden="true" tabindex="-1"></a>y_labels <span class="ot">&lt;-</span> <span class="fu">as.character</span>(y_breaks)</span>
<span id="cb98-26"><a href="plotting-models.html#cb98-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-27"><a href="plotting-models.html#cb98-27" aria-hidden="true" tabindex="-1"></a>m1_response_final <span class="ot">&lt;-</span> m1_response_p <span class="sc">+</span></span>
<span id="cb98-28"><a href="plotting-models.html#cb98-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(y_plot_min, y_axis_max)) <span class="sc">+</span></span>
<span id="cb98-29"><a href="plotting-models.html#cb98-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> y_breaks) <span class="sc">+</span></span>
<span id="cb98-30"><a href="plotting-models.html#cb98-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb98-31"><a href="plotting-models.html#cb98-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_blank</span>(), <span class="co"># remove both x &amp; y axis lines</span></span>
<span id="cb98-32"><a href="plotting-models.html#cb98-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="co"># remove x-axis labels</span></span>
<span id="cb98-33"><a href="plotting-models.html#cb98-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>() <span class="co"># remove x-axis ticks</span></span>
<span id="cb98-34"><a href="plotting-models.html#cb98-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb98-35"><a href="plotting-models.html#cb98-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-36"><a href="plotting-models.html#cb98-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add shortened y-axis line that doesn&#39;t extend to treatments</span></span>
<span id="cb98-37"><a href="plotting-models.html#cb98-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_axis_min <span class="sc">+</span> <span class="fl">0.01</span>,</span>
<span id="cb98-38"><a href="plotting-models.html#cb98-38" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y_axis_min,</span>
<span id="cb98-39"><a href="plotting-models.html#cb98-39" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> x_axis_min <span class="sc">+</span> <span class="fl">0.01</span>,</span>
<span id="cb98-40"><a href="plotting-models.html#cb98-40" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> y_axis_max),</span>
<span id="cb98-41"><a href="plotting-models.html#cb98-41" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb98-42"><a href="plotting-models.html#cb98-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-43"><a href="plotting-models.html#cb98-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add x-axis line above treatments</span></span>
<span id="cb98-44"><a href="plotting-models.html#cb98-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_axis_min,</span>
<span id="cb98-45"><a href="plotting-models.html#cb98-45" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y_axis_min,</span>
<span id="cb98-46"><a href="plotting-models.html#cb98-46" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> x_axis_max,</span>
<span id="cb98-47"><a href="plotting-models.html#cb98-47" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> y_axis_min),</span>
<span id="cb98-48"><a href="plotting-models.html#cb98-48" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb98-49"><a href="plotting-models.html#cb98-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-50"><a href="plotting-models.html#cb98-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add treatment combinations</span></span>
<span id="cb98-51"><a href="plotting-models.html#cb98-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb98-52"><a href="plotting-models.html#cb98-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb98-53"><a href="plotting-models.html#cb98-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> y_plot_min,</span>
<span id="cb98-54"><a href="plotting-models.html#cb98-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> x_levels_text) <span class="sc">+</span></span>
<span id="cb98-55"><a href="plotting-models.html#cb98-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-56"><a href="plotting-models.html#cb98-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add factor names</span></span>
<span id="cb98-57"><a href="plotting-models.html#cb98-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb98-58"><a href="plotting-models.html#cb98-58" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> x_axis_min,</span>
<span id="cb98-59"><a href="plotting-models.html#cb98-59" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> y_plot_min,</span>
<span id="cb98-60"><a href="plotting-models.html#cb98-60" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> x_levels_title,</span>
<span id="cb98-61"><a href="plotting-models.html#cb98-61" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb98-62"><a href="plotting-models.html#cb98-62" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb98-63"><a href="plotting-models.html#cb98-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-64"><a href="plotting-models.html#cb98-64" aria-hidden="true" tabindex="-1"></a>m1_response_final</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-how%20to%20plot%20treatments-1.png" width="576" /></p>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li><code>ggplot_the_treatments</code> should work with any ggplot, including those generated by ggpubr functions, with categorical values on the x-axis.</li>
<li>Here, I add the treatment combinations manually. The table of combinations is added inside the plot area (inside the axes). To make this look nice, and not weird, the x and y axes are removed and new lines are inserted to create new axis lines. The bottom of the new y-axis line starts above the treatment table. The new x-axis line is inserted above the treatment table.</li>
<li>To include the treatment combination (group) names, add this as the first row of <code>x_levels</code>.</li>
<li>Note that if the plot has a grid, this grid will extend into the area occupied by the treatment table using this method.</li>
</ol>
</div>
</div>
</div>
<div id="how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2" class="section level3" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> How to generate a Response Plot with a grid of treatments using ggplot2</h3>
<p>Above, I wrote a <a href="plotting-models.html#plot-individual-points">short script for generating the base response plot</a> using ggplot. In this plot, the x-axis variable (“treatment”) is categorical and ggplot uses the integers 1, 2, 3, 4 as the coordinate values for the position of the four groups on the x-axis. Understanding this mapping is important for adding lines to a plot or annotating a plot with text, both of which requires x,y coordinates to position the feature. While the x-axis is discrete – I cannot add a tick at x = 1.5 – the horizontal dimension of the plot area itself is continuous and I can add points or lines or text at any x coordinate within the plot area.</p>
<p>Here I generate the same plot using a continuous x-axis. This requires that I explicitly create a numeric column in the data with the x-axis position for each group. This is easy. The advantage of this is that I now have a continuous x-axis that is more manipulatable than a discrete x-axis. I use this to add treatment levels below the plot</p>
<div id="first-wrangle-the-data" class="section level4" number="4.2.6.1">
<h4><span class="header-section-number">4.2.6.1</span> First, wrangle the data</h4>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="plotting-models.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make sure treatment is a factor with the levels in the </span></span>
<span id="cb99-2"><a href="plotting-models.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co"># desired order</span></span>
<span id="cb99-3"><a href="plotting-models.html#cb99-3" aria-hidden="true" tabindex="-1"></a>fig2e[, treatment_i <span class="sc">:</span><span class="er">=</span> <span class="fu">as.integer</span>(treatment)]</span>
<span id="cb99-4"><a href="plotting-models.html#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="plotting-models.html#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co"># convert m1_emm to a data.table</span></span>
<span id="cb99-6"><a href="plotting-models.html#cb99-6" aria-hidden="true" tabindex="-1"></a>m1_emm_dt_i <span class="ot">&lt;-</span> <span class="fu">summary</span>(m1_emm) <span class="sc">%&gt;%</span></span>
<span id="cb99-7"><a href="plotting-models.html#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb99-8"><a href="plotting-models.html#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="plotting-models.html#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create treatment_i column</span></span>
<span id="cb99-10"><a href="plotting-models.html#cb99-10" aria-hidden="true" tabindex="-1"></a>m1_emm_dt_i[, treatment_i <span class="sc">:</span><span class="er">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb99-11"><a href="plotting-models.html#cb99-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-12"><a href="plotting-models.html#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="co"># convert m1_simple to a data.table</span></span>
<span id="cb99-13"><a href="plotting-models.html#cb99-13" aria-hidden="true" tabindex="-1"></a>m1_simple_dt_i <span class="ot">&lt;-</span> <span class="fu">data.table</span>(m1_simple)</span>
<span id="cb99-14"><a href="plotting-models.html#cb99-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-15"><a href="plotting-models.html#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="co"># create group1 -- column containing x-position</span></span>
<span id="cb99-16"><a href="plotting-models.html#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="co"># of the left side of the bracket</span></span>
<span id="cb99-17"><a href="plotting-models.html#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="co"># need to look at m1_simple_dt to construct this.</span></span>
<span id="cb99-18"><a href="plotting-models.html#cb99-18" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;ASK1F/F chow&quot;, &quot;ASK1Δadipo chow&quot; ,&quot;ASK1F/F HFD&quot;, &quot;ASK1Δadipo HFD&quot; </span></span>
<span id="cb99-19"><a href="plotting-models.html#cb99-19" aria-hidden="true" tabindex="-1"></a>m1_simple_dt_i[, group1 <span class="sc">:</span><span class="er">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>)]</span>
<span id="cb99-20"><a href="plotting-models.html#cb99-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-21"><a href="plotting-models.html#cb99-21" aria-hidden="true" tabindex="-1"></a><span class="co"># create group2 -- column containing x-position</span></span>
<span id="cb99-22"><a href="plotting-models.html#cb99-22" aria-hidden="true" tabindex="-1"></a><span class="co"># of the right side of the bracket</span></span>
<span id="cb99-23"><a href="plotting-models.html#cb99-23" aria-hidden="true" tabindex="-1"></a><span class="co"># need to look at m1_simple_dt to construct this.</span></span>
<span id="cb99-24"><a href="plotting-models.html#cb99-24" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;ASK1F/F chow&quot;, &quot;ASK1Δadipo chow&quot; ,&quot;ASK1F/F HFD&quot;, &quot;ASK1Δadipo HFD&quot; </span></span>
<span id="cb99-25"><a href="plotting-models.html#cb99-25" aria-hidden="true" tabindex="-1"></a>m1_simple_dt_i[, group2 <span class="sc">:</span><span class="er">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>)]</span>
<span id="cb99-26"><a href="plotting-models.html#cb99-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-27"><a href="plotting-models.html#cb99-27" aria-hidden="true" tabindex="-1"></a>m1_simple_dt_i[, p_rounded <span class="sc">:</span><span class="er">=</span> <span class="fu">p_round</span>(p.value,</span>
<span id="cb99-28"><a href="plotting-models.html#cb99-28" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">digits =</span> <span class="dv">2</span>)]</span>
<span id="cb99-29"><a href="plotting-models.html#cb99-29" aria-hidden="true" tabindex="-1"></a>m1_simple_dt_i[, p_pretty <span class="sc">:</span><span class="er">=</span> <span class="fu">p_format</span>(p_rounded,</span>
<span id="cb99-30"><a href="plotting-models.html#cb99-30" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb99-31"><a href="plotting-models.html#cb99-31" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">accuracy =</span> <span class="fl">1e-04</span>,</span>
<span id="cb99-32"><a href="plotting-models.html#cb99-32" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">add.p =</span> <span class="cn">TRUE</span>)]</span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The first line simply converts the categorical variable treatment into a numeric variable with values 1-4 assigned to the four treatment levels.</li>
<li>As above, <code>m1_emm_dt</code> is created and a column with the x-variable name is added</li>
<li>As above, <code>m1_simple_dt</code> is created and group1 and group2 columns with the x-axis positions of the two groups in the contrast are created. Here these columns are integers and not group names.</li>
</ol>
</div>
<div id="second-generate-the-plot" class="section level4" number="4.2.6.2">
<h4><span class="header-section-number">4.2.6.2</span> Second, generate the plot</h4>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="plotting-models.html#cb100-1" aria-hidden="true" tabindex="-1"></a>m1_response_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb100-2"><a href="plotting-models.html#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fig2e,</span>
<span id="cb100-3"><a href="plotting-models.html#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> treatment_i, <span class="co"># these 2 lines define the axes</span></span>
<span id="cb100-4"><a href="plotting-models.html#cb100-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> glucose_auc,</span>
<span id="cb100-5"><a href="plotting-models.html#cb100-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> ask1 <span class="co"># define the grouping variable</span></span>
<span id="cb100-6"><a href="plotting-models.html#cb100-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb100-7"><a href="plotting-models.html#cb100-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-8"><a href="plotting-models.html#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add jittered points</span></span>
<span id="cb100-9"><a href="plotting-models.html#cb100-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb100-10"><a href="plotting-models.html#cb100-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-11"><a href="plotting-models.html#cb100-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add layer containing means</span></span>
<span id="cb100-12"><a href="plotting-models.html#cb100-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> m1_emm_dt_i,</span>
<span id="cb100-13"><a href="plotting-models.html#cb100-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> emmean,</span>
<span id="cb100-14"><a href="plotting-models.html#cb100-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> ask1), </span>
<span id="cb100-15"><a href="plotting-models.html#cb100-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb100-16"><a href="plotting-models.html#cb100-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-17"><a href="plotting-models.html#cb100-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add layer containing error bars</span></span>
<span id="cb100-18"><a href="plotting-models.html#cb100-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> m1_emm_dt_i, </span>
<span id="cb100-19"><a href="plotting-models.html#cb100-19" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">y =</span> emmean,</span>
<span id="cb100-20"><a href="plotting-models.html#cb100-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> lower.CL, </span>
<span id="cb100-21"><a href="plotting-models.html#cb100-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> upper.CL,</span>
<span id="cb100-22"><a href="plotting-models.html#cb100-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> ask1), </span>
<span id="cb100-23"><a href="plotting-models.html#cb100-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb100-24"><a href="plotting-models.html#cb100-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-25"><a href="plotting-models.html#cb100-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the p-value brackets</span></span>
<span id="cb100-26"><a href="plotting-models.html#cb100-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_pvalue_manual</span>(</span>
<span id="cb100-27"><a href="plotting-models.html#cb100-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> m1_simple_dt_i[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), ], <span class="co"># only rows 2, 4</span></span>
<span id="cb100-28"><a href="plotting-models.html#cb100-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;p_pretty&quot;</span>,</span>
<span id="cb100-29"><a href="plotting-models.html#cb100-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y.position =</span> <span class="fu">c</span>(<span class="dv">3300</span>, <span class="dv">3450</span>),</span>
<span id="cb100-30"><a href="plotting-models.html#cb100-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">tip.length =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb100-31"><a href="plotting-models.html#cb100-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-32"><a href="plotting-models.html#cb100-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change the title of the y-axis</span></span>
<span id="cb100-33"><a href="plotting-models.html#cb100-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (mmol &quot;</span>, l<span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot; min)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb100-34"><a href="plotting-models.html#cb100-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-35"><a href="plotting-models.html#cb100-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change the theme</span></span>
<span id="cb100-36"><a href="plotting-models.html#cb100-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb100-37"><a href="plotting-models.html#cb100-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-38"><a href="plotting-models.html#cb100-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># these theme modifications need to be added after re-setting</span></span>
<span id="cb100-39"><a href="plotting-models.html#cb100-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the theme</span></span>
<span id="cb100-40"><a href="plotting-models.html#cb100-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb100-41"><a href="plotting-models.html#cb100-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="co"># remove legend</span></span>
<span id="cb100-42"><a href="plotting-models.html#cb100-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>() <span class="co"># remove the x-axis title</span></span>
<span id="cb100-43"><a href="plotting-models.html#cb100-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb100-44"><a href="plotting-models.html#cb100-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-45"><a href="plotting-models.html#cb100-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change the colors palette for the points</span></span>
<span id="cb100-46"><a href="plotting-models.html#cb100-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> pal_okabe_ito_blue) <span class="sc">+</span></span>
<span id="cb100-47"><a href="plotting-models.html#cb100-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-48"><a href="plotting-models.html#cb100-48" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb100-49"><a href="plotting-models.html#cb100-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-50"><a href="plotting-models.html#cb100-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-51"><a href="plotting-models.html#cb100-51" aria-hidden="true" tabindex="-1"></a>m1_response_2</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-ggplot-continuous-x-1.png" width="576" /></p>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>This code is exactly the same as <a href="plotting-models.html#plot-individual-points">that above</a> but uses an x-variable that is numeric instead of a factor.</li>
</ol>
</div>
<div id="third-add-the-grid-of-treatments-below-the-x-axis" class="section level4" number="4.2.6.3">
<h4><span class="header-section-number">4.2.6.3</span> Third, add the grid of treatments below the x-axis</h4>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="plotting-models.html#cb101-1" aria-hidden="true" tabindex="-1"></a>minus <span class="ot">&lt;-</span> <span class="st">&quot;\u2013&quot;</span> <span class="co"># good to put this in the setup chunk</span></span>
<span id="cb101-2"><a href="plotting-models.html#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="plotting-models.html#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># I&#39;ve added x-axis group names in addition to the grid</span></span>
<span id="cb101-4"><a href="plotting-models.html#cb101-4" aria-hidden="true" tabindex="-1"></a>x_levels <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb101-5"><a href="plotting-models.html#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Δadipo&quot;</span>, <span class="st">&quot;HFD&quot;</span>, <span class="st">&quot;Δadipo+HFD&quot;</span>),</span>
<span id="cb101-6"><a href="plotting-models.html#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;Δadipo:&quot;</span>, minus, <span class="st">&quot;+&quot;</span>, minus, <span class="st">&quot;+&quot;</span>),</span>
<span id="cb101-7"><a href="plotting-models.html#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;HFD: &quot;</span>, minus, minus, <span class="st">&quot;+&quot;</span>, <span class="st">&quot;+&quot;</span>)</span>
<span id="cb101-8"><a href="plotting-models.html#cb101-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb101-9"><a href="plotting-models.html#cb101-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-10"><a href="plotting-models.html#cb101-10" aria-hidden="true" tabindex="-1"></a>x_breaks_text <span class="ot">&lt;-</span> <span class="fu">apply</span>(x_levels, <span class="dv">2</span>, paste0, <span class="at">collapse=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb101-11"><a href="plotting-models.html#cb101-11" aria-hidden="true" tabindex="-1"></a>x_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb101-12"><a href="plotting-models.html#cb101-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-13"><a href="plotting-models.html#cb101-13" aria-hidden="true" tabindex="-1"></a>m1_response_2 <span class="ot">&lt;-</span> m1_response_2 <span class="sc">+</span></span>
<span id="cb101-14"><a href="plotting-models.html#cb101-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>)) <span class="sc">+</span></span>
<span id="cb101-15"><a href="plotting-models.html#cb101-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> x_breaks,</span>
<span id="cb101-16"><a href="plotting-models.html#cb101-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> x_breaks_text,</span>
<span id="cb101-17"><a href="plotting-models.html#cb101-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb101-18"><a href="plotting-models.html#cb101-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="co"># remove x-axis ticks</span></span>
<span id="cb101-19"><a href="plotting-models.html#cb101-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-20"><a href="plotting-models.html#cb101-20" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb101-21"><a href="plotting-models.html#cb101-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb101-22"><a href="plotting-models.html#cb101-22" aria-hidden="true" tabindex="-1"></a>m1_response_2</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-method3-treatment-grid-1.png" width="576" />
Notes</p>
<ol style="list-style-type: decimal">
<li>This is a good plot. A pretty good plot would include the effects.</li>
</ol>
</div>
</div>
<div id="how-to-generate-an-effects-plot" class="section level3" number="4.2.7">
<h3><span class="header-section-number">4.2.7</span> How to generate an Effects Plot</h3>
<p>The effects plot is built using ggplot2 instead of ggpubr because the plot is “flipped” – the y-axis is the categorical variable and the x-axis is the continuous variable. The base plot with the estimates (but not the error bars) could be made using ggpubr (see below) but the subsequent functions to modify the plot are awkward because of inconsistencies in the designation of the x and y-axis (old or new?).</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="plotting-models.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use the m1_simple_dt object created above</span></span>
<span id="cb102-2"><a href="plotting-models.html#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="plotting-models.html#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create nice labels for the contrasts</span></span>
<span id="cb102-4"><a href="plotting-models.html#cb102-4" aria-hidden="true" tabindex="-1"></a>m1_simple_dt[, contrast_pretty <span class="sc">:</span><span class="er">=</span> <span class="fu">c</span>(<span class="st">&quot;ASK1Δadipo - Control&quot;</span>,</span>
<span id="cb102-5"><a href="plotting-models.html#cb102-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;ASK1Δadipo - HFD&quot;</span>,</span>
<span id="cb102-6"><a href="plotting-models.html#cb102-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;HFD - Control&quot;</span>,</span>
<span id="cb102-7"><a href="plotting-models.html#cb102-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;ASK1Δadipo+HFD - ASK1Δadipo&quot;</span>)]</span>
<span id="cb102-8"><a href="plotting-models.html#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="co"># make sure the levels of contrast_pretty are in the order of that in</span></span>
<span id="cb102-9"><a href="plotting-models.html#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="co"># m1_simple_dt</span></span>
<span id="cb102-10"><a href="plotting-models.html#cb102-10" aria-hidden="true" tabindex="-1"></a>m1_simple_dt[, contrast_pretty <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(contrast_pretty,</span>
<span id="cb102-11"><a href="plotting-models.html#cb102-11" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">levels =</span> contrast_pretty)]</span>
<span id="cb102-12"><a href="plotting-models.html#cb102-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-13"><a href="plotting-models.html#cb102-13" aria-hidden="true" tabindex="-1"></a>m1_effects <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> m1_simple_dt,</span>
<span id="cb102-14"><a href="plotting-models.html#cb102-14" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> estimate,</span>
<span id="cb102-15"><a href="plotting-models.html#cb102-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> contrast_pretty)) <span class="sc">+</span></span>
<span id="cb102-16"><a href="plotting-models.html#cb102-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-17"><a href="plotting-models.html#cb102-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb102-18"><a href="plotting-models.html#cb102-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-19"><a href="plotting-models.html#cb102-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Effects (mmol/L)&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-20"><a href="plotting-models.html#cb102-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-21"><a href="plotting-models.html#cb102-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add error bars</span></span>
<span id="cb102-22"><a href="plotting-models.html#cb102-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate,</span>
<span id="cb102-23"><a href="plotting-models.html#cb102-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> lower.CL,</span>
<span id="cb102-24"><a href="plotting-models.html#cb102-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax =</span> upper.CL),</span>
<span id="cb102-25"><a href="plotting-models.html#cb102-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.02</span>) <span class="sc">+</span></span>
<span id="cb102-26"><a href="plotting-models.html#cb102-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-27"><a href="plotting-models.html#cb102-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add zero effect line</span></span>
<span id="cb102-28"><a href="plotting-models.html#cb102-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb102-29"><a href="plotting-models.html#cb102-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb102-30"><a href="plotting-models.html#cb102-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pal_okabe_ito_blue[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb102-31"><a href="plotting-models.html#cb102-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-32"><a href="plotting-models.html#cb102-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add p-values</span></span>
<span id="cb102-33"><a href="plotting-models.html#cb102-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb102-34"><a href="plotting-models.html#cb102-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> m1_simple_dt<span class="sc">$</span>estimate <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb102-35"><a href="plotting-models.html#cb102-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">+</span> <span class="fl">0.2</span>,</span>
<span id="cb102-36"><a href="plotting-models.html#cb102-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> m1_simple_dt<span class="sc">$</span>p_pretty,</span>
<span id="cb102-37"><a href="plotting-models.html#cb102-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb102-38"><a href="plotting-models.html#cb102-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-39"><a href="plotting-models.html#cb102-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb102-40"><a href="plotting-models.html#cb102-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rremove</span>(<span class="st">&quot;ylab&quot;</span>) <span class="sc">+</span> <span class="co">#remove y-axis, ggpubr function</span></span>
<span id="cb102-41"><a href="plotting-models.html#cb102-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-42"><a href="plotting-models.html#cb102-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-43"><a href="plotting-models.html#cb102-43" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb102-44"><a href="plotting-models.html#cb102-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-45"><a href="plotting-models.html#cb102-45" aria-hidden="true" tabindex="-1"></a>m1_effects</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-how-to-plot-effects-1.png" width="576" /></p>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li><code>c(-30,0,0,0)</code> is added to the x coordinate to shift the first p-value to the left of the zero-effect line.</li>
</ol>
<p><strong>how would this be done with ggpubr?</strong></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="plotting-models.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use the modified m1_simple_dt object created in the previous chunk</span></span>
<span id="cb103-2"><a href="plotting-models.html#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="plotting-models.html#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co"># use ggpubr::ggerrorplot with no error</span></span>
<span id="cb103-4"><a href="plotting-models.html#cb103-4" aria-hidden="true" tabindex="-1"></a>m1_effects_pubr <span class="ot">&lt;-</span> <span class="fu">ggerrorplot</span>(<span class="at">data =</span> m1_simple_dt,</span>
<span id="cb103-5"><a href="plotting-models.html#cb103-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="st">&quot;estimate&quot;</span>,</span>
<span id="cb103-6"><a href="plotting-models.html#cb103-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">x =</span> <span class="st">&quot;contrast_pretty&quot;</span>,</span>
<span id="cb103-7"><a href="plotting-models.html#cb103-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ylab =</span> <span class="st">&quot;Effects (mmol/L)&quot;</span>,</span>
<span id="cb103-8"><a href="plotting-models.html#cb103-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">desc_stat =</span> <span class="st">&quot;mean&quot;</span>, <span class="co"># mean only!</span></span>
<span id="cb103-9"><a href="plotting-models.html#cb103-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">orientation =</span> <span class="st">&quot;horizontal&quot;</span>) <span class="sc">+</span></span>
<span id="cb103-10"><a href="plotting-models.html#cb103-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-11"><a href="plotting-models.html#cb103-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove y-axis title</span></span>
<span id="cb103-12"><a href="plotting-models.html#cb103-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rremove</span>(<span class="st">&quot;ylab&quot;</span>) <span class="sc">+</span> <span class="co">#ggpubr function</span></span>
<span id="cb103-13"><a href="plotting-models.html#cb103-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-14"><a href="plotting-models.html#cb103-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add error bars using ggplot function</span></span>
<span id="cb103-15"><a href="plotting-models.html#cb103-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note using original (not horizontal) axis designation</span></span>
<span id="cb103-16"><a href="plotting-models.html#cb103-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate,</span>
<span id="cb103-17"><a href="plotting-models.html#cb103-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> lower.CL,</span>
<span id="cb103-18"><a href="plotting-models.html#cb103-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> upper.CL),</span>
<span id="cb103-19"><a href="plotting-models.html#cb103-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.02</span>) <span class="sc">+</span></span>
<span id="cb103-20"><a href="plotting-models.html#cb103-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-21"><a href="plotting-models.html#cb103-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add zero effect line using ggplot function</span></span>
<span id="cb103-22"><a href="plotting-models.html#cb103-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note using original (not horizontal) axis designation</span></span>
<span id="cb103-23"><a href="plotting-models.html#cb103-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb103-24"><a href="plotting-models.html#cb103-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb103-25"><a href="plotting-models.html#cb103-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pal_okabe_ito_blue[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb103-26"><a href="plotting-models.html#cb103-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-27"><a href="plotting-models.html#cb103-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add p-values</span></span>
<span id="cb103-28"><a href="plotting-models.html#cb103-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note using original (not horizontal) axis designation</span></span>
<span id="cb103-29"><a href="plotting-models.html#cb103-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb103-30"><a href="plotting-models.html#cb103-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> m1_simple_dt<span class="sc">$</span>estimate <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb103-31"><a href="plotting-models.html#cb103-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">+</span> <span class="fl">0.3</span>,</span>
<span id="cb103-32"><a href="plotting-models.html#cb103-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> m1_simple_dt<span class="sc">$</span>p_pretty,</span>
<span id="cb103-33"><a href="plotting-models.html#cb103-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb103-34"><a href="plotting-models.html#cb103-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-35"><a href="plotting-models.html#cb103-35" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb103-36"><a href="plotting-models.html#cb103-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-37"><a href="plotting-models.html#cb103-37" aria-hidden="true" tabindex="-1"></a>m1_effects_pubr</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-how-to-plot-effects-ggpubr-1.png" width="576" /></p>
</div>
<div id="how-to-combine-the-response-and-effects-plots" class="section level3" number="4.2.8">
<h3><span class="header-section-number">4.2.8</span> How to combine the response and effects plots</h3>
<div id="using-the-ggpubr-response-plot" class="section level4" number="4.2.8.1">
<h4><span class="header-section-number">4.2.8.1</span> Using the ggpubr response plot</h4>
<p>The <code>cowplot::plotgrid()</code> function is used generally to arrange multiple plots into a single figure. Here I use it to combine the response and effects subplots into a single plot. The response plot is <code>m1_response</code> created using ggpubr.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="plotting-models.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># modify the response and effects plots for consistency</span></span>
<span id="cb104-2"><a href="plotting-models.html#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="plotting-models.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># change group names for consistency</span></span>
<span id="cb104-4"><a href="plotting-models.html#cb104-4" aria-hidden="true" tabindex="-1"></a>groups_pretty <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,</span>
<span id="cb104-5"><a href="plotting-models.html#cb104-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;ASK1Δadipo&quot;</span>,</span>
<span id="cb104-6"><a href="plotting-models.html#cb104-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;HFD&quot;</span>,</span>
<span id="cb104-7"><a href="plotting-models.html#cb104-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;ASK1Δadipo+HFD&quot;</span>)</span>
<span id="cb104-8"><a href="plotting-models.html#cb104-8" aria-hidden="true" tabindex="-1"></a>m1_bottom <span class="ot">&lt;-</span> m1_response <span class="sc">+</span></span>
<span id="cb104-9"><a href="plotting-models.html#cb104-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> groups_pretty) <span class="sc">+</span></span>
<span id="cb104-10"><a href="plotting-models.html#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="co"># rotate to horizontal</span></span>
<span id="cb104-11"><a href="plotting-models.html#cb104-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-12"><a href="plotting-models.html#cb104-12" aria-hidden="true" tabindex="-1"></a>m1_top <span class="ot">&lt;-</span> m1_effects <span class="sc">+</span> <span class="co"># assign to new plot object</span></span>
<span id="cb104-13"><a href="plotting-models.html#cb104-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">position=</span><span class="st">&quot;top&quot;</span>) <span class="co"># move x-axis to &quot;top&quot;</span></span>
<span id="cb104-14"><a href="plotting-models.html#cb104-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-15"><a href="plotting-models.html#cb104-15" aria-hidden="true" tabindex="-1"></a>m1_plot <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(m1_top,</span>
<span id="cb104-16"><a href="plotting-models.html#cb104-16" aria-hidden="true" tabindex="-1"></a>                     m1_bottom,</span>
<span id="cb104-17"><a href="plotting-models.html#cb104-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb104-18"><a href="plotting-models.html#cb104-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb104-19"><a href="plotting-models.html#cb104-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis =</span> <span class="st">&quot;lr&quot;</span>,</span>
<span id="cb104-20"><a href="plotting-models.html#cb104-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb104-21"><a href="plotting-models.html#cb104-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-22"><a href="plotting-models.html#cb104-22" aria-hidden="true" tabindex="-1"></a>m1_plot</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-combined-plot-1.png" width="576" />
Notes</p>
<ol style="list-style-type: decimal">
<li>The response plot was flipped in this code. If you know that you want it in this orientation, simply build it with this orientation to avoid the kinds of axis designation ambiguities highlighted above with the ggpubr effects plot.</li>
<li>the <code>align</code> and <code>axis</code> arguments are used to force the plot areas to have the same width.</li>
<li><code>rel_heights = c()</code> adjusts the relative heights of the top and bottom plot. This typically requires fiddling.</li>
<li>The placement of the p-values looks different than it does in the standalone effects plot. To improve the look in the combined plot, fiddle with the placement argument (the x and y positions) in the chunk that generates the effects plot.</li>
</ol>
</div>
<div id="using-a-response-plot-with-a-treatment-grid" class="section level4" number="4.2.8.2">
<h4><span class="header-section-number">4.2.8.2</span> Using a response plot with a treatment grid</h4>
<p>Here, I re-build the response plot in a horizontal orientation</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="plotting-models.html#cb105-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="st">&quot;\u0009&quot;</span>  <span class="co"># good to put this in the setup chunk</span></span>
<span id="cb105-2"><a href="plotting-models.html#cb105-2" aria-hidden="true" tabindex="-1"></a>minus <span class="ot">&lt;-</span> <span class="st">&quot;\u2013&quot;</span> <span class="co"># good to put this in the setup chunk</span></span>
<span id="cb105-3"><a href="plotting-models.html#cb105-3" aria-hidden="true" tabindex="-1"></a>minus_pad <span class="ot">&lt;-</span> <span class="fu">paste0</span>(minus, <span class="st">&quot;    &quot;</span>)</span>
<span id="cb105-4"><a href="plotting-models.html#cb105-4" aria-hidden="true" tabindex="-1"></a>plus_pad <span class="ot">&lt;-</span> <span class="st">&quot;+    &quot;</span></span>
<span id="cb105-5"><a href="plotting-models.html#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="plotting-models.html#cb105-6" aria-hidden="true" tabindex="-1"></a>x_levels <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb105-7"><a href="plotting-models.html#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(minus_pad, plus_pad, minus_pad, plus_pad),</span>
<span id="cb105-8"><a href="plotting-models.html#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(minus_pad, minus_pad, plus_pad, plus_pad)</span>
<span id="cb105-9"><a href="plotting-models.html#cb105-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-10"><a href="plotting-models.html#cb105-10" aria-hidden="true" tabindex="-1"></a>x_breaks_text <span class="ot">&lt;-</span> <span class="fu">apply</span>(x_levels, <span class="dv">2</span>, paste0, <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb105-11"><a href="plotting-models.html#cb105-11" aria-hidden="true" tabindex="-1"></a>x_breaks_text <span class="ot">&lt;-</span> <span class="fu">c</span>(x_breaks_text, <span class="st">&quot;Δadipo HFD&quot;</span>)</span>
<span id="cb105-12"><a href="plotting-models.html#cb105-12" aria-hidden="true" tabindex="-1"></a>x_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fl">4.5</span>)</span>
<span id="cb105-13"><a href="plotting-models.html#cb105-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-14"><a href="plotting-models.html#cb105-14" aria-hidden="true" tabindex="-1"></a>m1_response_horiz <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb105-15"><a href="plotting-models.html#cb105-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fig2e,</span>
<span id="cb105-16"><a href="plotting-models.html#cb105-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span> treatment_i, <span class="co"># these 2 lines define the axes</span></span>
<span id="cb105-17"><a href="plotting-models.html#cb105-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> glucose_auc,</span>
<span id="cb105-18"><a href="plotting-models.html#cb105-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> ask1 <span class="co"># define the grouping variable</span></span>
<span id="cb105-19"><a href="plotting-models.html#cb105-19" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb105-20"><a href="plotting-models.html#cb105-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-21"><a href="plotting-models.html#cb105-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add jittered points</span></span>
<span id="cb105-22"><a href="plotting-models.html#cb105-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb105-23"><a href="plotting-models.html#cb105-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-24"><a href="plotting-models.html#cb105-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add layer containing means</span></span>
<span id="cb105-25"><a href="plotting-models.html#cb105-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> m1_emm_dt_i,</span>
<span id="cb105-26"><a href="plotting-models.html#cb105-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> emmean,</span>
<span id="cb105-27"><a href="plotting-models.html#cb105-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> ask1), </span>
<span id="cb105-28"><a href="plotting-models.html#cb105-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb105-29"><a href="plotting-models.html#cb105-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-30"><a href="plotting-models.html#cb105-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add layer containing error bars</span></span>
<span id="cb105-31"><a href="plotting-models.html#cb105-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> m1_emm_dt_i, </span>
<span id="cb105-32"><a href="plotting-models.html#cb105-32" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> emmean,</span>
<span id="cb105-33"><a href="plotting-models.html#cb105-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> lower.CL, </span>
<span id="cb105-34"><a href="plotting-models.html#cb105-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax =</span> upper.CL,</span>
<span id="cb105-35"><a href="plotting-models.html#cb105-35" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> ask1), </span>
<span id="cb105-36"><a href="plotting-models.html#cb105-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb105-37"><a href="plotting-models.html#cb105-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-38"><a href="plotting-models.html#cb105-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change the title of the y-axis</span></span>
<span id="cb105-39"><a href="plotting-models.html#cb105-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;AUC (mmol &quot;</span>, l<span class="sc">^-</span><span class="dv">1</span>, <span class="st">&quot; min)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb105-40"><a href="plotting-models.html#cb105-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-41"><a href="plotting-models.html#cb105-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change the theme</span></span>
<span id="cb105-42"><a href="plotting-models.html#cb105-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb105-43"><a href="plotting-models.html#cb105-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-44"><a href="plotting-models.html#cb105-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># these theme modifications need to be added after re-setting</span></span>
<span id="cb105-45"><a href="plotting-models.html#cb105-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the theme</span></span>
<span id="cb105-46"><a href="plotting-models.html#cb105-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb105-47"><a href="plotting-models.html#cb105-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="co"># remove legend</span></span>
<span id="cb105-48"><a href="plotting-models.html#cb105-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(), <span class="co"># remove the x-axis title</span></span>
<span id="cb105-49"><a href="plotting-models.html#cb105-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>() <span class="co"># remove y-axis ticks</span></span>
<span id="cb105-50"><a href="plotting-models.html#cb105-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb105-51"><a href="plotting-models.html#cb105-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-52"><a href="plotting-models.html#cb105-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change the colors palette for the points</span></span>
<span id="cb105-53"><a href="plotting-models.html#cb105-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> pal_okabe_ito_blue) <span class="sc">+</span></span>
<span id="cb105-54"><a href="plotting-models.html#cb105-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-55"><a href="plotting-models.html#cb105-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the treatment</span></span>
<span id="cb105-56"><a href="plotting-models.html#cb105-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-57"><a href="plotting-models.html#cb105-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>)) <span class="sc">+</span></span>
<span id="cb105-58"><a href="plotting-models.html#cb105-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> x_breaks,</span>
<span id="cb105-59"><a href="plotting-models.html#cb105-59" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> x_breaks_text,</span>
<span id="cb105-60"><a href="plotting-models.html#cb105-60" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb105-61"><a href="plotting-models.html#cb105-61" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb105-62"><a href="plotting-models.html#cb105-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-63"><a href="plotting-models.html#cb105-63" aria-hidden="true" tabindex="-1"></a>m1_response_horiz</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-response-horizontal-1.png" width="576" /></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="plotting-models.html#cb106-1" aria-hidden="true" tabindex="-1"></a>m1_plot <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(m1_top,</span>
<span id="cb106-2"><a href="plotting-models.html#cb106-2" aria-hidden="true" tabindex="-1"></a>                     m1_response_horiz,</span>
<span id="cb106-3"><a href="plotting-models.html#cb106-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb106-4"><a href="plotting-models.html#cb106-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb106-5"><a href="plotting-models.html#cb106-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis =</span> <span class="st">&quot;lr&quot;</span>,</span>
<span id="cb106-6"><a href="plotting-models.html#cb106-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb106-7"><a href="plotting-models.html#cb106-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-8"><a href="plotting-models.html#cb106-8" aria-hidden="true" tabindex="-1"></a>m1_plot</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-response-effects-plot-treatment-1.png" width="576" /></p>
</div>
</div>
<div id="how-to-add-the-interaction-effect-to-response-and-effects-plots" class="section level3" number="4.2.9">
<h3><span class="header-section-number">4.2.9</span> How to add the interaction effect to response and effects plots</h3>
<p>In the experiment for Figure 2E, a good question to ask is, is the effect of ASK1Δadipo conditional on diet? For example, a scenario where ASK1Δadipo lowers AUC about the same amount in both Chow and HFD mice (that is, the effect of ASK1Δadipo is not conditional on diet) has a different underlying biological explanation of the control of browning than a scenario where ASK1Δadipo lowers AUC only in HFD mice. To pursue this, we need an estimate of the interaction effect. In general, <strong>if an experiment has a factorial design, we always want estimates of the interaction effects</strong></p>
<div id="adding-interaction-p-value-to-a-response-plot" class="section level4" number="4.2.9.1">
<h4><span class="header-section-number">4.2.9.1</span> Adding interaction p-value to a response plot</h4>
<p>Wrangle</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="plotting-models.html#cb107-1" aria-hidden="true" tabindex="-1"></a>m1_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(m1))</span>
<span id="cb107-2"><a href="plotting-models.html#cb107-2" aria-hidden="true" tabindex="-1"></a>ixn_estimate <span class="ot">&lt;-</span> m1_coef[<span class="st">&quot;ask1ASK1Δadipo:dietHFD&quot;</span>, <span class="st">&quot;Estimate&quot;</span>]</span>
<span id="cb107-3"><a href="plotting-models.html#cb107-3" aria-hidden="true" tabindex="-1"></a>p_ixn <span class="ot">&lt;-</span> m1_coef[<span class="st">&quot;ask1ASK1Δadipo:dietHFD&quot;</span>, <span class="st">&quot;Pr(&gt;|t|)&quot;</span>] <span class="sc">%&gt;%</span></span>
<span id="cb107-4"><a href="plotting-models.html#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_round</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-5"><a href="plotting-models.html#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_format</span>(<span class="at">digits =</span> <span class="dv">3</span>, <span class="at">accuracy =</span> <span class="fl">1e-04</span>)</span>
<span id="cb107-6"><a href="plotting-models.html#cb107-6" aria-hidden="true" tabindex="-1"></a>p_ixn_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;interaction p = &quot;</span>, p_ixn)</span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="plotting-models.html#cb108-1" aria-hidden="true" tabindex="-1"></a>m1_response_ixn <span class="ot">&lt;-</span> m1_response_fac <span class="sc">+</span></span>
<span id="cb108-2"><a href="plotting-models.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-3"><a href="plotting-models.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add line connecting group means</span></span>
<span id="cb108-4"><a href="plotting-models.html#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># comment out all lines to remove</span></span>
<span id="cb108-5"><a href="plotting-models.html#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> m1_emm_dt,</span>
<span id="cb108-6"><a href="plotting-models.html#cb108-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> emmean,</span>
<span id="cb108-7"><a href="plotting-models.html#cb108-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> ask1,</span>
<span id="cb108-8"><a href="plotting-models.html#cb108-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> ask1),</span>
<span id="cb108-9"><a href="plotting-models.html#cb108-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> dodge_width)) <span class="sc">+</span></span>
<span id="cb108-10"><a href="plotting-models.html#cb108-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-11"><a href="plotting-models.html#cb108-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add p-value</span></span>
<span id="cb108-12"><a href="plotting-models.html#cb108-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb108-13"><a href="plotting-models.html#cb108-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>,</span>
<span id="cb108-14"><a href="plotting-models.html#cb108-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">2300</span>,</span>
<span id="cb108-15"><a href="plotting-models.html#cb108-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> p_ixn_text) <span class="sc">+</span></span>
<span id="cb108-16"><a href="plotting-models.html#cb108-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-17"><a href="plotting-models.html#cb108-17" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb108-18"><a href="plotting-models.html#cb108-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-19"><a href="plotting-models.html#cb108-19" aria-hidden="true" tabindex="-1"></a>m1_response_ixn</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-52-1.png" width="576" /></p>
</div>
<div id="adding-interaction-effect-to-effects-plot" class="section level4" number="4.2.9.2">
<h4><span class="header-section-number">4.2.9.2</span> Adding interaction effect to effects plot</h4>
<div id="add-the-interaction-effect-to-the-contrast-table" class="section level5" number="4.2.9.2.1">
<h5><span class="header-section-number">4.2.9.2.1</span> Add the interaction effect to the contrast table</h5>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="plotting-models.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert m1_simple to data.table</span></span>
<span id="cb109-2"><a href="plotting-models.html#cb109-2" aria-hidden="true" tabindex="-1"></a>m1_simple_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(m1_simple)</span>
<span id="cb109-3"><a href="plotting-models.html#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="plotting-models.html#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get interaction p-value using emmeans::contrast()</span></span>
<span id="cb109-5"><a href="plotting-models.html#cb109-5" aria-hidden="true" tabindex="-1"></a>m1_ixn <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb109-6"><a href="plotting-models.html#cb109-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">interaction =</span> <span class="fu">c</span>(<span class="st">&quot;revpairwise&quot;</span>),</span>
<span id="cb109-7"><a href="plotting-models.html#cb109-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb109-8"><a href="plotting-models.html#cb109-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb109-9"><a href="plotting-models.html#cb109-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb109-10"><a href="plotting-models.html#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="plotting-models.html#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(m1_ixn,</span>
<span id="cb109-12"><a href="plotting-models.html#cb109-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">old =</span> <span class="fu">names</span>(m1_ixn)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb109-13"><a href="plotting-models.html#cb109-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">names</span>(m1_simple_dt)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb109-14"><a href="plotting-models.html#cb109-14" aria-hidden="true" tabindex="-1"></a>m1_ixn[, contrast <span class="sc">:</span><span class="er">=</span> <span class="st">&quot;ask1:diet&quot;</span>]</span>
<span id="cb109-15"><a href="plotting-models.html#cb109-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-16"><a href="plotting-models.html#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="co"># note that column order does not need to be the same</span></span>
<span id="cb109-17"><a href="plotting-models.html#cb109-17" aria-hidden="true" tabindex="-1"></a>m1_effects_dt <span class="ot">&lt;-</span> <span class="fu">rbind</span>(m1_simple_dt,</span>
<span id="cb109-18"><a href="plotting-models.html#cb109-18" aria-hidden="true" tabindex="-1"></a>                       m1_ixn)</span>
<span id="cb109-19"><a href="plotting-models.html#cb109-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-20"><a href="plotting-models.html#cb109-20" aria-hidden="true" tabindex="-1"></a>m1_effects_dt[, contrast_pretty <span class="sc">:</span><span class="er">=</span> <span class="fu">c</span>(<span class="st">&quot;Δadipo - Control&quot;</span>,</span>
<span id="cb109-21"><a href="plotting-models.html#cb109-21" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Δadipo+HFD - HFD&quot;</span>,</span>
<span id="cb109-22"><a href="plotting-models.html#cb109-22" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;HFD - Control&quot;</span>,</span>
<span id="cb109-23"><a href="plotting-models.html#cb109-23" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Δadipo+HFD - Δadipo&quot;</span>,</span>
<span id="cb109-24"><a href="plotting-models.html#cb109-24" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Interaction&quot;</span>)]</span>
<span id="cb109-25"><a href="plotting-models.html#cb109-25" aria-hidden="true" tabindex="-1"></a>m1_effects_dt[, p_round <span class="sc">:</span><span class="er">=</span> <span class="fu">p_round</span>(p.value, <span class="at">digits =</span> <span class="dv">2</span>)]</span>
<span id="cb109-26"><a href="plotting-models.html#cb109-26" aria-hidden="true" tabindex="-1"></a>m1_effects_dt[, p_pretty <span class="sc">:</span><span class="er">=</span> <span class="fu">p_format</span>(p_round,</span>
<span id="cb109-27"><a href="plotting-models.html#cb109-27" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb109-28"><a href="plotting-models.html#cb109-28" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">accuracy =</span> <span class="fl">1e-04</span>,</span>
<span id="cb109-29"><a href="plotting-models.html#cb109-29" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">add.p =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb109-30"><a href="plotting-models.html#cb109-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-31"><a href="plotting-models.html#cb109-31" aria-hidden="true" tabindex="-1"></a><span class="co"># don&#39;t forget this imperative step!</span></span>
<span id="cb109-32"><a href="plotting-models.html#cb109-32" aria-hidden="true" tabindex="-1"></a><span class="co"># otherwise your p-values and factor labels won&#39;t match!</span></span>
<span id="cb109-33"><a href="plotting-models.html#cb109-33" aria-hidden="true" tabindex="-1"></a>m1_effects_dt[, contrast_pretty <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(contrast_pretty,</span>
<span id="cb109-34"><a href="plotting-models.html#cb109-34" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">levels =</span> contrast_pretty)]</span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="plotting-models.html#cb110-1" aria-hidden="true" tabindex="-1"></a>m1_effects <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> m1_effects_dt,</span>
<span id="cb110-2"><a href="plotting-models.html#cb110-2" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> estimate,</span>
<span id="cb110-3"><a href="plotting-models.html#cb110-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> contrast_pretty)) <span class="sc">+</span></span>
<span id="cb110-4"><a href="plotting-models.html#cb110-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-5"><a href="plotting-models.html#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb110-6"><a href="plotting-models.html#cb110-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-7"><a href="plotting-models.html#cb110-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Effects (mmol/L)&quot;</span>) <span class="sc">+</span></span>
<span id="cb110-8"><a href="plotting-models.html#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="plotting-models.html#cb110-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add error bars</span></span>
<span id="cb110-10"><a href="plotting-models.html#cb110-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate,</span>
<span id="cb110-11"><a href="plotting-models.html#cb110-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> lower.CL,</span>
<span id="cb110-12"><a href="plotting-models.html#cb110-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax =</span> upper.CL),</span>
<span id="cb110-13"><a href="plotting-models.html#cb110-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.02</span>) <span class="sc">+</span></span>
<span id="cb110-14"><a href="plotting-models.html#cb110-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-15"><a href="plotting-models.html#cb110-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add zero effect line</span></span>
<span id="cb110-16"><a href="plotting-models.html#cb110-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb110-17"><a href="plotting-models.html#cb110-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb110-18"><a href="plotting-models.html#cb110-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pal_okabe_ito_blue[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb110-19"><a href="plotting-models.html#cb110-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-20"><a href="plotting-models.html#cb110-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add p-values</span></span>
<span id="cb110-21"><a href="plotting-models.html#cb110-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb110-22"><a href="plotting-models.html#cb110-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> m1_effects_dt<span class="sc">$</span>estimate <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb110-23"><a href="plotting-models.html#cb110-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.2</span>,</span>
<span id="cb110-24"><a href="plotting-models.html#cb110-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> m1_effects_dt<span class="sc">$</span>p_pretty,</span>
<span id="cb110-25"><a href="plotting-models.html#cb110-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb110-26"><a href="plotting-models.html#cb110-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-27"><a href="plotting-models.html#cb110-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb110-28"><a href="plotting-models.html#cb110-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-29"><a href="plotting-models.html#cb110-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rremove</span>(<span class="st">&quot;ylab&quot;</span>) <span class="sc">+</span> <span class="co">#remove y-axis, ggpubr function</span></span>
<span id="cb110-30"><a href="plotting-models.html#cb110-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-31"><a href="plotting-models.html#cb110-31" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb110-32"><a href="plotting-models.html#cb110-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-33"><a href="plotting-models.html#cb110-33" aria-hidden="true" tabindex="-1"></a>m1_effects</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-ixn-effects-plot-1.png" width="576" /></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="plotting-models.html#cb111-1" aria-hidden="true" tabindex="-1"></a>m1_top <span class="ot">&lt;-</span> m1_effects <span class="sc">+</span></span>
<span id="cb111-2"><a href="plotting-models.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">position=</span><span class="st">&quot;top&quot;</span>) <span class="co"># move x-axis to &quot;top&quot;</span></span>
<span id="cb111-3"><a href="plotting-models.html#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="plotting-models.html#cb111-4" aria-hidden="true" tabindex="-1"></a>m1_plot <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(m1_top,</span>
<span id="cb111-5"><a href="plotting-models.html#cb111-5" aria-hidden="true" tabindex="-1"></a>                     m1_response_horiz,</span>
<span id="cb111-6"><a href="plotting-models.html#cb111-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb111-7"><a href="plotting-models.html#cb111-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb111-8"><a href="plotting-models.html#cb111-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis =</span> <span class="st">&quot;lr&quot;</span>,</span>
<span id="cb111-9"><a href="plotting-models.html#cb111-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.9</span>))</span>
<span id="cb111-10"><a href="plotting-models.html#cb111-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-11"><a href="plotting-models.html#cb111-11" aria-hidden="true" tabindex="-1"></a>m1_plot</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-ixn-combined-plot-1.png" width="576" />
Notes</p>
<ol style="list-style-type: decimal">
<li>This is a pretty good plot</li>
</ol>

</div>
</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>“The Pretty Good House - Finding the right balance between construction cost and energy performance.” <a href="https://www.greenbuildingadvisor.com/article/the-pretty-good-house" class="uri">https://www.greenbuildingadvisor.com/article/the-pretty-good-house</a><a href="plotting-models.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="part-iv-some-fundamentals-of-statistical-modeling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/29-plotting_models.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
