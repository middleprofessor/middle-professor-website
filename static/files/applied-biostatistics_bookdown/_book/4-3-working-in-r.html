<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="4.3 Working in R | Elements of Statistical Modeling for Experimental Biology" />
<meta property="og:type" content="book" />


<meta property="og:description" content="A first course in statistical modeling for experimental biology researchers" />


<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="A first course in statistical modeling for experimental biology researchers">

<title>4.3 Working in R | Elements of Statistical Modeling for Experimental Biology</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#preface">Preface</a><ul>
<li><a href="0-1-math.html#math"><span class="toc-section-number">0.1</span> Math</a></li>
<li><a href="0-2-r-and-programming.html#r-and-programming"><span class="toc-section-number">0.2</span> R and programming</a></li>
</ul></li>
<li><a href="part-i-getting-started.html#part-i-getting-started">Part I: Getting Started</a></li>
<li class="has-sub"><a href="1-getting-started-r-projects-and-r-markdown.html#getting-started-r-projects-and-r-markdown"><span class="toc-section-number">1</span> Getting Started – R Projects and R Markdown</a><ul>
<li><a href="1-1-r-vs-r-studio.html#r-vs-r-studio"><span class="toc-section-number">1.1</span> R vs R Studio</a></li>
<li><a href="1-2-download-and-install-r-and-r-studio.html#download-and-install-r-and-r-studio"><span class="toc-section-number">1.2</span> Download and install R and R studio</a></li>
<li><a href="1-3-install-r-markdown.html#install-r-markdown"><span class="toc-section-number">1.3</span> Install R Markdown</a></li>
<li><a href="1-4-importing-packages.html#importing-packages"><span class="toc-section-number">1.4</span> Importing Packages</a></li>
<li class="has-sub"><a href="1-5-create-an-r-studio-project-for-this-textbook.html#create-an-r-studio-project-for-this-textbook"><span class="toc-section-number">1.5</span> Create an R Studio Project for this textbook</a><ul>
<li><a href="1-5-create-an-r-studio-project-for-this-textbook.html#create-an-r-markdown-file-for-this-chapter"><span class="toc-section-number">1.5.1</span> Create an R Markdown file for this Chapter</a></li>
<li><a href="1-5-create-an-r-studio-project-for-this-textbook.html#create-a-fake-data-chunk"><span class="toc-section-number">1.5.2</span> Create a “fake-data” chunk</a></li>
<li><a href="1-5-create-an-r-studio-project-for-this-textbook.html#create-a-plot-chunk"><span class="toc-section-number">1.5.3</span> Create a “plot” chunk</a></li>
<li><a href="1-5-create-an-r-studio-project-for-this-textbook.html#knit"><span class="toc-section-number">1.5.4</span> Knit</a></li>
</ul></li>
</ul></li>
<li><a href="part-ii-an-introduction-to-the-analysis-of-experimental-data-with-a-linear-model.html#part-ii-an-introduction-to-the-analysis-of-experimental-data-with-a-linear-model">Part II: An introduction to the analysis of experimental data with a linear model</a></li>
<li class="has-sub"><a href="2-analyzing-experimental-data-with-a-linear-model.html#analyzing-experimental-data-with-a-linear-model"><span class="toc-section-number">2</span> Analyzing experimental data with a linear model</a><ul>
<li><a href="2-1-this-text-is-about-the-estimation-of-treatment-effects-and-the-uncertainty-in-our-estimates-using-linear-models-this-raises-the-question-what-is-an-effect.html#this-text-is-about-the-estimation-of-treatment-effects-and-the-uncertainty-in-our-estimates-using-linear-models.-this-raises-the-question-what-is-an-effect"><span class="toc-section-number">2.1</span> This text is about the estimation of treatment effects and the uncertainty in our estimates using linear models. This, raises the question, what is “an effect”?</a></li>
</ul></li>
<li><a href="background-physiology-to-the-experiments-in-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#background-physiology-to-the-experiments-in-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity">Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li class="has-sub"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity">Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a><ul>
<li><a href="2-2-setup.html#setup"><span class="toc-section-number">2.2</span> Setup</a></li>
<li><a href="2-3-data-source.html#data-source"><span class="toc-section-number">2.3</span> Data source</a></li>
<li><a href="2-4-control-the-color-palette.html#control-the-color-palette"><span class="toc-section-number">2.4</span> control the color palette</a></li>
<li><a href="2-5-useful-functions.html#useful-functions"><span class="toc-section-number">2.5</span> useful functions</a></li>
<li class="has-sub"><a href="2-6-figure-2b-effect-of-ask1-deletion-on-growth-body-weight.html#figure-2b-effect-of-ask1-deletion-on-growth-body-weight"><span class="toc-section-number">2.6</span> figure 2b – effect of ASK1 deletion on growth (body weight)</a><ul>
<li><a href="2-6-figure-2b-effect-of-ask1-deletion-on-growth-body-weight.html#figure-2b-import"><span class="toc-section-number">2.6.1</span> figure 2b – import</a></li>
<li><a href="2-6-figure-2b-effect-of-ask1-deletion-on-growth-body-weight.html#figure-2b-exploratory-plots"><span class="toc-section-number">2.6.2</span> figure 2b – exploratory plots</a></li>
</ul></li>
<li class="has-sub"><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-effect-of-ask1-deletion-on-final-body-weight"><span class="toc-section-number">2.7</span> Figure 2c – Effect of ASK1 deletion on final body weight</a><ul>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-import"><span class="toc-section-number">2.7.1</span> Figure 2c – import</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-check-own-computation-of-weight-change-v-imported-value"><span class="toc-section-number">2.7.2</span> Figure 2c – check own computation of weight change v imported value</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-exploratory-plots"><span class="toc-section-number">2.7.3</span> Figure 2c – exploratory plots</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-fit-the-model-m1-lm"><span class="toc-section-number">2.7.4</span> Figure 2c – fit the model: m1 (lm)</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-check-the-model-m1"><span class="toc-section-number">2.7.5</span> Figure 2c – check the model: m1</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-fit-the-model-m2-gamma-glm"><span class="toc-section-number">2.7.6</span> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-check-the-model-m2"><span class="toc-section-number">2.7.7</span> Figure 2c – check the model, m2</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-inference-from-the-model"><span class="toc-section-number">2.7.8</span> Figure 2c – inference from the model</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-plot-the-model"><span class="toc-section-number">2.7.9</span> Figure 2c – plot the model</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-report"><span class="toc-section-number">2.7.10</span> Figure 2c – report</a></li>
</ul></li>
<li class="has-sub"><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><span class="toc-section-number">2.8</span> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a><ul>
<li><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-import"><span class="toc-section-number">2.8.1</span> Figure 2d – Import</a></li>
<li><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-exploratory-plots"><span class="toc-section-number">2.8.2</span> Figure 2d – exploratory plots</a></li>
<li><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-fit-the-model"><span class="toc-section-number">2.8.3</span> Figure 2d – fit the model</a></li>
<li><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-check-the-model"><span class="toc-section-number">2.8.4</span> Figure 2d – check the model</a></li>
<li><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-inference"><span class="toc-section-number">2.8.5</span> Figure 2d – inference</a></li>
<li><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-plot-the-model"><span class="toc-section-number">2.8.6</span> Figure 2d – plot the model</a></li>
</ul></li>
<li class="has-sub"><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure"><span class="toc-section-number">2.9</span> Figure 2e – Effect of ASK1 deletion on glucose tolerance (summary measure)</a><ul>
<li><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-message-the-data"><span class="toc-section-number">2.9.1</span> Figure 2e – message the data</a></li>
<li><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-exploratory-plots"><span class="toc-section-number">2.9.2</span> Figure 2e – exploratory plots</a></li>
<li><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-fit-the-model"><span class="toc-section-number">2.9.3</span> Figure 2e – fit the model</a></li>
<li><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-check-the-model"><span class="toc-section-number">2.9.4</span> Figure 2e – check the model</a></li>
<li><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-inference-from-the-model"><span class="toc-section-number">2.9.5</span> Figure 2e – inference from the model</a></li>
<li><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-plot-the-model"><span class="toc-section-number">2.9.6</span> Figure 2e – plot the model</a></li>
</ul></li>
<li class="has-sub"><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate"><span class="toc-section-number">2.10</span> Figure 2f – Effect of ASK1 deletion on glucose infusion rate</a><ul>
<li><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-import"><span class="toc-section-number">2.10.1</span> Figure 2f – import</a></li>
<li><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-exploratory-plots"><span class="toc-section-number">2.10.2</span> Figure 2f – exploratory plots</a></li>
<li><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-fit-the-model"><span class="toc-section-number">2.10.3</span> Figure 2f – fit the model</a></li>
<li><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-check-the-model"><span class="toc-section-number">2.10.4</span> Figure 2f – check the model</a></li>
<li><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-inference"><span class="toc-section-number">2.10.5</span> Figure 2f – inference</a></li>
<li><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-plot-the-model"><span class="toc-section-number">2.10.6</span> Figure 2f – plot the model</a></li>
</ul></li>
<li class="has-sub"><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake"><span class="toc-section-number">2.11</span> Figure 2g – Effect of ASK1 deletion on tissue-specific glucose uptake</a><ul>
<li><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-import"><span class="toc-section-number">2.11.1</span> Figure 2g – import</a></li>
<li><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-exploratory-plots"><span class="toc-section-number">2.11.2</span> Figure 2g – exploratory plots</a></li>
<li><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-fit-the-model"><span class="toc-section-number">2.11.3</span> Figure 2g – fit the model</a></li>
<li><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-check-the-model"><span class="toc-section-number">2.11.4</span> Figure 2g – check the model</a></li>
<li><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-inference"><span class="toc-section-number">2.11.5</span> Figure 2g – inference</a></li>
<li><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-plot-the-model"><span class="toc-section-number">2.11.6</span> Figure 2g – plot the model</a></li>
</ul></li>
<li><a href="2-12-figure-2h.html#figure-2h"><span class="toc-section-number">2.12</span> Figure 2h</a></li>
<li class="has-sub"><a href="2-13-figure-2i-effect-of-ask1-deletion-on-liver-tg.html#figure-2i-effect-of-ask1-deletion-on-liver-tg"><span class="toc-section-number">2.13</span> Figure 2i – Effect of ASK1 deletion on liver TG</a><ul>
<li><a href="2-13-figure-2i-effect-of-ask1-deletion-on-liver-tg.html#figure-2i-fit-the-model"><span class="toc-section-number">2.13.1</span> Figure 2i – fit the model</a></li>
<li><a href="2-13-figure-2i-effect-of-ask1-deletion-on-liver-tg.html#figure-2i-check-the-model"><span class="toc-section-number">2.13.2</span> Figure 2i – check the model</a></li>
<li><a href="2-13-figure-2i-effect-of-ask1-deletion-on-liver-tg.html#figure-2i-inference"><span class="toc-section-number">2.13.3</span> Figure 2i – inference</a></li>
<li><a href="2-13-figure-2i-effect-of-ask1-deletion-on-liver-tg.html#figure-2i-plot-the-model"><span class="toc-section-number">2.13.4</span> Figure 2i – plot the model</a></li>
<li><a href="2-13-figure-2i-effect-of-ask1-deletion-on-liver-tg.html#figure-2i-report-the-model"><span class="toc-section-number">2.13.5</span> Figure 2i – report the model</a></li>
</ul></li>
<li><a href="2-14-figure-2j.html#figure-2j"><span class="toc-section-number">2.14</span> Figure 2j</a></li>
</ul></li>
<li><a href="part-iii-r-fundamentals.html#part-iii-r-fundamentals">Part III: R fundamentals</a></li>
<li class="has-sub"><a href="3-data-reading-wrangling-and-writing.html#data-reading-wrangling-and-writing"><span class="toc-section-number">3</span> Data – Reading, Wrangling, and Writing</a><ul>
<li><a href="3-1-learning-from-this-chapter.html#learning-from-this-chapter"><span class="toc-section-number">3.1</span> Learning from this chapter</a></li>
<li class="has-sub"><a href="3-2-data-working-in-r.html#data-working-in-r"><span class="toc-section-number">3.2</span> Working in R</a><ul>
<li><a href="3-2-data-working-in-r.html#importing-data"><span class="toc-section-number">3.2.1</span> Importing data</a></li>
</ul></li>
<li class="has-sub"><a href="3-3-data-wrangling.html#data-wrangling"><span class="toc-section-number">3.3</span> Data wrangling</a><ul>
<li><a href="3-3-data-wrangling.html#reshaping-data-wide-to-long"><span class="toc-section-number">3.3.1</span> Reshaping data – Wide to long</a></li>
<li><a href="3-3-data-wrangling.html#reshaping-data-transpose-turning-the-columns-into-rows"><span class="toc-section-number">3.3.2</span> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li><a href="3-3-data-wrangling.html#combining-data"><span class="toc-section-number">3.3.3</span> Combining data</a></li>
<li><a href="3-3-data-wrangling.html#subsetting-data"><span class="toc-section-number">3.3.4</span> Subsetting data</a></li>
<li><a href="3-3-data-wrangling.html#wrangling-columns"><span class="toc-section-number">3.3.5</span> Wrangling columns</a></li>
<li><a href="3-3-data-wrangling.html#missing-data"><span class="toc-section-number">3.3.6</span> Missing data</a></li>
</ul></li>
<li><a href="3-4-saving-data.html#saving-data"><span class="toc-section-number">3.4</span> Saving data</a></li>
<li><a href="3-5-exercises.html#exercises"><span class="toc-section-number">3.5</span> Exercises</a></li>
</ul></li>
<li class="has-sub"><a href="4-plotting-models.html#plotting-models"><span class="toc-section-number">4</span> Plotting Models</a><ul>
<li class="has-sub"><a href="4-1-pretty-good-plots-show-the-model-and-the-data.html#pretty-good-plots-show-the-model-and-the-data"><span class="toc-section-number">4.1</span> Pretty good plots show the model and the data</a><ul>
<li><a href="4-1-pretty-good-plots-show-the-model-and-the-data.html#pretty-good-plot-component-1-modeled-effects-plot"><span class="toc-section-number">4.1.1</span> Pretty good plot component 1: Modeled effects plot</a></li>
<li><a href="4-1-pretty-good-plots-show-the-model-and-the-data.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot"><span class="toc-section-number">4.1.2</span> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li><a href="4-1-pretty-good-plots-show-the-model-and-the-data.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><span class="toc-section-number">4.1.3</span> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
</ul></li>
<li><a href="4-2-some-comments-on-plot-components.html#some-comments-on-plot-components"><span class="toc-section-number">4.2</span> Some comments on plot components</a></li>
<li class="has-sub"><a href="4-3-working-in-r.html#working-in-r"><span class="toc-section-number">4.3</span> Working in R</a><ul>
<li><a href="4-3-working-in-r.html#unpooled-se-bars-and-confidence-intervals"><span class="toc-section-number">4.3.1</span> Unpooled SE bars and confidence intervals</a></li>
<li><a href="4-3-working-in-r.html#adding-bootstrap-intervals"><span class="toc-section-number">4.3.2</span> Adding bootstrap intervals</a></li>
<li><a href="4-3-working-in-r.html#adding-modeled-means-and-error-intervals"><span class="toc-section-number">4.3.3</span> Adding modeled means and error intervals</a></li>
<li><a href="4-3-working-in-r.html#adding-p-values"><span class="toc-section-number">4.3.4</span> Adding p-values</a></li>
<li><a href="4-3-working-in-r.html#adding-custom-p-values"><span class="toc-section-number">4.3.5</span> Adding custom p-values</a></li>
<li><a href="4-3-working-in-r.html#plotting-two-factors"><span class="toc-section-number">4.3.6</span> Plotting two factors</a></li>
<li><a href="4-3-working-in-r.html#interaction-plot"><span class="toc-section-number">4.3.7</span> Interaction plot</a></li>
<li><a href="4-3-working-in-r.html#plot-components"><span class="toc-section-number">4.3.8</span> Plot components</a></li>
</ul></li>
</ul></li>
<li><a href="part-iv-some-fundamentals-of-statistical-modeling.html#part-iv-some-fundamentals-of-statistical-modeling">Part IV: Some Fundamentals of Statistical Modeling</a></li>
<li class="has-sub"><a href="5-variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals"><span class="toc-section-number">5</span> Variability and Uncertainty (Standard Deviations, Standard Errors, Confidence Intervals)</a><ul>
<li class="has-sub"><a href="5-1-the-sample-standard-deviation-vs-the-standard-error-of-the-mean.html#the-sample-standard-deviation-vs.-the-standard-error-of-the-mean"><span class="toc-section-number">5.1</span> The sample standard deviation vs. the standard error of the mean</a><ul>
<li><a href="5-1-the-sample-standard-deviation-vs-the-standard-error-of-the-mean.html#sample-standard-deviation"><span class="toc-section-number">5.1.1</span> Sample standard deviation</a></li>
<li><a href="5-1-the-sample-standard-deviation-vs-the-standard-error-of-the-mean.html#standard-error-of-the-mean"><span class="toc-section-number">5.1.2</span> Standard error of the mean</a></li>
</ul></li>
<li class="has-sub"><a href="5-2-using-google-sheets-to-generate-fake-data-to-explore-the-standard-error.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><span class="toc-section-number">5.2</span> Using Google Sheets to generate fake data to explore the standard error</a><ul>
<li><a href="5-2-using-google-sheets-to-generate-fake-data-to-explore-the-standard-error.html#steps"><span class="toc-section-number">5.2.1</span> Steps</a></li>
</ul></li>
<li class="has-sub"><a href="5-3-using-r-to-generate-fake-data-to-explore-the-standard-error.html#using-r-to-generate-fake-data-to-explore-the-standard-error"><span class="toc-section-number">5.3</span> Using R to generate fake data to explore the standard error</a><ul>
<li><a href="5-3-using-r-to-generate-fake-data-to-explore-the-standard-error.html#part-i"><span class="toc-section-number">5.3.1</span> part I</a></li>
<li><a href="5-3-using-r-to-generate-fake-data-to-explore-the-standard-error.html#part-ii---means"><span class="toc-section-number">5.3.2</span> part II - means</a></li>
<li><a href="5-3-using-r-to-generate-fake-data-to-explore-the-standard-error.html#part-iii---how-do-sd-and-se-change-as-sample-size-n-increases"><span class="toc-section-number">5.3.3</span> part III - how do SD and SE change as sample size (n) increases?</a></li>
<li><a href="5-3-using-r-to-generate-fake-data-to-explore-the-standard-error.html#part-iv-generating-fake-data-with-for-loops"><span class="toc-section-number">5.3.4</span> Part IV – Generating fake data with for-loops</a></li>
</ul></li>
<li class="has-sub"><a href="5-4-bootstrap.html#bootstrap"><span class="toc-section-number">5.4</span> Bootstrapped standard errors</a><ul>
<li><a href="5-4-bootstrap.html#an-example-of-bootstrapped-standard-errors-using-vole-data"><span class="toc-section-number">5.4.1</span> An example of bootstrapped standard errors using vole data</a></li>
</ul></li>
<li class="has-sub"><a href="5-5-confidence-interval.html#confidence-interval"><span class="toc-section-number">5.5</span> Confidence Interval</a><ul>
<li><a href="5-5-confidence-interval.html#interpretation-of-a-confidence-interval"><span class="toc-section-number">5.5.1</span> Interpretation of a confidence interval</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="6-p-values.html#p-values"><span class="toc-section-number">6</span> P-values</a><ul>
<li><a href="6-1-a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution.html#a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution"><span class="toc-section-number">6.1</span> A <em>p</em>-value is the probability of sampling a value as or more extreme than the test statistic if sampling from a null distribution</a></li>
<li><a href="6-2-pump-your-intuition-creating-a-null-distribution.html#pump-your-intuition-creating-a-null-distribution"><span class="toc-section-number">6.2</span> Pump your intuition – Creating a null distribution</a></li>
<li><a href="6-3-a-null-distribution-of-t-values-the-t-distribution.html#a-null-distribution-of-t-values-the-t-distribution"><span class="toc-section-number">6.3</span> A null distribution of <em>t</em>-values – the <em>t</em> distribution</a></li>
<li><a href="6-4-p-values-from-the-perspective-of-permutation.html#p-values-from-the-perspective-of-permutation"><span class="toc-section-number">6.4</span> P-values from the perspective of permutation</a></li>
<li><a href="6-5-parametric-vs-non-parametric-statistics.html#parametric-vs.-non-parametric-statistics"><span class="toc-section-number">6.5</span> Parametric vs. non-parametric statistics</a></li>
<li class="has-sub"><a href="6-6-frequentist-probability-and-the-interpretation-of-p-values.html#frequentist-probability-and-the-interpretation-of-p-values"><span class="toc-section-number">6.6</span> frequentist probability and the interpretation of p-values</a><ul>
<li><a href="6-6-frequentist-probability-and-the-interpretation-of-p-values.html#background"><span class="toc-section-number">6.6.1</span> Background</a></li>
<li><a href="6-6-frequentist-probability-and-the-interpretation-of-p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><span class="toc-section-number">6.6.2</span> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li><a href="6-6-frequentist-probability-and-the-interpretation-of-p-values.html#two-interpretations-of-the-p-value"><span class="toc-section-number">6.6.3</span> Two interpretations of the <em>p</em>-value</a></li>
<li><a href="6-6-frequentist-probability-and-the-interpretation-of-p-values.html#nhst"><span class="toc-section-number">6.6.4</span> NHST</a></li>
</ul></li>
<li class="has-sub"><a href="6-7-some-major-misconceptions-of-the-p-value.html#some-major-misconceptions-of-the-p-value"><span class="toc-section-number">6.7</span> Some major misconceptions of the <em>p</em>-value</a><ul>
<li><a href="6-7-some-major-misconceptions-of-the-p-value.html#misconception-p-is-the-probability-that-the-null-is-true-and-1-p-is-probability-that-the-alternative-is-true"><span class="toc-section-number">6.7.1</span> Misconception: <em>p</em> is the probability that the null is true <em>and</em> <span class="math inline">\(1-p\)</span> is probability that the alternative is true</a></li>
<li><a href="6-7-some-major-misconceptions-of-the-p-value.html#misconception-a-p-value-is-repeatable"><span class="toc-section-number">6.7.2</span> Misconception: a <em>p</em>-value is repeatable</a></li>
<li><a href="6-7-some-major-misconceptions-of-the-p-value.html#misconception-0.05-is-the-lifetime-rate-of-false-discoveries"><span class="toc-section-number">6.7.3</span> Misconception: 0.05 is the lifetime rate of false discoveries</a></li>
<li><a href="6-7-some-major-misconceptions-of-the-p-value.html#misconception-a-low-p-value-indicates-an-important-effect"><span class="toc-section-number">6.7.4</span> Misconception: a low <em>p</em>-value indicates an important effect</a></li>
<li><a href="6-7-some-major-misconceptions-of-the-p-value.html#misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity"><span class="toc-section-number">6.7.5</span> Misconception: a low <em>p</em>-value indicates high model fit or high predictive capacity</a></li>
</ul></li>
<li><a href="6-8-what-the-p-value-does-not-mean.html#what-the-p-value-does-not-mean"><span class="toc-section-number">6.8</span> What the <em>p</em>-value does not mean</a></li>
<li class="has-sub"><a href="6-9-recommendations.html#recommendations"><span class="toc-section-number">6.9</span> Recommendations</a><ul>
<li><a href="6-9-recommendations.html#primary-sources-for-recommendations"><span class="toc-section-number">6.9.1</span> Primary sources for recommendations</a></li>
</ul></li>
<li><a href="6-10-problems.html#problems"><span class="toc-section-number">6.10</span> Problems</a></li>
</ul></li>
<li class="has-sub"><a href="7-errors-in-inference.html#errors-in-inference"><span class="toc-section-number">7</span> Errors in inference</a><ul>
<li class="has-sub"><a href="7-1-classical-nhst-concepts-of-wrong.html#classical-nhst-concepts-of-wrong"><span class="toc-section-number">7.1</span> Classical NHST concepts of wrong</a><ul>
<li><a href="7-1-classical-nhst-concepts-of-wrong.html#type-i-error"><span class="toc-section-number">7.1.1</span> Type I error</a></li>
<li><a href="7-1-classical-nhst-concepts-of-wrong.html#power"><span class="toc-section-number">7.1.2</span> Power</a></li>
</ul></li>
<li class="has-sub"><a href="7-2-a-non-neyman-pearson-concept-of-power.html#a-non-neyman-pearson-concept-of-power"><span class="toc-section-number">7.2</span> A non-Neyman-Pearson concept of power</a><ul>
<li><a href="7-2-a-non-neyman-pearson-concept-of-power.html#estimation-error"><span class="toc-section-number">7.2.1</span> Estimation error</a></li>
<li><a href="7-2-a-non-neyman-pearson-concept-of-power.html#coverage"><span class="toc-section-number">7.2.2</span> Coverage</a></li>
<li><a href="7-2-a-non-neyman-pearson-concept-of-power.html#type-s-error"><span class="toc-section-number">7.2.3</span> Type S error</a></li>
<li><a href="7-2-a-non-neyman-pearson-concept-of-power.html#type-m-error"><span class="toc-section-number">7.2.4</span> Type M error</a></li>
</ul></li>
</ul></li>
<li><a href="part-v-introduction-to-linear-models.html#part-v-introduction-to-linear-models">Part V: Introduction to Linear Models</a></li>
<li class="has-sub"><a href="8-an-introduction-to-linear-models.html#an-introduction-to-linear-models"><span class="toc-section-number">8</span> An introduction to linear models</a><ul>
<li class="has-sub"><a href="8-1-two-specifications-of-a-linear-model.html#two-specifications-of-a-linear-model"><span class="toc-section-number">8.1</span> Two specifications of a linear model</a><ul>
<li><a href="8-1-two-specifications-of-a-linear-model.html#the-error-draw-specification"><span class="toc-section-number">8.1.1</span> The “error draw” specification</a></li>
<li><a href="8-1-two-specifications-of-a-linear-model.html#the-conditional-draw-specification"><span class="toc-section-number">8.1.2</span> The “conditional draw” specification</a></li>
<li><a href="8-1-two-specifications-of-a-linear-model.html#comparing-the-two-ways-of-specifying-the-linear-model"><span class="toc-section-number">8.1.3</span> Comparing the two ways of specifying the linear model</a></li>
</ul></li>
<li class="has-sub"><a href="8-2-a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"><span class="toc-section-number">8.2</span> A linear model can be fit to data with continuous, discrete, or categorical <span class="math inline">\(X\)</span> variables</a><ul>
<li><a href="8-2-a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete"><span class="toc-section-number">8.2.1</span> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is continuous or discrete</a></li>
<li><a href="8-2-a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-categorical"><span class="toc-section-number">8.2.2</span> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is categorical</a></li>
</ul></li>
<li><a href="8-3-statistical-models-are-used-for-prediction-explanation-and-description.html#statistical-models-are-used-for-prediction-explanation-and-description"><span class="toc-section-number">8.3</span> Statistical models are used for prediction, explanation, and description</a></li>
<li><a href="8-4-what-do-we-call-the-x-and-y-variables.html#what-do-we-call-the-x-and-y-variables"><span class="toc-section-number">8.4</span> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li><a href="8-5-modeling-strategy.html#modeling-strategy"><span class="toc-section-number">8.5</span> Modeling strategy</a></li>
<li><a href="8-6-predictions-from-the-model.html#predictions-from-the-model"><span class="toc-section-number">8.6</span> Predictions from the model</a></li>
<li class="has-sub"><a href="8-7-inference-from-the-model.html#inference-from-the-model"><span class="toc-section-number">8.7</span> Inference from the model</a><ul>
<li><a href="8-7-inference-from-the-model.html#assumptions-for-inference-with-a-statistical-model"><span class="toc-section-number">8.7.1</span> Assumptions for inference with a statistical model</a></li>
<li><a href="8-7-inference-from-the-model.html#specific-assumptions-for-inference-with-a-linear-model"><span class="toc-section-number">8.7.2</span> Specific assumptions for inference with a linear model</a></li>
</ul></li>
<li><a href="8-8-linear-modelregression-model-orstatistical-model.html#linear-modelregression-model-orstatistical-model"><span class="toc-section-number">8.8</span> “linear model,”regression model“, or”statistical model"?</a></li>
</ul></li>
<li class="has-sub"><a href="9-linear-models-with-a-single-continuous-x.html#linear-models-with-a-single-continuous-x"><span class="toc-section-number">9</span> Linear models with a single, continuous <em>X</em></a><ul>
<li class="has-sub"><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><span class="toc-section-number">9.1</span> A linear model with a single, continuous <em>X</em> is classical “regression”</a><ul>
<li><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#analysis-of-green-down-data"><span class="toc-section-number">9.1.1</span> Analysis of “green-down” data</a></li>
<li><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#learning-from-the-green-down-example"><span class="toc-section-number">9.1.2</span> Learning from the green-down example</a></li>
<li><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#using-a-regression-model-for-explanation-causal-models"><span class="toc-section-number">9.1.3</span> Using a regression model for “explanation” – causal models</a></li>
<li><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#using-a-regression-model-for-prediction-prediction-models"><span class="toc-section-number">9.1.4</span> Using a regression model for prediction – prediction models</a></li>
<li><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data"><span class="toc-section-number">9.1.5</span> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</a></li>
<li><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#using-a-regression-model-for-for-calibration"><span class="toc-section-number">9.1.6</span> Using a regression model for for calibration</a></li>
</ul></li>
<li class="has-sub"><a href="9-2-working-in-r-1.html#working-in-r-1"><span class="toc-section-number">9.2</span> Working in R</a><ul>
<li><a href="9-2-working-in-r-1.html#fitting-the-linear-model"><span class="toc-section-number">9.2.1</span> Fitting the linear model</a></li>
<li><a href="9-2-working-in-r-1.html#getting-to-know-the-linear-model-the-summary-function"><span class="toc-section-number">9.2.2</span> Getting to know the linear model: the <code>summary</code> function</a></li>
<li><a href="9-2-working-in-r-1.html#inference-the-coefficient-table-and-confidence-intervals"><span class="toc-section-number">9.2.3</span> Inference – the coefficient table and Confidence intervals</a></li>
<li><a href="9-2-working-in-r-1.html#how-good-is-our-model-model-checking"><span class="toc-section-number">9.2.4</span> How good is our model? – Model checking</a></li>
<li><a href="9-2-working-in-r-1.html#plotting-models-with-continuous-x"><span class="toc-section-number">9.2.5</span> Plotting models with continuous <em>X</em></a></li>
<li><a href="9-2-working-in-r-1.html#creating-a-table-of-predicted-values-and-95-prediction-intervals"><span class="toc-section-number">9.2.6</span> Creating a table of predicted values and 95% prediction intervals</a></li>
</ul></li>
<li class="has-sub"><a href="9-3-hidden-code.html#hidden-code"><span class="toc-section-number">9.3</span> Hidden code</a><ul>
<li><a href="9-3-hidden-code.html#import-and-plot-of-fig2c-ecosystem-warming-experimental-data"><span class="toc-section-number">9.3.1</span> Import and plot of fig2c (ecosystem warming experimental) data</a></li>
<li><a href="9-3-hidden-code.html#import-and-plot-efig_3d-ecosysem-warming-observational-data"><span class="toc-section-number">9.3.2</span> Import and plot efig_3d (Ecosysem warming observational) data</a></li>
<li><a href="9-3-hidden-code.html#import-and-plot-of-fig1f-methionine-restriction-data"><span class="toc-section-number">9.3.3</span> Import and plot of fig1f (methionine restriction) data</a></li>
</ul></li>
<li class="has-sub"><a href="9-4-try-it.html#try-it"><span class="toc-section-number">9.4</span> Try it</a><ul>
<li><a href="9-4-try-it.html#a-prediction-model-from-the-literature"><span class="toc-section-number">9.4.1</span> A prediction model from the literature</a></li>
</ul></li>
<li class="has-sub"><a href="9-5-intuition-pumps.html#intuition-pumps"><span class="toc-section-number">9.5</span> Intuition pumps</a><ul>
<li><a href="9-5-intuition-pumps.html#correlation-and-r2"><span class="toc-section-number">9.5.1</span> Correlation and $R^2</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="10-linear-models-with-a-single-categorical-x.html#linear-models-with-a-single-categorical-x"><span class="toc-section-number">10</span> Linear models with a single, categorical <em>X</em></a><ul>
<li class="has-sub"><a href="10-1-a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response-.html#a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response."><span class="toc-section-number">10.1</span> A linear model with a single, categorical <em>X</em> variable estimates the effects of the levels of <em>X</em> on the response.</a><ul>
<li><a href="10-1-a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response-.html#example-1-two-treatment-levels-groups"><span class="toc-section-number">10.1.1</span> Example 1 – two treatment levels (“groups”)</a></li>
<li><a href="10-1-a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response-.html#understanding-the-analysis-with-two-treatment-levels"><span class="toc-section-number">10.1.2</span> Understanding the analysis with two treatment levels</a></li>
<li><a href="10-1-a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response-.html#example-2-three-treatment-levels-groups"><span class="toc-section-number">10.1.3</span> Example 2 – three treatment levels (“groups”)</a></li>
<li><a href="10-1-a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response-.html#understanding-the-analysis-with-three-or-more-treatment-levels"><span class="toc-section-number">10.1.4</span> Understanding the analysis with three (or more) treatment levels</a></li>
</ul></li>
<li class="has-sub"><a href="10-2-working-in-r-2.html#working-in-r-2"><span class="toc-section-number">10.2</span> Working in R</a><ul>
<li><a href="10-2-working-in-r-2.html#specifying-the-contrasts"><span class="toc-section-number">10.2.1</span> Specifying the contrasts</a></li>
<li><a href="10-2-working-in-r-2.html#adjustment-for-multiple-comparisons"><span class="toc-section-number">10.2.2</span> Adjustment for multiple comparisons</a></li>
<li><a href="10-2-working-in-r-2.html#plotting-models-with-a-single-categorical-x"><span class="toc-section-number">10.2.3</span> Plotting models with a single, categorical <span class="math inline">\(X\)</span></a></li>
</ul></li>
<li class="has-sub"><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#issues-in-inference-in-models-with-a-single-categorical-x"><span class="toc-section-number">10.3</span> Issues in inference in models with a single, categorical <span class="math inline">\(X\)</span></a><ul>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#lack-of-independence"><span class="toc-section-number">10.3.1</span> Lack of independence</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#heterogeneity-of-variances"><span class="toc-section-number">10.3.2</span> Heterogeneity of variances</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#the-conditional-response-isnt-normal"><span class="toc-section-number">10.3.3</span> The conditional response isn’t Normal</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#pre-post-designs"><span class="toc-section-number">10.3.4</span> Pre-post designs</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#longitudinal-designs"><span class="toc-section-number">10.3.5</span> Longitudinal designs</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#comparing-responses-normalized-to-a-standard"><span class="toc-section-number">10.3.6</span> Comparing responses normalized to a standard</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#comparing-responses-that-are-ratios"><span class="toc-section-number">10.3.7</span> Comparing responses that are ratios</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#researcher-degrees-of-freedom"><span class="toc-section-number">10.3.8</span> Researcher degrees of freedom</a></li>
</ul></li>
<li class="has-sub"><a href="10-4-hidden-code-1.html#hidden-code-1"><span class="toc-section-number">10.4</span> Hidden Code</a><ul>
<li><a href="10-4-hidden-code-1.html#fig2a-data"><span class="toc-section-number">10.4.1</span> fig2a data</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="11-model-checking.html#model-checking"><span class="toc-section-number">11</span> Model Checking</a><ul>
<li><a href="11-1-all-statistical-analyses-should-be-followed-by-model-checking.html#all-statistical-analyses-should-be-followed-by-model-checking"><span class="toc-section-number">11.1</span> All statistical analyses should be followed by model checking</a></li>
<li class="has-sub"><a href="11-2-linear-model-assumptions.html#linear-model-assumptions"><span class="toc-section-number">11.2</span> Linear model assumptions</a><ul>
<li><a href="11-2-linear-model-assumptions.html#a-bit-about-iid"><span class="toc-section-number">11.2.1</span> A bit about IID</a></li>
</ul></li>
<li class="has-sub"><a href="11-3-diagnostic-plots-use-the-residuals-from-the-model-fit.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><span class="toc-section-number">11.3</span> Diagnostic plots use the residuals from the model fit</a><ul>
<li><a href="11-3-diagnostic-plots-use-the-residuals-from-the-model-fit.html#residuals"><span class="toc-section-number">11.3.1</span> Residuals</a></li>
<li><a href="11-3-diagnostic-plots-use-the-residuals-from-the-model-fit.html#a-normal-q-q-plot-is-used-to-check-for-characteristic-departures-from-normality"><span class="toc-section-number">11.3.2</span> A Normal Q-Q plot is used to check for characteristic departures from Normality</a></li>
<li><a href="11-3-diagnostic-plots-use-the-residuals-from-the-model-fit.html#mapping-qq-plot-departures-from-normality"><span class="toc-section-number">11.3.3</span> Mapping QQ-plot departures from Normality</a></li>
<li><a href="11-3-diagnostic-plots-use-the-residuals-from-the-model-fit.html#model-checking-homoskedasticity"><span class="toc-section-number">11.3.4</span> Model checking homoskedasticity</a></li>
</ul></li>
<li class="has-sub"><a href="11-4-using-r.html#using-r"><span class="toc-section-number">11.4</span> Using R</a><ul>
<li><a href="11-4-using-r.html#normal-q-q-plots"><span class="toc-section-number">11.4.1</span> Normal Q-Q plots</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="12-model-fitting-and-model-fit-ols.html#model-fitting-and-model-fit-ols"><span class="toc-section-number">12</span> Model Fitting and Model Fit (OLS)</a><ul>
<li><a href="12-1-least-squares-estimation-and-the-decomposition-of-variance.html#least-squares-estimation-and-the-decomposition-of-variance"><span class="toc-section-number">12.1</span> Least Squares Estimation and the Decomposition of Variance</a></li>
<li><a href="12-2-ols-regression.html#ols-regression"><span class="toc-section-number">12.2</span> OLS regression</a></li>
<li><a href="12-3-how-well-does-the-model-fit-the-data-r2-and-variance-explained.html#how-well-does-the-model-fit-the-data-r2-and-variance-explained"><span class="toc-section-number">12.3</span> How well does the model fit the data? <span class="math inline">\(R^2\)</span> and “variance explained”</a></li>
</ul></li>
<li class="has-sub"><a href="13-best-practices-issues-in-inference.html#best-practices-issues-in-inference"><span class="toc-section-number">13</span> Best practices – issues in inference</a><ul>
<li class="has-sub"><a href="13-1-multiple-testing.html#multiple-testing"><span class="toc-section-number">13.1</span> Multiple testing</a><ul>
<li><a href="13-1-multiple-testing.html#some-background"><span class="toc-section-number">13.1.1</span> Some background</a></li>
<li><a href="13-1-multiple-testing.html#multiple-testing-working-in-r"><span class="toc-section-number">13.1.2</span> Multiple testing – working in R</a></li>
<li><a href="13-1-multiple-testing.html#false-discovery-rate"><span class="toc-section-number">13.1.3</span> False Discovery Rate</a></li>
</ul></li>
<li><a href="13-2-difference-in-p-is-not-different.html#difference-in-p-is-not-different"><span class="toc-section-number">13.2</span> difference in p is not different</a></li>
<li class="has-sub"><a href="13-3-inference-when-data-are-not-normal.html#inference-when-data-are-not-normal"><span class="toc-section-number">13.3</span> Inference when data are not Normal</a><ul>
<li><a href="13-3-inference-when-data-are-not-normal.html#working-in-r-3"><span class="toc-section-number">13.3.1</span> Working in R</a></li>
<li><a href="13-3-inference-when-data-are-not-normal.html#bootstrap-confidence-intervals"><span class="toc-section-number">13.3.2</span> Bootstrap Confidence Intervals</a></li>
<li><a href="13-3-inference-when-data-are-not-normal.html#permutation-test"><span class="toc-section-number">13.3.3</span> Permutation test</a></li>
<li><a href="13-3-inference-when-data-are-not-normal.html#non-parametric-tests"><span class="toc-section-number">13.3.4</span> Non-parametric tests</a></li>
<li><a href="13-3-inference-when-data-are-not-normal.html#log-transformations"><span class="toc-section-number">13.3.5</span> Log transformations</a></li>
<li><a href="13-3-inference-when-data-are-not-normal.html#performance-of-parametric-tests-and-alternatives"><span class="toc-section-number">13.3.6</span> Performance of parametric tests and alternatives</a></li>
</ul></li>
</ul></li>
<li><a href="part-vi-more-than-one-x-multivariable-models.html#part-vi-more-than-one-x-multivariable-models">Part VI: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li class="has-sub"><a href="14-adding-covariates-to-a-linear-model.html#adding-covariates-to-a-linear-model"><span class="toc-section-number">14</span> Adding covariates to a linear model</a><ul>
<li><a href="14-1-adding-covariates-can-increases-the-precision-of-the-effect-of-interest.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><span class="toc-section-number">14.1</span> Adding covariates can increases the precision of the effect of interest</a></li>
<li class="has-sub"><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data"><span class="toc-section-number">14.2</span> Understanding a linear model with an added covariate – heart necrosis data</a><ul>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#fit-the-model-1"><span class="toc-section-number">14.2.1</span> Fit the model</a></li>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#plot-the-model-1"><span class="toc-section-number">14.2.2</span> Plot the model</a></li>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#interpretation-of-the-model-coefficients"><span class="toc-section-number">14.2.3</span> Interpretation of the model coefficients</a></li>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#everything-adds-up"><span class="toc-section-number">14.2.4</span> Everything adds up</a></li>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#interpretation-of-the-estimated-marginal-means"><span class="toc-section-number">14.2.5</span> Interpretation of the estimated marginal means</a></li>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#interpretation-of-the-contrasts"><span class="toc-section-number">14.2.6</span> Interpretation of the contrasts</a></li>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#adding-the-covariate-improves-inference"><span class="toc-section-number">14.2.7</span> Adding the covariate improves inference</a></li>
</ul></li>
<li class="has-sub"><a href="14-3-understanding-interaction-effects-with-covariates.html#understanding-interaction-effects-with-covariates"><span class="toc-section-number">14.3</span> Understanding interaction effects with covariates</a><ul>
<li><a href="14-3-understanding-interaction-effects-with-covariates.html#fit-the-model-2"><span class="toc-section-number">14.3.1</span> Fit the model</a></li>
<li><a href="14-3-understanding-interaction-effects-with-covariates.html#plot-the-model-with-interaction-effect"><span class="toc-section-number">14.3.2</span> Plot the model with interaction effect</a></li>
<li><a href="14-3-understanding-interaction-effects-with-covariates.html#interpretation-of-the-model-coefficients-1"><span class="toc-section-number">14.3.3</span> Interpretation of the model coefficients</a></li>
<li><a href="14-3-understanding-interaction-effects-with-covariates.html#what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends."><span class="toc-section-number">14.3.4</span> What is the effect of a treatment, if interactions are modeled? – it depends.</a></li>
<li><a href="14-3-understanding-interaction-effects-with-covariates.html#which-model-do-we-use-mathcalm_1-or-mathcalm_2"><span class="toc-section-number">14.3.5</span> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</a></li>
</ul></li>
<li><a href="14-4-understanding-ancova-tables.html#understanding-ancova-tables"><span class="toc-section-number">14.4</span> Understanding ANCOVA tables</a></li>
<li class="has-sub"><a href="14-5-working-in-r-4.html#working-in-r-4"><span class="toc-section-number">14.5</span> Working in R</a><ul>
<li><a href="14-5-working-in-r-4.html#importing-the-heart-necrosis-data"><span class="toc-section-number">14.5.1</span> Importing the heart necrosis data</a></li>
<li><a href="14-5-working-in-r-4.html#fitting-the-model"><span class="toc-section-number">14.5.2</span> Fitting the model</a></li>
<li><a href="14-5-working-in-r-4.html#ancova-tables"><span class="toc-section-number">14.5.3</span> ANCOVA tables</a></li>
<li><a href="14-5-working-in-r-4.html#plotting-the-model"><span class="toc-section-number">14.5.4</span> Plotting the model</a></li>
</ul></li>
<li class="has-sub"><a href="14-6-best-practices.html#best-practices"><span class="toc-section-number">14.6</span> Best practices</a><ul>
<li><a href="14-6-best-practices.html#do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate"><span class="toc-section-number">14.6.1</span> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</a></li>
<li><a href="14-6-best-practices.html#do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate"><span class="toc-section-number">14.6.2</span> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</a></li>
<li><a href="14-6-best-practices.html#do-not-test-for-balance-of-baseline-measures"><span class="toc-section-number">14.6.3</span> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li><a href="14-7-best-practices-2-use-a-covariate-instead-of-normalizing-a-response.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><span class="toc-section-number">14.7</span> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li class="has-sub"><a href="15-two-or-more-categorical-x-factorial-designs.html#two-or-more-categorical-x-factorial-designs"><span class="toc-section-number">15</span> Two (or more) Categorical <span class="math inline">\(X\)</span> – Factorial designs</a><ul>
<li class="has-sub"><a href="15-1-factorial-experiments.html#factorial-experiments"><span class="toc-section-number">15.1</span> Factorial experiments</a><ul>
<li><a href="15-1-factorial-experiments.html#model-coefficients-an-interaction-effect-is-what-is-leftover-after-adding-the-treatment-effects-to-the-control"><span class="toc-section-number">15.1.1</span> Model coefficients: an interaction effect is what is leftover after adding the treatment effects to the control</a></li>
<li><a href="15-1-factorial-experiments.html#what-is-the-biological-meaning-of-an-interaction-effect"><span class="toc-section-number">15.1.2</span> What is the biological meaning of an interaction effect?</a></li>
<li><a href="15-1-factorial-experiments.html#the-interpretation-of-the-coefficients-in-a-factorial-model-is-entirely-dependent-on-the-reference"><span class="toc-section-number">15.1.3</span> The interpretation of the coefficients in a factorial model is entirely dependent on the reference…</a></li>
<li><a href="15-1-factorial-experiments.html#estimated-marginal-means"><span class="toc-section-number">15.1.4</span> Estimated marginal means</a></li>
<li><a href="15-1-factorial-experiments.html#in-a-factorial-model-there-are-multiple-effects-of-each-factor-simple-effects"><span class="toc-section-number">15.1.5</span> In a factorial model, there are multiple effects of each factor (simple effects)</a></li>
<li><a href="15-1-factorial-experiments.html#marginal-effects"><span class="toc-section-number">15.1.6</span> Marginal effects</a></li>
<li><a href="15-1-factorial-experiments.html#the-additive-model"><span class="toc-section-number">15.1.7</span> The additive model</a></li>
<li><a href="15-1-factorial-experiments.html#reduce-models-for-the-right-reason"><span class="toc-section-number">15.1.8</span> Reduce models for the right reason</a></li>
<li><a href="15-1-factorial-experiments.html#what-about-models-with-more-than-two-factors"><span class="toc-section-number">15.1.9</span> What about models with more than two factors?</a></li>
</ul></li>
<li class="has-sub"><a href="15-2-reporting-results.html#reporting-results"><span class="toc-section-number">15.2</span> Reporting results</a><ul>
<li><a href="15-2-reporting-results.html#text-results"><span class="toc-section-number">15.2.1</span> Text results</a></li>
</ul></li>
<li class="has-sub"><a href="15-3-working-in-r-5.html#working-in-r-5"><span class="toc-section-number">15.3</span> Working in R</a><ul>
<li><a href="15-3-working-in-r-5.html#model-formula"><span class="toc-section-number">15.3.1</span> Model formula</a></li>
<li><a href="15-3-working-in-r-5.html#modeled-means"><span class="toc-section-number">15.3.2</span> Modeled means</a></li>
<li><a href="15-3-working-in-r-5.html#marginal-means"><span class="toc-section-number">15.3.3</span> Marginal means</a></li>
<li><a href="15-3-working-in-r-5.html#contrasts"><span class="toc-section-number">15.3.4</span> Contrasts</a></li>
<li><a href="15-3-working-in-r-5.html#simple-effects"><span class="toc-section-number">15.3.5</span> Simple effects</a></li>
<li><a href="15-3-working-in-r-5.html#marginal-effects-1"><span class="toc-section-number">15.3.6</span> Marginal effects</a></li>
<li><a href="15-3-working-in-r-5.html#plotting-results"><span class="toc-section-number">15.3.7</span> Plotting results</a></li>
</ul></li>
<li><a href="15-4-problems-1.html#problems-1"><span class="toc-section-number">15.4</span> Problems</a></li>
</ul></li>
<li class="has-sub"><a href="16-anova-tables.html#anova-tables"><span class="toc-section-number">16</span> ANOVA Tables</a><ul>
<li><a href="16-1-summary-of-usage.html#summary-of-usage"><span class="toc-section-number">16.1</span> Summary of usage</a></li>
<li><a href="16-2-example-a-one-way-anova-using-the-vole-data.html#example-a-one-way-anova-using-the-vole-data"><span class="toc-section-number">16.2</span> Example: a one-way ANOVA using the vole data</a></li>
<li class="has-sub"><a href="16-3-example-a-two-way-anova-using-the-urchin-data.html#example-a-two-way-anova-using-the-urchin-data"><span class="toc-section-number">16.3</span> Example: a two-way ANOVA using the urchin data</a><ul>
<li><a href="16-3-example-a-two-way-anova-using-the-urchin-data.html#how-to-read-an-anova-table"><span class="toc-section-number">16.3.1</span> How to read an ANOVA table</a></li>
<li><a href="16-3-example-a-two-way-anova-using-the-urchin-data.html#how-to-read-anova-results-reported-in-the-text"><span class="toc-section-number">16.3.2</span> How to read ANOVA results reported in the text</a></li>
<li><a href="16-3-example-a-two-way-anova-using-the-urchin-data.html#better-practice-estimates-and-their-uncertainty"><span class="toc-section-number">16.3.3</span> Better practice – estimates and their uncertainty</a></li>
</ul></li>
<li class="has-sub"><a href="16-4-unbalanced-designs.html#unbalanced-designs"><span class="toc-section-number">16.4</span> Unbalanced designs</a><ul>
<li><a href="16-4-unbalanced-designs.html#what-is-going-on-in-unbalanced-anova-type-i-ii-iii-sum-of-squares"><span class="toc-section-number">16.4.1</span> What is going on in unbalanced ANOVA? – Type I, II, III sum of squares</a></li>
<li><a href="16-4-unbalanced-designs.html#back-to-interpretation-of-main-effects"><span class="toc-section-number">16.4.2</span> Back to interpretation of main effects</a></li>
<li><a href="16-4-unbalanced-designs.html#the-anova-tables-for-type-i-ii-and-iii-sum-of-squares-are-the-same-if-the-design-is-balanced."><span class="toc-section-number">16.4.3</span> The anova tables for Type I, II, and III sum of squares are the same if the design is balanced.</a></li>
</ul></li>
<li class="has-sub"><a href="16-5-working-in-r-6.html#working-in-r-6"><span class="toc-section-number">16.5</span> Working in R</a><ul>
<li><a href="16-5-working-in-r-6.html#type-i-sum-of-squares-in-r"><span class="toc-section-number">16.5.1</span> Type I sum of squares in R</a></li>
<li><a href="16-5-working-in-r-6.html#type-ii-and-iii-sum-of-squares"><span class="toc-section-number">16.5.2</span> Type II and III Sum of Squares</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="17-predictive-models.html#predictive-models"><span class="toc-section-number">17</span> Predictive Models</a><ul>
<li><a href="17-1-overfitting.html#overfitting"><span class="toc-section-number">17.1</span> Overfitting</a></li>
<li class="has-sub"><a href="17-2-model-building-vs-variable-selection-vs-model-selection.html#model-building-vs.-variable-selection-vs.-model-selection"><span class="toc-section-number">17.2</span> Model building vs. Variable selection vs. Model selection</a><ul>
<li><a href="17-2-model-building-vs-variable-selection-vs-model-selection.html#stepwise-regression"><span class="toc-section-number">17.2.1</span> Stepwise regression</a></li>
<li><a href="17-2-model-building-vs-variable-selection-vs-model-selection.html#cross-validation"><span class="toc-section-number">17.2.2</span> Cross-validation</a></li>
<li><a href="17-2-model-building-vs-variable-selection-vs-model-selection.html#penalization"><span class="toc-section-number">17.2.3</span> Penalization</a></li>
</ul></li>
<li><a href="17-3-shrinkage.html#shrinkage"><span class="toc-section-number">17.3</span> Shrinkage</a></li>
</ul></li>
<li><a href="part-vii-expanding-the-linear-model.html#part-vii-expanding-the-linear-model">Part VII – Expanding the Linear Model</a></li>
<li class="has-sub"><a href="18-models-with-random-effects-blocking-and-pseudoreplication.html#models-with-random-effects-blocking-and-pseudoreplication"><span class="toc-section-number">18</span> Models with random effects – Blocking and pseudoreplication</a><ul>
<li><a href="18-1-random-effects.html#random-effects"><span class="toc-section-number">18.1</span> Random effects</a></li>
<li><a href="18-2-random-effects-in-statistical-models.html#random-effects-in-statistical-models"><span class="toc-section-number">18.2</span> Random effects in statistical models</a></li>
<li><a href="18-3-linear-mixed-models-are-flexible.html#linear-mixed-models-are-flexible"><span class="toc-section-number">18.3</span> Linear mixed models are flexible</a></li>
<li class="has-sub"><a href="18-4-blocking.html#blocking"><span class="toc-section-number">18.4</span> Blocking</a><ul>
<li><a href="18-4-blocking.html#visualing-variation-due-to-blocks"><span class="toc-section-number">18.4.1</span> Visualing variation due to blocks</a></li>
<li><a href="18-4-blocking.html#blocking-increases-precision-of-point-estimates"><span class="toc-section-number">18.4.2</span> Blocking increases precision of point estimates</a></li>
</ul></li>
<li class="has-sub"><a href="18-5-pseudoreplication.html#pseudoreplication"><span class="toc-section-number">18.5</span> Pseudoreplication</a><ul>
<li><a href="18-5-pseudoreplication.html#visualizing-pseduoreplication"><span class="toc-section-number">18.5.1</span> Visualizing pseduoreplication</a></li>
</ul></li>
<li><a href="18-6-mapping-nhst-to-estimation-a-paired-t-test-is-a-special-case-of-a-linear-mixed-model.html#mapping-nhst-to-estimation-a-paired-t-test-is-a-special-case-of-a-linear-mixed-model"><span class="toc-section-number">18.6</span> Mapping NHST to estimation: A paired t-test is a special case of a linear mixed model</a></li>
<li><a href="18-7-advanced-topic-linear-mixed-models-shrink-coefficients-by-partial-pooling.html#advanced-topic-linear-mixed-models-shrink-coefficients-by-partial-pooling"><span class="toc-section-number">18.7</span> Advanced topic – Linear mixed models shrink coefficients by partial pooling</a></li>
<li class="has-sub"><a href="18-8-working-in-r-7.html#working-in-r-7"><span class="toc-section-number">18.8</span> Working in R</a><ul>
<li><a href="18-8-working-in-r-7.html#coral-data"><span class="toc-section-number">18.8.1</span> coral data</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="19-models-for-longitudinal-experiments-pre-post-designs.html#models-for-longitudinal-experiments-pre-post-designs"><span class="toc-section-number">19</span> Models for longitudinal experiments – pre-post designs</a><ul>
<li><a href="19-1-best-practice-models.html#best-practice-models"><span class="toc-section-number">19.1</span> Best practice models</a></li>
<li><a href="19-2-common-alternatives-that-are-not-recommended.html#common-alternatives-that-are-not-recommended"><span class="toc-section-number">19.2</span> Common alternatives that are not recommended</a></li>
<li><a href="19-3-advanced-models.html#advanced-models"><span class="toc-section-number">19.3</span> Advanced models</a></li>
<li class="has-sub"><a href="19-4-understanding-the-alternative-models.html#understanding-the-alternative-models"><span class="toc-section-number">19.4</span> Understanding the alternative models</a><ul>
<li><a href="19-4-understanding-the-alternative-models.html#m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model"><span class="toc-section-number">19.4.1</span> (M1) Linear model with the baseline measure as the covariate (ANCOVA model)</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m2-linear-model-of-the-change-score-change-score-model"><span class="toc-section-number">19.4.2</span> (M2) Linear model of the change score (change-score model)</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model"><span class="toc-section-number">19.4.3</span> (M3) Linear model of post-baseline values without the baseline as a covariate (post model)</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m4-linear-model-with-factorial-fixed-effects-fixed-effects-model"><span class="toc-section-number">19.4.4</span> (M4) Linear model with factorial fixed effects (fixed-effects model)</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m5-repeated-measures-anova"><span class="toc-section-number">19.4.5</span> (M5) Repeated measures ANOVA</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m6-linear-mixed-model"><span class="toc-section-number">19.4.6</span> (M6) Linear mixed model</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m7-linear-model-with-correlated-error"><span class="toc-section-number">19.4.7</span> (M7) Linear model with correlated error</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m8-constrained-fixed-effects-model-with-correlated-error-clda-model"><span class="toc-section-number">19.4.8</span> (M8) Constrained fixed effects model with correlated error (cLDA model)</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#comparison-table"><span class="toc-section-number">19.4.9</span> Comparison table</a></li>
</ul></li>
<li class="has-sub"><a href="19-5-example-1-a-single-post-baseline-measure-pre-post-design.html#example-1-a-single-post-baseline-measure-pre-post-design"><span class="toc-section-number">19.5</span> Example 1 – a single post-baseline measure (pre-post design)</a><ul>
<li><a href="19-5-example-1-a-single-post-baseline-measure-pre-post-design.html#analysis"><span class="toc-section-number">19.5.1</span> Analysis</a></li>
</ul></li>
<li><a href="19-6-working-in-r-8.html#working-in-r-8"><span class="toc-section-number">19.6</span> Working in R</a></li>
</ul></li>
<li class="has-sub"><a href="20-generalized-linear-models-i-count-data.html#generalized-linear-models-i-count-data"><span class="toc-section-number">20</span> Generalized linear models I: Count data</a><ul>
<li><a href="20-1-the-generalized-linear-model.html#the-generalized-linear-model"><span class="toc-section-number">20.1</span> The generalized linear model</a></li>
<li class="has-sub"><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish"><span class="toc-section-number">20.2</span> Count data example – number of trematode worm larvae in eyes of threespine stickleback fish</a><ul>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#modeling-strategy-1"><span class="toc-section-number">20.2.1</span> Modeling strategy</a></li>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#checking-the-model-i-a-normal-q-q-plot"><span class="toc-section-number">20.2.2</span> Checking the model I – a Normal Q-Q plot</a></li>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#checking-the-model-ii-scale-location-plot-for-checking-homoskedasticity"><span class="toc-section-number">20.2.3</span> Checking the model II – scale-location plot for checking homoskedasticity</a></li>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#two-distributions-for-count-data-poisson-and-negative-binomial"><span class="toc-section-number">20.2.4</span> Two distributions for count data – Poisson and Negative Binomial</a></li>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#fitting-a-glm-with-a-poisson-distribution-to-the-worm-data"><span class="toc-section-number">20.2.5</span> Fitting a GLM with a Poisson distribution to the worm data</a></li>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#model-checking-fits-to-count-data"><span class="toc-section-number">20.2.6</span> Model checking fits to count data</a></li>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#fitting-a-glm-with-a-negative-binomial-distribution-to-the-worm-data"><span class="toc-section-number">20.2.7</span> Fitting a GLM with a Negative Binomial distribution to the worm data</a></li>
</ul></li>
<li class="has-sub"><a href="20-3-working-in-r-9.html#working-in-r-9"><span class="toc-section-number">20.3</span> Working in R</a><ul>
<li><a href="20-3-working-in-r-9.html#fitting-a-glm-to-count-data"><span class="toc-section-number">20.3.1</span> Fitting a GLM to count data</a></li>
<li><a href="20-3-working-in-r-9.html#fitting-a-generalized-linear-mixed-model-glmm-to-count-data"><span class="toc-section-number">20.3.2</span> Fitting a generalized linear mixed model (GLMM) to count data</a></li>
<li><a href="20-3-working-in-r-9.html#fitting-a-generalized-linear-model-to-continouus-data"><span class="toc-section-number">20.3.3</span> Fitting a generalized linear model to continouus data</a></li>
</ul></li>
<li><a href="20-4-problems-2.html#problems-2"><span class="toc-section-number">20.4</span> Problems</a></li>
</ul></li>
<li class="has-sub"><a href="21-linear-models-with-heterogenous-variance.html#linear-models-with-heterogenous-variance"><span class="toc-section-number">21</span> Linear models with heterogenous variance</a><ul>
<li><a href="21-1-gls.html#gls"><span class="toc-section-number">21.1</span> gls</a></li>
</ul></li>
<li><a href="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html#part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models">Part V: Expanding the Linear Model – Generalized Linear Models and Multilevel (Linear Mixed) Models</a></li>
<li class="has-sub"><a href="22-plotting-functions-ggplotsci.html#plotting-functions-ggplotsci"><span class="toc-section-number">22</span> Plotting functions (#ggplotsci)</a><ul>
<li><a href="22-1-odd-even.html#odd-even"><span class="toc-section-number">22.1</span> odd-even</a></li>
<li><a href="22-2-estimate-response-and-effects-with-emmeans.html#estimate-response-and-effects-with-emmeans"><span class="toc-section-number">22.2</span> estimate response and effects with emmeans</a></li>
<li><a href="22-3-emm-table.html#emm_table"><span class="toc-section-number">22.3</span> emm_table</a></li>
<li><a href="22-4-pairs-table.html#pairs_table"><span class="toc-section-number">22.4</span> pairs_table</a></li>
<li><a href="22-5-gg-mean-error.html#gg_mean_error"><span class="toc-section-number">22.5</span> gg_mean_error</a></li>
<li><a href="22-6-gg-ancova.html#gg_ancova"><span class="toc-section-number">22.6</span> gg_ancova</a></li>
<li><a href="22-7-gg-mean-ci-ancova.html#gg_mean_ci_ancova"><span class="toc-section-number">22.7</span> gg_mean_ci_ancova</a></li>
<li><a href="22-8-gg-effects.html#gg_effects"><span class="toc-section-number">22.8</span> gg_effects</a></li>
</ul></li>
<li class="has-sub"><a href="appendix-1-getting-started-with-r.html#appendix-1-getting-started-with-r">Appendix 1: Getting Started with R</a><ul>
<li class="has-sub"><a href="22-9-get-your-computer-ready.html#get-your-computer-ready"><span class="toc-section-number">22.9</span> Get your computer ready</a><ul>
<li><a href="22-9-get-your-computer-ready.html#start-here"><span class="toc-section-number">22.9.1</span> Start here</a></li>
<li><a href="22-9-get-your-computer-ready.html#install-r"><span class="toc-section-number">22.9.2</span> Install R</a></li>
<li><a href="22-9-get-your-computer-ready.html#install-r-studio"><span class="toc-section-number">22.9.3</span> Install R Studio</a></li>
<li><a href="22-9-get-your-computer-ready.html#install-r-markdown-1"><span class="toc-section-number">22.9.4</span> Install R Markdown</a></li>
<li><a href="22-9-get-your-computer-ready.html#optional-alternative-latex-installations"><span class="toc-section-number">22.9.5</span> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li><a href="22-10-start-learning-r-studio.html#start-learning-r-studio"><span class="toc-section-number">22.10</span> Start learning R Studio</a></li>
</ul></li>
<li><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html#appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r">Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="has-sub"><a href="appendix-3-fake-data-simulations.html#appendix-3-fake-data-simulations">Appendix 3: Fake Data Simulations</a><ul>
<li><a href="22-11-performance-of-blocking-relative-to-a-linear-model.html#performance-of-blocking-relative-to-a-linear-model"><span class="toc-section-number">22.11</span> Performance of Blocking relative to a linear model</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="working-in-r" class="section level2">
<h2><span class="header-section-number">4.3</span> Working in R</h2>
<p>A reasonable goal of any research project should be a script to generate the final plots entirely within the R environment and not rely on external drawing software to add finishing features. <a href="https://ggplot2.tidyverse.org">ggplot2</a> is one of the major plotting environments in R and the one that seems to have the strongest following, especially among new R users. ggplot2 has the ability to generate extremely personalized and finished plots. However, creating a plot with multiple layers (bars, lines, error intervals, raw data points, p-values, text annotations) can often require many hours of googling.</p>
<p><a href="https://cran.r-project.org/web/packages/ggpubr/index.html">ggpubr</a> is an extension to ggplot2 (it calls ggplot2 functions under the hood) and provides many canned functions for producing the kinds of ggplots that are published in biological journals. With one line of script, a researcher can generate a publishable plot that is as good or better than many published plot.</p>
<p><strong>Here I show how to add custom (ggplot2) features to a ggpubr plot</strong></p>
<p>Throughout this book, ggpubr is used to create a basic plot and then additional features are added to the basic plot using ggplot2 functions.</p>
<div id="unpooled-se-bars-and-confidence-intervals" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Unpooled SE bars and confidence intervals</h3>
<p><code>ggplot2</code> and <code>ggpubr</code> default to unpooled error intervals (standard error bars and confidence intervals).</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="4-3-working-in-r.html#cb144-1"></a>gg1 &lt;-<span class="st"> </span><span class="kw">ggbarplot</span>(<span class="dt">data =</span> exp2d,</span>
<span id="cb144-2"><a href="4-3-working-in-r.html#cb144-2"></a>                 <span class="dt">x =</span> <span class="st">&quot;donor&quot;</span>, </span>
<span id="cb144-3"><a href="4-3-working-in-r.html#cb144-3"></a>                 <span class="dt">y =</span> <span class="st">&quot;count&quot;</span>, </span>
<span id="cb144-4"><a href="4-3-working-in-r.html#cb144-4"></a>                 <span class="dt">add =</span> <span class="kw">c</span>(<span class="st">&quot;mean_se&quot;</span>),</span>
<span id="cb144-5"><a href="4-3-working-in-r.html#cb144-5"></a>                 <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span></span>
<span id="cb144-6"><a href="4-3-working-in-r.html#cb144-6"></a>)</span>
<span id="cb144-7"><a href="4-3-working-in-r.html#cb144-7"></a>gg2 &lt;-<span class="st"> </span><span class="kw">ggbarplot</span>(<span class="dt">data =</span> exp2d,</span>
<span id="cb144-8"><a href="4-3-working-in-r.html#cb144-8"></a>                 <span class="dt">x =</span> <span class="st">&quot;donor&quot;</span>, </span>
<span id="cb144-9"><a href="4-3-working-in-r.html#cb144-9"></a>                 <span class="dt">y =</span> <span class="st">&quot;count&quot;</span>, </span>
<span id="cb144-10"><a href="4-3-working-in-r.html#cb144-10"></a>                 <span class="dt">add =</span> <span class="kw">c</span>(<span class="st">&quot;mean_ci&quot;</span>),</span>
<span id="cb144-11"><a href="4-3-working-in-r.html#cb144-11"></a>                 <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span></span>
<span id="cb144-12"><a href="4-3-working-in-r.html#cb144-12"></a>)</span>
<span id="cb144-13"><a href="4-3-working-in-r.html#cb144-13"></a><span class="kw">plot_grid</span>(gg1, gg2, <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">labels=</span><span class="st">&quot;AUTO&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:plots-unpooled"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plots-unpooled-1.png" alt="(A) Mean and 1 SE error bar. (B) Mean and 95% CI." width="576" />
<p class="caption">
Figure 4.5: (A) Mean and 1 SE error bar. (B) Mean and 95% CI.
</p>
</div>
</div>
<div id="adding-bootstrap-intervals" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Adding bootstrap intervals</h3>
<p>A bootstrap CI uses resamples of the data to estimate the interval and is a better choice than the default CI for data such as counts and proportions. The plot below uses ggpubr to create a stripchart of the data and the color of the data points are “de-emphasized” – in order to emphasize the mean and CI – by making them more transparent (using the argument <code>alpha</code>). <code>alpha</code> is added before the argument to add the mean in order to no de-emphasize the mean.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="4-3-working-in-r.html#cb145-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb145-2"><a href="4-3-working-in-r.html#cb145-2"></a>gg.boot &lt;-<span class="st"> </span><span class="kw">ggstripchart</span>(<span class="dt">data=</span>exp2d,</span>
<span id="cb145-3"><a href="4-3-working-in-r.html#cb145-3"></a>                   <span class="dt">x =</span> <span class="st">&quot;donor&quot;</span>, </span>
<span id="cb145-4"><a href="4-3-working-in-r.html#cb145-4"></a>                   <span class="dt">y =</span> <span class="st">&quot;count&quot;</span>, </span>
<span id="cb145-5"><a href="4-3-working-in-r.html#cb145-5"></a>                   <span class="dt">alpha =</span> <span class="fl">0.4</span>,</span>
<span id="cb145-6"><a href="4-3-working-in-r.html#cb145-6"></a>                   <span class="dt">add =</span> <span class="st">&quot;mean&quot;</span></span>
<span id="cb145-7"><a href="4-3-working-in-r.html#cb145-7"></a>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb145-8"><a href="4-3-working-in-r.html#cb145-8"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>, </span>
<span id="cb145-9"><a href="4-3-working-in-r.html#cb145-9"></a>               <span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>, </span>
<span id="cb145-10"><a href="4-3-working-in-r.html#cb145-10"></a>               <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb145-11"><a href="4-3-working-in-r.html#cb145-11"></a><span class="st">  </span><span class="ot">NULL</span></span>
<span id="cb145-12"><a href="4-3-working-in-r.html#cb145-12"></a>gg.boot</span></code></pre></div>
<div class="figure"><span id="fig:plot-boot-plot"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plot-boot-plot-1.png" alt="Sample means with bootstrapped 95% confidence intervals." width="576" />
<p class="caption">
Figure 4.6: Sample means with bootstrapped 95% confidence intervals.
</p>
</div>
</div>
<div id="adding-modeled-means-and-error-intervals" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Adding modeled means and error intervals</h3>
<p>This section is extremely important for implementing the work flow advocated in this text. The goal is to plot the modeled means with some sort of error interval, typically a confidence interval, <em>and</em> to show the data or a summary of the data in a single plot. The procedure is</p>
<ol style="list-style-type: decimal">
<li>fit the model</li>
<li>use the fit model to estimate the modeled means and confidence limits using <code>emmeans</code> from the <a href="https://cran.r-project.org/web/packages/emmeans/index.html">emmeans package</a>.</li>
<li>use the <code>emmean</code> object to estimate the contrasts of interests using the <code>contrast</code> function from emmeans.</li>
<li>Use the objects from steps 2 and 3 to plot the modeled means</li>
</ol>
<p><strong>Step 1: Fit the model</strong>. A negative binomial, generalized linear model with log-link is fit to the count data.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="4-3-working-in-r.html#cb146-1"></a>m1 &lt;-<span class="st"> </span><span class="kw">glm.nb</span>(count <span class="op">~</span><span class="st"> </span>donor, <span class="dt">data=</span>exp2d)</span>
<span id="cb146-2"><a href="4-3-working-in-r.html#cb146-2"></a><span class="kw">coef</span>(<span class="kw">summary</span>(m1))</span></code></pre></div>
<pre><code>##               Estimate Std. Error    z value     Pr(&gt;|z|)
## (Intercept)  0.9873867  0.2229971  4.4278004 9.519895e-06
## donorgf     -0.8203326  0.4227008 -1.9406930 5.229553e-02
## donoriap_mo -0.1544775  0.3878578 -0.3982839 6.904209e-01
## donorsox10   1.0091672  0.2862047  3.5260325 4.218353e-04</code></pre>
<ul>
<li>The estimates and SE are on the <strong>link scale</strong>, which means they are in log-transformed space (or “log space”). Exponentiate these with exp(x) to <strong>backstransform</strong> these to the the <strong>response scale</strong> which is the scale of the measurement (number of neutrophils).</li>
</ul>
<p><strong>Step 2: Estimate the modeled means and confidence levels</strong>. The second step is to pass the fit model object (m1) to <code>emmeans</code> to estimate the modeled means.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="4-3-working-in-r.html#cb148-1"></a>m1.emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(m1, <span class="dt">specs=</span><span class="st">&quot;donor&quot;</span>, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb148-2"><a href="4-3-working-in-r.html#cb148-2"></a>m1.emm</span></code></pre></div>
<pre><code>##  donor  response    SE  df asymp.LCL asymp.UCL
##  wt         2.68 0.599 Inf     1.734      4.16
##  gf         1.18 0.424 Inf     0.585      2.39
##  iap_mo     2.30 0.730 Inf     1.235      4.28
##  sox10      7.36 1.321 Inf     5.181     10.47
## 
## Confidence level used: 0.95 
## Intervals are back-transformed from the log scale</code></pre>
<ul>
<li>We specify the means that we want to estimate with “specs =”. Here, we want to estimate the means of the levels of <span class="math inline">\(donor\)</span>.</li>
<li>Because the linear predictor of the model is on the log scale, we use the “type” argument to specify that we want the means to be backtransformed to the <strong>response scale</strong>, which is the scale of the measurement (number of cells)</li>
<li>It can be useful to convert the emmeans table m1.emm to a data.table (or data.frame or tibble) using <code>m1.emm &lt;- data.table(m1.emm)</code>. <strong>Bug alert</strong> If you do this, the object cannot be passed to the next step, the <code>contrast</code> function. So if you want the emmeans table as a data.table, assign it to a different name, for example <code>m1.emm_dt &lt;- data.table(m1.emm)</code>.</li>
</ul>
<p><strong>Step 3: Compute the contrasts, with p-values and confidence levels</strong>. Contrasts among levels, or combinations of levels, are computed by passing the emmeans object (m1.emm) to the <code>contrast</code> function.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="4-3-working-in-r.html#cb150-1"></a>m1.pairs &lt;-<span class="st"> </span><span class="kw">contrast</span>(m1.emm, <span class="dt">method=</span><span class="st">&quot;revpairwise&quot;</span>, <span class="dt">adjust=</span><span class="st">&quot;none&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb150-2"><a href="4-3-working-in-r.html#cb150-2"></a><span class="st">  </span><span class="kw">summary</span>(<span class="dt">infer=</span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>))</span>
<span id="cb150-3"><a href="4-3-working-in-r.html#cb150-3"></a>m1.pairs</span></code></pre></div>
<pre><code>##  contrast       ratio    SE  df asymp.LCL asymp.UCL z.ratio p.value
##  gf / wt        0.440 0.186 Inf     0.192      1.01 -1.941  0.0523 
##  iap_mo / wt    0.857 0.332 Inf     0.401      1.83 -0.398  0.6904 
##  iap_mo / gf    1.946 0.933 Inf     0.761      4.98  1.389  0.1647 
##  sox10 / wt     2.743 0.785 Inf     1.566      4.81  3.526  0.0004 
##  sox10 / gf     6.231 2.501 Inf     2.837     13.68  4.558  &lt;.0001 
##  sox10 / iap_mo 3.202 1.167 Inf     1.567      6.54  3.192  0.0014 
## 
## Confidence level used: 0.95 
## Intervals are back-transformed from the log scale 
## Tests are performed on the log scale</code></pre>
<ul>
<li>Here, we set “method” to “revpairwise” in order to compute contrasts among all pairs of levels of <span class="math inline">\(donor\)</span>. There are <span class="math inline">\(m = 4\)</span> levels and so <span class="math inline">\(m(m-1)/2 = 6\)</span> pairwise contrasts. “revpairwise” is used instead of “pairwise” because the former sets the direction of the contrasts that include the reference as non-reference level minus reference level.</li>
<li>I use the “adjust” argument to specify no <em>p</em>-value adjustment for multiple tests.</li>
<li>the contrast object is then piped (%&gt;%) to the summary function, where I pass to the argument “infer”, that I want both the confidence intervals (the first TRUE) and <em>p</em>-values (the second TRUE)</li>
<li>this step isn’t necessary if we were plotting only modeled means and CIs but 1) we almost always want contrasts with a fit model and so that is done here as part of the uninterrupted work flow that this book advocates and 2) we do use the <em>p</em>-values and CIs from this table (m1.pairs) in the final plot below.</li>
<li><strong>Bug alert</strong> again, the emmeans table m1.emm must be passed to <code>contrast</code> as an emmeans object. If you have converted this object to a data.table, you will get an error. See the last note in Step 2.</li>
</ul>
<p><strong>Step 4: Plot the modeled means and 95% error intervals</strong>.</p>
<p>The code below first creates the stripchart using the ggpubr function and then adds the confidence intervals using <code>geom_errorbar</code> and means using <code>geom_point</code>. The stripchart uses the data in the exp2d data.table. The errorbar and mean use the values in m1.emm object created by the <code>emmeans</code> function. The <code>geom_errorbar</code> and <code>geom_point</code> functions require an “aesthetic” to tell ggplot which column contains the y values of the points to plot (the “x” values are still in the column “donor”, which is a column in both the exp2d data.table and m1.emm). The name of the column containing the “y” values in m1.emm is “response”.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="4-3-working-in-r.html#cb152-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb152-2"><a href="4-3-working-in-r.html#cb152-2"></a>gg.nb &lt;-<span class="st"> </span><span class="kw">ggstripchart</span>(<span class="dt">data=</span>exp2d,</span>
<span id="cb152-3"><a href="4-3-working-in-r.html#cb152-3"></a>                 <span class="dt">x=</span><span class="st">&quot;donor&quot;</span>, </span>
<span id="cb152-4"><a href="4-3-working-in-r.html#cb152-4"></a>                 <span class="dt">y=</span><span class="st">&quot;count&quot;</span>,</span>
<span id="cb152-5"><a href="4-3-working-in-r.html#cb152-5"></a>                 <span class="dt">alpha =</span> <span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb152-6"><a href="4-3-working-in-r.html#cb152-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Neutrophil count&quot;</span>) <span class="op">+</span></span>
<span id="cb152-7"><a href="4-3-working-in-r.html#cb152-7"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data=</span><span class="kw">summary</span>(m1.emm), </span>
<span id="cb152-8"><a href="4-3-working-in-r.html#cb152-8"></a>                <span class="kw">aes</span>(<span class="dt">y=</span>response,</span>
<span id="cb152-9"><a href="4-3-working-in-r.html#cb152-9"></a>                    <span class="dt">ymin=</span>asymp.LCL, </span>
<span id="cb152-10"><a href="4-3-working-in-r.html#cb152-10"></a>                    <span class="dt">ymax=</span>asymp.UCL), </span>
<span id="cb152-11"><a href="4-3-working-in-r.html#cb152-11"></a>                <span class="dt">width=</span><span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb152-12"><a href="4-3-working-in-r.html#cb152-12"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span><span class="kw">summary</span>(m1.emm), </span>
<span id="cb152-13"><a href="4-3-working-in-r.html#cb152-13"></a>                <span class="kw">aes</span>(<span class="dt">y=</span>response), </span>
<span id="cb152-14"><a href="4-3-working-in-r.html#cb152-14"></a>                <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb152-15"><a href="4-3-working-in-r.html#cb152-15"></a><span class="st">  </span><span class="ot">NULL</span></span>
<span id="cb152-16"><a href="4-3-working-in-r.html#cb152-16"></a>gg.nb</span></code></pre></div>
<div class="figure"><span id="fig:plot-nb-plot"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plot-nb-plot-1.png" alt="Modeled means and 95% confidence interval computed from a negative binomial generalized linear model." width="576" />
<p class="caption">
Figure 4.7: Modeled means and 95% confidence interval computed from a negative binomial generalized linear model.
</p>
</div>
<p>Some notes on the plot code</p>
<ul>
<li>A column name passed to a <code>ggpubr</code> function must be in quotes but a column name passed to a <code>ggplot2</code> function cannot be in quotes</li>
<li><strong>Bug alert</strong>. The data passed to ggplot2 must be a data.frame. In order for the ggplot2 functions to use the m1.emm object, the object has to be passed as <code>summary(m1.emm)</code>.</li>
<li><strong>Bug alert</strong>. Because the m1.emm table does not have a column named “count”, which is the “y” column specified in <code>ggstripchart</code>, you must supply a new “y” column name to the <code>aes</code> function of <code>geom_errorbar</code> and <code>geom_point</code>. This is the name of the column in the emmeans table containing the modeled means. In m1.emm, this name is “response” but it can take different names in different emmeans tables, depending on the fit model.</li>
</ul>
</div>
<div id="adding-p-values" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Adding p-values</h3>
<p>In this section, I show how to add <em>p</em>-values to a ggpubr plot using <code>stat_compare_means</code>. Because this function has only a limited set of models that can be used to compute the <em>p</em>-values, I don’t find it very useful and instead recommend adding custom <em>p</em>-values from the fit model (or from a permutation test) using the method in the next section.</p>
<p>For this example, a “t.test” is used to compute the p-values. The mean and error are the sample-based estimates because these, and not the modeled estimates, are consistent with the t-test <em>p</em>-values.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="4-3-working-in-r.html#cb153-1"></a>compare_list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;sox10&quot;</span>, <span class="st">&quot;iap_mo&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;sox10&quot;</span>, <span class="st">&quot;gf&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;sox10&quot;</span>, <span class="st">&quot;wt&quot;</span>))</span>
<span id="cb153-2"><a href="4-3-working-in-r.html#cb153-2"></a>gg.sample &lt;-<span class="st"> </span><span class="kw">ggstripchart</span>(<span class="dt">data=</span>exp2d,</span>
<span id="cb153-3"><a href="4-3-working-in-r.html#cb153-3"></a>          <span class="dt">x=</span><span class="st">&quot;donor&quot;</span>, </span>
<span id="cb153-4"><a href="4-3-working-in-r.html#cb153-4"></a>          <span class="dt">y=</span><span class="st">&quot;count&quot;</span>,</span>
<span id="cb153-5"><a href="4-3-working-in-r.html#cb153-5"></a>          <span class="dt">alpha =</span> <span class="fl">0.4</span>,</span>
<span id="cb153-6"><a href="4-3-working-in-r.html#cb153-6"></a>          <span class="dt">add=</span><span class="kw">c</span>(<span class="st">&quot;mean_ci&quot;</span>)) <span class="op">+</span></span>
<span id="cb153-7"><a href="4-3-working-in-r.html#cb153-7"></a><span class="st">  </span><span class="kw">stat_compare_means</span>(<span class="dt">method =</span> <span class="st">&quot;t.test&quot;</span>, <span class="dt">comparisons=</span>compare_list) <span class="op">+</span></span>
<span id="cb153-8"><a href="4-3-working-in-r.html#cb153-8"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Neutrophil count&quot;</span>) <span class="op">+</span></span>
<span id="cb153-9"><a href="4-3-working-in-r.html#cb153-9"></a><span class="st">  </span><span class="ot">NULL</span></span>
<span id="cb153-10"><a href="4-3-working-in-r.html#cb153-10"></a>gg.sample</span></code></pre></div>
<div class="figure"><span id="fig:plot-p-values"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plot-p-values-1.png" alt="t-test p-values for the plot of sample means and CIs. The p-values were computed using ggpubr's function stat_compare_means." width="576" />
<p class="caption">
Figure 4.8: t-test p-values for the plot of sample means and CIs. The p-values were computed using ggpubr’s function stat_compare_means.
</p>
</div>
<p>Notes on the code</p>
<ul>
<li><p>The pairs to compare with a <em>p</em>-value are specified with <code>comparison =</code>. The order of the pairs in the list function determine the order plotted from bottom (lowest on the y-axis) to top (highest on the y-axis).</p></li>
<li><p><strong>It is important to know what exactly is being computed when analyzing data and reporting results</strong> and “t test” is not sufficient to know this. The t-test could be the classic t-test or a Welch test. In this example, there are multiple comparisons and the standard error of the test statistic could be the pooled estimate from the linear model, or a pairwise estimate computed separately for each pair. And, given the multiple comparisons, the p-values could be adjusted or not. These kinds of questions can be checked with a function’s help page. <code>?stat_compare_means</code> doesn’t answer these questions but suggests <code>compare_means</code>, which also doesn’t answer these questions. The script below has checks to see what p-values the function is returning. Run it in your session by changing the value of check_it to TRUE.</p></li>
</ul>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="4-3-working-in-r.html#cb154-1"></a><span class="co"># checks on the p-value</span></span>
<span id="cb154-2"><a href="4-3-working-in-r.html#cb154-2"></a><span class="co"># t-tests using SE pooled over all four groups</span></span>
<span id="cb154-3"><a href="4-3-working-in-r.html#cb154-3"></a>check_it &lt;-<span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb154-4"><a href="4-3-working-in-r.html#cb154-4"></a><span class="cf">if</span>(check_it<span class="op">==</span><span class="ot">TRUE</span>){</span>
<span id="cb154-5"><a href="4-3-working-in-r.html#cb154-5"></a>  m1.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(count<span class="op">~</span>donor, <span class="dt">data=</span>exp2d)</span>
<span id="cb154-6"><a href="4-3-working-in-r.html#cb154-6"></a>  m1.lm.emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(m1.lm, <span class="dt">specs=</span><span class="st">&quot;donor&quot;</span>)</span>
<span id="cb154-7"><a href="4-3-working-in-r.html#cb154-7"></a>  <span class="kw">contrast</span>(m1.lm.emm, <span class="dt">method=</span><span class="st">&quot;trt.vs.ctrl&quot;</span>, <span class="dt">ref=</span><span class="dv">4</span>, <span class="dt">adjust=</span><span class="st">&quot;none&quot;</span>) <span class="co"># pooled SD</span></span>
<span id="cb154-8"><a href="4-3-working-in-r.html#cb154-8"></a>  </span>
<span id="cb154-9"><a href="4-3-working-in-r.html#cb154-9"></a>  <span class="kw">pairwise.t.test</span>(exp2d<span class="op">$</span>count, exp2d<span class="op">$</span>donor, <span class="dt">p.adjust.method=</span><span class="st">&quot;none&quot;</span>, <span class="dt">pool.sd=</span><span class="ot">FALSE</span>) <span class="co"># non-pooled SD</span></span>
<span id="cb154-10"><a href="4-3-working-in-r.html#cb154-10"></a>  <span class="co"># compare</span></span>
<span id="cb154-11"><a href="4-3-working-in-r.html#cb154-11"></a>  <span class="kw">t.test</span>(count<span class="op">~</span>donor, <span class="dt">data=</span>exp2d[donor<span class="op">==</span><span class="st">&quot;wt&quot;</span> <span class="op">|</span><span class="st"> </span>donor<span class="op">==</span><span class="st">&quot;sox10&quot;</span>]) <span class="co"># matches, this is Welch t</span></span>
<span id="cb154-12"><a href="4-3-working-in-r.html#cb154-12"></a>  <span class="kw">t.test</span>(count<span class="op">~</span>donor, <span class="dt">data=</span>exp2d[donor<span class="op">==</span><span class="st">&quot;wt&quot;</span> <span class="op">|</span><span class="st"> </span>donor<span class="op">==</span><span class="st">&quot;sox10&quot;</span>], <span class="dt">var.equal=</span><span class="ot">TRUE</span>)</span>
<span id="cb154-13"><a href="4-3-working-in-r.html#cb154-13"></a>}</span></code></pre></div>
<p>So, the <em>p</em>-values returned by <code>stat_compare_means(method="t.test")</code> are computed from independent (not pooled over the four groups) Welch t-tests.</p>
</div>
<div id="adding-custom-p-values" class="section level3">
<h3><span class="header-section-number">4.3.5</span> Adding custom p-values</h3>
<p>If we want to add permutation <em>p</em>-values to the plot with bootstrapped CIs (<a href="4-3-working-in-r.html#fig:plot-boot-plot">4.6</a> or add <em>p</em>-values from the generalized linear model to the plot of modeled means and CIs (<a href="4-3-working-in-r.html#fig:plot-nb-plot">4.7</a>, we need to use the function <code>stat_pvalue_manual</code> from the ggpubr package. In order to implement this, we need to add a step to the work flow path above</p>
<p><strong>Step 5: Add group columns and a column of formatted p-values to the contrast table</strong></p>
<p>The <code>stat_pvalue_manual</code> function needs to read a data frame with a columns labeled “group1” and “group2” that contain the pairs of levels to compare with a plotted p-value and a column “p” containing the nicely formatted p-values to add to the plot. There is no R function to create this table, but here is a script to add these to the contrast object returned by the <code>contrast</code> function of emmeans. In this example, I use m1.pairs from above and add the p-values to the plot of modeled means and CIs (<a href="4-3-working-in-r.html#fig:plot-nb-plot">4.7</a>.</p>
<p>First, we need these functions. Run these two lines to define the functions <code>odd</code> and <code>even</code></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="4-3-working-in-r.html#cb155-1"></a>odd &lt;-<span class="st"> </span><span class="cf">function</span>(x) x<span class="op">%%</span><span class="dv">2</span> <span class="op">!=</span><span class="st"> </span><span class="dv">0</span></span>
<span id="cb155-2"><a href="4-3-working-in-r.html#cb155-2"></a>even &lt;-<span class="st"> </span><span class="cf">function</span>(x) x<span class="op">%%</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span></span></code></pre></div>
<p>Second, we need to use these functions to add the columns. There are several R packages that provide functions to format <em>p</em>-values. Here, I use the function <code>pvalString</code> from the <a href="https://www.rdocumentation.org/packages/lazyWeave/versions/3.0.2/topics/pvalString">lazyWeave</a> package. This script also uses <code>str_split</code> from the package <a href="https://cran.r-project.org/web/packages/stringr/index.html">stringr</a>.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="4-3-working-in-r.html#cb156-1"></a><span class="co"># convert m1.pairs to a data.table and assign to a new object, in order to</span></span>
<span id="cb156-2"><a href="4-3-working-in-r.html#cb156-2"></a><span class="co"># keep a clean copy of m1.pairs</span></span>
<span id="cb156-3"><a href="4-3-working-in-r.html#cb156-3"></a>m1.pvalues &lt;-<span class="st"> </span><span class="kw">data.table</span>(m1.pairs)</span>
<span id="cb156-4"><a href="4-3-working-in-r.html#cb156-4"></a><span class="co"># if the linear model is from a glm with log link, use this</span></span>
<span id="cb156-5"><a href="4-3-working-in-r.html#cb156-5"></a>groups &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">str_split</span>(m1.pvalues<span class="op">$</span>contrast, <span class="st">&quot; / &quot;</span>))</span>
<span id="cb156-6"><a href="4-3-working-in-r.html#cb156-6"></a><span class="co"># add the group1 and group 2 columns</span></span>
<span id="cb156-7"><a href="4-3-working-in-r.html#cb156-7"></a>m1.pvalues[, group1 <span class="op">:</span><span class="er">=</span><span class="st"> </span>groups[<span class="kw">odd</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(groups))]]</span>
<span id="cb156-8"><a href="4-3-working-in-r.html#cb156-8"></a>m1.pvalues[, group2 <span class="op">:</span><span class="er">=</span><span class="st"> </span>groups[<span class="kw">even</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(groups))]]</span>
<span id="cb156-9"><a href="4-3-working-in-r.html#cb156-9"></a><span class="co"># create a column of nicely formatted p-values for display.</span></span>
<span id="cb156-10"><a href="4-3-working-in-r.html#cb156-10"></a>m1.pvalues[, p <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">pvalString</span>(p.value)]</span></code></pre></div>
<p><strong>Bug alert</strong> notes on the script to build the p-value table, if you don’t want your code to fail.</p>
<ul>
<li>The script to extract the pair of group labels <code>str_split(m1.pvalues$contrast, " / "))</code> has to be written so that the characters within the quotes matches the characters separating the groups in the “contrast” column of the contrast table (here, m1.pairs). This will typically be either a space-minus-space or a space-slash-space. If the model fit is <code>lm</code> and the response is not transformed, then the correct code is <code>str_split(m1.pvalues$contrast, " - "))</code>. Regardless, look at the table to check.</li>
<li>In step 3 above, we took the contrast table object and passed it to the function <code>summary</code>, which converts the contrast table object to a data.frame. If we had skipped this step, <code>data.table(m1.pairs)</code> would fail. Instead, we’d have to use <code>data.table(summary(m1.pairs))</code>.</li>
</ul>
<p>Now we can add the p-value to the ggplot object gg.nb created above. This is the beauty of a ggplot object (including those created by ggpubr), we can just keep adding stuff to it.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="4-3-working-in-r.html#cb157-1"></a>gg.nb &lt;-<span class="st"> </span>gg.nb <span class="op">+</span></span>
<span id="cb157-2"><a href="4-3-working-in-r.html#cb157-2"></a><span class="st">    </span><span class="kw">stat_pvalue_manual</span>(m1.pvalues[<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>,], <span class="co"># only show sox effects</span></span>
<span id="cb157-3"><a href="4-3-working-in-r.html#cb157-3"></a>                           <span class="dt">label =</span> <span class="st">&quot;p&quot;</span>, </span>
<span id="cb157-4"><a href="4-3-working-in-r.html#cb157-4"></a>                           <span class="dt">y.position=</span><span class="kw">c</span>(<span class="dv">31</span>, <span class="dv">28</span>, <span class="dv">25</span>)) <span class="op">+</span></span>
<span id="cb157-5"><a href="4-3-working-in-r.html#cb157-5"></a><span class="st">  </span><span class="ot">NULL</span></span>
<span id="cb157-6"><a href="4-3-working-in-r.html#cb157-6"></a>gg.nb</span></code></pre></div>
<div class="figure"><span id="fig:plot-manual-p-values"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/plot-manual-p-values-1.png" alt="Effects and means plot. Top panel: Effects (top panel) of treatments on neutrophil count. Bottom panel: modeled means of treatment levels with 95% confidence intervals." width="576" />
<p class="caption">
Figure 4.9: Effects and means plot. Top panel: Effects (top panel) of treatments on neutrophil count. Bottom panel: modeled means of treatment levels with 95% confidence intervals.
</p>
</div>
<p>Notes on adding manual <em>p</em>-values to the plot:</p>
<ul>
<li>The pairs of groups to compare are specified by indexing the rows of m1.pvalues. Above, I limit the comparisons to those in rows 4-6. If I wanted to specify non-continous rows, I could use something like <code>m1.pvalues[c(1,3,5),]</code>, for example.</li>
<li>The most manual part of adding manual p-values is setting the position for the brackets using the “position” argument. The values in this argument are the y-coordinates of the brackets. This may take some trial-and-error to position the brackets satisfactorily.</li>
</ul>
<div id="modeled-error-intervals-of-the-effect" class="section level4">
<h4><span class="header-section-number">4.3.5.1</span> Modeled error intervals of the effect</h4>
<p>For the plot of effects, we use table of contrasts m1.pairs as the data.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="4-3-working-in-r.html#cb158-1"></a>gg.effects &lt;-<span class="st"> </span><span class="kw">ggdotplot</span>(<span class="dt">data =</span> m1.pairs,</span>
<span id="cb158-2"><a href="4-3-working-in-r.html#cb158-2"></a>                        <span class="dt">x=</span><span class="st">&quot;contrast&quot;</span>, </span>
<span id="cb158-3"><a href="4-3-working-in-r.html#cb158-3"></a>                        <span class="dt">y=</span><span class="st">&quot;ratio&quot;</span>, </span>
<span id="cb158-4"><a href="4-3-working-in-r.html#cb158-4"></a>                        <span class="dt">color =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb158-5"><a href="4-3-working-in-r.html#cb158-5"></a>                        <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb158-6"><a href="4-3-working-in-r.html#cb158-6"></a>                        <span class="dt">size=</span><span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb158-7"><a href="4-3-working-in-r.html#cb158-7"></a><span class="st">  </span></span>
<span id="cb158-8"><a href="4-3-working-in-r.html#cb158-8"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">x=</span>contrast, </span>
<span id="cb158-9"><a href="4-3-working-in-r.html#cb158-9"></a>                    <span class="dt">ymin=</span>asymp.LCL, </span>
<span id="cb158-10"><a href="4-3-working-in-r.html#cb158-10"></a>                    <span class="dt">ymax=</span>asymp.UCL),</span>
<span id="cb158-11"><a href="4-3-working-in-r.html#cb158-11"></a>                <span class="dt">width=</span><span class="fl">0.15</span>, </span>
<span id="cb158-12"><a href="4-3-working-in-r.html#cb158-12"></a>                <span class="dt">color=</span><span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb158-13"><a href="4-3-working-in-r.html#cb158-13"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Effect ratio&quot;</span>) <span class="op">+</span></span>
<span id="cb158-14"><a href="4-3-working-in-r.html#cb158-14"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">1</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb158-15"><a href="4-3-working-in-r.html#cb158-15"></a><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb158-16"><a href="4-3-working-in-r.html#cb158-16"></a><span class="st">  </span></span>
<span id="cb158-17"><a href="4-3-working-in-r.html#cb158-17"></a><span class="st">  </span><span class="ot">NULL</span></span>
<span id="cb158-18"><a href="4-3-working-in-r.html#cb158-18"></a>gg.effects</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-101-1.png" width="576" /></p>
</div>
<div id="combining-effects-and-response-plots" class="section level4">
<h4><span class="header-section-number">4.3.5.2</span> Combining effects and response plots</h4>
<p>The ggplots are combined using <code>plot_grid</code> from the package <a href="https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html">cowplot</a></p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="4-3-working-in-r.html#cb159-1"></a>gg.effects &lt;-<span class="st"> </span>gg.effects <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">position=</span><span class="st">&quot;right&quot;</span>)</span>
<span id="cb159-2"><a href="4-3-working-in-r.html#cb159-2"></a><span class="kw">plot_grid</span>(gg.effects, gg.nb, <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">align =</span> <span class="st">&quot;v&quot;</span>, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-102-1.png" width="576" /></p>
</div>
</div>
<div id="plotting-two-factors" class="section level3">
<h3><span class="header-section-number">4.3.6</span> Plotting two factors</h3>
<p>The data are from figure 6d. This solution requires computing either the raw or modeled means and errors and adding these to a base ggpubr plot. Many packages have summary statistics functions for means, standard deviations, and standard errors. This is easily done by simply computing the statistics using data.table functionality.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="4-3-working-in-r.html#cb160-1"></a><span class="co"># compute raw statistics</span></span>
<span id="cb160-2"><a href="4-3-working-in-r.html#cb160-2"></a><span class="co"># enclosing the line within parentheses prints the result to the console!</span></span>
<span id="cb160-3"><a href="4-3-working-in-r.html#cb160-3"></a>(exp6d.raw &lt;-<span class="st"> </span>exp6d[<span class="op">!</span><span class="kw">is.na</span>(count), .(<span class="dt">count=</span><span class="kw">mean</span>(count),</span>
<span id="cb160-4"><a href="4-3-working-in-r.html#cb160-4"></a>                       <span class="dt">se=</span><span class="kw">sd</span>(count)<span class="op">/</span><span class="kw">sqrt</span>(.N)),</span>
<span id="cb160-5"><a href="4-3-working-in-r.html#cb160-5"></a>                   <span class="dt">by=</span>.(treatment, strain)]</span>
<span id="cb160-6"><a href="4-3-working-in-r.html#cb160-6"></a>)</span></code></pre></div>
<pre><code>##     treatment strain    count       se
## 1:    control     wt 13.08333 2.310904
## 2:    control  sox10 45.61538 6.259903
## 3: transplant     wt 16.35714 2.259552
## 4: transplant  sox10 18.33333 4.536274</code></pre>
<p>Modeled means, standard errors, and confidence limits are conveniently computed using the <code>emmeans</code> (“estimated marginal means”) function from the emmeans package.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="4-3-working-in-r.html#cb162-1"></a><span class="co"># modeled statsistics</span></span>
<span id="cb162-2"><a href="4-3-working-in-r.html#cb162-2"></a>m1 &lt;-<span class="st"> </span><span class="kw">glm.nb</span>(count <span class="op">~</span><span class="st"> </span>treatment<span class="op">*</span>strain, <span class="dt">data=</span>exp6d)</span>
<span id="cb162-3"><a href="4-3-working-in-r.html#cb162-3"></a>(m1.emm &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="kw">summary</span>(<span class="kw">emmeans</span>(m1, <span class="dt">specs=</span><span class="kw">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;strain&quot;</span>), <span class="dt">type=</span><span class="st">&quot;response&quot;</span>))))</span></code></pre></div>
<pre><code>##     treatment strain response       SE  df asymp.LCL asymp.UCL
## 1:    control     wt 13.08333 2.032161 Inf  9.649528  17.73907
## 2: transplant     wt 16.35714 2.289208 Inf 12.433129  21.51961
## 3:    control  sox10 45.61538 6.132974 Inf 35.048350  59.36837
## 4: transplant  sox10 18.33333 3.871911 Inf 12.119140  27.73391</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="4-3-working-in-r.html#cb164-1"></a><span class="co"># change column &quot;response&quot; to &quot;count&quot; for the ggplot</span></span>
<span id="cb164-2"><a href="4-3-working-in-r.html#cb164-2"></a><span class="kw">setnames</span>(m1.emm, <span class="dt">old=</span><span class="st">&quot;response&quot;</span>, <span class="dt">new=</span><span class="st">&quot;count&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="4-3-working-in-r.html#cb165-1"></a><span class="co">#pairs_i &lt;- list(c(&quot;sox10&quot;, &quot;iap_mo&quot;), c(&quot;sox10&quot;, &quot;gf&quot;), c(&quot;sox10&quot;, &quot;wt&quot;))</span></span>
<span id="cb165-2"><a href="4-3-working-in-r.html#cb165-2"></a>pd =<span class="st"> </span><span class="kw">position_dodge</span>(<span class="fl">0.7</span>)</span>
<span id="cb165-3"><a href="4-3-working-in-r.html#cb165-3"></a><span class="kw">ggbarplot</span>(<span class="dt">x=</span><span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb165-4"><a href="4-3-working-in-r.html#cb165-4"></a>          <span class="dt">y=</span><span class="st">&quot;count&quot;</span>,</span>
<span id="cb165-5"><a href="4-3-working-in-r.html#cb165-5"></a>          <span class="dt">data=</span>exp6d,</span>
<span id="cb165-6"><a href="4-3-working-in-r.html#cb165-6"></a>          <span class="dt">add=</span><span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>),</span>
<span id="cb165-7"><a href="4-3-working-in-r.html#cb165-7"></a>          <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb165-8"><a href="4-3-working-in-r.html#cb165-8"></a>          <span class="dt">fill =</span> <span class="st">&quot;strain&quot;</span>,</span>
<span id="cb165-9"><a href="4-3-working-in-r.html#cb165-9"></a>          <span class="dt">palette =</span> <span class="st">&quot;jco&quot;</span>,</span>
<span id="cb165-10"><a href="4-3-working-in-r.html#cb165-10"></a>          <span class="dt">position =</span> pd,</span>
<span id="cb165-11"><a href="4-3-working-in-r.html#cb165-11"></a>          <span class="dt">size=</span><span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb165-12"><a href="4-3-working-in-r.html#cb165-12"></a><span class="st">  </span><span class="co">#stat_compare_means(method = &quot;t.test&quot;, comparisons=pairs_i) +</span></span>
<span id="cb165-13"><a href="4-3-working-in-r.html#cb165-13"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Neutrophil count&quot;</span>) <span class="op">+</span></span>
<span id="cb165-14"><a href="4-3-working-in-r.html#cb165-14"></a><span class="st">  </span><span class="co"># geom_dotplot(aes(fill=strain),</span></span>
<span id="cb165-15"><a href="4-3-working-in-r.html#cb165-15"></a><span class="st">  </span><span class="co">#              binaxis=&#39;y&#39;, stackdir=&#39;center&#39;, position=pd, show.legend=FALSE,</span></span>
<span id="cb165-16"><a href="4-3-working-in-r.html#cb165-16"></a><span class="st">  </span><span class="co">#              color=&quot;grey&quot;) +</span></span>
<span id="cb165-17"><a href="4-3-working-in-r.html#cb165-17"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>strain), <span class="dt">position=</span><span class="kw">position_jitterdodge</span>(<span class="dt">jitter.width=</span><span class="fl">0.2</span>), <span class="dt">show.legend=</span><span class="ot">FALSE</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb165-18"><a href="4-3-working-in-r.html#cb165-18"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data=</span>m1.emm, <span class="kw">aes</span>(<span class="dt">x=</span>treatment, <span class="dt">ymin=</span>asymp.LCL, <span class="dt">ymax=</span>asymp.UCL, <span class="dt">group=</span>strain),</span>
<span id="cb165-19"><a href="4-3-working-in-r.html#cb165-19"></a>                <span class="dt">position=</span>pd, <span class="dt">width=</span><span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb165-20"><a href="4-3-working-in-r.html#cb165-20"></a><span class="st">  </span><span class="ot">NULL</span></span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-105-1.png" width="576" /></p>
</div>
<div id="interaction-plot" class="section level3">
<h3><span class="header-section-number">4.3.7</span> Interaction plot</h3>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="4-3-working-in-r.html#cb166-1"></a><span class="co">#pairs_i &lt;- list(c(&quot;sox10&quot;, &quot;iap_mo&quot;), c(&quot;sox10&quot;, &quot;gf&quot;), c(&quot;sox10&quot;, &quot;wt&quot;))</span></span>
<span id="cb166-2"><a href="4-3-working-in-r.html#cb166-2"></a>pd =<span class="st"> </span><span class="kw">position_dodge</span>(<span class="fl">0.2</span>)</span>
<span id="cb166-3"><a href="4-3-working-in-r.html#cb166-3"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>m1.emm, <span class="kw">aes</span>(<span class="dt">x=</span>treatment, <span class="dt">y=</span>count, <span class="dt">shape=</span>strain, <span class="dt">color=</span>strain, <span class="dt">group=</span>strain)) <span class="op">+</span></span>
<span id="cb166-4"><a href="4-3-working-in-r.html#cb166-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position=</span>pd, <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb166-5"><a href="4-3-working-in-r.html#cb166-5"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data=</span>m1.emm, <span class="kw">aes</span>(<span class="dt">x=</span>treatment, <span class="dt">ymin=</span>asymp.LCL, <span class="dt">ymax=</span>asymp.UCL, <span class="dt">group=</span>strain),<span class="dt">position=</span>pd, <span class="dt">width=</span><span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb166-6"><a href="4-3-working-in-r.html#cb166-6"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">position=</span>pd) <span class="op">+</span></span>
<span id="cb166-7"><a href="4-3-working-in-r.html#cb166-7"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Neutrophil count&quot;</span>) <span class="op">+</span></span>
<span id="cb166-8"><a href="4-3-working-in-r.html#cb166-8"></a><span class="st">  </span><span class="kw">scale_color_jco</span>() <span class="op">+</span></span>
<span id="cb166-9"><a href="4-3-working-in-r.html#cb166-9"></a><span class="st">  </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb166-10"><a href="4-3-working-in-r.html#cb166-10"></a><span class="st">  </span><span class="ot">NULL</span></span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-106-1.png" width="576" /></p>
</div>
<div id="plot-components" class="section level3">
<h3><span class="header-section-number">4.3.8</span> Plot components</h3>
<div id="showing-the-data" class="section level4">
<h4><span class="header-section-number">4.3.8.1</span> Showing the data</h4>
<p>If there are only a few cases per group, there is little reason to summarize the distribution. Instead plot the individual points using a stripchart or a jitter plot</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="4-3-working-in-r.html#cb167-1"></a><span class="co"># sample 4 points from each group to make it a small n experiment</span></span>
<span id="cb167-2"><a href="4-3-working-in-r.html#cb167-2"></a>inc &lt;-<span class="st"> </span>exp2d[, .(<span class="dt">inc=</span><span class="kw">sample</span>(<span class="kw">min</span>(.I)<span class="op">:</span><span class="kw">max</span>(.I), <span class="dv">4</span>)), by=donor][, inc]</span>
<span id="cb167-3"><a href="4-3-working-in-r.html#cb167-3"></a><span class="kw">ggstripchart</span>(<span class="dt">x =</span> <span class="st">&quot;donor&quot;</span>,</span>
<span id="cb167-4"><a href="4-3-working-in-r.html#cb167-4"></a>             <span class="dt">y =</span> <span class="st">&quot;count&quot;</span>,</span>
<span id="cb167-5"><a href="4-3-working-in-r.html#cb167-5"></a>             <span class="dt">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb167-6"><a href="4-3-working-in-r.html#cb167-6"></a>             <span class="dt">add =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb167-7"><a href="4-3-working-in-r.html#cb167-7"></a>             <span class="dt">data =</span> exp2d[inc,])</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-107-1.png" width="576" /></p>
<p>With more points, a stripchart can be okay but with too many points the distribution might be obscured. Reasonable alternatives are a box plot, a violin plot, and a dotplot.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="4-3-working-in-r.html#cb168-1"></a>gg1 &lt;-<span class="st"> </span><span class="kw">ggstripchart</span>(<span class="dt">x =</span> <span class="st">&quot;donor&quot;</span>,</span>
<span id="cb168-2"><a href="4-3-working-in-r.html#cb168-2"></a>          <span class="dt">y =</span> <span class="st">&quot;count&quot;</span>,</span>
<span id="cb168-3"><a href="4-3-working-in-r.html#cb168-3"></a>          <span class="dt">fill=</span><span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb168-4"><a href="4-3-working-in-r.html#cb168-4"></a>          <span class="dt">data =</span> exp2d)</span>
<span id="cb168-5"><a href="4-3-working-in-r.html#cb168-5"></a>gg2 &lt;-<span class="st"> </span><span class="kw">ggboxplot</span>(<span class="dt">x =</span> <span class="st">&quot;donor&quot;</span>,</span>
<span id="cb168-6"><a href="4-3-working-in-r.html#cb168-6"></a>          <span class="dt">y =</span> <span class="st">&quot;count&quot;</span>,</span>
<span id="cb168-7"><a href="4-3-working-in-r.html#cb168-7"></a>          <span class="dt">fill=</span><span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb168-8"><a href="4-3-working-in-r.html#cb168-8"></a>          <span class="dt">data =</span> exp2d)</span>
<span id="cb168-9"><a href="4-3-working-in-r.html#cb168-9"></a>gg3 &lt;-<span class="st"> </span><span class="kw">ggviolin</span>(<span class="dt">x =</span> <span class="st">&quot;donor&quot;</span>,</span>
<span id="cb168-10"><a href="4-3-working-in-r.html#cb168-10"></a>          <span class="dt">y =</span> <span class="st">&quot;count&quot;</span>,</span>
<span id="cb168-11"><a href="4-3-working-in-r.html#cb168-11"></a>          <span class="dt">fill=</span><span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb168-12"><a href="4-3-working-in-r.html#cb168-12"></a>          <span class="dt">data =</span> exp2d)</span>
<span id="cb168-13"><a href="4-3-working-in-r.html#cb168-13"></a>gg4 &lt;-<span class="st"> </span><span class="kw">ggdotplot</span>(<span class="dt">x =</span> <span class="st">&quot;donor&quot;</span>,</span>
<span id="cb168-14"><a href="4-3-working-in-r.html#cb168-14"></a>          <span class="dt">y =</span> <span class="st">&quot;count&quot;</span>,</span>
<span id="cb168-15"><a href="4-3-working-in-r.html#cb168-15"></a>          <span class="dt">fill=</span><span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb168-16"><a href="4-3-working-in-r.html#cb168-16"></a>          <span class="dt">data =</span> exp2d)</span>
<span id="cb168-17"><a href="4-3-working-in-r.html#cb168-17"></a><span class="kw">plot_grid</span>(gg1, gg2, gg3, gg4, <span class="dt">nrow=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-108-1.png" width="576" /></p>

</div>
</div>
</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="4-2-some-comments-on-plot-components.html"><button class="btn btn-default">Previous</button></a>
<a href="part-iv-some-fundamentals-of-statistical-modeling.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
