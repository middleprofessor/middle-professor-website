<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Linear models with a single, categorical X | Elements of Statistical Modeling for Experimental Biology</title>
  <meta name="description" content="A first course in statistical modeling for experimental biology researchers" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Linear models with a single, categorical X | Elements of Statistical Modeling for Experimental Biology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A first course in statistical modeling for experimental biology researchers" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Linear models with a single, categorical X | Elements of Statistical Modeling for Experimental Biology" />
  
  <meta name="twitter:description" content="A first course in statistical modeling for experimental biology researchers" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-models-with-a-single-continuous-x.html"/>
<link rel="next" href="model-checking.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#math"><i class="fa fa-check"></i><b>0.1</b> Math</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#r-and-programming"><i class="fa fa-check"></i><b>0.2</b> R and programming</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-getting-started.html"><a href="part-i-getting-started.html"><i class="fa fa-check"></i>Part I: Getting Started</a></li>
<li class="chapter" data-level="1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html"><i class="fa fa-check"></i><b>1</b> Getting Started – R Projects and R Markdown</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-vs-r-studio"><i class="fa fa-check"></i><b>1.1</b> R vs R Studio</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#download-and-install-r-and-r-studio"><i class="fa fa-check"></i><b>1.2</b> Download and install R and R studio</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#install-r-markdown"><i class="fa fa-check"></i><b>1.3</b> Install R Markdown</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#importing-packages"><i class="fa fa-check"></i><b>1.4</b> Importing Packages</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-an-r-studio-project-for-this-textbook"><i class="fa fa-check"></i><b>1.5</b> Create an R Studio Project for this textbook</a><ul>
<li class="chapter" data-level="1.5.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-an-r-markdown-file-for-this-chapter"><i class="fa fa-check"></i><b>1.5.1</b> Create an R Markdown file for this Chapter</a></li>
<li class="chapter" data-level="1.5.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-fake-data-chunk"><i class="fa fa-check"></i><b>1.5.2</b> Create a “fake-data” chunk</a></li>
<li class="chapter" data-level="1.5.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-plot-chunk"><i class="fa fa-check"></i><b>1.5.3</b> Create a “plot” chunk</a></li>
<li class="chapter" data-level="1.5.4" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#knit"><i class="fa fa-check"></i><b>1.5.4</b> Knit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-an-introduction-to-the-analysis-of-experimental-data-with-a-linear-model.html"><a href="part-ii-an-introduction-to-the-analysis-of-experimental-data-with-a-linear-model.html"><i class="fa fa-check"></i>Part II: An introduction to the analysis of experimental data with a linear model</a></li>
<li class="chapter" data-level="2" data-path="analyzing-experimental-data-with-a-linear-model.html"><a href="analyzing-experimental-data-with-a-linear-model.html"><i class="fa fa-check"></i><b>2</b> Analyzing experimental data with a linear model</a><ul>
<li class="chapter" data-level="2.1" data-path="analyzing-experimental-data-with-a-linear-model.html"><a href="analyzing-experimental-data-with-a-linear-model.html#this-text-is-about-the-estimation-of-treatment-effects-and-the-uncertainty-in-our-estimates-using-linear-models.-this-raises-the-question-what-is-an-effect"><i class="fa fa-check"></i><b>2.1</b> This text is about the estimation of treatment effects and the uncertainty in our estimates using linear models. This, raises the question, what is “an effect”?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="background-physiology-to-the-experiments-in-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="background-physiology-to-the-experiments-in-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><i class="fa fa-check"></i>Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li class="chapter" data-level="" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><i class="fa fa-check"></i>Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a><ul>
<li class="chapter" data-level="2.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#setup"><i class="fa fa-check"></i><b>2.2</b> Setup</a></li>
<li class="chapter" data-level="2.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#data-source"><i class="fa fa-check"></i><b>2.3</b> Data source</a></li>
<li class="chapter" data-level="2.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#control-the-color-palette"><i class="fa fa-check"></i><b>2.4</b> control the color palette</a></li>
<li class="chapter" data-level="2.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#useful-functions"><i class="fa fa-check"></i><b>2.5</b> useful functions</a></li>
<li class="chapter" data-level="2.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2b-effect-of-ask1-deletion-on-growth-body-weight"><i class="fa fa-check"></i><b>2.6</b> figure 2b – effect of ASK1 deletion on growth (body weight)</a><ul>
<li class="chapter" data-level="2.6.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2b-import"><i class="fa fa-check"></i><b>2.6.1</b> figure 2b – import</a></li>
<li class="chapter" data-level="2.6.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2b-exploratory-plots"><i class="fa fa-check"></i><b>2.6.2</b> figure 2b – exploratory plots</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-effect-of-ask1-deletion-on-final-body-weight"><i class="fa fa-check"></i><b>2.7</b> Figure 2c – Effect of ASK1 deletion on final body weight</a><ul>
<li class="chapter" data-level="2.7.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-import"><i class="fa fa-check"></i><b>2.7.1</b> Figure 2c – import</a></li>
<li class="chapter" data-level="2.7.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-check-own-computation-of-weight-change-v-imported-value"><i class="fa fa-check"></i><b>2.7.2</b> Figure 2c – check own computation of weight change v imported value</a></li>
<li class="chapter" data-level="2.7.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-exploratory-plots"><i class="fa fa-check"></i><b>2.7.3</b> Figure 2c – exploratory plots</a></li>
<li class="chapter" data-level="2.7.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-fit-the-model-m1-lm"><i class="fa fa-check"></i><b>2.7.4</b> Figure 2c – fit the model: m1 (lm)</a></li>
<li class="chapter" data-level="2.7.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-check-the-model-m1"><i class="fa fa-check"></i><b>2.7.5</b> Figure 2c – check the model: m1</a></li>
<li class="chapter" data-level="2.7.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-fit-the-model-m2-gamma-glm"><i class="fa fa-check"></i><b>2.7.6</b> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li class="chapter" data-level="2.7.7" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-check-the-model-m2"><i class="fa fa-check"></i><b>2.7.7</b> Figure 2c – check the model, m2</a></li>
<li class="chapter" data-level="2.7.8" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-inference-from-the-model"><i class="fa fa-check"></i><b>2.7.8</b> Figure 2c – inference from the model</a></li>
<li class="chapter" data-level="2.7.9" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-plot-the-model"><i class="fa fa-check"></i><b>2.7.9</b> Figure 2c – plot the model</a></li>
<li class="chapter" data-level="2.7.10" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-report"><i class="fa fa-check"></i><b>2.7.10</b> Figure 2c – report</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><i class="fa fa-check"></i><b>2.8</b> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a><ul>
<li class="chapter" data-level="2.8.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-import"><i class="fa fa-check"></i><b>2.8.1</b> Figure 2d – Import</a></li>
<li class="chapter" data-level="2.8.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-exploratory-plots"><i class="fa fa-check"></i><b>2.8.2</b> Figure 2d – exploratory plots</a></li>
<li class="chapter" data-level="2.8.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-fit-the-model"><i class="fa fa-check"></i><b>2.8.3</b> Figure 2d – fit the model</a></li>
<li class="chapter" data-level="2.8.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-check-the-model"><i class="fa fa-check"></i><b>2.8.4</b> Figure 2d – check the model</a></li>
<li class="chapter" data-level="2.8.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-inference"><i class="fa fa-check"></i><b>2.8.5</b> Figure 2d – inference</a></li>
<li class="chapter" data-level="2.8.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-plot-the-model"><i class="fa fa-check"></i><b>2.8.6</b> Figure 2d – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure"><i class="fa fa-check"></i><b>2.9</b> Figure 2e – Effect of ASK1 deletion on glucose tolerance (summary measure)</a><ul>
<li class="chapter" data-level="2.9.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-message-the-data"><i class="fa fa-check"></i><b>2.9.1</b> Figure 2e – message the data</a></li>
<li class="chapter" data-level="2.9.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-exploratory-plots"><i class="fa fa-check"></i><b>2.9.2</b> Figure 2e – exploratory plots</a></li>
<li class="chapter" data-level="2.9.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-fit-the-model"><i class="fa fa-check"></i><b>2.9.3</b> Figure 2e – fit the model</a></li>
<li class="chapter" data-level="2.9.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-check-the-model"><i class="fa fa-check"></i><b>2.9.4</b> Figure 2e – check the model</a></li>
<li class="chapter" data-level="2.9.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-inference-from-the-model"><i class="fa fa-check"></i><b>2.9.5</b> Figure 2e – inference from the model</a></li>
<li class="chapter" data-level="2.9.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-plot-the-model"><i class="fa fa-check"></i><b>2.9.6</b> Figure 2e – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate"><i class="fa fa-check"></i><b>2.10</b> Figure 2f – Effect of ASK1 deletion on glucose infusion rate</a><ul>
<li class="chapter" data-level="2.10.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-import"><i class="fa fa-check"></i><b>2.10.1</b> Figure 2f – import</a></li>
<li class="chapter" data-level="2.10.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-exploratory-plots"><i class="fa fa-check"></i><b>2.10.2</b> Figure 2f – exploratory plots</a></li>
<li class="chapter" data-level="2.10.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-fit-the-model"><i class="fa fa-check"></i><b>2.10.3</b> Figure 2f – fit the model</a></li>
<li class="chapter" data-level="2.10.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-check-the-model"><i class="fa fa-check"></i><b>2.10.4</b> Figure 2f – check the model</a></li>
<li class="chapter" data-level="2.10.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-inference"><i class="fa fa-check"></i><b>2.10.5</b> Figure 2f – inference</a></li>
<li class="chapter" data-level="2.10.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-plot-the-model"><i class="fa fa-check"></i><b>2.10.6</b> Figure 2f – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake"><i class="fa fa-check"></i><b>2.11</b> Figure 2g – Effect of ASK1 deletion on tissue-specific glucose uptake</a><ul>
<li class="chapter" data-level="2.11.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-import"><i class="fa fa-check"></i><b>2.11.1</b> Figure 2g – import</a></li>
<li class="chapter" data-level="2.11.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-exploratory-plots"><i class="fa fa-check"></i><b>2.11.2</b> Figure 2g – exploratory plots</a></li>
<li class="chapter" data-level="2.11.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-fit-the-model"><i class="fa fa-check"></i><b>2.11.3</b> Figure 2g – fit the model</a></li>
<li class="chapter" data-level="2.11.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-check-the-model"><i class="fa fa-check"></i><b>2.11.4</b> Figure 2g – check the model</a></li>
<li class="chapter" data-level="2.11.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-inference"><i class="fa fa-check"></i><b>2.11.5</b> Figure 2g – inference</a></li>
<li class="chapter" data-level="2.11.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-plot-the-model"><i class="fa fa-check"></i><b>2.11.6</b> Figure 2g – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2h"><i class="fa fa-check"></i><b>2.12</b> Figure 2h</a></li>
<li class="chapter" data-level="2.13" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-effect-of-ask1-deletion-on-liver-tg"><i class="fa fa-check"></i><b>2.13</b> Figure 2i – Effect of ASK1 deletion on liver TG</a><ul>
<li class="chapter" data-level="2.13.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-fit-the-model"><i class="fa fa-check"></i><b>2.13.1</b> Figure 2i – fit the model</a></li>
<li class="chapter" data-level="2.13.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-check-the-model"><i class="fa fa-check"></i><b>2.13.2</b> Figure 2i – check the model</a></li>
<li class="chapter" data-level="2.13.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-inference"><i class="fa fa-check"></i><b>2.13.3</b> Figure 2i – inference</a></li>
<li class="chapter" data-level="2.13.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-plot-the-model"><i class="fa fa-check"></i><b>2.13.4</b> Figure 2i – plot the model</a></li>
<li class="chapter" data-level="2.13.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-report-the-model"><i class="fa fa-check"></i><b>2.13.5</b> Figure 2i – report the model</a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2j"><i class="fa fa-check"></i><b>2.14</b> Figure 2j</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-r-fundamentals.html"><a href="part-iii-r-fundamentals.html"><i class="fa fa-check"></i>Part III: R fundamentals</a></li>
<li class="chapter" data-level="3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html"><i class="fa fa-check"></i><b>3</b> Data – Reading, Wrangling, and Writing</a><ul>
<li class="chapter" data-level="3.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#learning-from-this-chapter"><i class="fa fa-check"></i><b>3.1</b> Learning from this chapter</a></li>
<li class="chapter" data-level="3.2" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#data-working-in-r"><i class="fa fa-check"></i><b>3.2</b> Working in R</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#importing-data"><i class="fa fa-check"></i><b>3.2.1</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#data-wrangling"><i class="fa fa-check"></i><b>3.3</b> Data wrangling</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#reshaping-data-wide-to-long"><i class="fa fa-check"></i><b>3.3.1</b> Reshaping data – Wide to long</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#reshaping-data-transpose-turning-the-columns-into-rows"><i class="fa fa-check"></i><b>3.3.2</b> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#combining-data"><i class="fa fa-check"></i><b>3.3.3</b> Combining data</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#subsetting-data"><i class="fa fa-check"></i><b>3.3.4</b> Subsetting data</a></li>
<li class="chapter" data-level="3.3.5" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#wrangling-columns"><i class="fa fa-check"></i><b>3.3.5</b> Wrangling columns</a></li>
<li class="chapter" data-level="3.3.6" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#missing-data"><i class="fa fa-check"></i><b>3.3.6</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#saving-data"><i class="fa fa-check"></i><b>3.4</b> Saving data</a></li>
<li class="chapter" data-level="3.5" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#exercises"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting-models.html"><a href="plotting-models.html"><i class="fa fa-check"></i><b>4</b> Plotting Models</a><ul>
<li class="chapter" data-level="4.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data"><i class="fa fa-check"></i><b>4.1</b> Pretty good plots show the model and the data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot"><i class="fa fa-check"></i><b>4.1.1</b> Pretty good plot component 1: Modeled effects plot</a></li>
<li class="chapter" data-level="4.1.2" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot"><i class="fa fa-check"></i><b>4.1.2</b> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li class="chapter" data-level="4.1.3" data-path="plotting-models.html"><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><i class="fa fa-check"></i><b>4.1.3</b> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="plotting-models.html"><a href="plotting-models.html#some-comments-on-plot-components"><i class="fa fa-check"></i><b>4.2</b> Some comments on plot components</a></li>
<li class="chapter" data-level="4.3" data-path="plotting-models.html"><a href="plotting-models.html#working-in-r"><i class="fa fa-check"></i><b>4.3</b> Working in R</a><ul>
<li class="chapter" data-level="4.3.1" data-path="plotting-models.html"><a href="plotting-models.html#unpooled-se-bars-and-confidence-intervals"><i class="fa fa-check"></i><b>4.3.1</b> Unpooled SE bars and confidence intervals</a></li>
<li class="chapter" data-level="4.3.2" data-path="plotting-models.html"><a href="plotting-models.html#adding-bootstrap-intervals"><i class="fa fa-check"></i><b>4.3.2</b> Adding bootstrap intervals</a></li>
<li class="chapter" data-level="4.3.3" data-path="plotting-models.html"><a href="plotting-models.html#adding-modeled-means-and-error-intervals"><i class="fa fa-check"></i><b>4.3.3</b> Adding modeled means and error intervals</a></li>
<li class="chapter" data-level="4.3.4" data-path="plotting-models.html"><a href="plotting-models.html#adding-p-values"><i class="fa fa-check"></i><b>4.3.4</b> Adding p-values</a></li>
<li class="chapter" data-level="4.3.5" data-path="plotting-models.html"><a href="plotting-models.html#adding-custom-p-values"><i class="fa fa-check"></i><b>4.3.5</b> Adding custom p-values</a></li>
<li class="chapter" data-level="4.3.6" data-path="plotting-models.html"><a href="plotting-models.html#plotting-two-factors"><i class="fa fa-check"></i><b>4.3.6</b> Plotting two factors</a></li>
<li class="chapter" data-level="4.3.7" data-path="plotting-models.html"><a href="plotting-models.html#interaction-plot"><i class="fa fa-check"></i><b>4.3.7</b> Interaction plot</a></li>
<li class="chapter" data-level="4.3.8" data-path="plotting-models.html"><a href="plotting-models.html#plot-components"><i class="fa fa-check"></i><b>4.3.8</b> Plot components</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iv-some-fundamentals-of-statistical-modeling.html"><a href="part-iv-some-fundamentals-of-statistical-modeling.html"><i class="fa fa-check"></i>Part IV: Some Fundamentals of Statistical Modeling</a></li>
<li class="chapter" data-level="5" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><i class="fa fa-check"></i><b>5</b> Variability and Uncertainty (Standard Deviations, Standard Errors, Confidence Intervals)</a><ul>
<li class="chapter" data-level="5.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#the-sample-standard-deviation-vs.-the-standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.1</b> The sample standard deviation vs. the standard error of the mean</a><ul>
<li class="chapter" data-level="5.1.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#sample-standard-deviation"><i class="fa fa-check"></i><b>5.1.1</b> Sample standard deviation</a></li>
<li class="chapter" data-level="5.1.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.2</b> Using Google Sheets to generate fake data to explore the standard error</a><ul>
<li class="chapter" data-level="5.2.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#steps"><i class="fa fa-check"></i><b>5.2.1</b> Steps</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#using-r-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.3</b> Using R to generate fake data to explore the standard error</a><ul>
<li class="chapter" data-level="5.3.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-i"><i class="fa fa-check"></i><b>5.3.1</b> part I</a></li>
<li class="chapter" data-level="5.3.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-ii---means"><i class="fa fa-check"></i><b>5.3.2</b> part II - means</a></li>
<li class="chapter" data-level="5.3.3" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-iii---how-do-sd-and-se-change-as-sample-size-n-increases"><i class="fa fa-check"></i><b>5.3.3</b> part III - how do SD and SE change as sample size (n) increases?</a></li>
<li class="chapter" data-level="5.3.4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-iv-generating-fake-data-with-for-loops"><i class="fa fa-check"></i><b>5.3.4</b> Part IV – Generating fake data with for-loops</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#bootstrap"><i class="fa fa-check"></i><b>5.4</b> Bootstrapped standard errors</a><ul>
<li class="chapter" data-level="5.4.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#an-example-of-bootstrapped-standard-errors-using-vole-data"><i class="fa fa-check"></i><b>5.4.1</b> An example of bootstrapped standard errors using vole data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#confidence-interval"><i class="fa fa-check"></i><b>5.5</b> Confidence Interval</a><ul>
<li class="chapter" data-level="5.5.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#interpretation-of-a-confidence-interval"><i class="fa fa-check"></i><b>5.5.1</b> Interpretation of a confidence interval</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="p-values.html"><a href="p-values.html"><i class="fa fa-check"></i><b>6</b> P-values</a><ul>
<li class="chapter" data-level="6.1" data-path="p-values.html"><a href="p-values.html#a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution"><i class="fa fa-check"></i><b>6.1</b> A <em>p</em>-value is the probability of sampling a value as or more extreme than the test statistic if sampling from a null distribution</a></li>
<li class="chapter" data-level="6.2" data-path="p-values.html"><a href="p-values.html#pump-your-intuition-creating-a-null-distribution"><i class="fa fa-check"></i><b>6.2</b> Pump your intuition – Creating a null distribution</a></li>
<li class="chapter" data-level="6.3" data-path="p-values.html"><a href="p-values.html#a-null-distribution-of-t-values-the-t-distribution"><i class="fa fa-check"></i><b>6.3</b> A null distribution of <em>t</em>-values – the <em>t</em> distribution</a></li>
<li class="chapter" data-level="6.4" data-path="p-values.html"><a href="p-values.html#p-values-from-the-perspective-of-permutation"><i class="fa fa-check"></i><b>6.4</b> P-values from the perspective of permutation</a></li>
<li class="chapter" data-level="6.5" data-path="p-values.html"><a href="p-values.html#parametric-vs.-non-parametric-statistics"><i class="fa fa-check"></i><b>6.5</b> Parametric vs. non-parametric statistics</a></li>
<li class="chapter" data-level="6.6" data-path="p-values.html"><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values"><i class="fa fa-check"></i><b>6.6</b> frequentist probability and the interpretation of p-values</a><ul>
<li class="chapter" data-level="6.6.1" data-path="p-values.html"><a href="p-values.html#background"><i class="fa fa-check"></i><b>6.6.1</b> Background</a></li>
<li class="chapter" data-level="6.6.2" data-path="p-values.html"><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><i class="fa fa-check"></i><b>6.6.2</b> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li class="chapter" data-level="6.6.3" data-path="p-values.html"><a href="p-values.html#two-interpretations-of-the-p-value"><i class="fa fa-check"></i><b>6.6.3</b> Two interpretations of the <em>p</em>-value</a></li>
<li class="chapter" data-level="6.6.4" data-path="p-values.html"><a href="p-values.html#nhst"><i class="fa fa-check"></i><b>6.6.4</b> NHST</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="p-values.html"><a href="p-values.html#some-major-misconceptions-of-the-p-value"><i class="fa fa-check"></i><b>6.7</b> Some major misconceptions of the <em>p</em>-value</a><ul>
<li class="chapter" data-level="6.7.1" data-path="p-values.html"><a href="p-values.html#misconception-p-is-the-probability-that-the-null-is-true-and-1-p-is-probability-that-the-alternative-is-true"><i class="fa fa-check"></i><b>6.7.1</b> Misconception: <em>p</em> is the probability that the null is true <em>and</em> <span class="math inline">\(1-p\)</span> is probability that the alternative is true</a></li>
<li class="chapter" data-level="6.7.2" data-path="p-values.html"><a href="p-values.html#misconception-a-p-value-is-repeatable"><i class="fa fa-check"></i><b>6.7.2</b> Misconception: a <em>p</em>-value is repeatable</a></li>
<li class="chapter" data-level="6.7.3" data-path="p-values.html"><a href="p-values.html#misconception-0.05-is-the-lifetime-rate-of-false-discoveries"><i class="fa fa-check"></i><b>6.7.3</b> Misconception: 0.05 is the lifetime rate of false discoveries</a></li>
<li class="chapter" data-level="6.7.4" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-an-important-effect"><i class="fa fa-check"></i><b>6.7.4</b> Misconception: a low <em>p</em>-value indicates an important effect</a></li>
<li class="chapter" data-level="6.7.5" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity"><i class="fa fa-check"></i><b>6.7.5</b> Misconception: a low <em>p</em>-value indicates high model fit or high predictive capacity</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="p-values.html"><a href="p-values.html#what-the-p-value-does-not-mean"><i class="fa fa-check"></i><b>6.8</b> What the <em>p</em>-value does not mean</a></li>
<li class="chapter" data-level="6.9" data-path="p-values.html"><a href="p-values.html#recommendations"><i class="fa fa-check"></i><b>6.9</b> Recommendations</a><ul>
<li class="chapter" data-level="6.9.1" data-path="p-values.html"><a href="p-values.html#primary-sources-for-recommendations"><i class="fa fa-check"></i><b>6.9.1</b> Primary sources for recommendations</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="p-values.html"><a href="p-values.html#problems"><i class="fa fa-check"></i><b>6.10</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="errors-in-inference.html"><a href="errors-in-inference.html"><i class="fa fa-check"></i><b>7</b> Errors in inference</a><ul>
<li class="chapter" data-level="7.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#classical-nhst-concepts-of-wrong"><i class="fa fa-check"></i><b>7.1</b> Classical NHST concepts of wrong</a><ul>
<li class="chapter" data-level="7.1.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-i-error"><i class="fa fa-check"></i><b>7.1.1</b> Type I error</a></li>
<li class="chapter" data-level="7.1.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#power"><i class="fa fa-check"></i><b>7.1.2</b> Power</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#a-non-neyman-pearson-concept-of-power"><i class="fa fa-check"></i><b>7.2</b> A non-Neyman-Pearson concept of power</a><ul>
<li class="chapter" data-level="7.2.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#estimation-error"><i class="fa fa-check"></i><b>7.2.1</b> Estimation error</a></li>
<li class="chapter" data-level="7.2.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#coverage"><i class="fa fa-check"></i><b>7.2.2</b> Coverage</a></li>
<li class="chapter" data-level="7.2.3" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-s-error"><i class="fa fa-check"></i><b>7.2.3</b> Type S error</a></li>
<li class="chapter" data-level="7.2.4" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-m-error"><i class="fa fa-check"></i><b>7.2.4</b> Type M error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-introduction-to-linear-models.html"><a href="part-v-introduction-to-linear-models.html"><i class="fa fa-check"></i>Part V: Introduction to Linear Models</a></li>
<li class="chapter" data-level="8" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html"><i class="fa fa-check"></i><b>8</b> An introduction to linear models</a><ul>
<li class="chapter" data-level="8.1" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#two-specifications-of-a-linear-model"><i class="fa fa-check"></i><b>8.1</b> Two specifications of a linear model</a><ul>
<li class="chapter" data-level="8.1.1" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#the-error-draw-specification"><i class="fa fa-check"></i><b>8.1.1</b> The “error draw” specification</a></li>
<li class="chapter" data-level="8.1.2" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#the-conditional-draw-specification"><i class="fa fa-check"></i><b>8.1.2</b> The “conditional draw” specification</a></li>
<li class="chapter" data-level="8.1.3" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#comparing-the-two-ways-of-specifying-the-linear-model"><i class="fa fa-check"></i><b>8.1.3</b> Comparing the two ways of specifying the linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"><i class="fa fa-check"></i><b>8.2</b> A linear model can be fit to data with continuous, discrete, or categorical <span class="math inline">\(X\)</span> variables</a><ul>
<li class="chapter" data-level="8.2.1" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete"><i class="fa fa-check"></i><b>8.2.1</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is continuous or discrete</a></li>
<li class="chapter" data-level="8.2.2" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-categorical"><i class="fa fa-check"></i><b>8.2.2</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is categorical</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#statistical-models-are-used-for-prediction-explanation-and-description"><i class="fa fa-check"></i><b>8.3</b> Statistical models are used for prediction, explanation, and description</a></li>
<li class="chapter" data-level="8.4" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#what-do-we-call-the-x-and-y-variables"><i class="fa fa-check"></i><b>8.4</b> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li class="chapter" data-level="8.5" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#modeling-strategy"><i class="fa fa-check"></i><b>8.5</b> Modeling strategy</a></li>
<li class="chapter" data-level="8.6" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#predictions-from-the-model"><i class="fa fa-check"></i><b>8.6</b> Predictions from the model</a></li>
<li class="chapter" data-level="8.7" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#inference-from-the-model"><i class="fa fa-check"></i><b>8.7</b> Inference from the model</a><ul>
<li class="chapter" data-level="8.7.1" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#assumptions-for-inference-with-a-statistical-model"><i class="fa fa-check"></i><b>8.7.1</b> Assumptions for inference with a statistical model</a></li>
<li class="chapter" data-level="8.7.2" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#specific-assumptions-for-inference-with-a-linear-model"><i class="fa fa-check"></i><b>8.7.2</b> Specific assumptions for inference with a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#linear-modelregression-model-orstatistical-model"><i class="fa fa-check"></i><b>8.8</b> “linear model,”regression model“, or”statistical model"?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html"><i class="fa fa-check"></i><b>9</b> Linear models with a single, continuous <em>X</em></a><ul>
<li class="chapter" data-level="9.1" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><i class="fa fa-check"></i><b>9.1</b> A linear model with a single, continuous <em>X</em> is classical “regression”</a><ul>
<li class="chapter" data-level="9.1.1" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#analysis-of-green-down-data"><i class="fa fa-check"></i><b>9.1.1</b> Analysis of “green-down” data</a></li>
<li class="chapter" data-level="9.1.2" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#learning-from-the-green-down-example"><i class="fa fa-check"></i><b>9.1.2</b> Learning from the green-down example</a></li>
<li class="chapter" data-level="9.1.3" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#using-a-regression-model-for-explanation-causal-models"><i class="fa fa-check"></i><b>9.1.3</b> Using a regression model for “explanation” – causal models</a></li>
<li class="chapter" data-level="9.1.4" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#using-a-regression-model-for-prediction-prediction-models"><i class="fa fa-check"></i><b>9.1.4</b> Using a regression model for prediction – prediction models</a></li>
<li class="chapter" data-level="9.1.5" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data"><i class="fa fa-check"></i><b>9.1.5</b> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</a></li>
<li class="chapter" data-level="9.1.6" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#using-a-regression-model-for-for-calibration"><i class="fa fa-check"></i><b>9.1.6</b> Using a regression model for for calibration</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#working-in-r-1"><i class="fa fa-check"></i><b>9.2</b> Working in R</a><ul>
<li class="chapter" data-level="9.2.1" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#fitting-the-linear-model"><i class="fa fa-check"></i><b>9.2.1</b> Fitting the linear model</a></li>
<li class="chapter" data-level="9.2.2" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#getting-to-know-the-linear-model-the-summary-function"><i class="fa fa-check"></i><b>9.2.2</b> Getting to know the linear model: the <code>summary</code> function</a></li>
<li class="chapter" data-level="9.2.3" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#inference-the-coefficient-table-and-confidence-intervals"><i class="fa fa-check"></i><b>9.2.3</b> Inference – the coefficient table and Confidence intervals</a></li>
<li class="chapter" data-level="9.2.4" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#how-good-is-our-model-model-checking"><i class="fa fa-check"></i><b>9.2.4</b> How good is our model? – Model checking</a></li>
<li class="chapter" data-level="9.2.5" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#plotting-models-with-continuous-x"><i class="fa fa-check"></i><b>9.2.5</b> Plotting models with continuous <em>X</em></a></li>
<li class="chapter" data-level="9.2.6" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#creating-a-table-of-predicted-values-and-95-prediction-intervals"><i class="fa fa-check"></i><b>9.2.6</b> Creating a table of predicted values and 95% prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#hidden-code"><i class="fa fa-check"></i><b>9.3</b> Hidden code</a><ul>
<li class="chapter" data-level="9.3.1" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#import-and-plot-of-fig2c-ecosystem-warming-experimental-data"><i class="fa fa-check"></i><b>9.3.1</b> Import and plot of fig2c (ecosystem warming experimental) data</a></li>
<li class="chapter" data-level="9.3.2" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#import-and-plot-efig_3d-ecosysem-warming-observational-data"><i class="fa fa-check"></i><b>9.3.2</b> Import and plot efig_3d (Ecosysem warming observational) data</a></li>
<li class="chapter" data-level="9.3.3" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#import-and-plot-of-fig1f-methionine-restriction-data"><i class="fa fa-check"></i><b>9.3.3</b> Import and plot of fig1f (methionine restriction) data</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#try-it"><i class="fa fa-check"></i><b>9.4</b> Try it</a><ul>
<li class="chapter" data-level="9.4.1" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#a-prediction-model-from-the-literature"><i class="fa fa-check"></i><b>9.4.1</b> A prediction model from the literature</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#intuition-pumps"><i class="fa fa-check"></i><b>9.5</b> Intuition pumps</a><ul>
<li class="chapter" data-level="9.5.1" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#correlation-and-r2"><i class="fa fa-check"></i><b>9.5.1</b> Correlation and $R^2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html"><i class="fa fa-check"></i><b>10</b> Linear models with a single, categorical <em>X</em></a><ul>
<li class="chapter" data-level="10.1" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response."><i class="fa fa-check"></i><b>10.1</b> A linear model with a single, categorical <em>X</em> variable estimates the effects of the levels of <em>X</em> on the response.</a><ul>
<li class="chapter" data-level="10.1.1" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#example-1-two-treatment-levels-groups"><i class="fa fa-check"></i><b>10.1.1</b> Example 1 – two treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.2" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#understanding-the-analysis-with-two-treatment-levels"><i class="fa fa-check"></i><b>10.1.2</b> Understanding the analysis with two treatment levels</a></li>
<li class="chapter" data-level="10.1.3" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#example-2-three-treatment-levels-groups"><i class="fa fa-check"></i><b>10.1.3</b> Example 2 – three treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.4" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#understanding-the-analysis-with-three-or-more-treatment-levels"><i class="fa fa-check"></i><b>10.1.4</b> Understanding the analysis with three (or more) treatment levels</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#working-in-r-2"><i class="fa fa-check"></i><b>10.2</b> Working in R</a><ul>
<li class="chapter" data-level="10.2.1" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#specifying-the-contrasts"><i class="fa fa-check"></i><b>10.2.1</b> Specifying the contrasts</a></li>
<li class="chapter" data-level="10.2.2" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#adjustment-for-multiple-comparisons"><i class="fa fa-check"></i><b>10.2.2</b> Adjustment for multiple comparisons</a></li>
<li class="chapter" data-level="10.2.3" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#plotting-models-with-a-single-categorical-x"><i class="fa fa-check"></i><b>10.2.3</b> Plotting models with a single, categorical <span class="math inline">\(X\)</span></a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#issues-in-inference-in-models-with-a-single-categorical-x"><i class="fa fa-check"></i><b>10.3</b> Issues in inference in models with a single, categorical <span class="math inline">\(X\)</span></a><ul>
<li class="chapter" data-level="10.3.1" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#lack-of-independence"><i class="fa fa-check"></i><b>10.3.1</b> Lack of independence</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#heterogeneity-of-variances"><i class="fa fa-check"></i><b>10.3.2</b> Heterogeneity of variances</a></li>
<li class="chapter" data-level="10.3.3" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#the-conditional-response-isnt-normal"><i class="fa fa-check"></i><b>10.3.3</b> The conditional response isn’t Normal</a></li>
<li class="chapter" data-level="10.3.4" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#pre-post-designs"><i class="fa fa-check"></i><b>10.3.4</b> Pre-post designs</a></li>
<li class="chapter" data-level="10.3.5" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#longitudinal-designs"><i class="fa fa-check"></i><b>10.3.5</b> Longitudinal designs</a></li>
<li class="chapter" data-level="10.3.6" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#comparing-responses-normalized-to-a-standard"><i class="fa fa-check"></i><b>10.3.6</b> Comparing responses normalized to a standard</a></li>
<li class="chapter" data-level="10.3.7" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#comparing-responses-that-are-ratios"><i class="fa fa-check"></i><b>10.3.7</b> Comparing responses that are ratios</a></li>
<li class="chapter" data-level="10.3.8" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#researcher-degrees-of-freedom"><i class="fa fa-check"></i><b>10.3.8</b> Researcher degrees of freedom</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#hidden-code-1"><i class="fa fa-check"></i><b>10.4</b> Hidden Code</a><ul>
<li class="chapter" data-level="10.4.1" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#fig2a-data"><i class="fa fa-check"></i><b>10.4.1</b> fig2a data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>11</b> Model Checking</a><ul>
<li class="chapter" data-level="11.1" data-path="model-checking.html"><a href="model-checking.html#all-statistical-analyses-should-be-followed-by-model-checking"><i class="fa fa-check"></i><b>11.1</b> All statistical analyses should be followed by model checking</a></li>
<li class="chapter" data-level="11.2" data-path="model-checking.html"><a href="model-checking.html#linear-model-assumptions"><i class="fa fa-check"></i><b>11.2</b> Linear model assumptions</a><ul>
<li class="chapter" data-level="11.2.1" data-path="model-checking.html"><a href="model-checking.html#a-bit-about-iid"><i class="fa fa-check"></i><b>11.2.1</b> A bit about IID</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="model-checking.html"><a href="model-checking.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>11.3</b> Diagnostic plots use the residuals from the model fit</a><ul>
<li class="chapter" data-level="11.3.1" data-path="model-checking.html"><a href="model-checking.html#residuals"><i class="fa fa-check"></i><b>11.3.1</b> Residuals</a></li>
<li class="chapter" data-level="11.3.2" data-path="model-checking.html"><a href="model-checking.html#a-normal-q-q-plot-is-used-to-check-for-characteristic-departures-from-normality"><i class="fa fa-check"></i><b>11.3.2</b> A Normal Q-Q plot is used to check for characteristic departures from Normality</a></li>
<li class="chapter" data-level="11.3.3" data-path="model-checking.html"><a href="model-checking.html#mapping-qq-plot-departures-from-normality"><i class="fa fa-check"></i><b>11.3.3</b> Mapping QQ-plot departures from Normality</a></li>
<li class="chapter" data-level="11.3.4" data-path="model-checking.html"><a href="model-checking.html#model-checking-homoskedasticity"><i class="fa fa-check"></i><b>11.3.4</b> Model checking homoskedasticity</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="model-checking.html"><a href="model-checking.html#using-r"><i class="fa fa-check"></i><b>11.4</b> Using R</a><ul>
<li class="chapter" data-level="11.4.1" data-path="model-checking.html"><a href="model-checking.html#normal-q-q-plots"><i class="fa fa-check"></i><b>11.4.1</b> Normal Q-Q plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html"><i class="fa fa-check"></i><b>12</b> Model Fitting and Model Fit (OLS)</a><ul>
<li class="chapter" data-level="12.1" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#least-squares-estimation-and-the-decomposition-of-variance"><i class="fa fa-check"></i><b>12.1</b> Least Squares Estimation and the Decomposition of Variance</a></li>
<li class="chapter" data-level="12.2" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#ols-regression"><i class="fa fa-check"></i><b>12.2</b> OLS regression</a></li>
<li class="chapter" data-level="12.3" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#how-well-does-the-model-fit-the-data-r2-and-variance-explained"><i class="fa fa-check"></i><b>12.3</b> How well does the model fit the data? <span class="math inline">\(R^2\)</span> and “variance explained”</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html"><i class="fa fa-check"></i><b>13</b> Best practices – issues in inference</a><ul>
<li class="chapter" data-level="13.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#multiple-testing"><i class="fa fa-check"></i><b>13.1</b> Multiple testing</a><ul>
<li class="chapter" data-level="13.1.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#some-background"><i class="fa fa-check"></i><b>13.1.1</b> Some background</a></li>
<li class="chapter" data-level="13.1.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#multiple-testing-working-in-r"><i class="fa fa-check"></i><b>13.1.2</b> Multiple testing – working in R</a></li>
<li class="chapter" data-level="13.1.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#false-discovery-rate"><i class="fa fa-check"></i><b>13.1.3</b> False Discovery Rate</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#difference-in-p-is-not-different"><i class="fa fa-check"></i><b>13.2</b> difference in p is not different</a></li>
<li class="chapter" data-level="13.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#inference-when-data-are-not-normal"><i class="fa fa-check"></i><b>13.3</b> Inference when data are not Normal</a><ul>
<li class="chapter" data-level="13.3.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#working-in-r-3"><i class="fa fa-check"></i><b>13.3.1</b> Working in R</a></li>
<li class="chapter" data-level="13.3.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>13.3.2</b> Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="13.3.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#permutation-test"><i class="fa fa-check"></i><b>13.3.3</b> Permutation test</a></li>
<li class="chapter" data-level="13.3.4" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#non-parametric-tests"><i class="fa fa-check"></i><b>13.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="13.3.5" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#log-transformations"><i class="fa fa-check"></i><b>13.3.5</b> Log transformations</a></li>
<li class="chapter" data-level="13.3.6" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#performance-of-parametric-tests-and-alternatives"><i class="fa fa-check"></i><b>13.3.6</b> Performance of parametric tests and alternatives</a></li>
</ul></li>
</ul></li>
<li><a href="part-vi-more-than-one-x-multivariable-models.html#part-vi-more-than-one-x-multivariable-models">Part VI: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li class="chapter" data-level="14" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html"><i class="fa fa-check"></i><b>14</b> Adding covariates to a linear model</a><ul>
<li class="chapter" data-level="14.1" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><i class="fa fa-check"></i><b>14.1</b> Adding covariates can increases the precision of the effect of interest</a></li>
<li class="chapter" data-level="14.2" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data"><i class="fa fa-check"></i><b>14.2</b> Understanding a linear model with an added covariate – heart necrosis data</a><ul>
<li class="chapter" data-level="14.2.1" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#fit-the-model-1"><i class="fa fa-check"></i><b>14.2.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.2.2" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#plot-the-model-1"><i class="fa fa-check"></i><b>14.2.2</b> Plot the model</a></li>
<li class="chapter" data-level="14.2.3" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#interpretation-of-the-model-coefficients"><i class="fa fa-check"></i><b>14.2.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.2.4" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#everything-adds-up"><i class="fa fa-check"></i><b>14.2.4</b> Everything adds up</a></li>
<li class="chapter" data-level="14.2.5" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#interpretation-of-the-estimated-marginal-means"><i class="fa fa-check"></i><b>14.2.5</b> Interpretation of the estimated marginal means</a></li>
<li class="chapter" data-level="14.2.6" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#interpretation-of-the-contrasts"><i class="fa fa-check"></i><b>14.2.6</b> Interpretation of the contrasts</a></li>
<li class="chapter" data-level="14.2.7" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-the-covariate-improves-inference"><i class="fa fa-check"></i><b>14.2.7</b> Adding the covariate improves inference</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#understanding-interaction-effects-with-covariates"><i class="fa fa-check"></i><b>14.3</b> Understanding interaction effects with covariates</a><ul>
<li class="chapter" data-level="14.3.1" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#fit-the-model-2"><i class="fa fa-check"></i><b>14.3.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.3.2" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#plot-the-model-with-interaction-effect"><i class="fa fa-check"></i><b>14.3.2</b> Plot the model with interaction effect</a></li>
<li class="chapter" data-level="14.3.3" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#interpretation-of-the-model-coefficients-1"><i class="fa fa-check"></i><b>14.3.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.3.4" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends."><i class="fa fa-check"></i><b>14.3.4</b> What is the effect of a treatment, if interactions are modeled? – it depends.</a></li>
<li class="chapter" data-level="14.3.5" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#which-model-do-we-use-mathcalm_1-or-mathcalm_2"><i class="fa fa-check"></i><b>14.3.5</b> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#understanding-ancova-tables"><i class="fa fa-check"></i><b>14.4</b> Understanding ANCOVA tables</a></li>
<li class="chapter" data-level="14.5" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#working-in-r-4"><i class="fa fa-check"></i><b>14.5</b> Working in R</a><ul>
<li class="chapter" data-level="14.5.1" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#importing-the-heart-necrosis-data"><i class="fa fa-check"></i><b>14.5.1</b> Importing the heart necrosis data</a></li>
<li class="chapter" data-level="14.5.2" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#fitting-the-model"><i class="fa fa-check"></i><b>14.5.2</b> Fitting the model</a></li>
<li class="chapter" data-level="14.5.3" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#ancova-tables"><i class="fa fa-check"></i><b>14.5.3</b> ANCOVA tables</a></li>
<li class="chapter" data-level="14.5.4" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#plotting-the-model"><i class="fa fa-check"></i><b>14.5.4</b> Plotting the model</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#best-practices"><i class="fa fa-check"></i><b>14.6</b> Best practices</a><ul>
<li class="chapter" data-level="14.6.1" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate"><i class="fa fa-check"></i><b>14.6.1</b> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</a></li>
<li class="chapter" data-level="14.6.2" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate"><i class="fa fa-check"></i><b>14.6.2</b> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</a></li>
<li class="chapter" data-level="14.6.3" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#regression-to-the-mean-in-words"><i class="fa fa-check"></i><b>14.6.3</b> Regression to the mean in words</a></li>
<li class="chapter" data-level="14.6.4" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#regression-to-the-mean-in-pictures"><i class="fa fa-check"></i><b>14.6.4</b> Regression to the mean in pictures</a></li>
<li class="chapter" data-level="14.6.5" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#do-not-use-percent-change-believing-that-percents-account-for-effects-of-initial-weights"><i class="fa fa-check"></i><b>14.6.5</b> Do not use percent change, believing that percents account for effects of initial weights</a></li>
<li class="chapter" data-level="14.6.6" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#do-not-test-for-balance-of-baseline-measures"><i class="fa fa-check"></i><b>14.6.6</b> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><i class="fa fa-check"></i><b>14.7</b> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html"><i class="fa fa-check"></i><b>15</b> Two (or more) Categorical <span class="math inline">\(X\)</span> – Factorial designs</a><ul>
<li class="chapter" data-level="15.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#factorial-experiments"><i class="fa fa-check"></i><b>15.1</b> Factorial experiments</a><ul>
<li class="chapter" data-level="15.1.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#model-coefficients-an-interaction-effect-is-what-is-leftover-after-adding-the-treatment-effects-to-the-control"><i class="fa fa-check"></i><b>15.1.1</b> Model coefficients: an interaction effect is what is leftover after adding the treatment effects to the control</a></li>
<li class="chapter" data-level="15.1.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#what-is-the-biological-meaning-of-an-interaction-effect"><i class="fa fa-check"></i><b>15.1.2</b> What is the biological meaning of an interaction effect?</a></li>
<li class="chapter" data-level="15.1.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#the-interpretation-of-the-coefficients-in-a-factorial-model-is-entirely-dependent-on-the-reference"><i class="fa fa-check"></i><b>15.1.3</b> The interpretation of the coefficients in a factorial model is entirely dependent on the reference…</a></li>
<li class="chapter" data-level="15.1.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#estimated-marginal-means"><i class="fa fa-check"></i><b>15.1.4</b> Estimated marginal means</a></li>
<li class="chapter" data-level="15.1.5" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#in-a-factorial-model-there-are-multiple-effects-of-each-factor-simple-effects"><i class="fa fa-check"></i><b>15.1.5</b> In a factorial model, there are multiple effects of each factor (simple effects)</a></li>
<li class="chapter" data-level="15.1.6" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#marginal-effects"><i class="fa fa-check"></i><b>15.1.6</b> Marginal effects</a></li>
<li class="chapter" data-level="15.1.7" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#the-additive-model"><i class="fa fa-check"></i><b>15.1.7</b> The additive model</a></li>
<li class="chapter" data-level="15.1.8" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#reduce-models-for-the-right-reason"><i class="fa fa-check"></i><b>15.1.8</b> Reduce models for the right reason</a></li>
<li class="chapter" data-level="15.1.9" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#what-about-models-with-more-than-two-factors"><i class="fa fa-check"></i><b>15.1.9</b> What about models with more than two factors?</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#reporting-results"><i class="fa fa-check"></i><b>15.2</b> Reporting results</a><ul>
<li class="chapter" data-level="15.2.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#text-results"><i class="fa fa-check"></i><b>15.2.1</b> Text results</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#working-in-r-5"><i class="fa fa-check"></i><b>15.3</b> Working in R</a><ul>
<li class="chapter" data-level="15.3.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#model-formula"><i class="fa fa-check"></i><b>15.3.1</b> Model formula</a></li>
<li class="chapter" data-level="15.3.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#modeled-means"><i class="fa fa-check"></i><b>15.3.2</b> Modeled means</a></li>
<li class="chapter" data-level="15.3.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#marginal-means"><i class="fa fa-check"></i><b>15.3.3</b> Marginal means</a></li>
<li class="chapter" data-level="15.3.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#contrasts"><i class="fa fa-check"></i><b>15.3.4</b> Contrasts</a></li>
<li class="chapter" data-level="15.3.5" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#simple-effects"><i class="fa fa-check"></i><b>15.3.5</b> Simple effects</a></li>
<li class="chapter" data-level="15.3.6" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#marginal-effects-1"><i class="fa fa-check"></i><b>15.3.6</b> Marginal effects</a></li>
<li class="chapter" data-level="15.3.7" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#plotting-results"><i class="fa fa-check"></i><b>15.3.7</b> Plotting results</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#problems-1"><i class="fa fa-check"></i><b>15.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="anova-tables.html"><a href="anova-tables.html"><i class="fa fa-check"></i><b>16</b> ANOVA Tables</a><ul>
<li class="chapter" data-level="16.1" data-path="anova-tables.html"><a href="anova-tables.html#summary-of-usage"><i class="fa fa-check"></i><b>16.1</b> Summary of usage</a></li>
<li class="chapter" data-level="16.2" data-path="anova-tables.html"><a href="anova-tables.html#example-a-one-way-anova-using-the-vole-data"><i class="fa fa-check"></i><b>16.2</b> Example: a one-way ANOVA using the vole data</a></li>
<li class="chapter" data-level="16.3" data-path="anova-tables.html"><a href="anova-tables.html#example-a-two-way-anova-using-the-urchin-data"><i class="fa fa-check"></i><b>16.3</b> Example: a two-way ANOVA using the urchin data</a><ul>
<li class="chapter" data-level="16.3.1" data-path="anova-tables.html"><a href="anova-tables.html#how-to-read-an-anova-table"><i class="fa fa-check"></i><b>16.3.1</b> How to read an ANOVA table</a></li>
<li class="chapter" data-level="16.3.2" data-path="anova-tables.html"><a href="anova-tables.html#how-to-read-anova-results-reported-in-the-text"><i class="fa fa-check"></i><b>16.3.2</b> How to read ANOVA results reported in the text</a></li>
<li class="chapter" data-level="16.3.3" data-path="anova-tables.html"><a href="anova-tables.html#better-practice-estimates-and-their-uncertainty"><i class="fa fa-check"></i><b>16.3.3</b> Better practice – estimates and their uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="anova-tables.html"><a href="anova-tables.html#unbalanced-designs"><i class="fa fa-check"></i><b>16.4</b> Unbalanced designs</a><ul>
<li class="chapter" data-level="16.4.1" data-path="anova-tables.html"><a href="anova-tables.html#what-is-going-on-in-unbalanced-anova-type-i-ii-iii-sum-of-squares"><i class="fa fa-check"></i><b>16.4.1</b> What is going on in unbalanced ANOVA? – Type I, II, III sum of squares</a></li>
<li class="chapter" data-level="16.4.2" data-path="anova-tables.html"><a href="anova-tables.html#back-to-interpretation-of-main-effects"><i class="fa fa-check"></i><b>16.4.2</b> Back to interpretation of main effects</a></li>
<li class="chapter" data-level="16.4.3" data-path="anova-tables.html"><a href="anova-tables.html#the-anova-tables-for-type-i-ii-and-iii-sum-of-squares-are-the-same-if-the-design-is-balanced."><i class="fa fa-check"></i><b>16.4.3</b> The anova tables for Type I, II, and III sum of squares are the same if the design is balanced.</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="anova-tables.html"><a href="anova-tables.html#working-in-r-6"><i class="fa fa-check"></i><b>16.5</b> Working in R</a><ul>
<li class="chapter" data-level="16.5.1" data-path="anova-tables.html"><a href="anova-tables.html#type-i-sum-of-squares-in-r"><i class="fa fa-check"></i><b>16.5.1</b> Type I sum of squares in R</a></li>
<li class="chapter" data-level="16.5.2" data-path="anova-tables.html"><a href="anova-tables.html#type-ii-and-iii-sum-of-squares"><i class="fa fa-check"></i><b>16.5.2</b> Type II and III Sum of Squares</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="predictive-models.html"><a href="predictive-models.html"><i class="fa fa-check"></i><b>17</b> Predictive Models</a><ul>
<li class="chapter" data-level="17.1" data-path="predictive-models.html"><a href="predictive-models.html#overfitting"><i class="fa fa-check"></i><b>17.1</b> Overfitting</a></li>
<li class="chapter" data-level="17.2" data-path="predictive-models.html"><a href="predictive-models.html#model-building-vs.-variable-selection-vs.-model-selection"><i class="fa fa-check"></i><b>17.2</b> Model building vs. Variable selection vs. Model selection</a><ul>
<li class="chapter" data-level="17.2.1" data-path="predictive-models.html"><a href="predictive-models.html#stepwise-regression"><i class="fa fa-check"></i><b>17.2.1</b> Stepwise regression</a></li>
<li class="chapter" data-level="17.2.2" data-path="predictive-models.html"><a href="predictive-models.html#cross-validation"><i class="fa fa-check"></i><b>17.2.2</b> Cross-validation</a></li>
<li class="chapter" data-level="17.2.3" data-path="predictive-models.html"><a href="predictive-models.html#penalization"><i class="fa fa-check"></i><b>17.2.3</b> Penalization</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="predictive-models.html"><a href="predictive-models.html#shrinkage"><i class="fa fa-check"></i><b>17.3</b> Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-vii-expanding-the-linear-model.html"><a href="part-vii-expanding-the-linear-model.html"><i class="fa fa-check"></i>Part VII – Expanding the Linear Model</a></li>
<li class="chapter" data-level="18" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html"><i class="fa fa-check"></i><b>18</b> Linear mixed models</a><ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#random-effects"><i class="fa fa-check"></i><b>18.1</b> Random effects</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#random-effects-in-statistical-models"><i class="fa fa-check"></i><b>18.2</b> Random effects in statistical models</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#linear-mixed-models-are-flexible"><i class="fa fa-check"></i><b>18.3</b> Linear mixed models are flexible</a></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#blocking"><i class="fa fa-check"></i><b>18.4</b> Blocking</a><ul>
<li class="chapter" data-level="18.4.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#visualing-variation-due-to-blocks"><i class="fa fa-check"></i><b>18.4.1</b> Visualing variation due to blocks</a></li>
<li class="chapter" data-level="18.4.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#blocking-increases-precision-of-point-estimates"><i class="fa fa-check"></i><b>18.4.2</b> Blocking increases precision of point estimates</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#pseudoreplication"><i class="fa fa-check"></i><b>18.5</b> Pseudoreplication</a><ul>
<li class="chapter" data-level="18.5.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#visualizing-pseduoreplication"><i class="fa fa-check"></i><b>18.5.1</b> Visualizing pseduoreplication</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#mapping-nhst-to-estimation-a-paired-t-test-is-a-special-case-of-a-linear-mixed-model"><i class="fa fa-check"></i><b>18.6</b> Mapping NHST to estimation: A paired t-test is a special case of a linear mixed model</a></li>
<li class="chapter" data-level="18.7" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#advanced-topic-linear-mixed-models-shrink-coefficients-by-partial-pooling"><i class="fa fa-check"></i><b>18.7</b> Advanced topic – Linear mixed models shrink coefficients by partial pooling</a></li>
<li class="chapter" data-level="18.8" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#working-in-r-7"><i class="fa fa-check"></i><b>18.8</b> Working in R</a><ul>
<li class="chapter" data-level="18.8.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#coral-data"><i class="fa fa-check"></i><b>18.8.1</b> coral data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html"><i class="fa fa-check"></i><b>19</b> Generalized linear models I: Count data</a><ul>
<li class="chapter" data-level="19.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#the-generalized-linear-model"><i class="fa fa-check"></i><b>19.1</b> The generalized linear model</a></li>
<li class="chapter" data-level="19.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish"><i class="fa fa-check"></i><b>19.2</b> Count data example – number of trematode worm larvae in eyes of threespine stickleback fish</a><ul>
<li class="chapter" data-level="19.2.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#modeling-strategy-1"><i class="fa fa-check"></i><b>19.2.1</b> Modeling strategy</a></li>
<li class="chapter" data-level="19.2.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#checking-the-model-i-a-normal-q-q-plot"><i class="fa fa-check"></i><b>19.2.2</b> Checking the model I – a Normal Q-Q plot</a></li>
<li class="chapter" data-level="19.2.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#checking-the-model-ii-scale-location-plot-for-checking-homoskedasticity"><i class="fa fa-check"></i><b>19.2.3</b> Checking the model II – scale-location plot for checking homoskedasticity</a></li>
<li class="chapter" data-level="19.2.4" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#two-distributions-for-count-data-poisson-and-negative-binomial"><i class="fa fa-check"></i><b>19.2.4</b> Two distributions for count data – Poisson and Negative Binomial</a></li>
<li class="chapter" data-level="19.2.5" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-with-a-poisson-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>19.2.5</b> Fitting a GLM with a Poisson distribution to the worm data</a></li>
<li class="chapter" data-level="19.2.6" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#model-checking-fits-to-count-data"><i class="fa fa-check"></i><b>19.2.6</b> Model checking fits to count data</a></li>
<li class="chapter" data-level="19.2.7" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-with-a-negative-binomial-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>19.2.7</b> Fitting a GLM with a Negative Binomial distribution to the worm data</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#working-in-r-8"><i class="fa fa-check"></i><b>19.3</b> Working in R</a><ul>
<li class="chapter" data-level="19.3.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-to-count-data"><i class="fa fa-check"></i><b>19.3.1</b> Fitting a GLM to count data</a></li>
<li class="chapter" data-level="19.3.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-generalized-linear-mixed-model-glmm-to-count-data"><i class="fa fa-check"></i><b>19.3.2</b> Fitting a generalized linear mixed model (GLMM) to count data</a></li>
<li class="chapter" data-level="19.3.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-generalized-linear-model-to-continouus-data"><i class="fa fa-check"></i><b>19.3.3</b> Fitting a generalized linear model to continouus data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#problems-2"><i class="fa fa-check"></i><b>19.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="linear-models-with-heterogenous-variance.html"><a href="linear-models-with-heterogenous-variance.html"><i class="fa fa-check"></i><b>20</b> Linear models with heterogenous variance</a><ul>
<li class="chapter" data-level="20.1" data-path="linear-models-with-heterogenous-variance.html"><a href="linear-models-with-heterogenous-variance.html#gls"><i class="fa fa-check"></i><b>20.1</b> gls</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"><a href="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"><i class="fa fa-check"></i>Part V: Expanding the Linear Model – Generalized Linear Models and Multilevel (Linear Mixed) Models</a></li>
<li class="chapter" data-level="21" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html"><i class="fa fa-check"></i><b>21</b> Plotting functions (#ggplotsci)</a><ul>
<li class="chapter" data-level="21.1" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#odd-even"><i class="fa fa-check"></i><b>21.1</b> odd-even</a></li>
<li class="chapter" data-level="21.2" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#estimate-response-and-effects-with-emmeans"><i class="fa fa-check"></i><b>21.2</b> estimate response and effects with emmeans</a></li>
<li class="chapter" data-level="21.3" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#emm_table"><i class="fa fa-check"></i><b>21.3</b> emm_table</a></li>
<li class="chapter" data-level="21.4" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#pairs_table"><i class="fa fa-check"></i><b>21.4</b> pairs_table</a></li>
<li class="chapter" data-level="21.5" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#gg_mean_error"><i class="fa fa-check"></i><b>21.5</b> gg_mean_error</a></li>
<li class="chapter" data-level="21.6" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#gg_ancova"><i class="fa fa-check"></i><b>21.6</b> gg_ancova</a></li>
<li class="chapter" data-level="21.7" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#gg_mean_ci_ancova"><i class="fa fa-check"></i><b>21.7</b> gg_mean_ci_ancova</a></li>
<li class="chapter" data-level="21.8" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#gg_effects"><i class="fa fa-check"></i><b>21.8</b> gg_effects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html"><i class="fa fa-check"></i>Appendix 1: Getting Started with R</a><ul>
<li class="chapter" data-level="21.9" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready"><i class="fa fa-check"></i><b>21.9</b> Get your computer ready</a><ul>
<li class="chapter" data-level="21.9.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-here"><i class="fa fa-check"></i><b>21.9.1</b> Start here</a></li>
<li class="chapter" data-level="21.9.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r"><i class="fa fa-check"></i><b>21.9.2</b> Install R</a></li>
<li class="chapter" data-level="21.9.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-studio"><i class="fa fa-check"></i><b>21.9.3</b> Install R Studio</a></li>
<li class="chapter" data-level="21.9.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-markdown-1"><i class="fa fa-check"></i><b>21.9.4</b> Install R Markdown</a></li>
<li class="chapter" data-level="21.9.5" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#optional-alternative-latex-installations"><i class="fa fa-check"></i><b>21.9.5</b> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li class="chapter" data-level="21.10" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-learning-r-studio"><i class="fa fa-check"></i><b>21.10</b> Start learning R Studio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><i class="fa fa-check"></i>Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="chapter" data-level="" data-path="appendix-3-fake-data-simulations.html"><a href="appendix-3-fake-data-simulations.html"><i class="fa fa-check"></i>Appendix 3: Fake Data Simulations</a><ul>
<li class="chapter" data-level="21.11" data-path="appendix-3-fake-data-simulations.html"><a href="appendix-3-fake-data-simulations.html#performance-of-blocking-relative-to-a-linear-model"><i class="fa fa-check"></i><b>21.11</b> Performance of Blocking relative to a linear model</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Elements of Statistical Modeling for Experimental Biology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-models-with-a-single-categorical-x" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> Linear models with a single, categorical <em>X</em></h1>
<div id="a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response." class="section level2">
<h2><span class="header-section-number">10.1</span> A linear model with a single, categorical <em>X</em> variable estimates the effects of the levels of <em>X</em> on the response.</h2>
<p>To introduce a linear model with a single, categorical <span class="math inline">\(X\)</span> variable, I’ll use data from a set of experiments designed to measure the effect of the lipid 12,13-diHOME on brown adipose tissue (BAT) thermoregulation and the mechanism of this effect.</p>
<p><a href="https://www.nature.com/articles/nm.4297" target="_blank">Lynes, M.D., Leiria, L.O., Lundh, M., Bartelt, A., Shamsi, F., Huang, T.L., Takahashi, H., Hirshman, M.F., Schlein, C., Lee, A. and Baer, L.A., 2017. The cold-induced lipokine 12, 13-diHOME promotes fatty acid transport into brown adipose tissue. Nature medicine, 23(5), pp.631-637.</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5699924/pdf/nihms916046.pdf" target="_blank">Public source</a></p>
<p><a href="https://www.nature.com/articles/nm.4297#Sec14" target="_blank">Data source</a></p>
<p>Download the source data files and move to a new folder named “The cold-induced lipokine 12,13-diHOME promotes fatty acid transport into brown adipose tissue”.</p>
<p>Cold temperature and the neurotransmitter/hormone norepinephrine are known to stimulate increased thermogenesis in BAT cells. In this project, the researchers probed the question “what is the pathway that mediates the effect of cold-exposure on BAT thermogenesis?”. In the “discovery” component of this project, the researchers measured plasma levels of 88 lipids with known signaling properties in humans exposed to one hour of both normal (20 °C) and cold temperature (14 °C) temperature. Of the 88 lipids, 12,13-diHOME had the largest response to the cold treatment. The researchers followed this up with experiments on mice.</p>
<div id="example-1-two-treatment-levels-groups" class="section level3">
<h3><span class="header-section-number">10.1.1</span> Example 1 – two treatment levels (“groups”)</h3>
<p>Let’s start with the experiment in Figure 3d, which was designed to measure the effect of 12,13-diHOME on plasma triglyceride level. If 12,13-diHOME stimulates BAT activity, then levels in the 12,13-diHOME mice should be less than levels in the control mice.</p>
<p><strong>response variable</strong>: <em>serum_tg</em>, a continuous variable.</p>
<p><strong>treatment variable</strong>: <em>treatment</em>, with levels: “Vehicle”, “12,13-diHOME” (the control or “Vehicle” mice were injected with saline). Coded as a factor.</p>
<p><strong>design</strong>: single, categorical <em>X</em></p>
<div id="step-1-import" class="section level4">
<h4><span class="header-section-number">10.1.1.1</span> Step 1 – import</h4>
<p>The first step in any analysis is to open the data and, if necessary, wrangle into an analyzable format. The script to import these data is in the section Hidden code below.</p>
</div>
<div id="step-2-examine-the-data" class="section level4">
<h4><span class="header-section-number">10.1.1.2</span> Step 2 – examine the data</h4>
<p>The second step is to examine the data to</p>
<ol start="6" class="example" style="list-style-type: decimal">
<li>get a sense of sample size and balance</li>
<li>check for biologically implausible outliers that suggest measurement failure, or transcription error (from a notebook, not in a cell)</li>
<li>assess outliers for outlier strategy or robust analysis</li>
<li>assess reasonable distributions and models for analysis.</li>
</ol>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="linear-models-with-a-single-categorical-x.html#cb283-1"></a><span class="kw">qplot</span>(<span class="dt">x =</span> treatment, <span class="dt">y =</span> serum_tg, <span class="dt">data =</span> fig_3d)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-159-1.png" width="576" /></p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="linear-models-with-a-single-categorical-x.html#cb284-1"></a><span class="co"># ggdotplot(x = &quot;treatment&quot;, y = &quot;serum_tg&quot;, data = fig_3d)</span></span></code></pre></div>
<p>There are no obviously implausible data points. A normal distribution is a good, reasonable start. This can be checked more thoroughly after fitting the model.</p>
</div>
<div id="step-3-fit-the-model" class="section level4">
<h4><span class="header-section-number">10.1.1.3</span> Step 3 – fit the model</h4>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="linear-models-with-a-single-categorical-x.html#cb285-1"></a>fig3d_m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(serum_tg <span class="op">~</span><span class="st"> </span>treatment, <span class="dt">data =</span> fig_3d)</span></code></pre></div>
</div>
<div id="step-4-check-the-model" class="section level4">
<h4><span class="header-section-number">10.1.1.4</span> Step 4 – check the model</h4>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="linear-models-with-a-single-categorical-x.html#cb286-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb286-2"><a href="linear-models-with-a-single-categorical-x.html#cb286-2"></a><span class="kw">qqPlot</span>(fig3d_m1, <span class="dt">id=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-161-1.png" width="576" /></p>
<p>The Q-Q plot indicates the distribution of residuals is well within that expected for a normal sample and there is no cause for concern with inference.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="linear-models-with-a-single-categorical-x.html#cb287-1"></a><span class="kw">spreadLevelPlot</span>(fig3d_m1, <span class="dt">id=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-162-1.png" width="576" /></p>
<pre><code>## 
## Suggested power transformation:  0.8167264</code></pre>
<p>The spread-location plot shows no conspicuous trend in how the spread changes with the conditonal mean. There is no cause for concern with inference.</p>
</div>
<div id="step-5-inference" class="section level4">
<h4><span class="header-section-number">10.1.1.5</span> Step 5 – inference</h4>
<div id="coefficient-table" class="section level5">
<h5><span class="header-section-number">10.1.1.5.1</span> coefficient table</h5>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="linear-models-with-a-single-categorical-x.html#cb289-1"></a>fig3d_m1_coef &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(fig3d_m1)),</span>
<span id="cb289-2"><a href="linear-models-with-a-single-categorical-x.html#cb289-2"></a>                        <span class="kw">confint</span>(fig3d_m1))</span>
<span id="cb289-3"><a href="linear-models-with-a-single-categorical-x.html#cb289-3"></a>fig3d_m1_coef</span></code></pre></div>
<pre><code>##                        Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)           42.620042   1.667226 25.563447 1.926081e-10
## treatment12,13-diHOME -7.167711   2.357813 -3.039982 1.246296e-02
##                           2.5 %    97.5 %
## (Intercept)            38.90523 46.334853
## treatment12,13-diHOME -12.42125 -1.914175</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="linear-models-with-a-single-categorical-x.html#cb291-1"></a><span class="co">#knitr::kable(fig3d_m1_coef, digits = c(1,2,1,4,1,1))</span></span></code></pre></div>
</div>
<div id="marginal-means-table" class="section level5">
<h5><span class="header-section-number">10.1.1.5.2</span> Marginal means table</h5>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="linear-models-with-a-single-categorical-x.html#cb292-1"></a>(fig3d_m1_emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(fig3d_m1, <span class="dt">specs =</span> <span class="st">&quot;treatment&quot;</span>))</span></code></pre></div>
<pre><code>##  treatment    emmean   SE df lower.CL upper.CL
##  Vehicle        42.6 1.67 10     38.9     46.3
##  12,13-diHOME   35.5 1.67 10     31.7     39.2
## 
## Confidence level used: 0.95</code></pre>
</div>
<div id="contrasts-table" class="section level5">
<h5><span class="header-section-number">10.1.1.5.3</span> Contrasts table</h5>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="linear-models-with-a-single-categorical-x.html#cb294-1"></a>(fig3d_m1_pairs &lt;-<span class="st"> </span><span class="kw">contrast</span>(fig3d_m1_emm,</span>
<span id="cb294-2"><a href="linear-models-with-a-single-categorical-x.html#cb294-2"></a>                            <span class="dt">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb294-3"><a href="linear-models-with-a-single-categorical-x.html#cb294-3"></a><span class="st">  </span><span class="kw">summary</span>(<span class="dt">infer =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>##  contrast               estimate   SE df lower.CL upper.CL t.ratio p.value
##  12,13-diHOME - Vehicle    -7.17 2.36 10    -12.4    -1.91 -3.040  0.0125 
## 
## Confidence level used: 0.95</code></pre>
</div>
</div>
<div id="step-6-plot-the-model" class="section level4">
<h4><span class="header-section-number">10.1.1.6</span> Step 6 – plot the model</h4>
<p>The script for plotting the model in the section Hidden code below.</p>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-169-1.png" width="576" /></p>
</div>
<div id="step-7-report-the-model-results" class="section level4">
<h4><span class="header-section-number">10.1.1.7</span> Step 7 – report the model results</h4>
<p>Mean serum TG in mice with 12,13-diHOME (35.5 µg/dL, 95% CI: 31.7, 39.2) was 7.17 µg/dL less (95% CI: -12.4, -1.9, <span class="math inline">\(p = 0.012\)</span>) than mean serum TG in control mice (42.6 µg/dL, 95% CI: 38.9, 46.3).</p>
</div>
</div>
<div id="understanding-the-analysis-with-two-treatment-levels" class="section level3">
<h3><span class="header-section-number">10.1.2</span> Understanding the analysis with two treatment levels</h3>
<p>The variable <span class="math inline">\(treatment\)</span> in the Figure 3d mouse experiment, is a single, categorical <span class="math inline">\(X\)</span> variable. In a linear model, categorical variables are called <strong>factors</strong>. <span class="math inline">\(treatment\)</span> can take two different values, “Vehicle” and “12,13-diHOME”. The different values in a factor are the <strong>factor levels</strong> (or just “levels”). “Levels” is a strange usage of this word; a less formal name for levels is “groups”. In a <strong>Nominal</strong> categorical factor, the levels have no units and are unordered, even if the variable is based on a numeric measurement. For example, I might design an experiment in which mice are randomly assigned to one of three treatments: one hour at 14 °C, one hour at 18 °C, or one hour at 26 °C. If I model this treatment as a nominal categorical factor, then I simply have three levels. While I would certainly choose to arrange these levels in a meaningful way in a plot, for the analysis itself, these levels have no units and there is no order. <strong>Ordinal</strong> categorical factors have levels that are ordered but there is no information on relative distance. The treatment at 18 °C is not more similar to 14 °C than to 26 °C. Nominal categorical factors is the default in R and how all factors are analyzed in this text.</p>
<div id="linear-models-are-regression-models" class="section level4">
<h4><span class="header-section-number">10.1.2.1</span> Linear models are regression models</h4>
<p>The linear model fit to the serum TG data is</p>
<p><span class="math display" id="eq:lm-serum-tg">\[\begin{align}
serum\_tg &amp;= treatment + \varepsilon\\
\varepsilon &amp;~ N(0, sigma^2)
\tag{10.1}
\end{align}\]</span></p>
<p>This specification is potentially confusing because the variable <span class="math inline">\(treatment\)</span> is a factor containing the words “Vehicle” and “12,13-diHOME” and not numbers. A linear model with a single factor containing two levels can be specified using notation for a regression model.</p>
<p><span class="math display" id="eq:model-cat-x">\[\begin{align}
Y &amp;= \beta_0 + \beta_1 X_1 + \varepsilon\\
\varepsilon &amp;\sim N(0, \sigma^2)
\tag{10.2}
\end{align}\]</span></p>
<p>Model <a href="linear-models-with-a-single-categorical-x.html#eq:model-cat-x">(10.2)</a> is a regression model where <span class="math inline">\(X_1\)</span> is not the variable <span class="math inline">\(treatment\)</span>, containing the words “Vehicle” or “12,13-diHOME” but a numeric variable that indicates group membership, containing the number 1 if the element belongs to the first non-reference level (if there are only two levels, then there is only a single, non-reference level) and the number 0 if the element doesn’t belong to the first non-reference level.</p>
<p>For the serum TG data, “Vehicle” is the reference, so we can write the linear model fit to the serum TG data using regression model notation.</p>
<p><span class="math display" id="eq:model-cat-serum-tg">\[\begin{align}
serum\_tg &amp;= \beta_0 + \beta_1 treatment_{12,13-diHOME} + \varepsilon\\
\varepsilon &amp;\sim N(0, \sigma^2)
\tag{10.3}
\end{align}\]</span></p>
<p>Model <a href="linear-models-with-a-single-categorical-x.html#eq:model-cat-serum-tg">(10.3)</a> is a regression model where <span class="math inline">\(treatment_{12,13-diHOME}\)</span> is not the variable <span class="math inline">\(treatment\)</span>, containing the words “Vehicle” or “12,13-diHOME” but a numeric variable that indicates membership in the level “12,13-diHOME”. This variable contains the number 1 if the element belongs to “12,13-diHOME” and the number 0 if the element doesn’t belong to “12,13-diHOME”. More generally, model <a href="linear-models-with-a-single-categorical-x.html#eq:model-cat-x">(10.2)</a> is a regression model where <span class="math inline">\(X_1\)</span> contains the number 1 if the element belongs to the first non-reference level (if there are only two levels, then there is only a single, non-reference level) and the number 0 if the element doesn’t belong to the first non-reference level. If there were a third level within <span class="math inline">\(treatment\)</span> (say, a 12,13-diHOME inhibitor), there would be a second <span class="math inline">\(X\)</span> variable added to the model (<span class="math inline">\(X_2\)</span>), which would contain the number 1 if the element belongs to the second non-reference level (12,13-diHOME inhibitor) and the number 0, otherwise.</p>
<p>The <span class="math inline">\(X\)</span> variables in the regression model notation that indicate group membership are called <strong>indicator variables</strong>. There are several ways of coding indicator variables and the way described here is called <strong>dummy</strong> or treatment coding. This text will typically call dummy-coded indicator variables <strong>dummy variables</strong>. The <code>lm</code> function creates these dummy variables under the table, in something called the <strong>model matrix</strong>. You won’t see these columns in your data but if you did, they would look like this</p>
<table>
<thead>
<tr class="header">
<th align="left">treatment</th>
<th align="right">serum_tg</th>
<th align="right">treatment12,13-diHOME</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Vehicle</td>
<td align="right">42.35908</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Vehicle</td>
<td align="right">43.82046</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Vehicle</td>
<td align="right">39.01879</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Vehicle</td>
<td align="right">48.72651</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Vehicle</td>
<td align="right">45.17745</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Vehicle</td>
<td align="right">36.61795</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">12,13-diHOME</td>
<td align="right">36.09603</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">12,13-diHOME</td>
<td align="right">32.12944</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">12,13-diHOME</td>
<td align="right">33.38205</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">12,13-diHOME</td>
<td align="right">41.52401</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">12,13-diHOME</td>
<td align="right">31.71190</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">12,13-diHOME</td>
<td align="right">37.87056</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>R names dummy variables by combining the names of the factor and the name of the level within the factor. So the <span class="math inline">\(X\)</span> variable that R creates in the model matrix for the fit linear model in model <a href="linear-models-with-a-single-categorical-x.html#eq:model-cat-x">(10.2)</a> is <span class="math inline">\(treatment12,13-diHOME\)</span>. You can see these names as terms in the coefficient table of the fit model.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>Analysis fail. There are alternatives to dummy coding for creating indicator variables. Dummy coding is the default in R and it makes sense when thinking about experimental data with an obvious control level. I also like the interpretation of a “interaction effect” using Dummy coding. The classical coding for ANOVA is deviation effect coding, which creates coefficients that are deviations from the grand mean. In contrast to R, Deviation coding is the default in many statistical software packages including SAS, SPSS, and JMP. The method of coding can make a difference in an ANOVA table. Watch out for this – I’ve come across numerous published papers where the researchers used the default dummy coding but interpreted the ANOVA table as if they had used deviation coding. This is both getting ahead of ourselves and somewhat moot, because I don’t advocate publishing ANOVA tables.</p>
</div>
</div>
<div id="the-estimates-in-the-coefficient-table-are-estimates-of-the-parameters-of-the-linear-model-fit-to-the-data." class="section level4">
<h4><span class="header-section-number">10.1.2.2</span> The “Estimates” in the coefficient table are estimates of the parameters of the linear model fit to the data.</h4>
<pre><code>##                        Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)           42.620042   1.667226 25.563447 1.926081e-10
## treatment12,13-diHOME -7.167711   2.357813 -3.039982 1.246296e-02
##                           2.5 %    97.5 %
## (Intercept)            38.90523 46.334853
## treatment12,13-diHOME -12.42125 -1.914175</code></pre>
<p>The linear model <a href="linear-models-with-a-single-categorical-x.html#eq:model-cat-serum-tg">(10.3)</a> fit to the serum TG data has three parameters, including two in the regression equation. The “estimates” in the coefficient table are the estimates of the regression parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. These estimates are the coefficients of the fit model</p>
<p><span class="math display" id="eq:fit-serum-tg">\[\begin{equation}
serum\_tg = b_0 + b_1 \beta_1 treatment_{12,13-diHOME} + e
\tag{10.4}
\end{equation}\]</span></p>
<p>The coefficients <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are the two values in the column “Estimate” of the table of model coefficients (or “coefficient table”). In addition to the estimates, the table inlcludes the standard error, 95% confidence interval, and <em>t</em> and <em>p</em>-values of each estimate.</p>
</div>
<div id="the-parameters-of-a-linear-model-using-dummy-coding-have-an-impoortant-interpretation" class="section level4">
<h4><span class="header-section-number">10.1.2.3</span> The parameters of a linear model using dummy coding have an impoortant interpretation</h4>
<p>It is important to understand the interpretation of the coefficients of the fit linear model @(eq:fit-serum-tg). The “coefficient” <span class="math inline">\(b_0\)</span> is the first value in the “Estimate” column of the coefficient table (in the row “(intercept)”). This is the conditional mean of the response for the reference level, which is “Vehicle”. Remember that a conditional mean is the mean of a group that all have the same value for one or more <span class="math inline">\(X\)</span> variables. The coefficient <span class="math inline">\(b_1\)</span> is the second value in the “Estimate” column (in the row “treatment12,13-diHOME”). <span class="math inline">\(b_1\)</span> is the difference between the conditional means of the 12,13-diHOME level and the reference (Vehicle) level. The <em>direction</em> of this difference is important; it is <span class="math inline">\(\bar{Y}_{12,13-diHOME} - \bar{Y}_{Vehicle}\)</span>, that is, the non-reference level minus the reference level. The estimate for treatment12,13-diHOME is the <strong>effect</strong> that we are interested in. Specifically, it is the effect of 12,13-diHOME on serum TG. When we inject 12,13-diHOME, we find the mean serum TG decreases by -7.2 µg/dL relative to the mean serum TG in the mice that were injected with saline. Importantly, the reference level is not a property of an experiment but is set by whomever is analyzing the data. Since the non-reference estimates are differences in means, it often makes sense to set the “control” treatment level as the reference level.</p>
<p>The intercept estimates the true, mean serum TG in a hypothetical population of mice that have been given saline but not 12,13-diHOME. The treatment12,13-diHOME value estimates the true, difference in means between a hypothetical population of mice that have been given 12,13-diHOME and a population that has been given only saline.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>tl;dr. What is a population? In the experimental biology examples in this text, we might consider the population as a very idealized, infinitely large set of mice, or fish, or fruit flies, or communities from which our sample is a reasonably representative subset. For the experiments in the 12,13-diHOME study, the population might be conceived of as the hypothetical, infinitely large set of 12-week-old, male, C57BL/6J mice, raised in the mouse facility at Joslin Diabetes Center. An even more abstract way to way to think about what the population could be is the infinitely large set of values that could generated by the linear model.</p>
</div>
<div class="figure"><span id="fig:unnamed-chunk-172"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-172-1.png" alt="What the coefficients of a linear model with a single categorical X mean. The means of the two treatment levels for the serum TG data are shown with the filled circles. The intercept ($b_0$) is the mean of the reference treatment level. The coefficient $b_1$ is the difference between the treatment level's mean and the reference mean. As with a linear model with a continuous X, the coefficients are effects." width="576" />
<p class="caption">
Figure 10.1: What the coefficients of a linear model with a single categorical X mean. The means of the two treatment levels for the serum TG data are shown with the filled circles. The intercept (<span class="math inline">\(b_0\)</span>) is the mean of the reference treatment level. The coefficient <span class="math inline">\(b_1\)</span> is the difference between the treatment level’s mean and the reference mean. As with a linear model with a continuous X, the coefficients are effects.
</p>
</div>
<p>Let’s put this all together. <span class="math inline">\(b_0\)</span> is the conditional mean of the reference level (“Vehicle”) and is an estimate of <span class="math inline">\(\beta_0\)</span>, the true, conditional mean of the population. <span class="math inline">\(b_1\)</span> is the difference in the conditional means of the first non-reference level (“12,13-diHOME”) and the reference level (“Vehicle”) and is an estimate of <span class="math inline">\(\beta_1\)</span>, the true difference in the conditional means of the population with and without the treatment 12,13-diHOME.</p>
</div>
<div id="the-table-of-marginal-means-is-a-table-of-modeled-means-and-inferential-statistics-not-a-table-of-raw-means-and-inferential-statistics" class="section level4">
<h4><span class="header-section-number">10.1.2.4</span> The table of marginal means is a table of modeled means and inferential statistics, not a table of raw means and inferential statistics</h4>
<p>The table of marginal means for the model fit to the Figure 3d serum TG data is (shown to five decimal places for a later comparison)</p>
<table>
<thead>
<tr class="header">
<th align="left">treatment</th>
<th align="right">emmean</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">lower.CL</th>
<th align="right">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Vehicle</td>
<td align="right">42.62004</td>
<td align="right">1.66723</td>
<td align="right">10</td>
<td align="right">38.90523</td>
<td align="right">46.33485</td>
</tr>
<tr class="even">
<td align="left">12,13-diHOME</td>
<td align="right">35.45233</td>
<td align="right">1.66723</td>
<td align="right">10</td>
<td align="right">31.73752</td>
<td align="right">39.16714</td>
</tr>
</tbody>
</table>
<p>A <strong>marginal mean</strong> is the mean of a set of conditional means and is, consequently, a <strong>modeled mean</strong> (it comes from a model). The table of marginal means (“marginal means table) outputs the specified marginal means and the standard error and 95% confidence interval of each mean. There is no test-statistic with a <em>p</em>-value because there is no significance test. The specified marginal means table of the Figure 3d data is not too exciting because it simply contains the conditional means – the values are not marginalized over any <span class="math inline">\(X\)</span>. In several sections of this text, the marginal means table will contain values that average conditional means over one or more factors. The marginal means table also computes these means as the expected value (mean) at the average value of a continuous covariate, if any covariates are in the linear model. Because the marginal means table contains different sorts of means (conditional, marginal, adjusted), this text will generally refer to the means in this table as”modeled means".</p>
<p>If the design is <strong>balanced</strong>, meaning the sample size for each conditional mean is the same, then a marginal mean will simply equal the average of the individual values. But, this is not the case for unbalanced designs. For example, if we unbalance the Figure 3d data by throwing out the first row of and refit the model, the raw mean of <span class="math inline">\(serum\_tg\)</span> is 38.734 and the marginal mean, marginalized over <span class="math inline">\(treatment\)</span>, is 39.062.</p>
<p>Like the modeled means, the standard errors in the marginal means table are modeled and not raw values. Recall that the standard error of a mean is <span class="math inline">\(\frac{s}{\sqrt{n}}\)</span>, where <span class="math inline">\(s\)</span> is the sample standard deviation. In the marginal means table, <span class="math inline">\(s\)</span> is not the raw standard deviation of the group but the estimate of <span class="math inline">\(\sigma\)</span>, the square root of the true variance. As with the raw standard error of the mean, the denominator is the sample size <span class="math inline">\(n\)</span> for the group. Since the numerator of the modeled SE is the same for all groups, the modeled SE will be the same in all groups that have the same sample size, as seen in the marginal means table for the model fit to the Figure 3d data. This may seem odd. It is not. Remember that an assumption of the linear model is homogeneity of variances – that the <span class="math inline">\(e_i\)</span> for each group are drawn from <span class="math inline">\(N(0, \sigma^2)\)</span> regardless of group. <span class="math inline">\(s^2\)</span>, which is computed as a variance of the model residuals, is an estimate this true variance (<span class="math inline">\(\sigma^2\)</span>). It is also useful to think of the raw variances computed separately for each group (level of <span class="math inline">\(treatment\)</span>) as estimates of <span class="math inline">\(\sigma^2\)</span>. The separately computed estimates are averaged to create a single estimate, which is equal to <span class="math inline">\(s^2\)</span> computed from the model residuals.</p>
<p>Unlike the modeled means, the modeled standard error and confidence interval will, effectively, never equal the raw values.</p>
</div>
<div id="report-the-modeled-means-and-inferential-statistics-from-the-marginal-means-table-not-the-raw-means-and-inferential-statistics" class="section level4">
<h4><span class="header-section-number">10.1.2.5</span> Report the modeled means and inferential statistics from the marginal means table, not the raw means and inferential statistics</h4>
<p>This text advocates the best practice of reporting, including plotting, the modeled means and inferential statistics (SEM or confidence interval) and not the raw means and summary statistics, because only the modeled means and statistics are consistent with the modeled statistical analysis. Raw means and summary statistics can both mask the effects that we want to communicate and give misleading interpretation of the statistics, including the conditional distribution of the data.</p>
<p>The raw, group means and standard errors of each mean of the Figure 3d serum TG are</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="linear-models-with-a-single-categorical-x.html#cb297-1"></a>fig_3d[, .(<span class="dt">mean =</span> <span class="kw">mean</span>(serum_tg),</span>
<span id="cb297-2"><a href="linear-models-with-a-single-categorical-x.html#cb297-2"></a>           <span class="dt">SE =</span> <span class="kw">sd</span>(serum_tg)<span class="op">/</span><span class="kw">sqrt</span>(.N)),</span>
<span id="cb297-3"><a href="linear-models-with-a-single-categorical-x.html#cb297-3"></a>       by =<span class="st"> </span>treatment]</span></code></pre></div>
<pre><code>##       treatment     mean       SE
## 1:      Vehicle 42.62004 1.773251
## 2: 12,13-diHOME 35.45233 1.553984</code></pre>
<p>The raw means are equal to the modeled means but the SE differs.</p>
</div>
<div id="estimates-of-the-effects-are-in-the-contrasts-table" class="section level4">
<h4><span class="header-section-number">10.1.2.6</span> Estimates of the effects are in the contrasts table</h4>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="linear-models-with-a-single-categorical-x.html#cb299-1"></a>fig3d_m1_pairs</span></code></pre></div>
<pre><code>##  contrast               estimate   SE df lower.CL upper.CL t.ratio p.value
##  12,13-diHOME - Vehicle    -7.17 2.36 10    -12.4    -1.91 -3.040  0.0125 
## 
## Confidence level used: 0.95</code></pre>
<p>This table is important for reporting treatment effects and CIs and for plotting the model. A contrast is a difference in means. With only two treatment levels, the table of contrasts doesn’t give any more information than the coefficient table – the single contrast is the coefficient <span class="math inline">\(b_1\)</span> in the coefficient table. Nevertheless, I advocate computing this table to stay consistent and because the script to plot the model uses this table and not the coefficient table.</p>
<p>The values in the column “estimate” is the simple difference of groups given in the contrast column (what you would compute if you simply computed the difference for these groups). This is true for this model, but is not generally true.</p>
<p>The values in the “SE” column are standard errors of a difference (SED), specifically the difference in the estimate column. These SEs are from the fit model using the pooled estimate of <span class="math inline">\(\sigma\)</span>.</p>
<p>The values in the “lower.CL” and “upper.CL” columns are the bounds of the 95% confidence interval of the estimate. This confidence level applies to the procedure and not the estimate. Think of this interval as containing potential values of the true parameter (the true difference in means between the two groups) that are reasonably compatible with the data. More formally, it is correct to interpret this CI as “95% of the CIs computed using this procedure include the true value given the model conditions.”</p>
<p>The columns “t.ratio” and “p.value” contains the <em>t</em> and <em>p</em> values of the significance (not hypothesis!) test of the estimate. The <em>t</em>-statistic is the ratio of the estimate to the SE of the estimate (use the console to confirm this given the values in the table). It is a signal (the estimate) to noise (SE of the estimate) ratio. The <em>p</em>-value is the probability of sampling the same distribution, fiting the linear model, and observing a <em>t</em>-value as or more extreme than the observed <em>t</em>. A very small <em>p</em>-value is consistent with the experiment “not sampling from distributions with the same mean” – meaning that adding a treatment affects the mean of the distribution. This is the logic used to infer a treatment effect. Unfortunately, it is also consistent with the experiment not approximating other conditions of the model, including non-random assignment, non-independence, non-normal conditional responses, and variance heterogeneity. It is up to the rigorous researcher to be sure that these other model conditions are approximated or “good enough” to use the <em>p</em>-value to infer a treatment effect on the mean.</p>
</div>
<div id="t-and-p-from-the-contrasts-table-when-there-are-only-two-levels-in-x-are-the-same-as-t-and-p-from-a-t-test" class="section level4">
<h4><span class="header-section-number">10.1.2.7</span> <em>t</em> and <em>p</em> from the contrasts table – when there are only two levels in <span class="math inline">\(X\)</span> – are the same as <em>t</em> and <em>p</em> from a <em>t</em>-test</h4>
<p>Compare</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="linear-models-with-a-single-categorical-x.html#cb301-1"></a>m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(serum_tg <span class="op">~</span><span class="st"> </span>treatment, <span class="dt">data =</span> fig_3d)</span>
<span id="cb301-2"><a href="linear-models-with-a-single-categorical-x.html#cb301-2"></a>m1_pairs &lt;-<span class="st"> </span><span class="kw">emmeans</span>(m1, <span class="dt">specs =</span> <span class="st">&quot;treatment&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb301-3"><a href="linear-models-with-a-single-categorical-x.html#cb301-3"></a><span class="st">  </span><span class="kw">contrast</span>(<span class="dt">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb301-4"><a href="linear-models-with-a-single-categorical-x.html#cb301-4"></a><span class="st">  </span><span class="kw">summary</span>(<span class="dt">infer =</span> <span class="ot">TRUE</span>)</span>
<span id="cb301-5"><a href="linear-models-with-a-single-categorical-x.html#cb301-5"></a>m1_pairs</span></code></pre></div>
<pre><code>##  contrast               estimate   SE df lower.CL upper.CL t.ratio p.value
##  12,13-diHOME - Vehicle    -7.17 2.36 10    -12.4    -1.91 -3.040  0.0125 
## 
## Confidence level used: 0.95</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="linear-models-with-a-single-categorical-x.html#cb303-1"></a>m2 &lt;-<span class="st"> </span><span class="kw">t.test</span>(serum_tg <span class="op">~</span><span class="st"> </span>treatment,</span>
<span id="cb303-2"><a href="linear-models-with-a-single-categorical-x.html#cb303-2"></a>                <span class="dt">data =</span> fig_3d,</span>
<span id="cb303-3"><a href="linear-models-with-a-single-categorical-x.html#cb303-3"></a>                <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</span>
<span id="cb303-4"><a href="linear-models-with-a-single-categorical-x.html#cb303-4"></a><span class="kw">glance</span>(m2) <span class="co"># glance is from the broom package</span></span></code></pre></div>
<pre><code>## # A tibble: 1 x 10
##   estimate estimate1 estimate2 statistic p.value parameter conf.low
##      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1     7.17      42.6      35.5      3.04  0.0125        10     1.91
## # … with 3 more variables: conf.high &lt;dbl&gt;, method &lt;chr&gt;,
## #   alternative &lt;chr&gt;</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The “statistic” in the output contains the <em>t</em>-value of the <em>t</em>-test. It is equal in magnitude but opposite in sign to that in the contrast table from the linear model. This is because the <code>method = "revpairwise"</code> argument tells the <code>contrast</code> function to use the difference “non-reference mean minus reference mean”, which is the direction I prefer (I like to compare to the reference, which is usually a control)</li>
<li>The “p.value” in the output contains the <em>p</em>-value of the <em>t</em>-test. It is equal to that in the contrast table from the linear model.</li>
<li>The <code>t.test</code> function doesn’t output the estimate of the difference in means, only the estimates of each mean.</li>
<li>The <code>t.test</code> function does give the 95% confidence intervals of the difference in means. Notice that these have the same magnitude but opposite sign of those in the contrast table, for the same reason given in note 1 above.</li>
</ol>
<p>The <em>t</em> and <em>p</em> values for the <em>t</em>-test are the same as those for the linear model, because the <em>t</em>-test is a specific case of the linear model. Reasons to abandon classic <em>t</em>-tests and learn the linear modeling strategy include</p>
<ol style="list-style-type: decimal">
<li>A linear modeling strategy encourages researchers to think about the effect and uncertainty in the effect and not just a <em>p</em>-value.</li>
<li>The linear model is nearly infinitely flexible and expandible while the <em>t</em>-test has extremely limited flexibility.</li>
</ol>
</div>
</div>
<div id="example-2-three-treatment-levels-groups" class="section level3">
<h3><span class="header-section-number">10.1.3</span> Example 2 – three treatment levels (“groups”)</h3>
<p>The data come from the experiment reported in Figure 2a of the 12,13-diHOME article described above. This experiment was designed to probe the hypothesis that 12,13-diHOME is a mediator of known stimulators of increased BAT activity (exposure to cold temperature and sympathetic nervous system activation). Mice were assigned to control (30 °C), one-hour exposure to 4 °C, or 30 minute norepinephrine (NE) treatment level (NE is the neurotransmitter of the sympathetic neurons targeting peripheral tissues).</p>
<p><strong>response variable</strong>: <em>diHOME</em>, the serum concentration of 12,13-diHOME. a continuous variable.</p>
<p><strong>treatment variable</strong>: <em>treatment</em>, with levels: “Control”, “1 hour cold”, "30 min NE. Coded as a factor.</p>
<p><strong>design</strong>: single, categorical <em>X</em></p>
<div id="fit-the-model" class="section level4">
<h4><span class="header-section-number">10.1.3.1</span> fit the model</h4>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="linear-models-with-a-single-categorical-x.html#cb305-1"></a>fig2a_m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(diHOME <span class="op">~</span><span class="st"> </span>treatment, <span class="dt">data =</span> fig2a)</span></code></pre></div>
</div>
<div id="check-the-model" class="section level4">
<h4><span class="header-section-number">10.1.3.2</span> check the model</h4>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="linear-models-with-a-single-categorical-x.html#cb306-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb306-2"><a href="linear-models-with-a-single-categorical-x.html#cb306-2"></a><span class="kw">qqPlot</span>(fig2a_m1)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-182-1.png" width="576" /></p>
<pre><code>## [1]  3 18</code></pre>
<p>The Q-Q plot indicates potential issues at the extreme quantiles, what is called “heavy tails”. The two values are the extreme values in the “30 min NE” group. This could be the result of a small sample from a response with a larger variance.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="linear-models-with-a-single-categorical-x.html#cb308-1"></a><span class="kw">spreadLevelPlot</span>(fig2a_m1, <span class="dt">id=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-183-1.png" width="576" /></p>
<pre><code>## 
## Suggested power transformation:  0.4430799</code></pre>
<p>The combination of the raw residuals and the spread-level plot suggests heterogeneity but low confidence in anything given the small sample size.</p>
</div>
<div id="inference-from-the-model-1" class="section level4">
<h4><span class="header-section-number">10.1.3.3</span> Inference from the model</h4>
<div id="coefficient-table-1" class="section level5">
<h5><span class="header-section-number">10.1.3.3.1</span> Coefficient table</h5>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="linear-models-with-a-single-categorical-x.html#cb310-1"></a>fig2a_m1_coef &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(fig2a_m1)),</span>
<span id="cb310-2"><a href="linear-models-with-a-single-categorical-x.html#cb310-2"></a>                        <span class="kw">confint</span>(fig2a_m1))</span>
<span id="cb310-3"><a href="linear-models-with-a-single-categorical-x.html#cb310-3"></a>fig2a_m1_coef</span></code></pre></div>
<pre><code>##                       Estimate Std. Error  t value    Pr(&gt;|t|)     2.5 %
## (Intercept)          12.023075   3.081337 3.901902 0.001595771  5.414264
## treatment1 hour cold  7.140386   4.570362 1.562324 0.140527829 -2.662066
## treatment30 min NE   14.794354   4.357669 3.395015 0.004355868  5.448083
##                        97.5 %
## (Intercept)          18.63189
## treatment1 hour cold 16.94284
## treatment30 min NE   24.14063</code></pre>
</div>
<div id="marginal-means-table-1" class="section level5">
<h5><span class="header-section-number">10.1.3.3.2</span> Marginal means table</h5>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="linear-models-with-a-single-categorical-x.html#cb312-1"></a>(fig2a_m1_emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(fig2a_m1, <span class="dt">specs =</span> <span class="st">&quot;treatment&quot;</span>))</span></code></pre></div>
<pre><code>##  treatment   emmean   SE df lower.CL upper.CL
##  Control       12.0 3.08 14     5.41     18.6
##  1 hour cold   19.2 3.38 14    11.92     26.4
##  30 min NE     26.8 3.08 14    20.21     33.4
## 
## Confidence level used: 0.95</code></pre>
</div>
<div id="contrasts-table-1" class="section level5">
<h5><span class="header-section-number">10.1.3.3.3</span> Contrasts table</h5>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="linear-models-with-a-single-categorical-x.html#cb314-1"></a>(fig2a_m1_pairs &lt;-<span class="st"> </span><span class="kw">contrast</span>(fig2a_m1_emm,</span>
<span id="cb314-2"><a href="linear-models-with-a-single-categorical-x.html#cb314-2"></a>                            <span class="dt">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb314-3"><a href="linear-models-with-a-single-categorical-x.html#cb314-3"></a>                            <span class="dt">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb314-4"><a href="linear-models-with-a-single-categorical-x.html#cb314-4"></a><span class="st">  </span><span class="kw">summary</span>(<span class="dt">infer =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>##  contrast                estimate   SE df lower.CL upper.CL t.ratio
##  1 hour cold - Control       7.14 4.57 14    -2.66     16.9 1.562  
##  30 min NE - Control        14.79 4.36 14     5.45     24.1 3.395  
##  30 min NE - 1 hour cold     7.65 4.57 14    -2.15     17.5 1.675  
##  p.value
##  0.1405 
##  0.0044 
##  0.1162 
## 
## Confidence level used: 0.95</code></pre>
</div>
</div>
<div id="plot-the-model" class="section level4">
<h4><span class="header-section-number">10.1.3.4</span> plot the model</h4>
<p>The script for plotting the model in the section Hidden code below.</p>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/categorical-x-fig2a-plot-1.png" width="576" /></p>
</div>
<div id="report-the-model-results" class="section level4">
<h4><span class="header-section-number">10.1.3.5</span> Report the model results</h4>
<p>Compared to control mice (12.0 pmol/mL, 95% CI: 5.4, 18.6), mean serum 12,13-diHOME in mice exposed to one-hour cold (19.2 pmol/mL, 95% CI: 11.9, 26.4) was 7.1 pmol/mL higher (95% CI: -2.7, 16.9, <span class="math inline">\(p = 0.14\)</span>) while mean Serum 12,13-diHOME in mice exposed to 30 minutes NE (26.8 pmol/mL, 95% CI: 20.2, 33.3) was 14.8 pmol/mL higher (95% CI: 5.4, 24.1 <span class="math inline">\(p = 0.004\)</span>).</p>
</div>
</div>
<div id="understanding-the-analysis-with-three-or-more-treatment-levels" class="section level3">
<h3><span class="header-section-number">10.1.4</span> Understanding the analysis with three (or more) treatment levels</h3>
<div id="the-coefficient-table" class="section level4">
<h4><span class="header-section-number">10.1.4.1</span> The coefficient table</h4>
<pre><code>##                       Estimate Std. Error  t value    Pr(&gt;|t|)     2.5 %
## (Intercept)          12.023075   3.081337 3.901902 0.001595771  5.414264
## treatment1 hour cold  7.140386   4.570362 1.562324 0.140527829 -2.662066
## treatment30 min NE   14.794354   4.357669 3.395015 0.004355868  5.448083
##                        97.5 %
## (Intercept)          18.63189
## treatment1 hour cold 16.94284
## treatment30 min NE   24.14063</code></pre>
<p>Two understand row names in the first column, its useful to recall the order of the factor levels of <span class="math inline">\(treatment\)</span>, which is</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="linear-models-with-a-single-categorical-x.html#cb317-1"></a><span class="kw">levels</span>(fig2a<span class="op">$</span>treatment) </span></code></pre></div>
<pre><code>## [1] &quot;Control&quot;     &quot;1 hour cold&quot; &quot;30 min NE&quot;</code></pre>
<p>“Control” is the reference level, so the Estimate of the intercept is the mean 12,13diHome for the “Control” mice. The 2nd row of the coefficient table contains the estimate and statistics for the “1 hour cold” level. The estimate (in the column “Estimate”) is the difference in means <span class="math inline">\(\bar{y}_{1\_hour\_cold} - \bar{y}_{Control}\)</span>. The 3rd row contains the estimate and statistics for the “30 min NE” level. The estimate is the difference in means <span class="math inline">\(\bar{y}_{30\_min\_NE} - \bar{y}_{Control}\)</span>.</p>
<p>Let’s put this in the context of the linear model fit to the data.</p>
<p><span class="math display" id="eq:fit-dihome">\[\begin{equation}
diHOME_i = b_0 + b_1 treatment_{1\_hour\_cold,i} + b_2 treatment_{30\_min\_NE,i} + e_i
\tag{10.5}
\end{equation}\]</span></p>
<p>The value in the column “Estimate” for the “(Intercept)” row is <span class="math inline">\(b_0\)</span>, the estimate of <span class="math inline">\(\beta_0\)</span>, the “population” mean of “control” mice. The value in the column “Estimate” for the “treatment1 hour cold” row is <span class="math inline">\(b_1\)</span>, the estimate of <span class="math inline">\(\beta_1\)</span>, the effect of the cold treatment on the response (relative to the control). The value in the column “Estimate” for the “treatment30 min NE” row is <span class="math inline">\(b_1\)</span>, the estimate of <span class="math inline">\(\beta_2\)</span>, the effect of the NE treatment on the response (relative to the control).</p>
<p><span class="math inline">\(treatment_{1\_hour\_cold, i}\)</span> is a dummy-coded indicator variable, containing the number 1, if <span class="math inline">\(i\)</span> is in the “1 hour cold” group, or the number 0, otherwise. <span class="math inline">\(treatment_{30\_min\_NE, i}\)</span> is a dummy-coded indicator variable, containing the number 1, if <span class="math inline">\(i\)</span> is in the “30 min NE” group, or the number 0, otherwise. Importantly, the function <code>lm</code> creates these indicator variables under the hood. You don’t create these but understanding how these are made gives you phenomenal cosmic power (because there are models where you have to construct these manually).</p>
<p>This generalizes to any number of levels of the factor variable. If there are <span class="math inline">\(k\)</span> levels of the factor, there are <span class="math inline">\(k-1\)</span> indicator variables, each with its own coefficient (<span class="math inline">\(b_1\)</span> through <span class="math inline">\(b_{k-1}\)</span>) that estimates the effect of that treatment level relative to the control (if using dummy coding).</p>
<p>As in the example with only two treatment levels above, both <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> are “slopes”. Don’t visualize this as a single line from the control mean through both non-control means but as two lines, each with their own slopes. The numerator of each slope is the difference between that group’s mean and the control mean. The denominator of each slope is 1 (because each has the value 1 when the row is assigned to that group).</p>
<p>The model formula (<code>dihome ~ treatment</code>) used in the <code>lm</code> function is the same, regardless of the number of levels in the factor <span class="math inline">\(treatment\)</span>. This model formula is the verbal form of the fit linear model and is useful for communication, but disconnects the formula from the actual model. For example, it might lead to the confusion on how the model <code>dihome ~ treatment</code> can output an intercept and <em>two</em> coefficients when there is only <em>one</em> <span class="math inline">\(X\)</span> variable. The answer is, this question confuses the verbal formula with the quantitative formula. The model is fit using the quantitative formula which has <span class="math inline">\(3-1=2\)</span> indicator variables resulting in two (non-intercept) coefficients.</p>
</div>
<div id="the-estimated-marginal-means-table" class="section level4">
<h4><span class="header-section-number">10.1.4.2</span> The estimated marginal means table</h4>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="linear-models-with-a-single-categorical-x.html#cb319-1"></a>fig2a_m1_emm</span></code></pre></div>
<pre><code>##  treatment   emmean   SE df lower.CL upper.CL
##  Control       12.0 3.08 14     5.41     18.6
##  1 hour cold   19.2 3.38 14    11.92     26.4
##  30 min NE     26.8 3.08 14    20.21     33.4
## 
## Confidence level used: 0.95</code></pre>
<p>This table is important for reporting means and CIs and for plotting the model. As in example 1, the values in the column “emmean” are the simple means of each group (what you would compute if you simply computed the mean for that group). Again, this is true for this model, but is not generally true. Despite the column label standing for “estimated marginal mean”, these are conditional means – the mean conditional on treatment level.</p>
<p>Also as in example 1, the SE for each mean is <em>not</em> the sample SE but the modeled SE – it is based on a pooled estimate of <span class="math inline">\(\sigma\)</span>. <em>These are the SEs that you should report</em> because it is these SEs that are used to compute the <em>p</em>-value and CI that you report, that is, they tell the same “story”. The SE for the “1 hour cold” group is a bit higher because the sample size <span class="math inline">\(n\)</span> for this group is smaller by 1.</p>
</div>
<div id="the-contrasts-table" class="section level4">
<h4><span class="header-section-number">10.1.4.3</span> The contrasts table</h4>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="linear-models-with-a-single-categorical-x.html#cb321-1"></a>fig2a_m1_pairs</span></code></pre></div>
<pre><code>##  contrast                estimate   SE df lower.CL upper.CL t.ratio
##  1 hour cold - Control       7.14 4.57 14    -2.66     16.9 1.562  
##  30 min NE - Control        14.79 4.36 14     5.45     24.1 3.395  
##  30 min NE - 1 hour cold     7.65 4.57 14    -2.15     17.5 1.675  
##  p.value
##  0.1405 
##  0.0044 
##  0.1162 
## 
## Confidence level used: 0.95</code></pre>
<p>If a factor variable has more than two levels, there are multiple kinds of contrasts that a researcher can compare. The simplest are <strong>pairwise contrasts</strong>, which are differences between group means. These are typically called “post-hoc” tests in hypothesis testing but I avoid that because the focus in this text is estimation.</p>
<p>This table is important for reporting treatment effects and CIs and for plotting the model. As in example 1, the values in the column “estimate” are the simple differences between the means of the groups given in the contrast column (what you would compute if you simply computed the difference for these groups). Again, this is true for this model, but is not generally true.</p>
<p>The values in the “SE” column are standard errors of a difference (SED), specifically the difference in the estimate column. These SEs are from the fit model using the pooled estimate of <span class="math inline">\(\sigma\)</span> and not the SED one would compute if one simply used the two groups in the contrast column. <em>These are the SEs that you should report</em> because it is these SEs that are used to compute the <em>p</em>-value and CI that you report, that is, they tell the same “story”.</p>
<p>The values in the “lower.CL” and “upper.CL” columns are the bounds of the 95% confidence interval of the estimate. Again, this confidence level applies to the procedure and not the estimate. Think of this interval as containing potential values of the true parameter (the true difference in means between the two groups) that are reasonably compatible with the data. More formally, it is correct to interpret this CI as “95% of the CIs computed using this procedure include the true value given the model conditions.”</p>
<p>The columns “t.ratio” and “p.value” contains the <em>t</em> and <em>p</em> values of the significance (not hypothesis!) test of the estimate. The <em>t</em>-statistic is the ratio of the estimate to the SE of the estimate (use the console to confirm this given the values in the table). It is a signal (the estimate) to noise (SE of the estimate) ratio. The <em>p</em>-value is the probability of sampling the same distribution, fiting the linear model, and observing a <em>t</em>-value as or more extreme than the observed <em>t</em>. A very small <em>p</em>-value is consistent with the experiment “not sampling from distributions with the same mean” – meaning that adding a treatment affects the mean of the distribution. This is the logic used to infer a treatment effect. Unfortunately, it is also consistent with the experiment not approximating other conditions of the model, including non-random assignment, non-independence, non-normal conditional responses, and variance heterogeneity. It is up to the rigorous researcher to be sure that these other model conditions are approximated or “good enough” to use the <em>p</em>-value to infer a treatment effect on the mean.</p>
</div>
<div id="t-and-p-from-the-contrasts-table-when-there-are-more-than-two-levels-in-x-are-not-the-same-as-those-from-pairwise-t-tests-among-pairs-of-groups" class="section level4">
<h4><span class="header-section-number">10.1.4.4</span> <em>t</em> and <em>p</em> from the contrasts table – when there are more than two levels in <span class="math inline">\(X\)</span> – are not the same as those from pairwise <em>t</em>-tests among pairs of groups</h4>
<p>The contrasts, CIs, and significance test statistics in the contrasts table come from a single model fit to the data. Researchers commonly fit separate <em>t</em>-tests for each pair of treatment levels instead of a single linear model.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="linear-models-with-a-single-categorical-x.html#cb323-1"></a><span class="co"># classic t-test</span></span>
<span id="cb323-2"><a href="linear-models-with-a-single-categorical-x.html#cb323-2"></a>test1 &lt;-<span class="st"> </span><span class="kw">t.test</span>(fig2a[treatment <span class="op">==</span><span class="st"> &quot;1 hour cold&quot;</span>, diHOME],</span>
<span id="cb323-3"><a href="linear-models-with-a-single-categorical-x.html#cb323-3"></a>       fig2a[treatment <span class="op">==</span><span class="st"> &quot;Control&quot;</span>, diHOME],</span>
<span id="cb323-4"><a href="linear-models-with-a-single-categorical-x.html#cb323-4"></a>       <span class="dt">var.equal=</span><span class="ot">TRUE</span>)</span>
<span id="cb323-5"><a href="linear-models-with-a-single-categorical-x.html#cb323-5"></a></span>
<span id="cb323-6"><a href="linear-models-with-a-single-categorical-x.html#cb323-6"></a>test2 &lt;-<span class="st"> </span><span class="kw">t.test</span>(fig2a[treatment <span class="op">==</span><span class="st"> &quot;30 min NE&quot;</span>, diHOME],</span>
<span id="cb323-7"><a href="linear-models-with-a-single-categorical-x.html#cb323-7"></a>       fig2a[treatment <span class="op">==</span><span class="st"> &quot;Control&quot;</span>, diHOME],</span>
<span id="cb323-8"><a href="linear-models-with-a-single-categorical-x.html#cb323-8"></a>       <span class="dt">var.equal=</span><span class="ot">TRUE</span>)</span>
<span id="cb323-9"><a href="linear-models-with-a-single-categorical-x.html#cb323-9"></a></span>
<span id="cb323-10"><a href="linear-models-with-a-single-categorical-x.html#cb323-10"></a>test3 &lt;-<span class="st"> </span><span class="kw">t.test</span>(fig2a[treatment <span class="op">==</span><span class="st"> &quot;30 min NE&quot;</span>, diHOME],</span>
<span id="cb323-11"><a href="linear-models-with-a-single-categorical-x.html#cb323-11"></a>       fig2a[treatment <span class="op">==</span><span class="st"> &quot;1 hour cold&quot;</span>, diHOME],</span>
<span id="cb323-12"><a href="linear-models-with-a-single-categorical-x.html#cb323-12"></a>       <span class="dt">var.equal=</span><span class="ot">TRUE</span>)</span>
<span id="cb323-13"><a href="linear-models-with-a-single-categorical-x.html#cb323-13"></a></span>
<span id="cb323-14"><a href="linear-models-with-a-single-categorical-x.html#cb323-14"></a>ttests &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">t =</span> <span class="kw">c</span>(test1<span class="op">$</span>statistic, test2<span class="op">$</span>statistic, test3<span class="op">$</span>statistic),</span>
<span id="cb323-15"><a href="linear-models-with-a-single-categorical-x.html#cb323-15"></a>                     <span class="dt">p =</span> <span class="kw">c</span>(test1<span class="op">$</span>p.value, test2<span class="op">$</span>p.value, test3<span class="op">$</span>p.value))</span>
<span id="cb323-16"><a href="linear-models-with-a-single-categorical-x.html#cb323-16"></a><span class="kw">row.names</span>(ttests) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1 hour cold - Control&quot;</span>, </span>
<span id="cb323-17"><a href="linear-models-with-a-single-categorical-x.html#cb323-17"></a>                       <span class="st">&quot;30 min NE - Control&quot;</span>,</span>
<span id="cb323-18"><a href="linear-models-with-a-single-categorical-x.html#cb323-18"></a>                       <span class="st">&quot;30 min NE - 1 hour cold&quot;</span>)</span>
<span id="cb323-19"><a href="linear-models-with-a-single-categorical-x.html#cb323-19"></a>ttests</span></code></pre></div>
<pre><code>##                                t           p
## 1 hour cold - Control   2.415122 0.038920739
## 30 min NE - Control     3.238158 0.008897132
## 30 min NE - 1 hour cold 1.380666 0.200700587</code></pre>
<p>The <em>t</em> and <em>p</em>-values computed from three separate tests differ from the <em>t</em> and <em>p</em>-values computed from the single linear model shown in the contrasts table above. The values differ because the SE in the denominators used to compute the <span class="math inline">\(t\)</span>-values differ. The <em>t</em>-value computed from the linear model use variation in all three groups to estimate <span class="math inline">\(\sigma^2\)</span> the variance of the response conditional on treatment level, and this estimate is commmon to all three <em>t</em>-tests (the SE differs slightly because of sample size differences among levels). The <em>t</em>-value computed from the separate tests each use variation from only the two groups in that test to estimate <span class="math inline">\(\sigma^2\)</span>. Consequently, <span class="math inline">\(\sigma^2\)</span>, and the SE of the estimate, differs for each test.</p>
<p>Using the linear model is a better practice than the pairwise <em>t</em>-tests. The reason is that the <em>t</em>-tests assume homogeneity of variance, that is, the <span class="math inline">\(\sigma^2\)</span> equal in all three groups. And, since a <em>t</em>-test estimates <span class="math inline">\(\sigma^2\)</span>, it is more precise to estimate this using three groups (the linear model) than two groups (the pairwise <em>t</em>-test). And, because the three pairwise <em>t</em>-test computes three estimates of <span class="math inline">\(\sigma^2\)</span>, it is inconsistent to use one estimate in one test and a different estimate in a second test (why would we think the <span class="math inline">\(\sigma^2\)</span> for the Control group is two different values?).</p>
</div>
<div id="the-contrasts-table-when-there-are-more-than-two-levels-in-x-has-multiple-p-values.-how-to-handle-this-multiple-testing-is-highly-controversial" class="section level4">
<h4><span class="header-section-number">10.1.4.5</span> The contrasts table – when there are more than two levels in <span class="math inline">\(X\)</span> – has multiple p-values. How to handle this “multiple testing” is highly controversial</h4>
<p><strong>Multiple testing</strong> is the practice of adjusting <em>p</em>-values (and less commonly confidence intervals) to account for the expected increase in the frequency of Type I error in a batch, or <em>family</em>, of tests. An example of a batch of tests is the three tests in the contrast table for the analysis of the fig2a data. Multiple testing is a concept that exists because of Neyman-Pearson hypothesis testing strategy. My own belief is that the major problem of multiple testing is less the inflation of Type I error and more the idea that we “discover by p-value”. If we focus on effects and uncertainty in experiments where we have good prior knowledge to have reasonable expectations of these effects for the different treatment levels, we shouldn’t be concerned about inflated Type I error. If we use experiments to “see what happens” in tens, hundreds, thousands, or millions of response variables after we perturb the system, then multiple testing is more problematic. Issues surrounding multiple testing are fleshed out in more detail in Chapter xxx “Best Practices”. Computing adjusted values is covered below in the “Working in R” section.</p>
</div>
</div>
</div>
<div id="working-in-r-2" class="section level2">
<h2><span class="header-section-number">10.2</span> Working in R</h2>
<div id="specifying-the-contrasts" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Specifying the contrasts</h3>
</div>
<div id="adjustment-for-multiple-comparisons" class="section level3">
<h3><span class="header-section-number">10.2.2</span> Adjustment for multiple comparisons</h3>
<p>If the head of your group or a reviewer demands that you adjust p-values in data from an experiment like that for the fig2a data, then the <code>adjust</code> argument in <code>emmeans::contrast()</code> controls the method for <em>p</em>-value adjustment. The default is “tukey”.</p>
<ol style="list-style-type: decimal">
<li>“none” – no adjustment, in general my preference.</li>
<li>“tukey” – Tukey’s HSD</li>
<li>“bonferroni” – the standard bonferroni, which is conservative</li>
<li>“fdr” – the false discovery rate</li>
<li>“mvt” – based on the multivariate <em>t</em> distribution and using covariance structure of the variables</li>
</ol>
<p>Here I use the Tukey HSD adjustment, which is a common choice for the “posthoc comparison of means” in experimental data like this. The Tukey adjustment is the default of <code>emmeans::contrast()</code> if the method of comparison is <code>revpairwise</code>, which means that the <code>adjust</code> argument does not need to be specified. That said, explicitly specify the adjustment as this makes the analysis more transparent.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="linear-models-with-a-single-categorical-x.html#cb325-1"></a>(fig2a_m1_pairs_tukey &lt;-<span class="st"> </span><span class="kw">contrast</span>(fig2a_m1_emm,</span>
<span id="cb325-2"><a href="linear-models-with-a-single-categorical-x.html#cb325-2"></a>                            <span class="dt">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb325-3"><a href="linear-models-with-a-single-categorical-x.html#cb325-3"></a>                            <span class="dt">adjust =</span> <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb325-4"><a href="linear-models-with-a-single-categorical-x.html#cb325-4"></a><span class="st">  </span><span class="kw">summary</span>(<span class="dt">infer =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>##  contrast                estimate   SE df lower.CL upper.CL t.ratio
##  1 hour cold - Control       7.14 4.57 14    -4.82     19.1 1.562  
##  30 min NE - Control        14.79 4.36 14     3.39     26.2 3.395  
##  30 min NE - 1 hour cold     7.65 4.57 14    -4.31     19.6 1.675  
##  p.value
##  0.2936 
##  0.0114 
##  0.2490 
## 
## Confidence level used: 0.95 
## Conf-level adjustment: tukey method for comparing a family of 3 estimates 
## P value adjustment: tukey method for comparing a family of 3 estimates</code></pre>
</div>
<div id="plotting-models-with-a-single-categorical-x" class="section level3">
<h3><span class="header-section-number">10.2.3</span> Plotting models with a single, categorical <span class="math inline">\(X\)</span></h3>
<div id="response-plot-sample-means-and-error-bars-using-ggpubr" class="section level4">
<h4><span class="header-section-number">10.2.3.1</span> Response plot – Sample means and error bars using ggpubr</h4>
<p>The package ggpubr makes it very easy to create a publishable plot.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="linear-models-with-a-single-categorical-x.html#cb327-1"></a>gg_good &lt;-<span class="st"> </span><span class="kw">ggstripchart</span>(<span class="dt">data =</span> fig2a,</span>
<span id="cb327-2"><a href="linear-models-with-a-single-categorical-x.html#cb327-2"></a>                    <span class="dt">x =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb327-3"><a href="linear-models-with-a-single-categorical-x.html#cb327-3"></a>                    <span class="dt">y =</span> <span class="st">&quot;diHOME&quot;</span>,</span>
<span id="cb327-4"><a href="linear-models-with-a-single-categorical-x.html#cb327-4"></a>                    <span class="dt">add =</span> <span class="st">&quot;mean_se&quot;</span></span>
<span id="cb327-5"><a href="linear-models-with-a-single-categorical-x.html#cb327-5"></a>)</span>
<span id="cb327-6"><a href="linear-models-with-a-single-categorical-x.html#cb327-6"></a>gg_good</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-195-1.png" width="576" /></p>
<p>With a little work, we can improve this. Note that I’ve changed the error interval from 1 SE to a 95% CI.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="linear-models-with-a-single-categorical-x.html#cb328-1"></a>compare_list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;1 hour cold&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;30 min NE&quot;</span>))</span>
<span id="cb328-2"><a href="linear-models-with-a-single-categorical-x.html#cb328-2"></a></span>
<span id="cb328-3"><a href="linear-models-with-a-single-categorical-x.html#cb328-3"></a>gg_better &lt;-<span class="st"> </span><span class="kw">ggstripchart</span>(<span class="dt">data =</span> fig2a,</span>
<span id="cb328-4"><a href="linear-models-with-a-single-categorical-x.html#cb328-4"></a>                    <span class="dt">x =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb328-5"><a href="linear-models-with-a-single-categorical-x.html#cb328-5"></a>                    <span class="dt">y =</span> <span class="st">&quot;diHOME&quot;</span>,</span>
<span id="cb328-6"><a href="linear-models-with-a-single-categorical-x.html#cb328-6"></a>                    <span class="dt">add =</span> <span class="st">&quot;mean_ci&quot;</span>,</span>
<span id="cb328-7"><a href="linear-models-with-a-single-categorical-x.html#cb328-7"></a>                    <span class="dt">color =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb328-8"><a href="linear-models-with-a-single-categorical-x.html#cb328-8"></a>                    <span class="dt">palette =</span> <span class="st">&quot;jco&quot;</span></span>
<span id="cb328-9"><a href="linear-models-with-a-single-categorical-x.html#cb328-9"></a>) <span class="op">+</span></span>
<span id="cb328-10"><a href="linear-models-with-a-single-categorical-x.html#cb328-10"></a><span class="st">  </span><span class="kw">stat_compare_means</span>(<span class="dt">method =</span> <span class="st">&quot;t.test&quot;</span>,</span>
<span id="cb328-11"><a href="linear-models-with-a-single-categorical-x.html#cb328-11"></a>                     <span class="dt">comparisons=</span>compare_list)</span>
<span id="cb328-12"><a href="linear-models-with-a-single-categorical-x.html#cb328-12"></a></span>
<span id="cb328-13"><a href="linear-models-with-a-single-categorical-x.html#cb328-13"></a>gg_better</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-196-1.png" width="576" /></p>
</div>
<div id="response-plot-modeled-cis-and-custom-p-values-using-ggpubr" class="section level4">
<h4><span class="header-section-number">10.2.3.2</span> Response plot – Modeled CIs and custom p-values using ggpubr</h4>
<p>The CI’s and <em>p</em>-values computed using ggpubr are sample statistics and multiple, independent Welch <em>t</em>-tests and not from the linear model <code>lm(fig2a ~ treatment)</code>. Since the p-values are from Welch <em>t</em>-tests, the CIs and <em>p</em>-values are consistent in that they are using the same models to compute them.</p>
<p>ggpubr and <code>stat_compare_means()</code> have very limited flexibility in the means, CI’s and <em>p</em> values that can be reported in a plot. This raises issues with best practices in this text, which advocates reporting modeled means, CIs and <em>p</em>-values. This includes adjusted <em>p</em>-values, which are not handled by <code>stat_compare_means()</code>. ggpubr has the function <code>stat_pvalue_manual()</code>, which is useful for reporting <em>p</em>-values from tests other than the limited number of tests available in <code>stat_compare_means()</code>. For the model used with fig2a, we can use ggpub to construct the base plot of means and raw values. But with more complex models, we have to skip ggpubr alltogether and use ggplot2 directly.</p>
<p>Step 1 – convert the “emm” (estimated marginal means) and “pairs” (contrast) tables to data.table. The “emm” table is ready after conversion to a data.table but the “pairs” table needs additional columns</p>
<ol style="list-style-type: decimal">
<li>create a column of pretty <em>p</em>-values that are rounded or converted to “&lt; 0.001” if small.</li>
<li>create the group columns containing the pair of groups that are compared. adding <em>p</em>-values to the graph requires a bracket to show which groups are being compared. The column “group1” is added to list the “x value” of the first group. The column “group2” is added to list the “x value” of the second group. The “x value” of a group is the index of the group returned by the <code>levels()</code> function.</li>
</ol>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="linear-models-with-a-single-categorical-x.html#cb329-1"></a><span class="kw">levels</span>(fig2a<span class="op">$</span>treatment)</span></code></pre></div>
<pre><code>## [1] &quot;Control&quot;     &quot;1 hour cold&quot; &quot;30 min NE&quot;</code></pre>
<p>As an example, the contrast in the first row of the contrast table is “1 hour cold - Control”. This is 2 - 1. The first element of Group1 is “2” and the first element of Group2 is “1”. ggpubr will use these columns to construct the brackets.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="linear-models-with-a-single-categorical-x.html#cb331-1"></a>fig2a_m1_emm_dt &lt;-<span class="st"> </span><span class="kw">summary</span>(fig2a_m1_emm) <span class="op">%&gt;%</span></span>
<span id="cb331-2"><a href="linear-models-with-a-single-categorical-x.html#cb331-2"></a><span class="st">  </span>data.table</span>
<span id="cb331-3"><a href="linear-models-with-a-single-categorical-x.html#cb331-3"></a>fig2a_m1_pairs_dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(fig2a_m1_pairs)</span>
<span id="cb331-4"><a href="linear-models-with-a-single-categorical-x.html#cb331-4"></a></span>
<span id="cb331-5"><a href="linear-models-with-a-single-categorical-x.html#cb331-5"></a><span class="co"># pvalString is from package lazyWeave</span></span>
<span id="cb331-6"><a href="linear-models-with-a-single-categorical-x.html#cb331-6"></a>fig2a_m1_pairs_dt[ , p_pretty <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">pvalString</span>(p.value)]</span>
<span id="cb331-7"><a href="linear-models-with-a-single-categorical-x.html#cb331-7"></a><span class="co"># also create a column with &quot;p-val: &quot;</span></span>
<span id="cb331-8"><a href="linear-models-with-a-single-categorical-x.html#cb331-8"></a>fig2a_m1_pairs_dt[ , pval_pretty <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;p-val:&quot;</span>, p_pretty)]</span>
<span id="cb331-9"><a href="linear-models-with-a-single-categorical-x.html#cb331-9"></a></span>
<span id="cb331-10"><a href="linear-models-with-a-single-categorical-x.html#cb331-10"></a><span class="co"># create group columns -- this is needed for p-value brackets</span></span>
<span id="cb331-11"><a href="linear-models-with-a-single-categorical-x.html#cb331-11"></a>fig2a_m1_pairs_dt[, group1 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)]</span>
<span id="cb331-12"><a href="linear-models-with-a-single-categorical-x.html#cb331-12"></a>fig2a_m1_pairs_dt[, group2 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)]</span></code></pre></div>
<p>Step 2 – Add the CIs and <em>p</em>-value to a ggpubr plot</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="linear-models-with-a-single-categorical-x.html#cb332-1"></a>gg_almost_best &lt;-<span class="st"> </span><span class="kw">ggstripchart</span>(<span class="dt">data =</span> fig2a,</span>
<span id="cb332-2"><a href="linear-models-with-a-single-categorical-x.html#cb332-2"></a>                    <span class="dt">x =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb332-3"><a href="linear-models-with-a-single-categorical-x.html#cb332-3"></a>                    <span class="dt">y =</span> <span class="st">&quot;diHOME&quot;</span>,</span>
<span id="cb332-4"><a href="linear-models-with-a-single-categorical-x.html#cb332-4"></a>                    <span class="dt">add =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb332-5"><a href="linear-models-with-a-single-categorical-x.html#cb332-5"></a>                    <span class="dt">color =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb332-6"><a href="linear-models-with-a-single-categorical-x.html#cb332-6"></a>                    <span class="dt">palette =</span> <span class="st">&quot;jco&quot;</span></span>
<span id="cb332-7"><a href="linear-models-with-a-single-categorical-x.html#cb332-7"></a>) <span class="op">+</span></span>
<span id="cb332-8"><a href="linear-models-with-a-single-categorical-x.html#cb332-8"></a><span class="st">  </span></span>
<span id="cb332-9"><a href="linear-models-with-a-single-categorical-x.html#cb332-9"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> fig2a_m1_emm_dt,</span>
<span id="cb332-10"><a href="linear-models-with-a-single-categorical-x.html#cb332-10"></a>                <span class="kw">aes</span>(<span class="dt">y =</span> emmean,</span>
<span id="cb332-11"><a href="linear-models-with-a-single-categorical-x.html#cb332-11"></a>                    <span class="dt">ymin =</span> lower.CL,</span>
<span id="cb332-12"><a href="linear-models-with-a-single-categorical-x.html#cb332-12"></a>                    <span class="dt">ymax =</span> upper.CL,</span>
<span id="cb332-13"><a href="linear-models-with-a-single-categorical-x.html#cb332-13"></a>                    <span class="dt">color =</span> treatment),</span>
<span id="cb332-14"><a href="linear-models-with-a-single-categorical-x.html#cb332-14"></a>                <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb332-15"><a href="linear-models-with-a-single-categorical-x.html#cb332-15"></a><span class="st">  </span></span>
<span id="cb332-16"><a href="linear-models-with-a-single-categorical-x.html#cb332-16"></a><span class="st">  </span><span class="co"># only plotting 1st two p-values</span></span>
<span id="cb332-17"><a href="linear-models-with-a-single-categorical-x.html#cb332-17"></a><span class="st">  </span><span class="kw">stat_pvalue_manual</span>(fig2a_m1_pairs_dt,</span>
<span id="cb332-18"><a href="linear-models-with-a-single-categorical-x.html#cb332-18"></a>                           <span class="dt">label =</span> <span class="st">&quot;p_pretty&quot;</span>, </span>
<span id="cb332-19"><a href="linear-models-with-a-single-categorical-x.html#cb332-19"></a>                           <span class="dt">y.position =</span> <span class="kw">c</span>(<span class="dv">46</span>, <span class="dv">54</span>, <span class="dv">50</span>)) <span class="op">+</span></span>
<span id="cb332-20"><a href="linear-models-with-a-single-categorical-x.html#cb332-20"></a></span>
<span id="cb332-21"><a href="linear-models-with-a-single-categorical-x.html#cb332-21"></a><span class="st">  </span><span class="ot">NULL</span> <span class="co"># add to ease exploring plot components</span></span>
<span id="cb332-22"><a href="linear-models-with-a-single-categorical-x.html#cb332-22"></a>  </span>
<span id="cb332-23"><a href="linear-models-with-a-single-categorical-x.html#cb332-23"></a>gg_almost_best</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-199-1.png" width="576" /></p>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The <code>y.position</code> argument in <code>stat_pvalue_manual()</code> contains the position on the y-axis for the p-value brackets. I typically choose these values “by eye”. Essentially, I look at the maximum y-value on the plot and then choose a value just above this for the first bracket.</li>
<li>All three <em>p</em>-values are shown. In general, all <em>p</em>-values (and means and CIs) should be reported but these can be in a supplemental table. To limit the <em>p</em>-values that are shown, use the row index of a data.table. For example, to show on the <em>p</em>-values with the control, use the following script (note that y.position was also changed to only show the y position of two brackets).</li>
</ol>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="linear-models-with-a-single-categorical-x.html#cb333-1"></a>  <span class="kw">stat_pvalue_manual</span>(fig2a_m1_pairs_dt[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,],</span>
<span id="cb333-2"><a href="linear-models-with-a-single-categorical-x.html#cb333-2"></a>                           <span class="dt">label =</span> <span class="st">&quot;p_pretty&quot;</span>, </span>
<span id="cb333-3"><a href="linear-models-with-a-single-categorical-x.html#cb333-3"></a>                           <span class="dt">y.position =</span> <span class="kw">c</span>(<span class="dv">46</span>, <span class="dv">50</span>))</span></code></pre></div>
<pre><code>## mapping: xmin = ~xmin, xmax = ~xmax, label = ~label, y.position = ~y.position, vjust = ~vjust, group = 1:2, step.increase = c(0, 0), bracket.nudge.y = c(0, 0), bracket.shorten = c(0, 0), x = ~xmin, y = ~y.position 
## geom_bracket: type = text, na.rm = FALSE, coord.flip = FALSE
## stat_bracket: tip.length = 0.03, na.rm = FALSE
## position_identity</code></pre>
</div>
<div id="response-plot-modeled-means-and-cis-using-ggplot2" class="section level4">
<h4><span class="header-section-number">10.2.3.3</span> Response plot – Modeled means and CIs using ggplot2</h4>
<p>The only difference between this and the “gg_almost_best” plot constructed above is that I am using the <code>ggplot</code> function to create the base plot (the axes) and <code>geom_sina</code> to plot the points in place of <code>ggstripchart</code> from the <code>ggpubr</code> package.</p>
<p>Step 1 - Create the data tables “fig2a_m1_emm_dt” and “fig2a_m1_pairs_dt” as above.</p>
<p>Step 2 - plot using the color-blind friendly Okabe-Ito paletter instead of “jco”.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="linear-models-with-a-single-categorical-x.html#cb335-1"></a>gg_response &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> fig2a,</span>
<span id="cb335-2"><a href="linear-models-with-a-single-categorical-x.html#cb335-2"></a>                            <span class="kw">aes</span>(<span class="dt">x =</span> treatment,</span>
<span id="cb335-3"><a href="linear-models-with-a-single-categorical-x.html#cb335-3"></a>                                <span class="dt">y =</span> diHOME,</span>
<span id="cb335-4"><a href="linear-models-with-a-single-categorical-x.html#cb335-4"></a>                                <span class="dt">color =</span> treatment)) <span class="op">+</span></span>
<span id="cb335-5"><a href="linear-models-with-a-single-categorical-x.html#cb335-5"></a><span class="st">  </span><span class="co"># points</span></span>
<span id="cb335-6"><a href="linear-models-with-a-single-categorical-x.html#cb335-6"></a><span class="st">  </span><span class="kw">geom_sina</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="co"># ggforce package</span></span>
<span id="cb335-7"><a href="linear-models-with-a-single-categorical-x.html#cb335-7"></a><span class="st">  </span></span>
<span id="cb335-8"><a href="linear-models-with-a-single-categorical-x.html#cb335-8"></a><span class="st">  </span><span class="co"># plot means and CI</span></span>
<span id="cb335-9"><a href="linear-models-with-a-single-categorical-x.html#cb335-9"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> fig2a_m1_emm_dt,</span>
<span id="cb335-10"><a href="linear-models-with-a-single-categorical-x.html#cb335-10"></a>                <span class="kw">aes</span>(<span class="dt">y =</span> emmean,</span>
<span id="cb335-11"><a href="linear-models-with-a-single-categorical-x.html#cb335-11"></a>                    <span class="dt">ymin =</span> lower.CL,</span>
<span id="cb335-12"><a href="linear-models-with-a-single-categorical-x.html#cb335-12"></a>                    <span class="dt">ymax =</span> upper.CL,</span>
<span id="cb335-13"><a href="linear-models-with-a-single-categorical-x.html#cb335-13"></a>                    <span class="dt">color =</span> treatment),</span>
<span id="cb335-14"><a href="linear-models-with-a-single-categorical-x.html#cb335-14"></a>                <span class="dt">width =</span> <span class="dv">0</span></span>
<span id="cb335-15"><a href="linear-models-with-a-single-categorical-x.html#cb335-15"></a>  ) <span class="op">+</span></span>
<span id="cb335-16"><a href="linear-models-with-a-single-categorical-x.html#cb335-16"></a><span class="st">  </span></span>
<span id="cb335-17"><a href="linear-models-with-a-single-categorical-x.html#cb335-17"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> fig2a_m1_emm_dt,</span>
<span id="cb335-18"><a href="linear-models-with-a-single-categorical-x.html#cb335-18"></a>             <span class="kw">aes</span>(<span class="dt">y =</span> emmean,</span>
<span id="cb335-19"><a href="linear-models-with-a-single-categorical-x.html#cb335-19"></a>                 <span class="dt">color =</span> treatment),</span>
<span id="cb335-20"><a href="linear-models-with-a-single-categorical-x.html#cb335-20"></a>             <span class="dt">size =</span> <span class="dv">3</span></span>
<span id="cb335-21"><a href="linear-models-with-a-single-categorical-x.html#cb335-21"></a>  ) <span class="op">+</span></span>
<span id="cb335-22"><a href="linear-models-with-a-single-categorical-x.html#cb335-22"></a></span>
<span id="cb335-23"><a href="linear-models-with-a-single-categorical-x.html#cb335-23"></a><span class="st">  </span><span class="co"># aesthetics</span></span>
<span id="cb335-24"><a href="linear-models-with-a-single-categorical-x.html#cb335-24"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;12,13-diHOME (pmol/mL)&quot;</span>) <span class="op">+</span></span>
<span id="cb335-25"><a href="linear-models-with-a-single-categorical-x.html#cb335-25"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>pal_okabe_ito,</span>
<span id="cb335-26"><a href="linear-models-with-a-single-categorical-x.html#cb335-26"></a>                     <span class="dt">name =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb335-27"><a href="linear-models-with-a-single-categorical-x.html#cb335-27"></a><span class="st">  </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb335-28"><a href="linear-models-with-a-single-categorical-x.html#cb335-28"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb335-29"><a href="linear-models-with-a-single-categorical-x.html#cb335-29"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb335-30"><a href="linear-models-with-a-single-categorical-x.html#cb335-30"></a><span class="st">  </span></span>
<span id="cb335-31"><a href="linear-models-with-a-single-categorical-x.html#cb335-31"></a><span class="st">  </span><span class="ot">NULL</span></span>
<span id="cb335-32"><a href="linear-models-with-a-single-categorical-x.html#cb335-32"></a></span>
<span id="cb335-33"><a href="linear-models-with-a-single-categorical-x.html#cb335-33"></a><span class="co"># create a version with the p-values. We want the p-valueless version for the combined effects-response plot</span></span>
<span id="cb335-34"><a href="linear-models-with-a-single-categorical-x.html#cb335-34"></a></span>
<span id="cb335-35"><a href="linear-models-with-a-single-categorical-x.html#cb335-35"></a>gg_response_p &lt;-<span class="st"> </span>gg_response <span class="op">+</span><span class="st"> </span></span>
<span id="cb335-36"><a href="linear-models-with-a-single-categorical-x.html#cb335-36"></a><span class="st">      </span><span class="co"># only plotting 1st two p-values</span></span>
<span id="cb335-37"><a href="linear-models-with-a-single-categorical-x.html#cb335-37"></a><span class="st">  </span><span class="kw">stat_pvalue_manual</span>(fig2a_m1_pairs_dt,</span>
<span id="cb335-38"><a href="linear-models-with-a-single-categorical-x.html#cb335-38"></a>                           <span class="dt">label =</span> <span class="st">&quot;p_pretty&quot;</span>, </span>
<span id="cb335-39"><a href="linear-models-with-a-single-categorical-x.html#cb335-39"></a>                           <span class="dt">y.position =</span> <span class="kw">c</span>(<span class="dv">46</span>, <span class="dv">54</span>, <span class="dv">50</span>))</span>
<span id="cb335-40"><a href="linear-models-with-a-single-categorical-x.html#cb335-40"></a></span>
<span id="cb335-41"><a href="linear-models-with-a-single-categorical-x.html#cb335-41"></a>gg_response_p</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-201-1.png" width="576" /></p>
</div>
<div id="effects-plot" class="section level4">
<h4><span class="header-section-number">10.2.3.4</span> Effects plot</h4>
<p>Effects plots commonly use the y-axis for the categorical variable (the contrast pairs) and the x-axis for the continuous variable (the effects). It is important to make sure the order of the plotted contrasts and p-values match!</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="linear-models-with-a-single-categorical-x.html#cb336-1"></a><span class="co"># important -- this insures the order of the contrasts in the plot i</span></span>
<span id="cb336-2"><a href="linear-models-with-a-single-categorical-x.html#cb336-2"></a><span class="co"># the order in the pairs table.</span></span>
<span id="cb336-3"><a href="linear-models-with-a-single-categorical-x.html#cb336-3"></a>contrast_order &lt;-<span class="st"> </span>fig2a_m1_pairs_dt[, contrast]</span>
<span id="cb336-4"><a href="linear-models-with-a-single-categorical-x.html#cb336-4"></a>fig2a_m1_pairs_dt[, contrast <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(contrast, contrast_order)]</span>
<span id="cb336-5"><a href="linear-models-with-a-single-categorical-x.html#cb336-5"></a><span class="co"># labels for plotting contrasts - double check the order</span></span>
<span id="cb336-6"><a href="linear-models-with-a-single-categorical-x.html#cb336-6"></a>fig2a_m1_pairs_dt[, contrast_label <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cold effect&quot;</span>,</span>
<span id="cb336-7"><a href="linear-models-with-a-single-categorical-x.html#cb336-7"></a>                                        <span class="st">&quot;NE effect&quot;</span>,</span>
<span id="cb336-8"><a href="linear-models-with-a-single-categorical-x.html#cb336-8"></a>                                        <span class="st">&quot;NE minus cold&quot;</span>)]</span>
<span id="cb336-9"><a href="linear-models-with-a-single-categorical-x.html#cb336-9"></a></span>
<span id="cb336-10"><a href="linear-models-with-a-single-categorical-x.html#cb336-10"></a>gg_effect &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>fig2a_m1_pairs_dt, </span>
<span id="cb336-11"><a href="linear-models-with-a-single-categorical-x.html#cb336-11"></a>                          <span class="kw">aes</span>(<span class="dt">x =</span> estimate,</span>
<span id="cb336-12"><a href="linear-models-with-a-single-categorical-x.html#cb336-12"></a>                              <span class="dt">y =</span> contrast)) <span class="op">+</span></span>
<span id="cb336-13"><a href="linear-models-with-a-single-categorical-x.html#cb336-13"></a><span class="st">  </span><span class="co"># confidence level of effect</span></span>
<span id="cb336-14"><a href="linear-models-with-a-single-categorical-x.html#cb336-14"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span>lower.CL, </span>
<span id="cb336-15"><a href="linear-models-with-a-single-categorical-x.html#cb336-15"></a>                    <span class="dt">xmax=</span>upper.CL),</span>
<span id="cb336-16"><a href="linear-models-with-a-single-categorical-x.html#cb336-16"></a>                <span class="dt">width=</span><span class="dv">0</span>, </span>
<span id="cb336-17"><a href="linear-models-with-a-single-categorical-x.html#cb336-17"></a>                <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb336-18"><a href="linear-models-with-a-single-categorical-x.html#cb336-18"></a><span class="st">  </span><span class="co"># estimate of effect</span></span>
<span id="cb336-19"><a href="linear-models-with-a-single-categorical-x.html#cb336-19"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb336-20"><a href="linear-models-with-a-single-categorical-x.html#cb336-20"></a><span class="st">  </span></span>
<span id="cb336-21"><a href="linear-models-with-a-single-categorical-x.html#cb336-21"></a><span class="st">  </span><span class="co"># draw a line at effect = 0</span></span>
<span id="cb336-22"><a href="linear-models-with-a-single-categorical-x.html#cb336-22"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb336-23"><a href="linear-models-with-a-single-categorical-x.html#cb336-23"></a><span class="st">  </span></span>
<span id="cb336-24"><a href="linear-models-with-a-single-categorical-x.html#cb336-24"></a><span class="st">  </span><span class="co"># p-value. The y coordinates are set by eye</span></span>
<span id="cb336-25"><a href="linear-models-with-a-single-categorical-x.html#cb336-25"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb336-26"><a href="linear-models-with-a-single-categorical-x.html#cb336-26"></a>           <span class="dt">label =</span> fig2a_m1_pairs_dt<span class="op">$</span>p_pretty,</span>
<span id="cb336-27"><a href="linear-models-with-a-single-categorical-x.html#cb336-27"></a>           <span class="dt">y =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,</span>
<span id="cb336-28"><a href="linear-models-with-a-single-categorical-x.html#cb336-28"></a>           <span class="dt">x =</span> <span class="dv">28</span>) <span class="op">+</span></span>
<span id="cb336-29"><a href="linear-models-with-a-single-categorical-x.html#cb336-29"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb336-30"><a href="linear-models-with-a-single-categorical-x.html#cb336-30"></a>           <span class="dt">label =</span> <span class="st">&quot;p-value&quot;</span>,</span>
<span id="cb336-31"><a href="linear-models-with-a-single-categorical-x.html#cb336-31"></a>           <span class="dt">y =</span> <span class="fl">3.25</span>,</span>
<span id="cb336-32"><a href="linear-models-with-a-single-categorical-x.html#cb336-32"></a>           <span class="dt">x =</span> <span class="dv">28</span>) <span class="op">+</span></span>
<span id="cb336-33"><a href="linear-models-with-a-single-categorical-x.html#cb336-33"></a><span class="st">  </span></span>
<span id="cb336-34"><a href="linear-models-with-a-single-categorical-x.html#cb336-34"></a><span class="st">  </span><span class="co"># # contrast labels</span></span>
<span id="cb336-35"><a href="linear-models-with-a-single-categorical-x.html#cb336-35"></a><span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">labels =</span> fig2a_m1_pairs_dt<span class="op">$</span>contrast_label) <span class="op">+</span></span>
<span id="cb336-36"><a href="linear-models-with-a-single-categorical-x.html#cb336-36"></a><span class="st">  </span></span>
<span id="cb336-37"><a href="linear-models-with-a-single-categorical-x.html#cb336-37"></a><span class="st">  </span><span class="co"># x-axis label and aesthetics</span></span>
<span id="cb336-38"><a href="linear-models-with-a-single-categorical-x.html#cb336-38"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Effects (pmol/mL)&quot;</span>) <span class="op">+</span></span>
<span id="cb336-39"><a href="linear-models-with-a-single-categorical-x.html#cb336-39"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Contrast&quot;</span>) <span class="op">+</span></span>
<span id="cb336-40"><a href="linear-models-with-a-single-categorical-x.html#cb336-40"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">30</span>)) <span class="op">+</span></span>
<span id="cb336-41"><a href="linear-models-with-a-single-categorical-x.html#cb336-41"></a></span>
<span id="cb336-42"><a href="linear-models-with-a-single-categorical-x.html#cb336-42"></a><span class="st">  </span><span class="co"># use ggpubr theme</span></span>
<span id="cb336-43"><a href="linear-models-with-a-single-categorical-x.html#cb336-43"></a><span class="st">  </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb336-44"><a href="linear-models-with-a-single-categorical-x.html#cb336-44"></a><span class="st">  </span></span>
<span id="cb336-45"><a href="linear-models-with-a-single-categorical-x.html#cb336-45"></a><span class="st">  </span><span class="ot">NULL</span></span>
<span id="cb336-46"><a href="linear-models-with-a-single-categorical-x.html#cb336-46"></a></span>
<span id="cb336-47"><a href="linear-models-with-a-single-categorical-x.html#cb336-47"></a>gg_effect</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-202-1.png" width="576" /></p>
</div>
<div id="combined-effects-response-plot" class="section level4">
<h4><span class="header-section-number">10.2.3.5</span> Combined effects-response plot</h4>
<p><code>plot_grid</code> from the cowplot package is used to create a combined effects-response plot by combining the gg_effect and gg_response plots. This looks best if the labels of the x-axis are set to “top” instead of “bottom”. Also we don’t need p-values on both components. The placement of “p-value” in the gg_effect plot above does not look good in the combined plot and I cannot remove this (easily) so I’m rebuilding the gg_effect component from scratch.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="linear-models-with-a-single-categorical-x.html#cb337-1"></a><span class="co"># important -- this insures the order of the contrasts in the plot i</span></span>
<span id="cb337-2"><a href="linear-models-with-a-single-categorical-x.html#cb337-2"></a><span class="co"># the order in the pairs table.</span></span>
<span id="cb337-3"><a href="linear-models-with-a-single-categorical-x.html#cb337-3"></a>contrast_order &lt;-<span class="st"> </span>fig2a_m1_pairs_dt[, contrast]</span>
<span id="cb337-4"><a href="linear-models-with-a-single-categorical-x.html#cb337-4"></a>fig2a_m1_pairs_dt[, contrast <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(contrast, contrast_order)]</span>
<span id="cb337-5"><a href="linear-models-with-a-single-categorical-x.html#cb337-5"></a><span class="co"># labels for plotting contrasts - double check the order</span></span>
<span id="cb337-6"><a href="linear-models-with-a-single-categorical-x.html#cb337-6"></a>fig2a_m1_pairs_dt[, contrast_label <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cold effect&quot;</span>,</span>
<span id="cb337-7"><a href="linear-models-with-a-single-categorical-x.html#cb337-7"></a>                                        <span class="st">&quot;NE effect&quot;</span>,</span>
<span id="cb337-8"><a href="linear-models-with-a-single-categorical-x.html#cb337-8"></a>                                        <span class="st">&quot;NE minus cold&quot;</span>)]</span>
<span id="cb337-9"><a href="linear-models-with-a-single-categorical-x.html#cb337-9"></a></span>
<span id="cb337-10"><a href="linear-models-with-a-single-categorical-x.html#cb337-10"></a>gg_effect &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>fig2a_m1_pairs_dt, </span>
<span id="cb337-11"><a href="linear-models-with-a-single-categorical-x.html#cb337-11"></a>                          <span class="kw">aes</span>(<span class="dt">x =</span> estimate,</span>
<span id="cb337-12"><a href="linear-models-with-a-single-categorical-x.html#cb337-12"></a>                              <span class="dt">y =</span> contrast)) <span class="op">+</span></span>
<span id="cb337-13"><a href="linear-models-with-a-single-categorical-x.html#cb337-13"></a><span class="st">  </span><span class="co"># confidence level of effect</span></span>
<span id="cb337-14"><a href="linear-models-with-a-single-categorical-x.html#cb337-14"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span>lower.CL, </span>
<span id="cb337-15"><a href="linear-models-with-a-single-categorical-x.html#cb337-15"></a>                    <span class="dt">xmax=</span>upper.CL),</span>
<span id="cb337-16"><a href="linear-models-with-a-single-categorical-x.html#cb337-16"></a>                <span class="dt">width=</span><span class="dv">0</span>, </span>
<span id="cb337-17"><a href="linear-models-with-a-single-categorical-x.html#cb337-17"></a>                <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb337-18"><a href="linear-models-with-a-single-categorical-x.html#cb337-18"></a><span class="st">  </span><span class="co"># estimate of effect</span></span>
<span id="cb337-19"><a href="linear-models-with-a-single-categorical-x.html#cb337-19"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb337-20"><a href="linear-models-with-a-single-categorical-x.html#cb337-20"></a><span class="st">  </span></span>
<span id="cb337-21"><a href="linear-models-with-a-single-categorical-x.html#cb337-21"></a><span class="st">  </span><span class="co"># draw a line at effect = 0</span></span>
<span id="cb337-22"><a href="linear-models-with-a-single-categorical-x.html#cb337-22"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb337-23"><a href="linear-models-with-a-single-categorical-x.html#cb337-23"></a><span class="st">  </span></span>
<span id="cb337-24"><a href="linear-models-with-a-single-categorical-x.html#cb337-24"></a><span class="st">  </span><span class="co"># p-value. The y coordinates are set by eye</span></span>
<span id="cb337-25"><a href="linear-models-with-a-single-categorical-x.html#cb337-25"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb337-26"><a href="linear-models-with-a-single-categorical-x.html#cb337-26"></a>           <span class="dt">label =</span> fig2a_m1_pairs_dt<span class="op">$</span>p_pretty,</span>
<span id="cb337-27"><a href="linear-models-with-a-single-categorical-x.html#cb337-27"></a>           <span class="dt">y =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,</span>
<span id="cb337-28"><a href="linear-models-with-a-single-categorical-x.html#cb337-28"></a>           <span class="dt">x =</span> <span class="dv">28</span>) <span class="op">+</span></span>
<span id="cb337-29"><a href="linear-models-with-a-single-categorical-x.html#cb337-29"></a><span class="st">  </span></span>
<span id="cb337-30"><a href="linear-models-with-a-single-categorical-x.html#cb337-30"></a><span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">labels =</span> fig2a_m1_pairs_dt<span class="op">$</span>contrast_label) <span class="op">+</span></span>
<span id="cb337-31"><a href="linear-models-with-a-single-categorical-x.html#cb337-31"></a><span class="st">  </span></span>
<span id="cb337-32"><a href="linear-models-with-a-single-categorical-x.html#cb337-32"></a><span class="st">  </span><span class="co"># x-axis label and aesthetics</span></span>
<span id="cb337-33"><a href="linear-models-with-a-single-categorical-x.html#cb337-33"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Effects (pmol/mL)&quot;</span>) <span class="op">+</span></span>
<span id="cb337-34"><a href="linear-models-with-a-single-categorical-x.html#cb337-34"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Contrast&quot;</span>) <span class="op">+</span></span>
<span id="cb337-35"><a href="linear-models-with-a-single-categorical-x.html#cb337-35"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">30</span>)) <span class="op">+</span></span>
<span id="cb337-36"><a href="linear-models-with-a-single-categorical-x.html#cb337-36"></a><span class="st">  </span></span>
<span id="cb337-37"><a href="linear-models-with-a-single-categorical-x.html#cb337-37"></a><span class="st">  </span><span class="co"># the new code</span></span>
<span id="cb337-38"><a href="linear-models-with-a-single-categorical-x.html#cb337-38"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">28</span>),</span>
<span id="cb337-39"><a href="linear-models-with-a-single-categorical-x.html#cb337-39"></a>                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;-10&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;20&quot;</span>, <span class="st">&quot;p-value&quot;</span>),</span>
<span id="cb337-40"><a href="linear-models-with-a-single-categorical-x.html#cb337-40"></a>                     <span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># move to top</span></span>
<span id="cb337-41"><a href="linear-models-with-a-single-categorical-x.html#cb337-41"></a></span>
<span id="cb337-42"><a href="linear-models-with-a-single-categorical-x.html#cb337-42"></a><span class="st">  </span><span class="co"># use ggpubr theme</span></span>
<span id="cb337-43"><a href="linear-models-with-a-single-categorical-x.html#cb337-43"></a><span class="st">  </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb337-44"><a href="linear-models-with-a-single-categorical-x.html#cb337-44"></a><span class="st">  </span></span>
<span id="cb337-45"><a href="linear-models-with-a-single-categorical-x.html#cb337-45"></a><span class="st">  </span><span class="ot">NULL</span></span></code></pre></div>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="linear-models-with-a-single-categorical-x.html#cb338-1"></a><span class="kw">plot_grid</span>(gg_effect,</span>
<span id="cb338-2"><a href="linear-models-with-a-single-categorical-x.html#cb338-2"></a>          gg_response,</span>
<span id="cb338-3"><a href="linear-models-with-a-single-categorical-x.html#cb338-3"></a>          <span class="dt">nrow=</span><span class="dv">2</span>,</span>
<span id="cb338-4"><a href="linear-models-with-a-single-categorical-x.html#cb338-4"></a>          <span class="dt">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb338-5"><a href="linear-models-with-a-single-categorical-x.html#cb338-5"></a>          <span class="dt">axis =</span> <span class="st">&quot;lr&quot;</span>,</span>
<span id="cb338-6"><a href="linear-models-with-a-single-categorical-x.html#cb338-6"></a>          <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-204-1.png" width="576" /></p>
</div>
</div>
</div>
<div id="issues-in-inference-in-models-with-a-single-categorical-x" class="section level2">
<h2><span class="header-section-number">10.3</span> Issues in inference in models with a single, categorical <span class="math inline">\(X\)</span></h2>
<div id="lack-of-independence" class="section level3">
<h3><span class="header-section-number">10.3.1</span> Lack of independence</h3>
<p>The data from the experiment for Figure 1b of the 12,13-diHOME article outlined above are the plasma concentrations of 12,13-diHOME in humans in response to either saline or one-hour cold challenge. The response variable (<span class="math inline">\(diHOME\)</span>) is not independent because</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="linear-models-with-a-single-categorical-x.html#cb339-1"></a><span class="co"># fit the model</span></span>
<span id="cb339-2"><a href="linear-models-with-a-single-categorical-x.html#cb339-2"></a>m1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(diHOME <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>id), <span class="dt">data =</span> fig1b)</span>
<span id="cb339-3"><a href="linear-models-with-a-single-categorical-x.html#cb339-3"></a></span>
<span id="cb339-4"><a href="linear-models-with-a-single-categorical-x.html#cb339-4"></a><span class="co"># estimated marginal means table</span></span>
<span id="cb339-5"><a href="linear-models-with-a-single-categorical-x.html#cb339-5"></a>m1_emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(m1, <span class="dt">specs =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb339-6"><a href="linear-models-with-a-single-categorical-x.html#cb339-6"></a></span>
<span id="cb339-7"><a href="linear-models-with-a-single-categorical-x.html#cb339-7"></a><span class="co"># contrasts table</span></span>
<span id="cb339-8"><a href="linear-models-with-a-single-categorical-x.html#cb339-8"></a>(m1_pairs &lt;-<span class="st"> </span><span class="kw">contrast</span>(m1_emm,</span>
<span id="cb339-9"><a href="linear-models-with-a-single-categorical-x.html#cb339-9"></a>                     <span class="dt">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb339-10"><a href="linear-models-with-a-single-categorical-x.html#cb339-10"></a><span class="st">  </span><span class="kw">summary</span>(<span class="dt">infer =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>##  contrast      estimate     SE df lower.CL upper.CL t.ratio p.value
##  cold - saline    0.234 0.0549  8    0.108    0.361 4.272   0.0027 
## 
## Degrees-of-freedom method: kenward-roger 
## Confidence level used: 0.95</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="linear-models-with-a-single-categorical-x.html#cb341-1"></a><span class="kw">t.test</span>(<span class="dt">x =</span> fig1b[treatment <span class="op">==</span><span class="st"> &quot;cold&quot;</span>, diHOME],</span>
<span id="cb341-2"><a href="linear-models-with-a-single-categorical-x.html#cb341-2"></a>       <span class="dt">y =</span> fig1b[treatment <span class="op">==</span><span class="st"> &quot;saline&quot;</span>, diHOME],</span>
<span id="cb341-3"><a href="linear-models-with-a-single-categorical-x.html#cb341-3"></a>       <span class="dt">paired =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  fig1b[treatment == &quot;cold&quot;, diHOME] and fig1b[treatment == &quot;saline&quot;, diHOME]
## t = 4.2722, df = 8, p-value = 0.002716
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.1078778 0.3609173
## sample estimates:
## mean of the differences 
##               0.2343975</code></pre>
</div>
<div id="heterogeneity-of-variances" class="section level3">
<h3><span class="header-section-number">10.3.2</span> Heterogeneity of variances</h3>
<p>Textbooks that use a “which test?” strategy often point to a Welch’s <em>t</em>-test in place of Student’s <em>t</em>-test if there is heterogeneity of variances between treatment groups. A Welch t-test is infrequent in the experimental biology literature, perhaps because</p>
<ol style="list-style-type: decimal">
<li>it is poorly known and it doesn’t occur to researchers to use a test that models heterogeneity of variances.</li>
<li>many experiments have more than two levels, or are factorial, and these are often analyzed with ANOVA instead of multiple <em>t</em>-tests.</li>
<li>heterogeneity often arises in right-skewed data, which is often analyzed with a non-parametric test like the Mann-Whitney U test.</li>
</ol>
<p>The Welch <em>t</em>-test is a special case of a linear model that explicitly models the within-group variance using <strong>generalized least squares</strong> (GLS). The 95% CI of a mean differences and <em>p</em>-values from the fit gls linear model and from Welch’s t-test are the same. Advantages of using a linear modeling strategy is that a researcher uses the model to estimate effects (difference in means) and measures of uncertainty in the effects (standard errors or confidence intervals of the difference). Advantages of specifically using the gls extension of the linear model is that it is it can be easily expanded to analyze more complex designs including 1) more than two treatment groups, 2) more than one factor, and 3) additional covariates.</p>
<p>Modeling variance heterogenity is the focus of chapter xxx so the account here is brief. Heterogeneity can be modeled using a generalized least squares linear model with the <code>gls</code> function. The <code>weights</code> argument is used to model the variances using each group’s sample variance. In this example, I use the data from the Figure 1b experiment, which can be compared to the analysis of the same data in Example 2 above.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="linear-models-with-a-single-categorical-x.html#cb343-1"></a>subdata &lt;-<span class="st"> </span>fig2a[<span class="kw">is.na</span>(diHOME) <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>,] <span class="co"># omit rows with missing data</span></span>
<span id="cb343-2"><a href="linear-models-with-a-single-categorical-x.html#cb343-2"></a>fig2a_m2 &lt;-<span class="st"> </span><span class="kw">gls</span>(diHOME <span class="op">~</span><span class="st"> </span>treatment,</span>
<span id="cb343-3"><a href="linear-models-with-a-single-categorical-x.html#cb343-3"></a>                <span class="dt">data =</span> subdata,</span>
<span id="cb343-4"><a href="linear-models-with-a-single-categorical-x.html#cb343-4"></a>                <span class="dt">weights =</span> <span class="kw">varIdent</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>treatment))</span></code></pre></div>
<p>The model fig2a_m2 uses variance computed in each group separately as the estimate of <span class="math inline">\(\sigma^2\)</span> for that group. The coefficient table of the GLS model is</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="linear-models-with-a-single-categorical-x.html#cb344-1"></a><span class="kw">summary</span>(fig2a_m2) <span class="op">%&gt;%</span></span>
<span id="cb344-2"><a href="linear-models-with-a-single-categorical-x.html#cb344-2"></a><span class="st">  </span><span class="kw">coef</span>()</span></code></pre></div>
<pre><code>##                          Value Std.Error   t-value      p-value
## (Intercept)          12.023075  1.200139 10.018072 9.134757e-08
## treatment1 hour cold  7.140386  3.163467  2.257139 4.050473e-02
## treatment30 min NE   14.794354  4.568757  3.238157 5.951274e-03</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li><strong>Important</strong> for reporting <em>p</em>-values. Unlike the linear model modeling homogenous variance, the <em>p</em>-values for the coefficients of <span class="math inline">\(treatment1\;hour\;cold\)</span> and <span class="math inline">\(treatment30\;min\;NE\)</span> are <em>not</em> the same as the <em>p</em>-values of these equivalent contrasts in the contrasts table (see below). The reason is, the computation of the <em>p</em>-value in the two tables use two different degrees of freedom. Report the <em>p</em>-values from the contrast table using the Satterthwaite df.</li>
</ol>
<p>The modeled means and contrasts are computed as above for the <code>lm</code> object</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="linear-models-with-a-single-categorical-x.html#cb346-1"></a>fig2a_m2_emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(fig2a_m2, <span class="dt">specs=</span><span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb346-2"><a href="linear-models-with-a-single-categorical-x.html#cb346-2"></a>fig2a_m2_emm</span></code></pre></div>
<pre><code>##  treatment   emmean   SE df lower.CL upper.CL
##  Control       12.0 1.20  5     8.94     15.1
##  1 hour cold   19.2 2.93  4    11.04     27.3
##  30 min NE     26.8 4.41  5    15.49     38.1
## 
## Degrees-of-freedom method: satterthwaite 
## Confidence level used: 0.95</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The SE of the means in this table are modeled SEs but are equal to the sample SE of the means, because this was specified in the GLS model.</li>
</ol>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="linear-models-with-a-single-categorical-x.html#cb348-1"></a>fig2a_m2_pairs &lt;-<span class="st">  </span><span class="kw">contrast</span>(fig2a_m2_emm,</span>
<span id="cb348-2"><a href="linear-models-with-a-single-categorical-x.html#cb348-2"></a>                            <span class="dt">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb348-3"><a href="linear-models-with-a-single-categorical-x.html#cb348-3"></a>                            <span class="dt">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb348-4"><a href="linear-models-with-a-single-categorical-x.html#cb348-4"></a><span class="st">  </span><span class="kw">summary</span>(<span class="dt">infer =</span> <span class="ot">TRUE</span>)</span>
<span id="cb348-5"><a href="linear-models-with-a-single-categorical-x.html#cb348-5"></a>fig2a_m2_pairs</span></code></pre></div>
<pre><code>##  contrast                estimate   SE   df lower.CL upper.CL t.ratio
##  1 hour cold - Control       7.14 3.16 5.34   -0.839     15.1 2.257  
##  30 min NE - Control        14.79 4.57 5.74    3.490     26.1 3.238  
##  30 min NE - 1 hour cold     7.65 5.29 8.35   -4.460     19.8 1.446  
##  p.value
##  0.0703 
##  0.0189 
##  0.1845 
## 
## Degrees-of-freedom method: satterthwaite 
## Confidence level used: 0.95</code></pre>
<p>Compare this table to the three Welch <em>t</em>-tests of all pairs of treatment levels in the fig2a experiment.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="linear-models-with-a-single-categorical-x.html#cb350-1"></a>test1 &lt;-<span class="st"> </span><span class="kw">t.test</span>(fig2a[treatment <span class="op">==</span><span class="st"> &quot;1 hour cold&quot;</span>, diHOME],</span>
<span id="cb350-2"><a href="linear-models-with-a-single-categorical-x.html#cb350-2"></a>       fig2a[treatment <span class="op">==</span><span class="st"> &quot;Control&quot;</span>, diHOME],</span>
<span id="cb350-3"><a href="linear-models-with-a-single-categorical-x.html#cb350-3"></a>       <span class="dt">var.equal=</span><span class="ot">FALSE</span>)</span>
<span id="cb350-4"><a href="linear-models-with-a-single-categorical-x.html#cb350-4"></a></span>
<span id="cb350-5"><a href="linear-models-with-a-single-categorical-x.html#cb350-5"></a>test2 &lt;-<span class="st"> </span><span class="kw">t.test</span>(fig2a[treatment <span class="op">==</span><span class="st"> &quot;30 min NE&quot;</span>, diHOME],</span>
<span id="cb350-6"><a href="linear-models-with-a-single-categorical-x.html#cb350-6"></a>       fig2a[treatment <span class="op">==</span><span class="st"> &quot;Control&quot;</span>, diHOME],</span>
<span id="cb350-7"><a href="linear-models-with-a-single-categorical-x.html#cb350-7"></a>       <span class="dt">var.equal=</span><span class="ot">FALSE</span>)</span>
<span id="cb350-8"><a href="linear-models-with-a-single-categorical-x.html#cb350-8"></a></span>
<span id="cb350-9"><a href="linear-models-with-a-single-categorical-x.html#cb350-9"></a>test3 &lt;-<span class="st"> </span><span class="kw">t.test</span>(fig2a[treatment <span class="op">==</span><span class="st"> &quot;30 min NE&quot;</span>, diHOME],</span>
<span id="cb350-10"><a href="linear-models-with-a-single-categorical-x.html#cb350-10"></a>       fig2a[treatment <span class="op">==</span><span class="st"> &quot;1 hour cold&quot;</span>, diHOME],</span>
<span id="cb350-11"><a href="linear-models-with-a-single-categorical-x.html#cb350-11"></a>       <span class="dt">var.equal=</span><span class="ot">FALSE</span>)</span>
<span id="cb350-12"><a href="linear-models-with-a-single-categorical-x.html#cb350-12"></a></span>
<span id="cb350-13"><a href="linear-models-with-a-single-categorical-x.html#cb350-13"></a>welch_tests &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">t =</span> <span class="kw">c</span>(test1<span class="op">$</span>statistic, test2<span class="op">$</span>statistic, test3<span class="op">$</span>statistic),</span>
<span id="cb350-14"><a href="linear-models-with-a-single-categorical-x.html#cb350-14"></a>                     <span class="dt">p =</span> <span class="kw">c</span>(test1<span class="op">$</span>p.value, test2<span class="op">$</span>p.value, test3<span class="op">$</span>p.value))</span>
<span id="cb350-15"><a href="linear-models-with-a-single-categorical-x.html#cb350-15"></a><span class="kw">row.names</span>(welch_tests) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1 hour cold - Control&quot;</span>, </span>
<span id="cb350-16"><a href="linear-models-with-a-single-categorical-x.html#cb350-16"></a>                       <span class="st">&quot;30 min NE - Control&quot;</span>,</span>
<span id="cb350-17"><a href="linear-models-with-a-single-categorical-x.html#cb350-17"></a>                       <span class="st">&quot;30 min NE - 1 hour cold&quot;</span>)</span>
<span id="cb350-18"><a href="linear-models-with-a-single-categorical-x.html#cb350-18"></a>welch_tests</span></code></pre></div>
<pre><code>##                                t          p
## 1 hour cold - Control   2.257139 0.07026220
## 30 min NE - Control     3.238158 0.01889041
## 30 min NE - 1 hour cold 1.446454 0.18451549</code></pre>
<p>The <em>t</em> and <em>p</em>-values computed from the GLS linear model and from the three, pairwise Welch <em>t</em>-tests are the same (to about the 6th decimal place). They are the same because each is estimating <span class="math inline">\(\sigma^2\)</span> separately for each group and not as the pooled (among two groups for <em>t</em>-test or three groups for the linear model) estimate and because they use the same degrees of freedom to compute the <em>p</em>-value.</p>
<p>Let’s summarize these comparisons</p>
<ol style="list-style-type: decimal">
<li>Inference from a linear model using homogenous variance (the <code>lm</code> function) and from a Student’s <em>t</em>-test are the same if there are only two levels in the treatment variable.</li>
<li>Inference from a linear model using homogenous variance (the <code>lm</code> function) and from the series of pairwise, Student’s <em>t</em>-tests differ when there are more than two levels in the treatment variable.</li>
<li>Inference from a GLS linear model using heterogenous variance (the <code>gls</code> function) and from a Welch <em>t</em>-test are the same regardless of the number of levels in the treatment variable.</li>
</ol>
<p>Even though the linear model that models heterogeneity and the Welch <em>t</em>-test produce the same results, researchers should use the linear model because</p>
<ol style="list-style-type: decimal">
<li>A linear modeling strategy encourages researchers to think about the effect and uncertainty in the effect and not just a <em>p</em>-value.</li>
<li>The linear model is nearly infinitely flexible and expandible while the <em>t</em>-test has extremely limited flexibility (The Welch <em>t</em>-test is one way to expand the classical, Student’s <em>t</em>-test).</li>
</ol>
</div>
<div id="the-conditional-response-isnt-normal" class="section level3">
<h3><span class="header-section-number">10.3.3</span> The conditional response isn’t Normal</h3>
</div>
<div id="pre-post-designs" class="section level3">
<h3><span class="header-section-number">10.3.4</span> Pre-post designs</h3>
</div>
<div id="longitudinal-designs" class="section level3">
<h3><span class="header-section-number">10.3.5</span> Longitudinal designs</h3>
</div>
<div id="comparing-responses-normalized-to-a-standard" class="section level3">
<h3><span class="header-section-number">10.3.6</span> Comparing responses normalized to a standard</h3>
</div>
<div id="comparing-responses-that-are-ratios" class="section level3">
<h3><span class="header-section-number">10.3.7</span> Comparing responses that are ratios</h3>
</div>
<div id="researcher-degrees-of-freedom" class="section level3">
<h3><span class="header-section-number">10.3.8</span> Researcher degrees of freedom</h3>
<p>Conspicuously, the <em>p</em>-value for the “1 hour cold - Control” contrast is 0.039, which is “significant” using the conventional</p>
</div>
</div>
<div id="hidden-code-1" class="section level2">
<h2><span class="header-section-number">10.4</span> Hidden Code</h2>
<div id="fig2a-data" class="section level3">
<h3><span class="header-section-number">10.4.1</span> fig2a data</h3>
<p>The script for plotting the model in the section Hidden code below.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="linear-models-with-a-single-categorical-x.html#cb352-1"></a>fig2a_m1_emm_dt &lt;-<span class="st"> </span><span class="kw">summary</span>(fig2a_m1_emm) <span class="op">%&gt;%</span></span>
<span id="cb352-2"><a href="linear-models-with-a-single-categorical-x.html#cb352-2"></a><span class="st">  </span>data.table</span>
<span id="cb352-3"><a href="linear-models-with-a-single-categorical-x.html#cb352-3"></a>fig2a_m1_pairs_dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(fig2a_m1_pairs)</span>
<span id="cb352-4"><a href="linear-models-with-a-single-categorical-x.html#cb352-4"></a>fig2a_m1_pairs_dt[ , p_pretty <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">pvalString</span>(p.value)]</span></code></pre></div>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="linear-models-with-a-single-categorical-x.html#cb353-1"></a>fig2a_gg_response &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> fig2a,</span>
<span id="cb353-2"><a href="linear-models-with-a-single-categorical-x.html#cb353-2"></a>                            <span class="kw">aes</span>(<span class="dt">x =</span> treatment,</span>
<span id="cb353-3"><a href="linear-models-with-a-single-categorical-x.html#cb353-3"></a>                                <span class="dt">y =</span> diHOME,</span>
<span id="cb353-4"><a href="linear-models-with-a-single-categorical-x.html#cb353-4"></a>                                <span class="dt">color =</span> treatment)) <span class="op">+</span></span>
<span id="cb353-5"><a href="linear-models-with-a-single-categorical-x.html#cb353-5"></a><span class="st">  </span></span>
<span id="cb353-6"><a href="linear-models-with-a-single-categorical-x.html#cb353-6"></a><span class="st">  </span><span class="co"># points</span></span>
<span id="cb353-7"><a href="linear-models-with-a-single-categorical-x.html#cb353-7"></a><span class="st">  </span><span class="kw">geom_sina</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb353-8"><a href="linear-models-with-a-single-categorical-x.html#cb353-8"></a><span class="st">  </span></span>
<span id="cb353-9"><a href="linear-models-with-a-single-categorical-x.html#cb353-9"></a><span class="st">  </span><span class="co"># plot means and CI</span></span>
<span id="cb353-10"><a href="linear-models-with-a-single-categorical-x.html#cb353-10"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> fig2a_m1_emm_dt,</span>
<span id="cb353-11"><a href="linear-models-with-a-single-categorical-x.html#cb353-11"></a>                <span class="kw">aes</span>(<span class="dt">y =</span> emmean,</span>
<span id="cb353-12"><a href="linear-models-with-a-single-categorical-x.html#cb353-12"></a>                    <span class="dt">ymin =</span> lower.CL,</span>
<span id="cb353-13"><a href="linear-models-with-a-single-categorical-x.html#cb353-13"></a>                    <span class="dt">ymax =</span> upper.CL,</span>
<span id="cb353-14"><a href="linear-models-with-a-single-categorical-x.html#cb353-14"></a>                    <span class="dt">color =</span> treatment),</span>
<span id="cb353-15"><a href="linear-models-with-a-single-categorical-x.html#cb353-15"></a>                <span class="dt">width =</span> <span class="dv">0</span></span>
<span id="cb353-16"><a href="linear-models-with-a-single-categorical-x.html#cb353-16"></a>  ) <span class="op">+</span></span>
<span id="cb353-17"><a href="linear-models-with-a-single-categorical-x.html#cb353-17"></a><span class="st">  </span></span>
<span id="cb353-18"><a href="linear-models-with-a-single-categorical-x.html#cb353-18"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> fig2a_m1_emm_dt,</span>
<span id="cb353-19"><a href="linear-models-with-a-single-categorical-x.html#cb353-19"></a>             <span class="kw">aes</span>(<span class="dt">y =</span> emmean,</span>
<span id="cb353-20"><a href="linear-models-with-a-single-categorical-x.html#cb353-20"></a>                 <span class="dt">color =</span> treatment),</span>
<span id="cb353-21"><a href="linear-models-with-a-single-categorical-x.html#cb353-21"></a>             <span class="dt">size =</span> <span class="dv">3</span></span>
<span id="cb353-22"><a href="linear-models-with-a-single-categorical-x.html#cb353-22"></a>  ) <span class="op">+</span></span>
<span id="cb353-23"><a href="linear-models-with-a-single-categorical-x.html#cb353-23"></a></span>
<span id="cb353-24"><a href="linear-models-with-a-single-categorical-x.html#cb353-24"></a><span class="st">  </span><span class="co"># aesthetics</span></span>
<span id="cb353-25"><a href="linear-models-with-a-single-categorical-x.html#cb353-25"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;12,13-diHOME (pmol/mL)&quot;</span>) <span class="op">+</span></span>
<span id="cb353-26"><a href="linear-models-with-a-single-categorical-x.html#cb353-26"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>pal_okabe_ito,</span>
<span id="cb353-27"><a href="linear-models-with-a-single-categorical-x.html#cb353-27"></a>                     <span class="dt">name =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb353-28"><a href="linear-models-with-a-single-categorical-x.html#cb353-28"></a><span class="st">  </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb353-29"><a href="linear-models-with-a-single-categorical-x.html#cb353-29"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb353-30"><a href="linear-models-with-a-single-categorical-x.html#cb353-30"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb353-31"><a href="linear-models-with-a-single-categorical-x.html#cb353-31"></a><span class="st">  </span></span>
<span id="cb353-32"><a href="linear-models-with-a-single-categorical-x.html#cb353-32"></a><span class="st">  </span><span class="ot">NULL</span></span>
<span id="cb353-33"><a href="linear-models-with-a-single-categorical-x.html#cb353-33"></a></span>
<span id="cb353-34"><a href="linear-models-with-a-single-categorical-x.html#cb353-34"></a><span class="co">#fig2a_gg_response</span></span></code></pre></div>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="linear-models-with-a-single-categorical-x.html#cb354-1"></a><span class="co"># reverse order of rows so flipped plot has original order</span></span>
<span id="cb354-2"><a href="linear-models-with-a-single-categorical-x.html#cb354-2"></a>fig2a_m1_pairs_dt &lt;-<span class="st"> </span>fig2a_m1_pairs_dt[<span class="kw">rev</span>(<span class="dv">1</span><span class="op">:</span>.N)]</span>
<span id="cb354-3"><a href="linear-models-with-a-single-categorical-x.html#cb354-3"></a></span>
<span id="cb354-4"><a href="linear-models-with-a-single-categorical-x.html#cb354-4"></a><span class="co"># order &quot;contrast&quot; factor as in table!</span></span>
<span id="cb354-5"><a href="linear-models-with-a-single-categorical-x.html#cb354-5"></a>contrast_order &lt;-<span class="st"> </span>fig2a_m1_pairs_dt[, contrast]</span>
<span id="cb354-6"><a href="linear-models-with-a-single-categorical-x.html#cb354-6"></a>fig2a_m1_pairs_dt[, contrast <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(contrast, contrast_order)]</span>
<span id="cb354-7"><a href="linear-models-with-a-single-categorical-x.html#cb354-7"></a></span>
<span id="cb354-8"><a href="linear-models-with-a-single-categorical-x.html#cb354-8"></a>min_bound &lt;-<span class="st"> </span><span class="kw">min</span>(fig2a_m1_pairs_dt[, lower.CL])</span>
<span id="cb354-9"><a href="linear-models-with-a-single-categorical-x.html#cb354-9"></a>max_bound &lt;-<span class="st"> </span><span class="kw">min</span>(fig2a_m1_pairs_dt[, upper.CL])</span>
<span id="cb354-10"><a href="linear-models-with-a-single-categorical-x.html#cb354-10"></a>y_lo &lt;-<span class="st"> </span><span class="kw">min</span>(min_bound<span class="op">+</span>min_bound<span class="op">*</span><span class="fl">0.2</span>,</span>
<span id="cb354-11"><a href="linear-models-with-a-single-categorical-x.html#cb354-11"></a>            <span class="op">-</span>max_bound)</span>
<span id="cb354-12"><a href="linear-models-with-a-single-categorical-x.html#cb354-12"></a>y_hi &lt;-<span class="st"> </span><span class="kw">max</span>(max_bound <span class="op">+</span><span class="st"> </span>max_bound<span class="op">*</span><span class="fl">0.2</span>,</span>
<span id="cb354-13"><a href="linear-models-with-a-single-categorical-x.html#cb354-13"></a>            <span class="op">-</span>min_bound)</span>
<span id="cb354-14"><a href="linear-models-with-a-single-categorical-x.html#cb354-14"></a>y_lims &lt;-<span class="st"> </span><span class="kw">c</span>(y_lo, y_hi)</span>
<span id="cb354-15"><a href="linear-models-with-a-single-categorical-x.html#cb354-15"></a></span>
<span id="cb354-16"><a href="linear-models-with-a-single-categorical-x.html#cb354-16"></a>fig2a_gg_effect &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>fig2a_m1_pairs_dt, </span>
<span id="cb354-17"><a href="linear-models-with-a-single-categorical-x.html#cb354-17"></a>                          <span class="kw">aes</span>(<span class="dt">x =</span> contrast,</span>
<span id="cb354-18"><a href="linear-models-with-a-single-categorical-x.html#cb354-18"></a>                              <span class="dt">y =</span> estimate)) <span class="op">+</span></span>
<span id="cb354-19"><a href="linear-models-with-a-single-categorical-x.html#cb354-19"></a><span class="st">  </span><span class="co"># confidence level of effect</span></span>
<span id="cb354-20"><a href="linear-models-with-a-single-categorical-x.html#cb354-20"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>lower.CL, </span>
<span id="cb354-21"><a href="linear-models-with-a-single-categorical-x.html#cb354-21"></a>                    <span class="dt">ymax=</span>upper.CL),</span>
<span id="cb354-22"><a href="linear-models-with-a-single-categorical-x.html#cb354-22"></a>                <span class="dt">width=</span><span class="dv">0</span>, </span>
<span id="cb354-23"><a href="linear-models-with-a-single-categorical-x.html#cb354-23"></a>                <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb354-24"><a href="linear-models-with-a-single-categorical-x.html#cb354-24"></a><span class="st">  </span><span class="co"># estimate of effect</span></span>
<span id="cb354-25"><a href="linear-models-with-a-single-categorical-x.html#cb354-25"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb354-26"><a href="linear-models-with-a-single-categorical-x.html#cb354-26"></a><span class="st">  </span></span>
<span id="cb354-27"><a href="linear-models-with-a-single-categorical-x.html#cb354-27"></a><span class="st">  </span><span class="co"># zero effect</span></span>
<span id="cb354-28"><a href="linear-models-with-a-single-categorical-x.html#cb354-28"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb354-29"><a href="linear-models-with-a-single-categorical-x.html#cb354-29"></a><span class="st">  </span></span>
<span id="cb354-30"><a href="linear-models-with-a-single-categorical-x.html#cb354-30"></a><span class="st">  </span><span class="co"># p-value</span></span>
<span id="cb354-31"><a href="linear-models-with-a-single-categorical-x.html#cb354-31"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb354-32"><a href="linear-models-with-a-single-categorical-x.html#cb354-32"></a>           <span class="dt">label =</span> fig2a_m1_pairs_dt<span class="op">$</span>p_pretty,</span>
<span id="cb354-33"><a href="linear-models-with-a-single-categorical-x.html#cb354-33"></a>           <span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,</span>
<span id="cb354-34"><a href="linear-models-with-a-single-categorical-x.html#cb354-34"></a>           <span class="dt">y =</span> <span class="dv">-10</span>) <span class="op">+</span></span>
<span id="cb354-35"><a href="linear-models-with-a-single-categorical-x.html#cb354-35"></a><span class="st">  </span></span>
<span id="cb354-36"><a href="linear-models-with-a-single-categorical-x.html#cb354-36"></a><span class="st">  </span><span class="co"># aesthetics</span></span>
<span id="cb354-37"><a href="linear-models-with-a-single-categorical-x.html#cb354-37"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">position=</span><span class="st">&quot;right&quot;</span>) <span class="op">+</span></span>
<span id="cb354-38"><a href="linear-models-with-a-single-categorical-x.html#cb354-38"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;NE minus cold&quot;</span>,</span>
<span id="cb354-39"><a href="linear-models-with-a-single-categorical-x.html#cb354-39"></a>                              <span class="st">&quot;NE effect&quot;</span>,</span>
<span id="cb354-40"><a href="linear-models-with-a-single-categorical-x.html#cb354-40"></a>                              <span class="st">&quot;cold effect&quot;</span></span>
<span id="cb354-41"><a href="linear-models-with-a-single-categorical-x.html#cb354-41"></a>  )) <span class="op">+</span></span>
<span id="cb354-42"><a href="linear-models-with-a-single-categorical-x.html#cb354-42"></a><span class="st">  </span><span class="kw">coord_flip</span>(<span class="dt">ylim =</span> y_lims) <span class="op">+</span><span class="st"> </span></span>
<span id="cb354-43"><a href="linear-models-with-a-single-categorical-x.html#cb354-43"></a><span class="st">  </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb354-44"><a href="linear-models-with-a-single-categorical-x.html#cb354-44"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Effects (pmol/mL)&quot;</span>) <span class="op">+</span></span>
<span id="cb354-45"><a href="linear-models-with-a-single-categorical-x.html#cb354-45"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb354-46"><a href="linear-models-with-a-single-categorical-x.html#cb354-46"></a><span class="st">  </span><span class="ot">NULL</span></span>
<span id="cb354-47"><a href="linear-models-with-a-single-categorical-x.html#cb354-47"></a></span>
<span id="cb354-48"><a href="linear-models-with-a-single-categorical-x.html#cb354-48"></a><span class="co"># fig2a_gg_effect</span></span></code></pre></div>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="linear-models-with-a-single-categorical-x.html#cb355-1"></a>fig2a_fig &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(fig2a_gg_effect,</span>
<span id="cb355-2"><a href="linear-models-with-a-single-categorical-x.html#cb355-2"></a>                       fig2a_gg_response,</span>
<span id="cb355-3"><a href="linear-models-with-a-single-categorical-x.html#cb355-3"></a>                       <span class="dt">nrow=</span><span class="dv">2</span>,</span>
<span id="cb355-4"><a href="linear-models-with-a-single-categorical-x.html#cb355-4"></a>                       <span class="dt">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb355-5"><a href="linear-models-with-a-single-categorical-x.html#cb355-5"></a>                       <span class="dt">axis =</span> <span class="st">&quot;lr&quot;</span>,</span>
<span id="cb355-6"><a href="linear-models-with-a-single-categorical-x.html#cb355-6"></a>                       <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>))</span>
<span id="cb355-7"><a href="linear-models-with-a-single-categorical-x.html#cb355-7"></a>fig2a_fig</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-216-1.png" width="576" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-models-with-a-single-continuous-x.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-checking.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/24-categorical_X.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
