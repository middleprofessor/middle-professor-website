<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="3.3 Data wrangling | Elements of Statistical Modeling for Experimental Biology" />
<meta property="og:type" content="book" />


<meta property="og:description" content="A first course in statistical modeling for experimental biology researchers" />


<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="A first course in statistical modeling for experimental biology researchers">

<title>3.3 Data wrangling | Elements of Statistical Modeling for Experimental Biology</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#preface">Preface</a><ul>
<li><a href="0-1-math.html#math"><span class="toc-section-number">0.1</span> Math</a></li>
<li><a href="0-2-r-and-programming.html#r-and-programming"><span class="toc-section-number">0.2</span> R and programming</a></li>
</ul></li>
<li><a href="part-i-getting-started.html#part-i-getting-started">Part I: Getting Started</a></li>
<li class="has-sub"><a href="1-getting-started-r-projects-and-r-markdown.html#getting-started-r-projects-and-r-markdown"><span class="toc-section-number">1</span> Getting Started – R Projects and R Markdown</a><ul>
<li><a href="1-1-r-vs-r-studio.html#r-vs-r-studio"><span class="toc-section-number">1.1</span> R vs R Studio</a></li>
<li><a href="1-2-download-and-install-r-and-r-studio.html#download-and-install-r-and-r-studio"><span class="toc-section-number">1.2</span> Download and install R and R studio</a></li>
<li><a href="1-3-install-r-markdown.html#install-r-markdown"><span class="toc-section-number">1.3</span> Install R Markdown</a></li>
<li><a href="1-4-importing-packages.html#importing-packages"><span class="toc-section-number">1.4</span> Importing Packages</a></li>
<li class="has-sub"><a href="1-5-create-an-r-studio-project-for-this-textbook.html#create-an-r-studio-project-for-this-textbook"><span class="toc-section-number">1.5</span> Create an R Studio Project for this textbook</a><ul>
<li><a href="1-5-create-an-r-studio-project-for-this-textbook.html#create-an-r-markdown-file-for-this-chapter"><span class="toc-section-number">1.5.1</span> Create an R Markdown file for this Chapter</a></li>
<li><a href="1-5-create-an-r-studio-project-for-this-textbook.html#create-a-fake-data-chunk"><span class="toc-section-number">1.5.2</span> Create a “fake-data” chunk</a></li>
<li><a href="1-5-create-an-r-studio-project-for-this-textbook.html#create-a-plot-chunk"><span class="toc-section-number">1.5.3</span> Create a “plot” chunk</a></li>
<li><a href="1-5-create-an-r-studio-project-for-this-textbook.html#knit"><span class="toc-section-number">1.5.4</span> Knit</a></li>
</ul></li>
</ul></li>
<li><a href="part-ii-an-introduction-to-the-analysis-of-experimental-data-with-a-linear-model.html#part-ii-an-introduction-to-the-analysis-of-experimental-data-with-a-linear-model">Part II: An introduction to the analysis of experimental data with a linear model</a></li>
<li class="has-sub"><a href="2-analyzing-experimental-data-with-a-linear-model.html#analyzing-experimental-data-with-a-linear-model"><span class="toc-section-number">2</span> Analyzing experimental data with a linear model</a><ul>
<li><a href="2-1-this-text-is-about-the-estimation-of-treatment-effects-and-the-uncertainty-in-our-estimates-using-linear-models-this-raises-the-question-what-is-an-effect.html#this-text-is-about-the-estimation-of-treatment-effects-and-the-uncertainty-in-our-estimates-using-linear-models.-this-raises-the-question-what-is-an-effect"><span class="toc-section-number">2.1</span> This text is about the estimation of treatment effects and the uncertainty in our estimates using linear models. This, raises the question, what is “an effect”?</a></li>
</ul></li>
<li><a href="background-physiology-to-the-experiments-in-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#background-physiology-to-the-experiments-in-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity">Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li class="has-sub"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity">Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a><ul>
<li><a href="2-2-setup.html#setup"><span class="toc-section-number">2.2</span> Setup</a></li>
<li><a href="2-3-data-source.html#data-source"><span class="toc-section-number">2.3</span> Data source</a></li>
<li><a href="2-4-control-the-color-palette.html#control-the-color-palette"><span class="toc-section-number">2.4</span> control the color palette</a></li>
<li><a href="2-5-useful-functions.html#useful-functions"><span class="toc-section-number">2.5</span> useful functions</a></li>
<li class="has-sub"><a href="2-6-figure-2b-effect-of-ask1-deletion-on-growth-body-weight.html#figure-2b-effect-of-ask1-deletion-on-growth-body-weight"><span class="toc-section-number">2.6</span> figure 2b – effect of ASK1 deletion on growth (body weight)</a><ul>
<li><a href="2-6-figure-2b-effect-of-ask1-deletion-on-growth-body-weight.html#figure-2b-import"><span class="toc-section-number">2.6.1</span> figure 2b – import</a></li>
<li><a href="2-6-figure-2b-effect-of-ask1-deletion-on-growth-body-weight.html#figure-2b-exploratory-plots"><span class="toc-section-number">2.6.2</span> figure 2b – exploratory plots</a></li>
</ul></li>
<li class="has-sub"><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-effect-of-ask1-deletion-on-final-body-weight"><span class="toc-section-number">2.7</span> Figure 2c – Effect of ASK1 deletion on final body weight</a><ul>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-import"><span class="toc-section-number">2.7.1</span> Figure 2c – import</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-check-own-computation-of-weight-change-v-imported-value"><span class="toc-section-number">2.7.2</span> Figure 2c – check own computation of weight change v imported value</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-exploratory-plots"><span class="toc-section-number">2.7.3</span> Figure 2c – exploratory plots</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-fit-the-model-m1-lm"><span class="toc-section-number">2.7.4</span> Figure 2c – fit the model: m1 (lm)</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-check-the-model-m1"><span class="toc-section-number">2.7.5</span> Figure 2c – check the model: m1</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-fit-the-model-m2-gamma-glm"><span class="toc-section-number">2.7.6</span> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-check-the-model-m2"><span class="toc-section-number">2.7.7</span> Figure 2c – check the model, m2</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-inference-from-the-model"><span class="toc-section-number">2.7.8</span> Figure 2c – inference from the model</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-plot-the-model"><span class="toc-section-number">2.7.9</span> Figure 2c – plot the model</a></li>
<li><a href="2-7-figure-2c-effect-of-ask1-deletion-on-final-body-weight.html#figure-2c-report"><span class="toc-section-number">2.7.10</span> Figure 2c – report</a></li>
</ul></li>
<li class="has-sub"><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><span class="toc-section-number">2.8</span> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a><ul>
<li><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-import"><span class="toc-section-number">2.8.1</span> Figure 2d – Import</a></li>
<li><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-exploratory-plots"><span class="toc-section-number">2.8.2</span> Figure 2d – exploratory plots</a></li>
<li><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-fit-the-model"><span class="toc-section-number">2.8.3</span> Figure 2d – fit the model</a></li>
<li><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-check-the-model"><span class="toc-section-number">2.8.4</span> Figure 2d – check the model</a></li>
<li><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-inference"><span class="toc-section-number">2.8.5</span> Figure 2d – inference</a></li>
<li><a href="2-8-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve.html#figure-2d-plot-the-model"><span class="toc-section-number">2.8.6</span> Figure 2d – plot the model</a></li>
</ul></li>
<li class="has-sub"><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure"><span class="toc-section-number">2.9</span> Figure 2e – Effect of ASK1 deletion on glucose tolerance (summary measure)</a><ul>
<li><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-message-the-data"><span class="toc-section-number">2.9.1</span> Figure 2e – message the data</a></li>
<li><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-exploratory-plots"><span class="toc-section-number">2.9.2</span> Figure 2e – exploratory plots</a></li>
<li><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-fit-the-model"><span class="toc-section-number">2.9.3</span> Figure 2e – fit the model</a></li>
<li><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-check-the-model"><span class="toc-section-number">2.9.4</span> Figure 2e – check the model</a></li>
<li><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-inference-from-the-model"><span class="toc-section-number">2.9.5</span> Figure 2e – inference from the model</a></li>
<li><a href="2-9-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure.html#figure-2e-plot-the-model"><span class="toc-section-number">2.9.6</span> Figure 2e – plot the model</a></li>
</ul></li>
<li class="has-sub"><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate"><span class="toc-section-number">2.10</span> Figure 2f – Effect of ASK1 deletion on glucose infusion rate</a><ul>
<li><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-import"><span class="toc-section-number">2.10.1</span> Figure 2f – import</a></li>
<li><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-exploratory-plots"><span class="toc-section-number">2.10.2</span> Figure 2f – exploratory plots</a></li>
<li><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-fit-the-model"><span class="toc-section-number">2.10.3</span> Figure 2f – fit the model</a></li>
<li><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-check-the-model"><span class="toc-section-number">2.10.4</span> Figure 2f – check the model</a></li>
<li><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-inference"><span class="toc-section-number">2.10.5</span> Figure 2f – inference</a></li>
<li><a href="2-10-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate.html#figure-2f-plot-the-model"><span class="toc-section-number">2.10.6</span> Figure 2f – plot the model</a></li>
</ul></li>
<li class="has-sub"><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake"><span class="toc-section-number">2.11</span> Figure 2g – Effect of ASK1 deletion on tissue-specific glucose uptake</a><ul>
<li><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-import"><span class="toc-section-number">2.11.1</span> Figure 2g – import</a></li>
<li><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-exploratory-plots"><span class="toc-section-number">2.11.2</span> Figure 2g – exploratory plots</a></li>
<li><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-fit-the-model"><span class="toc-section-number">2.11.3</span> Figure 2g – fit the model</a></li>
<li><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-check-the-model"><span class="toc-section-number">2.11.4</span> Figure 2g – check the model</a></li>
<li><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-inference"><span class="toc-section-number">2.11.5</span> Figure 2g – inference</a></li>
<li><a href="2-11-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake.html#figure-2g-plot-the-model"><span class="toc-section-number">2.11.6</span> Figure 2g – plot the model</a></li>
</ul></li>
<li><a href="2-12-figure-2h.html#figure-2h"><span class="toc-section-number">2.12</span> Figure 2h</a></li>
<li class="has-sub"><a href="2-13-figure-2i-effect-of-ask1-deletion-on-liver-tg.html#figure-2i-effect-of-ask1-deletion-on-liver-tg"><span class="toc-section-number">2.13</span> Figure 2i – Effect of ASK1 deletion on liver TG</a><ul>
<li><a href="2-13-figure-2i-effect-of-ask1-deletion-on-liver-tg.html#figure-2i-fit-the-model"><span class="toc-section-number">2.13.1</span> Figure 2i – fit the model</a></li>
<li><a href="2-13-figure-2i-effect-of-ask1-deletion-on-liver-tg.html#figure-2i-check-the-model"><span class="toc-section-number">2.13.2</span> Figure 2i – check the model</a></li>
<li><a href="2-13-figure-2i-effect-of-ask1-deletion-on-liver-tg.html#figure-2i-inference"><span class="toc-section-number">2.13.3</span> Figure 2i – inference</a></li>
<li><a href="2-13-figure-2i-effect-of-ask1-deletion-on-liver-tg.html#figure-2i-plot-the-model"><span class="toc-section-number">2.13.4</span> Figure 2i – plot the model</a></li>
<li><a href="2-13-figure-2i-effect-of-ask1-deletion-on-liver-tg.html#figure-2i-report-the-model"><span class="toc-section-number">2.13.5</span> Figure 2i – report the model</a></li>
</ul></li>
<li><a href="2-14-figure-2j.html#figure-2j"><span class="toc-section-number">2.14</span> Figure 2j</a></li>
</ul></li>
<li><a href="part-iii-r-fundamentals.html#part-iii-r-fundamentals">Part III: R fundamentals</a></li>
<li class="has-sub"><a href="3-data-reading-wrangling-and-writing.html#data-reading-wrangling-and-writing"><span class="toc-section-number">3</span> Data – Reading, Wrangling, and Writing</a><ul>
<li><a href="3-1-learning-from-this-chapter.html#learning-from-this-chapter"><span class="toc-section-number">3.1</span> Learning from this chapter</a></li>
<li class="has-sub"><a href="3-2-data-working-in-r.html#data-working-in-r"><span class="toc-section-number">3.2</span> Working in R</a><ul>
<li><a href="3-2-data-working-in-r.html#importing-data"><span class="toc-section-number">3.2.1</span> Importing data</a></li>
</ul></li>
<li class="has-sub"><a href="3-3-data-wrangling.html#data-wrangling"><span class="toc-section-number">3.3</span> Data wrangling</a><ul>
<li><a href="3-3-data-wrangling.html#reshaping-data-wide-to-long"><span class="toc-section-number">3.3.1</span> Reshaping data – Wide to long</a></li>
<li><a href="3-3-data-wrangling.html#reshaping-data-transpose-turning-the-columns-into-rows"><span class="toc-section-number">3.3.2</span> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li><a href="3-3-data-wrangling.html#combining-data"><span class="toc-section-number">3.3.3</span> Combining data</a></li>
<li><a href="3-3-data-wrangling.html#subsetting-data"><span class="toc-section-number">3.3.4</span> Subsetting data</a></li>
<li><a href="3-3-data-wrangling.html#wrangling-columns"><span class="toc-section-number">3.3.5</span> Wrangling columns</a></li>
<li><a href="3-3-data-wrangling.html#missing-data"><span class="toc-section-number">3.3.6</span> Missing data</a></li>
</ul></li>
<li><a href="3-4-saving-data.html#saving-data"><span class="toc-section-number">3.4</span> Saving data</a></li>
<li><a href="3-5-exercises.html#exercises"><span class="toc-section-number">3.5</span> Exercises</a></li>
</ul></li>
<li class="has-sub"><a href="4-plotting-models.html#plotting-models"><span class="toc-section-number">4</span> Plotting Models</a><ul>
<li class="has-sub"><a href="4-1-pretty-good-plots-show-the-model-and-the-data.html#pretty-good-plots-show-the-model-and-the-data"><span class="toc-section-number">4.1</span> Pretty good plots show the model and the data</a><ul>
<li><a href="4-1-pretty-good-plots-show-the-model-and-the-data.html#pretty-good-plot-component-1-modeled-effects-plot"><span class="toc-section-number">4.1.1</span> Pretty good plot component 1: Modeled effects plot</a></li>
<li><a href="4-1-pretty-good-plots-show-the-model-and-the-data.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot"><span class="toc-section-number">4.1.2</span> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li><a href="4-1-pretty-good-plots-show-the-model-and-the-data.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><span class="toc-section-number">4.1.3</span> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
</ul></li>
<li><a href="4-2-some-comments-on-plot-components.html#some-comments-on-plot-components"><span class="toc-section-number">4.2</span> Some comments on plot components</a></li>
<li class="has-sub"><a href="4-3-working-in-r.html#working-in-r"><span class="toc-section-number">4.3</span> Working in R</a><ul>
<li><a href="4-3-working-in-r.html#unpooled-se-bars-and-confidence-intervals"><span class="toc-section-number">4.3.1</span> Unpooled SE bars and confidence intervals</a></li>
<li><a href="4-3-working-in-r.html#adding-bootstrap-intervals"><span class="toc-section-number">4.3.2</span> Adding bootstrap intervals</a></li>
<li><a href="4-3-working-in-r.html#adding-modeled-means-and-error-intervals"><span class="toc-section-number">4.3.3</span> Adding modeled means and error intervals</a></li>
<li><a href="4-3-working-in-r.html#adding-p-values"><span class="toc-section-number">4.3.4</span> Adding p-values</a></li>
<li><a href="4-3-working-in-r.html#adding-custom-p-values"><span class="toc-section-number">4.3.5</span> Adding custom p-values</a></li>
<li><a href="4-3-working-in-r.html#plotting-two-factors"><span class="toc-section-number">4.3.6</span> Plotting two factors</a></li>
<li><a href="4-3-working-in-r.html#interaction-plot"><span class="toc-section-number">4.3.7</span> Interaction plot</a></li>
<li><a href="4-3-working-in-r.html#plot-components"><span class="toc-section-number">4.3.8</span> Plot components</a></li>
</ul></li>
</ul></li>
<li><a href="part-iv-some-fundamentals-of-statistical-modeling.html#part-iv-some-fundamentals-of-statistical-modeling">Part IV: Some Fundamentals of Statistical Modeling</a></li>
<li class="has-sub"><a href="5-variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals"><span class="toc-section-number">5</span> Variability and Uncertainty (Standard Deviations, Standard Errors, Confidence Intervals)</a><ul>
<li class="has-sub"><a href="5-1-the-sample-standard-deviation-vs-the-standard-error-of-the-mean.html#the-sample-standard-deviation-vs.-the-standard-error-of-the-mean"><span class="toc-section-number">5.1</span> The sample standard deviation vs. the standard error of the mean</a><ul>
<li><a href="5-1-the-sample-standard-deviation-vs-the-standard-error-of-the-mean.html#sample-standard-deviation"><span class="toc-section-number">5.1.1</span> Sample standard deviation</a></li>
<li><a href="5-1-the-sample-standard-deviation-vs-the-standard-error-of-the-mean.html#standard-error-of-the-mean"><span class="toc-section-number">5.1.2</span> Standard error of the mean</a></li>
</ul></li>
<li class="has-sub"><a href="5-2-using-google-sheets-to-generate-fake-data-to-explore-the-standard-error.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><span class="toc-section-number">5.2</span> Using Google Sheets to generate fake data to explore the standard error</a><ul>
<li><a href="5-2-using-google-sheets-to-generate-fake-data-to-explore-the-standard-error.html#steps"><span class="toc-section-number">5.2.1</span> Steps</a></li>
</ul></li>
<li class="has-sub"><a href="5-3-using-r-to-generate-fake-data-to-explore-the-standard-error.html#using-r-to-generate-fake-data-to-explore-the-standard-error"><span class="toc-section-number">5.3</span> Using R to generate fake data to explore the standard error</a><ul>
<li><a href="5-3-using-r-to-generate-fake-data-to-explore-the-standard-error.html#part-i"><span class="toc-section-number">5.3.1</span> part I</a></li>
<li><a href="5-3-using-r-to-generate-fake-data-to-explore-the-standard-error.html#part-ii---means"><span class="toc-section-number">5.3.2</span> part II - means</a></li>
<li><a href="5-3-using-r-to-generate-fake-data-to-explore-the-standard-error.html#part-iii---how-do-sd-and-se-change-as-sample-size-n-increases"><span class="toc-section-number">5.3.3</span> part III - how do SD and SE change as sample size (n) increases?</a></li>
<li><a href="5-3-using-r-to-generate-fake-data-to-explore-the-standard-error.html#part-iv-generating-fake-data-with-for-loops"><span class="toc-section-number">5.3.4</span> Part IV – Generating fake data with for-loops</a></li>
</ul></li>
<li class="has-sub"><a href="5-4-bootstrap.html#bootstrap"><span class="toc-section-number">5.4</span> Bootstrapped standard errors</a><ul>
<li><a href="5-4-bootstrap.html#an-example-of-bootstrapped-standard-errors-using-vole-data"><span class="toc-section-number">5.4.1</span> An example of bootstrapped standard errors using vole data</a></li>
</ul></li>
<li class="has-sub"><a href="5-5-confidence-interval.html#confidence-interval"><span class="toc-section-number">5.5</span> Confidence Interval</a><ul>
<li><a href="5-5-confidence-interval.html#interpretation-of-a-confidence-interval"><span class="toc-section-number">5.5.1</span> Interpretation of a confidence interval</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="6-p-values.html#p-values"><span class="toc-section-number">6</span> P-values</a><ul>
<li><a href="6-1-a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution.html#a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution"><span class="toc-section-number">6.1</span> A <em>p</em>-value is the probability of sampling a value as or more extreme than the test statistic if sampling from a null distribution</a></li>
<li><a href="6-2-pump-your-intuition-creating-a-null-distribution.html#pump-your-intuition-creating-a-null-distribution"><span class="toc-section-number">6.2</span> Pump your intuition – Creating a null distribution</a></li>
<li><a href="6-3-a-null-distribution-of-t-values-the-t-distribution.html#a-null-distribution-of-t-values-the-t-distribution"><span class="toc-section-number">6.3</span> A null distribution of <em>t</em>-values – the <em>t</em> distribution</a></li>
<li><a href="6-4-p-values-from-the-perspective-of-permutation.html#p-values-from-the-perspective-of-permutation"><span class="toc-section-number">6.4</span> P-values from the perspective of permutation</a></li>
<li><a href="6-5-parametric-vs-non-parametric-statistics.html#parametric-vs.-non-parametric-statistics"><span class="toc-section-number">6.5</span> Parametric vs. non-parametric statistics</a></li>
<li class="has-sub"><a href="6-6-frequentist-probability-and-the-interpretation-of-p-values.html#frequentist-probability-and-the-interpretation-of-p-values"><span class="toc-section-number">6.6</span> frequentist probability and the interpretation of p-values</a><ul>
<li><a href="6-6-frequentist-probability-and-the-interpretation-of-p-values.html#background"><span class="toc-section-number">6.6.1</span> Background</a></li>
<li><a href="6-6-frequentist-probability-and-the-interpretation-of-p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><span class="toc-section-number">6.6.2</span> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li><a href="6-6-frequentist-probability-and-the-interpretation-of-p-values.html#two-interpretations-of-the-p-value"><span class="toc-section-number">6.6.3</span> Two interpretations of the <em>p</em>-value</a></li>
<li><a href="6-6-frequentist-probability-and-the-interpretation-of-p-values.html#nhst"><span class="toc-section-number">6.6.4</span> NHST</a></li>
</ul></li>
<li class="has-sub"><a href="6-7-some-major-misconceptions-of-the-p-value.html#some-major-misconceptions-of-the-p-value"><span class="toc-section-number">6.7</span> Some major misconceptions of the <em>p</em>-value</a><ul>
<li><a href="6-7-some-major-misconceptions-of-the-p-value.html#misconception-p-is-the-probability-that-the-null-is-true-and-1-p-is-probability-that-the-alternative-is-true"><span class="toc-section-number">6.7.1</span> Misconception: <em>p</em> is the probability that the null is true <em>and</em> <span class="math inline">\(1-p\)</span> is probability that the alternative is true</a></li>
<li><a href="6-7-some-major-misconceptions-of-the-p-value.html#misconception-a-p-value-is-repeatable"><span class="toc-section-number">6.7.2</span> Misconception: a <em>p</em>-value is repeatable</a></li>
<li><a href="6-7-some-major-misconceptions-of-the-p-value.html#misconception-0.05-is-the-lifetime-rate-of-false-discoveries"><span class="toc-section-number">6.7.3</span> Misconception: 0.05 is the lifetime rate of false discoveries</a></li>
<li><a href="6-7-some-major-misconceptions-of-the-p-value.html#misconception-a-low-p-value-indicates-an-important-effect"><span class="toc-section-number">6.7.4</span> Misconception: a low <em>p</em>-value indicates an important effect</a></li>
<li><a href="6-7-some-major-misconceptions-of-the-p-value.html#misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity"><span class="toc-section-number">6.7.5</span> Misconception: a low <em>p</em>-value indicates high model fit or high predictive capacity</a></li>
</ul></li>
<li><a href="6-8-what-the-p-value-does-not-mean.html#what-the-p-value-does-not-mean"><span class="toc-section-number">6.8</span> What the <em>p</em>-value does not mean</a></li>
<li class="has-sub"><a href="6-9-recommendations.html#recommendations"><span class="toc-section-number">6.9</span> Recommendations</a><ul>
<li><a href="6-9-recommendations.html#primary-sources-for-recommendations"><span class="toc-section-number">6.9.1</span> Primary sources for recommendations</a></li>
</ul></li>
<li><a href="6-10-problems.html#problems"><span class="toc-section-number">6.10</span> Problems</a></li>
</ul></li>
<li class="has-sub"><a href="7-errors-in-inference.html#errors-in-inference"><span class="toc-section-number">7</span> Errors in inference</a><ul>
<li class="has-sub"><a href="7-1-classical-nhst-concepts-of-wrong.html#classical-nhst-concepts-of-wrong"><span class="toc-section-number">7.1</span> Classical NHST concepts of wrong</a><ul>
<li><a href="7-1-classical-nhst-concepts-of-wrong.html#type-i-error"><span class="toc-section-number">7.1.1</span> Type I error</a></li>
<li><a href="7-1-classical-nhst-concepts-of-wrong.html#power"><span class="toc-section-number">7.1.2</span> Power</a></li>
</ul></li>
<li class="has-sub"><a href="7-2-a-non-neyman-pearson-concept-of-power.html#a-non-neyman-pearson-concept-of-power"><span class="toc-section-number">7.2</span> A non-Neyman-Pearson concept of power</a><ul>
<li><a href="7-2-a-non-neyman-pearson-concept-of-power.html#estimation-error"><span class="toc-section-number">7.2.1</span> Estimation error</a></li>
<li><a href="7-2-a-non-neyman-pearson-concept-of-power.html#coverage"><span class="toc-section-number">7.2.2</span> Coverage</a></li>
<li><a href="7-2-a-non-neyman-pearson-concept-of-power.html#type-s-error"><span class="toc-section-number">7.2.3</span> Type S error</a></li>
<li><a href="7-2-a-non-neyman-pearson-concept-of-power.html#type-m-error"><span class="toc-section-number">7.2.4</span> Type M error</a></li>
</ul></li>
</ul></li>
<li><a href="part-v-introduction-to-linear-models.html#part-v-introduction-to-linear-models">Part V: Introduction to Linear Models</a></li>
<li class="has-sub"><a href="8-an-introduction-to-linear-models.html#an-introduction-to-linear-models"><span class="toc-section-number">8</span> An introduction to linear models</a><ul>
<li class="has-sub"><a href="8-1-two-specifications-of-a-linear-model.html#two-specifications-of-a-linear-model"><span class="toc-section-number">8.1</span> Two specifications of a linear model</a><ul>
<li><a href="8-1-two-specifications-of-a-linear-model.html#the-error-draw-specification"><span class="toc-section-number">8.1.1</span> The “error draw” specification</a></li>
<li><a href="8-1-two-specifications-of-a-linear-model.html#the-conditional-draw-specification"><span class="toc-section-number">8.1.2</span> The “conditional draw” specification</a></li>
<li><a href="8-1-two-specifications-of-a-linear-model.html#comparing-the-two-ways-of-specifying-the-linear-model"><span class="toc-section-number">8.1.3</span> Comparing the two ways of specifying the linear model</a></li>
</ul></li>
<li class="has-sub"><a href="8-2-a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"><span class="toc-section-number">8.2</span> A linear model can be fit to data with continuous, discrete, or categorical <span class="math inline">\(X\)</span> variables</a><ul>
<li><a href="8-2-a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete"><span class="toc-section-number">8.2.1</span> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is continuous or discrete</a></li>
<li><a href="8-2-a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-categorical"><span class="toc-section-number">8.2.2</span> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is categorical</a></li>
</ul></li>
<li><a href="8-3-statistical-models-are-used-for-prediction-explanation-and-description.html#statistical-models-are-used-for-prediction-explanation-and-description"><span class="toc-section-number">8.3</span> Statistical models are used for prediction, explanation, and description</a></li>
<li><a href="8-4-what-do-we-call-the-x-and-y-variables.html#what-do-we-call-the-x-and-y-variables"><span class="toc-section-number">8.4</span> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li><a href="8-5-modeling-strategy.html#modeling-strategy"><span class="toc-section-number">8.5</span> Modeling strategy</a></li>
<li><a href="8-6-predictions-from-the-model.html#predictions-from-the-model"><span class="toc-section-number">8.6</span> Predictions from the model</a></li>
<li class="has-sub"><a href="8-7-inference-from-the-model.html#inference-from-the-model"><span class="toc-section-number">8.7</span> Inference from the model</a><ul>
<li><a href="8-7-inference-from-the-model.html#assumptions-for-inference-with-a-statistical-model"><span class="toc-section-number">8.7.1</span> Assumptions for inference with a statistical model</a></li>
<li><a href="8-7-inference-from-the-model.html#specific-assumptions-for-inference-with-a-linear-model"><span class="toc-section-number">8.7.2</span> Specific assumptions for inference with a linear model</a></li>
</ul></li>
<li><a href="8-8-linear-modelregression-model-orstatistical-model.html#linear-modelregression-model-orstatistical-model"><span class="toc-section-number">8.8</span> “linear model,”regression model“, or”statistical model"?</a></li>
</ul></li>
<li class="has-sub"><a href="9-linear-models-with-a-single-continuous-x.html#linear-models-with-a-single-continuous-x"><span class="toc-section-number">9</span> Linear models with a single, continuous <em>X</em></a><ul>
<li class="has-sub"><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><span class="toc-section-number">9.1</span> A linear model with a single, continuous <em>X</em> is classical “regression”</a><ul>
<li><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#analysis-of-green-down-data"><span class="toc-section-number">9.1.1</span> Analysis of “green-down” data</a></li>
<li><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#learning-from-the-green-down-example"><span class="toc-section-number">9.1.2</span> Learning from the green-down example</a></li>
<li><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#using-a-regression-model-for-explanation-causal-models"><span class="toc-section-number">9.1.3</span> Using a regression model for “explanation” – causal models</a></li>
<li><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#using-a-regression-model-for-prediction-prediction-models"><span class="toc-section-number">9.1.4</span> Using a regression model for prediction – prediction models</a></li>
<li><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data"><span class="toc-section-number">9.1.5</span> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</a></li>
<li><a href="9-1-a-linear-model-with-a-single-continuous-x-is-classical-regression.html#using-a-regression-model-for-for-calibration"><span class="toc-section-number">9.1.6</span> Using a regression model for for calibration</a></li>
</ul></li>
<li class="has-sub"><a href="9-2-working-in-r-1.html#working-in-r-1"><span class="toc-section-number">9.2</span> Working in R</a><ul>
<li><a href="9-2-working-in-r-1.html#fitting-the-linear-model"><span class="toc-section-number">9.2.1</span> Fitting the linear model</a></li>
<li><a href="9-2-working-in-r-1.html#getting-to-know-the-linear-model-the-summary-function"><span class="toc-section-number">9.2.2</span> Getting to know the linear model: the <code>summary</code> function</a></li>
<li><a href="9-2-working-in-r-1.html#inference-the-coefficient-table-and-confidence-intervals"><span class="toc-section-number">9.2.3</span> Inference – the coefficient table and Confidence intervals</a></li>
<li><a href="9-2-working-in-r-1.html#how-good-is-our-model-model-checking"><span class="toc-section-number">9.2.4</span> How good is our model? – Model checking</a></li>
<li><a href="9-2-working-in-r-1.html#plotting-models-with-continuous-x"><span class="toc-section-number">9.2.5</span> Plotting models with continuous <em>X</em></a></li>
<li><a href="9-2-working-in-r-1.html#creating-a-table-of-predicted-values-and-95-prediction-intervals"><span class="toc-section-number">9.2.6</span> Creating a table of predicted values and 95% prediction intervals</a></li>
</ul></li>
<li class="has-sub"><a href="9-3-hidden-code.html#hidden-code"><span class="toc-section-number">9.3</span> Hidden code</a><ul>
<li><a href="9-3-hidden-code.html#import-and-plot-of-fig2c-ecosystem-warming-experimental-data"><span class="toc-section-number">9.3.1</span> Import and plot of fig2c (ecosystem warming experimental) data</a></li>
<li><a href="9-3-hidden-code.html#import-and-plot-efig_3d-ecosysem-warming-observational-data"><span class="toc-section-number">9.3.2</span> Import and plot efig_3d (Ecosysem warming observational) data</a></li>
<li><a href="9-3-hidden-code.html#import-and-plot-of-fig1f-methionine-restriction-data"><span class="toc-section-number">9.3.3</span> Import and plot of fig1f (methionine restriction) data</a></li>
</ul></li>
<li class="has-sub"><a href="9-4-try-it.html#try-it"><span class="toc-section-number">9.4</span> Try it</a><ul>
<li><a href="9-4-try-it.html#a-prediction-model-from-the-literature"><span class="toc-section-number">9.4.1</span> A prediction model from the literature</a></li>
</ul></li>
<li class="has-sub"><a href="9-5-intuition-pumps.html#intuition-pumps"><span class="toc-section-number">9.5</span> Intuition pumps</a><ul>
<li><a href="9-5-intuition-pumps.html#correlation-and-r2"><span class="toc-section-number">9.5.1</span> Correlation and $R^2</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="10-linear-models-with-a-single-categorical-x.html#linear-models-with-a-single-categorical-x"><span class="toc-section-number">10</span> Linear models with a single, categorical <em>X</em></a><ul>
<li class="has-sub"><a href="10-1-a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response-.html#a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response."><span class="toc-section-number">10.1</span> A linear model with a single, categorical <em>X</em> variable estimates the effects of the levels of <em>X</em> on the response.</a><ul>
<li><a href="10-1-a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response-.html#example-1-two-treatment-levels-groups"><span class="toc-section-number">10.1.1</span> Example 1 – two treatment levels (“groups”)</a></li>
<li><a href="10-1-a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response-.html#understanding-the-analysis-with-two-treatment-levels"><span class="toc-section-number">10.1.2</span> Understanding the analysis with two treatment levels</a></li>
<li><a href="10-1-a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response-.html#example-2-three-treatment-levels-groups"><span class="toc-section-number">10.1.3</span> Example 2 – three treatment levels (“groups”)</a></li>
<li><a href="10-1-a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response-.html#understanding-the-analysis-with-three-or-more-treatment-levels"><span class="toc-section-number">10.1.4</span> Understanding the analysis with three (or more) treatment levels</a></li>
</ul></li>
<li class="has-sub"><a href="10-2-working-in-r-2.html#working-in-r-2"><span class="toc-section-number">10.2</span> Working in R</a><ul>
<li><a href="10-2-working-in-r-2.html#specifying-the-contrasts"><span class="toc-section-number">10.2.1</span> Specifying the contrasts</a></li>
<li><a href="10-2-working-in-r-2.html#adjustment-for-multiple-comparisons"><span class="toc-section-number">10.2.2</span> Adjustment for multiple comparisons</a></li>
<li><a href="10-2-working-in-r-2.html#plotting-models-with-a-single-categorical-x"><span class="toc-section-number">10.2.3</span> Plotting models with a single, categorical <span class="math inline">\(X\)</span></a></li>
</ul></li>
<li class="has-sub"><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#issues-in-inference-in-models-with-a-single-categorical-x"><span class="toc-section-number">10.3</span> Issues in inference in models with a single, categorical <span class="math inline">\(X\)</span></a><ul>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#lack-of-independence"><span class="toc-section-number">10.3.1</span> Lack of independence</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#heterogeneity-of-variances"><span class="toc-section-number">10.3.2</span> Heterogeneity of variances</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#the-conditional-response-isnt-normal"><span class="toc-section-number">10.3.3</span> The conditional response isn’t Normal</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#pre-post-designs"><span class="toc-section-number">10.3.4</span> Pre-post designs</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#longitudinal-designs"><span class="toc-section-number">10.3.5</span> Longitudinal designs</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#comparing-responses-normalized-to-a-standard"><span class="toc-section-number">10.3.6</span> Comparing responses normalized to a standard</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#comparing-responses-that-are-ratios"><span class="toc-section-number">10.3.7</span> Comparing responses that are ratios</a></li>
<li><a href="10-3-issues-in-inference-in-models-with-a-single-categorical-x.html#researcher-degrees-of-freedom"><span class="toc-section-number">10.3.8</span> Researcher degrees of freedom</a></li>
</ul></li>
<li class="has-sub"><a href="10-4-hidden-code-1.html#hidden-code-1"><span class="toc-section-number">10.4</span> Hidden Code</a><ul>
<li><a href="10-4-hidden-code-1.html#fig2a-data"><span class="toc-section-number">10.4.1</span> fig2a data</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="11-model-checking.html#model-checking"><span class="toc-section-number">11</span> Model Checking</a><ul>
<li><a href="11-1-all-statistical-analyses-should-be-followed-by-model-checking.html#all-statistical-analyses-should-be-followed-by-model-checking"><span class="toc-section-number">11.1</span> All statistical analyses should be followed by model checking</a></li>
<li class="has-sub"><a href="11-2-linear-model-assumptions.html#linear-model-assumptions"><span class="toc-section-number">11.2</span> Linear model assumptions</a><ul>
<li><a href="11-2-linear-model-assumptions.html#a-bit-about-iid"><span class="toc-section-number">11.2.1</span> A bit about IID</a></li>
</ul></li>
<li class="has-sub"><a href="11-3-diagnostic-plots-use-the-residuals-from-the-model-fit.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><span class="toc-section-number">11.3</span> Diagnostic plots use the residuals from the model fit</a><ul>
<li><a href="11-3-diagnostic-plots-use-the-residuals-from-the-model-fit.html#residuals"><span class="toc-section-number">11.3.1</span> Residuals</a></li>
<li><a href="11-3-diagnostic-plots-use-the-residuals-from-the-model-fit.html#a-normal-q-q-plot-is-used-to-check-for-characteristic-departures-from-normality"><span class="toc-section-number">11.3.2</span> A Normal Q-Q plot is used to check for characteristic departures from Normality</a></li>
<li><a href="11-3-diagnostic-plots-use-the-residuals-from-the-model-fit.html#mapping-qq-plot-departures-from-normality"><span class="toc-section-number">11.3.3</span> Mapping QQ-plot departures from Normality</a></li>
<li><a href="11-3-diagnostic-plots-use-the-residuals-from-the-model-fit.html#model-checking-homoskedasticity"><span class="toc-section-number">11.3.4</span> Model checking homoskedasticity</a></li>
</ul></li>
<li class="has-sub"><a href="11-4-using-r.html#using-r"><span class="toc-section-number">11.4</span> Using R</a><ul>
<li><a href="11-4-using-r.html#normal-q-q-plots"><span class="toc-section-number">11.4.1</span> Normal Q-Q plots</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="12-model-fitting-and-model-fit-ols.html#model-fitting-and-model-fit-ols"><span class="toc-section-number">12</span> Model Fitting and Model Fit (OLS)</a><ul>
<li><a href="12-1-least-squares-estimation-and-the-decomposition-of-variance.html#least-squares-estimation-and-the-decomposition-of-variance"><span class="toc-section-number">12.1</span> Least Squares Estimation and the Decomposition of Variance</a></li>
<li><a href="12-2-ols-regression.html#ols-regression"><span class="toc-section-number">12.2</span> OLS regression</a></li>
<li><a href="12-3-how-well-does-the-model-fit-the-data-r2-and-variance-explained.html#how-well-does-the-model-fit-the-data-r2-and-variance-explained"><span class="toc-section-number">12.3</span> How well does the model fit the data? <span class="math inline">\(R^2\)</span> and “variance explained”</a></li>
</ul></li>
<li class="has-sub"><a href="13-best-practices-issues-in-inference.html#best-practices-issues-in-inference"><span class="toc-section-number">13</span> Best practices – issues in inference</a><ul>
<li class="has-sub"><a href="13-1-multiple-testing.html#multiple-testing"><span class="toc-section-number">13.1</span> Multiple testing</a><ul>
<li><a href="13-1-multiple-testing.html#some-background"><span class="toc-section-number">13.1.1</span> Some background</a></li>
<li><a href="13-1-multiple-testing.html#multiple-testing-working-in-r"><span class="toc-section-number">13.1.2</span> Multiple testing – working in R</a></li>
<li><a href="13-1-multiple-testing.html#false-discovery-rate"><span class="toc-section-number">13.1.3</span> False Discovery Rate</a></li>
</ul></li>
<li><a href="13-2-difference-in-p-is-not-different.html#difference-in-p-is-not-different"><span class="toc-section-number">13.2</span> difference in p is not different</a></li>
<li class="has-sub"><a href="13-3-inference-when-data-are-not-normal.html#inference-when-data-are-not-normal"><span class="toc-section-number">13.3</span> Inference when data are not Normal</a><ul>
<li><a href="13-3-inference-when-data-are-not-normal.html#working-in-r-3"><span class="toc-section-number">13.3.1</span> Working in R</a></li>
<li><a href="13-3-inference-when-data-are-not-normal.html#bootstrap-confidence-intervals"><span class="toc-section-number">13.3.2</span> Bootstrap Confidence Intervals</a></li>
<li><a href="13-3-inference-when-data-are-not-normal.html#permutation-test"><span class="toc-section-number">13.3.3</span> Permutation test</a></li>
<li><a href="13-3-inference-when-data-are-not-normal.html#non-parametric-tests"><span class="toc-section-number">13.3.4</span> Non-parametric tests</a></li>
<li><a href="13-3-inference-when-data-are-not-normal.html#log-transformations"><span class="toc-section-number">13.3.5</span> Log transformations</a></li>
<li><a href="13-3-inference-when-data-are-not-normal.html#performance-of-parametric-tests-and-alternatives"><span class="toc-section-number">13.3.6</span> Performance of parametric tests and alternatives</a></li>
</ul></li>
</ul></li>
<li><a href="part-vi-more-than-one-x-multivariable-models.html#part-vi-more-than-one-x-multivariable-models">Part VI: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li class="has-sub"><a href="14-adding-covariates-to-a-linear-model.html#adding-covariates-to-a-linear-model"><span class="toc-section-number">14</span> Adding covariates to a linear model</a><ul>
<li><a href="14-1-adding-covariates-can-increases-the-precision-of-the-effect-of-interest.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><span class="toc-section-number">14.1</span> Adding covariates can increases the precision of the effect of interest</a></li>
<li class="has-sub"><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data"><span class="toc-section-number">14.2</span> Understanding a linear model with an added covariate – heart necrosis data</a><ul>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#fit-the-model-1"><span class="toc-section-number">14.2.1</span> Fit the model</a></li>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#plot-the-model-1"><span class="toc-section-number">14.2.2</span> Plot the model</a></li>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#interpretation-of-the-model-coefficients"><span class="toc-section-number">14.2.3</span> Interpretation of the model coefficients</a></li>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#everything-adds-up"><span class="toc-section-number">14.2.4</span> Everything adds up</a></li>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#interpretation-of-the-estimated-marginal-means"><span class="toc-section-number">14.2.5</span> Interpretation of the estimated marginal means</a></li>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#interpretation-of-the-contrasts"><span class="toc-section-number">14.2.6</span> Interpretation of the contrasts</a></li>
<li><a href="14-2-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data.html#adding-the-covariate-improves-inference"><span class="toc-section-number">14.2.7</span> Adding the covariate improves inference</a></li>
</ul></li>
<li class="has-sub"><a href="14-3-understanding-interaction-effects-with-covariates.html#understanding-interaction-effects-with-covariates"><span class="toc-section-number">14.3</span> Understanding interaction effects with covariates</a><ul>
<li><a href="14-3-understanding-interaction-effects-with-covariates.html#fit-the-model-2"><span class="toc-section-number">14.3.1</span> Fit the model</a></li>
<li><a href="14-3-understanding-interaction-effects-with-covariates.html#plot-the-model-with-interaction-effect"><span class="toc-section-number">14.3.2</span> Plot the model with interaction effect</a></li>
<li><a href="14-3-understanding-interaction-effects-with-covariates.html#interpretation-of-the-model-coefficients-1"><span class="toc-section-number">14.3.3</span> Interpretation of the model coefficients</a></li>
<li><a href="14-3-understanding-interaction-effects-with-covariates.html#what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends."><span class="toc-section-number">14.3.4</span> What is the effect of a treatment, if interactions are modeled? – it depends.</a></li>
<li><a href="14-3-understanding-interaction-effects-with-covariates.html#which-model-do-we-use-mathcalm_1-or-mathcalm_2"><span class="toc-section-number">14.3.5</span> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</a></li>
</ul></li>
<li><a href="14-4-understanding-ancova-tables.html#understanding-ancova-tables"><span class="toc-section-number">14.4</span> Understanding ANCOVA tables</a></li>
<li class="has-sub"><a href="14-5-working-in-r-4.html#working-in-r-4"><span class="toc-section-number">14.5</span> Working in R</a><ul>
<li><a href="14-5-working-in-r-4.html#importing-the-heart-necrosis-data"><span class="toc-section-number">14.5.1</span> Importing the heart necrosis data</a></li>
<li><a href="14-5-working-in-r-4.html#fitting-the-model"><span class="toc-section-number">14.5.2</span> Fitting the model</a></li>
<li><a href="14-5-working-in-r-4.html#ancova-tables"><span class="toc-section-number">14.5.3</span> ANCOVA tables</a></li>
<li><a href="14-5-working-in-r-4.html#plotting-the-model"><span class="toc-section-number">14.5.4</span> Plotting the model</a></li>
</ul></li>
<li class="has-sub"><a href="14-6-best-practices.html#best-practices"><span class="toc-section-number">14.6</span> Best practices</a><ul>
<li><a href="14-6-best-practices.html#do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate"><span class="toc-section-number">14.6.1</span> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</a></li>
<li><a href="14-6-best-practices.html#do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate"><span class="toc-section-number">14.6.2</span> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</a></li>
<li><a href="14-6-best-practices.html#do-not-test-for-balance-of-baseline-measures"><span class="toc-section-number">14.6.3</span> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li><a href="14-7-best-practices-2-use-a-covariate-instead-of-normalizing-a-response.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><span class="toc-section-number">14.7</span> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li class="has-sub"><a href="15-two-or-more-categorical-x-factorial-designs.html#two-or-more-categorical-x-factorial-designs"><span class="toc-section-number">15</span> Two (or more) Categorical <span class="math inline">\(X\)</span> – Factorial designs</a><ul>
<li class="has-sub"><a href="15-1-factorial-experiments.html#factorial-experiments"><span class="toc-section-number">15.1</span> Factorial experiments</a><ul>
<li><a href="15-1-factorial-experiments.html#model-coefficients-an-interaction-effect-is-what-is-leftover-after-adding-the-treatment-effects-to-the-control"><span class="toc-section-number">15.1.1</span> Model coefficients: an interaction effect is what is leftover after adding the treatment effects to the control</a></li>
<li><a href="15-1-factorial-experiments.html#what-is-the-biological-meaning-of-an-interaction-effect"><span class="toc-section-number">15.1.2</span> What is the biological meaning of an interaction effect?</a></li>
<li><a href="15-1-factorial-experiments.html#the-interpretation-of-the-coefficients-in-a-factorial-model-is-entirely-dependent-on-the-reference"><span class="toc-section-number">15.1.3</span> The interpretation of the coefficients in a factorial model is entirely dependent on the reference…</a></li>
<li><a href="15-1-factorial-experiments.html#estimated-marginal-means"><span class="toc-section-number">15.1.4</span> Estimated marginal means</a></li>
<li><a href="15-1-factorial-experiments.html#in-a-factorial-model-there-are-multiple-effects-of-each-factor-simple-effects"><span class="toc-section-number">15.1.5</span> In a factorial model, there are multiple effects of each factor (simple effects)</a></li>
<li><a href="15-1-factorial-experiments.html#marginal-effects"><span class="toc-section-number">15.1.6</span> Marginal effects</a></li>
<li><a href="15-1-factorial-experiments.html#the-additive-model"><span class="toc-section-number">15.1.7</span> The additive model</a></li>
<li><a href="15-1-factorial-experiments.html#reduce-models-for-the-right-reason"><span class="toc-section-number">15.1.8</span> Reduce models for the right reason</a></li>
<li><a href="15-1-factorial-experiments.html#what-about-models-with-more-than-two-factors"><span class="toc-section-number">15.1.9</span> What about models with more than two factors?</a></li>
</ul></li>
<li class="has-sub"><a href="15-2-reporting-results.html#reporting-results"><span class="toc-section-number">15.2</span> Reporting results</a><ul>
<li><a href="15-2-reporting-results.html#text-results"><span class="toc-section-number">15.2.1</span> Text results</a></li>
</ul></li>
<li class="has-sub"><a href="15-3-working-in-r-5.html#working-in-r-5"><span class="toc-section-number">15.3</span> Working in R</a><ul>
<li><a href="15-3-working-in-r-5.html#model-formula"><span class="toc-section-number">15.3.1</span> Model formula</a></li>
<li><a href="15-3-working-in-r-5.html#modeled-means"><span class="toc-section-number">15.3.2</span> Modeled means</a></li>
<li><a href="15-3-working-in-r-5.html#marginal-means"><span class="toc-section-number">15.3.3</span> Marginal means</a></li>
<li><a href="15-3-working-in-r-5.html#contrasts"><span class="toc-section-number">15.3.4</span> Contrasts</a></li>
<li><a href="15-3-working-in-r-5.html#simple-effects"><span class="toc-section-number">15.3.5</span> Simple effects</a></li>
<li><a href="15-3-working-in-r-5.html#marginal-effects-1"><span class="toc-section-number">15.3.6</span> Marginal effects</a></li>
<li><a href="15-3-working-in-r-5.html#plotting-results"><span class="toc-section-number">15.3.7</span> Plotting results</a></li>
</ul></li>
<li><a href="15-4-problems-1.html#problems-1"><span class="toc-section-number">15.4</span> Problems</a></li>
</ul></li>
<li class="has-sub"><a href="16-anova-tables.html#anova-tables"><span class="toc-section-number">16</span> ANOVA Tables</a><ul>
<li><a href="16-1-summary-of-usage.html#summary-of-usage"><span class="toc-section-number">16.1</span> Summary of usage</a></li>
<li><a href="16-2-example-a-one-way-anova-using-the-vole-data.html#example-a-one-way-anova-using-the-vole-data"><span class="toc-section-number">16.2</span> Example: a one-way ANOVA using the vole data</a></li>
<li class="has-sub"><a href="16-3-example-a-two-way-anova-using-the-urchin-data.html#example-a-two-way-anova-using-the-urchin-data"><span class="toc-section-number">16.3</span> Example: a two-way ANOVA using the urchin data</a><ul>
<li><a href="16-3-example-a-two-way-anova-using-the-urchin-data.html#how-to-read-an-anova-table"><span class="toc-section-number">16.3.1</span> How to read an ANOVA table</a></li>
<li><a href="16-3-example-a-two-way-anova-using-the-urchin-data.html#how-to-read-anova-results-reported-in-the-text"><span class="toc-section-number">16.3.2</span> How to read ANOVA results reported in the text</a></li>
<li><a href="16-3-example-a-two-way-anova-using-the-urchin-data.html#better-practice-estimates-and-their-uncertainty"><span class="toc-section-number">16.3.3</span> Better practice – estimates and their uncertainty</a></li>
</ul></li>
<li class="has-sub"><a href="16-4-unbalanced-designs.html#unbalanced-designs"><span class="toc-section-number">16.4</span> Unbalanced designs</a><ul>
<li><a href="16-4-unbalanced-designs.html#what-is-going-on-in-unbalanced-anova-type-i-ii-iii-sum-of-squares"><span class="toc-section-number">16.4.1</span> What is going on in unbalanced ANOVA? – Type I, II, III sum of squares</a></li>
<li><a href="16-4-unbalanced-designs.html#back-to-interpretation-of-main-effects"><span class="toc-section-number">16.4.2</span> Back to interpretation of main effects</a></li>
<li><a href="16-4-unbalanced-designs.html#the-anova-tables-for-type-i-ii-and-iii-sum-of-squares-are-the-same-if-the-design-is-balanced."><span class="toc-section-number">16.4.3</span> The anova tables for Type I, II, and III sum of squares are the same if the design is balanced.</a></li>
</ul></li>
<li class="has-sub"><a href="16-5-working-in-r-6.html#working-in-r-6"><span class="toc-section-number">16.5</span> Working in R</a><ul>
<li><a href="16-5-working-in-r-6.html#type-i-sum-of-squares-in-r"><span class="toc-section-number">16.5.1</span> Type I sum of squares in R</a></li>
<li><a href="16-5-working-in-r-6.html#type-ii-and-iii-sum-of-squares"><span class="toc-section-number">16.5.2</span> Type II and III Sum of Squares</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="17-predictive-models.html#predictive-models"><span class="toc-section-number">17</span> Predictive Models</a><ul>
<li><a href="17-1-overfitting.html#overfitting"><span class="toc-section-number">17.1</span> Overfitting</a></li>
<li class="has-sub"><a href="17-2-model-building-vs-variable-selection-vs-model-selection.html#model-building-vs.-variable-selection-vs.-model-selection"><span class="toc-section-number">17.2</span> Model building vs. Variable selection vs. Model selection</a><ul>
<li><a href="17-2-model-building-vs-variable-selection-vs-model-selection.html#stepwise-regression"><span class="toc-section-number">17.2.1</span> Stepwise regression</a></li>
<li><a href="17-2-model-building-vs-variable-selection-vs-model-selection.html#cross-validation"><span class="toc-section-number">17.2.2</span> Cross-validation</a></li>
<li><a href="17-2-model-building-vs-variable-selection-vs-model-selection.html#penalization"><span class="toc-section-number">17.2.3</span> Penalization</a></li>
</ul></li>
<li><a href="17-3-shrinkage.html#shrinkage"><span class="toc-section-number">17.3</span> Shrinkage</a></li>
</ul></li>
<li><a href="part-vii-expanding-the-linear-model.html#part-vii-expanding-the-linear-model">Part VII – Expanding the Linear Model</a></li>
<li class="has-sub"><a href="18-models-with-random-effects-blocking-and-pseudoreplication.html#models-with-random-effects-blocking-and-pseudoreplication"><span class="toc-section-number">18</span> Models with random effects – Blocking and pseudoreplication</a><ul>
<li><a href="18-1-random-effects.html#random-effects"><span class="toc-section-number">18.1</span> Random effects</a></li>
<li><a href="18-2-random-effects-in-statistical-models.html#random-effects-in-statistical-models"><span class="toc-section-number">18.2</span> Random effects in statistical models</a></li>
<li><a href="18-3-linear-mixed-models-are-flexible.html#linear-mixed-models-are-flexible"><span class="toc-section-number">18.3</span> Linear mixed models are flexible</a></li>
<li class="has-sub"><a href="18-4-blocking.html#blocking"><span class="toc-section-number">18.4</span> Blocking</a><ul>
<li><a href="18-4-blocking.html#visualing-variation-due-to-blocks"><span class="toc-section-number">18.4.1</span> Visualing variation due to blocks</a></li>
<li><a href="18-4-blocking.html#blocking-increases-precision-of-point-estimates"><span class="toc-section-number">18.4.2</span> Blocking increases precision of point estimates</a></li>
</ul></li>
<li class="has-sub"><a href="18-5-pseudoreplication.html#pseudoreplication"><span class="toc-section-number">18.5</span> Pseudoreplication</a><ul>
<li><a href="18-5-pseudoreplication.html#visualizing-pseduoreplication"><span class="toc-section-number">18.5.1</span> Visualizing pseduoreplication</a></li>
</ul></li>
<li><a href="18-6-mapping-nhst-to-estimation-a-paired-t-test-is-a-special-case-of-a-linear-mixed-model.html#mapping-nhst-to-estimation-a-paired-t-test-is-a-special-case-of-a-linear-mixed-model"><span class="toc-section-number">18.6</span> Mapping NHST to estimation: A paired t-test is a special case of a linear mixed model</a></li>
<li><a href="18-7-advanced-topic-linear-mixed-models-shrink-coefficients-by-partial-pooling.html#advanced-topic-linear-mixed-models-shrink-coefficients-by-partial-pooling"><span class="toc-section-number">18.7</span> Advanced topic – Linear mixed models shrink coefficients by partial pooling</a></li>
<li class="has-sub"><a href="18-8-working-in-r-7.html#working-in-r-7"><span class="toc-section-number">18.8</span> Working in R</a><ul>
<li><a href="18-8-working-in-r-7.html#coral-data"><span class="toc-section-number">18.8.1</span> coral data</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="19-models-for-longitudinal-experiments-pre-post-designs.html#models-for-longitudinal-experiments-pre-post-designs"><span class="toc-section-number">19</span> Models for longitudinal experiments – pre-post designs</a><ul>
<li><a href="19-1-best-practice-models.html#best-practice-models"><span class="toc-section-number">19.1</span> Best practice models</a></li>
<li><a href="19-2-common-alternatives-that-are-not-recommended.html#common-alternatives-that-are-not-recommended"><span class="toc-section-number">19.2</span> Common alternatives that are not recommended</a></li>
<li><a href="19-3-advanced-models.html#advanced-models"><span class="toc-section-number">19.3</span> Advanced models</a></li>
<li class="has-sub"><a href="19-4-understanding-the-alternative-models.html#understanding-the-alternative-models"><span class="toc-section-number">19.4</span> Understanding the alternative models</a><ul>
<li><a href="19-4-understanding-the-alternative-models.html#m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model"><span class="toc-section-number">19.4.1</span> (M1) Linear model with the baseline measure as the covariate (ANCOVA model)</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m2-linear-model-of-the-change-score-change-score-model"><span class="toc-section-number">19.4.2</span> (M2) Linear model of the change score (change-score model)</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model"><span class="toc-section-number">19.4.3</span> (M3) Linear model of post-baseline values without the baseline as a covariate (post model)</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m4-linear-model-with-factorial-fixed-effects-fixed-effects-model"><span class="toc-section-number">19.4.4</span> (M4) Linear model with factorial fixed effects (fixed-effects model)</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m5-repeated-measures-anova"><span class="toc-section-number">19.4.5</span> (M5) Repeated measures ANOVA</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m6-linear-mixed-model"><span class="toc-section-number">19.4.6</span> (M6) Linear mixed model</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m7-linear-model-with-correlated-error"><span class="toc-section-number">19.4.7</span> (M7) Linear model with correlated error</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#m8-constrained-fixed-effects-model-with-correlated-error-clda-model"><span class="toc-section-number">19.4.8</span> (M8) Constrained fixed effects model with correlated error (cLDA model)</a></li>
<li><a href="19-4-understanding-the-alternative-models.html#comparison-table"><span class="toc-section-number">19.4.9</span> Comparison table</a></li>
</ul></li>
<li class="has-sub"><a href="19-5-example-1-a-single-post-baseline-measure-pre-post-design.html#example-1-a-single-post-baseline-measure-pre-post-design"><span class="toc-section-number">19.5</span> Example 1 – a single post-baseline measure (pre-post design)</a><ul>
<li><a href="19-5-example-1-a-single-post-baseline-measure-pre-post-design.html#analysis"><span class="toc-section-number">19.5.1</span> Analysis</a></li>
</ul></li>
<li><a href="19-6-working-in-r-8.html#working-in-r-8"><span class="toc-section-number">19.6</span> Working in R</a></li>
</ul></li>
<li class="has-sub"><a href="20-generalized-linear-models-i-count-data.html#generalized-linear-models-i-count-data"><span class="toc-section-number">20</span> Generalized linear models I: Count data</a><ul>
<li><a href="20-1-the-generalized-linear-model.html#the-generalized-linear-model"><span class="toc-section-number">20.1</span> The generalized linear model</a></li>
<li class="has-sub"><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish"><span class="toc-section-number">20.2</span> Count data example – number of trematode worm larvae in eyes of threespine stickleback fish</a><ul>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#modeling-strategy-1"><span class="toc-section-number">20.2.1</span> Modeling strategy</a></li>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#checking-the-model-i-a-normal-q-q-plot"><span class="toc-section-number">20.2.2</span> Checking the model I – a Normal Q-Q plot</a></li>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#checking-the-model-ii-scale-location-plot-for-checking-homoskedasticity"><span class="toc-section-number">20.2.3</span> Checking the model II – scale-location plot for checking homoskedasticity</a></li>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#two-distributions-for-count-data-poisson-and-negative-binomial"><span class="toc-section-number">20.2.4</span> Two distributions for count data – Poisson and Negative Binomial</a></li>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#fitting-a-glm-with-a-poisson-distribution-to-the-worm-data"><span class="toc-section-number">20.2.5</span> Fitting a GLM with a Poisson distribution to the worm data</a></li>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#model-checking-fits-to-count-data"><span class="toc-section-number">20.2.6</span> Model checking fits to count data</a></li>
<li><a href="20-2-count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish.html#fitting-a-glm-with-a-negative-binomial-distribution-to-the-worm-data"><span class="toc-section-number">20.2.7</span> Fitting a GLM with a Negative Binomial distribution to the worm data</a></li>
</ul></li>
<li class="has-sub"><a href="20-3-working-in-r-9.html#working-in-r-9"><span class="toc-section-number">20.3</span> Working in R</a><ul>
<li><a href="20-3-working-in-r-9.html#fitting-a-glm-to-count-data"><span class="toc-section-number">20.3.1</span> Fitting a GLM to count data</a></li>
<li><a href="20-3-working-in-r-9.html#fitting-a-generalized-linear-mixed-model-glmm-to-count-data"><span class="toc-section-number">20.3.2</span> Fitting a generalized linear mixed model (GLMM) to count data</a></li>
<li><a href="20-3-working-in-r-9.html#fitting-a-generalized-linear-model-to-continouus-data"><span class="toc-section-number">20.3.3</span> Fitting a generalized linear model to continouus data</a></li>
</ul></li>
<li><a href="20-4-problems-2.html#problems-2"><span class="toc-section-number">20.4</span> Problems</a></li>
</ul></li>
<li class="has-sub"><a href="21-linear-models-with-heterogenous-variance.html#linear-models-with-heterogenous-variance"><span class="toc-section-number">21</span> Linear models with heterogenous variance</a><ul>
<li><a href="21-1-gls.html#gls"><span class="toc-section-number">21.1</span> gls</a></li>
</ul></li>
<li><a href="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html#part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models">Part V: Expanding the Linear Model – Generalized Linear Models and Multilevel (Linear Mixed) Models</a></li>
<li class="has-sub"><a href="22-plotting-functions-ggplotsci.html#plotting-functions-ggplotsci"><span class="toc-section-number">22</span> Plotting functions (#ggplotsci)</a><ul>
<li><a href="22-1-odd-even.html#odd-even"><span class="toc-section-number">22.1</span> odd-even</a></li>
<li><a href="22-2-estimate-response-and-effects-with-emmeans.html#estimate-response-and-effects-with-emmeans"><span class="toc-section-number">22.2</span> estimate response and effects with emmeans</a></li>
<li><a href="22-3-emm-table.html#emm_table"><span class="toc-section-number">22.3</span> emm_table</a></li>
<li><a href="22-4-pairs-table.html#pairs_table"><span class="toc-section-number">22.4</span> pairs_table</a></li>
<li><a href="22-5-gg-mean-error.html#gg_mean_error"><span class="toc-section-number">22.5</span> gg_mean_error</a></li>
<li><a href="22-6-gg-ancova.html#gg_ancova"><span class="toc-section-number">22.6</span> gg_ancova</a></li>
<li><a href="22-7-gg-mean-ci-ancova.html#gg_mean_ci_ancova"><span class="toc-section-number">22.7</span> gg_mean_ci_ancova</a></li>
<li><a href="22-8-gg-effects.html#gg_effects"><span class="toc-section-number">22.8</span> gg_effects</a></li>
</ul></li>
<li class="has-sub"><a href="appendix-1-getting-started-with-r.html#appendix-1-getting-started-with-r">Appendix 1: Getting Started with R</a><ul>
<li class="has-sub"><a href="22-9-get-your-computer-ready.html#get-your-computer-ready"><span class="toc-section-number">22.9</span> Get your computer ready</a><ul>
<li><a href="22-9-get-your-computer-ready.html#start-here"><span class="toc-section-number">22.9.1</span> Start here</a></li>
<li><a href="22-9-get-your-computer-ready.html#install-r"><span class="toc-section-number">22.9.2</span> Install R</a></li>
<li><a href="22-9-get-your-computer-ready.html#install-r-studio"><span class="toc-section-number">22.9.3</span> Install R Studio</a></li>
<li><a href="22-9-get-your-computer-ready.html#install-r-markdown-1"><span class="toc-section-number">22.9.4</span> Install R Markdown</a></li>
<li><a href="22-9-get-your-computer-ready.html#optional-alternative-latex-installations"><span class="toc-section-number">22.9.5</span> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li><a href="22-10-start-learning-r-studio.html#start-learning-r-studio"><span class="toc-section-number">22.10</span> Start learning R Studio</a></li>
</ul></li>
<li><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html#appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r">Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="has-sub"><a href="appendix-3-fake-data-simulations.html#appendix-3-fake-data-simulations">Appendix 3: Fake Data Simulations</a><ul>
<li><a href="22-11-performance-of-blocking-relative-to-a-linear-model.html#performance-of-blocking-relative-to-a-linear-model"><span class="toc-section-number">22.11</span> Performance of Blocking relative to a linear model</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="data-wrangling" class="section level2">
<h2><span class="header-section-number">3.3</span> Data wrangling</h2>
<p>Data archived in Excel spreadsheets, at least in wet-bench experimental biology projects, are generally not in a format this is readily analyzed in R, or any statistical software other than perhaps Graphpad Prism. Use these examples as templates for how to import and wrangle Excel-archived data in your project.</p>
<div id="reshaping-data-wide-to-long" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Reshaping data – Wide to long</h3>
<div id="wide-to-long-adipsin-data" class="section level4">
<h4><span class="header-section-number">3.3.1.1</span> Wide to long – Adipsin data</h4>
<p>Source: <a href="https://www.nature.com/articles/s41591-019-0610-4" target="_blank">Adipsin preserves beta cells in diabetic mice and associates with protection from type 2 diabetes in humans</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7256970/" target="_blank">Public source</a> – the Adipsin paper is behind a paywall. A public source of the paper from NIH is available.</p>
<p><a href="https://www.nature.com/articles/s41591-019-0610-4#Sec39" target="_blank">Link to source data</a></p>
<p><img src="images/adipsin_1k_wide.png" width="60%" /></p>
<p>Fig. 1k of the Adipsin paper presents a bar plot of the glucose uptake in response to control (GFP) or <a href="https://en.wikipedia.org/wiki/Factor_D" target="_blank">adipsin</a> treatment. A screenshot of the Excel-archived data is shown above. The data are in <strong>wide format</strong>. In wide-format, the values of a single variable (here, this is glucose uptake level) are given in separate columns for each treatment level (group). The values for the GFP group are in Column A and the values for the Adipsin group are in Column B. Wide format is efficient for computations in a spreadsheet, such as computing means and standard deviations of columns of data, and for plotting.</p>
<p>For most statistical analyses of experimental data in R (and most statistics software), all values of a single variable should be in a single column. This is called <strong>long format</strong>. I’ve manually rearranged the data from the archived spread sheet into long format by stacking each group’s values into a single column, shown in the screen capture below. All values of glucose uptake are in a single column. In long format, there needs to be a way to identify which values belong to which group and this is achieved here with column “treatment”. In adition to the treatment column.</p>
<p><img src="images/adipsin_1k_long.png" width="60%" /></p>
<p>The difference between wide and long also reflects how we think about statistical analysis. When we do a <em>t</em>-test to compare the means of glucose uptake between GFP and Adipsin groups, we might think we have two things: the set of glucose uptake values for the GFP group and the set of values for the Adipsin group. When we fit a linear model, we also have two things, the variable <em>treatment</em> containing treatment level assignment and the variable <em>glucose_uptake</em> containing the glucose uptake values. In wide format, there is nothing to suggest that <em>treatment</em> is a variable.</p>
<p>There are many functions to tidy data from wide to long. <code>melt</code> from the data.table package is especially useful. It is data.table’s version of melt from the reshape2 package.</p>
<p>The major arguments of <code>data.table::melt</code> are</p>
<p><code>melt(data, id.vars, measure.vars, variable.name, value.name)</code></p>
<p><code>melt</code> takes the data in the columns listed in <code>measure.vars</code> and stacks these into a single column named <code>value.name</code>. The names of the columns in <code>measure.vars</code> are the values of the elements in a new column named <code>variable.name</code>. The elements of any column in <code>id.vars</code> are repeated <em>p</em> times, where <em>p</em> is the number of columns that were stacked.</p>
<p>Let’s melt the three different response variables of the adipsin data and <code>merge</code> them into a single data.table. There are several ways to combine data sets including <code>merge</code> and <code>cbind</code>. We’ll compare these later.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="3-3-data-wrangling.html#cb91-1"></a>file_folder &lt;-<span class="st"> &quot;Adipsin preserves beta cells in diabetic mice and associates with protection from type 2 diabetes in humans&quot;</span></span>
<span id="cb91-2"><a href="3-3-data-wrangling.html#cb91-2"></a>fn &lt;-<span class="st"> &quot;41591_2019_610_MOESM3_ESM.xlsx&quot;</span></span>
<span id="cb91-3"><a href="3-3-data-wrangling.html#cb91-3"></a>file_path &lt;-<span class="st"> </span><span class="kw">here</span>(data_folder, file_folder, fn)</span>
<span id="cb91-4"><a href="3-3-data-wrangling.html#cb91-4"></a></span>
<span id="cb91-5"><a href="3-3-data-wrangling.html#cb91-5"></a>treatment_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;db/db-GFP&quot;</span>, <span class="st">&quot;db/db-Adipsin&quot;</span>)</span>
<span id="cb91-6"><a href="3-3-data-wrangling.html#cb91-6"></a></span>
<span id="cb91-7"><a href="3-3-data-wrangling.html#cb91-7"></a><span class="co"># as separate line</span></span>
<span id="cb91-8"><a href="3-3-data-wrangling.html#cb91-8"></a>fig_1k_wide &lt;-<span class="st"> </span><span class="kw">read_excel</span>(file_path,</span>
<span id="cb91-9"><a href="3-3-data-wrangling.html#cb91-9"></a>                    <span class="dt">sheet =</span> <span class="st">&quot;Figure 1k&quot;</span>,</span>
<span id="cb91-10"><a href="3-3-data-wrangling.html#cb91-10"></a>                    <span class="dt">range =</span> <span class="st">&quot;A3:B9&quot;</span>)</span>
<span id="cb91-11"><a href="3-3-data-wrangling.html#cb91-11"></a>fig_1k_wide &lt;-<span class="st"> </span><span class="kw">data.table</span>(fig_1k_wide)</span>
<span id="cb91-12"><a href="3-3-data-wrangling.html#cb91-12"></a>fig_1k &lt;-<span class="st"> </span><span class="kw">melt</span>(fig_1k_wide,</span>
<span id="cb91-13"><a href="3-3-data-wrangling.html#cb91-13"></a>               <span class="dt">measure.vars =</span> treatment_levels,</span>
<span id="cb91-14"><a href="3-3-data-wrangling.html#cb91-14"></a>               <span class="dt">variable.name =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb91-15"><a href="3-3-data-wrangling.html#cb91-15"></a>               <span class="dt">value.name =</span> <span class="st">&quot;glucose_uptake&quot;</span>)</span>
<span id="cb91-16"><a href="3-3-data-wrangling.html#cb91-16"></a></span>
<span id="cb91-17"><a href="3-3-data-wrangling.html#cb91-17"></a><span class="co"># or piped -- which do you prefer?</span></span>
<span id="cb91-18"><a href="3-3-data-wrangling.html#cb91-18"></a>fig_1k &lt;-<span class="st"> </span><span class="kw">read_excel</span>(file_path,</span>
<span id="cb91-19"><a href="3-3-data-wrangling.html#cb91-19"></a>                    <span class="dt">sheet =</span> <span class="st">&quot;Figure 1k&quot;</span>,</span>
<span id="cb91-20"><a href="3-3-data-wrangling.html#cb91-20"></a>                    <span class="dt">range =</span> <span class="st">&quot;A3:B9&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb91-21"><a href="3-3-data-wrangling.html#cb91-21"></a><span class="st">  </span><span class="kw">data.table</span>() <span class="op">%&gt;%</span></span>
<span id="cb91-22"><a href="3-3-data-wrangling.html#cb91-22"></a><span class="st">  </span><span class="kw">melt</span>(<span class="dt">measure.vars =</span> treatment_levels,</span>
<span id="cb91-23"><a href="3-3-data-wrangling.html#cb91-23"></a>       <span class="dt">variable.name =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb91-24"><a href="3-3-data-wrangling.html#cb91-24"></a>       <span class="dt">value.name =</span> <span class="st">&quot;glucose_uptake&quot;</span>)</span>
<span id="cb91-25"><a href="3-3-data-wrangling.html#cb91-25"></a></span>
<span id="cb91-26"><a href="3-3-data-wrangling.html#cb91-26"></a><span class="co"># View(fig_1k) # highlight without the comment sign and &quot;run selected lines()&quot; to view</span></span></code></pre></div>
<p>A pretty-good-plot using the <code>ggpubr</code> package</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="3-3-data-wrangling.html#cb92-1"></a><span class="co"># put warning=FALSE into the chunk header to supress the warning</span></span>
<span id="cb92-2"><a href="3-3-data-wrangling.html#cb92-2"></a></span>
<span id="cb92-3"><a href="3-3-data-wrangling.html#cb92-3"></a>gg &lt;-<span class="st"> </span><span class="kw">ggstripchart</span>(<span class="dt">x =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb92-4"><a href="3-3-data-wrangling.html#cb92-4"></a>                   <span class="dt">y =</span> <span class="st">&quot;glucose_uptake&quot;</span>,</span>
<span id="cb92-5"><a href="3-3-data-wrangling.html#cb92-5"></a>                   <span class="dt">add =</span> <span class="st">&quot;mean_se&quot;</span>,</span>
<span id="cb92-6"><a href="3-3-data-wrangling.html#cb92-6"></a>                   <span class="dt">data =</span> fig_1k)</span>
<span id="cb92-7"><a href="3-3-data-wrangling.html#cb92-7"></a></span>
<span id="cb92-8"><a href="3-3-data-wrangling.html#cb92-8"></a>gg</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-65-1.png" width="576" /></p>
</div>
<div id="wide-to-long-enteric-nervous-system-data" class="section level4">
<h4><span class="header-section-number">3.3.1.2</span> Wide to long – Enteric nervous system data</h4>
<p>Source: <a href="https://doi.org/10.1371/journal.pbio.2000689">Rolig, A. S., Mittge, E. K., Ganz, J., Troll, J. V., Melancon, E., Wiles, T. J., … Guillemin, K. (2017). The enteric nervous system promotes intestinal health by constraining microbiota composition. PLOS Biology, 15(2), e2000689.</a></p>
<p><a href="https://doi.org/10.1371/journal.pbio.2000689.s008">Source data</a></p>
<p>Let’s import and reshape the data for figure 2d. Look at the excel file and the data in Fig. 2d. There is a single treament with four levels, but the authors have organized the data in each level in separate columns and used the column header as the level name.</p>
<p><img src="images/enteric_fig2d_wide.png" width="60%" /></p>
<p>Let’s melt the data from wide to long by stacking the four columns into a single column “neutrophil_count” and adding a treatment column identifying the group.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="3-3-data-wrangling.html#cb93-1"></a>folder &lt;-<span class="st"> &quot;The enteric nervous system promotes intestinal health by constraining microbiota composition&quot;</span></span>
<span id="cb93-2"><a href="3-3-data-wrangling.html#cb93-2"></a>filename &lt;-<span class="st"> &quot;journal.pbio.2000689.s008.xlsx&quot;</span></span>
<span id="cb93-3"><a href="3-3-data-wrangling.html#cb93-3"></a>file_path &lt;-<span class="st"> </span><span class="kw">here</span>(data_folder, folder, filename)</span>
<span id="cb93-4"><a href="3-3-data-wrangling.html#cb93-4"></a></span>
<span id="cb93-5"><a href="3-3-data-wrangling.html#cb93-5"></a><span class="co"># figure 2D data</span></span>
<span id="cb93-6"><a href="3-3-data-wrangling.html#cb93-6"></a>sheet_i &lt;-<span class="st"> &quot;Figure 2&quot;</span></span>
<span id="cb93-7"><a href="3-3-data-wrangling.html#cb93-7"></a>range_i &lt;-<span class="st"> &quot;F2:I24&quot;</span></span>
<span id="cb93-8"><a href="3-3-data-wrangling.html#cb93-8"></a>fig_2d_wide &lt;-<span class="st"> </span><span class="kw">read_excel</span>(file_path, <span class="dt">sheet=</span>sheet_i, <span class="dt">range=</span>range_i) <span class="op">%&gt;%</span></span>
<span id="cb93-9"><a href="3-3-data-wrangling.html#cb93-9"></a><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span></span>
<span id="cb93-10"><a href="3-3-data-wrangling.html#cb93-10"></a><span class="st">  </span><span class="kw">data.table</span>()</span>
<span id="cb93-11"><a href="3-3-data-wrangling.html#cb93-11"></a></span>
<span id="cb93-12"><a href="3-3-data-wrangling.html#cb93-12"></a><span class="co"># change column names by replacing without &quot;_donor&quot; in each name</span></span>
<span id="cb93-13"><a href="3-3-data-wrangling.html#cb93-13"></a><span class="co"># these new column names will become the levels of the treatment factor</span></span>
<span id="cb93-14"><a href="3-3-data-wrangling.html#cb93-14"></a>new_colnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gf&quot;</span>, <span class="st">&quot;wt&quot;</span>, <span class="st">&quot;sox10&quot;</span>, <span class="st">&quot;iap_mo&quot;</span>)</span>
<span id="cb93-15"><a href="3-3-data-wrangling.html#cb93-15"></a><span class="kw">setnames</span>(fig_2d_wide, <span class="dt">old=</span><span class="kw">colnames</span>(fig_2d_wide), <span class="dt">new=</span>new_colnames)</span>
<span id="cb93-16"><a href="3-3-data-wrangling.html#cb93-16"></a></span>
<span id="cb93-17"><a href="3-3-data-wrangling.html#cb93-17"></a><span class="co"># wide to long</span></span>
<span id="cb93-18"><a href="3-3-data-wrangling.html#cb93-18"></a>fig_2d &lt;-<span class="st"> </span><span class="kw">melt</span>(fig_2d_wide, </span>
<span id="cb93-19"><a href="3-3-data-wrangling.html#cb93-19"></a>              <span class="dt">measure.vars=</span><span class="kw">colnames</span>(fig_2d_wide), </span>
<span id="cb93-20"><a href="3-3-data-wrangling.html#cb93-20"></a>              <span class="dt">variable.name=</span><span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb93-21"><a href="3-3-data-wrangling.html#cb93-21"></a>              <span class="dt">value.name=</span><span class="st">&quot;neutrophil_count&quot;</span>)</span>
<span id="cb93-22"><a href="3-3-data-wrangling.html#cb93-22"></a></span>
<span id="cb93-23"><a href="3-3-data-wrangling.html#cb93-23"></a><span class="co"># omit empty rows</span></span>
<span id="cb93-24"><a href="3-3-data-wrangling.html#cb93-24"></a>fig_2d &lt;-<span class="st"> </span><span class="kw">na.omit</span>(fig_2d)</span>
<span id="cb93-25"><a href="3-3-data-wrangling.html#cb93-25"></a></span>
<span id="cb93-26"><a href="3-3-data-wrangling.html#cb93-26"></a><span class="co"># re-order factors</span></span>
<span id="cb93-27"><a href="3-3-data-wrangling.html#cb93-27"></a>fig_2d[, treatment <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(treatment,</span>
<span id="cb93-28"><a href="3-3-data-wrangling.html#cb93-28"></a>                         <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;gf&quot;</span>, <span class="st">&quot;sox10&quot;</span>, <span class="st">&quot;iap_mo&quot;</span>))]</span>
<span id="cb93-29"><a href="3-3-data-wrangling.html#cb93-29"></a></span>
<span id="cb93-30"><a href="3-3-data-wrangling.html#cb93-30"></a><span class="co"># View(fig_2d)</span></span></code></pre></div>
<p>To learn (instead of just copy and modify), it’s best to do this in steps and not run the whole chunk. At each step, look at the result using View. The script above includes three extra wrangling steps.</p>
<ol style="list-style-type: decimal">
<li><p>Changing column names in fig_2d_wide. The column names in wide format will become the treatment level names of the <em>treatment</em> factor after reshaping. It will be easier down the road if these names are shorter and the "_donor" in each name is redundant. The <code>setnames</code> function renames the column names.</p></li>
<li><p>For these data, the number of measures within the different treatments differs and, as a consequence, there are multiple cells with <code>NA</code> which indicates a missing value. <code>View(fig_2d_wide)</code> (this can be typed in the console) to see this. After reshaping to long format (fig_2d), the rows with missing values become empty rows – there is no useful information in them (View this). To see this, re-run the lines of the chunk up to the line “# omit empty rows”. The <code>na.omit</code> function deletes any row with missing values. Here, this deletes these information-less rows. Be very careful with <code>na.omit</code>. You do not want to delete rows of data that contain information you want.</p></li>
<li><p>For both analysis and plots, we want to compare values to the control level, which is named “wt” for the fig_2d data. That is, we want “wt” to be the <em>reference</em> level. To achieve this, the levels of the factor <em>treatment</em> need to be re-ordered using the <code>levels</code> argument. (note, I typically do not add “levels =”, but simply pass the list of levels)</p></li>
</ol>
</div>
<div id="wide-to-long-bee-data" class="section level4">
<h4><span class="header-section-number">3.3.1.3</span> Wide to long – bee data</h4>
<p>The example above is pretty easy, because the all columns in the original data frame are melted (stacked). Here is an example in which only a subset of columns are stacked. In addition, only a subset of the remaining columns are retained in the long format data frame. The data are from Panel A of supplement Fig. 8 (<a href="https://journals.plos.org/plosbiology/article/file?type=supplementary&amp;id=info:doi/10.1371/journal.pbio.2003467.s019" class="uri">https://journals.plos.org/plosbiology/article/file?type=supplementary&amp;id=info:doi/10.1371/journal.pbio.2003467.s019</a>) from</p>
<p>Source: <a href="https://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.2003467">Kešnerová, L., Mars, R.A., Ellegaard, K.M., Troilo, M., Sauer, U. and Engel, P., 2017. Disentangling metabolic functions of bacteria in the honey bee gut. PLoS biology, 15(12), p.e2003467.</a></p>
<p><a href="https://doi.org/10.1371/journal.pbio.2003467.s001">Source data</a></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="3-3-data-wrangling.html#cb94-1"></a>folder &lt;-<span class="st"> &quot;Data from Disentangling metabolic functions of bacteria in the honey bee gut&quot;</span></span>
<span id="cb94-2"><a href="3-3-data-wrangling.html#cb94-2"></a>filename &lt;-<span class="st"> &quot;journal.pbio.2003467.s001.xlsx&quot;</span></span>
<span id="cb94-3"><a href="3-3-data-wrangling.html#cb94-3"></a></span>
<span id="cb94-4"><a href="3-3-data-wrangling.html#cb94-4"></a><span class="co"># figure 2D data</span></span>
<span id="cb94-5"><a href="3-3-data-wrangling.html#cb94-5"></a>sheet_i &lt;-<span class="st"> &quot;S8 Fig&quot;</span></span>
<span id="cb94-6"><a href="3-3-data-wrangling.html#cb94-6"></a>range_i &lt;-<span class="st"> &quot;A2:H12&quot;</span></span>
<span id="cb94-7"><a href="3-3-data-wrangling.html#cb94-7"></a>file_path &lt;-<span class="st"> </span><span class="kw">here</span>(data_folder, folder, filename)</span>
<span id="cb94-8"><a href="3-3-data-wrangling.html#cb94-8"></a>fig_s8a_wide &lt;-<span class="st"> </span><span class="kw">read_excel</span>(file_path,</span>
<span id="cb94-9"><a href="3-3-data-wrangling.html#cb94-9"></a>                      <span class="dt">sheet=</span>sheet_i,</span>
<span id="cb94-10"><a href="3-3-data-wrangling.html#cb94-10"></a>                      <span class="dt">range=</span>range_i) <span class="op">%&gt;%</span></span>
<span id="cb94-11"><a href="3-3-data-wrangling.html#cb94-11"></a><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span></span>
<span id="cb94-12"><a href="3-3-data-wrangling.html#cb94-12"></a><span class="st">  </span><span class="kw">data.table</span>()</span>
<span id="cb94-13"><a href="3-3-data-wrangling.html#cb94-13"></a></span>
<span id="cb94-14"><a href="3-3-data-wrangling.html#cb94-14"></a><span class="co"># wide to long</span></span>
<span id="cb94-15"><a href="3-3-data-wrangling.html#cb94-15"></a>stack_cols &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;replicate&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb94-16"><a href="3-3-data-wrangling.html#cb94-16"></a>fig_s8a &lt;-<span class="st"> </span><span class="kw">melt</span>(fig_s8a_wide,</span>
<span id="cb94-17"><a href="3-3-data-wrangling.html#cb94-17"></a>              <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&quot;media&quot;</span>, <span class="st">&quot;time_h&quot;</span>),</span>
<span id="cb94-18"><a href="3-3-data-wrangling.html#cb94-18"></a>              <span class="dt">measure.vars =</span> stack_cols, </span>
<span id="cb94-19"><a href="3-3-data-wrangling.html#cb94-19"></a>              <span class="dt">variable.name =</span> <span class="st">&quot;Replicate&quot;</span>, </span>
<span id="cb94-20"><a href="3-3-data-wrangling.html#cb94-20"></a>              <span class="dt">value.name =</span> <span class="st">&quot;OD600&quot;</span>) <span class="co"># measure of absorbance at 600nm</span></span></code></pre></div>
</div>
<div id="wide-to-long-stacking-multiple-sets-of-columns" class="section level4">
<h4><span class="header-section-number">3.3.1.4</span> Wide to long – stacking multiple sets of columns</h4>
<p>This example comes from my lab, where a student measured sprint speed in each fish three times prior to treatment and three times following treatment. The wide format data looked something like this</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="3-3-data-wrangling.html#cb95-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb95-2"><a href="3-3-data-wrangling.html#cb95-2"></a>fd_wide &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">fish_ID=</span><span class="kw">paste0</span>(<span class="st">&quot;fish&quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>),</span>
<span id="cb95-3"><a href="3-3-data-wrangling.html#cb95-3"></a>                      <span class="dt">treatment=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;cn&quot;</span>, <span class="st">&quot;tr&quot;</span>), <span class="dt">each=</span><span class="dv">2</span>),</span>
<span id="cb95-4"><a href="3-3-data-wrangling.html#cb95-4"></a>                      <span class="dt">length=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">2</span>),</span>
<span id="cb95-5"><a href="3-3-data-wrangling.html#cb95-5"></a>                      <span class="dt">pre_1=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">50</span>, <span class="dv">5</span>),</span>
<span id="cb95-6"><a href="3-3-data-wrangling.html#cb95-6"></a>                      <span class="dt">pre_2=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">50</span>, <span class="dv">5</span>),</span>
<span id="cb95-7"><a href="3-3-data-wrangling.html#cb95-7"></a>                      <span class="dt">pre_3=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">50</span>, <span class="dv">5</span>),</span>
<span id="cb95-8"><a href="3-3-data-wrangling.html#cb95-8"></a>                      <span class="dt">post_1=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">50</span>, <span class="dv">5</span>),</span>
<span id="cb95-9"><a href="3-3-data-wrangling.html#cb95-9"></a>                      <span class="dt">post_2=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">50</span>, <span class="dv">5</span>),</span>
<span id="cb95-10"><a href="3-3-data-wrangling.html#cb95-10"></a>                      <span class="dt">post_3=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">50</span>, <span class="dv">5</span>)</span>
<span id="cb95-11"><a href="3-3-data-wrangling.html#cb95-11"></a>                      )</span>
<span id="cb95-12"><a href="3-3-data-wrangling.html#cb95-12"></a>knitr<span class="op">::</span><span class="kw">kable</span>(fd_wide, <span class="dt">digits=</span><span class="dv">1</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">fish_ID</th>
<th align="left">treatment</th>
<th align="right">length</th>
<th align="right">pre_1</th>
<th align="right">pre_2</th>
<th align="right">pre_3</th>
<th align="right">post_1</th>
<th align="right">post_2</th>
<th align="right">post_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">fish1</td>
<td align="left">cn</td>
<td align="right">10.7</td>
<td align="right">51.6</td>
<td align="right">52.9</td>
<td align="right">46.9</td>
<td align="right">49.9</td>
<td align="right">54.6</td>
<td align="right">53.1</td>
</tr>
<tr class="even">
<td align="left">fish2</td>
<td align="left">cn</td>
<td align="right">12.4</td>
<td align="right">45.9</td>
<td align="right">48.5</td>
<td align="right">38.9</td>
<td align="right">54.7</td>
<td align="right">53.9</td>
<td align="right">49.7</td>
</tr>
<tr class="odd">
<td align="left">fish3</td>
<td align="left">tr</td>
<td align="right">10.3</td>
<td align="right">52.4</td>
<td align="right">57.6</td>
<td align="right">55.6</td>
<td align="right">54.1</td>
<td align="right">50.4</td>
<td align="right">49.2</td>
</tr>
<tr class="even">
<td align="left">fish4</td>
<td align="left">tr</td>
<td align="right">15.2</td>
<td align="right">53.7</td>
<td align="right">51.9</td>
<td align="right">49.8</td>
<td align="right">53.0</td>
<td align="right">40.1</td>
<td align="right">42.6</td>
</tr>
</tbody>
</table>
<p>To analyze the response (post-treatment sprint) adjusted for pre-treatment sprint, the three pre-treatment sprint measures need to be stacked into a single column and the three post-treatment measures need to be stacked into a single column. This is easy using <code>melt</code> from the data.table package.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="3-3-data-wrangling.html#cb96-1"></a>pre_cols &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;pre&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb96-2"><a href="3-3-data-wrangling.html#cb96-2"></a>post_cols &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;post&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb96-3"><a href="3-3-data-wrangling.html#cb96-3"></a>fd &lt;-<span class="st"> </span><span class="kw">melt</span>(fd_wide,</span>
<span id="cb96-4"><a href="3-3-data-wrangling.html#cb96-4"></a>           <span class="dt">id.vars=</span><span class="kw">c</span>(<span class="st">&quot;fish_ID&quot;</span>, <span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;length&quot;</span>),</span>
<span id="cb96-5"><a href="3-3-data-wrangling.html#cb96-5"></a>           <span class="dt">measure.vars=</span><span class="kw">list</span>(pre_cols, post_cols),</span>
<span id="cb96-6"><a href="3-3-data-wrangling.html#cb96-6"></a>           <span class="dt">variable.name=</span><span class="st">&quot;Order&quot;</span>,</span>
<span id="cb96-7"><a href="3-3-data-wrangling.html#cb96-7"></a>           <span class="dt">value.name=</span><span class="kw">c</span>(<span class="st">&quot;sprint_pre&quot;</span>, <span class="st">&quot;sprint_post&quot;</span>))</span>
<span id="cb96-8"><a href="3-3-data-wrangling.html#cb96-8"></a>knitr<span class="op">::</span><span class="kw">kable</span>(fd, <span class="dt">digits=</span><span class="dv">1</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">fish_ID</th>
<th align="left">treatment</th>
<th align="right">length</th>
<th align="left">Order</th>
<th align="right">sprint_pre</th>
<th align="right">sprint_post</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">fish1</td>
<td align="left">cn</td>
<td align="right">10.7</td>
<td align="left">1</td>
<td align="right">51.6</td>
<td align="right">49.9</td>
</tr>
<tr class="even">
<td align="left">fish2</td>
<td align="left">cn</td>
<td align="right">12.4</td>
<td align="left">1</td>
<td align="right">45.9</td>
<td align="right">54.7</td>
</tr>
<tr class="odd">
<td align="left">fish3</td>
<td align="left">tr</td>
<td align="right">10.3</td>
<td align="left">1</td>
<td align="right">52.4</td>
<td align="right">54.1</td>
</tr>
<tr class="even">
<td align="left">fish4</td>
<td align="left">tr</td>
<td align="right">15.2</td>
<td align="left">1</td>
<td align="right">53.7</td>
<td align="right">53.0</td>
</tr>
<tr class="odd">
<td align="left">fish1</td>
<td align="left">cn</td>
<td align="right">10.7</td>
<td align="left">2</td>
<td align="right">52.9</td>
<td align="right">54.6</td>
</tr>
<tr class="even">
<td align="left">fish2</td>
<td align="left">cn</td>
<td align="right">12.4</td>
<td align="left">2</td>
<td align="right">48.5</td>
<td align="right">53.9</td>
</tr>
<tr class="odd">
<td align="left">fish3</td>
<td align="left">tr</td>
<td align="right">10.3</td>
<td align="left">2</td>
<td align="right">57.6</td>
<td align="right">50.4</td>
</tr>
<tr class="even">
<td align="left">fish4</td>
<td align="left">tr</td>
<td align="right">15.2</td>
<td align="left">2</td>
<td align="right">51.9</td>
<td align="right">40.1</td>
</tr>
<tr class="odd">
<td align="left">fish1</td>
<td align="left">cn</td>
<td align="right">10.7</td>
<td align="left">3</td>
<td align="right">46.9</td>
<td align="right">53.1</td>
</tr>
<tr class="even">
<td align="left">fish2</td>
<td align="left">cn</td>
<td align="right">12.4</td>
<td align="left">3</td>
<td align="right">38.9</td>
<td align="right">49.7</td>
</tr>
<tr class="odd">
<td align="left">fish3</td>
<td align="left">tr</td>
<td align="right">10.3</td>
<td align="left">3</td>
<td align="right">55.6</td>
<td align="right">49.2</td>
</tr>
<tr class="even">
<td align="left">fish4</td>
<td align="left">tr</td>
<td align="right">15.2</td>
<td align="left">3</td>
<td align="right">49.8</td>
<td align="right">42.6</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="reshaping-data-transpose-turning-the-columns-into-rows" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Reshaping data – Transpose (turning the columns into rows)</h3>
<div id="transpose-pi3k-inhibitors-data" class="section level4">
<h4><span class="header-section-number">3.3.2.1</span> Transpose – PI3K inhibitors data</h4>
<p>Source: <a href="https://www.nature.com/articles/s41586-018-0343-4">Suppression of insulin feedback enhances the efficacy of PI3K inhibitors</a></p>
<p><a href="https://www.nature.com/articles/s41586-018-0343-4#Sec15">Source data</a></p>
<p>Figure 3A of this publication is a plot of blood glucose level taken on the same individual mice from four treatment groups over six time periods. Data on a single variable such as blood glucose, taken on the same individual at multiple time points, are known as <strong>longitudial data</strong> but are often mistakenly called <strong>repeated measures data</strong>. There are mulitple ways to analyze longitudinal data, some goood, some less good. There are two reasonable ways to archive longitudinal data for analysis in R. The Excel-archived data for Figure 3A is neither. A screen capture of two of the four treatment groups is shown below.</p>
<p><img src="images/pi3k-inhibitors.png" width="60%" /></p>
<p>In the archived data the individual mice are in columns. The measure at each time point is in rows. And the treatment group is in blocks. Typical data for analysis in R should have the individual mice in rows and each variable in columns (an exception in experimental biology is omics data, such as RNA expression levels. Many packages with functions to analyze these data have the genes on each row and the individual on each column). The Figure 3A data are turned on its side. We need to <strong>transpose</strong> the data, or rotate the matrix 90 degrees (make the columns rows and the rows columns) to turn the data into wide format. From this we can create a new data.table with the data in long format.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="3-3-data-wrangling.html#cb97-1"></a>folder &lt;-<span class="st"> &quot;Suppression of insulin feedback enhances the efficacy of PI3K inhibitors&quot;</span></span>
<span id="cb97-2"><a href="3-3-data-wrangling.html#cb97-2"></a>filename &lt;-<span class="st"> &quot;41586_2018_343_MOESM6_ESM.xlsx&quot;</span></span>
<span id="cb97-3"><a href="3-3-data-wrangling.html#cb97-3"></a>file_path &lt;-<span class="st"> </span><span class="kw">here</span>(data_folder, folder, filename)</span>
<span id="cb97-4"><a href="3-3-data-wrangling.html#cb97-4"></a>pi3k_side &lt;-<span class="st"> </span><span class="kw">read_excel</span>(file_path,</span>
<span id="cb97-5"><a href="3-3-data-wrangling.html#cb97-5"></a>                    <span class="dt">sheet =</span> <span class="st">&quot;Figure 3A (Blood Glucose)&quot;</span>,</span>
<span id="cb97-6"><a href="3-3-data-wrangling.html#cb97-6"></a>                    <span class="dt">range =</span> <span class="st">&quot;A2:U7&quot;</span>,</span>
<span id="cb97-7"><a href="3-3-data-wrangling.html#cb97-7"></a>                    <span class="dt">col_names =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></span>
<span id="cb97-8"><a href="3-3-data-wrangling.html#cb97-8"></a><span class="st">  </span><span class="kw">data.table</span>()</span>
<span id="cb97-9"><a href="3-3-data-wrangling.html#cb97-9"></a></span>
<span id="cb97-10"><a href="3-3-data-wrangling.html#cb97-10"></a><span class="co"># give columns names as the treatment of each mouse</span></span>
<span id="cb97-11"><a href="3-3-data-wrangling.html#cb97-11"></a><span class="co"># verify n=5 per group</span></span>
<span id="cb97-12"><a href="3-3-data-wrangling.html#cb97-12"></a>treatment_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Chow&quot;</span>, <span class="st">&quot;Ketogenic&quot;</span>, <span class="st">&quot;Metformin&quot;</span>, <span class="st">&quot;SGLT2i&quot;</span>)</span>
<span id="cb97-13"><a href="3-3-data-wrangling.html#cb97-13"></a><span class="kw">colnames</span>(pi3k_side) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;time&quot;</span>,</span>
<span id="cb97-14"><a href="3-3-data-wrangling.html#cb97-14"></a>                         <span class="kw">rep</span>(treatment_levels, <span class="dt">each =</span> <span class="dv">5</span>))</span>
<span id="cb97-15"><a href="3-3-data-wrangling.html#cb97-15"></a></span>
<span id="cb97-16"><a href="3-3-data-wrangling.html#cb97-16"></a><span class="co"># transpose</span></span>
<span id="cb97-17"><a href="3-3-data-wrangling.html#cb97-17"></a><span class="co"># keep colnames in &quot;side&quot; as values of treatment col in &quot;wide&quot;</span></span>
<span id="cb97-18"><a href="3-3-data-wrangling.html#cb97-18"></a><span class="co"># make values of &quot;time&quot; in &quot;side&quot; the colnames in &quot;wide&quot;</span></span>
<span id="cb97-19"><a href="3-3-data-wrangling.html#cb97-19"></a>pi3k_wide &lt;-<span class="st"> </span><span class="kw">transpose</span>(pi3k_side,</span>
<span id="cb97-20"><a href="3-3-data-wrangling.html#cb97-20"></a>                       <span class="dt">keep.names =</span> <span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb97-21"><a href="3-3-data-wrangling.html#cb97-21"></a>                       <span class="dt">make.names =</span> <span class="st">&quot;time&quot;</span>)</span>
<span id="cb97-22"><a href="3-3-data-wrangling.html#cb97-22"></a></span>
<span id="cb97-23"><a href="3-3-data-wrangling.html#cb97-23"></a><span class="co"># make a baseline column </span></span>
<span id="cb97-24"><a href="3-3-data-wrangling.html#cb97-24"></a>pi3k_wide[, glucose_<span class="dv">0</span> <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">get</span>(<span class="st">&quot;0&quot;</span>)]</span>
<span id="cb97-25"><a href="3-3-data-wrangling.html#cb97-25"></a></span>
<span id="cb97-26"><a href="3-3-data-wrangling.html#cb97-26"></a><span class="co"># make-up a mouse id for each mouse</span></span>
<span id="cb97-27"><a href="3-3-data-wrangling.html#cb97-27"></a>pi3k_wide[, id <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste</span>(treatment, <span class="dv">1</span><span class="op">:</span>.N, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>), by =<span class="st"> </span>treatment]</span>
<span id="cb97-28"><a href="3-3-data-wrangling.html#cb97-28"></a></span>
<span id="cb97-29"><a href="3-3-data-wrangling.html#cb97-29"></a><span class="co"># make treatement a factor with &quot;chow&quot; as reference</span></span>
<span id="cb97-30"><a href="3-3-data-wrangling.html#cb97-30"></a>pi3k_wide[, treatment <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(treatment, treatment_levels)]</span>
<span id="cb97-31"><a href="3-3-data-wrangling.html#cb97-31"></a></span>
<span id="cb97-32"><a href="3-3-data-wrangling.html#cb97-32"></a><span class="co"># make a long version</span></span>
<span id="cb97-33"><a href="3-3-data-wrangling.html#cb97-33"></a>pi3k_long &lt;-<span class="st"> </span><span class="kw">melt</span>(pi3k_wide,</span>
<span id="cb97-34"><a href="3-3-data-wrangling.html#cb97-34"></a>                  <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;id&quot;</span>, <span class="st">&quot;glucose_0&quot;</span>),</span>
<span id="cb97-35"><a href="3-3-data-wrangling.html#cb97-35"></a>                  <span class="dt">variable.name =</span> <span class="st">&quot;time&quot;</span>,</span>
<span id="cb97-36"><a href="3-3-data-wrangling.html#cb97-36"></a>                  <span class="dt">value.name =</span> <span class="st">&quot;glucose&quot;</span>)</span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>Read the comments on the usage of the <code>keep.names</code> and <code>make.names</code> arguments of <code>transpose</code>. These are powerful.</li>
<li>pi3k_wide has column names that are times (in minutes). This presents wrangling problems (column names shouldn’t be numbers. Here it is useful to create the long format data.table with a time column of numbers). For example, the code above creates copies the column “0” into a new column “glucose_0” using <code>glucose_0 := get("0")</code>. Had the code been <code>glucose_0 := "0"</code>, all values would be the character “0”. Had the code been <code>glucose_0 := 0</code>, all values would be the number 0. <code>get</code> looks for the column with the name of whatever is inside the parentheses.</li>
</ol>
<p>Let’s do a quick plot to examine the data</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="3-3-data-wrangling.html#cb98-1"></a><span class="kw">qplot</span>(<span class="dt">x =</span> time,</span>
<span id="cb98-2"><a href="3-3-data-wrangling.html#cb98-2"></a>      <span class="dt">y =</span> glucose,</span>
<span id="cb98-3"><a href="3-3-data-wrangling.html#cb98-3"></a>      <span class="dt">data =</span> pi3k_long,</span>
<span id="cb98-4"><a href="3-3-data-wrangling.html#cb98-4"></a>      <span class="dt">color =</span> treatment) <span class="op">+</span></span>
<span id="cb98-5"><a href="3-3-data-wrangling.html#cb98-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-73-1.png" width="576" /></p>
</div>
</div>
<div id="combining-data" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Combining data</h3>
<p>Source <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0200817">Bak, A.M., Vendelbo, M.H., Christensen, B., Viggers, R., Bibby, B.M., Rungby, J., Jørgensen, J.O.L., Møller, N. and Jessen, N., 2018. Prolonged fasting-induced metabolic signatures in human skeletal muscle of lean and obese men. PloS one, 13(9), p.e0200817.</a></p>
<p><a href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.6121hj7">Source data</a></p>
<p>The data are from a randomized <strong>crossover</strong> design where 18 men (9 lean and 9 obese) were measured for multiple metabolic markers at two times: 1) in a post-absorptive state after 12 hours overnight fast, and 2) in a prolonged fasting state after 72 hours of fasting. In addition, at each time point, metabolic markers were measured prior to and after an insulin infusion. Here, we want to reproduce values in Table 2, which are measures of mean blood insulin and metabolite levels after 12 hours and 72 hours fasting in both the lean and obese groups.</p>
<p>A difficulty for the analyst is that the response data are in the “Table 2” sheet but the variable containing the assignment to “lean” or “obese” group is in the “Table 1” sheet. To analyze these response, the two datasets need to be combined into a single data frame. The important consideration when combining data is that <em>like is matched with like</em>. For the fasting dataset, “like” is the subject id, and we have some data for each subject id in Table 1 and other data for the same subject ids in Table 2. This means that we essentially want to glue the columns of table 2 to the columns of table 1 in a way that insures that the correct data for each subject id is on the same row. This is a bit more complicated for these data because Table 1 contains 18 data rows, one for each subject id and Table 2 contains 36 data rows, 2 for each subject id, because each subject has data measured at 12 hours and at 72 hours.</p>
</div>
<div id="subsetting-data" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Subsetting data</h3>
<p>It is common to see researchers create multiple subsets of data for further processing. This practice should be be discouraged because the same variables will be in multiple data frames and it can be hard to keep track of any processing of variables in the different datasets. Instead, subset the data at the level of analysis.</p>
<p>There are many ways to subset data in R. Experienced users tend to divide up into those using base R, those using the tidyverse packages, or those using data.table. Learn one well. This book uses data.table. Before outlining usage in data.table, let’s back up a bit and review different <em>indexing</em> systems.</p>
<ul>
<li>In Excel, rows are specified (or “indexed”) by numbers and columns by letters. Every cell has an address, for example C2 is the cell in the 2nd row and 3rd column. Notice that in Excel, the column part of the address comes before the row part.</li>
<li>In statistics, it is extremely common to use a system where <span class="math inline">\(x_{ij}\)</span> is the value of the element in the <em>i</em>th row and <em>j</em>th column of the matrix <strong>X</strong>. Notice that in this notatin, the row index (<em>i</em>) comes before the column index (<em>j</em>).</li>
<li>In programming languages, including R, it is extremely common to use a system where my_data[i, j] is the value of the element in the <em>i</em>th row and <em>j</em>th column of the matrix-like object named “my_data” (such as a data frame in R).</li>
<li>data.table explicitly refers to the row index and column index as <em>i</em> and <em>j</em>.</li>
</ul>
<div id="specifying-a-subset-of-rows-observations-or-cases" class="section level4">
<h4><span class="header-section-number">3.3.4.1</span> Specifying a subset of rows (“observations” or “cases”)</h4>
<p>A subset of rows is specified using either a list of row numbers or</p>
<p>In a data.table, a subset of rows is specified using either a list of row numbers or a combination of comparison operators (==, !=, &gt;, &lt;, &gt;=, &lt;=, %in%) and Boolean logic operators (&amp;, |, ! – these are “and”, “or”, “not”) as <em>i</em>.</p>
<p>Let’s use the pi3k_long data from above to explore this. First, the plot of plasma glucose for all individuals in each treatment group across all time points.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="3-3-data-wrangling.html#cb99-1"></a><span class="kw">qplot</span>(<span class="dt">x =</span> time,</span>
<span id="cb99-2"><a href="3-3-data-wrangling.html#cb99-2"></a>      <span class="dt">y =</span> glucose,</span>
<span id="cb99-3"><a href="3-3-data-wrangling.html#cb99-3"></a>      <span class="dt">data =</span> pi3k_long,</span>
<span id="cb99-4"><a href="3-3-data-wrangling.html#cb99-4"></a>      <span class="dt">color =</span> treatment) <span class="op">+</span></span>
<span id="cb99-5"><a href="3-3-data-wrangling.html#cb99-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-74-1.png" width="576" /></p>
<p><code>pi3k_long[treatment == "Chow",])</code> is the subset of rows in which entries in the column “treatment” take the value “Chow” using the “is equal” (“==”) operator</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="3-3-data-wrangling.html#cb100-1"></a><span class="kw">qplot</span>(<span class="dt">x =</span> time,</span>
<span id="cb100-2"><a href="3-3-data-wrangling.html#cb100-2"></a>      <span class="dt">y =</span> glucose,</span>
<span id="cb100-3"><a href="3-3-data-wrangling.html#cb100-3"></a>      <span class="dt">data =</span> pi3k_long[treatment <span class="op">==</span><span class="st"> &quot;Chow&quot;</span>,],</span>
<span id="cb100-4"><a href="3-3-data-wrangling.html#cb100-4"></a>      <span class="dt">color =</span> treatment) <span class="op">+</span></span>
<span id="cb100-5"><a href="3-3-data-wrangling.html#cb100-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-75-1.png" width="576" /></p>
<p>And the subset of rows in which entries in the column “treatment” take any value but “Chow” using the “not equal” operator (“!=”).</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="3-3-data-wrangling.html#cb101-1"></a><span class="kw">qplot</span>(<span class="dt">x =</span> time,</span>
<span id="cb101-2"><a href="3-3-data-wrangling.html#cb101-2"></a>      <span class="dt">y =</span> glucose,</span>
<span id="cb101-3"><a href="3-3-data-wrangling.html#cb101-3"></a>      <span class="dt">data =</span> pi3k_long[treatment <span class="op">!=</span><span class="st"> &quot;Chow&quot;</span>,],</span>
<span id="cb101-4"><a href="3-3-data-wrangling.html#cb101-4"></a>      <span class="dt">color =</span> treatment) <span class="op">+</span></span>
<span id="cb101-5"><a href="3-3-data-wrangling.html#cb101-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-76-1.png" width="576" /></p>
<p>The subset of rows in which entries in the column “treatment” take either the value “Chow” or the value “SGLT2i” by combining two “is equal” (“==”) operators using the OR (“|”) boolean operator</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="3-3-data-wrangling.html#cb102-1"></a><span class="kw">qplot</span>(<span class="dt">x =</span> time,</span>
<span id="cb102-2"><a href="3-3-data-wrangling.html#cb102-2"></a>      <span class="dt">y =</span> glucose,</span>
<span id="cb102-3"><a href="3-3-data-wrangling.html#cb102-3"></a>      <span class="dt">data =</span> pi3k_long[treatment <span class="op">==</span><span class="st"> &quot;Chow&quot;</span> <span class="op">|</span><span class="st"> </span>treatment <span class="op">==</span><span class="st"> &quot;SGLT2i&quot;</span>,],</span>
<span id="cb102-4"><a href="3-3-data-wrangling.html#cb102-4"></a>      <span class="dt">color =</span> treatment) <span class="op">+</span></span>
<span id="cb102-5"><a href="3-3-data-wrangling.html#cb102-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-77-1.png" width="576" /></p>
<p>The subset of rows in which entries in the column “time” take either the value “30” or the value “60” using the “in a list” operator (%in%). The values in the “time” column look like integers but are actually treatment levels (which act like string or character variables).</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="3-3-data-wrangling.html#cb103-1"></a><span class="kw">qplot</span>(<span class="dt">x =</span> time,</span>
<span id="cb103-2"><a href="3-3-data-wrangling.html#cb103-2"></a>      <span class="dt">y =</span> glucose,</span>
<span id="cb103-3"><a href="3-3-data-wrangling.html#cb103-3"></a>      <span class="dt">data =</span> pi3k_long[time  <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;30&quot;</span>, <span class="st">&quot;60&quot;</span>),],</span>
<span id="cb103-4"><a href="3-3-data-wrangling.html#cb103-4"></a>      <span class="dt">color =</span> treatment) <span class="op">+</span></span>
<span id="cb103-5"><a href="3-3-data-wrangling.html#cb103-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-78-1.png" width="576" /></p>
<p>The subset of rows in which entries in the column “time_c” are less than or equal to 60 using the “less than or equal to” operator AND the value in the treatment column is in the list (“Chow”, “SGLT2i”). The two comparisons are combined with the AND (“&amp;”) Boolean operator.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="3-3-data-wrangling.html#cb104-1"></a>pi3k_long[, time_c <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(time))]</span>
<span id="cb104-2"><a href="3-3-data-wrangling.html#cb104-2"></a><span class="kw">qplot</span>(<span class="dt">x =</span> time,</span>
<span id="cb104-3"><a href="3-3-data-wrangling.html#cb104-3"></a>      <span class="dt">y =</span> glucose,</span>
<span id="cb104-4"><a href="3-3-data-wrangling.html#cb104-4"></a>      <span class="dt">data =</span> pi3k_long[time_c <span class="op">&lt;=</span><span class="st"> </span><span class="dv">30</span> <span class="op">&amp;</span><span class="st"> </span>treatment <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Chow&quot;</span>, <span class="st">&quot;SGLT2i&quot;</span>),],</span>
<span id="cb104-5"><a href="3-3-data-wrangling.html#cb104-5"></a>      <span class="dt">color =</span> treatment) <span class="op">+</span></span>
<span id="cb104-6"><a href="3-3-data-wrangling.html#cb104-6"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-79-1.png" width="576" /></p>
<p>The same result as above but using different operators. I would describe this as, the subset of rows in which entries in the column “time_c” are less than or equal to 60 using the “less than or equal to” operator AND the value in the treatment column is either “Chow” OR “SGLT2i”. The two comparisons are combined with the AND (“&amp;”) Boolean operator. The order of operations is determined by the parentheses, as with all algebra.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="3-3-data-wrangling.html#cb105-1"></a>pi3k_long[, time_c <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(time))]</span>
<span id="cb105-2"><a href="3-3-data-wrangling.html#cb105-2"></a><span class="kw">qplot</span>(<span class="dt">x =</span> time,</span>
<span id="cb105-3"><a href="3-3-data-wrangling.html#cb105-3"></a>      <span class="dt">y =</span> glucose,</span>
<span id="cb105-4"><a href="3-3-data-wrangling.html#cb105-4"></a>      <span class="dt">data =</span> pi3k_long[time_c <span class="op">&lt;=</span><span class="st"> </span><span class="dv">30</span> <span class="op">&amp;</span><span class="st"> </span>(treatment <span class="op">==</span><span class="st"> &quot;Chow&quot;</span> <span class="op">|</span><span class="st"> </span>treatment <span class="op">==</span><span class="st"> &quot;SGLT2i&quot;</span>),],</span>
<span id="cb105-5"><a href="3-3-data-wrangling.html#cb105-5"></a>      <span class="dt">color =</span> treatment) <span class="op">+</span></span>
<span id="cb105-6"><a href="3-3-data-wrangling.html#cb105-6"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-80-1.png" width="576" /></p>
</div>
</div>
<div id="wrangling-columns" class="section level3">
<h3><span class="header-section-number">3.3.5</span> Wrangling columns</h3>
<div id="creating-new-columns-that-are-functions-of-values-in-existing-columnes" class="section level4">
<h4><span class="header-section-number">3.3.5.1</span> Creating new columns that are functions of values in existing columnes</h4>
</div>
<div id="change-the-reference-level-of-a-factor" class="section level4">
<h4><span class="header-section-number">3.3.5.2</span> Change the reference level of a factor</h4>
</div>
<div id="converting-a-single-column-with-all-combinations-of-a-2-x-2-factorial-experiment-into-two-columns-each-containing-the-two-levels-of-a-factor" class="section level4">
<h4><span class="header-section-number">3.3.5.3</span> Converting a single column with all combinations of a 2 x 2 factorial experiment into two columns, each containing the two levels of a factor</h4>
<p>Source: <a href="2018">Tauriello, D., Palomo-Ponce, S., Stork, D. et al. TGFβ drives immune evasion in genetically reconstituted colon cancer metastasis. Nature 554, 538–543</a> <a href="doi:10.1038/nature25492" class="uri">doi:10.1038/nature25492</a></p>
<p><a href="https://www.nature.com/articles/nature25492#Sec23">Source data</a></p>
<p>filename: “41586_2018_BFnature25492_MOESM10_ESM.xlsx”</p>
<p>sheet: “Fig. 4h-tumours”</p>
<p>The analysis of the data in Fig. 4h specifies a single <span class="math inline">\(X\)</span> variable “Treatment” with four levels (or groups): “Con”, “Gal”, “aPD-L1”, and “Gal+aPD-L1”. These levels indicate that the design is actually <strong>factorial</strong> with two factors, each with two levels. The first factor has levels “no Gal” and “Gal”. The second factor has levels “no aPD-L1”, “aPD-L1”. The single column Treatment “flattens” the 2 X 2 factorial design to a 4 x 1 design. In general, we would want to analyze an experiment like this as factorial model, because this allows us to make inferences about the <em>interaction effect</em> between the two factors. For these inferences, we need a standard error, or a confidence interval, or a <em>p</em>-value of the estimate, which we can easily get from the factorial model. In order to analyze the data with a factorial model, we need to create two new columns – one column is the factor variable containing the two levels of Gal and one column is the factor variable containing the two levels of aPD-L1.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="3-3-data-wrangling.html#cb106-1"></a>gal_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;no Gal&quot;</span>, <span class="st">&quot;Gal&quot;</span>)</span>
<span id="cb106-2"><a href="3-3-data-wrangling.html#cb106-2"></a>tumor[, gal <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(treatment <span class="op">==</span><span class="st"> &quot;Gal&quot;</span> <span class="op">|</span><span class="st"> </span>treatment <span class="op">==</span><span class="st"> &quot;Gal+aPD-L1&quot;</span>,</span>
<span id="cb106-3"><a href="3-3-data-wrangling.html#cb106-3"></a>                      gal_levels[<span class="dv">2</span>],</span>
<span id="cb106-4"><a href="3-3-data-wrangling.html#cb106-4"></a>                      gal_levels[<span class="dv">1</span>])]</span>
<span id="cb106-5"><a href="3-3-data-wrangling.html#cb106-5"></a></span>
<span id="cb106-6"><a href="3-3-data-wrangling.html#cb106-6"></a>apd_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;no aPD-L1&quot;</span>, <span class="st">&quot;aPD-L1&quot;</span>)</span>
<span id="cb106-7"><a href="3-3-data-wrangling.html#cb106-7"></a>tumor[, apdl1 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(treatment <span class="op">==</span><span class="st"> &quot;aPD-L1&quot;</span> <span class="op">|</span><span class="st"> </span>treatment <span class="op">==</span><span class="st"> &quot;Gal+aPD-L1&quot;</span>,</span>
<span id="cb106-8"><a href="3-3-data-wrangling.html#cb106-8"></a>                      apd_levels[<span class="dv">2</span>],</span>
<span id="cb106-9"><a href="3-3-data-wrangling.html#cb106-9"></a>                      apd_levels[<span class="dv">1</span>])]</span>
<span id="cb106-10"><a href="3-3-data-wrangling.html#cb106-10"></a></span>
<span id="cb106-11"><a href="3-3-data-wrangling.html#cb106-11"></a><span class="co"># re-order factor levels</span></span>
<span id="cb106-12"><a href="3-3-data-wrangling.html#cb106-12"></a>tumor[, gal<span class="op">:</span><span class="er">=</span><span class="kw">factor</span>(gal, gal_levels)]</span>
<span id="cb106-13"><a href="3-3-data-wrangling.html#cb106-13"></a>tumor[, apdl1<span class="op">:</span><span class="er">=</span><span class="kw">factor</span>(apdl1, apd_levels)]</span></code></pre></div>
<p>A way to check the results to make sure that our conversion is correct is to compute the sampel size for the 2 x 2 combinations, but include the original treatment column in the <code>by</code> list.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="3-3-data-wrangling.html#cb107-1"></a>tumor[<span class="op">!</span><span class="kw">is.na</span>(num_positive_per_mm), .(<span class="dt">N=</span>.N), by=.(treatment, gal, apdl1)]</span></code></pre></div>
<pre><code>##     treatment    gal     apdl1   N
## 1:        Con no Gal no aPD-L1 124
## 2:        Gal    Gal no aPD-L1  89
## 3:     aPD-L1 no Gal    aPD-L1 101
## 4: Gal+aPD-L1    Gal    aPD-L1  58</code></pre>
<p>That looks good.</p>
<p><strong>Bug alert</strong> If you break Rule #1, and type in the treatment level “Gal+aPD-L1” as “Gal + aPD-L1”, then you will get new columns containing junk.</p>
<pre><code>##     treatment    gal     apdl1   N
## 1:        Con no Gal no aPD-L1 124
## 2:        Gal    Gal no aPD-L1  89
## 3:     aPD-L1 no Gal    aPD-L1 101
## 4: Gal+aPD-L1 no Gal no aPD-L1  58</code></pre>
<p>Remember Rule #1. Always copy and paste any text that will be inserted into quotes. This is easily done here by typing <code>unique(tumor$treatment)</code> into the console. This function returns the unique values of the column “treatment” of the data.table “tumor”.</p>
<blockquote>
<p>unique(tumor$treatment)
[1] “Con” “Gal” “aPD-L1” “Gal+aPD-L1”</p>
</blockquote>
<p>Now, copy the name of a level and paste into your code. Repeat until done.</p>
</div>
</div>
<div id="missing-data" class="section level3">
<h3><span class="header-section-number">3.3.6</span> Missing data</h3>
<p>Source: <a href="https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1008002">Deletion of Cdkn1b in ACI rats leads to increased proliferation and pregnancy-associated changes in the mammary gland due to perturbed systemic endocrine environment</a></p>
<p><a href="https://doi.org/10.1371/journal.pgen.1008002.s008">Source data</a></p>
<p>Supplement Figure 1F of this paper shows weight as a function of age class and genotype for the whole body and 8 organs. There are some missing weights in the Excel-archived data. These missing data are designated with a minus “-” sign. To import these data in correctly, use the <code>na =</code> argument in the <code>read_excel</code> function.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="3-3-data-wrangling.html#cb110-1"></a>file_folder &lt;-<span class="st"> &quot;Deletion of Cdkn1b in ACI rats leads to increased proliferation and pregnancy-associated changes in the mammary gland due to perturbed systemic endocrine environment&quot;</span></span>
<span id="cb110-2"><a href="3-3-data-wrangling.html#cb110-2"></a>file_name &lt;-<span class="st"> &quot;journal.pgen.1008002.s008.xlsx&quot;</span></span>
<span id="cb110-3"><a href="3-3-data-wrangling.html#cb110-3"></a>file_path &lt;-<span class="st"> </span><span class="kw">here</span>(data_folder, file_folder, file_name)</span>
<span id="cb110-4"><a href="3-3-data-wrangling.html#cb110-4"></a>  </span>
<span id="cb110-5"><a href="3-3-data-wrangling.html#cb110-5"></a>fig_s1f &lt;-<span class="st"> </span><span class="kw">read_excel</span>(file_path,</span>
<span id="cb110-6"><a href="3-3-data-wrangling.html#cb110-6"></a>                    <span class="dt">sheet =</span> <span class="st">&quot;all weights&quot;</span>,</span>
<span id="cb110-7"><a href="3-3-data-wrangling.html#cb110-7"></a>                    <span class="dt">range =</span> <span class="st">&quot;A2:K57&quot;</span>,</span>
<span id="cb110-8"><a href="3-3-data-wrangling.html#cb110-8"></a>                    <span class="dt">na =</span> <span class="st">&quot;-&quot;</span>,</span>
<span id="cb110-9"><a href="3-3-data-wrangling.html#cb110-9"></a>                    <span class="dt">col_names =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb110-10"><a href="3-3-data-wrangling.html#cb110-10"></a><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span></span>
<span id="cb110-11"><a href="3-3-data-wrangling.html#cb110-11"></a><span class="st">  </span><span class="kw">data.table</span>()</span>
<span id="cb110-12"><a href="3-3-data-wrangling.html#cb110-12"></a></span>
<span id="cb110-13"><a href="3-3-data-wrangling.html#cb110-13"></a>fig_s1f[, genotype <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(genotype, <span class="kw">c</span>(<span class="st">&quot;+/+&quot;</span>, <span class="st">&quot;-/-&quot;</span>))]</span>
<span id="cb110-14"><a href="3-3-data-wrangling.html#cb110-14"></a>fig_s1f[, age_class <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(age_at_sac_wks <span class="op">&lt;=</span><span class="st"> </span><span class="fl">6.0</span>, <span class="st">&quot;4-6&quot;</span>, <span class="st">&quot;8+&quot;</span>)]</span>
<span id="cb110-15"><a href="3-3-data-wrangling.html#cb110-15"></a></span>
<span id="cb110-16"><a href="3-3-data-wrangling.html#cb110-16"></a><span class="co"># View(fig_s1f)</span></span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>In R, a value of “NA” represents missing.</li>
<li>The default value for <code>na =</code> is an empty (or blank) cell (not a space but a cell that is empty).</li>
<li><code>na =</code> accepts a list of strings, for example <code>na = c("", "-99", "--")</code> that will all be read as na.</li>
</ol>
<div id="handling-missing-data" class="section level4">
<h4><span class="header-section-number">3.3.6.1</span> Handling missing data</h4>
<div id="many-base-r-functions-used-for-summary-measures-require-na-handling" class="section level5">
<h5><span class="header-section-number">3.3.6.1.1</span> Many base R functions used for summary measures require NA handling</h5>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="3-3-data-wrangling.html#cb111-1"></a><span class="kw">mean</span>(fig_s1f[, ovary]) <span class="co"># returns &quot;NA&quot;</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="3-3-data-wrangling.html#cb113-1"></a><span class="kw">mean</span>(fig_s1f[, ovary], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="co"># returns the mean</span></span></code></pre></div>
<pre><code>## [1] 0.2489524</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="3-3-data-wrangling.html#cb115-1"></a><span class="kw">sd</span>(fig_s1f[, ovary]) <span class="co"># returns &quot;NA&quot;</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="3-3-data-wrangling.html#cb117-1"></a><span class="kw">sd</span>(fig_s1f[, ovary], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="co"># returns the mean</span></span></code></pre></div>
<pre><code>## [1] 0.151694</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="3-3-data-wrangling.html#cb119-1"></a><span class="kw">sum</span>(fig_s1f[, ovary]) <span class="co"># returns &quot;NA&quot;</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="3-3-data-wrangling.html#cb121-1"></a><span class="kw">sum</span>(fig_s1f[, ovary], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="co"># returns the mean</span></span></code></pre></div>
<pre><code>## [1] 10.456</code></pre>
<p>There are many ways to get the sample size for a particular variable. Be careful if using <code>length()</code> which counts NA as part of the vector of values.</p>
</div>
<div id="the-is.na-function-is-useful" class="section level5">
<h5><span class="header-section-number">3.3.6.1.2</span> The !is.na function is useful</h5>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="3-3-data-wrangling.html#cb123-1"></a><span class="kw">length</span>(fig_s1f[, ovary])</span></code></pre></div>
<pre><code>## [1] 55</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="3-3-data-wrangling.html#cb125-1"></a><span class="kw">length</span>(fig_s1f[<span class="op">!</span><span class="kw">is.na</span>(ovary), ovary])</span></code></pre></div>
<pre><code>## [1] 42</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li><code>!is.na(ovary)</code> is taking the subset of rows of fig_s1f for which the value of “ovary” is not NA (!is.na is read “not is.na”)</li>
</ol>
<p>This is especially useful if you are creating your own code uses counts. Here I create a table of means, standard error of the mean, and 95% CIs of the mean for each genotype group. But first, this script generates the wrong N for each group (since there are missing values), although the mean and SD are correct.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="3-3-data-wrangling.html#cb127-1"></a>fig_s1f[, .(<span class="dt">mean =</span> <span class="kw">mean</span>(spleen, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb127-2"><a href="3-3-data-wrangling.html#cb127-2"></a>            <span class="dt">n =</span> .N,</span>
<span id="cb127-3"><a href="3-3-data-wrangling.html#cb127-3"></a>            <span class="dt">sd =</span> <span class="kw">sd</span>(spleen, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)),</span>
<span id="cb127-4"><a href="3-3-data-wrangling.html#cb127-4"></a>        by =<span class="st"> </span>genotype]</span></code></pre></div>
<pre><code>##    genotype      mean  n         sd
## 1:      -/- 0.5801333 21 0.13680480
## 2:      +/+ 0.2956667 34 0.04460855</code></pre>
<p>To compute the correct <em>n</em>, which will be necessary for computing the SE and the CI, use <code>!is.na</code></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="3-3-data-wrangling.html#cb129-1"></a>spleen_summary &lt;-<span class="st"> </span>fig_s1f[<span class="op">!</span><span class="kw">is.na</span>(spleen), .(<span class="dt">mean =</span> <span class="kw">mean</span>(spleen),</span>
<span id="cb129-2"><a href="3-3-data-wrangling.html#cb129-2"></a>            <span class="dt">n =</span> .N,</span>
<span id="cb129-3"><a href="3-3-data-wrangling.html#cb129-3"></a>            <span class="dt">sd =</span> <span class="kw">sd</span>(spleen)),</span>
<span id="cb129-4"><a href="3-3-data-wrangling.html#cb129-4"></a>        by =<span class="st"> </span>genotype]</span>
<span id="cb129-5"><a href="3-3-data-wrangling.html#cb129-5"></a>spleen_summary[, se <span class="op">:</span><span class="er">=</span><span class="st"> </span>sd<span class="op">/</span><span class="kw">sqrt</span>(n)]</span>
<span id="cb129-6"><a href="3-3-data-wrangling.html#cb129-6"></a>spleen_summary[, lower <span class="op">:</span><span class="er">=</span><span class="st"> </span>mean <span class="op">+</span><span class="st"> </span>se<span class="op">*</span><span class="kw">qt</span>(.<span class="dv">025</span>, (n<span class="dv">-1</span>))]</span>
<span id="cb129-7"><a href="3-3-data-wrangling.html#cb129-7"></a>spleen_summary[, upper <span class="op">:</span><span class="er">=</span><span class="st"> </span>mean <span class="op">+</span><span class="st"> </span>se<span class="op">*</span><span class="kw">qt</span>(.<span class="dv">975</span>, (n<span class="dv">-1</span>))]</span>
<span id="cb129-8"><a href="3-3-data-wrangling.html#cb129-8"></a>spleen_summary</span></code></pre></div>
<pre><code>##    genotype      mean  n         sd         se     lower     upper
## 1:      -/- 0.5801333 15 0.13680480 0.03532285 0.5043734 0.6558933
## 2:      +/+ 0.2956667 27 0.04460855 0.00858492 0.2780201 0.3133132</code></pre>
</div>
<div id="ggplot-functions-automatically-handle-missing-values" class="section level5">
<h5><span class="header-section-number">3.3.6.1.3</span> ggplot functions automatically handle missing values</h5>
<p>with a useful warning.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="3-3-data-wrangling.html#cb131-1"></a><span class="kw">qplot</span>(<span class="dt">x =</span> body_wt_g_sac,</span>
<span id="cb131-2"><a href="3-3-data-wrangling.html#cb131-2"></a>      <span class="dt">y =</span> spleen,</span>
<span id="cb131-3"><a href="3-3-data-wrangling.html#cb131-3"></a>      <span class="dt">color =</span> genotype,</span>
<span id="cb131-4"><a href="3-3-data-wrangling.html#cb131-4"></a>      <span class="dt">data =</span> fig_s1f)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-90-1.png" width="576" /></p>
</div>
<div id="regression-model-functions-lm-glm-gls-etc.-handle-missing-values-by-default" class="section level5">
<h5><span class="header-section-number">3.3.6.1.4</span> Regression model functions (lm, glm, gls, etc.) handle missing values by default</h5>
<p>Missing data in regression model functions such as <code>lm</code> are handled using the argument <code>na.action =</code> and the default is “na.omit”, which omits any rows that contain a missing value in one or more of the model variables (it includes rows if these contain missing values only in the columns not included in the model). It’s as if the user took the subset of data including only the columns containing the model variables and then deleted any row with missing values.</p>
<p>Here is the coefficient table of the fit model object that did not explictly tell the <code>lm</code> function how to handle missing data.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="3-3-data-wrangling.html#cb132-1"></a>m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(spleen <span class="op">~</span><span class="st"> </span>body_wt_g_sac <span class="op">+</span><span class="st"> </span>genotype,</span>
<span id="cb132-2"><a href="3-3-data-wrangling.html#cb132-2"></a>         <span class="dt">data =</span> fig_s1f)</span>
<span id="cb132-3"><a href="3-3-data-wrangling.html#cb132-3"></a><span class="kw">coef</span>(<span class="kw">summary</span>(m1))</span></code></pre></div>
<pre><code>##                 Estimate   Std. Error   t value     Pr(&gt;|t|)
## (Intercept)   0.04238009 0.0242993900  1.744081 8.902319e-02
## body_wt_g_sac 0.00167493 0.0001506493 11.118067 1.170042e-13
## genotype-/-   0.23760586 0.0147600545 16.097898 8.072069e-19</code></pre>
<p>Here is the coefficient table of the fit model object that did explicitly tell <code>lm</code> how to handle missing data, using the argument <code>na.action = "na.exclude"</code>. These coefficient tables are the same.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="3-3-data-wrangling.html#cb134-1"></a>m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(spleen <span class="op">~</span><span class="st"> </span>body_wt_g_sac <span class="op">+</span><span class="st"> </span>genotype,</span>
<span id="cb134-2"><a href="3-3-data-wrangling.html#cb134-2"></a>         <span class="dt">data =</span> fig_s1f,</span>
<span id="cb134-3"><a href="3-3-data-wrangling.html#cb134-3"></a>         <span class="dt">na.action =</span> <span class="st">&quot;na.exclude&quot;</span>)</span>
<span id="cb134-4"><a href="3-3-data-wrangling.html#cb134-4"></a><span class="kw">coef</span>(<span class="kw">summary</span>(m2))</span></code></pre></div>
<pre><code>##                 Estimate   Std. Error   t value     Pr(&gt;|t|)
## (Intercept)   0.04238009 0.0242993900  1.744081 8.902319e-02
## body_wt_g_sac 0.00167493 0.0001506493 11.118067 1.170042e-13
## genotype-/-   0.23760586 0.0147600545 16.097898 8.072069e-19</code></pre>
</div>
</div>
<div id="butbeware-of-fitted-predicted-or-residual-values-from-regression-model-functions-unless-youve-explictly-told-the-function-how-to-handle-missing-values" class="section level4">
<h4><span class="header-section-number">3.3.6.2</span> But…beware of fitted, predicted, or residual values from regression model functions unless you’ve explictly told the function how to handle missing values</h4>
<p><strong>Use <code>na.action = "na.exclude"</code></strong> if you want to add the fitted (or predicted) values or residuals as new columns in the original data object (fig_sf1). Compare the length of the fitted values vector from models m1 (using the default “na.omit”) and m2 (using the “na.exclude”).</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="3-3-data-wrangling.html#cb136-1"></a><span class="kw">length</span>(<span class="kw">fitted</span>(m1))</span></code></pre></div>
<pre><code>## [1] 42</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="3-3-data-wrangling.html#cb138-1"></a><span class="kw">length</span>(<span class="kw">fitted</span>(m2))</span></code></pre></div>
<pre><code>## [1] 55</code></pre>
<p>There are 55 observations (rows in the data) but only 42 complete rows with no missing values. The vector of fitted values from m1 has 42 fitted values. The vector of fitted values from m2 has 55 elements, the 42 fitted values plus 13 NA elements.</p>
<p>This is important if we want to do something like add the fitted values (or residuals, or some function of these) to the original data object (fig_sf1). Here I compute the spleen weights adjusted to the mean body weight of the control (“+/+”) group using the residuals from m1 and m2.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="3-3-data-wrangling.html#cb140-1"></a>mean_x_control &lt;-<span class="st"> </span><span class="kw">mean</span>(fig_s1f[genotype <span class="op">==</span><span class="st"> &quot;+/+&quot;</span>, body_wt_g_sac])</span>
<span id="cb140-2"><a href="3-3-data-wrangling.html#cb140-2"></a>b &lt;-<span class="st"> </span><span class="kw">coef</span>(m1)</span>
<span id="cb140-3"><a href="3-3-data-wrangling.html#cb140-3"></a>fig_s1f[, spleen_adj_m1 <span class="op">:</span><span class="er">=</span><span class="st"> </span>b[<span class="dv">1</span>] <span class="op">+</span></span>
<span id="cb140-4"><a href="3-3-data-wrangling.html#cb140-4"></a><span class="st">          </span>b[<span class="dv">2</span>]<span class="op">*</span>mean_x_control <span class="op">+</span></span>
<span id="cb140-5"><a href="3-3-data-wrangling.html#cb140-5"></a><span class="st">          </span>b[<span class="dv">3</span>]<span class="op">*</span>(<span class="kw">as.integer</span>(genotype)<span class="op">-</span><span class="dv">1</span> <span class="op">+</span></span>
<span id="cb140-6"><a href="3-3-data-wrangling.html#cb140-6"></a><span class="st">          </span><span class="kw">residuals</span>(m1))]</span>
<span id="cb140-7"><a href="3-3-data-wrangling.html#cb140-7"></a>fig_s1f[, spleen_adj_m2 <span class="op">:</span><span class="er">=</span><span class="st"> </span>b[<span class="dv">1</span>] <span class="op">+</span></span>
<span id="cb140-8"><a href="3-3-data-wrangling.html#cb140-8"></a><span class="st">          </span>b[<span class="dv">2</span>]<span class="op">*</span>mean_x_control <span class="op">+</span></span>
<span id="cb140-9"><a href="3-3-data-wrangling.html#cb140-9"></a><span class="st">          </span>b[<span class="dv">3</span>]<span class="op">*</span>(<span class="kw">as.integer</span>(genotype)<span class="op">-</span><span class="dv">1</span> <span class="op">+</span></span>
<span id="cb140-10"><a href="3-3-data-wrangling.html#cb140-10"></a><span class="st">          </span><span class="kw">residuals</span>(m2))]</span>
<span id="cb140-11"><a href="3-3-data-wrangling.html#cb140-11"></a><span class="co"># View(fig_s1f)</span></span></code></pre></div>
<p>The computation of “spleen_adj_m1” returns a warning that the values of <code>residuals(m1)</code> were recycled (the first 42 elements of the new column were filled with the 42 residuals and the last 13 elements of the new column were filled with the first 13 residuals) – after the first row of missing data, all of these computed adjusted values are wrong. Using <code>residuals(m2</code>), the adjusted values are matched to the correct row and the rows with missing variables do not have an adjusted value (because there is no residual to compute this).</p>
</div>
</div>
</div>
<p style="text-align: center;">
<a href="3-2-data-working-in-r.html"><button class="btn btn-default">Previous</button></a>
<a href="3-4-saving-data.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
