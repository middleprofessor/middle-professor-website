<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Violations of independence, homogeneity, or Normality | Statistics for the Bench Biologist</title>
  <meta name="description" content="An introduction to statistical modeling for experimental biology researchers" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Violations of independence, homogeneity, or Normality | Statistics for the Bench Biologist" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Violations of independence, homogeneity, or Normality | Statistics for the Bench Biologist" />
  
  <meta name="twitter:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-checking.html"/>
<link rel="next" href="issues.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistics for the Experimental Biologist</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#linear-models"><i class="fa fa-check"></i>Linear Models</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#arent-t-tests-and-anova-good-enough"><i class="fa fa-check"></i>Aren’t <em>t</em>-tests and ANOVA good enough?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-unusual-about-this-book"><i class="fa fa-check"></i>What is unusual about this book?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-table-of-models.html"><a href="a-table-of-models.html"><i class="fa fa-check"></i>A Table of Models</a>
<ul>
<li class="chapter" data-level="" data-path="a-table-of-models.html"><a href="a-table-of-models.html#including-mapping-between-linear-models-and-classical-tests"><i class="fa fa-check"></i>including mapping between linear models and classical tests</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ask1-intro.html"><a href="ask1-intro.html"><i class="fa fa-check"></i><b>1</b> Analyzing experimental data with a linear model</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ask1-intro.html"><a href="ask1-intro.html#this-text-is-about-using-linear-models-to-estimate-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect"><i class="fa fa-check"></i><b>1.1</b> This text is about using linear models to estimate treatment effects and the uncertainty in our estimates. This, raises the question, what is “an effect”?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-getting-started.html"><a href="part-i-getting-started.html"><i class="fa fa-check"></i>Part I: Getting Started</a></li>
<li class="chapter" data-level="2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html"><i class="fa fa-check"></i><b>2</b> Getting Started – R Projects and R Markdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-vs-r-studio"><i class="fa fa-check"></i><b>2.1</b> R vs R Studio</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#download-and-install-r-and-r-studio"><i class="fa fa-check"></i><b>2.2</b> Download and install R and R studio</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#open-r-studio-and-modify-the-workspace-preference"><i class="fa fa-check"></i><b>2.3</b> Open R Studio and modify the workspace preference</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it"><i class="fa fa-check"></i><b>2.4</b> If you didn’t modify the workspace preferences from the previous section, go back and do it</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-markdown-in-a-nutshell"><i class="fa fa-check"></i><b>2.5</b> R Markdown in a nutshell</a></li>
<li class="chapter" data-level="2.6" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#install-r-markdown"><i class="fa fa-check"></i><b>2.6</b> Install R Markdown</a></li>
<li class="chapter" data-level="2.7" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#importing-packages"><i class="fa fa-check"></i><b>2.7</b> Importing Packages</a></li>
<li class="chapter" data-level="2.8" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#setup-create-project"><i class="fa fa-check"></i><b>2.8</b> Create an R Studio Project for this textbook</a></li>
<li class="chapter" data-level="2.9" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#working-on-a-project-in-a-nutshell"><i class="fa fa-check"></i><b>2.9</b> Working on a project, in a nutshell</a></li>
<li class="chapter" data-level="2.10" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#setup-create-rmd"><i class="fa fa-check"></i><b>2.10</b> Create and setup an R Markdown document (Rmd)</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#modify-the-yaml-header"><i class="fa fa-check"></i><b>2.10.1</b> Modify the yaml header</a></li>
<li class="chapter" data-level="2.10.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#modify-the-setup-chunk"><i class="fa fa-check"></i><b>2.10.2</b> Modify the “setup” chunk</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#lets-play-around-with-an-r-markdown-file"><i class="fa fa-check"></i><b>2.11</b> Let’s play around with an R Markdown file</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-fake-data-chunk"><i class="fa fa-check"></i><b>2.11.1</b> Create a “fake-data” chunk</a></li>
<li class="chapter" data-level="2.11.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-plot-chunk"><i class="fa fa-check"></i><b>2.11.2</b> Create a “plot” chunk</a></li>
<li class="chapter" data-level="2.11.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#knit-the-rmd"><i class="fa fa-check"></i><b>2.11.3</b> Knit the Rmd</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-r-fundamentals.html"><a href="part-ii-r-fundamentals.html"><i class="fa fa-check"></i>Part II: R fundamentals</a></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data – Reading, Wrangling, and Writing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#data-long"><i class="fa fa-check"></i><b>3.1</b> Long data format – the way data should be</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#data-here"><i class="fa fa-check"></i><b>3.2</b> Use the here function to construct the file path</a></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#learning-from-this-chapter"><i class="fa fa-check"></i><b>3.3</b> Learning from this chapter</a></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#data-working-in-r"><i class="fa fa-check"></i><b>3.4</b> Working in R</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data.html"><a href="data.html#importing-data"><i class="fa fa-check"></i><b>3.4.1</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data.html"><a href="data.html#data-wrangling"><i class="fa fa-check"></i><b>3.5</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data.html"><a href="data.html#reshaping-data-wide-to-long"><i class="fa fa-check"></i><b>3.5.1</b> Reshaping data – Wide to long</a></li>
<li class="chapter" data-level="3.5.2" data-path="data.html"><a href="data.html#reshaping-data-transpose-turning-the-columns-into-rows"><i class="fa fa-check"></i><b>3.5.2</b> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li class="chapter" data-level="3.5.3" data-path="data.html"><a href="data.html#combining-data"><i class="fa fa-check"></i><b>3.5.3</b> Combining data</a></li>
<li class="chapter" data-level="3.5.4" data-path="data.html"><a href="data.html#data-subset"><i class="fa fa-check"></i><b>3.5.4</b> Subsetting data</a></li>
<li class="chapter" data-level="3.5.5" data-path="data.html"><a href="data.html#wrangling-columns"><i class="fa fa-check"></i><b>3.5.5</b> Wrangling columns</a></li>
<li class="chapter" data-level="3.5.6" data-path="data.html"><a href="data.html#missing-data"><i class="fa fa-check"></i><b>3.5.6</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data.html"><a href="data.html#saving-data"><i class="fa fa-check"></i><b>3.6</b> Saving data</a></li>
<li class="chapter" data-level="3.7" data-path="data.html"><a href="data.html#exercises"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting-models.html"><a href="plotting-models.html"><i class="fa fa-check"></i><b>4</b> Plotting Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data"><i class="fa fa-check"></i><b>4.1</b> Pretty good plots show the model and the data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot"><i class="fa fa-check"></i><b>4.1.1</b> Pretty good plot component 1: Modeled effects plot</a></li>
<li class="chapter" data-level="4.1.2" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot"><i class="fa fa-check"></i><b>4.1.2</b> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li class="chapter" data-level="4.1.3" data-path="plotting-models.html"><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><i class="fa fa-check"></i><b>4.1.3</b> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
<li class="chapter" data-level="4.1.4" data-path="plotting-models.html"><a href="plotting-models.html#some-comments-on-plot-components"><i class="fa fa-check"></i><b>4.1.4</b> Some comments on plot components</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="plotting-models.html"><a href="plotting-models.html#working-in-r"><i class="fa fa-check"></i><b>4.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="plotting-models.html"><a href="plotting-models.html#source-data"><i class="fa fa-check"></i><b>4.2.1</b> Source data</a></li>
<li class="chapter" data-level="4.2.2" data-path="plotting-models.html"><a href="plotting-models.html#how-to-plot-the-model"><i class="fa fa-check"></i><b>4.2.2</b> How to plot the model</a></li>
<li class="chapter" data-level="4.2.3" data-path="plotting-models.html"><a href="plotting-models.html#be-sure-ggplot_the_model-is-in-your-r-folder"><i class="fa fa-check"></i><b>4.2.3</b> Be sure ggplot_the_model is in your R folder</a></li>
<li class="chapter" data-level="4.2.4" data-path="plotting-models.html"><a href="plotting-models.html#how-to-use-the-plot-the-model-functions"><i class="fa fa-check"></i><b>4.2.4</b> How to use the Plot the Model functions</a></li>
<li class="chapter" data-level="4.2.5" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-a-response-plot-using-ggpubr"><i class="fa fa-check"></i><b>4.2.5</b> How to generate a Response Plot using ggpubr</a></li>
<li class="chapter" data-level="4.2.6" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2"><i class="fa fa-check"></i><b>4.2.6</b> How to generate a Response Plot with a grid of treatments using ggplot2</a></li>
<li class="chapter" data-level="4.2.7" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-an-effects-plot"><i class="fa fa-check"></i><b>4.2.7</b> How to generate an Effects Plot</a></li>
<li class="chapter" data-level="4.2.8" data-path="plotting-models.html"><a href="plotting-models.html#how-to-combine-the-response-and-effects-plots"><i class="fa fa-check"></i><b>4.2.8</b> How to combine the response and effects plots</a></li>
<li class="chapter" data-level="4.2.9" data-path="plotting-models.html"><a href="plotting-models.html#how-to-add-the-interaction-effect-to-response-and-effects-plots"><i class="fa fa-check"></i><b>4.2.9</b> How to add the interaction effect to response and effects plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-some-fundamentals-of-statistical-modeling.html"><a href="part-iii-some-fundamentals-of-statistical-modeling.html"><i class="fa fa-check"></i>Part III: Some Fundamentals of Statistical Modeling</a></li>
<li class="chapter" data-level="5" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>5</b> Variability and Uncertainty (Standard Deviations, Standard Errors, and Confidence Intervals)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="uncertainty.html"><a href="uncertainty.html#standard-errors-are-used-to-compute-p-values-and-confidence-intervals"><i class="fa fa-check"></i><b>5.1</b> Standard errors are used to compute <em>p</em>-values and confidence intervals</a></li>
<li class="chapter" data-level="5.2" data-path="uncertainty.html"><a href="uncertainty.html#background"><i class="fa fa-check"></i><b>5.2</b> Background</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="uncertainty.html"><a href="uncertainty.html#sample-standard-deviation"><i class="fa fa-check"></i><b>5.2.1</b> Sample standard deviation</a></li>
<li class="chapter" data-level="5.2.2" data-path="uncertainty.html"><a href="uncertainty.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.2.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="uncertainty.html"><a href="uncertainty.html#simulations-using-fake-data-as-an-intuition-pump"><i class="fa fa-check"></i><b>5.3</b> Simulations – using fake data as an intuition pump</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="uncertainty.html"><a href="uncertainty.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.3.1</b> Using Google Sheets to generate fake data to explore the standard error</a></li>
<li class="chapter" data-level="5.3.2" data-path="uncertainty.html"><a href="uncertainty.html#using-r-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.3.2</b> Using R to generate fake data to explore the standard error</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="uncertainty.html"><a href="uncertainty.html#bootstrap"><i class="fa fa-check"></i><b>5.4</b> Bootstrapped standard errors</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="uncertainty.html"><a href="uncertainty.html#an-example-of-bootstrapped-standard-errors"><i class="fa fa-check"></i><b>5.4.1</b> An example of bootstrapped standard errors</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="uncertainty.html"><a href="uncertainty.html#confidence-intervals"><i class="fa fa-check"></i><b>5.5</b> Confidence Intervals</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="uncertainty.html"><a href="uncertainty.html#just-the-math"><i class="fa fa-check"></i><b>5.5.1</b> Just the math</a></li>
<li class="chapter" data-level="5.5.2" data-path="uncertainty.html"><a href="uncertainty.html#interpretation-of-a-confidence-interval"><i class="fa fa-check"></i><b>5.5.2</b> Interpretation of a confidence interval</a></li>
<li class="chapter" data-level="5.5.3" data-path="uncertainty.html"><a href="uncertainty.html#bootstrap-confidence-interval"><i class="fa fa-check"></i><b>5.5.3</b> Bootstrap confidence interval</a></li>
<li class="chapter" data-level="5.5.4" data-path="uncertainty.html"><a href="uncertainty.html#a-plot-of-a-parametric-ci-vs.-bootstrap-ci-of-the-means"><i class="fa fa-check"></i><b>5.5.4</b> A plot of a “parametric” CI vs. bootstrap CI of the means</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="uncertainty.html"><a href="uncertainty.html#standard-error-of-a-difference-between-means"><i class="fa fa-check"></i><b>5.6</b> Standard error of a difference between means</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="uncertainty.html"><a href="uncertainty.html#the-standard-error-of-a-difference-between-means-is-the-standard-deviation-of-the-sampling-distribution-of-the-difference"><i class="fa fa-check"></i><b>5.6.1</b> The standard error of a difference between means is the standard deviation of the sampling distribution of the difference</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="uncertainty.html"><a href="uncertainty.html#confidence-limits-of-a-difference-between-means"><i class="fa fa-check"></i><b>5.7</b> Confidence limits of a difference between means</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="uncertainty.html"><a href="uncertainty.html#of-95-cis-of-the-difference-include-the-true-difference"><i class="fa fa-check"></i><b>5.7.1</b> 95% of 95% CIs of the difference include the true difference</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="uncertainty.html"><a href="uncertainty.html#hidden-code"><i class="fa fa-check"></i><b>5.8</b> Hidden code</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="uncertainty.html"><a href="uncertainty.html#import-exp3b"><i class="fa fa-check"></i><b>5.8.1</b> Import exp3b</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="p-values.html"><a href="p-values.html"><i class="fa fa-check"></i><b>6</b> P-values</a>
<ul>
<li class="chapter" data-level="6.1" data-path="p-values.html"><a href="p-values.html#a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution"><i class="fa fa-check"></i><b>6.1</b> A <em>p</em>-value is the probability of sampling a value as or more extreme than the test statistic if sampling from a null distribution</a></li>
<li class="chapter" data-level="6.2" data-path="p-values.html"><a href="p-values.html#pump-your-intuition-creating-a-null-distribution"><i class="fa fa-check"></i><b>6.2</b> Pump your intuition – Creating a null distribution</a></li>
<li class="chapter" data-level="6.3" data-path="p-values.html"><a href="p-values.html#a-null-distribution-of-t-values-the-t-distribution"><i class="fa fa-check"></i><b>6.3</b> A null distribution of <em>t</em>-values – the <em>t</em> distribution</a></li>
<li class="chapter" data-level="6.4" data-path="p-values.html"><a href="p-values.html#p-values-from-the-perspective-of-permutation"><i class="fa fa-check"></i><b>6.4</b> P-values from the perspective of permutation</a></li>
<li class="chapter" data-level="6.5" data-path="p-values.html"><a href="p-values.html#parametric-vs.-non-parametric-statistics"><i class="fa fa-check"></i><b>6.5</b> Parametric vs. non-parametric statistics</a></li>
<li class="chapter" data-level="6.6" data-path="p-values.html"><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values"><i class="fa fa-check"></i><b>6.6</b> frequentist probability and the interpretation of p-values</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="p-values.html"><a href="p-values.html#background-1"><i class="fa fa-check"></i><b>6.6.1</b> Background</a></li>
<li class="chapter" data-level="6.6.2" data-path="p-values.html"><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><i class="fa fa-check"></i><b>6.6.2</b> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li class="chapter" data-level="6.6.3" data-path="p-values.html"><a href="p-values.html#two-interpretations-of-the-p-value"><i class="fa fa-check"></i><b>6.6.3</b> Two interpretations of the <em>p</em>-value</a></li>
<li class="chapter" data-level="6.6.4" data-path="p-values.html"><a href="p-values.html#nhst"><i class="fa fa-check"></i><b>6.6.4</b> NHST</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="p-values.html"><a href="p-values.html#some-major-misconceptions-of-the-p-value"><i class="fa fa-check"></i><b>6.7</b> Some major misconceptions of the <em>p</em>-value</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="p-values.html"><a href="p-values.html#misconception-p-0.05-means-there-is-no-effect-of-treatment"><i class="fa fa-check"></i><b>6.7.1</b> Misconception: <span class="math inline">\(p &gt; 0.05\)</span> means there is no effect of treatment</a></li>
<li class="chapter" data-level="6.7.2" data-path="p-values.html"><a href="p-values.html#misconception-a-p-value-is-repeatable"><i class="fa fa-check"></i><b>6.7.2</b> Misconception: a <em>p</em>-value is repeatable</a></li>
<li class="chapter" data-level="6.7.3" data-path="p-values.html"><a href="p-values.html#misconception-0.05-is-the-lifetime-rate-of-false-discoveries"><i class="fa fa-check"></i><b>6.7.3</b> Misconception: 0.05 is the lifetime rate of false discoveries</a></li>
<li class="chapter" data-level="6.7.4" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-an-important-effect"><i class="fa fa-check"></i><b>6.7.4</b> Misconception: a low <em>p</em>-value indicates an important effect</a></li>
<li class="chapter" data-level="6.7.5" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity"><i class="fa fa-check"></i><b>6.7.5</b> Misconception: a low <em>p</em>-value indicates high model fit or high predictive capacity</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="p-values.html"><a href="p-values.html#what-the-p-value-does-not-mean"><i class="fa fa-check"></i><b>6.8</b> What the <em>p</em>-value does not mean</a></li>
<li class="chapter" data-level="6.9" data-path="p-values.html"><a href="p-values.html#on-using-p-values-in-experimental-biology"><i class="fa fa-check"></i><b>6.9</b> On using <em>p</em>-values in experimental biology</a></li>
<li class="chapter" data-level="6.10" data-path="p-values.html"><a href="p-values.html#better-reproducibility"><i class="fa fa-check"></i><b>6.10</b> Better reproducibility</a></li>
<li class="chapter" data-level="6.11" data-path="p-values.html"><a href="p-values.html#multiple-testing-and-controlling-for-false-positives"><i class="fa fa-check"></i><b>6.11</b> Multiple testing and controlling for false positives</a>
<ul>
<li class="chapter" data-level="6.11.1" data-path="p-values.html"><a href="p-values.html#controlling-the-family-wise-error-rate-when-all-tests-are-testing-the-same-hypothesis"><i class="fa fa-check"></i><b>6.11.1</b> Controlling the family-wise error rate when all tests are testing the same hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="6.12" data-path="p-values.html"><a href="p-values.html#recommendations"><i class="fa fa-check"></i><b>6.12</b> Recommendations</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="p-values.html"><a href="p-values.html#primary-sources-for-recommendations"><i class="fa fa-check"></i><b>6.12.1</b> Primary sources for recommendations</a></li>
</ul></li>
<li class="chapter" data-level="6.13" data-path="p-values.html"><a href="p-values.html#problems"><i class="fa fa-check"></i><b>6.13</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="errors-in-inference.html"><a href="errors-in-inference.html"><i class="fa fa-check"></i><b>7</b> Errors in inference</a>
<ul>
<li class="chapter" data-level="7.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#classical-nhst-concepts-of-wrong"><i class="fa fa-check"></i><b>7.1</b> Classical NHST concepts of wrong</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-i-error"><i class="fa fa-check"></i><b>7.1.1</b> Type I error</a></li>
<li class="chapter" data-level="7.1.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#power"><i class="fa fa-check"></i><b>7.1.2</b> Power</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#a-non-neyman-pearson-concept-of-power"><i class="fa fa-check"></i><b>7.2</b> A non-Neyman-Pearson concept of power</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#estimation-error"><i class="fa fa-check"></i><b>7.2.1</b> Estimation error</a></li>
<li class="chapter" data-level="7.2.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#coverage"><i class="fa fa-check"></i><b>7.2.2</b> Coverage</a></li>
<li class="chapter" data-level="7.2.3" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-s-error"><i class="fa fa-check"></i><b>7.2.3</b> Type S error</a></li>
<li class="chapter" data-level="7.2.4" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-m-error"><i class="fa fa-check"></i><b>7.2.4</b> Type M error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iv-introduction-to-linear-models.html"><a href="part-iv-introduction-to-linear-models.html"><i class="fa fa-check"></i>Part IV: Introduction to Linear Models</a></li>
<li class="chapter" data-level="8" data-path="intro-linear-models.html"><a href="intro-linear-models.html"><i class="fa fa-check"></i><b>8</b> An introduction to linear models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#lm-specifications"><i class="fa fa-check"></i><b>8.1</b> Two specifications of a linear model</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#the-error-draw-specification"><i class="fa fa-check"></i><b>8.1.1</b> The “error draw” specification</a></li>
<li class="chapter" data-level="8.1.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#the-conditional-draw-specification"><i class="fa fa-check"></i><b>8.1.2</b> The “conditional draw” specification</a></li>
<li class="chapter" data-level="8.1.3" data-path="intro-linear-models.html"><a href="intro-linear-models.html#comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model"><i class="fa fa-check"></i><b>8.1.3</b> Comparing the error-draw and conditional-draw ways of specifying the linear model</a></li>
<li class="chapter" data-level="8.1.4" data-path="intro-linear-models.html"><a href="intro-linear-models.html#anova-notation-of-a-linear-model"><i class="fa fa-check"></i><b>8.1.4</b> ANOVA notation of a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"><i class="fa fa-check"></i><b>8.2</b> A linear model can be fit to data with continuous, discrete, or categorical <span class="math inline">\(X\)</span> variables</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete"><i class="fa fa-check"></i><b>8.2.1</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is continuous or discrete</a></li>
<li class="chapter" data-level="8.2.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#slope"><i class="fa fa-check"></i><b>8.2.2</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is categorical</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="intro-linear-models.html"><a href="intro-linear-models.html#statistical-models-are-used-for-prediction-explanation-and-description"><i class="fa fa-check"></i><b>8.3</b> Statistical models are used for prediction, explanation, and description</a></li>
<li class="chapter" data-level="8.4" data-path="intro-linear-models.html"><a href="intro-linear-models.html#what-is-the-interpretation-of-a-regression-coefficient"><i class="fa fa-check"></i><b>8.4</b> What is the interpretation of a regression coefficient?</a></li>
<li class="chapter" data-level="8.5" data-path="intro-linear-models.html"><a href="intro-linear-models.html#what-do-we-call-the-x-and-y-variables"><i class="fa fa-check"></i><b>8.5</b> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li class="chapter" data-level="8.6" data-path="intro-linear-models.html"><a href="intro-linear-models.html#modeling-strategy"><i class="fa fa-check"></i><b>8.6</b> Modeling strategy</a></li>
<li class="chapter" data-level="8.7" data-path="intro-linear-models.html"><a href="intro-linear-models.html#predictions-from-the-model"><i class="fa fa-check"></i><b>8.7</b> Predictions from the model</a></li>
<li class="chapter" data-level="8.8" data-path="intro-linear-models.html"><a href="intro-linear-models.html#inference-from-the-model"><i class="fa fa-check"></i><b>8.8</b> Inference from the model</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#assumptions-for-inference-with-a-statistical-model"><i class="fa fa-check"></i><b>8.8.1</b> Assumptions for inference with a statistical model</a></li>
<li class="chapter" data-level="8.8.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model"><i class="fa fa-check"></i><b>8.8.2</b> Specific assumptions for inference with a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="intro-linear-models.html"><a href="intro-linear-models.html#linear-modelregression-model-or-statistical-model"><i class="fa fa-check"></i><b>8.9</b> “linear model,”regression model”, or “statistical model”?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> Linear models with a single, continuous <em>X</em> (“regression”)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><i class="fa fa-check"></i><b>9.1</b> A linear model with a single, continuous <em>X</em> is classical “regression”</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="regression.html"><a href="regression.html#analysis-of-green-down-data"><i class="fa fa-check"></i><b>9.1.1</b> Analysis of “green-down” data</a></li>
<li class="chapter" data-level="9.1.2" data-path="regression.html"><a href="regression.html#learning-from-the-green-down-example"><i class="fa fa-check"></i><b>9.1.2</b> Learning from the green-down example</a></li>
<li class="chapter" data-level="9.1.3" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-explanation-causal-models"><i class="fa fa-check"></i><b>9.1.3</b> Using a regression model for “explanation” – causal models</a></li>
<li class="chapter" data-level="9.1.4" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-prediction-prediction-models"><i class="fa fa-check"></i><b>9.1.4</b> Using a regression model for prediction – prediction models</a></li>
<li class="chapter" data-level="9.1.5" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data"><i class="fa fa-check"></i><b>9.1.5</b> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</a></li>
<li class="chapter" data-level="9.1.6" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-for-calibration"><i class="fa fa-check"></i><b>9.1.6</b> Using a regression model for for calibration</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#working-in-r-1"><i class="fa fa-check"></i><b>9.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="plotting-models.html"><a href="plotting-models.html#fit-the-model"><i class="fa fa-check"></i><b>9.2.1</b> Fitting the linear model</a></li>
<li class="chapter" data-level="9.2.2" data-path="regression.html"><a href="regression.html#getting-to-know-the-linear-model-the-summary-function"><i class="fa fa-check"></i><b>9.2.2</b> Getting to know the linear model: the <code>summary</code> function</a></li>
<li class="chapter" data-level="9.2.3" data-path="regression.html"><a href="regression.html#inference-the-coefficient-table"><i class="fa fa-check"></i><b>9.2.3</b> Inference – the coefficient table</a></li>
<li class="chapter" data-level="9.2.4" data-path="regression.html"><a href="regression.html#how-good-is-our-model-model-checking"><i class="fa fa-check"></i><b>9.2.4</b> How good is our model? – Model checking</a></li>
<li class="chapter" data-level="9.2.5" data-path="regression.html"><a href="regression.html#plotting-models-with-continuous-x"><i class="fa fa-check"></i><b>9.2.5</b> Plotting models with continuous <em>X</em></a></li>
<li class="chapter" data-level="9.2.6" data-path="regression.html"><a href="regression.html#creating-a-table-of-predicted-values-and-95-prediction-intervals"><i class="fa fa-check"></i><b>9.2.6</b> Creating a table of predicted values and 95% prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="regression.html"><a href="regression.html#hidden-code-1"><i class="fa fa-check"></i><b>9.3</b> Hidden code</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="regression.html"><a href="regression.html#import-and-plot-of-fig2c-ecosystem-warming-experimental-data"><i class="fa fa-check"></i><b>9.3.1</b> Import and plot of fig2c (ecosystem warming experimental) data</a></li>
<li class="chapter" data-level="9.3.2" data-path="regression.html"><a href="regression.html#import-and-plot-efig_3d-ecosysem-warming-observational-data"><i class="fa fa-check"></i><b>9.3.2</b> Import and plot efig_3d (Ecosysem warming observational) data</a></li>
<li class="chapter" data-level="9.3.3" data-path="regression.html"><a href="regression.html#import-and-plot-of-fig1f-methionine-restriction-data"><i class="fa fa-check"></i><b>9.3.3</b> Import and plot of fig1f (methionine restriction) data</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="regression.html"><a href="regression.html#try-it"><i class="fa fa-check"></i><b>9.4</b> Try it</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="regression.html"><a href="regression.html#a-prediction-model-from-the-literature"><i class="fa fa-check"></i><b>9.4.1</b> A prediction model from the literature</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="regression.html"><a href="regression.html#intuition-pumps"><i class="fa fa-check"></i><b>9.5</b> Intuition pumps</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="regression.html"><a href="regression.html#correlation-and-r2"><i class="fa fa-check"></i><b>9.5.1</b> Correlation and $R^2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="oneway.html"><a href="oneway.html"><i class="fa fa-check"></i><b>10</b> Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="oneway.html"><a href="oneway.html#oneway-data"><i class="fa fa-check"></i><b>10.1</b> A linear model with a single factor (categorical <em>X</em>variable) estimates the effects of the levels of factor on the response</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="oneway.html"><a href="oneway.html#oneway-example1"><i class="fa fa-check"></i><b>10.1.1</b> Example 1 (fig3d) – two treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.2" data-path="oneway.html"><a href="oneway.html#understanding-the-analysis-with-two-treatment-levels"><i class="fa fa-check"></i><b>10.1.2</b> Understanding the analysis with two treatment levels</a></li>
<li class="chapter" data-level="10.1.3" data-path="oneway.html"><a href="oneway.html#oneway-example2"><i class="fa fa-check"></i><b>10.1.3</b> Example 2 – three treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.4" data-path="oneway.html"><a href="oneway.html#understanding-the-analysis-with-three-or-more-treatment-levels"><i class="fa fa-check"></i><b>10.1.4</b> Understanding the analysis with three (or more) treatment levels</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="oneway.html"><a href="oneway.html#working-in-r-2"><i class="fa fa-check"></i><b>10.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="oneway.html"><a href="oneway.html#fit-the-model-1"><i class="fa fa-check"></i><b>10.2.1</b> Fit the model</a></li>
<li class="chapter" data-level="10.2.2" data-path="oneway.html"><a href="oneway.html#controlling-the-output-in-tables-using-the-coefficient-table-as-an-example"><i class="fa fa-check"></i><b>10.2.2</b> Controlling the output in tables using the coefficient table as an example</a></li>
<li class="chapter" data-level="10.2.3" data-path="oneway.html"><a href="oneway.html#using-the-emmeans-function"><i class="fa fa-check"></i><b>10.2.3</b> Using the emmeans function</a></li>
<li class="chapter" data-level="10.2.4" data-path="oneway.html"><a href="oneway.html#using-the-contrast-function"><i class="fa fa-check"></i><b>10.2.4</b> Using the contrast function</a></li>
<li class="chapter" data-level="10.2.5" data-path="oneway.html"><a href="oneway.html#how-to-generate-anova-tables"><i class="fa fa-check"></i><b>10.2.5</b> How to generate ANOVA tables</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="oneway.html"><a href="oneway.html#hidden-code-2"><i class="fa fa-check"></i><b>10.3</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="oneway.html"><a href="oneway.html#importing-and-wrangling-the-fig3d-data-for-example-1"><i class="fa fa-check"></i><b>10.3.1</b> Importing and wrangling the fig3d data for example 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="oneway.html"><a href="oneway.html#importing-and-wrangling-the-fig2a-data-for-example-2"><i class="fa fa-check"></i><b>10.3.2</b> Importing and wrangling the fig2a data for example 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>11</b> Model Checking</a>
<ul>
<li class="chapter" data-level="11.1" data-path="model-checking.html"><a href="model-checking.html#check-check"><i class="fa fa-check"></i><b>11.1</b> All statistical analyses should be followed by model checking</a></li>
<li class="chapter" data-level="11.2" data-path="model-checking.html"><a href="model-checking.html#linear-model-assumptions"><i class="fa fa-check"></i><b>11.2</b> Linear model assumptions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="model-checking.html"><a href="model-checking.html#a-bit-about-iid"><i class="fa fa-check"></i><b>11.2.1</b> A bit about IID</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="model-checking.html"><a href="model-checking.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>11.3</b> Diagnostic plots use the residuals from the model fit</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="model-checking.html"><a href="model-checking.html#residuals"><i class="fa fa-check"></i><b>11.3.1</b> Residuals</a></li>
<li class="chapter" data-level="11.3.2" data-path="model-checking.html"><a href="model-checking.html#normal-qq"><i class="fa fa-check"></i><b>11.3.2</b> A Normal Q-Q plot is used to check for characteristic departures from Normality</a></li>
<li class="chapter" data-level="11.3.3" data-path="model-checking.html"><a href="model-checking.html#mapping-qq-plot-departures-from-normality"><i class="fa fa-check"></i><b>11.3.3</b> Mapping QQ-plot departures from Normality</a></li>
<li class="chapter" data-level="11.3.4" data-path="model-checking.html"><a href="model-checking.html#model-checking-spread-level"><i class="fa fa-check"></i><b>11.3.4</b> Model checking homoskedasticity</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="model-checking.html"><a href="model-checking.html#using-r"><i class="fa fa-check"></i><b>11.4</b> Using R</a></li>
<li class="chapter" data-level="11.5" data-path="model-checking.html"><a href="model-checking.html#hidden-code-3"><i class="fa fa-check"></i><b>11.5</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="model-checking.html"><a href="model-checking.html#normal-q-q-plots"><i class="fa fa-check"></i><b>11.5.1</b> Normal Q-Q plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="violations.html"><a href="violations.html"><i class="fa fa-check"></i><b>12</b> Violations of independence, homogeneity, or Normality</a>
<ul>
<li class="chapter" data-level="12.1" data-path="violations.html"><a href="violations.html#oneway-paired-t"><i class="fa fa-check"></i><b>12.1</b> Lack of independence</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="violations.html"><a href="violations.html#violations-paired-t"><i class="fa fa-check"></i><b>12.1.1</b> Example 1 (exp1b) – a paired t-test is a special case of a linear mixed model</a></li>
<li class="chapter" data-level="12.1.2" data-path="violations.html"><a href="violations.html#violations-rmanova"><i class="fa fa-check"></i><b>12.1.2</b> Example 2 (diHOME exp2a) – A repeated measures ANOVA is a special case of a linear mixed model</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="violations.html"><a href="violations.html#oneway-welch"><i class="fa fa-check"></i><b>12.2</b> Heterogeneity of variances</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="violations.html"><a href="violations.html#when-groups-of-the-focal-test-have-variance"><i class="fa fa-check"></i><b>12.2.1</b> When groups of the focal test have &gt;&gt; variance</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="violations.html"><a href="violations.html#the-conditional-response-isnt-normal"><i class="fa fa-check"></i><b>12.3</b> The conditional response isn’t Normal</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="violations.html"><a href="violations.html#violations-6f"><i class="fa fa-check"></i><b>12.3.1</b> Example 1 (fig6f) – Linear models for non-normal count data</a></li>
<li class="chapter" data-level="12.3.2" data-path="violations.html"><a href="violations.html#my-data-arent-normal-what-is-the-best-practice"><i class="fa fa-check"></i><b>12.3.2</b> My data aren’t normal, what is the best practice?</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="violations.html"><a href="violations.html#hidden-code-4"><i class="fa fa-check"></i><b>12.4</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-exp1b-data"><i class="fa fa-check"></i><b>12.4.1</b> Importing and wrangling the exp1b data</a></li>
<li class="chapter" data-level="12.4.2" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-exp2a-data"><i class="fa fa-check"></i><b>12.4.2</b> Importing and wrangling the exp2a data</a></li>
<li class="chapter" data-level="12.4.3" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-fig6f-data"><i class="fa fa-check"></i><b>12.4.3</b> Importing and wrangling the fig6f data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="issues.html"><a href="issues.html"><i class="fa fa-check"></i><b>13</b> Issues in inference</a>
<ul>
<li class="chapter" data-level="13.1" data-path="issues.html"><a href="issues.html#replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means"><i class="fa fa-check"></i><b>13.1</b> Replicated experiments – include <span class="math inline">\(\texttt{Experiment}\)</span> as a random factor (better than one-way ANOVA of means)</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="issues.html"><a href="issues.html#issues-exp4d"><i class="fa fa-check"></i><b>13.1.1</b> Multiple experiments Example 1 (wound healing Exp4d)</a></li>
<li class="chapter" data-level="13.1.2" data-path="issues.html"><a href="issues.html#issues-combined-experiments"><i class="fa fa-check"></i><b>13.1.2</b> Models for combining replicated experiments</a></li>
<li class="chapter" data-level="13.1.3" data-path="issues.html"><a href="issues.html#understanding-model-exp4d_m1"><i class="fa fa-check"></i><b>13.1.3</b> Understanding Model <code>exp4d_m1</code></a></li>
<li class="chapter" data-level="13.1.4" data-path="issues.html"><a href="issues.html#the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2"><i class="fa fa-check"></i><b>13.1.4</b> The univariate model is equivalent to a linear mixed model of the aggregated data (Model exp4d_m2)</a></li>
<li class="chapter" data-level="13.1.5" data-path="issues.html"><a href="issues.html#a-linear-mixed-model-of-the-full-data"><i class="fa fa-check"></i><b>13.1.5</b> A linear mixed model of the full data</a></li>
<li class="chapter" data-level="13.1.6" data-path="issues.html"><a href="issues.html#analysis-of-the-experiment-means-has-less-precision-and-power"><i class="fa fa-check"></i><b>13.1.6</b> Analysis of the experiment means has less precision and power</a></li>
<li class="chapter" data-level="13.1.7" data-path="issues.html"><a href="issues.html#dont-do-this-a-t-testfixed-effect-anova-of-the-full-data"><i class="fa fa-check"></i><b>13.1.7</b> Don’t do this – a t-test/fixed-effect ANOVA of the full data</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="issues.html"><a href="issues.html#issues-pre-post"><i class="fa fa-check"></i><b>13.2</b> Comparing change from baseline (pre-post)</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="issues.html"><a href="issues.html#pre-post-example-1-dpp4-fig4c"><i class="fa fa-check"></i><b>13.2.1</b> Pre-post example 1 (DPP4 fig4c)</a></li>
<li class="chapter" data-level="13.2.2" data-path="issues.html"><a href="issues.html#what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure"><i class="fa fa-check"></i><b>13.2.2</b> What if the data in example 1 were from from an experiment where the treatment was applied prior to the baseline measure?</a></li>
<li class="chapter" data-level="13.2.3" data-path="issues.html"><a href="issues.html#pre-post-example-2-xx-males-fig1c"><i class="fa fa-check"></i><b>13.2.3</b> Pre-post example 2 (XX males fig1c)</a></li>
<li class="chapter" data-level="13.2.4" data-path="issues.html"><a href="issues.html#issues-regression-to-mean"><i class="fa fa-check"></i><b>13.2.4</b> Regression to the mean</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="issues.html"><a href="issues.html#longitudinal-designs-with-more-than-one-post-baseline-measure"><i class="fa fa-check"></i><b>13.3</b> Longitudinal designs with more than one-post baseline measure</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="issues.html"><a href="issues.html#issues-auc"><i class="fa fa-check"></i><b>13.3.1</b> Area under the curve (AUC)</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="issues.html"><a href="issues.html#normalization-the-analysis-of-ratios"><i class="fa fa-check"></i><b>13.4</b> Normalization – the analysis of ratios</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="issues.html"><a href="issues.html#kinds-of-ratios-in-experimental-biology"><i class="fa fa-check"></i><b>13.4.1</b> Kinds of ratios in experimental biology</a></li>
<li class="chapter" data-level="13.4.2" data-path="issues.html"><a href="issues.html#issues-offset"><i class="fa fa-check"></i><b>13.4.2</b> Example 1 – The ratio is a density (number of something per area)</a></li>
<li class="chapter" data-level="13.4.3" data-path="issues.html"><a href="issues.html#issues-size"><i class="fa fa-check"></i><b>13.4.3</b> Example 2 – The ratio is normalizing for size differences</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="issues.html"><a href="issues.html#dont-do-this-stuff"><i class="fa fa-check"></i><b>13.5</b> Don’t do this stuff</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="issues.html"><a href="issues.html#normalize-the-response-so-that-all-control-values-are-equal-to-1."><i class="fa fa-check"></i><b>13.5.1</b> Normalize the response so that all control values are equal to 1.</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="issues.html"><a href="issues.html#a-difference-in-significance-is-not-necessarily-significant"><i class="fa fa-check"></i><b>13.6</b> A difference in significance is not necessarily significant</a></li>
<li class="chapter" data-level="13.7" data-path="issues.html"><a href="issues.html#researcher-degrees-of-freedom"><i class="fa fa-check"></i><b>13.7</b> Researcher degrees of freedom</a></li>
<li class="chapter" data-level="13.8" data-path="issues.html"><a href="issues.html#hidden-code-5"><i class="fa fa-check"></i><b>13.8</b> Hidden code</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="issues.html"><a href="issues.html#import-exp4d-vimentin-cell-count-data-replicate-experiments-example"><i class="fa fa-check"></i><b>13.8.1</b> Import exp4d vimentin cell count data (replicate experiments example)</a></li>
<li class="chapter" data-level="13.8.2" data-path="issues.html"><a href="issues.html#import-fig4c-data"><i class="fa fa-check"></i><b>13.8.2</b> Import Fig4c data</a></li>
<li class="chapter" data-level="13.8.3" data-path="issues.html"><a href="issues.html#xx-males-fig1c"><i class="fa fa-check"></i><b>13.8.3</b> XX males fig1c</a></li>
<li class="chapter" data-level="13.8.4" data-path="issues.html"><a href="issues.html#generation-of-fake-data-to-illustrate-regression-to-the-mean"><i class="fa fa-check"></i><b>13.8.4</b> Generation of fake data to illustrate regression to the mean</a></li>
<li class="chapter" data-level="13.8.5" data-path="issues.html"><a href="issues.html#import-fig3f"><i class="fa fa-check"></i><b>13.8.5</b> Import fig3f</a></li>
<li class="chapter" data-level="13.8.6" data-path="issues.html"><a href="issues.html#issues-import-exp3b"><i class="fa fa-check"></i><b>13.8.6</b> Import exp3b</a></li>
<li class="chapter" data-level="13.8.7" data-path="issues.html"><a href="issues.html#issues-exp3b-plot"><i class="fa fa-check"></i><b>13.8.7</b> Plot the model of exp3b (glm offset data)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-more-than-one-x-multivariable-models.html"><a href="part-v-more-than-one-x-multivariable-models.html"><i class="fa fa-check"></i>Part V: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li class="chapter" data-level="14" data-path="covariates.html"><a href="covariates.html"><i class="fa fa-check"></i><b>14</b> Linear models with added covariates (“ANCOVA”)</a>
<ul>
<li class="chapter" data-level="14.1" data-path="covariates.html"><a href="covariates.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><i class="fa fa-check"></i><b>14.1</b> Adding covariates can increases the precision of the effect of interest</a></li>
<li class="chapter" data-level="14.2" data-path="covariates.html"><a href="covariates.html#understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data"><i class="fa fa-check"></i><b>14.2</b> Understanding a linear model with an added covariate – heart necrosis data</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="covariates.html"><a href="covariates.html#fit-the-model-5"><i class="fa fa-check"></i><b>14.2.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.2.2" data-path="covariates.html"><a href="covariates.html#plot-the-model-2"><i class="fa fa-check"></i><b>14.2.2</b> Plot the model</a></li>
<li class="chapter" data-level="14.2.3" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-model-coefficients"><i class="fa fa-check"></i><b>14.2.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.2.4" data-path="covariates.html"><a href="covariates.html#everything-adds-up"><i class="fa fa-check"></i><b>14.2.4</b> Everything adds up</a></li>
<li class="chapter" data-level="14.2.5" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-estimated-marginal-means"><i class="fa fa-check"></i><b>14.2.5</b> Interpretation of the estimated marginal means</a></li>
<li class="chapter" data-level="14.2.6" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-contrasts"><i class="fa fa-check"></i><b>14.2.6</b> Interpretation of the contrasts</a></li>
<li class="chapter" data-level="14.2.7" data-path="covariates.html"><a href="covariates.html#adding-the-covariate-improves-inference"><i class="fa fa-check"></i><b>14.2.7</b> Adding the covariate improves inference</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="covariates.html"><a href="covariates.html#understanding-interaction-effects-with-covariates"><i class="fa fa-check"></i><b>14.3</b> Understanding interaction effects with covariates</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="covariates.html"><a href="covariates.html#fit-the-model-6"><i class="fa fa-check"></i><b>14.3.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.3.2" data-path="covariates.html"><a href="covariates.html#plot-the-model-with-interaction-effect"><i class="fa fa-check"></i><b>14.3.2</b> Plot the model with interaction effect</a></li>
<li class="chapter" data-level="14.3.3" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-model-coefficients-1"><i class="fa fa-check"></i><b>14.3.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.3.4" data-path="covariates.html"><a href="covariates.html#what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends."><i class="fa fa-check"></i><b>14.3.4</b> What is the effect of a treatment, if interactions are modeled? – it depends.</a></li>
<li class="chapter" data-level="14.3.5" data-path="covariates.html"><a href="covariates.html#which-model-do-we-use-mathcalm_1-or-mathcalm_2"><i class="fa fa-check"></i><b>14.3.5</b> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="covariates.html"><a href="covariates.html#understanding-ancova-tables"><i class="fa fa-check"></i><b>14.4</b> Understanding ANCOVA tables</a></li>
<li class="chapter" data-level="14.5" data-path="covariates.html"><a href="covariates.html#working-in-r-3"><i class="fa fa-check"></i><b>14.5</b> Working in R</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="covariates.html"><a href="covariates.html#importing-the-heart-necrosis-data"><i class="fa fa-check"></i><b>14.5.1</b> Importing the heart necrosis data</a></li>
<li class="chapter" data-level="14.5.2" data-path="covariates.html"><a href="covariates.html#fitting-the-model"><i class="fa fa-check"></i><b>14.5.2</b> Fitting the model</a></li>
<li class="chapter" data-level="14.5.3" data-path="covariates.html"><a href="covariates.html#using-the-emmeans-function-1"><i class="fa fa-check"></i><b>14.5.3</b> Using the emmeans function</a></li>
<li class="chapter" data-level="14.5.4" data-path="covariates.html"><a href="covariates.html#ancova-tables"><i class="fa fa-check"></i><b>14.5.4</b> ANCOVA tables</a></li>
<li class="chapter" data-level="14.5.5" data-path="covariates.html"><a href="covariates.html#plotting-the-model"><i class="fa fa-check"></i><b>14.5.5</b> Plotting the model</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="covariates.html"><a href="covariates.html#best-practices"><i class="fa fa-check"></i><b>14.6</b> Best practices</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="covariates.html"><a href="covariates.html#do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate"><i class="fa fa-check"></i><b>14.6.1</b> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</a></li>
<li class="chapter" data-level="14.6.2" data-path="covariates.html"><a href="covariates.html#do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate"><i class="fa fa-check"></i><b>14.6.2</b> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</a></li>
<li class="chapter" data-level="14.6.3" data-path="covariates.html"><a href="covariates.html#do-not-test-for-balance-of-baseline-measures"><i class="fa fa-check"></i><b>14.6.3</b> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="covariates.html"><a href="covariates.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><i class="fa fa-check"></i><b>14.7</b> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="factorial.html"><a href="factorial.html"><i class="fa fa-check"></i><b>15</b> Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</a>
<ul>
<li class="chapter" data-level="15.1" data-path="factorial.html"><a href="factorial.html#a-linear-model-with-crossed-factors-estimates-interaction-effects"><i class="fa fa-check"></i><b>15.1</b> A linear model with crossed factors estimates interaction effects</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="factorial.html"><a href="factorial.html#an-interaction-is-a-difference-in-simple-effects"><i class="fa fa-check"></i><b>15.1.1</b> An interaction is a difference in simple effects</a></li>
<li class="chapter" data-level="15.1.2" data-path="factorial.html"><a href="factorial.html#a-linear-model-with-crossed-factors-includes-interaction-effects"><i class="fa fa-check"></i><b>15.1.2</b> A linear model with crossed factors includes interaction effects</a></li>
<li class="chapter" data-level="15.1.3" data-path="factorial.html"><a href="factorial.html#factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature"><i class="fa fa-check"></i><b>15.1.3</b> factorial experiments are frequently analyzed as flattened linear models in the experimental biology literature</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="factorial.html"><a href="factorial.html#example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data"><i class="fa fa-check"></i><b>15.2</b> Example 1 – Estimation of a treatment effect relative to a control effect (“Something different”) (Experiment 2j glucose uptake data)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="factorial.html"><a href="factorial.html#twoway-understand1"><i class="fa fa-check"></i><b>15.2.1</b> Understand the experimental design</a></li>
<li class="chapter" data-level="15.2.2" data-path="factorial.html"><a href="factorial.html#fit-the-linear-model"><i class="fa fa-check"></i><b>15.2.2</b> Fit the linear model</a></li>
<li class="chapter" data-level="15.2.3" data-path="factorial.html"><a href="factorial.html#twoway-exp2j-inf"><i class="fa fa-check"></i><b>15.2.3</b> Inference</a></li>
<li class="chapter" data-level="15.2.4" data-path="factorial.html"><a href="factorial.html#plot-the-model-3"><i class="fa fa-check"></i><b>15.2.4</b> Plot the model</a></li>
<li class="chapter" data-level="15.2.5" data-path="factorial.html"><a href="factorial.html#alternaplot-the-model"><i class="fa fa-check"></i><b>15.2.5</b> alternaPlot the model</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-1"><i class="fa fa-check"></i><b>15.3</b> Understanding the linear model with crossed factors 1</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="factorial.html"><a href="factorial.html#twoway-what-coefs-are"><i class="fa fa-check"></i><b>15.3.1</b> What the coefficients are</a></li>
<li class="chapter" data-level="15.3.2" data-path="factorial.html"><a href="factorial.html#the-interaction-effect-is-something-different"><i class="fa fa-check"></i><b>15.3.2</b> The interaction effect is something different</a></li>
<li class="chapter" data-level="15.3.3" data-path="factorial.html"><a href="factorial.html#why-we-want-to-compare-the-treatment-effect-to-a-control-effect"><i class="fa fa-check"></i><b>15.3.3</b> Why we want to compare the treatment effect to a control effect</a></li>
<li class="chapter" data-level="15.3.4" data-path="factorial.html"><a href="factorial.html#the-order-of-the-factors-in-the-model-tells-the-same-story-differently"><i class="fa fa-check"></i><b>15.3.4</b> The order of the factors in the model tells the same story differently</a></li>
<li class="chapter" data-level="15.3.5" data-path="factorial.html"><a href="factorial.html#power-for-the-interaction-effect-is-less-than-that-for-simple-effects"><i class="fa fa-check"></i><b>15.3.5</b> Power for the interaction effect is less than that for simple effects</a></li>
<li class="chapter" data-level="15.3.6" data-path="factorial.html"><a href="factorial.html#planned-comparisons-vs.-post-hoc-tests"><i class="fa fa-check"></i><b>15.3.6</b> Planned comparisons vs. post-hoc tests</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="factorial.html"><a href="factorial.html#example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data"><i class="fa fa-check"></i><b>15.4</b> Example 2: Estimation of the effect of background condition on an effect (“it depends”) (Experiment 3e lesian area data)</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="factorial.html"><a href="factorial.html#understand-the-experimental-design"><i class="fa fa-check"></i><b>15.4.1</b> Understand the experimental design</a></li>
<li class="chapter" data-level="15.4.2" data-path="factorial.html"><a href="factorial.html#fit-the-linear-model-1"><i class="fa fa-check"></i><b>15.4.2</b> Fit the linear model</a></li>
<li class="chapter" data-level="15.4.3" data-path="factorial.html"><a href="factorial.html#check-the-model-1"><i class="fa fa-check"></i><b>15.4.3</b> Check the model</a></li>
<li class="chapter" data-level="15.4.4" data-path="factorial.html"><a href="factorial.html#inference-from-the-model-2"><i class="fa fa-check"></i><b>15.4.4</b> Inference from the model</a></li>
<li class="chapter" data-level="15.4.5" data-path="factorial.html"><a href="factorial.html#plot-the-model-4"><i class="fa fa-check"></i><b>15.4.5</b> Plot the model</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-2"><i class="fa fa-check"></i><b>15.5</b> Understanding the linear model with crossed factors 2</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="factorial.html"><a href="factorial.html#twoway-marginal-means"><i class="fa fa-check"></i><b>15.5.1</b> Conditional and marginal means</a></li>
<li class="chapter" data-level="15.5.2" data-path="factorial.html"><a href="factorial.html#simple-conditional-effects"><i class="fa fa-check"></i><b>15.5.2</b> Simple (conditional) effects</a></li>
<li class="chapter" data-level="15.5.3" data-path="factorial.html"><a href="factorial.html#twoway-marginal-effects"><i class="fa fa-check"></i><b>15.5.3</b> Marginal effects</a></li>
<li class="chapter" data-level="15.5.4" data-path="factorial.html"><a href="factorial.html#the-additive-model"><i class="fa fa-check"></i><b>15.5.4</b> The additive model</a></li>
<li class="chapter" data-level="15.5.5" data-path="factorial.html"><a href="factorial.html#twoway-reduce"><i class="fa fa-check"></i><b>15.5.5</b> Reduce models for the right reason</a></li>
<li class="chapter" data-level="15.5.6" data-path="factorial.html"><a href="factorial.html#the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird"><i class="fa fa-check"></i><b>15.5.6</b> The marginal means of an additive linear model with two factors can be weird</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="factorial.html"><a href="factorial.html#example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data"><i class="fa fa-check"></i><b>15.6</b> Example 3: Estimation of synergy (“More than the sum of the parts”) (Experiment 1c JA data)</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="factorial.html"><a href="factorial.html#examine-the-data"><i class="fa fa-check"></i><b>15.6.1</b> Examine the data</a></li>
<li class="chapter" data-level="15.6.2" data-path="factorial.html"><a href="factorial.html#fit-the-model-7"><i class="fa fa-check"></i><b>15.6.2</b> Fit the model</a></li>
<li class="chapter" data-level="15.6.3" data-path="factorial.html"><a href="factorial.html#model-check"><i class="fa fa-check"></i><b>15.6.3</b> Model check</a></li>
<li class="chapter" data-level="15.6.4" data-path="factorial.html"><a href="factorial.html#inference-from-the-model-3"><i class="fa fa-check"></i><b>15.6.4</b> Inference from the model</a></li>
<li class="chapter" data-level="15.6.5" data-path="factorial.html"><a href="factorial.html#plot-the-model-5"><i class="fa fa-check"></i><b>15.6.5</b> Plot the model</a></li>
<li class="chapter" data-level="15.6.6" data-path="factorial.html"><a href="factorial.html#alternative-plot"><i class="fa fa-check"></i><b>15.6.6</b> Alternative plot</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-3"><i class="fa fa-check"></i><b>15.7</b> Understanding the linear model with crossed factors 3</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="factorial.html"><a href="factorial.html#thinking-about-the-coefficients-of-the-linear-model"><i class="fa fa-check"></i><b>15.7.1</b> Thinking about the coefficients of the linear model</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="factorial.html"><a href="factorial.html#issues-in-inference"><i class="fa fa-check"></i><b>15.8</b> Issues in inference</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="factorial.html"><a href="factorial.html#for-pairwise-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><i class="fa fa-check"></i><b>15.8.1</b> For pairwise contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li class="chapter" data-level="15.8.2" data-path="factorial.html"><a href="factorial.html#for-interaction-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><i class="fa fa-check"></i><b>15.8.2</b> For interaction contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li class="chapter" data-level="15.8.3" data-path="factorial.html"><a href="factorial.html#twoway-multiple-tests"><i class="fa fa-check"></i><b>15.8.3</b> Adjusting <em>p</em>-values for multiple tests</a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="factorial.html"><a href="factorial.html#two-way-anova"><i class="fa fa-check"></i><b>15.9</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="15.9.1" data-path="factorial.html"><a href="factorial.html#how-to-read-a-two-way-anova-table"><i class="fa fa-check"></i><b>15.9.1</b> How to read a two-way ANOVA table</a></li>
<li class="chapter" data-level="15.9.2" data-path="factorial.html"><a href="factorial.html#what-do-the-main-effects-in-an-anova-table-mean"><i class="fa fa-check"></i><b>15.9.2</b> What do the main effects in an ANOVA table mean?</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="factorial.html"><a href="factorial.html#more-issues-in-inference"><i class="fa fa-check"></i><b>15.10</b> More issues in inference</a>
<ul>
<li class="chapter" data-level="15.10.1" data-path="factorial.html"><a href="factorial.html#longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova"><i class="fa fa-check"></i><b>15.10.1</b> Longitudinal experiments – include Time as a random factor (better than repeated measures ANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="factorial.html"><a href="factorial.html#working-in-r-4"><i class="fa fa-check"></i><b>15.11</b> Working in R</a>
<ul>
<li class="chapter" data-level="15.11.1" data-path="factorial.html"><a href="factorial.html#model-formula"><i class="fa fa-check"></i><b>15.11.1</b> Model formula</a></li>
<li class="chapter" data-level="15.11.2" data-path="factorial.html"><a href="factorial.html#using-the-emmeans-function-2"><i class="fa fa-check"></i><b>15.11.2</b> Using the emmeans function</a></li>
<li class="chapter" data-level="15.11.3" data-path="factorial.html"><a href="factorial.html#contrasts"><i class="fa fa-check"></i><b>15.11.3</b> Contrasts</a></li>
<li class="chapter" data-level="15.11.4" data-path="factorial.html"><a href="factorial.html#practice-safe-anova"><i class="fa fa-check"></i><b>15.11.4</b> Practice safe ANOVA</a></li>
<li class="chapter" data-level="15.11.5" data-path="factorial.html"><a href="factorial.html#better-to-avoid-these"><i class="fa fa-check"></i><b>15.11.5</b> Better to avoid these</a></li>
</ul></li>
<li class="chapter" data-level="15.12" data-path="factorial.html"><a href="factorial.html#hidden-code-6"><i class="fa fa-check"></i><b>15.12</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="15.12.1" data-path="factorial.html"><a href="factorial.html#import-exp2j-example-1"><i class="fa fa-check"></i><b>15.12.1</b> Import exp2j (Example 1)</a></li>
<li class="chapter" data-level="15.12.2" data-path="factorial.html"><a href="factorial.html#import-exp3e-lesian-area-data-example-2"><i class="fa fa-check"></i><b>15.12.2</b> Import exp3e lesian area data (Example 2)</a></li>
<li class="chapter" data-level="15.12.3" data-path="factorial.html"><a href="factorial.html#import-exp1c-ja-data-example-3"><i class="fa fa-check"></i><b>15.12.3</b> Import Exp1c JA data (Example 3)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-vi-expanding-the-linear-model.html"><a href="part-vi-expanding-the-linear-model.html"><i class="fa fa-check"></i>Part VI – Expanding the Linear Model</a></li>
<li class="chapter" data-level="16" data-path="lmm.html"><a href="lmm.html"><i class="fa fa-check"></i><b>16</b> Models for non-independence – linear mixed models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="lmm.html"><a href="lmm.html#liberal-inference-from-pseudoreplication"><i class="fa fa-check"></i><b>16.1</b> Liberal inference from pseudoreplication</a></li>
<li class="chapter" data-level="16.2" data-path="lmm.html"><a href="lmm.html#conservative-inference-from-failure-to-identify-blocks"><i class="fa fa-check"></i><b>16.2</b> Conservative inference from failure to identify blocks</a></li>
<li class="chapter" data-level="16.3" data-path="lmm.html"><a href="lmm.html#introduction-to-models-for-non-independent-data-linear-mixed-models"><i class="fa fa-check"></i><b>16.3</b> Introduction to models for non-independent data (linear mixed models)</a></li>
<li class="chapter" data-level="16.4" data-path="lmm.html"><a href="lmm.html#experimental-designs-in-experimental-bench-biology"><i class="fa fa-check"></i><b>16.4</b> Experimental designs in experimental bench biology</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="lmm.html"><a href="lmm.html#notation-for-models"><i class="fa fa-check"></i><b>16.4.1</b> Notation for models</a></li>
<li class="chapter" data-level="16.4.2" data-path="lmm.html"><a href="lmm.html#completely-randomized-design-crd"><i class="fa fa-check"></i><b>16.4.2</b> Completely Randomized Design (CRD)</a></li>
<li class="chapter" data-level="16.4.3" data-path="lmm.html"><a href="lmm.html#completely-randomized-design-with-subsampling-crds-or-nested-design"><i class="fa fa-check"></i><b>16.4.3</b> Completely Randomized Design with Subsampling (CRDS) or “Nested Design”</a></li>
<li class="chapter" data-level="16.4.4" data-path="lmm.html"><a href="lmm.html#randomized-complete-block-design-rcbd"><i class="fa fa-check"></i><b>16.4.4</b> Randomized Complete Block Design (RCBD)</a></li>
<li class="chapter" data-level="16.4.5" data-path="lmm.html"><a href="lmm.html#randomized-split-plot-design-rspd"><i class="fa fa-check"></i><b>16.4.5</b> Randomized Split Plot Design (RSPD)</a></li>
<li class="chapter" data-level="16.4.6" data-path="lmm.html"><a href="lmm.html#generalized-randomized-complete-block-design-grcbd"><i class="fa fa-check"></i><b>16.4.6</b> Generalized Randomized Complete Block Design (GRCBD)</a></li>
<li class="chapter" data-level="16.4.7" data-path="lmm.html"><a href="lmm.html#nested-randomized-complete-block-design-nrcbd"><i class="fa fa-check"></i><b>16.4.7</b> Nested Randomized Complete Block Design (NRCBD)</a></li>
<li class="chapter" data-level="16.4.8" data-path="lmm.html"><a href="lmm.html#longitudinal-randomized-complete-block-design-lrcbd"><i class="fa fa-check"></i><b>16.4.8</b> Longitudinal Randomized Complete Block Design (LRCBD)</a></li>
<li class="chapter" data-level="16.4.9" data-path="lmm.html"><a href="lmm.html#variations-due-to-multiple-measures-of-the-response-variable"><i class="fa fa-check"></i><b>16.4.9</b> Variations due to multiple measures of the response variable</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="lmm.html"><a href="lmm.html#building-the-linear-mixed-model-for-clustered-data"><i class="fa fa-check"></i><b>16.5</b> Building the linear (mixed) model for clustered data</a></li>
<li class="chapter" data-level="16.6" data-path="lmm.html"><a href="lmm.html#lmm-demo"><i class="fa fa-check"></i><b>16.6</b> Example 1 – A random intercepts and slopes explainer (demo1)</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="lmm.html"><a href="lmm.html#batched-measurements-result-in-clustered-residuals"><i class="fa fa-check"></i><b>16.6.1</b> Batched measurements result in clustered residuals</a></li>
<li class="chapter" data-level="16.6.2" data-path="lmm.html"><a href="lmm.html#lmm-corerr"><i class="fa fa-check"></i><b>16.6.2</b> Clustered residuals result in correlated error</a></li>
<li class="chapter" data-level="16.6.3" data-path="lmm.html"><a href="lmm.html#in-blocked-designs-clustered-residuals-adds-a-variance-component-that-masks-treatment-effects"><i class="fa fa-check"></i><b>16.6.3</b> In blocked designs, clustered residuals adds a variance component that masks treatment effects</a></li>
<li class="chapter" data-level="16.6.4" data-path="lmm.html"><a href="lmm.html#linear-mixed-models-are-linear-models-with-added-random-factors"><i class="fa fa-check"></i><b>16.6.4</b> Linear mixed models are linear models with added random factors</a></li>
<li class="chapter" data-level="16.6.5" data-path="lmm.html"><a href="lmm.html#what-the-random-effects-are"><i class="fa fa-check"></i><b>16.6.5</b> What the random effects are</a></li>
<li class="chapter" data-level="16.6.6" data-path="lmm.html"><a href="lmm.html#in-a-blocked-design-a-linear-model-with-added-random-effects-increases-precision-of-treatment-effects"><i class="fa fa-check"></i><b>16.6.6</b> In a blocked design, a linear model with added random effects increases precision of treatment effects</a></li>
<li class="chapter" data-level="16.6.7" data-path="lmm.html"><a href="lmm.html#lmm-varcorr"><i class="fa fa-check"></i><b>16.6.7</b> The correlation among random intercepts and slopes</a></li>
<li class="chapter" data-level="16.6.8" data-path="lmm.html"><a href="lmm.html#clustered-residuals-create-heterogeneity-among-treatments"><i class="fa fa-check"></i><b>16.6.8</b> Clustered residuals create heterogeneity among treatments</a></li>
<li class="chapter" data-level="16.6.9" data-path="lmm.html"><a href="lmm.html#linear-mixed-models-are-flexible"><i class="fa fa-check"></i><b>16.6.9</b> Linear mixed models are flexible</a></li>
<li class="chapter" data-level="16.6.10" data-path="lmm.html"><a href="lmm.html#a-random-intercept-only-model"><i class="fa fa-check"></i><b>16.6.10</b> A random intercept only model</a></li>
<li class="chapter" data-level="16.6.11" data-path="lmm.html"><a href="lmm.html#a-model-including-an-interaction-intercept"><i class="fa fa-check"></i><b>16.6.11</b> A model including an interaction intercept</a></li>
<li class="chapter" data-level="16.6.12" data-path="lmm.html"><a href="lmm.html#lmm-demo-aic"><i class="fa fa-check"></i><b>16.6.12</b> AIC and model selection – which model to report?</a></li>
<li class="chapter" data-level="16.6.13" data-path="lmm.html"><a href="lmm.html#the-specification-of-random-effects-matters"><i class="fa fa-check"></i><b>16.6.13</b> The specification of random effects matters</a></li>
<li class="chapter" data-level="16.6.14" data-path="lmm.html"><a href="lmm.html#mixed-effect-and-repeated-measures-anova"><i class="fa fa-check"></i><b>16.6.14</b> Mixed Effect and Repeated Measures ANOVA</a></li>
<li class="chapter" data-level="16.6.15" data-path="lmm.html"><a href="lmm.html#pseudoreplication"><i class="fa fa-check"></i><b>16.6.15</b> Pseudoreplication</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="lmm.html"><a href="lmm.html#lmm-example2"><i class="fa fa-check"></i><b>16.7</b> Example 2 – experiments without subsampling replication (exp6g)</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="lmm.html"><a href="lmm.html#understand-the-data"><i class="fa fa-check"></i><b>16.7.1</b> Understand the data</a></li>
<li class="chapter" data-level="16.7.2" data-path="lmm.html"><a href="lmm.html#model-fit-and-inference"><i class="fa fa-check"></i><b>16.7.2</b> Model fit and inference</a></li>
<li class="chapter" data-level="16.7.3" data-path="lmm.html"><a href="lmm.html#the-model-exp6g_m1-adds-a-random-intercept-but-not-a-random-slope"><i class="fa fa-check"></i><b>16.7.3</b> The model exp6g_m1 adds a random intercept but not a random slope</a></li>
<li class="chapter" data-level="16.7.4" data-path="lmm.html"><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp6g_m1"><i class="fa fa-check"></i><b>16.7.4</b> The fixed effect coefficients of model exp6g_m1</a></li>
<li class="chapter" data-level="16.7.5" data-path="lmm.html"><a href="lmm.html#the-random-intercept-coefficients-of-exp6g_m1"><i class="fa fa-check"></i><b>16.7.5</b> The random intercept coefficients of exp6g_m1</a></li>
<li class="chapter" data-level="16.7.6" data-path="lmm.html"><a href="lmm.html#the-random-and-residual-variance-and-the-intraclass-correlation-of-model-exp6g_m1"><i class="fa fa-check"></i><b>16.7.6</b> The random and residual variance and the intraclass correlation of model exp6g_m1</a></li>
<li class="chapter" data-level="16.7.7" data-path="lmm.html"><a href="lmm.html#the-linear-mixed-model-exp6g_m1-increases-precision-of-treatment-effects-relative-to-a-fixed-effects-model"><i class="fa fa-check"></i><b>16.7.7</b> The linear mixed model exp6g_m1 increases precision of treatment effects, relative to a fixed effects model</a></li>
<li class="chapter" data-level="16.7.8" data-path="lmm.html"><a href="lmm.html#lmm-exp6g-alt"><i class="fa fa-check"></i><b>16.7.8</b> Alternative models for exp6g</a></li>
<li class="chapter" data-level="16.7.9" data-path="lmm.html"><a href="lmm.html#paired-t-tests-and-repeated-measures-anova-are-special-cases-of-linear-mixed-models"><i class="fa fa-check"></i><b>16.7.9</b> Paired t-tests and repeated measures ANOVA are special cases of linear mixed models</a></li>
<li class="chapter" data-level="16.7.10" data-path="lmm.html"><a href="lmm.html#lmm-exp6g-rmanova"><i class="fa fa-check"></i><b>16.7.10</b> Classical (“univariate model”) repeated measures ANOVA of exp6g</a></li>
<li class="chapter" data-level="16.7.11" data-path="lmm.html"><a href="lmm.html#lmm-exp6g-rmanova-multi"><i class="fa fa-check"></i><b>16.7.11</b> “Multivariate model” repeated measures ANOVA</a></li>
<li class="chapter" data-level="16.7.12" data-path="lmm.html"><a href="lmm.html#linear-mixed-models-vs-repeated-measures-anova"><i class="fa fa-check"></i><b>16.7.12</b> Linear mixed models vs repeated measures ANOVA</a></li>
<li class="chapter" data-level="16.7.13" data-path="lmm.html"><a href="lmm.html#modeling-textttmouse_id-as-a-fixed-effect"><i class="fa fa-check"></i><b>16.7.13</b> Modeling <span class="math inline">\(\texttt{mouse_id}\)</span> as a fixed effect</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="lmm.html"><a href="lmm.html#example-3-factorial-experiments-and-no-subsampling-replicates-exp5c"><i class="fa fa-check"></i><b>16.8</b> Example 3 – Factorial experiments and no subsampling replicates (exp5c)</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="lmm.html"><a href="lmm.html#understand-the-data-1"><i class="fa fa-check"></i><b>16.8.1</b> Understand the data</a></li>
<li class="chapter" data-level="16.8.2" data-path="lmm.html"><a href="lmm.html#examine-the-data-1"><i class="fa fa-check"></i><b>16.8.2</b> Examine the data</a></li>
<li class="chapter" data-level="16.8.3" data-path="lmm.html"><a href="lmm.html#lmm-exp5c-m1"><i class="fa fa-check"></i><b>16.8.3</b> Model fit and inference</a></li>
<li class="chapter" data-level="16.8.4" data-path="lmm.html"><a href="lmm.html#why-we-care-about-modeling-batch-in-exp5c"><i class="fa fa-check"></i><b>16.8.4</b> Why we care about modeling batch in exp5c</a></li>
<li class="chapter" data-level="16.8.5" data-path="lmm.html"><a href="lmm.html#the-linear-mixed-model-exp5c_m1-adds-two-random-intercepts"><i class="fa fa-check"></i><b>16.8.5</b> The linear mixed model exp5c_m1 adds two random intercepts</a></li>
<li class="chapter" data-level="16.8.6" data-path="lmm.html"><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp5c_m1"><i class="fa fa-check"></i><b>16.8.6</b> The fixed effect coefficients of model exp5c_m1</a></li>
<li class="chapter" data-level="16.8.7" data-path="lmm.html"><a href="lmm.html#the-random-effect-coefficients-of-model-exp5c_m1"><i class="fa fa-check"></i><b>16.8.7</b> The random effect coefficients of model exp5c_m1</a></li>
<li class="chapter" data-level="16.8.8" data-path="lmm.html"><a href="lmm.html#lmm-exp5c-alt"><i class="fa fa-check"></i><b>16.8.8</b> Alternative models for exp5c</a></li>
<li class="chapter" data-level="16.8.9" data-path="lmm.html"><a href="lmm.html#lmm-rmanova-5c"><i class="fa fa-check"></i><b>16.8.9</b> Classical (“univariate model”) repeated measures ANOVA</a></li>
<li class="chapter" data-level="16.8.10" data-path="lmm.html"><a href="lmm.html#lmm-rmanova-5c-multi"><i class="fa fa-check"></i><b>16.8.10</b> “Multivariate model” repeated measures ANOVA of exp5c</a></li>
<li class="chapter" data-level="16.8.11" data-path="lmm.html"><a href="lmm.html#modeling-textttdonor-as-a-fixed-effect"><i class="fa fa-check"></i><b>16.8.11</b> Modeling <span class="math inline">\(\texttt{donor}\)</span> as a fixed effect</a></li>
</ul></li>
<li class="chapter" data-level="16.9" data-path="lmm.html"><a href="lmm.html#lmm-example4"><i class="fa fa-check"></i><b>16.9</b> Example 4 – Experiments with subsampling replication (exp1g)</a>
<ul>
<li class="chapter" data-level="16.9.1" data-path="lmm.html"><a href="lmm.html#understand-the-data-2"><i class="fa fa-check"></i><b>16.9.1</b> Understand the data</a></li>
<li class="chapter" data-level="16.9.2" data-path="lmm.html"><a href="lmm.html#examine-the-data-2"><i class="fa fa-check"></i><b>16.9.2</b> Examine the data</a></li>
<li class="chapter" data-level="16.9.3" data-path="lmm.html"><a href="lmm.html#fit-the-model-9"><i class="fa fa-check"></i><b>16.9.3</b> Fit the model</a></li>
<li class="chapter" data-level="16.9.4" data-path="lmm.html"><a href="lmm.html#inference-from-the-model-6"><i class="fa fa-check"></i><b>16.9.4</b> Inference from the model</a></li>
<li class="chapter" data-level="16.9.5" data-path="lmm.html"><a href="lmm.html#plot-the-model-6"><i class="fa fa-check"></i><b>16.9.5</b> Plot the model</a></li>
<li class="chapter" data-level="16.9.6" data-path="lmm.html"><a href="lmm.html#alternaplot-the-model-3"><i class="fa fa-check"></i><b>16.9.6</b> Alternaplot the model</a></li>
<li class="chapter" data-level="16.9.7" data-path="lmm.html"><a href="lmm.html#understanding-the-alternative-models"><i class="fa fa-check"></i><b>16.9.7</b> Understanding the alternative models</a></li>
<li class="chapter" data-level="16.9.8" data-path="lmm.html"><a href="lmm.html#the-varcorr-matrix-of-models-exp1g_m1a-and-exp1g_m1b"><i class="fa fa-check"></i><b>16.9.8</b> The VarCorr matrix of models exp1g_m1a and exp1g_m1b</a></li>
<li class="chapter" data-level="16.9.9" data-path="lmm.html"><a href="lmm.html#the-linear-mixed-model-has-more-precision-and-power-than-the-fixed-effect-model-of-batch-means"><i class="fa fa-check"></i><b>16.9.9</b> The linear mixed model has more precision and power than the fixed effect model of batch means</a></li>
<li class="chapter" data-level="16.9.10" data-path="lmm.html"><a href="lmm.html#fixed-effect-models-and-pseudoreplication"><i class="fa fa-check"></i><b>16.9.10</b> Fixed effect models and pseudoreplication</a></li>
<li class="chapter" data-level="16.9.11" data-path="lmm.html"><a href="lmm.html#mixed-effect-anova"><i class="fa fa-check"></i><b>16.9.11</b> Mixed-effect ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="16.10" data-path="lmm.html"><a href="lmm.html#statistical-models-for-experimental-designs"><i class="fa fa-check"></i><b>16.10</b> Statistical models for experimental designs</a>
<ul>
<li class="chapter" data-level="16.10.1" data-path="lmm.html"><a href="lmm.html#models-for-completely-randomized-designs-crd"><i class="fa fa-check"></i><b>16.10.1</b> Models for Completely Randomized Designs (CRD)</a></li>
<li class="chapter" data-level="16.10.2" data-path="lmm.html"><a href="lmm.html#models-for-batched-data-crds-rcbd-rspd-grcbd-nrcbd"><i class="fa fa-check"></i><b>16.10.2</b> Models for batched data (CRDS, RCBD, RSPD, GRCBD, NRCBD)</a></li>
</ul></li>
<li class="chapter" data-level="16.11" data-path="lmm.html"><a href="lmm.html#which-model-and-why"><i class="fa fa-check"></i><b>16.11</b> Which model and why?</a>
<ul>
<li class="chapter" data-level="16.11.1" data-path="lmm.html"><a href="lmm.html#crd"><i class="fa fa-check"></i><b>16.11.1</b> CRD</a></li>
<li class="chapter" data-level="16.11.2" data-path="lmm.html"><a href="lmm.html#crds"><i class="fa fa-check"></i><b>16.11.2</b> CRDS</a></li>
<li class="chapter" data-level="16.11.3" data-path="lmm.html"><a href="lmm.html#rcbd"><i class="fa fa-check"></i><b>16.11.3</b> RCBD</a></li>
<li class="chapter" data-level="16.11.4" data-path="lmm.html"><a href="lmm.html#rspd"><i class="fa fa-check"></i><b>16.11.4</b> RSPD</a></li>
<li class="chapter" data-level="16.11.5" data-path="lmm.html"><a href="lmm.html#rcbds"><i class="fa fa-check"></i><b>16.11.5</b> RCBDS</a></li>
<li class="chapter" data-level="16.11.6" data-path="lmm.html"><a href="lmm.html#grcbd"><i class="fa fa-check"></i><b>16.11.6</b> GRCBD</a></li>
<li class="chapter" data-level="16.11.7" data-path="lmm.html"><a href="lmm.html#grcbds"><i class="fa fa-check"></i><b>16.11.7</b> GRCBDS</a></li>
</ul></li>
<li class="chapter" data-level="16.12" data-path="lmm.html"><a href="lmm.html#working-in-r-5"><i class="fa fa-check"></i><b>16.12</b> Working in R</a>
<ul>
<li class="chapter" data-level="16.12.1" data-path="lmm.html"><a href="lmm.html#plotting-models-fit-to-batched-data"><i class="fa fa-check"></i><b>16.12.1</b> Plotting models fit to batched data</a></li>
<li class="chapter" data-level="16.12.2" data-path="lmm.html"><a href="lmm.html#repeated-measures-anova-randomized-complete-block-with-no-subsampling"><i class="fa fa-check"></i><b>16.12.2</b> Repeated measures ANOVA (randomized complete block with no subsampling)</a></li>
</ul></li>
<li class="chapter" data-level="16.13" data-path="lmm.html"><a href="lmm.html#hidden-code-7"><i class="fa fa-check"></i><b>16.13</b> Hidden code</a>
<ul>
<li class="chapter" data-level="16.13.1" data-path="lmm.html"><a href="lmm.html#import-exp5c"><i class="fa fa-check"></i><b>16.13.1</b> Import exp5c</a></li>
<li class="chapter" data-level="16.13.2" data-path="lmm.html"><a href="lmm.html#import-exp1g"><i class="fa fa-check"></i><b>16.13.2</b> Import exp1g</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="pre-post.html"><a href="pre-post.html"><i class="fa fa-check"></i><b>17</b> Linear models for longitudinal experiments – I. pre-post designs</a>
<ul>
<li class="chapter" data-level="17.1" data-path="pre-post.html"><a href="pre-post.html#best-practice-models"><i class="fa fa-check"></i><b>17.1</b> Best practice models</a></li>
<li class="chapter" data-level="17.2" data-path="pre-post.html"><a href="pre-post.html#common-alternatives-that-are-not-recommended"><i class="fa fa-check"></i><b>17.2</b> Common alternatives that are not recommended</a></li>
<li class="chapter" data-level="17.3" data-path="pre-post.html"><a href="pre-post.html#advanced-models"><i class="fa fa-check"></i><b>17.3</b> Advanced models</a></li>
<li class="chapter" data-level="17.4" data-path="pre-post.html"><a href="pre-post.html#understanding-the-alternative-models-1"><i class="fa fa-check"></i><b>17.4</b> Understanding the alternative models</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="pre-post.html"><a href="pre-post.html#m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model"><i class="fa fa-check"></i><b>17.4.1</b> (M1) Linear model with the baseline measure as the covariate (ANCOVA model)</a></li>
<li class="chapter" data-level="17.4.2" data-path="pre-post.html"><a href="pre-post.html#m2-linear-model-of-the-change-score-change-score-model"><i class="fa fa-check"></i><b>17.4.2</b> (M2) Linear model of the change score (change-score model)</a></li>
<li class="chapter" data-level="17.4.3" data-path="pre-post.html"><a href="pre-post.html#m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model"><i class="fa fa-check"></i><b>17.4.3</b> (M3) Linear model of post-baseline values without the baseline as a covariate (post model)</a></li>
<li class="chapter" data-level="17.4.4" data-path="pre-post.html"><a href="pre-post.html#m4-linear-model-with-factorial-fixed-effects-fixed-effects-model"><i class="fa fa-check"></i><b>17.4.4</b> (M4) Linear model with factorial fixed effects (fixed-effects model)</a></li>
<li class="chapter" data-level="17.4.5" data-path="pre-post.html"><a href="pre-post.html#m5-repeated-measures-anova"><i class="fa fa-check"></i><b>17.4.5</b> (M5) Repeated measures ANOVA</a></li>
<li class="chapter" data-level="17.4.6" data-path="pre-post.html"><a href="pre-post.html#m6-linear-mixed-model"><i class="fa fa-check"></i><b>17.4.6</b> (M6) Linear mixed model</a></li>
<li class="chapter" data-level="17.4.7" data-path="pre-post.html"><a href="pre-post.html#m7-linear-model-with-correlated-error"><i class="fa fa-check"></i><b>17.4.7</b> (M7) Linear model with correlated error</a></li>
<li class="chapter" data-level="17.4.8" data-path="pre-post.html"><a href="pre-post.html#m8-constrained-fixed-effects-model-with-correlated-error-clda-model"><i class="fa fa-check"></i><b>17.4.8</b> (M8) Constrained fixed effects model with correlated error (cLDA model)</a></li>
<li class="chapter" data-level="17.4.9" data-path="pre-post.html"><a href="pre-post.html#comparison-table"><i class="fa fa-check"></i><b>17.4.9</b> Comparison table</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="pre-post.html"><a href="pre-post.html#example-1-a-single-post-baseline-measure-pre-post-design"><i class="fa fa-check"></i><b>17.5</b> Example 1 – a single post-baseline measure (pre-post design)</a></li>
<li class="chapter" data-level="17.6" data-path="pre-post.html"><a href="pre-post.html#working-in-r-6"><i class="fa fa-check"></i><b>17.6</b> Working in R</a></li>
<li class="chapter" data-level="17.7" data-path="pre-post.html"><a href="pre-post.html#hidden-code-8"><i class="fa fa-check"></i><b>17.7</b> Hidden code</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="pre-post.html"><a href="pre-post.html#import-and-wrangle-mouse-sociability-data"><i class="fa fa-check"></i><b>17.7.1</b> Import and wrangle mouse sociability data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="counts.html"><a href="counts.html"><i class="fa fa-check"></i><b>18</b> Linear models for counts, binary responses, skewed responses, and ratios – Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="18.1" data-path="counts.html"><a href="counts.html#glm-counts"><i class="fa fa-check"></i><b>18.1</b> Introducing Generalized Linear Models using count data examples</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="counts.html"><a href="counts.html#the-generalized-linear-model-glm"><i class="fa fa-check"></i><b>18.1.1</b> The Generalized Linear Model (GLM)</a></li>
<li class="chapter" data-level="18.1.2" data-path="counts.html"><a href="counts.html#kinds-of-data-that-are-modeled-by-a-glm"><i class="fa fa-check"></i><b>18.1.2</b> Kinds of data that are modeled by a GLM</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="counts.html"><a href="counts.html#glm-1"><i class="fa fa-check"></i><b>18.2</b> Example 1 – GLM models for count responses (“angiogenic sprouts” fig3a)</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="counts.html"><a href="counts.html#understand-the-data-3"><i class="fa fa-check"></i><b>18.2.1</b> Understand the data</a></li>
<li class="chapter" data-level="18.2.2" data-path="counts.html"><a href="counts.html#model-fit-and-inference-1"><i class="fa fa-check"></i><b>18.2.2</b> Model fit and inference</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="counts.html"><a href="counts.html#understanding-example-1"><i class="fa fa-check"></i><b>18.3</b> Understanding Example 1</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="counts.html"><a href="counts.html#modeling-strategy-1"><i class="fa fa-check"></i><b>18.3.1</b> Modeling strategy</a></li>
<li class="chapter" data-level="18.3.2" data-path="counts.html"><a href="counts.html#model-checking-fits-to-count-data"><i class="fa fa-check"></i><b>18.3.2</b> Model checking fits to count data</a></li>
<li class="chapter" data-level="18.3.3" data-path="counts.html"><a href="counts.html#biological-count-data-are-rarely-fit-well-by-a-poisson-glm.-instead-fit-a-quasi-poisson-or-negative-binomial-glm-model."><i class="fa fa-check"></i><b>18.3.3</b> Biological count data are rarely fit well by a Poisson GLM. Instead, fit a quasi-poisson or negative binomial GLM model.</a></li>
<li class="chapter" data-level="18.3.4" data-path="counts.html"><a href="counts.html#a-glm-is-a-linear-model-on-the-link-scale"><i class="fa fa-check"></i><b>18.3.4</b> A GLM is a linear model on the link scale</a></li>
<li class="chapter" data-level="18.3.5" data-path="counts.html"><a href="counts.html#coeffecients-of-a-generalized-linear-model-with-a-log-link-function-are-on-the-link-scale."><i class="fa fa-check"></i><b>18.3.5</b> Coeffecients of a Generalized Linear Model with a log-link function are on the link scale.</a></li>
<li class="chapter" data-level="18.3.6" data-path="counts.html"><a href="counts.html#modeled-means-in-the-emmeans-table-of-a-generalized-linear-model-can-be-on-the-link-scale-or-response-scale-report-the-response-scale"><i class="fa fa-check"></i><b>18.3.6</b> Modeled means in the emmeans table of a Generalized Linear Model can be on the link scale or response scale – Report the response scale</a></li>
<li class="chapter" data-level="18.3.7" data-path="counts.html"><a href="counts.html#some-consequences-of-fitting-a-linear-model-to-count-data"><i class="fa fa-check"></i><b>18.3.7</b> Some consequences of fitting a linear model to count data</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="counts.html"><a href="counts.html#example-2-use-a-glm-with-an-offset-instead-of-a-ratio-of-some-measurement-per-total-dna-damage-data-fig3b-glm_offset"><i class="fa fa-check"></i><b>18.4</b> Example 2 – Use a GLM with an offset instead of a ratio of some measurement per total (“dna damage” data fig3b) #glm_offset</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="counts.html"><a href="counts.html#fig3b-dna-damage-data"><i class="fa fa-check"></i><b>18.4.1</b> fig3b (“dna damage”) data</a></li>
<li class="chapter" data-level="18.4.2" data-path="counts.html"><a href="counts.html#understand-the-data-4"><i class="fa fa-check"></i><b>18.4.2</b> Understand the data</a></li>
<li class="chapter" data-level="18.4.3" data-path="counts.html"><a href="counts.html#model-fit-and-inference-2"><i class="fa fa-check"></i><b>18.4.3</b> Model fit and inference</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="counts.html"><a href="counts.html#understanding-example-2"><i class="fa fa-check"></i><b>18.5</b> Understanding Example 2</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="counts.html"><a href="counts.html#an-offset-is-an-added-covariate-with-a-coefficient-fixed-at-1"><i class="fa fa-check"></i><b>18.5.1</b> An offset is an added covariate with a coefficient fixed at 1</a></li>
<li class="chapter" data-level="18.5.2" data-path="counts.html"><a href="counts.html#glm-rate"><i class="fa fa-check"></i><b>18.5.2</b> A count GLM with an offset models the area-normalized means</a></li>
<li class="chapter" data-level="18.5.3" data-path="counts.html"><a href="counts.html#compare-an-offset-to-an-added-covariate-with-an-estimated-coefficient"><i class="fa fa-check"></i><b>18.5.3</b> Compare an offset to an added covariate with an estimated coefficient</a></li>
<li class="chapter" data-level="18.5.4" data-path="counts.html"><a href="counts.html#issues-with-plotting"><i class="fa fa-check"></i><b>18.5.4</b> Issues with plotting</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="counts.html"><a href="counts.html#example-3-glm-models-for-binary-responses"><i class="fa fa-check"></i><b>18.6</b> Example 3 – GLM models for binary responses</a></li>
<li class="chapter" data-level="18.7" data-path="counts.html"><a href="counts.html#working-in-r-7"><i class="fa fa-check"></i><b>18.7</b> Working in R</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="counts.html"><a href="counts.html#fitting-glms-to-count-data"><i class="fa fa-check"></i><b>18.7.1</b> Fitting GLMs to count data</a></li>
<li class="chapter" data-level="18.7.2" data-path="counts.html"><a href="counts.html#fitting-a-glm-to-a-continuous-conditional-response-with-right-skew."><i class="fa fa-check"></i><b>18.7.2</b> Fitting a GLM to a continuous conditional response with right skew.</a></li>
<li class="chapter" data-level="18.7.3" data-path="counts.html"><a href="counts.html#fitting-a-glm-to-a-binary-success-or-failure-presence-or-absence-survived-or-died-response"><i class="fa fa-check"></i><b>18.7.3</b> Fitting a GLM to a binary (success or failure, presence or absence, survived or died) response</a></li>
<li class="chapter" data-level="18.7.4" data-path="counts.html"><a href="counts.html#fitting-generalized-linear-mixed-models"><i class="fa fa-check"></i><b>18.7.4</b> Fitting Generalized Linear Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="counts.html"><a href="counts.html#model-checking-glms"><i class="fa fa-check"></i><b>18.8</b> Model checking GLMs</a></li>
<li class="chapter" data-level="18.9" data-path="counts.html"><a href="counts.html#hidden-code-9"><i class="fa fa-check"></i><b>18.9</b> Hidden code</a>
<ul>
<li class="chapter" data-level="18.9.1" data-path="counts.html"><a href="counts.html#import-example-1-data-fig3a-angiogenic-sprouts"><i class="fa fa-check"></i><b>18.9.1</b> Import Example 1 data (fig3a – “angiogenic sprouts”)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="gls.html"><a href="gls.html"><i class="fa fa-check"></i><b>19</b> Linear models with heterogenous variance</a></li>
<li class="chapter" data-level="" data-path="appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models.html"><a href="appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models.html"><i class="fa fa-check"></i>Appendix: An example set of analyses of experimental data with linear models</a></li>
<li class="chapter" data-level="20" data-path="ask1-bio.html"><a href="ask1-bio.html"><i class="fa fa-check"></i><b>20</b> Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li class="chapter" data-level="21" data-path="ask1-report.html"><a href="ask1-report.html"><i class="fa fa-check"></i><b>21</b> Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a>
<ul>
<li class="chapter" data-level="21.1" data-path="ask1-report.html"><a href="ask1-report.html#setup"><i class="fa fa-check"></i><b>21.1</b> Setup</a></li>
<li class="chapter" data-level="21.2" data-path="ask1-report.html"><a href="ask1-report.html#data-source"><i class="fa fa-check"></i><b>21.2</b> Data source</a></li>
<li class="chapter" data-level="21.3" data-path="ask1-report.html"><a href="ask1-report.html#control-the-color-palette"><i class="fa fa-check"></i><b>21.3</b> control the color palette</a></li>
<li class="chapter" data-level="21.4" data-path="ask1-report.html"><a href="ask1-report.html#useful-functions"><i class="fa fa-check"></i><b>21.4</b> useful functions</a></li>
<li class="chapter" data-level="21.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2b-effect-of-ask1-deletion-on-growth-body-weight"><i class="fa fa-check"></i><b>21.5</b> figure 2b – effect of ASK1 deletion on growth (body weight)</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2b-import"><i class="fa fa-check"></i><b>21.5.1</b> figure 2b – import</a></li>
<li class="chapter" data-level="21.5.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2b-exploratory-plots"><i class="fa fa-check"></i><b>21.5.2</b> figure 2b – exploratory plots</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-effect-of-ask1-deletion-on-final-body-weight"><i class="fa fa-check"></i><b>21.6</b> Figure 2c – Effect of ASK1 deletion on final body weight</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-import"><i class="fa fa-check"></i><b>21.6.1</b> Figure 2c – import</a></li>
<li class="chapter" data-level="21.6.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-check-own-computation-of-weight-change-v-imported-value"><i class="fa fa-check"></i><b>21.6.2</b> Figure 2c – check own computation of weight change v imported value</a></li>
<li class="chapter" data-level="21.6.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-exploratory-plots"><i class="fa fa-check"></i><b>21.6.3</b> Figure 2c – exploratory plots</a></li>
<li class="chapter" data-level="21.6.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-fit-the-model-m1-lm"><i class="fa fa-check"></i><b>21.6.4</b> Figure 2c – fit the model: m1 (lm)</a></li>
<li class="chapter" data-level="21.6.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-check-the-model-m1"><i class="fa fa-check"></i><b>21.6.5</b> Figure 2c – check the model: m1</a></li>
<li class="chapter" data-level="21.6.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-fit-the-model-m2-gamma-glm"><i class="fa fa-check"></i><b>21.6.6</b> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li class="chapter" data-level="21.6.7" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-check-the-model-m2"><i class="fa fa-check"></i><b>21.6.7</b> Figure 2c – check the model, m2</a></li>
<li class="chapter" data-level="21.6.8" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-inference-from-the-model"><i class="fa fa-check"></i><b>21.6.8</b> Figure 2c – inference from the model</a></li>
<li class="chapter" data-level="21.6.9" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-plot-the-model"><i class="fa fa-check"></i><b>21.6.9</b> Figure 2c – plot the model</a></li>
<li class="chapter" data-level="21.6.10" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-report"><i class="fa fa-check"></i><b>21.6.10</b> Figure 2c – report</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><i class="fa fa-check"></i><b>21.7</b> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a>
<ul>
<li class="chapter" data-level="21.7.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-import"><i class="fa fa-check"></i><b>21.7.1</b> Figure 2d – Import</a></li>
<li class="chapter" data-level="21.7.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-exploratory-plots"><i class="fa fa-check"></i><b>21.7.2</b> Figure 2d – exploratory plots</a></li>
<li class="chapter" data-level="21.7.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-fit-the-model"><i class="fa fa-check"></i><b>21.7.3</b> Figure 2d – fit the model</a></li>
<li class="chapter" data-level="21.7.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-check-the-model"><i class="fa fa-check"></i><b>21.7.4</b> Figure 2d – check the model</a></li>
<li class="chapter" data-level="21.7.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-inference"><i class="fa fa-check"></i><b>21.7.5</b> Figure 2d – inference</a></li>
<li class="chapter" data-level="21.7.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-plot-the-model"><i class="fa fa-check"></i><b>21.7.6</b> Figure 2d – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.8" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure"><i class="fa fa-check"></i><b>21.8</b> Figure 2e – Effect of ASK1 deletion on glucose tolerance (summary measure)</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-message-the-data"><i class="fa fa-check"></i><b>21.8.1</b> Figure 2e – message the data</a></li>
<li class="chapter" data-level="21.8.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-exploratory-plots"><i class="fa fa-check"></i><b>21.8.2</b> Figure 2e – exploratory plots</a></li>
<li class="chapter" data-level="21.8.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-fit-the-model"><i class="fa fa-check"></i><b>21.8.3</b> Figure 2e – fit the model</a></li>
<li class="chapter" data-level="21.8.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-check-the-model"><i class="fa fa-check"></i><b>21.8.4</b> Figure 2e – check the model</a></li>
<li class="chapter" data-level="21.8.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-inference-from-the-model"><i class="fa fa-check"></i><b>21.8.5</b> Figure 2e – inference from the model</a></li>
<li class="chapter" data-level="21.8.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-plot-the-model"><i class="fa fa-check"></i><b>21.8.6</b> Figure 2e – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate"><i class="fa fa-check"></i><b>21.9</b> Figure 2f – Effect of ASK1 deletion on glucose infusion rate</a>
<ul>
<li class="chapter" data-level="21.9.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-import"><i class="fa fa-check"></i><b>21.9.1</b> Figure 2f – import</a></li>
<li class="chapter" data-level="21.9.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-exploratory-plots"><i class="fa fa-check"></i><b>21.9.2</b> Figure 2f – exploratory plots</a></li>
<li class="chapter" data-level="21.9.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-fit-the-model"><i class="fa fa-check"></i><b>21.9.3</b> Figure 2f – fit the model</a></li>
<li class="chapter" data-level="21.9.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-check-the-model"><i class="fa fa-check"></i><b>21.9.4</b> Figure 2f – check the model</a></li>
<li class="chapter" data-level="21.9.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-inference"><i class="fa fa-check"></i><b>21.9.5</b> Figure 2f – inference</a></li>
<li class="chapter" data-level="21.9.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-plot-the-model"><i class="fa fa-check"></i><b>21.9.6</b> Figure 2f – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.10" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake"><i class="fa fa-check"></i><b>21.10</b> Figure 2g – Effect of ASK1 deletion on tissue-specific glucose uptake</a>
<ul>
<li class="chapter" data-level="21.10.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-import"><i class="fa fa-check"></i><b>21.10.1</b> Figure 2g – import</a></li>
<li class="chapter" data-level="21.10.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-exploratory-plots"><i class="fa fa-check"></i><b>21.10.2</b> Figure 2g – exploratory plots</a></li>
<li class="chapter" data-level="21.10.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-fit-the-model"><i class="fa fa-check"></i><b>21.10.3</b> Figure 2g – fit the model</a></li>
<li class="chapter" data-level="21.10.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-check-the-model"><i class="fa fa-check"></i><b>21.10.4</b> Figure 2g – check the model</a></li>
<li class="chapter" data-level="21.10.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-inference"><i class="fa fa-check"></i><b>21.10.5</b> Figure 2g – inference</a></li>
<li class="chapter" data-level="21.10.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-plot-the-model"><i class="fa fa-check"></i><b>21.10.6</b> Figure 2g – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.11" data-path="ask1-report.html"><a href="ask1-report.html#figure-2h"><i class="fa fa-check"></i><b>21.11</b> Figure 2h</a></li>
<li class="chapter" data-level="21.12" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-effect-of-ask1-deletion-on-liver-tg"><i class="fa fa-check"></i><b>21.12</b> Figure 2i – Effect of ASK1 deletion on liver TG</a>
<ul>
<li class="chapter" data-level="21.12.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-fit-the-model"><i class="fa fa-check"></i><b>21.12.1</b> Figure 2i – fit the model</a></li>
<li class="chapter" data-level="21.12.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-check-the-model"><i class="fa fa-check"></i><b>21.12.2</b> Figure 2i – check the model</a></li>
<li class="chapter" data-level="21.12.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-inference"><i class="fa fa-check"></i><b>21.12.3</b> Figure 2i – inference</a></li>
<li class="chapter" data-level="21.12.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-plot-the-model"><i class="fa fa-check"></i><b>21.12.4</b> Figure 2i – plot the model</a></li>
<li class="chapter" data-level="21.12.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-report-the-model"><i class="fa fa-check"></i><b>21.12.5</b> Figure 2i – report the model</a></li>
</ul></li>
<li class="chapter" data-level="21.13" data-path="ask1-report.html"><a href="ask1-report.html#figure-2j"><i class="fa fa-check"></i><b>21.13</b> Figure 2j</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="count-sim.html"><a href="count-sim.html"><i class="fa fa-check"></i><b>22</b> Simulations – Count data (alternatives to a t-test)</a>
<ul>
<li class="chapter" data-level="22.1" data-path="count-sim.html"><a href="count-sim.html#use-data-similar-to-figure-6f-from-example-1"><i class="fa fa-check"></i><b>22.1</b> Use data similar to Figure 6f from Example 1</a></li>
<li class="chapter" data-level="22.2" data-path="count-sim.html"><a href="count-sim.html#functions"><i class="fa fa-check"></i><b>22.2</b> Functions</a></li>
<li class="chapter" data-level="22.3" data-path="count-sim.html"><a href="count-sim.html#simulations"><i class="fa fa-check"></i><b>22.3</b> Simulations</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="count-sim.html"><a href="count-sim.html#type-i-pseudo-normal-distribution"><i class="fa fa-check"></i><b>22.3.1</b> Type I, Pseudo-Normal distribution</a></li>
<li class="chapter" data-level="22.3.2" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-equal-n"><i class="fa fa-check"></i><b>22.3.2</b> Type I, neg binom, equal n</a></li>
<li class="chapter" data-level="22.3.3" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-equal-n-small-theta"><i class="fa fa-check"></i><b>22.3.3</b> Type I, neg binom, equal n, small theta</a></li>
<li class="chapter" data-level="22.3.4" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-unequal-n"><i class="fa fa-check"></i><b>22.3.4</b> Type I, neg binom, unequal n</a></li>
<li class="chapter" data-level="22.3.5" data-path="count-sim.html"><a href="count-sim.html#power-pseudo-normal-distribution-equal-n"><i class="fa fa-check"></i><b>22.3.5</b> Power, Pseudo-Normal distribution, equal n</a></li>
<li class="chapter" data-level="22.3.6" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-equal-n"><i class="fa fa-check"></i><b>22.3.6</b> Power, neg binom, equal n</a></li>
<li class="chapter" data-level="22.3.7" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-small-theta"><i class="fa fa-check"></i><b>22.3.7</b> Power, neg binom, small theta</a></li>
<li class="chapter" data-level="22.3.8" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-unequal-n"><i class="fa fa-check"></i><b>22.3.8</b> Power, neg binom, unequal n</a></li>
<li class="chapter" data-level="22.3.9" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-unequal-n-unequal-theta"><i class="fa fa-check"></i><b>22.3.9</b> Power, neg binom, unequal n, unequal theta</a></li>
<li class="chapter" data-level="22.3.10" data-path="count-sim.html"><a href="count-sim.html#type-1-neg-binom-equal-n-unequal-theta"><i class="fa fa-check"></i><b>22.3.10</b> Type 1, neg binom, equal n, unequal theta</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="count-sim.html"><a href="count-sim.html#save-it-read-it"><i class="fa fa-check"></i><b>22.4</b> Save it, Read it</a></li>
<li class="chapter" data-level="22.5" data-path="count-sim.html"><a href="count-sim.html#analysis"><i class="fa fa-check"></i><b>22.5</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html"><i class="fa fa-check"></i>Appendix 1: Getting Started with R</a>
<ul>
<li class="chapter" data-level="22.6" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready"><i class="fa fa-check"></i><b>22.6</b> Get your computer ready</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-here"><i class="fa fa-check"></i><b>22.6.1</b> Start here</a></li>
<li class="chapter" data-level="22.6.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r"><i class="fa fa-check"></i><b>22.6.2</b> Install R</a></li>
<li class="chapter" data-level="22.6.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-studio"><i class="fa fa-check"></i><b>22.6.3</b> Install R Studio</a></li>
<li class="chapter" data-level="22.6.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-markdown-1"><i class="fa fa-check"></i><b>22.6.4</b> Install R Markdown</a></li>
<li class="chapter" data-level="22.6.5" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#optional-alternative-latex-installations"><i class="fa fa-check"></i><b>22.6.5</b> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-learning-r-studio"><i class="fa fa-check"></i><b>22.7</b> Start learning R Studio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><i class="fa fa-check"></i>Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics for the Bench Biologist</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="violations" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Violations of independence, homogeneity, or Normality<a href="violations.html#violations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="oneway-paired-t" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Lack of independence<a href="violations.html#oneway-paired-t" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="violations-paired-t" class="section level3 hasAnchor" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> Example 1 (exp1b) – a paired t-test is a special case of a linear mixed model<a href="violations.html#violations-paired-t" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://www.nature.com/articles/nm.4297" target="_blank">Lynes, M.D., Leiria, L.O., Lundh, M., Bartelt, A., Shamsi, F., Huang, T.L., Takahashi, H., Hirshman, M.F., Schlein, C., Lee, A. and Baer, L.A., 2017. The cold-induced lipokine 12, 13-diHOME promotes fatty acid transport into brown adipose tissue. Nature medicine, 23(5), pp.631-637.</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5699924/pdf/nihms916046.pdf" target="_blank">Public source</a></p>
<p><a href="https://www.nature.com/articles/nm.4297#Sec14" target="_blank">Data source</a></p>
<p>The data are from the experiment for Figure 1b of the <a href="oneway.html#oneway-data">12,13-diHOME article</a> from the previous chapter.</p>
<p><strong>Response variable</strong> – <span class="math inline">\(\texttt{diHOME}\)</span>: concentration (pmol per ml) of the putative lipokine 12,13 di-HOME. This is a continuous variable.</p>
<p><strong>Factor variable</strong> – <span class="math inline">\(\texttt{treatment}\)</span>, with levels: “saline” and “cold”. Coded as a factor.</p>
<p><strong>Blocking variable</strong> – <em>id</em>: identification code of the individual human.</p>
<p><strong>Design</strong> – Blocked. Plasma concentrations of 12,13-diHOME were measured two times in each individual, after injection with saline and after a 1 hour cold exposure.</p>
<p>The consequence of the two measures in each human is <strong>correlated error</strong>. In <strong>blocked designs</strong> like this, the correlated error arises because we expect measures within a block (the individual for the exp1b experiment) to be more similar to each other than to measures among blocks. A blocked design is a powerful experimental method to reduce uncertainty in estimates of differences among means – and, consequently, the power of a statistical test. The paired <em>t</em>-test exploits this design while the classic Student’s <em>t</em>-test ignores it.</p>
<p>Multiple response measures per individual violate the independent sampling assumption for inference. If there is a lack of independence between the two groups, a “which test?” strategy points to a paired <em>t</em>-test in place of Student’s <em>t</em>-test.</p>
<p>A paired t-test is a special case of a <strong>linear mixed model</strong>. Linear mixed models are discussed more in the chapter <a href="lmm.html#lmm">Models with random factors – Blocking and pseudoreplication</a>.</p>
<p>A good way to think about the model generating the data is</p>
<p><span class="math display">\[
\begin{equation}
\texttt{diHome} = (\beta_0 + \gamma_{0_j}) + \beta_1 (\texttt{treatment_cold}) + \varepsilon
\end{equation}
\]</span></p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\beta_0\)</span> is the expected value of <span class="math inline">\(\texttt{diHome}\)</span> in humans given a saline treatment.</li>
<li><span class="math inline">\(gamma_{0_j}\)</span> is the effect of being human <em>j</em> on the expected value of <span class="math inline">\(\texttt{diHome}\)</span>. <span class="math inline">\(\gamma_{0_j}\)</span> is a kind of <strong>random effect</strong>.</li>
<li><span class="math inline">\(\beta_0 + \gamma_{0_j}\)</span> is the expected value of <span class="math inline">\(\texttt{diHome}\)</span> in human <em>j</em> given a saline treatment. It is the <strong>random intercept</strong> for human <span class="math inline">\(j\)</span>.</li>
<li><span class="math inline">\(\beta_0 + \gamma_{0_j} + \beta_1\)</span> is the expected value of <span class="math inline">\(\texttt{diHome}\)</span> in human <em>j</em> given a cold treatment.</li>
</ol>
<p>Importantly, if the random effect (<span class="math inline">\(\gamma_{0_j}\)</span>) isn’t modeled, then variation in this component is picked up by the model error <span class="math inline">\(e\)</span>. Consequently, the error component <strong>is correlated</strong> because the subsets of <span class="math inline">\(e\)</span> from the same individual are expected to have more similar values to each other than to that from other individuals. Correlated error is discussed more in the chapter <a href="lmm.html#lmm">Models with random factors – Blocking and pseudoreplication</a>. Importantly, if the random effect isn’t modeled, the increased variance of <span class="math inline">\(e\)</span> decreases precision of the estimate. Consequently, CIs are wider and significance tests have less power.</p>
<div id="fit-the-model-2" class="section level4 hasAnchor" number="12.1.1.1">
<h4><span class="header-section-number">12.1.1.1</span> Fit the model<a href="violations.html#fit-the-model-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="violations.html#cb315-1" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb315-2"><a href="violations.html#cb315-2" tabindex="-1"></a>exp1b_m1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(diHOME <span class="sc">~</span> treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id), <span class="at">data =</span> exp1b)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>The function <code>lmer()</code> from the lme4 package allows the addition of random factors to the model formula. Otherwise, the function works like the <code>lm</code> function.</li>
<li>The added random factor is <span class="math inline">\(\texttt{id}\)</span>, which contains the id of the human. <span class="math inline">\(\texttt{id}\)</span> didn’t appear from nowhere, it is a column in the data.table exp1b.</li>
<li>Random factors are added embedded within parentheses. A random intercept is added using the formula <code>(1|factor)</code> where <span class="math inline">\(\texttt{factor}\)</span> is the names of the column of the data containing the random factor.</li>
<li><span class="math inline">\(\texttt{id}\)</span> is a <strong>random factor</strong>. <span class="math inline">\(\texttt{treatment}\)</span> is a <strong>fixed factor</strong>. Models with both fixed and random factors go by many names. In this text, I use “linear mixed model”.</li>
</ol>
</div>
<div id="inference" class="section level4 hasAnchor" number="12.1.1.2">
<h4><span class="header-section-number">12.1.1.2</span> Inference<a href="violations.html#inference" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Inference using the linear model with added random factor:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="violations.html#cb316-1" tabindex="-1"></a><span class="co"># estimated marginal means table</span></span>
<span id="cb316-2"><a href="violations.html#cb316-2" tabindex="-1"></a>exp1b_m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(exp1b_m1, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb316-3"><a href="violations.html#cb316-3" tabindex="-1"></a></span>
<span id="cb316-4"><a href="violations.html#cb316-4" tabindex="-1"></a><span class="co"># contrasts table</span></span>
<span id="cb316-5"><a href="violations.html#cb316-5" tabindex="-1"></a>exp1b_m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(exp1b_m1_emm,</span>
<span id="cb316-6"><a href="violations.html#cb316-6" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb316-7"><a href="violations.html#cb316-7" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb316-8"><a href="violations.html#cb316-8" tabindex="-1"></a></span>
<span id="cb316-9"><a href="violations.html#cb316-9" tabindex="-1"></a>exp1b_m1_pairs <span class="sc">%&gt;%</span></span>
<span id="cb316-10"><a href="violations.html#cb316-10" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb316-11"><a href="violations.html#cb316-11" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
cold - saline
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
4.27223
</td>
<td style="text-align:right;">
0.00272
</td>
</tr>
</tbody>
</table>
<p>Inference using paired t-test:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="violations.html#cb317-1" tabindex="-1"></a>exp1b_ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(</span>
<span id="cb317-2"><a href="violations.html#cb317-2" tabindex="-1"></a>  <span class="at">x =</span> exp1b[treatment <span class="sc">==</span> <span class="st">&quot;cold&quot;</span>, diHOME],</span>
<span id="cb317-3"><a href="violations.html#cb317-3" tabindex="-1"></a>  <span class="at">y =</span> exp1b[treatment <span class="sc">==</span> <span class="st">&quot;saline&quot;</span>, diHOME],</span>
<span id="cb317-4"><a href="violations.html#cb317-4" tabindex="-1"></a>  <span class="at">paired =</span> <span class="cn">TRUE</span></span>
<span id="cb317-5"><a href="violations.html#cb317-5" tabindex="-1"></a>)</span>
<span id="cb317-6"><a href="violations.html#cb317-6" tabindex="-1"></a></span>
<span id="cb317-7"><a href="violations.html#cb317-7" tabindex="-1"></a>exp1b_ttest</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  exp1b[treatment == &quot;cold&quot;, diHOME] and exp1b[treatment == &quot;saline&quot;, diHOME]
## t = 4.2722, df = 8, p-value = 0.002716
## alternative hypothesis: true mean difference is not equal to 0
## 95 percent confidence interval:
##  0.1078778 0.3609173
## sample estimates:
## mean difference 
##       0.2343975</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The <em>t</em> and <em>p</em> values from the linear model and from the <em>t</em>-tests are the same because the paired <em>t</em>-test is a special case of the linear model.</li>
</ol>
</div>
</div>
<div id="violations-rmanova" class="section level3 hasAnchor" number="12.1.2">
<h3><span class="header-section-number">12.1.2</span> Example 2 (diHOME exp2a) – A repeated measures ANOVA is a special case of a linear mixed model<a href="violations.html#violations-rmanova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The structure of the Figure 2A experiment from the chapter <a href="oneway.html#oneway">Linear models with a single, categorical <em>X</em></a> is ambiguous. It is not clear from the archived data if the measures of 12,13 diHome were on separate mice within each of the three treatments (“Control”, “1 hour cold”, “30 min NE”) or if the same mice were used in each set. If each mouse was measured three times, I assume the researchers would have stated this, which they didn’t. But, to outline modeling correlated data when we have more than two groups, let’s say each mouse in the Figure 2A experiment was subjected to all three treatments. We have three measures per mouse and the response measure violates the independence assumption.</p>
<p>The linear model (in regression notation) is</p>
<p><span class="math display">\[
\begin{equation}
\texttt{diHome} = (\beta_0 + \gamma_{0_j}) + \beta_1 \texttt{treatment}_\texttt{cold} + \beta_2 \texttt{treatment}_\texttt{NE} + \varepsilon
\end{equation}
\]</span></p>
<div id="fit-the-model-3" class="section level4 hasAnchor" number="12.1.2.1">
<h4><span class="header-section-number">12.1.2.1</span> Fit the model<a href="violations.html#fit-the-model-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="violations.html#cb319-1" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb319-2"><a href="violations.html#cb319-2" tabindex="-1"></a>exp2a_m1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(diHOME <span class="sc">~</span> treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id), <span class="at">data =</span> exp2a)</span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>If a treatment factor has more than two groups, nothing special has to be done relative to a model with a treatment factor with only two groups.</li>
</ol>
</div>
<div id="inference-1" class="section level4 hasAnchor" number="12.1.2.2">
<h4><span class="header-section-number">12.1.2.2</span> Inference<a href="violations.html#inference-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Inference using the linear model with added random factor:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="violations.html#cb320-1" tabindex="-1"></a><span class="co"># estimated marginal means table</span></span>
<span id="cb320-2"><a href="violations.html#cb320-2" tabindex="-1"></a>exp2a_m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(exp2a_m1, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb320-3"><a href="violations.html#cb320-3" tabindex="-1"></a></span>
<span id="cb320-4"><a href="violations.html#cb320-4" tabindex="-1"></a><span class="co"># contrasts table</span></span>
<span id="cb320-5"><a href="violations.html#cb320-5" tabindex="-1"></a>exp2a_m1_planned <span class="ot">&lt;-</span> <span class="fu">contrast</span>(exp2a_m1_emm,</span>
<span id="cb320-6"><a href="violations.html#cb320-6" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;trt.vs.ctrl&quot;</span>,</span>
<span id="cb320-7"><a href="violations.html#cb320-7" tabindex="-1"></a>                     <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb320-8"><a href="violations.html#cb320-8" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb320-9"><a href="violations.html#cb320-9" tabindex="-1"></a></span>
<span id="cb320-10"><a href="violations.html#cb320-10" tabindex="-1"></a>exp2a_m1_planned <span class="sc">%&gt;%</span></span>
<span id="cb320-11"><a href="violations.html#cb320-11" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb320-12"><a href="violations.html#cb320-12" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1 hour cold - Control
</td>
<td style="text-align:right;">
8.1
</td>
<td style="text-align:right;">
3.88
</td>
<td style="text-align:right;">
9.4
</td>
<td style="text-align:right;">
-0.6
</td>
<td style="text-align:right;">
16.8
</td>
<td style="text-align:right;">
2.08124
</td>
<td style="text-align:right;">
0.06589
</td>
</tr>
<tr>
<td style="text-align:left;">
30 min NE - Control
</td>
<td style="text-align:right;">
14.8
</td>
<td style="text-align:right;">
3.62
</td>
<td style="text-align:right;">
9.0
</td>
<td style="text-align:right;">
6.6
</td>
<td style="text-align:right;">
23.0
</td>
<td style="text-align:right;">
4.08718
</td>
<td style="text-align:right;">
0.00271
</td>
</tr>
</tbody>
</table>
</div>
<div id="repeated-measures-anova" class="section level4 hasAnchor" number="12.1.2.3">
<h4><span class="header-section-number">12.1.2.3</span> repeated measures ANOVA<a href="violations.html#repeated-measures-anova" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In some fields, this analysis would be called <strong>repeated measures ANOVA</strong> and in others it might be called a <strong>two-way Model II (mixed effect) ANOVA</strong> with one fixed and one random factor.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="violations.html#cb321-1" tabindex="-1"></a>exp2a_m2 <span class="ot">&lt;-</span> <span class="fu">aov_4</span>(diHOME <span class="sc">~</span> treatment <span class="sc">+</span> (treatment<span class="sc">|</span>id),</span>
<span id="cb321-2"><a href="violations.html#cb321-2" tabindex="-1"></a>                           <span class="at">data =</span> exp2a)</span></code></pre></div>
<pre><code>## Warning: Missing values for 1 ID(s), which were removed before analysis:
## Animal 6
## Below the first few rows (in wide format) of the removed cases with missing data.
##           id  Control X1.hour.cold X30.min.NE
## # 6 Animal 6 12.84069           NA   45.00093</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The measure of <span class="math inline">\(\texttt{diHOME}\)</span> for animal_6 for the 1 hour cold treatment is missing. To use the <code>exp2a</code> data in repeated measures ANOVA, the “Control” and “30 min NE” values for animal_6 have to be excluded. This exclusion isn’t necessary for the linear mixed model, which is one of the advantages of a linear mixed model over repeated measures ANOVA.</li>
</ol>
<p>The contrasts from the model are</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="violations.html#cb323-1" tabindex="-1"></a>exp2a_m1_planned <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(exp2a_m2, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb323-2"><a href="violations.html#cb323-2" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">&quot;trt.vs.ctrl&quot;</span>,</span>
<span id="cb323-3"><a href="violations.html#cb323-3" tabindex="-1"></a>           <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb323-4"><a href="violations.html#cb323-4" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb323-5"><a href="violations.html#cb323-5" tabindex="-1"></a></span>
<span id="cb323-6"><a href="violations.html#cb323-6" tabindex="-1"></a>exp2a_m1_planned <span class="sc">%&gt;%</span></span>
<span id="cb323-7"><a href="violations.html#cb323-7" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb323-8"><a href="violations.html#cb323-8" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
X1.hour.cold - Control
</td>
<td style="text-align:right;">
7.3
</td>
<td style="text-align:right;">
3.32
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-1.9
</td>
<td style="text-align:right;">
16.5
</td>
<td style="text-align:right;">
2.19728
</td>
<td style="text-align:right;">
0.09293
</td>
</tr>
<tr>
<td style="text-align:left;">
X30.min.NE - Control
</td>
<td style="text-align:right;">
11.3
</td>
<td style="text-align:right;">
2.27
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
17.6
</td>
<td style="text-align:right;">
4.97783
</td>
<td style="text-align:right;">
0.00761
</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: decimal">
<li>Lets remove animal 6 and rerun the linear mixed model <code>exp2a_m1</code></li>
</ol>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="violations.html#cb324-1" tabindex="-1"></a>exp2a_complete <span class="ot">&lt;-</span> exp2a[id <span class="sc">!=</span> <span class="st">&quot;Animal 6&quot;</span>]</span>
<span id="cb324-2"><a href="violations.html#cb324-2" tabindex="-1"></a></span>
<span id="cb324-3"><a href="violations.html#cb324-3" tabindex="-1"></a>exp2a_complete_m1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(diHOME <span class="sc">~</span> treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id), <span class="at">data =</span> exp2a_complete)</span>
<span id="cb324-4"><a href="violations.html#cb324-4" tabindex="-1"></a></span>
<span id="cb324-5"><a href="violations.html#cb324-5" tabindex="-1"></a>exp2a_m1_complete_planned <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(exp2a_complete_m1, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb324-6"><a href="violations.html#cb324-6" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">&quot;trt.vs.ctrl&quot;</span>,</span>
<span id="cb324-7"><a href="violations.html#cb324-7" tabindex="-1"></a>           <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb324-8"><a href="violations.html#cb324-8" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb324-9"><a href="violations.html#cb324-9" tabindex="-1"></a></span>
<span id="cb324-10"><a href="violations.html#cb324-10" tabindex="-1"></a>exp2a_m1_complete_planned <span class="sc">%&gt;%</span></span>
<span id="cb324-11"><a href="violations.html#cb324-11" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb324-12"><a href="violations.html#cb324-12" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1 hour cold - Control
</td>
<td style="text-align:right;">
7.3
</td>
<td style="text-align:right;">
2.83
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
13.8
</td>
<td style="text-align:right;">
2.57671
</td>
<td style="text-align:right;">
0.03278
</td>
</tr>
<tr>
<td style="text-align:left;">
30 min NE - Control
</td>
<td style="text-align:right;">
11.3
</td>
<td style="text-align:right;">
2.83
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
4.8
</td>
<td style="text-align:right;">
17.9
</td>
<td style="text-align:right;">
3.99395
</td>
<td style="text-align:right;">
0.00398
</td>
</tr>
</tbody>
</table>
<p>Notes -</p>
<ol style="list-style-type: decimal">
<li>Inference is the same.</li>
</ol>
</div>
<div id="inferences-from-the-linear-mixed-model-and-paired-t-tests-are-not-the-same-when-there-are-more-than-two-groups" class="section level4 hasAnchor" number="12.1.2.4">
<h4><span class="header-section-number">12.1.2.4</span> Inferences from the linear mixed model and paired t-tests are not the same when there are more than two groups<a href="violations.html#inferences-from-the-linear-mixed-model-and-paired-t-tests-are-not-the-same-when-there-are-more-than-two-groups" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Inference using two paired t-tests:</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="violations.html#cb325-1" tabindex="-1"></a>exp2a_ttest_cold <span class="ot">&lt;-</span> <span class="fu">t.test</span>(</span>
<span id="cb325-2"><a href="violations.html#cb325-2" tabindex="-1"></a>  <span class="at">x =</span> exp2a[treatment <span class="sc">==</span> <span class="st">&quot;1 hour cold&quot;</span>, diHOME],</span>
<span id="cb325-3"><a href="violations.html#cb325-3" tabindex="-1"></a>  <span class="at">y =</span> exp2a[treatment <span class="sc">==</span> <span class="st">&quot;Control&quot;</span>, diHOME],</span>
<span id="cb325-4"><a href="violations.html#cb325-4" tabindex="-1"></a>  <span class="at">paired =</span> <span class="cn">TRUE</span></span>
<span id="cb325-5"><a href="violations.html#cb325-5" tabindex="-1"></a>)</span>
<span id="cb325-6"><a href="violations.html#cb325-6" tabindex="-1"></a>exp2a_ttest_cold</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  exp2a[treatment == &quot;1 hour cold&quot;, diHOME] and exp2a[treatment == &quot;Control&quot;, diHOME]
## t = 2.1973, df = 4, p-value = 0.09293
## alternative hypothesis: true mean difference is not equal to 0
## 95 percent confidence interval:
##  -1.925189 16.533005
## sample estimates:
## mean difference 
##        7.303908</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="violations.html#cb327-1" tabindex="-1"></a>exp2a_ttest_ne <span class="ot">&lt;-</span> <span class="fu">t.test</span>(</span>
<span id="cb327-2"><a href="violations.html#cb327-2" tabindex="-1"></a>  <span class="at">x =</span> exp2a[treatment <span class="sc">==</span> <span class="st">&quot;30 min NE&quot;</span>, diHOME],</span>
<span id="cb327-3"><a href="violations.html#cb327-3" tabindex="-1"></a>  <span class="at">y =</span> exp2a[treatment <span class="sc">==</span> <span class="st">&quot;Control&quot;</span>, diHOME],</span>
<span id="cb327-4"><a href="violations.html#cb327-4" tabindex="-1"></a>  <span class="at">paired =</span> <span class="cn">TRUE</span></span>
<span id="cb327-5"><a href="violations.html#cb327-5" tabindex="-1"></a>)</span>
<span id="cb327-6"><a href="violations.html#cb327-6" tabindex="-1"></a>exp2a_ttest_ne</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  exp2a[treatment == &quot;30 min NE&quot;, diHOME] and exp2a[treatment == &quot;Control&quot;, diHOME]
## t = 3.7564, df = 5, p-value = 0.01321
## alternative hypothesis: true mean difference is not equal to 0
## 95 percent confidence interval:
##   4.670273 24.918436
## sample estimates:
## mean difference 
##        14.79435</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li><strong>important</strong> – the <em>t</em>-test for the comparison of “1 hour cold” and “Control” excluded mouse 6 because of a missing “1 hour cold” measure. The linear mixed model was fit to all data, including the “Control” and “30 min NE” measures. The consequence is more precision in the linear mixed model.</li>
<li>The paired t-test <em>t</em> and <em>p</em> values are not equal to those from the linear mixed model. This is partly because of the missing data (note 1). Even if there were no missing data, these wouldn’t be equal because the linear mixed model uses an estimate of <span class="math inline">\(\sigma\)</span> computed from the single model with all three groups to compute the standard errors. See the comparison of t-tests and the contrast table from a linear model in Section <a href="#ttests"><strong>??</strong></a>.</li>
<li>The results of the separate, paired t-tests and the linear mixed model differ in a way that might affect our inference about the system. Which is correct? Neither – they simply make different assumptions about the data generating model.</li>
</ol>
<ul>
<li>The linear model strategy has more power and precision but this advantage is small. The best reason to use linear models instead of separate <em>t</em>-tests is learning how to use linear models, and their extensions, gives you phenomenal cosmic power.</li>
<li>Do not compute both separate paired <em>t</em>-tests <strong>and</strong> the linear models and then convince yourself that that the assumption of the method with the <em>p</em>-value that matches your hypothesis is correct. See the p-hacking discussion above.</li>
</ul>
</div>
</div>
</div>
<div id="oneway-welch" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Heterogeneity of variances<a href="violations.html#oneway-welch" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Heterogeneity of variance among treatment groups is a problem for inference, especially if the sample size is unequal among groups (statisticians tend to agree that heterogeneity is much more problematic than a non-normal response).</p>
<div id="a-welch-t-test-is-a-special-case-of-a-linear-model-for-heterogeneity" class="section level4 hasAnchor" number="12.2.0.1">
<h4><span class="header-section-number">12.2.0.1</span> A Welch t-test is a special case of a linear model for heterogeneity<a href="violations.html#a-welch-t-test-is-a-special-case-of-a-linear-model-for-heterogeneity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A “which test?” strategy points to a Welch’s <em>t</em>-test in place of Student’s <em>t</em>-test if there is heterogeneity of variances between treatment groups. A Welch t-test is infrequent in the experimental biology literature, perhaps because</p>
<ol style="list-style-type: decimal">
<li>it is poorly known and it doesn’t occur to researchers to use a test that models heterogeneity of variances.</li>
<li>heterogeneity often arises in right-skewed data, which is often analyzed with a non-parametric test like the Mann-Whitney U test.</li>
</ol>
<p>The Welch <em>t</em>-test is a special case of a linear model that explicitly models the within-group variance using <strong>generalized least squares</strong> (GLS). The 95% CI of a mean differences and <em>p</em>-values from the fit gls linear model and from Welch’s t-test are the same. Advantages of using a linear modeling strategy is that a researcher uses the model to estimate effects (difference in means) and measures of uncertainty in the effects (standard errors or confidence intervals of the difference). Advantages of specifically using a GLS linear model is that it is easily expanded to analyze more complex designs including 1) more than one factor, 2) added covariates, 3) correlated residuals due to non-independence.</p>
<p>Some statisticians argue that researchers should <em>always</em> use a Welch t-test instead of Student’s t-test. Given this logic, researchers should consider using GLS linear models for more complex experimental designs (added covariates, factorial) in place of classical ANCOVA and two-way ANOVA.</p>
<p>Modeling variance heterogeneity is the focus of Chapter <a href="gls.html#gls">19</a> so the account here is brief. Heterogeneity can be modeled using a generalized least squares linear model with the <code>gls</code> function. The <code>weights</code> argument is used to model the variances using each group’s sample variance. In this example, I use the data from the Figure 1b experiment, which can be compared to the analysis of the same data in Example 2 above.</p>
</div>
<div id="fit-the-model-4" class="section level4 hasAnchor" number="12.2.0.2">
<h4><span class="header-section-number">12.2.0.2</span> Fit the model<a href="violations.html#fit-the-model-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="violations.html#cb329-1" tabindex="-1"></a><span class="co"># gls fails with missing data</span></span>
<span id="cb329-2"><a href="violations.html#cb329-2" tabindex="-1"></a>subdata <span class="ot">&lt;-</span> exp2a[<span class="fu">is.na</span>(diHOME) <span class="sc">==</span> <span class="cn">FALSE</span>,] <span class="co"># omit rows with missing data</span></span>
<span id="cb329-3"><a href="violations.html#cb329-3" tabindex="-1"></a>exp2a_m3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(diHOME <span class="sc">~</span> treatment,</span>
<span id="cb329-4"><a href="violations.html#cb329-4" tabindex="-1"></a>                <span class="at">data =</span> subdata,</span>
<span id="cb329-5"><a href="violations.html#cb329-5" tabindex="-1"></a>                <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> treatment))</span></code></pre></div>
<p>The model <code>exp2a_m3</code> uses variance computed in each group separately as the estimate of <span class="math inline">\(\sigma\)</span> for that group. The coefficient table of the GLS model is</p>
</div>
<div id="inference-from-the-linear-model" class="section level4 hasAnchor" number="12.2.0.3">
<h4><span class="header-section-number">12.2.0.3</span> Inference from the linear model<a href="violations.html#inference-from-the-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="violations.html#cb330-1" tabindex="-1"></a>exp2a_m3_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(exp2a_m3)),</span>
<span id="cb330-2"><a href="violations.html#cb330-2" tabindex="-1"></a>                       <span class="fu">confint</span>(exp2a_m3))</span>
<span id="cb330-3"><a href="violations.html#cb330-3" tabindex="-1"></a></span>
<span id="cb330-4"><a href="violations.html#cb330-4" tabindex="-1"></a>exp2a_m3_coef <span class="sc">%&gt;%</span></span>
<span id="cb330-5"><a href="violations.html#cb330-5" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb330-6"><a href="violations.html#cb330-6" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Value
</th>
<th style="text-align:right;">
Std.Error
</th>
<th style="text-align:right;">
t-value
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:right;">
2.5 %
</th>
<th style="text-align:right;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
12.0231
</td>
<td style="text-align:right;">
1.2001
</td>
<td style="text-align:right;">
10.0181
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
9.6708
</td>
<td style="text-align:right;">
14.3753
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment1 hour cold
</td>
<td style="text-align:right;">
7.1404
</td>
<td style="text-align:right;">
3.1635
</td>
<td style="text-align:right;">
2.2571
</td>
<td style="text-align:right;">
0.040505
</td>
<td style="text-align:right;">
0.9401
</td>
<td style="text-align:right;">
13.3407
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment30 min NE
</td>
<td style="text-align:right;">
14.7944
</td>
<td style="text-align:right;">
4.5688
</td>
<td style="text-align:right;">
3.2382
</td>
<td style="text-align:right;">
0.005951
</td>
<td style="text-align:right;">
5.8398
</td>
<td style="text-align:right;">
23.7490
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li><strong>Important</strong> for reporting CIs and <em>p</em>-values. Unlike the linear model modeling homogenous variance, the CIs and <em>p</em>-values for the coefficients of <span class="math inline">\(\texttt{treatment1 hour cold}\)</span> and <span class="math inline">\(\texttt{treatment30 min NE}\)</span> are <em>not</em> the same as the <em>p</em>-values of these equivalent contrasts in the contrasts table (see below). The reason is, the computation of the CI and <em>p</em>-values in the two tables use two different degrees of freedom. Report the CI and <em>p</em>-values from the contrast table using the Satterthwaite df.</li>
</ol>
<p>The modeled means and contrasts are computed as above for the <code>lm</code> object</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="violations.html#cb331-1" tabindex="-1"></a>exp2a_m3_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(exp2a_m3, <span class="at">specs=</span><span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb331-2"><a href="violations.html#cb331-2" tabindex="-1"></a>exp2a_m3_emm</span></code></pre></div>
<pre><code>##  treatment   emmean   SE df lower.CL upper.CL
##  Control       12.0 1.20  5     8.94     15.1
##  1 hour cold   19.2 2.93  4    11.04     27.3
##  30 min NE     26.8 4.41  5    15.49     38.1
## 
## Degrees-of-freedom method: satterthwaite 
## Confidence level used: 0.95</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The SE of the means in this table are modeled SEs but are equal to the sample SE of the means, because this was specified in the GLS model.</li>
</ol>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="violations.html#cb333-1" tabindex="-1"></a>exp2a_m3_pairs <span class="ot">&lt;-</span>  <span class="fu">contrast</span>(exp2a_m3_emm,</span>
<span id="cb333-2"><a href="violations.html#cb333-2" tabindex="-1"></a>                            <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb333-3"><a href="violations.html#cb333-3" tabindex="-1"></a>                            <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb333-4"><a href="violations.html#cb333-4" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb333-5"><a href="violations.html#cb333-5" tabindex="-1"></a></span>
<span id="cb333-6"><a href="violations.html#cb333-6" tabindex="-1"></a>exp2a_m3_pairs <span class="sc">%&gt;%</span></span>
<span id="cb333-7"><a href="violations.html#cb333-7" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb333-8"><a href="violations.html#cb333-8" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1 hour cold - Control
</td>
<td style="text-align:right;">
7.1404
</td>
<td style="text-align:right;">
3.1635
</td>
<td style="text-align:right;">
5.3
</td>
<td style="text-align:right;">
-0.8394
</td>
<td style="text-align:right;">
15.1201
</td>
<td style="text-align:right;">
2.2571
</td>
<td style="text-align:right;">
0.07026
</td>
</tr>
<tr>
<td style="text-align:left;">
30 min NE - Control
</td>
<td style="text-align:right;">
14.7944
</td>
<td style="text-align:right;">
4.5688
</td>
<td style="text-align:right;">
5.7
</td>
<td style="text-align:right;">
3.4896
</td>
<td style="text-align:right;">
26.0991
</td>
<td style="text-align:right;">
3.2382
</td>
<td style="text-align:right;">
0.01889
</td>
</tr>
<tr>
<td style="text-align:left;">
30 min NE - 1 hour cold
</td>
<td style="text-align:right;">
7.6540
</td>
<td style="text-align:right;">
5.2915
</td>
<td style="text-align:right;">
8.4
</td>
<td style="text-align:right;">
-4.4596
</td>
<td style="text-align:right;">
19.7675
</td>
<td style="text-align:right;">
1.4465
</td>
<td style="text-align:right;">
0.18452
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>Compare the statistics for “1 hour cold - Control” and “30 min NE - Control” to the coefficients for <span class="math inline">\(\texttt{treatment1 hour cold}\)</span> and <span class="math inline">\(\texttt{treatment30 min NE}\)</span> in the coefficient table. The estimates, SE, and <em>t</em> are the same but the CIs and <em>p</em> values differ. The contrast function is using a different method (“satterthwaite”) for computing the degrees of freedom and this results in a different value of the <em>t</em>-distribution tail area used to compute the CI and <em>p</em> value.</li>
</ol>
</div>
<div id="inference-using-welch-t-test" class="section level4 hasAnchor" number="12.2.0.4">
<h4><span class="header-section-number">12.2.0.4</span> Inference using Welch t-test<a href="violations.html#inference-using-welch-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="violations.html#cb334-1" tabindex="-1"></a>test1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(exp2a[treatment <span class="sc">==</span> <span class="st">&quot;1 hour cold&quot;</span>, diHOME],</span>
<span id="cb334-2"><a href="violations.html#cb334-2" tabindex="-1"></a>       exp2a[treatment <span class="sc">==</span> <span class="st">&quot;Control&quot;</span>, diHOME],</span>
<span id="cb334-3"><a href="violations.html#cb334-3" tabindex="-1"></a>       <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb334-4"><a href="violations.html#cb334-4" tabindex="-1"></a></span>
<span id="cb334-5"><a href="violations.html#cb334-5" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(exp2a[treatment <span class="sc">==</span> <span class="st">&quot;30 min NE&quot;</span>, diHOME],</span>
<span id="cb334-6"><a href="violations.html#cb334-6" tabindex="-1"></a>       exp2a[treatment <span class="sc">==</span> <span class="st">&quot;Control&quot;</span>, diHOME],</span>
<span id="cb334-7"><a href="violations.html#cb334-7" tabindex="-1"></a>       <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb334-8"><a href="violations.html#cb334-8" tabindex="-1"></a></span>
<span id="cb334-9"><a href="violations.html#cb334-9" tabindex="-1"></a>test3 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(exp2a[treatment <span class="sc">==</span> <span class="st">&quot;30 min NE&quot;</span>, diHOME],</span>
<span id="cb334-10"><a href="violations.html#cb334-10" tabindex="-1"></a>       exp2a[treatment <span class="sc">==</span> <span class="st">&quot;1 hour cold&quot;</span>, diHOME],</span>
<span id="cb334-11"><a href="violations.html#cb334-11" tabindex="-1"></a>       <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>the default <code>t.test</code> is the Welch t-test. However, I’ve included <code>var.equal = FALSE</code> so the method is transparent.</li>
</ol>
</div>
<div id="compare-inference-from-the-linear-model-and-welch-t-tests" class="section level4 hasAnchor" number="12.2.0.5">
<h4><span class="header-section-number">12.2.0.5</span> Compare inference from the linear model and Welch t-tests<a href="violations.html#compare-inference-from-the-linear-model-and-welch-t-tests" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Compare the contrast <em>p</em> values to the three Welch <em>t</em>-tests of all pairs of treatment levels in the exp2a experiment.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
t (gls lm)
</th>
<th style="text-align:right;">
p (gls lm)
</th>
<th style="text-align:right;">
t (welch t)
</th>
<th style="text-align:right;">
p (welch t)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1 hour cold - Control
</td>
<td style="text-align:right;">
2.257139
</td>
<td style="text-align:right;">
0.0702620
</td>
<td style="text-align:right;">
2.257139
</td>
<td style="text-align:right;">
0.0702622
</td>
</tr>
<tr>
<td style="text-align:left;">
30 min NE - 1 hour cold
</td>
<td style="text-align:right;">
1.446454
</td>
<td style="text-align:right;">
0.1845157
</td>
<td style="text-align:right;">
1.446454
</td>
<td style="text-align:right;">
0.1845155
</td>
</tr>
<tr>
<td style="text-align:left;">
30 min NE - Control
</td>
<td style="text-align:right;">
3.238157
</td>
<td style="text-align:right;">
0.0188906
</td>
<td style="text-align:right;">
3.238158
</td>
<td style="text-align:right;">
0.0188904
</td>
</tr>
</tbody>
</table>
<p>The <em>t</em> and <em>p</em>-values computed from the GLS linear model and from the three, pairwise Welch <em>t</em>-tests are the same (to about the 6th decimal place). They are the same because each is estimating <span class="math inline">\(\sigma^2\)</span> separately for each group and not as the pooled (among two groups for <em>t</em>-test or three groups for the linear model) estimate and because they use the same degrees of freedom to compute the <em>p</em>-value.</p>
<p>Let’s summarize these comparisons</p>
<ol style="list-style-type: decimal">
<li>Inference from a linear model using homogenous variance (the <code>lm</code> function) and from a Student’s <em>t</em>-test are the same if there are only two levels in the treatment variable.</li>
<li>Inference from a linear model using homogenous variance (the <code>lm</code> function) and from the series of pairwise, Student’s <em>t</em>-tests differ when there are more than two levels in the treatment variable.</li>
<li>Inference from a GLS linear model using heterogenous variance (the <code>gls</code> function) and from a Welch <em>t</em>-test are the same regardless of the number of levels in the treatment variable.</li>
</ol>
<p>Even though the linear model that models heterogeneity and the Welch <em>t</em>-test produce the same results, researchers should use the linear model because</p>
<ol style="list-style-type: decimal">
<li>A linear modeling strategy encourages researchers to think about the effect and uncertainty in the effect and not just a <em>p</em>-value.</li>
<li>The linear model is nearly infinitely flexible and expandible while the <em>t</em>-test has extremely limited flexibility (The Welch <em>t</em>-test is one way to expand the classical, Student’s <em>t</em>-test).</li>
</ol>
</div>
<div id="when-groups-of-the-focal-test-have-variance" class="section level3 hasAnchor" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> When groups of the focal test have &gt;&gt; variance<a href="violations.html#when-groups-of-the-focal-test-have-variance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="the-conditional-response-isnt-normal" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> The conditional response isn’t Normal<a href="violations.html#the-conditional-response-isnt-normal" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is common to hear or read from a statistitican that of all the issues with inference from a classical linear model (including <em>t</em>-tests and ANOVA), non-normal “data” is the least worrisome – we should be much more concerned about lack of independence and heterogeneity.</p>
<ol style="list-style-type: decimal">
<li>The theoretical basis for this sentiment is the <strong>central limit theorem</strong>. In short, if we repeatedly 1) sample a non-normal distribution and 2) compute the sample mean, the distribution <em>of these resampled means</em> is approximately normal (the distribution converges to normal as the sample size increases). Because inferential statistics using a classical linear model assume a normal distribution of the means, inference from classical linear models are increasingly robust to non-normal distributions as the sample size increases. The main issue for applied statistics in experimental biology is the small sample sizes.</li>
<li>Empirical results from simulations support the theory. Actual type I error using classical linear models with non-normal data tends to be close to the nominal (say, 0.05) level.</li>
<li>That said, <strong>generalized linear models that explicitly model the distribution have more power than classical linear models and this is a pretty good reason to use GLMs</strong>.</li>
<li>Confidence intervals computed using the normal distribution on non-normal data can be awkward, for example, the CIs might include impossible values such as negative counts or percent of cells expressing a certain marker above 100 %.</li>
</ol>
<p>The normality assumption of the classical linear model does not apply to the distribution of the response (<em>Y</em>) variable and certainly not to the distribution of the treatment (<em>X</em>) variable but to the <em>residuals of the fit model</em> (actually, it applies to the distribution of the means, but if the sampling distribution is normal then the means are normal). An equivalent way to think about this is that the normality assumption applies to the distribution of the response if all values of <span class="math inline">\(X\)</span> in the sample are the same – this is known as the <strong>conditional response</strong>. Contrary to common practice by experimental biologists, and the advice of some textbooks, there is no good reason to use the <em>p</em>-value from a test of normality as a decision tool to use either a <em>t</em>-test or a non-parametric test like the Mann-Whitney-Wilcoxon. A test of normality for small samples will frequently result in <span class="math inline">\(p &gt; 0.05\)</span> (“normal”), even for fake data sampled from a nonnormal distribution, while a test with a large sample size will frequently result in <span class="math inline">\(p &lt; 0.05\)</span> (“not-normal”) even if a histogram of the residuals appears normal.</p>
<p>A Normal Q-Q plot (Section <a href="model-checking.html#normal-qq">11.3.2</a>) is a useful tool for the decision to use some alternative to inference using a Normal assumption. If a Q-Q plot indicates that the residuals are far from expected for a normal distribution, then the researcher has several alternatives, the best choice of which partially depends on the goals of the analysis. Some alternative to a linear model assuming normal distribution include:</p>
<ol style="list-style-type: decimal">
<li>Count data – count data tend to be right skewed and groups with higher mean counts tend to have larger variance.</li>
</ol>
<ul>
<li>Generalized linear models using either a negative binomial or quasi-poisson distribution family are a good alternative to consider.</li>
<li>Bootstrap confidence intervals and permutation <em>p</em>-values are resampling techniques. Bootstrap confidence intervals are a good alternative if the sample size is much larger (say, &gt; 40) than typical in experimental biology. Permutation <em>p</em>-values are a good alternative regardless of sample size.</li>
<li>A GLS linear model to account for any heterogeneity in variance that typically accompanies non-normal data. This doesn’t address the non-normal distribution but, again, heterogeneity is typically a much larger problem than non-normality.</li>
<li>Log transformation of a count response is controversial at best. log transformations can be pretty good at making the response look more like it was sampled from a normal distribution (and can make variances more similar). But…If the counts include zero, researchers have to add a kludge factor (typically equal to 1) to all counts prior to transformation. The value of the kludge factor is arbitrary and matters (adding .1 gives different results than adding 1). A log transformation (or any transformation) raises interpretation problems. For the log transformation, the effect is the difference between the means of the log-transformed counts. I don’t know what the magnitude of an effect on a log scale means biologically. If we backtransform this, the effect is the ratio of the geometric means of the two groups. A ratio effect is easy enough to interpret but do we really want to model the geometric and not the arithmetic means? Finally, log transformation does not specifically address either the shape of the distribution or the heterogeneity that often comes with the non-normal shape. A generalized linear model can specifically model both the shape and the variance.</li>
<li>Classic non-parametric tests such as Mann-Whitney-Wilcoxon were invented when computers were not fast enough to perform permutation tests and before the development of Generalized Linear Models (and other modern methods). Since at least 1990, there are better alternatives to non-parametric tests.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Fraction (proportion) data – For example, the number of cells expressing a certain marker relative to all counted cells in the sample. Fraction data have hard bounds at 0 and 1, or at 0 and 100 if converted to a percent. Fraction data tend to be right skewed if the mean is closer to zero and left skewed if the mean is closer to the upper bound.</li>
</ol>
<ul>
<li>Generalized linear model using a binomial distribution family with a logit link (“logistic regression”) is a good alternative to consider. This model is used for Bernouili (success/fail) responses (for example the subject “lived” or “died”), where success is assigned the value 1 and fail is assigned the value 0. Using this model with proportion data is equivalent to assigning a 0 (“does not express marker”) or 1 (“expresses marker”) to all cells in the count.</li>
<li>Bootstrap confidence intervals and permutation <em>p</em>-values are resampling techniques. Bootstrap confidence intervals are a good alternative if the sample size is much larger (say, &gt; 40) than typical in experimental biology. Permutation <em>p</em>-values are a good alternative regardless of sample size.</li>
<li>A GLS linear model to account for any heterogeneity in variance that typically accompanies non-normal data. This doesn’t address the non-normal distribution but, again, heterogeneity is typically a much larger problem than non-normality.</li>
<li>arcsin transformation. See [The arcsine is asinine: the analysis of proportions in ecology] (<a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1890/10-0340.1" class="uri">https://esajournals.onlinelibrary.wiley.com/doi/full/10.1890/10-0340.1</a>)</li>
<li>Classic non-parametric tests such as Mann-Whitney-Wilcoxon were invented when computers were not fast enough to perform permutation tests and before the development of Generalized Linear Models (and other modern methods). Since at least 1990, there are better alternatives to non-parametric tests.</li>
</ul>
<p>Generalized linear models that explicitly model the distribution of the response is covered in more detail in the chapter <a href="counts.html#counts">Linear models for count data – Generalized Linear Models I</a>.</p>
<div id="violations-6f" class="section level3 hasAnchor" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Example 1 (fig6f) – Linear models for non-normal count data<a href="violations.html#violations-6f" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Source article: <a href="https://www.nature.com/articles/s41591-019-0633-x" target="_blank">Exercise reduces inflammatory cell production and cardiovascular inflammation via instruction of hematopoietic progenitor cells</a></p>
<p><a href="https://www.nature.com/articles/s41591-019-0633-x#Sec37" target="_blank">Data source</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6858591/" target="_blank">Public source</a></p>
<div id="fit-a-linear-model-inference-assuming-normal-conditional-response" class="section level4 hasAnchor" number="12.3.1.1">
<h4><span class="header-section-number">12.3.1.1</span> Fit a Linear Model – Inference assuming Normal conditional response<a href="violations.html#fit-a-linear-model-inference-assuming-normal-conditional-response" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>fit the model</strong></p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="violations.html#cb335-1" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(neutrophil_count <span class="sc">~</span> treatment, <span class="at">data =</span> fig6f)</span></code></pre></div>
<p><strong>check the model</strong></p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="violations.html#cb336-1" tabindex="-1"></a><span class="fu">ggcheck_the_model</span>(m1)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/violations-fig6f-check-1.png" width="576" /></p>
<p>The left plot shows classic right skew. The right plot shows evidence for positive relationship between mean and variance. This suggest we fit a negative binomial or quasi-poisson model.</p>
<p><strong>inference</strong></p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="violations.html#cb337-1" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb337-2"><a href="violations.html#cb337-2" tabindex="-1"></a>m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb337-3"><a href="violations.html#cb337-3" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;trt.vs.ctrl&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb337-4"><a href="violations.html#cb337-4" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="fit-a-generalized-linear-model-inference-assuming-negative-binomial-conditional-response" class="section level4 hasAnchor" number="12.3.1.2">
<h4><span class="header-section-number">12.3.1.2</span> Fit a Generalized Linear Model – inference assuming negative binomial conditional response<a href="violations.html#fit-a-generalized-linear-model-inference-assuming-negative-binomial-conditional-response" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Generalized linear models for count data are covered more thoroughly in the chapter <a href="counts.html#counts">Linear models for count data – Generalized Linear Models I</a>.</p>
<p><strong>fit the model</strong></p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="violations.html#cb338-1" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(neutrophil_count <span class="sc">~</span> treatment,</span>
<span id="cb338-2"><a href="violations.html#cb338-2" tabindex="-1"></a>              <span class="at">data =</span> fig6f,</span>
<span id="cb338-3"><a href="violations.html#cb338-3" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">nbinom2</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The function <code>glmmTMB</code> allows fitting from multiple distribution families and works like the <code>lm</code> function with a few tweaks, including an argument for the distribution family.</li>
</ol>
<p><strong>inference</strong></p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="violations.html#cb339-1" tabindex="-1"></a>m2_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(m2))<span class="sc">$</span>cond</span>
<span id="cb339-2"><a href="violations.html#cb339-2" tabindex="-1"></a></span>
<span id="cb339-3"><a href="violations.html#cb339-3" tabindex="-1"></a>m2_coef <span class="sc">%&gt;%</span></span>
<span id="cb339-4"><a href="violations.html#cb339-4" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb339-5"><a href="violations.html#cb339-5" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std. Error
</th>
<th style="text-align:right;">
z value
</th>
<th style="text-align:right;">
Pr(&gt;&amp;#124;z&amp;#124;)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
15.11
</td>
<td style="text-align:right;">
0.085
</td>
<td style="text-align:right;">
177.9
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
<tr>
<td style="text-align:left;">
treatmentExercise
</td>
<td style="text-align:right;">
-0.53
</td>
<td style="text-align:right;">
0.137
</td>
<td style="text-align:right;">
-3.8
</td>
<td style="text-align:right;">
0.00013
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The <code>coef</code> function for a glmmTMB object is a list with several elements. the element <span class="math inline">\(\texttt{\$cond}\)</span>” returns the coefficient table.</li>
<li><span class="math inline">\(b_0\)</span> (<span class="math inline">\(\texttt{(intercept)}\)</span>) is the natural log of the mean of the reference (“sedentary”) group.</li>
<li><span class="math inline">\(b_1\)</span> (<span class="math inline">\(\texttt{(intercept)}\)</span>) is the difference of the natural log of the mean of exercise group mean and the natural log of the mean of the sedentary group mean.</li>
<li>The coefficient values are on a <strong>link scale</strong>, which is the scale of the transformation of the group means in the GLM fit. The link transformation for this fit was <code>log</code> (the natural log transformation). In general, values on the <strong>response scale</strong> are more interpretable. <span class="math inline">\(exp(b_0)\)</span> is the modeled mean of the reference group on the response scale (because the model had no covariates, it is the sample mean of the reference group). <span class="math inline">\(exp(b_1)\)</span> is the <strong>ratio</strong> of the exercise to sedentary means. Remember: <span class="math inline">\(exp(log(a) - log(b)) = a/b\)</span></li>
</ol>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="violations.html#cb340-1" tabindex="-1"></a>m2_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m2,</span>
<span id="cb340-2"><a href="violations.html#cb340-2" tabindex="-1"></a>                  <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb340-3"><a href="violations.html#cb340-3" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb340-4"><a href="violations.html#cb340-4" tabindex="-1"></a>m2_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m2_emm,</span>
<span id="cb340-5"><a href="violations.html#cb340-5" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;trt.vs.ctrl&quot;</span>,</span>
<span id="cb340-6"><a href="violations.html#cb340-6" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb340-7"><a href="violations.html#cb340-7" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The argument <code>type = "response"</code> tells <code>emmeans</code> and <code>contrast</code> to return the estimates on the response (not link) scale. See the notes for the coefficient table above for a brief explanation of the link and response scale. For more detailed explanation, see the Chapter <a href="counts.html#counts">Linear models for count data – Generalized Linear Models I</a></li>
</ol>
</div>
<div id="compare-inference-from-the-lm-and-glm-models" class="section level4 hasAnchor" number="12.3.1.3">
<h4><span class="header-section-number">12.3.1.3</span> Compare inference from the LM and GLM models<a href="violations.html#compare-inference-from-the-lm-and-glm-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="violations.html#cb341-1" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> <span class="fu">ggplot_the_model</span>(</span>
<span id="cb341-2"><a href="violations.html#cb341-2" tabindex="-1"></a>  m1,</span>
<span id="cb341-3"><a href="violations.html#cb341-3" tabindex="-1"></a>  m1_emm,</span>
<span id="cb341-4"><a href="violations.html#cb341-4" tabindex="-1"></a>  m1_pairs,</span>
<span id="cb341-5"><a href="violations.html#cb341-5" tabindex="-1"></a>  <span class="at">legend_position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb341-6"><a href="violations.html#cb341-6" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="st">&quot;Neutrophil Count (/mL)&quot;</span>,</span>
<span id="cb341-7"><a href="violations.html#cb341-7" tabindex="-1"></a>  <span class="at">effect_label =</span> <span class="st">&quot;Effect (/mL)&quot;</span>,</span>
<span id="cb341-8"><a href="violations.html#cb341-8" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb341-9"><a href="violations.html#cb341-9" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.75</span>,<span class="dv">1</span>)</span>
<span id="cb341-10"><a href="violations.html#cb341-10" tabindex="-1"></a>)</span>
<span id="cb341-11"><a href="violations.html#cb341-11" tabindex="-1"></a></span>
<span id="cb341-12"><a href="violations.html#cb341-12" tabindex="-1"></a>gg2 <span class="ot">&lt;-</span> <span class="fu">ggplot_the_model</span>(</span>
<span id="cb341-13"><a href="violations.html#cb341-13" tabindex="-1"></a>  m2,</span>
<span id="cb341-14"><a href="violations.html#cb341-14" tabindex="-1"></a>  m2_emm,</span>
<span id="cb341-15"><a href="violations.html#cb341-15" tabindex="-1"></a>  m2_pairs,</span>
<span id="cb341-16"><a href="violations.html#cb341-16" tabindex="-1"></a>  <span class="at">legend_position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb341-17"><a href="violations.html#cb341-17" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="st">&quot;Neutrophil Count (/mL)&quot;</span>,</span>
<span id="cb341-18"><a href="violations.html#cb341-18" tabindex="-1"></a>  <span class="at">effect_label =</span> <span class="st">&quot;Relative Effect&quot;</span>,</span>
<span id="cb341-19"><a href="violations.html#cb341-19" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb341-20"><a href="violations.html#cb341-20" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.75</span>,<span class="dv">1</span>),</span>
<span id="cb341-21"><a href="violations.html#cb341-21" tabindex="-1"></a>  <span class="at">effect_x_lim =</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="fl">1.25</span>)</span>
<span id="cb341-22"><a href="violations.html#cb341-22" tabindex="-1"></a>)</span>
<span id="cb341-23"><a href="violations.html#cb341-23" tabindex="-1"></a></span>
<span id="cb341-24"><a href="violations.html#cb341-24" tabindex="-1"></a><span class="fu">plot_grid</span>(gg1, gg2, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="st">&quot;AUTO&quot;</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/violations-glm-plot-1.png" width="576" /></p>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>Generalized linear models are covered more thoroughly in Chapter <a href="counts.html#counts">18</a>.</li>
<li>The effect estimated from the GLM is not a difference but the ratio of the exercise group mean to the sedentary group mean. Both differences and ratios indicate how much bigger (or smaller) the mean of one group is compared to another but in a linear model “how much bigger” is a difference while in the glm here “how much bigger” is a multiple (or “times”) – the mean of the exercise group is .59X the mean of the sedentary group.</li>
<li>The CIs for the means and for the effect are asymmetric in the GLM. The CIs from a</li>
</ol>
</div>
</div>
<div id="my-data-arent-normal-what-is-the-best-practice" class="section level3 hasAnchor" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> My data aren’t normal, what is the best practice?<a href="violations.html#my-data-arent-normal-what-is-the-best-practice" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>The major advantage of using a GLM for count data instead of the classical linear model is the increased power of a significance test and increased precision of estimates. And, CIs will reflect the asymmetry in the uncertainty, unlike the CIs of a classical linear model. However, researchers should gaurd against the slight increase in Type I error of a GLM.</li>
</ol>
<div class="figure"><span style="display:block;" id="fig:violations-simulation-plot"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/violations-simulation-plot-1.png" alt="(A) histogram of distribution used for simulation of non-normal count response (sampled from negative binomial distribution with mu and theta equal to the observed values in Fig. 6f). (B) An example of a sampled fake data set." width="576" />
<p class="caption">
Figure 12.1: (A) histogram of distribution used for simulation of non-normal count response (sampled from negative binomial distribution with mu and theta equal to the observed values in Fig. 6f). (B) An example of a sampled fake data set.
</p>
</div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:violations-glm-count-simulation">Table 12.1: </span><span id="tab:violations-glm-count-simulation">Table 12.2: </span>Table of Type I error and Power computed from simulations of non-normal count data. The model columns are linear model, generalized least squares, GLM negative binomial, GLM quasipoisson, permutation, and Mann-Whitney-Wilcoxon. The values in the model columns are the frequency of simulated experiments with p
</caption>
<thead>
<tr>
<th style="text-align:right;">
sim
</th>
<th style="text-align:left;">
normal
</th>
<th style="text-align:left;">
type
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
theta
</th>
<th style="text-align:right;">
lm
</th>
<th style="text-align:right;">
gls
</th>
<th style="text-align:right;">
glm_nb
</th>
<th style="text-align:right;">
glm_qp
</th>
<th style="text-align:right;">
lmp
</th>
<th style="text-align:right;">
mww
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
type 1
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.050
</td>
<td style="text-align:right;">
0.076
</td>
<td style="text-align:right;">
0.052
</td>
<td style="text-align:right;">
0.053
</td>
<td style="text-align:right;">
0.046
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
type 1
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
6.6
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.041
</td>
<td style="text-align:right;">
0.075
</td>
<td style="text-align:right;">
0.044
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0.039
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
type 1
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
0.075
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0.041
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
type 1
</td>
<td style="text-align:left;">
12, 8
</td>
<td style="text-align:left;">
6.6
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.049
</td>
<td style="text-align:right;">
0.080
</td>
<td style="text-align:right;">
0.048
</td>
<td style="text-align:right;">
0.050
</td>
<td style="text-align:right;">
0.046
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
power
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
0.567
</td>
<td style="text-align:right;">
0.653
</td>
<td style="text-align:right;">
0.572
</td>
<td style="text-align:right;">
0.571
</td>
<td style="text-align:right;">
0.528
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
power
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
6.6
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.476
</td>
<td style="text-align:right;">
0.590
</td>
<td style="text-align:right;">
0.494
</td>
<td style="text-align:right;">
0.499
</td>
<td style="text-align:right;">
0.440
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
power
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.082
</td>
<td style="text-align:right;">
0.171
</td>
<td style="text-align:right;">
0.113
</td>
<td style="text-align:right;">
0.114
</td>
<td style="text-align:right;">
0.088
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
power
</td>
<td style="text-align:left;">
12, 8
</td>
<td style="text-align:left;">
6.6
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.501
</td>
<td style="text-align:right;">
0.578
</td>
<td style="text-align:right;">
0.452
</td>
<td style="text-align:right;">
0.444
</td>
<td style="text-align:right;">
0.438
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
power
</td>
<td style="text-align:left;">
12, 8
</td>
<td style="text-align:left;">
1, 6.6
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.082
</td>
<td style="text-align:right;">
0.144
</td>
<td style="text-align:right;">
0.054
</td>
<td style="text-align:right;">
0.041
</td>
<td style="text-align:right;">
0.045
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
type 1
</td>
<td style="text-align:left;">
12, 8
</td>
<td style="text-align:left;">
6.6, 1
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.103
</td>
<td style="text-align:right;">
0.139
</td>
<td style="text-align:right;">
0.116
</td>
<td style="text-align:right;">
0.132
</td>
<td style="text-align:right;">
0.144
</td>
</tr>
</tbody>
</table>
<p>Table <a href="violations.html#tab:violations-glm-count-simulation">12.1</a> summarizes the results of a simulation to compare the performance of alternatives to a <em>t</em>-test. The simulated data were modeled to look like the <a href="violations.html#violations-6f">Figure 6f</a> (Figure <a href="violations.html#fig:violations-simulation-plot">12.1</a>). The methods are the classical linear model (lm) (equivalent to the <em>t</em>-test), GLS linear model (gls), negative binomial GLM (glm-nb), quasi-poisson GLM (glm-qp), permutation test (lmp), and Mann-Whitney-Wilcoxon test. Performance is based on the the <em>p</em>-values from the test. The frequency of <span class="math inline">\(p &lt; 0.05\)</span> is given in the column for each method. If the simulation was run with no treatment effect, this frequency is the simulated Type I error, given the nominal error of <span class="math inline">\(\alpha = 0.05\)</span>. Values less then 0.05 are conservative and values greater than 0.05 are liberal. If the simulation was run with a treatment effect, the frequency is the simulated power of the test.</p>
<p>Over the limited parameter space of the non-normal distribution (the shape of the count distribution including the relationship between mean and variance, the sample size, the effect size), the negative binomial GLM has substantially higher power than the classical linear model, although this comes at some cost to inflated Type I error. Even with a Normal simulated distribution, the negative binomial GLM has higher power than the classical linear model, but again, at some cost to Type I error.</p>
<p>In the simulations with a negative binomial distributed response, the quasipoisson GLM has consistently higher power than the classical linear model and excellent Type I error control. The performance of the permutation test is very similar to that of the quasipoisson GLM. In the simulations with a negative binomial distributed response, the GLS linear model has about the same power as the classical linear model. Perhaps surprisingly, the Mann-Whitney-Wilcoxon fails to outperform the classical linear model and even underperforms the classical linear in some parts of the parameter space.</p>
</div>
</div>
<div id="hidden-code-4" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Hidden Code<a href="violations.html#hidden-code-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="importing-and-wrangling-the-exp1b-data" class="section level3 hasAnchor" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> Importing and wrangling the exp1b data<a href="violations.html#importing-and-wrangling-the-exp1b-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="violations.html#cb342-1" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;The cold-induced lipokine 12,13-diHOME promotes fatty acid transport into brown adipose tissue&quot;</span></span>
<span id="cb342-2"><a href="violations.html#cb342-2" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41591_2017_BFnm4297_MOESM1_ESM.xlsx&quot;</span></span>
<span id="cb342-3"><a href="violations.html#cb342-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb342-4"><a href="violations.html#cb342-4" tabindex="-1"></a></span>
<span id="cb342-5"><a href="violations.html#cb342-5" tabindex="-1"></a>exp1b <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb342-6"><a href="violations.html#cb342-6" tabindex="-1"></a>                     <span class="at">sheet =</span> <span class="st">&quot;Fig 1 b thur c&quot;</span>,</span>
<span id="cb342-7"><a href="violations.html#cb342-7" tabindex="-1"></a>                     <span class="at">range =</span> <span class="st">&quot;A1:C20&quot;</span>,</span>
<span id="cb342-8"><a href="violations.html#cb342-8" tabindex="-1"></a>                     <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb342-9"><a href="violations.html#cb342-9" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb342-10"><a href="violations.html#cb342-10" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb342-11"><a href="violations.html#cb342-11" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="co"># get rid of blank row</span></span>
<span id="cb342-12"><a href="violations.html#cb342-12" tabindex="-1"></a></span>
<span id="cb342-13"><a href="violations.html#cb342-13" tabindex="-1"></a><span class="fu">setnames</span>(exp1b,</span>
<span id="cb342-14"><a href="violations.html#cb342-14" tabindex="-1"></a>         <span class="at">old =</span> <span class="fu">names</span>(exp1b),</span>
<span id="cb342-15"><a href="violations.html#cb342-15" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;diHOME&quot;</span>, <span class="st">&quot;bat_activity&quot;</span>))</span>
<span id="cb342-16"><a href="violations.html#cb342-16" tabindex="-1"></a></span>
<span id="cb342-17"><a href="violations.html#cb342-17" tabindex="-1"></a>exp1b[, id <span class="sc">:=</span> <span class="fu">substr</span>(sample, <span class="dv">1</span>, <span class="dv">6</span>)]</span>
<span id="cb342-18"><a href="violations.html#cb342-18" tabindex="-1"></a>exp1b[, treatment <span class="sc">:=</span> <span class="fu">ifelse</span>(<span class="fu">substr</span>(sample, <span class="dv">8</span>,<span class="dv">8</span>) <span class="sc">==</span></span>
<span id="cb342-19"><a href="violations.html#cb342-19" tabindex="-1"></a>                              <span class="st">&quot;C&quot;</span>, <span class="st">&quot;cold&quot;</span>, <span class="st">&quot;saline&quot;</span>)]</span>
<span id="cb342-20"><a href="violations.html#cb342-20" tabindex="-1"></a>exp1b[, treatment <span class="sc">:=</span> <span class="fu">factor</span>(treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;saline&quot;</span>, <span class="st">&quot;cold&quot;</span>))]</span>
<span id="cb342-21"><a href="violations.html#cb342-21" tabindex="-1"></a></span>
<span id="cb342-22"><a href="violations.html#cb342-22" tabindex="-1"></a><span class="co">#View(exp1b)</span></span></code></pre></div>
</div>
<div id="importing-and-wrangling-the-exp2a-data" class="section level3 hasAnchor" number="12.4.2">
<h3><span class="header-section-number">12.4.2</span> Importing and wrangling the exp2a data<a href="violations.html#importing-and-wrangling-the-exp2a-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="violations.html#cb343-1" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;The cold-induced lipokine 12,13-diHOME promotes fatty acid transport into brown adipose tissue&quot;</span></span>
<span id="cb343-2"><a href="violations.html#cb343-2" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41591_2017_BFnm4297_MOESM2_ESM.xlsx&quot;</span></span>
<span id="cb343-3"><a href="violations.html#cb343-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb343-4"><a href="violations.html#cb343-4" tabindex="-1"></a></span>
<span id="cb343-5"><a href="violations.html#cb343-5" tabindex="-1"></a><span class="co"># assuming mice are independent and not same mouse used for all three treatment</span></span>
<span id="cb343-6"><a href="violations.html#cb343-6" tabindex="-1"></a>melt_col_names <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Animal&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb343-7"><a href="violations.html#cb343-7" tabindex="-1"></a>exp2a <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb343-8"><a href="violations.html#cb343-8" tabindex="-1"></a>                     <span class="at">sheet =</span> <span class="st">&quot;Fig 2a&quot;</span>,</span>
<span id="cb343-9"><a href="violations.html#cb343-9" tabindex="-1"></a>                     <span class="at">range =</span> <span class="st">&quot;A3:G6&quot;</span>,</span>
<span id="cb343-10"><a href="violations.html#cb343-10" tabindex="-1"></a>                     <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb343-11"><a href="violations.html#cb343-11" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb343-12"><a href="violations.html#cb343-12" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">measure.vars =</span> melt_col_names,</span>
<span id="cb343-13"><a href="violations.html#cb343-13" tabindex="-1"></a>       <span class="at">variable.name =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb343-14"><a href="violations.html#cb343-14" tabindex="-1"></a>       <span class="at">value.name =</span> <span class="st">&quot;diHOME&quot;</span>) <span class="co"># cannot start a variable with number</span></span>
<span id="cb343-15"><a href="violations.html#cb343-15" tabindex="-1"></a><span class="fu">setnames</span>(exp2a, <span class="at">old =</span> <span class="fu">colnames</span>(exp2a)[<span class="dv">1</span>], <span class="at">new =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb343-16"><a href="violations.html#cb343-16" tabindex="-1"></a></span>
<span id="cb343-17"><a href="violations.html#cb343-17" tabindex="-1"></a>treatment_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;1 hour cold&quot;</span>, <span class="st">&quot;30 min NE&quot;</span>)</span>
<span id="cb343-18"><a href="violations.html#cb343-18" tabindex="-1"></a>exp2a[, treatment <span class="sc">:=</span> <span class="fu">factor</span>(treatment, treatment_order)] <span class="co"># order levels</span></span>
<span id="cb343-19"><a href="violations.html#cb343-19" tabindex="-1"></a></span>
<span id="cb343-20"><a href="violations.html#cb343-20" tabindex="-1"></a><span class="co">#View(exp2a)</span></span></code></pre></div>
</div>
<div id="importing-and-wrangling-the-fig6f-data" class="section level3 hasAnchor" number="12.4.3">
<h3><span class="header-section-number">12.4.3</span> Importing and wrangling the fig6f data<a href="violations.html#importing-and-wrangling-the-fig6f-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="violations.html#cb344-1" tabindex="-1"></a><span class="co"># need data_folder from earlier chunk</span></span>
<span id="cb344-2"><a href="violations.html#cb344-2" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Exercise reduces inflammatory cell production and cardiovascular inflammation via instruction of hematopoietic progenitor cells&quot;</span></span>
<span id="cb344-3"><a href="violations.html#cb344-3" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41591_2019_633_MOESM8_ESM.xlsx&quot;</span></span>
<span id="cb344-4"><a href="violations.html#cb344-4" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb344-5"><a href="violations.html#cb344-5" tabindex="-1"></a></span>
<span id="cb344-6"><a href="violations.html#cb344-6" tabindex="-1"></a><span class="co"># assuming mice are independent and not same mouse used for all three treatment</span></span>
<span id="cb344-7"><a href="violations.html#cb344-7" tabindex="-1"></a>melt_col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Sedentary&quot;</span>, <span class="st">&quot;Exercise&quot;</span>)</span>
<span id="cb344-8"><a href="violations.html#cb344-8" tabindex="-1"></a>fig6f <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb344-9"><a href="violations.html#cb344-9" tabindex="-1"></a>                     <span class="at">sheet =</span> <span class="st">&quot;Figure 6f&quot;</span>,</span>
<span id="cb344-10"><a href="violations.html#cb344-10" tabindex="-1"></a>                     <span class="at">range =</span> <span class="st">&quot;A7:B29&quot;</span>,</span>
<span id="cb344-11"><a href="violations.html#cb344-11" tabindex="-1"></a>                     <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-12"><a href="violations.html#cb344-12" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb344-13"><a href="violations.html#cb344-13" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">measure.vars =</span> melt_col_names,</span>
<span id="cb344-14"><a href="violations.html#cb344-14" tabindex="-1"></a>       <span class="at">variable.name =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb344-15"><a href="violations.html#cb344-15" tabindex="-1"></a>       <span class="at">value.name =</span> <span class="st">&quot;neutrophils&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-16"><a href="violations.html#cb344-16" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="co"># danger!</span></span>
<span id="cb344-17"><a href="violations.html#cb344-17" tabindex="-1"></a></span>
<span id="cb344-18"><a href="violations.html#cb344-18" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> melt_col_names</span>
<span id="cb344-19"><a href="violations.html#cb344-19" tabindex="-1"></a>fig6f[, treatment <span class="sc">:=</span> <span class="fu">factor</span>(treatment,</span>
<span id="cb344-20"><a href="violations.html#cb344-20" tabindex="-1"></a>                            <span class="at">levels =</span> treatment_levels)]</span>
<span id="cb344-21"><a href="violations.html#cb344-21" tabindex="-1"></a></span>
<span id="cb344-22"><a href="violations.html#cb344-22" tabindex="-1"></a><span class="co"># neutrophils is count/10^6</span></span>
<span id="cb344-23"><a href="violations.html#cb344-23" tabindex="-1"></a>fig6f[, neutrophil_count <span class="sc">:=</span> <span class="fu">round</span>(neutrophils<span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="dv">0</span>)]</span>
<span id="cb344-24"><a href="violations.html#cb344-24" tabindex="-1"></a></span>
<span id="cb344-25"><a href="violations.html#cb344-25" tabindex="-1"></a>fig6f[<span class="dv">1</span>, neutrophil_count]</span></code></pre></div>
<pre><code>## [1] 4936007</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="violations.html#cb346-1" tabindex="-1"></a><span class="co">#View(fig6f)</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-checking.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="issues.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/28-violations.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
