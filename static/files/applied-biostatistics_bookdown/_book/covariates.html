<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Linear models with added covariates (“ANCOVA”) | Applied Statistics for Experimental Biology</title>
  <meta name="description" content="An introduction to statistical modeling for experimental biology researchers" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Linear models with added covariates (“ANCOVA”) | Applied Statistics for Experimental Biology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Linear models with added covariates (“ANCOVA”) | Applied Statistics for Experimental Biology" />
  
  <meta name="twitter:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="part-v-more-than-one-x-multivariable-models.html"/>
<link rel="next" href="factorial.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="index.html#why-bother-with-linear-models-arent-t-tests-and-anova-good-enough" id="toc-why-bother-with-linear-models-arent-t-tests-and-anova-good-enough">Why bother with linear models – aren’t <em>t</em>-tests and ANOVA good enough?</a></li>
<li><a href="index.html#what-is-unusual-about-this-book" id="toc-what-is-unusual-about-this-book">What is unusual about this book?</a></li>
</ul></li>
<li><a href="a-table-of-models.html#a-table-of-models" id="toc-a-table-of-models">A Table of Models</a>
<ul>
<li><a href="a-table-of-models.html#including-mapping-between-linear-models-and-classical-tests" id="toc-including-mapping-between-linear-models-and-classical-tests">including mapping between linear models and classical tests</a></li>
</ul></li>
<li><a href="ask1-intro.html#ask1-intro" id="toc-ask1-intro"><span class="toc-section-number">1</span> Analyzing experimental data with a linear model</a>
<ul>
<li><a href="ask1-intro.html#this-text-is-about-using-linear-models-to-estimate-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect" id="toc-this-text-is-about-using-linear-models-to-estimate-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect"><span class="toc-section-number">1.1</span> This text is about using linear models to estimate treatment effects and the uncertainty in our estimates. This, raises the question, what is “an effect”?</a></li>
</ul></li>
<li><a href="part-i-getting-started.html#part-i-getting-started" id="toc-part-i-getting-started">Part I: Getting Started</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#getting-started-r-projects-and-r-markdown" id="toc-getting-started-r-projects-and-r-markdown"><span class="toc-section-number">2</span> Getting Started – R Projects and R Markdown</a>
<ul>
<li><a href="getting-started-r-projects-and-r-markdown.html#r-vs-r-studio" id="toc-r-vs-r-studio"><span class="toc-section-number">2.1</span> R vs R Studio</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#download-and-install-r-and-r-studio" id="toc-download-and-install-r-and-r-studio"><span class="toc-section-number">2.2</span> Download and install R and R studio</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#open-r-studio-and-modify-the-workspace-preference" id="toc-open-r-studio-and-modify-the-workspace-preference"><span class="toc-section-number">2.3</span> Open R Studio and modify the workspace preference</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it" id="toc-if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it"><span class="toc-section-number">2.4</span> If you didn’t modify the workspace preferences from the previous section, go back and do it</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#r-markdown-in-a-nutshell" id="toc-r-markdown-in-a-nutshell"><span class="toc-section-number">2.5</span> R Markdown in a nutshell</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#install-r-markdown" id="toc-install-r-markdown"><span class="toc-section-number">2.6</span> Install R Markdown</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#importing-packages" id="toc-importing-packages"><span class="toc-section-number">2.7</span> Importing Packages</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#setup-create-project" id="toc-setup-create-project"><span class="toc-section-number">2.8</span> Create an R Studio Project for this textbook</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#working-on-a-project-in-a-nutshell" id="toc-working-on-a-project-in-a-nutshell"><span class="toc-section-number">2.9</span> Working on a project, in a nutshell</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#setup-create-rmd" id="toc-setup-create-rmd"><span class="toc-section-number">2.10</span> Create and setup an R Markdown document (Rmd)</a>
<ul>
<li><a href="getting-started-r-projects-and-r-markdown.html#modify-the-yaml-header" id="toc-modify-the-yaml-header"><span class="toc-section-number">2.10.1</span> Modify the yaml header</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#modify-the-setup-chunk" id="toc-modify-the-setup-chunk"><span class="toc-section-number">2.10.2</span> Modify the “setup” chunk</a></li>
</ul></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#lets-play-around-with-an-r-markdown-file" id="toc-lets-play-around-with-an-r-markdown-file"><span class="toc-section-number">2.11</span> Let’s play around with an R Markdown file</a>
<ul>
<li><a href="getting-started-r-projects-and-r-markdown.html#create-a-fake-data-chunk" id="toc-create-a-fake-data-chunk"><span class="toc-section-number">2.11.1</span> Create a “fake-data” chunk</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#create-a-plot-chunk" id="toc-create-a-plot-chunk"><span class="toc-section-number">2.11.2</span> Create a “plot” chunk</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#knit-the-rmd" id="toc-knit-the-rmd"><span class="toc-section-number">2.11.3</span> Knit the Rmd</a></li>
</ul></li>
</ul></li>
<li><a href="part-ii-r-fundamentals.html#part-ii-r-fundamentals" id="toc-part-ii-r-fundamentals">Part II: R fundamentals</a></li>
<li><a href="data.html#data" id="toc-data"><span class="toc-section-number">3</span> Data – Reading, Wrangling, and Writing</a>
<ul>
<li><a href="data.html#data-long" id="toc-data-long"><span class="toc-section-number">3.1</span> Long data format – the way data should be</a></li>
<li><a href="data.html#data-here" id="toc-data-here"><span class="toc-section-number">3.2</span> Use the here function to construct the file path</a></li>
<li><a href="data.html#learning-from-this-chapter" id="toc-learning-from-this-chapter"><span class="toc-section-number">3.3</span> Learning from this chapter</a></li>
<li><a href="data.html#data-working-in-r" id="toc-data-working-in-r"><span class="toc-section-number">3.4</span> Working in R</a>
<ul>
<li><a href="data.html#importing-data" id="toc-importing-data"><span class="toc-section-number">3.4.1</span> Importing data</a></li>
</ul></li>
<li><a href="data.html#data-wrangling" id="toc-data-wrangling"><span class="toc-section-number">3.5</span> Data wrangling</a>
<ul>
<li><a href="data.html#reshaping-data-wide-to-long" id="toc-reshaping-data-wide-to-long"><span class="toc-section-number">3.5.1</span> Reshaping data – Wide to long</a></li>
<li><a href="data.html#reshaping-data-transpose-turning-the-columns-into-rows" id="toc-reshaping-data-transpose-turning-the-columns-into-rows"><span class="toc-section-number">3.5.2</span> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li><a href="data.html#combining-data" id="toc-combining-data"><span class="toc-section-number">3.5.3</span> Combining data</a></li>
<li><a href="data.html#data-subset" id="toc-data-subset"><span class="toc-section-number">3.5.4</span> Subsetting data</a></li>
<li><a href="data.html#wrangling-columns" id="toc-wrangling-columns"><span class="toc-section-number">3.5.5</span> Wrangling columns</a></li>
<li><a href="data.html#missing-data" id="toc-missing-data"><span class="toc-section-number">3.5.6</span> Missing data</a></li>
</ul></li>
<li><a href="data.html#saving-data" id="toc-saving-data"><span class="toc-section-number">3.6</span> Saving data</a></li>
<li><a href="data.html#exercises" id="toc-exercises"><span class="toc-section-number">3.7</span> Exercises</a></li>
</ul></li>
<li><a href="plotting-models.html#plotting-models" id="toc-plotting-models"><span class="toc-section-number">4</span> Plotting Models</a>
<ul>
<li><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data" id="toc-pretty-good-plots-show-the-model-and-the-data"><span class="toc-section-number">4.1</span> Pretty good plots show the model and the data</a>
<ul>
<li><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot" id="toc-pretty-good-plot-component-1-modeled-effects-plot"><span class="toc-section-number">4.1.1</span> Pretty good plot component 1: Modeled effects plot</a></li>
<li><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot" id="toc-pretty-good-plot-component-2-modeled-mean-and-ci-plot"><span class="toc-section-number">4.1.2</span> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot." id="toc-combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><span class="toc-section-number">4.1.3</span> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
<li><a href="plotting-models.html#some-comments-on-plot-components" id="toc-some-comments-on-plot-components"><span class="toc-section-number">4.1.4</span> Some comments on plot components</a></li>
</ul></li>
<li><a href="plotting-models.html#working-in-r" id="toc-working-in-r"><span class="toc-section-number">4.2</span> Working in R</a>
<ul>
<li><a href="plotting-models.html#source-data" id="toc-source-data"><span class="toc-section-number">4.2.1</span> Source data</a></li>
<li><a href="plotting-models.html#how-to-plot-the-model" id="toc-how-to-plot-the-model"><span class="toc-section-number">4.2.2</span> How to plot the model</a></li>
<li><a href="plotting-models.html#be-sure-ggplot_the_model-is-in-your-r-folder" id="toc-be-sure-ggplot_the_model-is-in-your-r-folder"><span class="toc-section-number">4.2.3</span> Be sure ggplot_the_model is in your R folder</a></li>
<li><a href="plotting-models.html#how-to-use-the-plot-the-model-functions" id="toc-how-to-use-the-plot-the-model-functions"><span class="toc-section-number">4.2.4</span> How to use the Plot the Model functions</a></li>
<li><a href="plotting-models.html#how-to-generate-a-response-plot-using-ggpubr" id="toc-how-to-generate-a-response-plot-using-ggpubr"><span class="toc-section-number">4.2.5</span> How to generate a Response Plot using ggpubr</a></li>
<li><a href="plotting-models.html#how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2" id="toc-how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2"><span class="toc-section-number">4.2.6</span> How to generate a Response Plot with a grid of treatments using ggplot2</a></li>
<li><a href="plotting-models.html#how-to-generate-an-effects-plot" id="toc-how-to-generate-an-effects-plot"><span class="toc-section-number">4.2.7</span> How to generate an Effects Plot</a></li>
<li><a href="plotting-models.html#how-to-combine-the-response-and-effects-plots" id="toc-how-to-combine-the-response-and-effects-plots"><span class="toc-section-number">4.2.8</span> How to combine the response and effects plots</a></li>
<li><a href="plotting-models.html#how-to-add-the-interaction-effect-to-response-and-effects-plots" id="toc-how-to-add-the-interaction-effect-to-response-and-effects-plots"><span class="toc-section-number">4.2.9</span> How to add the interaction effect to response and effects plots</a></li>
</ul></li>
</ul></li>
<li><a href="part-iii-some-fundamentals-of-statistical-modeling.html#part-iii-some-fundamentals-of-statistical-modeling" id="toc-part-iii-some-fundamentals-of-statistical-modeling">Part III: Some Fundamentals of Statistical Modeling</a></li>
<li><a href="uncertainty.html#uncertainty" id="toc-uncertainty"><span class="toc-section-number">5</span> Variability and Uncertainty (Standard Deviations, Standard Errors, and Confidence Intervals)</a>
<ul>
<li><a href="uncertainty.html#standard-errors-are-used-to-compute-p-values-and-confidence-intervals" id="toc-standard-errors-are-used-to-compute-p-values-and-confidence-intervals"><span class="toc-section-number">5.1</span> Standard errors are used to compute <em>p</em>-values and confidence intervals</a></li>
<li><a href="uncertainty.html#background" id="toc-background"><span class="toc-section-number">5.2</span> Background</a>
<ul>
<li><a href="uncertainty.html#sample-standard-deviation" id="toc-sample-standard-deviation"><span class="toc-section-number">5.2.1</span> Sample standard deviation</a></li>
<li><a href="uncertainty.html#standard-error-of-the-mean" id="toc-standard-error-of-the-mean"><span class="toc-section-number">5.2.2</span> Standard error of the mean</a></li>
</ul></li>
<li><a href="uncertainty.html#simulations-using-fake-data-as-an-intuition-pump" id="toc-simulations-using-fake-data-as-an-intuition-pump"><span class="toc-section-number">5.3</span> Simulations – using fake data as an intuition pump</a>
<ul>
<li><a href="uncertainty.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error" id="toc-using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><span class="toc-section-number">5.3.1</span> Using Google Sheets to generate fake data to explore the standard error</a></li>
<li><a href="uncertainty.html#using-r-to-generate-fake-data-to-explore-the-standard-error" id="toc-using-r-to-generate-fake-data-to-explore-the-standard-error"><span class="toc-section-number">5.3.2</span> Using R to generate fake data to explore the standard error</a></li>
</ul></li>
<li><a href="uncertainty.html#bootstrap" id="toc-bootstrap"><span class="toc-section-number">5.4</span> Bootstrapped standard errors</a>
<ul>
<li><a href="uncertainty.html#an-example-of-bootstrapped-standard-errors" id="toc-an-example-of-bootstrapped-standard-errors"><span class="toc-section-number">5.4.1</span> An example of bootstrapped standard errors</a></li>
</ul></li>
<li><a href="uncertainty.html#confidence-intervals" id="toc-confidence-intervals"><span class="toc-section-number">5.5</span> Confidence Intervals</a>
<ul>
<li><a href="uncertainty.html#just-the-math" id="toc-just-the-math"><span class="toc-section-number">5.5.1</span> Just the math</a></li>
<li><a href="uncertainty.html#interpretation-of-a-confidence-interval" id="toc-interpretation-of-a-confidence-interval"><span class="toc-section-number">5.5.2</span> Interpretation of a confidence interval</a></li>
<li><a href="uncertainty.html#bootstrap-confidence-interval" id="toc-bootstrap-confidence-interval"><span class="toc-section-number">5.5.3</span> Bootstrap confidence interval</a></li>
<li><a href="uncertainty.html#a-plot-of-a-parametric-ci-vs.-bootstrap-ci-of-the-means" id="toc-a-plot-of-a-parametric-ci-vs.-bootstrap-ci-of-the-means"><span class="toc-section-number">5.5.4</span> A plot of a “parametric” CI vs. bootstrap CI of the means</a></li>
</ul></li>
<li><a href="uncertainty.html#standard-error-of-a-difference-between-means" id="toc-standard-error-of-a-difference-between-means"><span class="toc-section-number">5.6</span> Standard error of a difference between means</a>
<ul>
<li><a href="uncertainty.html#the-standard-error-of-a-difference-between-means-is-the-standard-deviation-of-the-sampling-distribution-of-the-difference" id="toc-the-standard-error-of-a-difference-between-means-is-the-standard-deviation-of-the-sampling-distribution-of-the-difference"><span class="toc-section-number">5.6.1</span> The standard error of a difference between means is the standard deviation of the sampling distribution of the difference</a></li>
</ul></li>
<li><a href="uncertainty.html#confidence-limits-of-a-difference-between-means" id="toc-confidence-limits-of-a-difference-between-means"><span class="toc-section-number">5.7</span> Confidence limits of a difference between means</a>
<ul>
<li><a href="uncertainty.html#of-95-cis-of-the-difference-include-the-true-difference" id="toc-of-95-cis-of-the-difference-include-the-true-difference"><span class="toc-section-number">5.7.1</span> 95% of 95% CIs of the difference include the true difference</a></li>
</ul></li>
<li><a href="uncertainty.html#hidden-code" id="toc-hidden-code"><span class="toc-section-number">5.8</span> Hidden code</a>
<ul>
<li><a href="uncertainty.html#import-exp3b" id="toc-import-exp3b"><span class="toc-section-number">5.8.1</span> Import exp3b</a></li>
</ul></li>
</ul></li>
<li><a href="p-values.html#p-values" id="toc-p-values"><span class="toc-section-number">6</span> P-values</a>
<ul>
<li><a href="p-values.html#a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution" id="toc-a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution"><span class="toc-section-number">6.1</span> A <em>p</em>-value is the probability of sampling a value as or more extreme than the test statistic if sampling from a null distribution</a></li>
<li><a href="p-values.html#pump-your-intuition-creating-a-null-distribution" id="toc-pump-your-intuition-creating-a-null-distribution"><span class="toc-section-number">6.2</span> Pump your intuition – Creating a null distribution</a></li>
<li><a href="p-values.html#a-null-distribution-of-t-values-the-t-distribution" id="toc-a-null-distribution-of-t-values-the-t-distribution"><span class="toc-section-number">6.3</span> A null distribution of <em>t</em>-values – the <em>t</em> distribution</a></li>
<li><a href="p-values.html#p-values-from-the-perspective-of-permutation" id="toc-p-values-from-the-perspective-of-permutation"><span class="toc-section-number">6.4</span> P-values from the perspective of permutation</a></li>
<li><a href="p-values.html#parametric-vs.-non-parametric-statistics" id="toc-parametric-vs.-non-parametric-statistics"><span class="toc-section-number">6.5</span> Parametric vs. non-parametric statistics</a></li>
<li><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values" id="toc-frequentist-probability-and-the-interpretation-of-p-values"><span class="toc-section-number">6.6</span> frequentist probability and the interpretation of p-values</a>
<ul>
<li><a href="p-values.html#background-1" id="toc-background-1"><span class="toc-section-number">6.6.1</span> Background</a></li>
<li><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability." id="toc-this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><span class="toc-section-number">6.6.2</span> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li><a href="p-values.html#two-interpretations-of-the-p-value" id="toc-two-interpretations-of-the-p-value"><span class="toc-section-number">6.6.3</span> Two interpretations of the <em>p</em>-value</a></li>
<li><a href="p-values.html#nhst" id="toc-nhst"><span class="toc-section-number">6.6.4</span> NHST</a></li>
</ul></li>
<li><a href="p-values.html#some-major-misconceptions-of-the-p-value" id="toc-some-major-misconceptions-of-the-p-value"><span class="toc-section-number">6.7</span> Some major misconceptions of the <em>p</em>-value</a>
<ul>
<li><a href="p-values.html#misconception-p-0.05-means-there-is-no-effect-of-treatment" id="toc-misconception-p-0.05-means-there-is-no-effect-of-treatment"><span class="toc-section-number">6.7.1</span> Misconception: <span class="math inline">\(p &gt; 0.05\)</span> means there is no effect of treatment</a></li>
<li><a href="p-values.html#misconception-a-p-value-is-repeatable" id="toc-misconception-a-p-value-is-repeatable"><span class="toc-section-number">6.7.2</span> Misconception: a <em>p</em>-value is repeatable</a></li>
<li><a href="p-values.html#misconception-0.05-is-the-lifetime-rate-of-false-discoveries" id="toc-misconception-0.05-is-the-lifetime-rate-of-false-discoveries"><span class="toc-section-number">6.7.3</span> Misconception: 0.05 is the lifetime rate of false discoveries</a></li>
<li><a href="p-values.html#misconception-a-low-p-value-indicates-an-important-effect" id="toc-misconception-a-low-p-value-indicates-an-important-effect"><span class="toc-section-number">6.7.4</span> Misconception: a low <em>p</em>-value indicates an important effect</a></li>
<li><a href="p-values.html#misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity" id="toc-misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity"><span class="toc-section-number">6.7.5</span> Misconception: a low <em>p</em>-value indicates high model fit or high predictive capacity</a></li>
</ul></li>
<li><a href="p-values.html#what-the-p-value-does-not-mean" id="toc-what-the-p-value-does-not-mean"><span class="toc-section-number">6.8</span> What the <em>p</em>-value does not mean</a></li>
<li><a href="p-values.html#on-using-p-values-in-experimental-biology" id="toc-on-using-p-values-in-experimental-biology"><span class="toc-section-number">6.9</span> On using <em>p</em>-values in experimental biology</a></li>
<li><a href="p-values.html#better-reproducibility" id="toc-better-reproducibility"><span class="toc-section-number">6.10</span> Better reproducibility</a></li>
<li><a href="p-values.html#multiple-testing-and-controlling-for-false-positives" id="toc-multiple-testing-and-controlling-for-false-positives"><span class="toc-section-number">6.11</span> Multiple testing and controlling for false positives</a>
<ul>
<li><a href="p-values.html#controlling-the-family-wise-error-rate-when-all-tests-are-testing-the-same-hypothesis" id="toc-controlling-the-family-wise-error-rate-when-all-tests-are-testing-the-same-hypothesis"><span class="toc-section-number">6.11.1</span> Controlling the family-wise error rate when all tests are testing the same hypothesis</a></li>
</ul></li>
<li><a href="p-values.html#recommendations" id="toc-recommendations"><span class="toc-section-number">6.12</span> Recommendations</a>
<ul>
<li><a href="p-values.html#primary-sources-for-recommendations" id="toc-primary-sources-for-recommendations"><span class="toc-section-number">6.12.1</span> Primary sources for recommendations</a></li>
</ul></li>
<li><a href="p-values.html#problems" id="toc-problems"><span class="toc-section-number">6.13</span> Problems</a></li>
</ul></li>
<li><a href="errors-in-inference.html#errors-in-inference" id="toc-errors-in-inference"><span class="toc-section-number">7</span> Errors in inference</a>
<ul>
<li><a href="errors-in-inference.html#classical-nhst-concepts-of-wrong" id="toc-classical-nhst-concepts-of-wrong"><span class="toc-section-number">7.1</span> Classical NHST concepts of wrong</a>
<ul>
<li><a href="errors-in-inference.html#type-i-error" id="toc-type-i-error"><span class="toc-section-number">7.1.1</span> Type I error</a></li>
<li><a href="errors-in-inference.html#power" id="toc-power"><span class="toc-section-number">7.1.2</span> Power</a></li>
</ul></li>
<li><a href="errors-in-inference.html#a-non-neyman-pearson-concept-of-power" id="toc-a-non-neyman-pearson-concept-of-power"><span class="toc-section-number">7.2</span> A non-Neyman-Pearson concept of power</a>
<ul>
<li><a href="errors-in-inference.html#estimation-error" id="toc-estimation-error"><span class="toc-section-number">7.2.1</span> Estimation error</a></li>
<li><a href="errors-in-inference.html#coverage" id="toc-coverage"><span class="toc-section-number">7.2.2</span> Coverage</a></li>
<li><a href="errors-in-inference.html#type-s-error" id="toc-type-s-error"><span class="toc-section-number">7.2.3</span> Type S error</a></li>
<li><a href="errors-in-inference.html#type-m-error" id="toc-type-m-error"><span class="toc-section-number">7.2.4</span> Type M error</a></li>
</ul></li>
</ul></li>
<li><a href="part-iv-introduction-to-linear-models.html#part-iv-introduction-to-linear-models" id="toc-part-iv-introduction-to-linear-models">Part IV: Introduction to Linear Models</a></li>
<li><a href="intro-linear-models.html#intro-linear-models" id="toc-intro-linear-models"><span class="toc-section-number">8</span> An introduction to linear models</a>
<ul>
<li><a href="intro-linear-models.html#lm-specifications" id="toc-lm-specifications"><span class="toc-section-number">8.1</span> Two specifications of a linear model</a>
<ul>
<li><a href="intro-linear-models.html#the-error-draw-specification" id="toc-the-error-draw-specification"><span class="toc-section-number">8.1.1</span> The “error draw” specification</a></li>
<li><a href="intro-linear-models.html#the-conditional-draw-specification" id="toc-the-conditional-draw-specification"><span class="toc-section-number">8.1.2</span> The “conditional draw” specification</a></li>
<li><a href="intro-linear-models.html#comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model" id="toc-comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model"><span class="toc-section-number">8.1.3</span> Comparing the error-draw and conditional-draw ways of specifying the linear model</a></li>
<li><a href="intro-linear-models.html#anova-notation-of-a-linear-model" id="toc-anova-notation-of-a-linear-model"><span class="toc-section-number">8.1.4</span> ANOVA notation of a linear model</a></li>
</ul></li>
<li><a href="intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables" id="toc-a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"><span class="toc-section-number">8.2</span> A linear model can be fit to data with continuous, discrete, or categorical <span class="math inline">\(X\)</span> variables</a>
<ul>
<li><a href="intro-linear-models.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete" id="toc-fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete"><span class="toc-section-number">8.2.1</span> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is continuous or discrete</a></li>
<li><a href="intro-linear-models.html#slope" id="toc-slope"><span class="toc-section-number">8.2.2</span> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is categorical</a></li>
</ul></li>
<li><a href="intro-linear-models.html#statistical-models-are-used-for-prediction-explanation-and-description" id="toc-statistical-models-are-used-for-prediction-explanation-and-description"><span class="toc-section-number">8.3</span> Statistical models are used for prediction, explanation, and description</a></li>
<li><a href="intro-linear-models.html#what-is-the-interpretation-of-a-regression-coefficient" id="toc-what-is-the-interpretation-of-a-regression-coefficient"><span class="toc-section-number">8.4</span> What is the interpretation of a regression coefficient?</a></li>
<li><a href="intro-linear-models.html#what-do-we-call-the-x-and-y-variables" id="toc-what-do-we-call-the-x-and-y-variables"><span class="toc-section-number">8.5</span> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li><a href="intro-linear-models.html#modeling-strategy" id="toc-modeling-strategy"><span class="toc-section-number">8.6</span> Modeling strategy</a></li>
<li><a href="intro-linear-models.html#predictions-from-the-model" id="toc-predictions-from-the-model"><span class="toc-section-number">8.7</span> Predictions from the model</a></li>
<li><a href="intro-linear-models.html#inference-from-the-model" id="toc-inference-from-the-model"><span class="toc-section-number">8.8</span> Inference from the model</a>
<ul>
<li><a href="intro-linear-models.html#assumptions-for-inference-with-a-statistical-model" id="toc-assumptions-for-inference-with-a-statistical-model"><span class="toc-section-number">8.8.1</span> Assumptions for inference with a statistical model</a></li>
<li><a href="intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model" id="toc-specific-assumptions-for-inference-with-a-linear-model"><span class="toc-section-number">8.8.2</span> Specific assumptions for inference with a linear model</a></li>
</ul></li>
<li><a href="intro-linear-models.html#linear-modelregression-model-or-statistical-model" id="toc-linear-modelregression-model-or-statistical-model"><span class="toc-section-number">8.9</span> “linear model,”regression model”, or “statistical model”?</a></li>
</ul></li>
<li><a href="regression.html#regression" id="toc-regression"><span class="toc-section-number">9</span> Linear models with a single, continuous <em>X</em> (“regression”)</a>
<ul>
<li><a href="regression.html#a-linear-model-with-a-single-continuous-x-is-classical-regression" id="toc-a-linear-model-with-a-single-continuous-x-is-classical-regression"><span class="toc-section-number">9.1</span> A linear model with a single, continuous <em>X</em> is classical “regression”</a>
<ul>
<li><a href="regression.html#analysis-of-green-down-data" id="toc-analysis-of-green-down-data"><span class="toc-section-number">9.1.1</span> Analysis of “green-down” data</a></li>
<li><a href="regression.html#learning-from-the-green-down-example" id="toc-learning-from-the-green-down-example"><span class="toc-section-number">9.1.2</span> Learning from the green-down example</a></li>
<li><a href="regression.html#using-a-regression-model-for-explanation-causal-models" id="toc-using-a-regression-model-for-explanation-causal-models"><span class="toc-section-number">9.1.3</span> Using a regression model for “explanation” – causal models</a></li>
<li><a href="regression.html#using-a-regression-model-for-prediction-prediction-models" id="toc-using-a-regression-model-for-prediction-prediction-models"><span class="toc-section-number">9.1.4</span> Using a regression model for prediction – prediction models</a></li>
<li><a href="regression.html#using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data" id="toc-using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data"><span class="toc-section-number">9.1.5</span> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</a></li>
<li><a href="regression.html#using-a-regression-model-for-for-calibration" id="toc-using-a-regression-model-for-for-calibration"><span class="toc-section-number">9.1.6</span> Using a regression model for for calibration</a></li>
</ul></li>
<li><a href="regression.html#working-in-r-1" id="toc-working-in-r-1"><span class="toc-section-number">9.2</span> Working in R</a>
<ul>
<li><a href="plotting-models.html#fit-the-model" id="toc-fit-the-model"><span class="toc-section-number">9.2.1</span> Fitting the linear model</a></li>
<li><a href="regression.html#getting-to-know-the-linear-model-the-summary-function" id="toc-getting-to-know-the-linear-model-the-summary-function"><span class="toc-section-number">9.2.2</span> Getting to know the linear model: the <code>summary</code> function</a></li>
<li><a href="regression.html#inference-the-coefficient-table" id="toc-inference-the-coefficient-table"><span class="toc-section-number">9.2.3</span> Inference – the coefficient table</a></li>
<li><a href="regression.html#how-good-is-our-model-model-checking" id="toc-how-good-is-our-model-model-checking"><span class="toc-section-number">9.2.4</span> How good is our model? – Model checking</a></li>
<li><a href="regression.html#plotting-models-with-continuous-x" id="toc-plotting-models-with-continuous-x"><span class="toc-section-number">9.2.5</span> Plotting models with continuous <em>X</em></a></li>
<li><a href="regression.html#creating-a-table-of-predicted-values-and-95-prediction-intervals" id="toc-creating-a-table-of-predicted-values-and-95-prediction-intervals"><span class="toc-section-number">9.2.6</span> Creating a table of predicted values and 95% prediction intervals</a></li>
</ul></li>
<li><a href="regression.html#hidden-code-1" id="toc-hidden-code-1"><span class="toc-section-number">9.3</span> Hidden code</a>
<ul>
<li><a href="regression.html#import-and-plot-of-fig2c-ecosystem-warming-experimental-data" id="toc-import-and-plot-of-fig2c-ecosystem-warming-experimental-data"><span class="toc-section-number">9.3.1</span> Import and plot of fig2c (ecosystem warming experimental) data</a></li>
<li><a href="regression.html#import-and-plot-efig_3d-ecosysem-warming-observational-data" id="toc-import-and-plot-efig_3d-ecosysem-warming-observational-data"><span class="toc-section-number">9.3.2</span> Import and plot efig_3d (Ecosysem warming observational) data</a></li>
<li><a href="regression.html#import-and-plot-of-fig1f-methionine-restriction-data" id="toc-import-and-plot-of-fig1f-methionine-restriction-data"><span class="toc-section-number">9.3.3</span> Import and plot of fig1f (methionine restriction) data</a></li>
</ul></li>
<li><a href="regression.html#try-it" id="toc-try-it"><span class="toc-section-number">9.4</span> Try it</a>
<ul>
<li><a href="regression.html#a-prediction-model-from-the-literature" id="toc-a-prediction-model-from-the-literature"><span class="toc-section-number">9.4.1</span> A prediction model from the literature</a></li>
</ul></li>
<li><a href="regression.html#intuition-pumps" id="toc-intuition-pumps"><span class="toc-section-number">9.5</span> Intuition pumps</a>
<ul>
<li><a href="regression.html#correlation-and-r2" id="toc-correlation-and-r2"><span class="toc-section-number">9.5.1</span> Correlation and $R^2</a></li>
</ul></li>
</ul></li>
<li><a href="oneway.html#oneway" id="toc-oneway"><span class="toc-section-number">10</span> Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</a>
<ul>
<li><a href="oneway.html#oneway-data" id="toc-oneway-data"><span class="toc-section-number">10.1</span> A linear model with a single, categorical <em>X</em> variable estimates the effects of the levels of <em>X</em> on the response</a>
<ul>
<li><a href="oneway.html#oneway-example1" id="toc-oneway-example1"><span class="toc-section-number">10.1.1</span> Example 1 (fig3d) – two treatment levels (“groups”)</a></li>
<li><a href="oneway.html#understanding-the-analysis-with-two-treatment-levels" id="toc-understanding-the-analysis-with-two-treatment-levels"><span class="toc-section-number">10.1.2</span> Understanding the analysis with two treatment levels</a></li>
<li><a href="oneway.html#oneway-example2" id="toc-oneway-example2"><span class="toc-section-number">10.1.3</span> Example 2 – three treatment levels (“groups”)</a></li>
<li><a href="oneway.html#understanding-the-analysis-with-three-or-more-treatment-levels" id="toc-understanding-the-analysis-with-three-or-more-treatment-levels"><span class="toc-section-number">10.1.4</span> Understanding the analysis with three (or more) treatment levels</a></li>
</ul></li>
<li><a href="oneway.html#working-in-r-2" id="toc-working-in-r-2"><span class="toc-section-number">10.2</span> Working in R</a>
<ul>
<li><a href="oneway.html#fit-the-model-1" id="toc-fit-the-model-1"><span class="toc-section-number">10.2.1</span> Fit the model</a></li>
<li><a href="oneway.html#controlling-the-output-in-tables-using-the-coefficient-table-as-an-example" id="toc-controlling-the-output-in-tables-using-the-coefficient-table-as-an-example"><span class="toc-section-number">10.2.2</span> Controlling the output in tables using the coefficient table as an example</a></li>
<li><a href="oneway.html#using-the-emmeans-function" id="toc-using-the-emmeans-function"><span class="toc-section-number">10.2.3</span> Using the emmeans function</a></li>
<li><a href="oneway.html#using-the-contrast-function" id="toc-using-the-contrast-function"><span class="toc-section-number">10.2.4</span> Using the contrast function</a></li>
<li><a href="oneway.html#how-to-generate-anova-tables" id="toc-how-to-generate-anova-tables"><span class="toc-section-number">10.2.5</span> How to generate ANOVA tables</a></li>
</ul></li>
<li><a href="oneway.html#hidden-code-2" id="toc-hidden-code-2"><span class="toc-section-number">10.3</span> Hidden Code</a>
<ul>
<li><a href="oneway.html#importing-and-wrangling-the-fig_3d-data-for-example-1" id="toc-importing-and-wrangling-the-fig_3d-data-for-example-1"><span class="toc-section-number">10.3.1</span> Importing and wrangling the fig_3d data for example 1</a></li>
<li><a href="oneway.html#importing-and-wrangling-the-fig2a-data-for-example-2" id="toc-importing-and-wrangling-the-fig2a-data-for-example-2"><span class="toc-section-number">10.3.2</span> Importing and wrangling the fig2a data for example 2</a></li>
</ul></li>
</ul></li>
<li><a href="model-checking.html#model-checking" id="toc-model-checking"><span class="toc-section-number">11</span> Model Checking</a>
<ul>
<li><a href="model-checking.html#check-check" id="toc-check-check"><span class="toc-section-number">11.1</span> All statistical analyses should be followed by model checking</a></li>
<li><a href="model-checking.html#linear-model-assumptions" id="toc-linear-model-assumptions"><span class="toc-section-number">11.2</span> Linear model assumptions</a>
<ul>
<li><a href="model-checking.html#a-bit-about-iid" id="toc-a-bit-about-iid"><span class="toc-section-number">11.2.1</span> A bit about IID</a></li>
</ul></li>
<li><a href="model-checking.html#diagnostic-plots-use-the-residuals-from-the-model-fit" id="toc-diagnostic-plots-use-the-residuals-from-the-model-fit"><span class="toc-section-number">11.3</span> Diagnostic plots use the residuals from the model fit</a>
<ul>
<li><a href="model-checking.html#residuals" id="toc-residuals"><span class="toc-section-number">11.3.1</span> Residuals</a></li>
<li><a href="model-checking.html#normal-qq" id="toc-normal-qq"><span class="toc-section-number">11.3.2</span> A Normal Q-Q plot is used to check for characteristic departures from Normality</a></li>
<li><a href="model-checking.html#mapping-qq-plot-departures-from-normality" id="toc-mapping-qq-plot-departures-from-normality"><span class="toc-section-number">11.3.3</span> Mapping QQ-plot departures from Normality</a></li>
<li><a href="model-checking.html#model-checking-spread-level" id="toc-model-checking-spread-level"><span class="toc-section-number">11.3.4</span> Model checking homoskedasticity</a></li>
</ul></li>
<li><a href="model-checking.html#using-r" id="toc-using-r"><span class="toc-section-number">11.4</span> Using R</a></li>
<li><a href="model-checking.html#hidden-code-3" id="toc-hidden-code-3"><span class="toc-section-number">11.5</span> Hidden Code</a>
<ul>
<li><a href="model-checking.html#normal-q-q-plots" id="toc-normal-q-q-plots"><span class="toc-section-number">11.5.1</span> Normal Q-Q plots</a></li>
</ul></li>
</ul></li>
<li><a href="violations.html#violations" id="toc-violations"><span class="toc-section-number">12</span> Violations of independence, homogeneity, or Normality</a>
<ul>
<li><a href="violations.html#oneway-paired-t" id="toc-oneway-paired-t"><span class="toc-section-number">12.1</span> Lack of independence</a>
<ul>
<li><a href="violations.html#violations-paired-t" id="toc-violations-paired-t"><span class="toc-section-number">12.1.1</span> Example 1 (exp1b) – a paired t-test is a special case of a linear mixed model</a></li>
<li><a href="violations.html#violations-rmanova" id="toc-violations-rmanova"><span class="toc-section-number">12.1.2</span> Example 2 (diHOME exp2a) – A repeated measures ANOVA is a special case of a linear mixed model</a></li>
</ul></li>
<li><a href="violations.html#oneway-welch" id="toc-oneway-welch"><span class="toc-section-number">12.2</span> Heterogeneity of variances</a>
<ul>
<li><a href="violations.html#when-groups-of-the-focal-test-have-variance" id="toc-when-groups-of-the-focal-test-have-variance"><span class="toc-section-number">12.2.1</span> When groups of the focal test have &gt;&gt; variance</a></li>
</ul></li>
<li><a href="violations.html#the-conditional-response-isnt-normal" id="toc-the-conditional-response-isnt-normal"><span class="toc-section-number">12.3</span> The conditional response isn’t Normal</a>
<ul>
<li><a href="violations.html#violations-6f" id="toc-violations-6f"><span class="toc-section-number">12.3.1</span> Example 1 (fig6f) – Linear models for non-normal count data</a></li>
<li><a href="violations.html#my-data-arent-normal-what-is-the-best-practice" id="toc-my-data-arent-normal-what-is-the-best-practice"><span class="toc-section-number">12.3.2</span> My data aren’t normal, what is the best practice?</a></li>
</ul></li>
<li><a href="violations.html#hidden-code-4" id="toc-hidden-code-4"><span class="toc-section-number">12.4</span> Hidden Code</a>
<ul>
<li><a href="violations.html#importing-and-wrangling-the-exp1b-data" id="toc-importing-and-wrangling-the-exp1b-data"><span class="toc-section-number">12.4.1</span> Importing and wrangling the exp1b data</a></li>
<li><a href="violations.html#importing-and-wrangling-the-exp2a-data" id="toc-importing-and-wrangling-the-exp2a-data"><span class="toc-section-number">12.4.2</span> Importing and wrangling the exp2a data</a></li>
<li><a href="violations.html#importing-and-wrangling-the-fig6f-data" id="toc-importing-and-wrangling-the-fig6f-data"><span class="toc-section-number">12.4.3</span> Importing and wrangling the fig6f data</a></li>
</ul></li>
</ul></li>
<li><a href="issues.html#issues" id="toc-issues"><span class="toc-section-number">13</span> Issues in inference</a>
<ul>
<li><a href="issues.html#replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means" id="toc-replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means"><span class="toc-section-number">13.1</span> Replicated experiments – include <span class="math inline">\(\texttt{Experiment}\)</span> as a random factor (better than one-way ANOVA of means)</a>
<ul>
<li><a href="issues.html#issues-exp4d" id="toc-issues-exp4d"><span class="toc-section-number">13.1.1</span> Multiple experiments Example 1 (wound healing Exp4d)</a></li>
<li><a href="issues.html#issues-combined-experiments" id="toc-issues-combined-experiments"><span class="toc-section-number">13.1.2</span> Models for combining replicated experiments</a></li>
<li><a href="issues.html#understanding-model-exp4d_m1" id="toc-understanding-model-exp4d_m1"><span class="toc-section-number">13.1.3</span> Understanding Model <code>exp4d_m1</code></a></li>
<li><a href="issues.html#the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2" id="toc-the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2"><span class="toc-section-number">13.1.4</span> The univariate model is equivalent to a linear mixed model of the aggregated data (Model exp4d_m2)</a></li>
<li><a href="issues.html#a-linear-mixed-model-of-the-full-data" id="toc-a-linear-mixed-model-of-the-full-data"><span class="toc-section-number">13.1.5</span> A linear mixed model of the full data</a></li>
<li><a href="issues.html#analysis-of-the-experiment-means-has-less-precision-and-power" id="toc-analysis-of-the-experiment-means-has-less-precision-and-power"><span class="toc-section-number">13.1.6</span> Analysis of the experiment means has less precision and power</a></li>
<li><a href="issues.html#dont-do-this-a-t-testfixed-effect-anova-of-the-full-data" id="toc-dont-do-this-a-t-testfixed-effect-anova-of-the-full-data"><span class="toc-section-number">13.1.7</span> Don’t do this – a t-test/fixed-effect ANOVA of the full data</a></li>
</ul></li>
<li><a href="issues.html#issues-pre-post" id="toc-issues-pre-post"><span class="toc-section-number">13.2</span> Comparing change from baseline (pre-post)</a>
<ul>
<li><a href="issues.html#pre-post-example-1-dpp4-fig4c" id="toc-pre-post-example-1-dpp4-fig4c"><span class="toc-section-number">13.2.1</span> Pre-post example 1 (DPP4 fig4c)</a></li>
<li><a href="issues.html#what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure" id="toc-what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure"><span class="toc-section-number">13.2.2</span> What if the data in example 1 were from from an experiment where the treatment was applied prior to the baseline measure?</a></li>
<li><a href="issues.html#pre-post-example-2-xx-males-fig1c" id="toc-pre-post-example-2-xx-males-fig1c"><span class="toc-section-number">13.2.3</span> Pre-post example 2 (XX males fig1c)</a></li>
<li><a href="issues.html#issues-regression-to-mean" id="toc-issues-regression-to-mean"><span class="toc-section-number">13.2.4</span> Regression to the mean</a></li>
</ul></li>
<li><a href="issues.html#longitudinal-designs-with-more-than-one-post-baseline-measure" id="toc-longitudinal-designs-with-more-than-one-post-baseline-measure"><span class="toc-section-number">13.3</span> Longitudinal designs with more than one-post baseline measure</a>
<ul>
<li><a href="issues.html#issues-auc" id="toc-issues-auc"><span class="toc-section-number">13.3.1</span> Area under the curve (AUC)</a></li>
</ul></li>
<li><a href="issues.html#normalization-the-analysis-of-ratios" id="toc-normalization-the-analysis-of-ratios"><span class="toc-section-number">13.4</span> Normalization – the analysis of ratios</a>
<ul>
<li><a href="issues.html#kinds-of-ratios-in-experimental-biology" id="toc-kinds-of-ratios-in-experimental-biology"><span class="toc-section-number">13.4.1</span> Kinds of ratios in experimental biology</a></li>
<li><a href="issues.html#issues-offset" id="toc-issues-offset"><span class="toc-section-number">13.4.2</span> Example 1 – The ratio is a density (number of something per area)</a></li>
<li><a href="issues.html#issues-size" id="toc-issues-size"><span class="toc-section-number">13.4.3</span> Example 2 – The ratio is normalizing for size differences</a></li>
</ul></li>
<li><a href="issues.html#dont-do-this-stuff" id="toc-dont-do-this-stuff"><span class="toc-section-number">13.5</span> Don’t do this stuff</a>
<ul>
<li><a href="issues.html#normalize-the-response-so-that-all-control-values-are-equal-to-1." id="toc-normalize-the-response-so-that-all-control-values-are-equal-to-1."><span class="toc-section-number">13.5.1</span> Normalize the response so that all control values are equal to 1.</a></li>
</ul></li>
<li><a href="issues.html#a-difference-in-significance-is-not-necessarily-significant" id="toc-a-difference-in-significance-is-not-necessarily-significant"><span class="toc-section-number">13.6</span> A difference in significance is not necessarily significant</a></li>
<li><a href="issues.html#researcher-degrees-of-freedom" id="toc-researcher-degrees-of-freedom"><span class="toc-section-number">13.7</span> Researcher degrees of freedom</a></li>
<li><a href="issues.html#hidden-code-5" id="toc-hidden-code-5"><span class="toc-section-number">13.8</span> Hidden code</a>
<ul>
<li><a href="issues.html#import-exp4d-vimentin-cell-count-data-replicate-experiments-example" id="toc-import-exp4d-vimentin-cell-count-data-replicate-experiments-example"><span class="toc-section-number">13.8.1</span> Import exp4d vimentin cell count data (replicate experiments example)</a></li>
<li><a href="issues.html#import-fig4c-data" id="toc-import-fig4c-data"><span class="toc-section-number">13.8.2</span> Import Fig4c data</a></li>
<li><a href="issues.html#xx-males-fig1c" id="toc-xx-males-fig1c"><span class="toc-section-number">13.8.3</span> XX males fig1c</a></li>
<li><a href="issues.html#generation-of-fake-data-to-illustrate-regression-to-the-mean" id="toc-generation-of-fake-data-to-illustrate-regression-to-the-mean"><span class="toc-section-number">13.8.4</span> Generation of fake data to illustrate regression to the mean</a></li>
<li><a href="issues.html#import-fig3f" id="toc-import-fig3f"><span class="toc-section-number">13.8.5</span> Import fig3f</a></li>
<li><a href="issues.html#issues-import-exp3b" id="toc-issues-import-exp3b"><span class="toc-section-number">13.8.6</span> Import exp3b</a></li>
<li><a href="issues.html#issues-exp3b-plot" id="toc-issues-exp3b-plot"><span class="toc-section-number">13.8.7</span> Plot the model of exp3b (glm offset data)</a></li>
</ul></li>
</ul></li>
<li><a href="part-v-more-than-one-x-multivariable-models.html#part-v-more-than-one-x-multivariable-models" id="toc-part-v-more-than-one-x-multivariable-models">Part V: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li><a href="covariates.html#covariates" id="toc-covariates"><span class="toc-section-number">14</span> Linear models with added covariates (“ANCOVA”)</a>
<ul>
<li><a href="covariates.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest" id="toc-adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><span class="toc-section-number">14.1</span> Adding covariates can increases the precision of the effect of interest</a></li>
<li><a href="covariates.html#understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data" id="toc-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data"><span class="toc-section-number">14.2</span> Understanding a linear model with an added covariate – heart necrosis data</a>
<ul>
<li><a href="covariates.html#fit-the-model-5" id="toc-fit-the-model-5"><span class="toc-section-number">14.2.1</span> Fit the model</a></li>
<li><a href="covariates.html#plot-the-model-2" id="toc-plot-the-model-2"><span class="toc-section-number">14.2.2</span> Plot the model</a></li>
<li><a href="covariates.html#interpretation-of-the-model-coefficients" id="toc-interpretation-of-the-model-coefficients"><span class="toc-section-number">14.2.3</span> Interpretation of the model coefficients</a></li>
<li><a href="covariates.html#everything-adds-up" id="toc-everything-adds-up"><span class="toc-section-number">14.2.4</span> Everything adds up</a></li>
<li><a href="covariates.html#interpretation-of-the-estimated-marginal-means" id="toc-interpretation-of-the-estimated-marginal-means"><span class="toc-section-number">14.2.5</span> Interpretation of the estimated marginal means</a></li>
<li><a href="covariates.html#interpretation-of-the-contrasts" id="toc-interpretation-of-the-contrasts"><span class="toc-section-number">14.2.6</span> Interpretation of the contrasts</a></li>
<li><a href="covariates.html#adding-the-covariate-improves-inference" id="toc-adding-the-covariate-improves-inference"><span class="toc-section-number">14.2.7</span> Adding the covariate improves inference</a></li>
</ul></li>
<li><a href="covariates.html#understanding-interaction-effects-with-covariates" id="toc-understanding-interaction-effects-with-covariates"><span class="toc-section-number">14.3</span> Understanding interaction effects with covariates</a>
<ul>
<li><a href="covariates.html#fit-the-model-6" id="toc-fit-the-model-6"><span class="toc-section-number">14.3.1</span> Fit the model</a></li>
<li><a href="covariates.html#plot-the-model-with-interaction-effect" id="toc-plot-the-model-with-interaction-effect"><span class="toc-section-number">14.3.2</span> Plot the model with interaction effect</a></li>
<li><a href="covariates.html#interpretation-of-the-model-coefficients-1" id="toc-interpretation-of-the-model-coefficients-1"><span class="toc-section-number">14.3.3</span> Interpretation of the model coefficients</a></li>
<li><a href="covariates.html#what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends." id="toc-what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends."><span class="toc-section-number">14.3.4</span> What is the effect of a treatment, if interactions are modeled? – it depends.</a></li>
<li><a href="covariates.html#which-model-do-we-use-mathcalm_1-or-mathcalm_2" id="toc-which-model-do-we-use-mathcalm_1-or-mathcalm_2"><span class="toc-section-number">14.3.5</span> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</a></li>
</ul></li>
<li><a href="covariates.html#understanding-ancova-tables" id="toc-understanding-ancova-tables"><span class="toc-section-number">14.4</span> Understanding ANCOVA tables</a></li>
<li><a href="covariates.html#working-in-r-3" id="toc-working-in-r-3"><span class="toc-section-number">14.5</span> Working in R</a>
<ul>
<li><a href="covariates.html#importing-the-heart-necrosis-data" id="toc-importing-the-heart-necrosis-data"><span class="toc-section-number">14.5.1</span> Importing the heart necrosis data</a></li>
<li><a href="covariates.html#fitting-the-model" id="toc-fitting-the-model"><span class="toc-section-number">14.5.2</span> Fitting the model</a></li>
<li><a href="covariates.html#using-the-emmeans-function-1" id="toc-using-the-emmeans-function-1"><span class="toc-section-number">14.5.3</span> Using the emmeans function</a></li>
<li><a href="covariates.html#ancova-tables" id="toc-ancova-tables"><span class="toc-section-number">14.5.4</span> ANCOVA tables</a></li>
<li><a href="covariates.html#plotting-the-model" id="toc-plotting-the-model"><span class="toc-section-number">14.5.5</span> Plotting the model</a></li>
</ul></li>
<li><a href="covariates.html#best-practices" id="toc-best-practices"><span class="toc-section-number">14.6</span> Best practices</a>
<ul>
<li><a href="covariates.html#do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate" id="toc-do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate"><span class="toc-section-number">14.6.1</span> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</a></li>
<li><a href="covariates.html#do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate" id="toc-do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate"><span class="toc-section-number">14.6.2</span> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</a></li>
<li><a href="covariates.html#do-not-test-for-balance-of-baseline-measures" id="toc-do-not-test-for-balance-of-baseline-measures"><span class="toc-section-number">14.6.3</span> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li><a href="covariates.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response" id="toc-best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><span class="toc-section-number">14.7</span> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li><a href="factorial.html#factorial" id="toc-factorial"><span class="toc-section-number">15</span> Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</a>
<ul>
<li><a href="factorial.html#a-linear-model-with-crossed-factors-estimates-interaction-effects" id="toc-a-linear-model-with-crossed-factors-estimates-interaction-effects"><span class="toc-section-number">15.1</span> A linear model with crossed factors estimates interaction effects</a>
<ul>
<li><a href="factorial.html#an-interaction-is-a-difference-in-simple-effects" id="toc-an-interaction-is-a-difference-in-simple-effects"><span class="toc-section-number">15.1.1</span> An interaction is a difference in simple effects</a></li>
<li><a href="factorial.html#a-linear-model-with-crossed-factors-includes-interaction-effects" id="toc-a-linear-model-with-crossed-factors-includes-interaction-effects"><span class="toc-section-number">15.1.2</span> A linear model with crossed factors includes interaction effects</a></li>
<li><a href="factorial.html#factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature" id="toc-factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature"><span class="toc-section-number">15.1.3</span> factorial experiments are frequently analyzed as flattened linear models in the experimental biology literature</a></li>
</ul></li>
<li><a href="factorial.html#example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data" id="toc-example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data"><span class="toc-section-number">15.2</span> Example 1 – Estimation of a treatment effect relative to a control effect (“Something different”) (Experiment 2j glucose uptake data)</a>
<ul>
<li><a href="factorial.html#twoway-understand1" id="toc-twoway-understand1"><span class="toc-section-number">15.2.1</span> Understand the experimental design</a></li>
<li><a href="factorial.html#fit-the-linear-model" id="toc-fit-the-linear-model"><span class="toc-section-number">15.2.2</span> Fit the linear model</a></li>
<li><a href="factorial.html#twoway-exp2j-inf" id="toc-twoway-exp2j-inf"><span class="toc-section-number">15.2.3</span> Inference</a></li>
<li><a href="factorial.html#plot-the-model-3" id="toc-plot-the-model-3"><span class="toc-section-number">15.2.4</span> Plot the model</a></li>
</ul></li>
<li><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-1" id="toc-understanding-the-linear-model-with-crossed-factors-1"><span class="toc-section-number">15.3</span> Understanding the linear model with crossed factors 1</a>
<ul>
<li><a href="factorial.html#twoway-what-coefs-are" id="toc-twoway-what-coefs-are"><span class="toc-section-number">15.3.1</span> What the coefficients are</a></li>
<li><a href="factorial.html#the-interaction-effect-is-something-different" id="toc-the-interaction-effect-is-something-different"><span class="toc-section-number">15.3.2</span> The interaction effect is something different</a></li>
<li><a href="factorial.html#why-we-want-to-compare-the-treatment-effect-to-a-control-effect" id="toc-why-we-want-to-compare-the-treatment-effect-to-a-control-effect"><span class="toc-section-number">15.3.3</span> Why we want to compare the treatment effect to a control effect</a></li>
<li><a href="factorial.html#the-order-of-the-factors-in-the-model-tells-the-same-story-differently" id="toc-the-order-of-the-factors-in-the-model-tells-the-same-story-differently"><span class="toc-section-number">15.3.4</span> The order of the factors in the model tells the same story differently</a></li>
<li><a href="factorial.html#power-for-the-interaction-effect-is-less-than-that-for-simple-effects" id="toc-power-for-the-interaction-effect-is-less-than-that-for-simple-effects"><span class="toc-section-number">15.3.5</span> Power for the interaction effect is less than that for simple effects</a></li>
<li><a href="factorial.html#planned-comparisons-vs.-post-hoc-tests" id="toc-planned-comparisons-vs.-post-hoc-tests"><span class="toc-section-number">15.3.6</span> Planned comparisons vs. post-hoc tests</a></li>
</ul></li>
<li><a href="factorial.html#example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data" id="toc-example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data"><span class="toc-section-number">15.4</span> Example 2: Estimation of the effect of background condition on an effect (“it depends”) (Experiment 3e lesian area data)</a>
<ul>
<li><a href="factorial.html#understand-the-experimental-design" id="toc-understand-the-experimental-design"><span class="toc-section-number">15.4.1</span> Understand the experimental design</a></li>
<li><a href="factorial.html#fit-the-linear-model-1" id="toc-fit-the-linear-model-1"><span class="toc-section-number">15.4.2</span> Fit the linear model</a></li>
<li><a href="factorial.html#check-the-model-1" id="toc-check-the-model-1"><span class="toc-section-number">15.4.3</span> Check the model</a></li>
<li><a href="factorial.html#inference-from-the-model-2" id="toc-inference-from-the-model-2"><span class="toc-section-number">15.4.4</span> Inference from the model</a></li>
<li><a href="factorial.html#plot-the-model-4" id="toc-plot-the-model-4"><span class="toc-section-number">15.4.5</span> Plot the model</a></li>
</ul></li>
<li><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-2" id="toc-understanding-the-linear-model-with-crossed-factors-2"><span class="toc-section-number">15.5</span> Understanding the linear model with crossed factors 2</a>
<ul>
<li><a href="factorial.html#twoway-marginal-means" id="toc-twoway-marginal-means"><span class="toc-section-number">15.5.1</span> Conditional and marginal means</a></li>
<li><a href="factorial.html#simple-conditional-effects" id="toc-simple-conditional-effects"><span class="toc-section-number">15.5.2</span> Simple (conditional) effects</a></li>
<li><a href="factorial.html#twoway-marginal-effects" id="toc-twoway-marginal-effects"><span class="toc-section-number">15.5.3</span> Marginal effects</a></li>
<li><a href="factorial.html#the-additive-model" id="toc-the-additive-model"><span class="toc-section-number">15.5.4</span> The additive model</a></li>
<li><a href="factorial.html#twoway-reduce" id="toc-twoway-reduce"><span class="toc-section-number">15.5.5</span> Reduce models for the right reason</a></li>
<li><a href="factorial.html#the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird" id="toc-the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird"><span class="toc-section-number">15.5.6</span> The marginal means of an additive linear model with two factors can be weird</a></li>
</ul></li>
<li><a href="factorial.html#example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data" id="toc-example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data"><span class="toc-section-number">15.6</span> Example 3: Estimation of synergy (“More than the sum of the parts”) (Experiment 1c JA data)</a>
<ul>
<li><a href="factorial.html#examine-the-data" id="toc-examine-the-data"><span class="toc-section-number">15.6.1</span> Examine the data</a></li>
<li><a href="factorial.html#fit-the-model-7" id="toc-fit-the-model-7"><span class="toc-section-number">15.6.2</span> Fit the model</a></li>
<li><a href="factorial.html#model-check" id="toc-model-check"><span class="toc-section-number">15.6.3</span> Model check</a></li>
<li><a href="factorial.html#inference-from-the-model-3" id="toc-inference-from-the-model-3"><span class="toc-section-number">15.6.4</span> Inference from the model</a></li>
<li><a href="factorial.html#plot-the-model-5" id="toc-plot-the-model-5"><span class="toc-section-number">15.6.5</span> Plot the model</a></li>
<li><a href="factorial.html#alternative-plot" id="toc-alternative-plot"><span class="toc-section-number">15.6.6</span> Alternative plot</a></li>
</ul></li>
<li><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-3" id="toc-understanding-the-linear-model-with-crossed-factors-3"><span class="toc-section-number">15.7</span> Understanding the linear model with crossed factors 3</a>
<ul>
<li><a href="factorial.html#thinking-about-the-coefficients-of-the-linear-model" id="toc-thinking-about-the-coefficients-of-the-linear-model"><span class="toc-section-number">15.7.1</span> Thinking about the coefficients of the linear model</a></li>
</ul></li>
<li><a href="factorial.html#issues-in-inference" id="toc-issues-in-inference"><span class="toc-section-number">15.8</span> Issues in inference</a>
<ul>
<li><a href="factorial.html#for-pairwise-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model" id="toc-for-pairwise-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><span class="toc-section-number">15.8.1</span> For pairwise contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li><a href="factorial.html#for-interaction-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model" id="toc-for-interaction-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><span class="toc-section-number">15.8.2</span> For interaction contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li><a href="factorial.html#twoway-multiple-tests" id="toc-twoway-multiple-tests"><span class="toc-section-number">15.8.3</span> Adjusting <em>p</em>-values for multiple tests</a></li>
</ul></li>
<li><a href="factorial.html#two-way-anova" id="toc-two-way-anova"><span class="toc-section-number">15.9</span> Two-way ANOVA</a>
<ul>
<li><a href="factorial.html#how-to-read-a-two-way-anova-table" id="toc-how-to-read-a-two-way-anova-table"><span class="toc-section-number">15.9.1</span> How to read a two-way ANOVA table</a></li>
<li><a href="factorial.html#what-do-the-main-effects-in-an-anova-table-mean" id="toc-what-do-the-main-effects-in-an-anova-table-mean"><span class="toc-section-number">15.9.2</span> What do the main effects in an ANOVA table mean?</a></li>
</ul></li>
<li><a href="factorial.html#more-issues-in-inference" id="toc-more-issues-in-inference"><span class="toc-section-number">15.10</span> More issues in inference</a>
<ul>
<li><a href="factorial.html#longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova" id="toc-longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova"><span class="toc-section-number">15.10.1</span> Longitudinal experiments – include Time as a random factor (better than repeated measures ANOVA)</a></li>
</ul></li>
<li><a href="factorial.html#working-in-r-4" id="toc-working-in-r-4"><span class="toc-section-number">15.11</span> Working in R</a>
<ul>
<li><a href="factorial.html#model-formula" id="toc-model-formula"><span class="toc-section-number">15.11.1</span> Model formula</a></li>
<li><a href="factorial.html#using-the-emmeans-function-2" id="toc-using-the-emmeans-function-2"><span class="toc-section-number">15.11.2</span> Using the emmeans function</a></li>
<li><a href="factorial.html#contrasts" id="toc-contrasts"><span class="toc-section-number">15.11.3</span> Contrasts</a></li>
<li><a href="factorial.html#practice-safe-anova" id="toc-practice-safe-anova"><span class="toc-section-number">15.11.4</span> Practice safe ANOVA</a></li>
<li><a href="factorial.html#better-to-avoid-these" id="toc-better-to-avoid-these"><span class="toc-section-number">15.11.5</span> Better to avoid these</a></li>
</ul></li>
<li><a href="factorial.html#hidden-code-6" id="toc-hidden-code-6"><span class="toc-section-number">15.12</span> Hidden Code</a>
<ul>
<li><a href="factorial.html#import-exp2j-example-1" id="toc-import-exp2j-example-1"><span class="toc-section-number">15.12.1</span> Import exp2j (Example 1)</a></li>
<li><a href="factorial.html#import-exp3e-lesian-area-data-example-2" id="toc-import-exp3e-lesian-area-data-example-2"><span class="toc-section-number">15.12.2</span> Import exp3e lesian area data (Example 2)</a></li>
<li><a href="factorial.html#import-exp1c-ja-data-example-3" id="toc-import-exp1c-ja-data-example-3"><span class="toc-section-number">15.12.3</span> Import Exp1c JA data (Example 3)</a></li>
</ul></li>
</ul></li>
<li><a href="part-vi-expanding-the-linear-model.html#part-vi-expanding-the-linear-model" id="toc-part-vi-expanding-the-linear-model">Part VI – Expanding the Linear Model</a></li>
<li><a href="lmm.html#lmm" id="toc-lmm"><span class="toc-section-number">16</span> Models with random factors – linear mixed models</a>
<ul>
<li><a href="lmm.html#lmm-demo" id="toc-lmm-demo"><span class="toc-section-number">16.1</span> Example 1 – A random intercepts and slopes explainer (demo1)</a>
<ul>
<li><a href="lmm.html#batched-measurements-result-in-clustered-residuals" id="toc-batched-measurements-result-in-clustered-residuals"><span class="toc-section-number">16.1.1</span> Batched measurements result in clustered residuals</a></li>
<li><a href="lmm.html#lmm-corerr" id="toc-lmm-corerr"><span class="toc-section-number">16.1.2</span> Clustered residuals result in correlated error</a></li>
<li><a href="lmm.html#in-blocked-designs-clustered-residuals-adds-a-variance-component-that-masks-treatment-effects" id="toc-in-blocked-designs-clustered-residuals-adds-a-variance-component-that-masks-treatment-effects"><span class="toc-section-number">16.1.3</span> In blocked designs, clustered residuals adds a variance component that masks treatment effects</a></li>
<li><a href="lmm.html#linear-mixed-models-are-linear-models-with-added-random-factors" id="toc-linear-mixed-models-are-linear-models-with-added-random-factors"><span class="toc-section-number">16.1.4</span> Linear mixed models are linear models with added random factors</a></li>
<li><a href="lmm.html#what-the-random-effects-are" id="toc-what-the-random-effects-are"><span class="toc-section-number">16.1.5</span> What the random effects are</a></li>
<li><a href="lmm.html#in-a-blocked-design-a-linear-model-with-added-random-effects-increases-precision-of-treatment-effects" id="toc-in-a-blocked-design-a-linear-model-with-added-random-effects-increases-precision-of-treatment-effects"><span class="toc-section-number">16.1.6</span> In a blocked design, a linear model with added random effects increases precision of treatment effects</a></li>
<li><a href="lmm.html#lmm-varcorr" id="toc-lmm-varcorr"><span class="toc-section-number">16.1.7</span> The correlation among random intercepts and slopes</a></li>
<li><a href="lmm.html#clustered-residuals-create-heterogeneity-among-treatments" id="toc-clustered-residuals-create-heterogeneity-among-treatments"><span class="toc-section-number">16.1.8</span> Clustered residuals create heterogeneity among treatments</a></li>
<li><a href="lmm.html#linear-mixed-models-are-flexible" id="toc-linear-mixed-models-are-flexible"><span class="toc-section-number">16.1.9</span> Linear mixed models are flexible</a></li>
<li><a href="lmm.html#a-random-intercept-only-model" id="toc-a-random-intercept-only-model"><span class="toc-section-number">16.1.10</span> A random intercept only model</a></li>
<li><a href="lmm.html#a-model-including-an-interaction-intercept" id="toc-a-model-including-an-interaction-intercept"><span class="toc-section-number">16.1.11</span> A model including an interaction intercept</a></li>
<li><a href="lmm.html#lmm-demo-aic" id="toc-lmm-demo-aic"><span class="toc-section-number">16.1.12</span> AIC and model selection – which model to report?</a></li>
<li><a href="lmm.html#the-specification-of-random-effects-matters" id="toc-the-specification-of-random-effects-matters"><span class="toc-section-number">16.1.13</span> The specification of random effects matters</a></li>
<li><a href="lmm.html#mixed-effect-and-repeated-measures-anova" id="toc-mixed-effect-and-repeated-measures-anova"><span class="toc-section-number">16.1.14</span> Mixed Effect and Repeated Measures ANOVA</a></li>
<li><a href="lmm.html#pseudoreplication" id="toc-pseudoreplication"><span class="toc-section-number">16.1.15</span> Pseudoreplication</a></li>
</ul></li>
<li><a href="lmm.html#lmm-example2" id="toc-lmm-example2"><span class="toc-section-number">16.2</span> Example 2 – experiments without subsampling replication (exp6g)</a>
<ul>
<li><a href="lmm.html#understand-the-data" id="toc-understand-the-data"><span class="toc-section-number">16.2.1</span> Understand the data</a></li>
<li><a href="lmm.html#model-fit-and-inference" id="toc-model-fit-and-inference"><span class="toc-section-number">16.2.2</span> Model fit and inference</a></li>
<li><a href="lmm.html#the-model-exp6g_m1-adds-a-random-intercept-but-not-a-random-slope" id="toc-the-model-exp6g_m1-adds-a-random-intercept-but-not-a-random-slope"><span class="toc-section-number">16.2.3</span> The model exp6g_m1 adds a random intercept but not a random slope</a></li>
<li><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp6g_m1" id="toc-the-fixed-effect-coefficients-of-model-exp6g_m1"><span class="toc-section-number">16.2.4</span> The fixed effect coefficients of model exp6g_m1</a></li>
<li><a href="lmm.html#the-random-intercept-coefficients-of-exp6g_m1" id="toc-the-random-intercept-coefficients-of-exp6g_m1"><span class="toc-section-number">16.2.5</span> The random intercept coefficients of exp6g_m1</a></li>
<li><a href="lmm.html#the-random-and-residual-variance-and-the-intraclass-correlation-of-model-exp6g_m1" id="toc-the-random-and-residual-variance-and-the-intraclass-correlation-of-model-exp6g_m1"><span class="toc-section-number">16.2.6</span> The random and residual variance and the intraclass correlation of model exp6g_m1</a></li>
<li><a href="lmm.html#the-linear-mixed-model-exp6g_m1-increases-precision-of-treatment-effects-relative-to-a-fixed-effects-model" id="toc-the-linear-mixed-model-exp6g_m1-increases-precision-of-treatment-effects-relative-to-a-fixed-effects-model"><span class="toc-section-number">16.2.7</span> The linear mixed model exp6g_m1 increases precision of treatment effects, relative to a fixed effects model</a></li>
<li><a href="lmm.html#lmm-exp6g-alt" id="toc-lmm-exp6g-alt"><span class="toc-section-number">16.2.8</span> Alternative models for exp6g</a></li>
<li><a href="lmm.html#paired-t-tests-and-repeated-measures-anova-are-special-cases-of-linear-mixed-models" id="toc-paired-t-tests-and-repeated-measures-anova-are-special-cases-of-linear-mixed-models"><span class="toc-section-number">16.2.9</span> Paired t-tests and repeated measures ANOVA are special cases of linear mixed models</a></li>
<li><a href="lmm.html#lmm-exp6g-rmanova" id="toc-lmm-exp6g-rmanova"><span class="toc-section-number">16.2.10</span> Classical (“univariate model”) repeated measures ANOVA of exp6g</a></li>
<li><a href="lmm.html#lmm-exp6g-rmanova-multi" id="toc-lmm-exp6g-rmanova-multi"><span class="toc-section-number">16.2.11</span> “Multivariate model” repeated measures ANOVA</a></li>
<li><a href="lmm.html#linear-mixed-models-vs-repeated-measures-anova" id="toc-linear-mixed-models-vs-repeated-measures-anova"><span class="toc-section-number">16.2.12</span> Linear mixed models vs repeated measures ANOVA</a></li>
<li><a href="lmm.html#modeling-textttmouse_id-as-a-fixed-effect" id="toc-modeling-textttmouse_id-as-a-fixed-effect"><span class="toc-section-number">16.2.13</span> Modeling <span class="math inline">\(\texttt{mouse_id}\)</span> as a fixed effect</a></li>
</ul></li>
<li><a href="lmm.html#example-3-factorial-experiments-and-no-subsampling-replicates-exp5c" id="toc-example-3-factorial-experiments-and-no-subsampling-replicates-exp5c"><span class="toc-section-number">16.3</span> Example 3 – Factorial experiments and no subsampling replicates (exp5c)</a>
<ul>
<li><a href="lmm.html#understand-the-data-1" id="toc-understand-the-data-1"><span class="toc-section-number">16.3.1</span> Understand the data</a></li>
<li><a href="lmm.html#examine-the-data-1" id="toc-examine-the-data-1"><span class="toc-section-number">16.3.2</span> Examine the data</a></li>
<li><a href="lmm.html#lmm-exp5c-m1" id="toc-lmm-exp5c-m1"><span class="toc-section-number">16.3.3</span> Model fit and inference</a></li>
<li><a href="lmm.html#why-we-care-about-modeling-batch-in-exp5c" id="toc-why-we-care-about-modeling-batch-in-exp5c"><span class="toc-section-number">16.3.4</span> Why we care about modeling batch in exp5c</a></li>
<li><a href="lmm.html#the-linear-mixed-model-exp5c_m1-adds-two-random-intercepts" id="toc-the-linear-mixed-model-exp5c_m1-adds-two-random-intercepts"><span class="toc-section-number">16.3.5</span> The linear mixed model exp5c_m1 adds two random intercepts</a></li>
<li><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp5c_m1" id="toc-the-fixed-effect-coefficients-of-model-exp5c_m1"><span class="toc-section-number">16.3.6</span> The fixed effect coefficients of model exp5c_m1</a></li>
<li><a href="lmm.html#the-random-effect-coefficients-of-model-exp5c_m1" id="toc-the-random-effect-coefficients-of-model-exp5c_m1"><span class="toc-section-number">16.3.7</span> The random effect coefficients of model exp5c_m1</a></li>
<li><a href="lmm.html#lmm-exp5c-alt" id="toc-lmm-exp5c-alt"><span class="toc-section-number">16.3.8</span> Alternative models for exp5c</a></li>
<li><a href="lmm.html#lmm-rmanova-5c" id="toc-lmm-rmanova-5c"><span class="toc-section-number">16.3.9</span> Classical (“univariate model”) repeated measures ANOVA</a></li>
<li><a href="lmm.html#lmm-rmanova-5c-multi" id="toc-lmm-rmanova-5c-multi"><span class="toc-section-number">16.3.10</span> “Multivariate model” repeated measures ANOVA of exp5c</a></li>
<li><a href="lmm.html#modeling-textttdonor-as-a-fixed-effect" id="toc-modeling-textttdonor-as-a-fixed-effect"><span class="toc-section-number">16.3.11</span> Modeling <span class="math inline">\(\texttt{donor}\)</span> as a fixed effect</a></li>
</ul></li>
<li><a href="lmm.html#lmm-example4" id="toc-lmm-example4"><span class="toc-section-number">16.4</span> Example 4 – Experiments with subsampling replication (exp1g)</a>
<ul>
<li><a href="lmm.html#understand-the-data-2" id="toc-understand-the-data-2"><span class="toc-section-number">16.4.1</span> Understand the data</a></li>
<li><a href="lmm.html#examine-the-data-2" id="toc-examine-the-data-2"><span class="toc-section-number">16.4.2</span> Examine the data</a></li>
<li><a href="lmm.html#fit-the-model-9" id="toc-fit-the-model-9"><span class="toc-section-number">16.4.3</span> Fit the model</a></li>
<li><a href="lmm.html#inference-from-the-model-6" id="toc-inference-from-the-model-6"><span class="toc-section-number">16.4.4</span> Inference from the model</a></li>
<li><a href="lmm.html#plot-the-model-6" id="toc-plot-the-model-6"><span class="toc-section-number">16.4.5</span> Plot the model</a></li>
<li><a href="lmm.html#alternaplot-the-model-2" id="toc-alternaplot-the-model-2"><span class="toc-section-number">16.4.6</span> Alternaplot the model</a></li>
<li><a href="lmm.html#understanding-the-alternative-models" id="toc-understanding-the-alternative-models"><span class="toc-section-number">16.4.7</span> Understanding the alternative models</a></li>
<li><a href="lmm.html#the-varcorr-matrix-of-models-exp1g_m1a-and-exp1g_m1b" id="toc-the-varcorr-matrix-of-models-exp1g_m1a-and-exp1g_m1b"><span class="toc-section-number">16.4.8</span> The VarCorr matrix of models exp1g_m1a and exp1g_m1b</a></li>
<li><a href="lmm.html#the-linear-mixed-model-has-more-precision-and-power-than-the-fixed-effect-model-of-batch-means" id="toc-the-linear-mixed-model-has-more-precision-and-power-than-the-fixed-effect-model-of-batch-means"><span class="toc-section-number">16.4.9</span> The linear mixed model has more precision and power than the fixed effect model of batch means</a></li>
<li><a href="lmm.html#fixed-effect-models-and-pseudoreplication" id="toc-fixed-effect-models-and-pseudoreplication"><span class="toc-section-number">16.4.10</span> Fixed effect models and pseudoreplication</a></li>
<li><a href="lmm.html#mixed-effect-anova" id="toc-mixed-effect-anova"><span class="toc-section-number">16.4.11</span> Mixed-effect ANOVA</a></li>
</ul></li>
<li><a href="lmm.html#working-in-r-5" id="toc-working-in-r-5"><span class="toc-section-number">16.5</span> Working in R</a>
<ul>
<li><a href="lmm.html#fitting-linear-mixed-models" id="toc-fitting-linear-mixed-models"><span class="toc-section-number">16.5.1</span> Fitting linear mixed models</a></li>
<li><a href="lmm.html#plotting-models-fit-to-batched-data" id="toc-plotting-models-fit-to-batched-data"><span class="toc-section-number">16.5.2</span> Plotting models fit to batched data</a></li>
<li><a href="lmm.html#repeated-measures-anova-randomized-complete-block-with-no-subsampling" id="toc-repeated-measures-anova-randomized-complete-block-with-no-subsampling"><span class="toc-section-number">16.5.3</span> Repeated measures ANOVA (randomized complete block with no subsampling)</a></li>
</ul></li>
<li><a href="lmm.html#hidden-code-7" id="toc-hidden-code-7"><span class="toc-section-number">16.6</span> Hidden code</a>
<ul>
<li><a href="lmm.html#import-exp5c" id="toc-import-exp5c"><span class="toc-section-number">16.6.1</span> Import exp5c</a></li>
<li><a href="lmm.html#import-exp1g" id="toc-import-exp1g"><span class="toc-section-number">16.6.2</span> Import exp1g</a></li>
</ul></li>
</ul></li>
<li><a href="pre-post.html#pre-post" id="toc-pre-post"><span class="toc-section-number">17</span> Linear models for longitudinal experiments – I. pre-post designs</a>
<ul>
<li><a href="pre-post.html#best-practice-models" id="toc-best-practice-models"><span class="toc-section-number">17.1</span> Best practice models</a></li>
<li><a href="pre-post.html#common-alternatives-that-are-not-recommended" id="toc-common-alternatives-that-are-not-recommended"><span class="toc-section-number">17.2</span> Common alternatives that are not recommended</a></li>
<li><a href="pre-post.html#advanced-models" id="toc-advanced-models"><span class="toc-section-number">17.3</span> Advanced models</a></li>
<li><a href="pre-post.html#understanding-the-alternative-models-1" id="toc-understanding-the-alternative-models-1"><span class="toc-section-number">17.4</span> Understanding the alternative models</a>
<ul>
<li><a href="pre-post.html#m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model" id="toc-m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model"><span class="toc-section-number">17.4.1</span> (M1) Linear model with the baseline measure as the covariate (ANCOVA model)</a></li>
<li><a href="pre-post.html#m2-linear-model-of-the-change-score-change-score-model" id="toc-m2-linear-model-of-the-change-score-change-score-model"><span class="toc-section-number">17.4.2</span> (M2) Linear model of the change score (change-score model)</a></li>
<li><a href="pre-post.html#m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model" id="toc-m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model"><span class="toc-section-number">17.4.3</span> (M3) Linear model of post-baseline values without the baseline as a covariate (post model)</a></li>
<li><a href="pre-post.html#m4-linear-model-with-factorial-fixed-effects-fixed-effects-model" id="toc-m4-linear-model-with-factorial-fixed-effects-fixed-effects-model"><span class="toc-section-number">17.4.4</span> (M4) Linear model with factorial fixed effects (fixed-effects model)</a></li>
<li><a href="pre-post.html#m5-repeated-measures-anova" id="toc-m5-repeated-measures-anova"><span class="toc-section-number">17.4.5</span> (M5) Repeated measures ANOVA</a></li>
<li><a href="pre-post.html#m6-linear-mixed-model" id="toc-m6-linear-mixed-model"><span class="toc-section-number">17.4.6</span> (M6) Linear mixed model</a></li>
<li><a href="pre-post.html#m7-linear-model-with-correlated-error" id="toc-m7-linear-model-with-correlated-error"><span class="toc-section-number">17.4.7</span> (M7) Linear model with correlated error</a></li>
<li><a href="pre-post.html#m8-constrained-fixed-effects-model-with-correlated-error-clda-model" id="toc-m8-constrained-fixed-effects-model-with-correlated-error-clda-model"><span class="toc-section-number">17.4.8</span> (M8) Constrained fixed effects model with correlated error (cLDA model)</a></li>
<li><a href="pre-post.html#comparison-table" id="toc-comparison-table"><span class="toc-section-number">17.4.9</span> Comparison table</a></li>
</ul></li>
<li><a href="pre-post.html#example-1-a-single-post-baseline-measure-pre-post-design" id="toc-example-1-a-single-post-baseline-measure-pre-post-design"><span class="toc-section-number">17.5</span> Example 1 – a single post-baseline measure (pre-post design)</a></li>
<li><a href="pre-post.html#working-in-r-6" id="toc-working-in-r-6"><span class="toc-section-number">17.6</span> Working in R</a></li>
<li><a href="pre-post.html#hidden-code-8" id="toc-hidden-code-8"><span class="toc-section-number">17.7</span> Hidden code</a>
<ul>
<li><a href="pre-post.html#import-and-wrangle-mouse-sociability-data" id="toc-import-and-wrangle-mouse-sociability-data"><span class="toc-section-number">17.7.1</span> Import and wrangle mouse sociability data</a></li>
</ul></li>
</ul></li>
<li><a href="counts.html#counts" id="toc-counts"><span class="toc-section-number">18</span> Linear models for counts, binary responses, skewed responses, and ratios – Generalized Linear Models</a>
<ul>
<li><a href="counts.html#glm-counts" id="toc-glm-counts"><span class="toc-section-number">18.1</span> Introducing Generalized Linear Models using count data examples</a>
<ul>
<li><a href="counts.html#the-generalized-linear-model-glm" id="toc-the-generalized-linear-model-glm"><span class="toc-section-number">18.1.1</span> The Generalized Linear Model (GLM)</a></li>
<li><a href="counts.html#kinds-of-data-that-are-modeled-by-a-glm" id="toc-kinds-of-data-that-are-modeled-by-a-glm"><span class="toc-section-number">18.1.2</span> Kinds of data that are modeled by a GLM</a></li>
</ul></li>
<li><a href="counts.html#glm-1" id="toc-glm-1"><span class="toc-section-number">18.2</span> Example 1 – GLM models for count responses (“angiogenic sprouts” exp3a)</a>
<ul>
<li><a href="counts.html#understand-the-data-3" id="toc-understand-the-data-3"><span class="toc-section-number">18.2.1</span> Understand the data</a></li>
<li><a href="counts.html#model-fit-and-inference-1" id="toc-model-fit-and-inference-1"><span class="toc-section-number">18.2.2</span> Model fit and inference</a></li>
</ul></li>
<li><a href="counts.html#understanding-example-1" id="toc-understanding-example-1"><span class="toc-section-number">18.3</span> Understanding Example 1</a>
<ul>
<li><a href="counts.html#modeling-strategy-1" id="toc-modeling-strategy-1"><span class="toc-section-number">18.3.1</span> Modeling strategy</a></li>
<li><a href="counts.html#model-checking-fits-to-count-data" id="toc-model-checking-fits-to-count-data"><span class="toc-section-number">18.3.2</span> Model checking fits to count data</a></li>
<li><a href="counts.html#biological-count-data-are-rarely-fit-well-by-a-poisson-glm.-instead-fit-a-quasi-poisson-or-negative-binomial-glm-model." id="toc-biological-count-data-are-rarely-fit-well-by-a-poisson-glm.-instead-fit-a-quasi-poisson-or-negative-binomial-glm-model."><span class="toc-section-number">18.3.3</span> Biological count data are rarely fit well by a Poisson GLM. Instead, fit a quasi-poisson or negative binomial GLM model.</a></li>
<li><a href="counts.html#a-glm-is-a-linear-model-on-the-link-scale" id="toc-a-glm-is-a-linear-model-on-the-link-scale"><span class="toc-section-number">18.3.4</span> A GLM is a linear model on the link scale</a></li>
<li><a href="counts.html#coeffecients-of-a-generalized-linear-model-with-a-log-link-function-are-on-the-link-scale." id="toc-coeffecients-of-a-generalized-linear-model-with-a-log-link-function-are-on-the-link-scale."><span class="toc-section-number">18.3.5</span> Coeffecients of a Generalized Linear Model with a log-link function are on the link scale.</a></li>
<li><a href="counts.html#modeled-means-in-the-emmeans-table-of-a-generalized-linear-model-can-be-on-the-link-scale-or-response-scale-report-the-response-scale" id="toc-modeled-means-in-the-emmeans-table-of-a-generalized-linear-model-can-be-on-the-link-scale-or-response-scale-report-the-response-scale"><span class="toc-section-number">18.3.6</span> Modeled means in the emmeans table of a Generalized Linear Model can be on the link scale or response scale – Report the response scale</a></li>
<li><a href="counts.html#some-consequences-of-fitting-a-linear-model-to-count-data" id="toc-some-consequences-of-fitting-a-linear-model-to-count-data"><span class="toc-section-number">18.3.7</span> Some consequences of fitting a linear model to count data</a></li>
</ul></li>
<li><a href="counts.html#example-2-use-a-glm-with-an-offset-instead-of-a-ratio-of-some-measurement-per-area-dna-damage-data-exp3b" id="toc-example-2-use-a-glm-with-an-offset-instead-of-a-ratio-of-some-measurement-per-area-dna-damage-data-exp3b"><span class="toc-section-number">18.4</span> Example 2 – Use a GLM with an offset instead of a ratio of some measurement per area (“dna damage” data exp3b)</a>
<ul>
<li><a href="counts.html#exp3b-dna-damage-data" id="toc-exp3b-dna-damage-data"><span class="toc-section-number">18.4.1</span> exp3b (“dna damage”) data</a></li>
<li><a href="counts.html#understand-the-data-4" id="toc-understand-the-data-4"><span class="toc-section-number">18.4.2</span> Understand the data</a></li>
<li><a href="counts.html#model-fit-and-inference-2" id="toc-model-fit-and-inference-2"><span class="toc-section-number">18.4.3</span> Model fit and inference</a></li>
</ul></li>
<li><a href="counts.html#understanding-example-2" id="toc-understanding-example-2"><span class="toc-section-number">18.5</span> Understanding Example 2</a>
<ul>
<li><a href="counts.html#an-offset-is-an-added-covariate-with-a-coefficient-fixed-at-1" id="toc-an-offset-is-an-added-covariate-with-a-coefficient-fixed-at-1"><span class="toc-section-number">18.5.1</span> An offset is an added covariate with a coefficient fixed at 1</a></li>
<li><a href="counts.html#glm-rate" id="toc-glm-rate"><span class="toc-section-number">18.5.2</span> A count GLM with an offset models the area-normalized means</a></li>
<li><a href="counts.html#compare-an-offset-to-an-added-covariate-with-an-estimated-coefficient" id="toc-compare-an-offset-to-an-added-covariate-with-an-estimated-coefficient"><span class="toc-section-number">18.5.3</span> Compare an offset to an added covariate with an estimated coefficient</a></li>
<li><a href="counts.html#issues-with-plotting" id="toc-issues-with-plotting"><span class="toc-section-number">18.5.4</span> Issues with plotting</a></li>
</ul></li>
<li><a href="counts.html#example-3-glm-models-for-binary-responses" id="toc-example-3-glm-models-for-binary-responses"><span class="toc-section-number">18.6</span> Example 3 – GLM models for binary responses</a></li>
<li><a href="counts.html#working-in-r-7" id="toc-working-in-r-7"><span class="toc-section-number">18.7</span> Working in R</a>
<ul>
<li><a href="counts.html#fitting-glms-to-count-data" id="toc-fitting-glms-to-count-data"><span class="toc-section-number">18.7.1</span> Fitting GLMs to count data</a></li>
<li><a href="counts.html#fitting-a-glm-to-a-continuous-conditional-response-with-right-skew." id="toc-fitting-a-glm-to-a-continuous-conditional-response-with-right-skew."><span class="toc-section-number">18.7.2</span> Fitting a GLM to a continuous conditional response with right skew.</a></li>
<li><a href="counts.html#fitting-a-glm-to-a-binary-success-or-failure-presence-or-absence-survived-or-died-response" id="toc-fitting-a-glm-to-a-binary-success-or-failure-presence-or-absence-survived-or-died-response"><span class="toc-section-number">18.7.3</span> Fitting a GLM to a binary (success or failure, presence or absence, survived or died) response</a></li>
<li><a href="counts.html#fitting-generalized-linear-mixed-models" id="toc-fitting-generalized-linear-mixed-models"><span class="toc-section-number">18.7.4</span> Fitting Generalized Linear Mixed Models</a></li>
</ul></li>
<li><a href="counts.html#model-checking-glms" id="toc-model-checking-glms"><span class="toc-section-number">18.8</span> Model checking GLMs</a></li>
<li><a href="counts.html#hidden-code-9" id="toc-hidden-code-9"><span class="toc-section-number">18.9</span> Hidden code</a>
<ul>
<li><a href="counts.html#import-example-1-data-exp3a-angiogenic-sprouts" id="toc-import-example-1-data-exp3a-angiogenic-sprouts"><span class="toc-section-number">18.9.1</span> Import Example 1 data (exp3a – “angiogenic sprouts”)</a></li>
</ul></li>
</ul></li>
<li><a href="gls.html#gls" id="toc-gls"><span class="toc-section-number">19</span> Linear models with heterogenous variance</a></li>
<li><a href="appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models.html#appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models" id="toc-appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models">Appendix: An example set of analyses of experimental data with linear models</a></li>
<li><a href="ask1-bio.html#ask1-bio" id="toc-ask1-bio"><span class="toc-section-number">20</span> Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li><a href="ask1-report.html#ask1-report" id="toc-ask1-report"><span class="toc-section-number">21</span> Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a>
<ul>
<li><a href="ask1-report.html#setup" id="toc-setup"><span class="toc-section-number">21.1</span> Setup</a></li>
<li><a href="ask1-report.html#data-source" id="toc-data-source"><span class="toc-section-number">21.2</span> Data source</a></li>
<li><a href="ask1-report.html#control-the-color-palette" id="toc-control-the-color-palette"><span class="toc-section-number">21.3</span> control the color palette</a></li>
<li><a href="ask1-report.html#useful-functions" id="toc-useful-functions"><span class="toc-section-number">21.4</span> useful functions</a></li>
<li><a href="ask1-report.html#figure-2b-effect-of-ask1-deletion-on-growth-body-weight" id="toc-figure-2b-effect-of-ask1-deletion-on-growth-body-weight"><span class="toc-section-number">21.5</span> figure 2b – effect of ASK1 deletion on growth (body weight)</a>
<ul>
<li><a href="ask1-report.html#figure-2b-import" id="toc-figure-2b-import"><span class="toc-section-number">21.5.1</span> figure 2b – import</a></li>
<li><a href="ask1-report.html#figure-2b-exploratory-plots" id="toc-figure-2b-exploratory-plots"><span class="toc-section-number">21.5.2</span> figure 2b – exploratory plots</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2c-effect-of-ask1-deletion-on-final-body-weight" id="toc-figure-2c-effect-of-ask1-deletion-on-final-body-weight"><span class="toc-section-number">21.6</span> Figure 2c – Effect of ASK1 deletion on final body weight</a>
<ul>
<li><a href="ask1-report.html#figure-2c-import" id="toc-figure-2c-import"><span class="toc-section-number">21.6.1</span> Figure 2c – import</a></li>
<li><a href="ask1-report.html#figure-2c-check-own-computation-of-weight-change-v-imported-value" id="toc-figure-2c-check-own-computation-of-weight-change-v-imported-value"><span class="toc-section-number">21.6.2</span> Figure 2c – check own computation of weight change v imported value</a></li>
<li><a href="ask1-report.html#figure-2c-exploratory-plots" id="toc-figure-2c-exploratory-plots"><span class="toc-section-number">21.6.3</span> Figure 2c – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2c-fit-the-model-m1-lm" id="toc-figure-2c-fit-the-model-m1-lm"><span class="toc-section-number">21.6.4</span> Figure 2c – fit the model: m1 (lm)</a></li>
<li><a href="ask1-report.html#figure-2c-check-the-model-m1" id="toc-figure-2c-check-the-model-m1"><span class="toc-section-number">21.6.5</span> Figure 2c – check the model: m1</a></li>
<li><a href="ask1-report.html#figure-2c-fit-the-model-m2-gamma-glm" id="toc-figure-2c-fit-the-model-m2-gamma-glm"><span class="toc-section-number">21.6.6</span> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li><a href="ask1-report.html#figure-2c-check-the-model-m2" id="toc-figure-2c-check-the-model-m2"><span class="toc-section-number">21.6.7</span> Figure 2c – check the model, m2</a></li>
<li><a href="ask1-report.html#figure-2c-inference-from-the-model" id="toc-figure-2c-inference-from-the-model"><span class="toc-section-number">21.6.8</span> Figure 2c – inference from the model</a></li>
<li><a href="ask1-report.html#figure-2c-plot-the-model" id="toc-figure-2c-plot-the-model"><span class="toc-section-number">21.6.9</span> Figure 2c – plot the model</a></li>
<li><a href="ask1-report.html#figure-2c-report" id="toc-figure-2c-report"><span class="toc-section-number">21.6.10</span> Figure 2c – report</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve" id="toc-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><span class="toc-section-number">21.7</span> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a>
<ul>
<li><a href="ask1-report.html#figure-2d-import" id="toc-figure-2d-import"><span class="toc-section-number">21.7.1</span> Figure 2d – Import</a></li>
<li><a href="ask1-report.html#figure-2d-exploratory-plots" id="toc-figure-2d-exploratory-plots"><span class="toc-section-number">21.7.2</span> Figure 2d – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2d-fit-the-model" id="toc-figure-2d-fit-the-model"><span class="toc-section-number">21.7.3</span> Figure 2d – fit the model</a></li>
<li><a href="ask1-report.html#figure-2d-check-the-model" id="toc-figure-2d-check-the-model"><span class="toc-section-number">21.7.4</span> Figure 2d – check the model</a></li>
<li><a href="ask1-report.html#figure-2d-inference" id="toc-figure-2d-inference"><span class="toc-section-number">21.7.5</span> Figure 2d – inference</a></li>
<li><a href="ask1-report.html#figure-2d-plot-the-model" id="toc-figure-2d-plot-the-model"><span class="toc-section-number">21.7.6</span> Figure 2d – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure" id="toc-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure"><span class="toc-section-number">21.8</span> Figure 2e – Effect of ASK1 deletion on glucose tolerance (summary measure)</a>
<ul>
<li><a href="ask1-report.html#figure-2e-message-the-data" id="toc-figure-2e-message-the-data"><span class="toc-section-number">21.8.1</span> Figure 2e – message the data</a></li>
<li><a href="ask1-report.html#figure-2e-exploratory-plots" id="toc-figure-2e-exploratory-plots"><span class="toc-section-number">21.8.2</span> Figure 2e – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2e-fit-the-model" id="toc-figure-2e-fit-the-model"><span class="toc-section-number">21.8.3</span> Figure 2e – fit the model</a></li>
<li><a href="ask1-report.html#figure-2e-check-the-model" id="toc-figure-2e-check-the-model"><span class="toc-section-number">21.8.4</span> Figure 2e – check the model</a></li>
<li><a href="ask1-report.html#figure-2e-inference-from-the-model" id="toc-figure-2e-inference-from-the-model"><span class="toc-section-number">21.8.5</span> Figure 2e – inference from the model</a></li>
<li><a href="ask1-report.html#figure-2e-plot-the-model" id="toc-figure-2e-plot-the-model"><span class="toc-section-number">21.8.6</span> Figure 2e – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate" id="toc-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate"><span class="toc-section-number">21.9</span> Figure 2f – Effect of ASK1 deletion on glucose infusion rate</a>
<ul>
<li><a href="ask1-report.html#figure-2f-import" id="toc-figure-2f-import"><span class="toc-section-number">21.9.1</span> Figure 2f – import</a></li>
<li><a href="ask1-report.html#figure-2f-exploratory-plots" id="toc-figure-2f-exploratory-plots"><span class="toc-section-number">21.9.2</span> Figure 2f – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2f-fit-the-model" id="toc-figure-2f-fit-the-model"><span class="toc-section-number">21.9.3</span> Figure 2f – fit the model</a></li>
<li><a href="ask1-report.html#figure-2f-check-the-model" id="toc-figure-2f-check-the-model"><span class="toc-section-number">21.9.4</span> Figure 2f – check the model</a></li>
<li><a href="ask1-report.html#figure-2f-inference" id="toc-figure-2f-inference"><span class="toc-section-number">21.9.5</span> Figure 2f – inference</a></li>
<li><a href="ask1-report.html#figure-2f-plot-the-model" id="toc-figure-2f-plot-the-model"><span class="toc-section-number">21.9.6</span> Figure 2f – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake" id="toc-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake"><span class="toc-section-number">21.10</span> Figure 2g – Effect of ASK1 deletion on tissue-specific glucose uptake</a>
<ul>
<li><a href="ask1-report.html#figure-2g-import" id="toc-figure-2g-import"><span class="toc-section-number">21.10.1</span> Figure 2g – import</a></li>
<li><a href="ask1-report.html#figure-2g-exploratory-plots" id="toc-figure-2g-exploratory-plots"><span class="toc-section-number">21.10.2</span> Figure 2g – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2g-fit-the-model" id="toc-figure-2g-fit-the-model"><span class="toc-section-number">21.10.3</span> Figure 2g – fit the model</a></li>
<li><a href="ask1-report.html#figure-2g-check-the-model" id="toc-figure-2g-check-the-model"><span class="toc-section-number">21.10.4</span> Figure 2g – check the model</a></li>
<li><a href="ask1-report.html#figure-2g-inference" id="toc-figure-2g-inference"><span class="toc-section-number">21.10.5</span> Figure 2g – inference</a></li>
<li><a href="ask1-report.html#figure-2g-plot-the-model" id="toc-figure-2g-plot-the-model"><span class="toc-section-number">21.10.6</span> Figure 2g – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2h" id="toc-figure-2h"><span class="toc-section-number">21.11</span> Figure 2h</a></li>
<li><a href="ask1-report.html#figure-2i-effect-of-ask1-deletion-on-liver-tg" id="toc-figure-2i-effect-of-ask1-deletion-on-liver-tg"><span class="toc-section-number">21.12</span> Figure 2i – Effect of ASK1 deletion on liver TG</a>
<ul>
<li><a href="ask1-report.html#figure-2i-fit-the-model" id="toc-figure-2i-fit-the-model"><span class="toc-section-number">21.12.1</span> Figure 2i – fit the model</a></li>
<li><a href="ask1-report.html#figure-2i-check-the-model" id="toc-figure-2i-check-the-model"><span class="toc-section-number">21.12.2</span> Figure 2i – check the model</a></li>
<li><a href="ask1-report.html#figure-2i-inference" id="toc-figure-2i-inference"><span class="toc-section-number">21.12.3</span> Figure 2i – inference</a></li>
<li><a href="ask1-report.html#figure-2i-plot-the-model" id="toc-figure-2i-plot-the-model"><span class="toc-section-number">21.12.4</span> Figure 2i – plot the model</a></li>
<li><a href="ask1-report.html#figure-2i-report-the-model" id="toc-figure-2i-report-the-model"><span class="toc-section-number">21.12.5</span> Figure 2i – report the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2j" id="toc-figure-2j"><span class="toc-section-number">21.13</span> Figure 2j</a></li>
</ul></li>
<li><a href="count-sim.html#count-sim" id="toc-count-sim"><span class="toc-section-number">22</span> Simulations – Count data (alternatives to a t-test)</a>
<ul>
<li><a href="count-sim.html#use-data-similar-to-figure-6f-from-example-1" id="toc-use-data-similar-to-figure-6f-from-example-1"><span class="toc-section-number">22.1</span> Use data similar to Figure 6f from Example 1</a></li>
<li><a href="count-sim.html#functions" id="toc-functions"><span class="toc-section-number">22.2</span> Functions</a></li>
<li><a href="count-sim.html#simulations" id="toc-simulations"><span class="toc-section-number">22.3</span> Simulations</a>
<ul>
<li><a href="count-sim.html#type-i-pseudo-normal-distribution" id="toc-type-i-pseudo-normal-distribution"><span class="toc-section-number">22.3.1</span> Type I, Pseudo-Normal distribution</a></li>
<li><a href="count-sim.html#type-i-neg-binom-equal-n" id="toc-type-i-neg-binom-equal-n"><span class="toc-section-number">22.3.2</span> Type I, neg binom, equal n</a></li>
<li><a href="count-sim.html#type-i-neg-binom-equal-n-small-theta" id="toc-type-i-neg-binom-equal-n-small-theta"><span class="toc-section-number">22.3.3</span> Type I, neg binom, equal n, small theta</a></li>
<li><a href="count-sim.html#type-i-neg-binom-unequal-n" id="toc-type-i-neg-binom-unequal-n"><span class="toc-section-number">22.3.4</span> Type I, neg binom, unequal n</a></li>
<li><a href="count-sim.html#power-pseudo-normal-distribution-equal-n" id="toc-power-pseudo-normal-distribution-equal-n"><span class="toc-section-number">22.3.5</span> Power, Pseudo-Normal distribution, equal n</a></li>
<li><a href="count-sim.html#power-neg-binom-equal-n" id="toc-power-neg-binom-equal-n"><span class="toc-section-number">22.3.6</span> Power, neg binom, equal n</a></li>
<li><a href="count-sim.html#power-neg-binom-small-theta" id="toc-power-neg-binom-small-theta"><span class="toc-section-number">22.3.7</span> Power, neg binom, small theta</a></li>
<li><a href="count-sim.html#power-neg-binom-unequal-n" id="toc-power-neg-binom-unequal-n"><span class="toc-section-number">22.3.8</span> Power, neg binom, unequal n</a></li>
<li><a href="count-sim.html#power-neg-binom-unequal-n-unequal-theta" id="toc-power-neg-binom-unequal-n-unequal-theta"><span class="toc-section-number">22.3.9</span> Power, neg binom, unequal n, unequal theta</a></li>
<li><a href="count-sim.html#type-1-neg-binom-equal-n-unequal-theta" id="toc-type-1-neg-binom-equal-n-unequal-theta"><span class="toc-section-number">22.3.10</span> Type 1, neg binom, equal n, unequal theta</a></li>
</ul></li>
<li><a href="count-sim.html#save-it-read-it" id="toc-save-it-read-it"><span class="toc-section-number">22.4</span> Save it, Read it</a></li>
<li><a href="count-sim.html#analysis" id="toc-analysis"><span class="toc-section-number">22.5</span> Analysis</a></li>
</ul></li>
<li><a href="appendix-1-getting-started-with-r.html#appendix-1-getting-started-with-r" id="toc-appendix-1-getting-started-with-r">Appendix 1: Getting Started with R</a>
<ul>
<li><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready" id="toc-get-your-computer-ready"><span class="toc-section-number">22.6</span> Get your computer ready</a>
<ul>
<li><a href="appendix-1-getting-started-with-r.html#start-here" id="toc-start-here"><span class="toc-section-number">22.6.1</span> Start here</a></li>
<li><a href="appendix-1-getting-started-with-r.html#install-r" id="toc-install-r"><span class="toc-section-number">22.6.2</span> Install R</a></li>
<li><a href="appendix-1-getting-started-with-r.html#install-r-studio" id="toc-install-r-studio"><span class="toc-section-number">22.6.3</span> Install R Studio</a></li>
<li><a href="appendix-1-getting-started-with-r.html#install-r-markdown-1" id="toc-install-r-markdown-1"><span class="toc-section-number">22.6.4</span> Install R Markdown</a></li>
<li><a href="appendix-1-getting-started-with-r.html#optional-alternative-latex-installations" id="toc-optional-alternative-latex-installations"><span class="toc-section-number">22.6.5</span> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li><a href="appendix-1-getting-started-with-r.html#start-learning-r-studio" id="toc-start-learning-r-studio"><span class="toc-section-number">22.7</span> Start learning R Studio</a></li>
</ul></li>
<li><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html#appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r" id="toc-appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r">Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics for Experimental Biology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="covariates" class="section level1" number="14">
<h1><span class="header-section-number">Chapter 14</span> Linear models with added covariates (“ANCOVA”)</h1>
<p>In its most general sense, <strong>Covariates</strong> are simply the <span class="math inline">\(X\)</span> variables in a statistical model. With data from experiments, “covariates” more typically refers to continuous <span class="math inline">\(X\)</span> variables that are added to a model to increase precision of the treatment effects. In observational designs, continuous and categorical covariates might be added to a model to 1) increase predictive ability, 2) because the researcher is interested in specific conditional effects, or 3) to eliminate confounding. These are discussed in later chapters. In this chapter, a single, continuous covariate is added to a linear model. Nothing is fundamentally different if the covariate added is categorical (<span class="math inline">\(Sex\)</span> is a common categorical covariate) or if multiple covariates are added.</p>
<div id="adding-covariates-can-increases-the-precision-of-the-effect-of-interest" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> Adding covariates can increases the precision of the effect of interest</h2>
<p>I use fake data to introduce the concept of <strong>statistical elimination</strong> of a <strong>covariate</strong> in a statistical model. Here I am modeling the effect of a new drug on blood LDL-C levels. LDL is a kind of lipoprotein, which are particles in the blood that transport fats and cholesterol to and from different tissues. LDL-C is cholesterol associated with LDL particles. LDL-C is considered “bad cholesterol” because LDL is believed to transport cholesterol and other lipids to arterial walls, which is the basis for atherosclerosis.</p>
<p>Thirty applied biostats students are recruited and are randomly assigned to either the “placebo” treatment level or “drug” treatment level. The response is blood LDL-C concentration. The drug manufacturer wants a measure of the effect of the new drug on ldlc.</p>
<div class="figure"><span style="display:block;" id="fig:covariate-fd-plot-no-cov"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/covariate-fd-plot-no-cov-1.png" alt="Effect of drug therapy on plasma LDL-C." width="576" />
<p class="caption">
Figure 14.1: Effect of drug therapy on plasma LDL-C.
</p>
</div>
<p>The linear model fit to the simulated LDL-C data is</p>
<p><span class="math display" id="eq:cov-no-cov">\[\begin{equation}
ldlc = \beta_0 + \beta_1 treatment_{drug} + \varepsilon
\tag{14.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(treatment_{drug}\)</span> is the dummy variable, which is set to 0 when <span class="math inline">\(treatment = \mathrm{&#39;&#39;placebo&#39;&#39;}\)</span> and to 1 when <span class="math inline">\(treatment = \mathrm{&#39;&#39;drug&#39;&#39;}\)</span>.</p>
<p>The coefficient table is</p>
<pre><code>##               Estimate Std. Error t value Pr(&gt;|t|)   2.5 %  97.5 %
## (Intercept)    106.045      1.070  99.111    0.000 103.854 108.237
## treatmentdrug   -1.554      1.513  -1.027    0.313  -4.654   1.546</code></pre>
<p>The response-effect plot shows large overlap in the LDL-C response and treatment effect that is small relative to the noise. “No effect of the drug (<span class="math inline">\(p = .31\)</span>)” is an incorrect interpretation of the <em>p</em>-value of the significance test of the estimate of <span class="math inline">\(\beta_1\)</span>. A better interpretation is, the estimated effect is -1.6 but everything from large, negative effects to moderate positive effects are consistent with the data.</p>
<p>As expert biologists, we know that LDL-C is strongly correlated with age and there is a large range in age among the Applied Bistats students. If age contributes to a large fraction of the variance in LDL-C among applied biostats students, then age-related variance <em>might</em> mask the effect of the drug. Here is a plot of LDL-C vs. age, with treatment assignment color coded. Remember, these are the exact same values of LDL-C as in figure <a href="#fig:cov-harrelplot"><strong>??</strong></a> above.</p>
<div class="figure"><span style="display:block;" id="fig:ancova-plot2"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/ancova-plot2-1.png" alt="Linear regression of $ldlc$ on age fit to the fake LDL-C data. The points are color coded by treatment." width="576" />
<p class="caption">
Figure 14.2: Linear regression of <span class="math inline">\(ldlc\)</span> on age fit to the fake LDL-C data. The points are color coded by treatment.
</p>
</div>
<p>The regression line is the fit of the linear model</p>
<p><span class="math display" id="eq:cov-age">\[\begin{equation}
ldlc = \beta_0 + \beta_1 age + \varepsilon
\tag{14.2}
\end{equation}\]</span></p>
<p>The points are color-coded by treatment level but <span class="math inline">\(treatment\)</span> is not in model <a href="covariates.html#eq:cov-age">(14.2)</a>. The color-coding makes it clear that most of the “placebo” data points are above the line, or have positive residuals from the model, while the “drug” data points are below the line, or have negative residuals from the model. That is, <strong>at any specific value of age, there is very small overlap of LDL-C values for drug and for placebo</strong>.</p>
<p>What is happening? Age is contributing to the variance of LDL-C, and the noise in <span class="math inline">\(\varepsilon\)</span> in model <a href="covariates.html#eq:cov-no-cov">(14.1)</a>, and this added noise makes decreases the precision in our estimate of the effect of the new drug relative to placebo. When we view the data as in Figure <a href="#covariate-fd-plot-no-cov"><strong>??</strong></a>, age is masking the effect. If we could somehow measure the effect of the drug at a specific age, then we could get a more precise estimate of the effect. But how to do this? Here are three possible methods. The third is <em>the only</em> one you should use but the second is useful for understanding the third.</p>
<ol style="list-style-type: decimal">
<li><p>We could just analyze a subset of the data, that is, only the cases in which the value of age is nearly equal. This throws away perfectly good data and, consequently, greatly reduces the sample size and thus precision to estimate the effect.</p></li>
<li><p>We could first fit model <a href="covariates.html#eq:cov-age">(14.2)</a> and then use the <em>residuals</em> of this fit as a new response variable to estimate the effect of drug treatment (this is what we did by eye in figure <a href="covariates.html#fig:ancova-plot2">14.2</a>).</p></li>
</ol>
<p>step 1:</p>
<p><span class="math display">\[\begin{equation}
ldlc = \beta_0 + \beta_1 age + \varepsilon
\end{equation}\]</span></p>
<p>step 2:</p>
<p><span class="math display" id="eq:ancova-3">\[\begin{equation}
ldlc\_residual = \beta_0 + \beta_1 treatment_{drug} + \varepsilon
\tag{14.3}
\end{equation}\]</span></p>
<p>Here, I use this two-stage method because it is useful to introduce the concept of <strong>adjusting for a covariate</strong> in a linear model, where the covariate here is <span class="math inline">\(age\)</span>. But, in general, don’t do this – the method usually “works” pretty well if the mean of the <strong>covariate</strong> (the step 1 <span class="math inline">\(X\)</span> variable) is nearly the same in both treatment levels but artifacts that lead to wrong inference are introduced if the mean of the covariate is far apart.</p>
<div class="figure"><span style="display:block;" id="fig:covariate-fd-plot-cov"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/covariate-fd-plot-cov-1.png" alt="Effect of drug therapy on plasma LDL-C using residuals. Don't do this!" width="576" />
<p class="caption">
Figure 14.3: Effect of drug therapy on plasma LDL-C using residuals. Don’t do this!
</p>
</div>
<p>Figure <a href="#covariate-fd-plot-cov"><strong>??</strong></a>A is an effect-response plot of the effect of treatment on the LDL-C <strong>adjusted for age</strong> using the two-step method. Figure <a href="#covariate-fd-plot-cov"><strong>??</strong></a>B is the original (not adjust) effect-response plot. The <strong>scale</strong> of both plots are the same. This means that the response axis has the same length in both plots and the effects axis has the same length in both plots. This makes comparing the two easy. Two patterns are conspicuous</p>
<ol style="list-style-type: decimal">
<li>The <strong>age-adjusted means</strong> in Figure <a href="#covariate-fd-plot-cov"><strong>??</strong></a>A are further apart (the difference is bigger) then the unadjusted means in Figure <a href="#covariate-fd-plot-cov"><strong>??</strong></a>B. This is seen in both the response and the effects components of the plot.</li>
<li>The spread of the residual LDL-C measures within each treatment level in Figure <a href="#covariate-fd-plot-cov"><strong>??</strong></a>A is less than the spread of the raw LDL-C measures in Figure <a href="#covariate-fd-plot-cov"><strong>??</strong></a>B.</li>
<li>The confidence interval of the effect (difference in means) is smaller using the adjusted model (Figure <a href="#covariate-fd-plot-cov"><strong>??</strong></a>A) than in the unadjusted model (Figure <a href="#covariate-fd-plot-cov"><strong>??</strong></a>B)</li>
<li>The <em>p</em>-value of the effect (difference in means) is smaller using the adjusted model (Figure <a href="#covariate-fd-plot-cov"><strong>??</strong></a>A) than in the unadjusted model (Figure <a href="#covariate-fd-plot-cov"><strong>??</strong></a>B)</li>
</ol>
<p>These patterns are quantified by the Estimates and SEs of the coefficient table. Again, I show both for comparison. Can you match comparisons 1-4 above with the statistic in the coefficient table?</p>
<p>Coefficient table of two-step, “adjusted” model (adjusting for <span class="math inline">\(age\)</span>):</p>
<pre><code>##               Estimate Std. Error t value Pr(&gt;|t|)  2.5 % 97.5 %
## (Intercept)      1.901      0.556   3.422    0.002  0.763  3.040
## treatmentdrug   -3.803      0.786  -4.840    0.000 -5.412 -2.193</code></pre>
<p>Coefficient table of unadjusted model (adjusting for <span class="math inline">\(age\)</span>):</p>
<pre><code>##               Estimate Std. Error t value Pr(&gt;|t|)   2.5 %  97.5 %
## (Intercept)    106.045      1.070  99.111    0.000 103.854 108.237
## treatmentdrug   -1.554      1.513  -1.027    0.313  -4.654   1.546</code></pre>
<p>It is clear from the plots and the tables that this two-stage adjustment increases the precision of the estimates of the means and the differences in means by <em>eliminating the contribution of Age to the variance in LDL-C</em>.</p>
<ol start="3" style="list-style-type: decimal">
<li>The best practice for <strong>adjusting for a covariate</strong> (or the <em>statistical elimination of a covariate</em>) is to simply add the covariate to the linear model.</li>
</ol>
<p><span class="math display" id="eq:cov-cov">\[\begin{equation}
ldlc = \beta_0 + \beta_1 age + \beta_2 treatment_{drug} + \varepsilon
\tag{14.4}
\end{equation}\]</span></p>
<pre><code>##               Estimate Std. Error t value Pr(&gt;|t|)  2.5 % 97.5 %
## (Intercept)      75.60      3.260   23.20 2.28e-19 68.900  82.30
## age               1.26      0.133    9.47 4.46e-10  0.988   1.53
## treatmentdrug    -4.45      0.802   -5.55 6.94e-06 -6.090  -2.81</code></pre>
<p>Again, compare the coefficient table from the model fit without the covariate.</p>
<pre><code>##               Estimate Std. Error t value Pr(&gt;|t|)  2.5 % 97.5 %
## (Intercept)     106.00       1.07   99.10 3.36e-37 104.00 108.00
## treatmentdrug    -1.55       1.51   -1.03 3.13e-01  -4.65   1.55</code></pre>
<ol style="list-style-type: decimal">
<li>The adjusted effect is larger (-4.5 vs. -1.6)</li>
<li>The adjusted SE of the difference is smaller (0.8 vs. 1.5)</li>
<li>The adjusted CIs are narrower (-6.1, -2.8 vs. -4.7, 1.6)</li>
<li>The p-value of the adjusted difference is smaller (0.000007 vs. 0.31)</li>
</ol>
<p>A plot of the model is</p>
<div class="figure"><span style="display:block;" id="fig:covariate-plot-the-model"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/covariate-plot-the-model-1.png" alt="Effect of drug therapy, adjusted for age, on plasma LDL-C." width="576" />
<p class="caption">
Figure 14.4: Effect of drug therapy, adjusted for age, on plasma LDL-C.
</p>
</div>
</div>
<div id="understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> Understanding a linear model with an added covariate – heart necrosis data</h2>
<p><a href="https://www.nature.com/articles/s42255-019-0123-y">1-Deoxydihydroceramide causes anoxic death by impairing chaperonin-mediated protein folding</a></p>
<p><a href="https://www.nature.com/articles/s42255-019-0123-y#Sec38">Source data</a></p>
<p>In this article, the researchers are investigating the effects of specific sphingolipids on hypoxia (low O2) in the heart. This hypoxia results in necrosis (death) of heart tissue. The researchers are specifically looking at the sphingolipid 1-deoxydihydroceramide (DoxDHCer), which is derived from 1-deoxysphinganine6 (DoxSa).</p>
<p>In the experiment for Figure 4h, the researchers measured the effect of three treatments on necrosis.</p>
<ol style="list-style-type: decimal">
<li>Vehicle – there is no “cardioprotection” from the hypoxia-producing sphingolipids. This is the “control”. We expect more necrotic area in this group.
2 Myriocin – a drug that inhibits the enzyme that iniates sphingolipid production. This drug should provide protection from the hypoxia-producing sphingolipids. We expect less necrotic area (or, cardioprotection) in this group.</li>
<li>Myriocin + DoxSa – DoxSa is the specific sphingolipid that the researchers believe cause the hypoxia/necrosis. The drug should inhibit the production of sphingolipids but the added DoxSa should reverses the protective effect of the drug. If there is a reversal of the protection, then this supports the hypothesis that DoxSa is the sphingolipid causing the hypoxia/necrosis.</li>
</ol>
<p>The response (<span class="math inline">\(Y\)</span>) variable is <span class="math inline">\(area\_of\_necrosis\)</span> – the measured “area” of the necrotic tissue (area is used here in the sense of “region” and not in the sense of length times width). The covariate is <span class="math inline">\(area\_at\_risk\)</span> – the area of heart tissue that is susceptible to necrosis.</p>
<div id="fit-the-model-5" class="section level3" number="14.2.1">
<h3><span class="header-section-number">14.2.1</span> Fit the model</h3>
<p>The verbal model with added covariate is</p>
<p><span class="math inline">\(area\_of\_necrosis \sim area\_at\_risk + treatment\;\;\;(\mathcal{M}_1)\)</span>.</p>
<p>which I’ll name model <span class="math inline">\(\mathcal{M}_1\)</span>. To understand the model coefficients, it helps to expand model <span class="math inline">\(\mathcal{M}_1\)</span> into the full linear model.</p>
<p><span class="math display" id="eq:cov-fig4h-additive">\[\begin{equation}
area\_of\_necrosis = \beta_0 + \beta_1 area\_at\_risk + \beta_2 treatment_{myriosin} + \beta_3 treatment_{Myriocin\;+\;DoxSa} + \varepsilon
\tag{14.5}
\end{equation}\]</span></p>
<p>The model includes parameters for the effects of area at risk (<span class="math inline">\(\beta_1\)</span>), the myriosin treatment (<span class="math inline">\(\beta_2\)</span>) and the myriosin + DoxSa treatment (<span class="math inline">\(\beta_3\)</span>). I explain the interpretation of these effects in “Interpretation of the model coefficients” below.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="covariates.html#cb408-1" aria-hidden="true" tabindex="-1"></a>fig4h_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(area_of_necrosis <span class="sc">~</span> area_at_risk <span class="sc">+</span> treatment,</span>
<span id="cb408-2"><a href="covariates.html#cb408-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> fig4h)</span></code></pre></div>
</div>
<div id="plot-the-model-2" class="section level3" number="14.2.2">
<h3><span class="header-section-number">14.2.2</span> Plot the model</h3>
<div class="figure"><span style="display:block;" id="fig:fig4h-m1-plot-model"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/fig4h-m1-plot-model-1.png" alt="The effect of treatment on area of necrosis, adjusted for area of risk." width="576" />
<p class="caption">
Figure 14.5: The effect of treatment on area of necrosis, adjusted for area of risk.
</p>
</div>
</div>
<div id="interpretation-of-the-model-coefficients" class="section level3" number="14.2.3">
<h3><span class="header-section-number">14.2.3</span> Interpretation of the model coefficients</h3>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="covariates.html#cb409-1" aria-hidden="true" tabindex="-1"></a>fig4h_m1_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(fig4h_m1)),</span>
<span id="cb409-2"><a href="covariates.html#cb409-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">confint</span>(fig4h_m1))</span>
<span id="cb409-3"><a href="covariates.html#cb409-3" aria-hidden="true" tabindex="-1"></a><span class="fu">signif</span>(fig4h_m1_coef, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                           Estimate Std. Error t value Pr(&gt;|t|)  2.5 % 97.5 %
## (Intercept)                 -3.890     2.1200   -1.83 7.63e-02 -8.220  0.436
## area_at_risk                 0.453     0.0587    7.73 8.28e-09  0.334  0.573
## treatmentMyriocin           -3.110     1.2300   -2.53 1.64e-02 -5.620 -0.611
## treatmentMyriocin + DoxSa   -3.150     1.3700   -2.31 2.78e-02 -5.930 -0.367</code></pre>
<ol style="list-style-type: decimal">
<li>The estimate in the “(Intercept)” row (<span class="math inline">\(b_0\)</span>) is the expected value of the reference (here, this is the Vehicle group) when <span class="math inline">\(area\_at\_risk=0\)</span>. Using Figure <a href="covariates.html#fig:fig4h-m1-plot-model">14.5</a>, this can be visualized as the value of <span class="math inline">\(Y\)</span> where the Vehicle line (the regression line for the reference group) crosses the <em>y</em>-axis (at <span class="math inline">\(X = 0\)</span>). This is not a meaningful estimate since the area at risk in all hearts is above zero.</li>
<li>The estimate in the “area_at_risk” row (<span class="math inline">\(b_1\)</span>) is a common slope for all three regression lines. Some might refer to this slope as the “effect” of <span class="math inline">\(area\_at\_risk\)</span> on <span class="math inline">\(area\_of\_necrosis\)</span> but I recommend against using this causal language because the <span class="math inline">\(area\_at\_risk\)</span> is not randomly assigned – its purpose in <em>this</em> model (but not necessarily all linear models with an added covariate) is not for interpretation but for improving inference in the expimental treatment factor.</li>
<li>The estimate in the “treatmentMyriocin” row (<span class="math inline">\(b_2\)</span>) is the effect of <span class="math inline">\(Myriocin\)</span> on <span class="math inline">\(area\_of\_necrosis\)</span> <strong>conditional on</strong> (or <strong>adjusted for</strong>) <span class="math inline">\(area\_at\_risk\)</span>. A frequent phrase is “the estimate controlling for area at risk” but avoid this because “control” implies experimenter intervention and this is not true for <span class="math inline">\(area\_at\_risk\)</span>. The value is the difference in the elevation of the regression line for the reference group and that for the Myriocin group. This difference is equal to the difference in conditional expectations at a specific value of the covariate.</li>
</ol>
<p><span class="math display">\[\begin{equation}
b_2 = \mathrm{E}(area\_of\_necrosis|treatment = &quot;Myriocin&quot;, X = x) - \mathrm{E}(area\_of\_necrosis|treatment = &quot;Vehicle&quot;, X = x)
\end{equation}\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>The estimate in the “treatmentMyriocin + DoxSa” row (<span class="math inline">\(b_3\)</span>) is the effect of <span class="math inline">\(Myriocin + DoxSa\)</span> on <span class="math inline">\(area\_of\_necrosis\)</span> <strong>conditional on</strong> (or <strong>adjusted for</strong>) <span class="math inline">\(area\_at\_risk\)</span>. It’s interpretation is similar to that for <span class="math inline">\(b_2\)</span>.</li>
</ol>
<p>How do we summarize these interpretations given the motivating hypothesis? The results do not support the hypothesis. If DoxSa is one of the sphingolipids inducing hypoxia/necrosis, then we’d expect the Myriocin + DoxSa line to be elevated above the Myriocin line. But the coefficient table “tests” this prediction only indirectly. The explicit statistic for this prediction is the (Myriocin + DoxSa) - Myriocin contrast in the contrast table below.</p>
</div>
<div id="everything-adds-up" class="section level3" number="14.2.4">
<h3><span class="header-section-number">14.2.4</span> Everything adds up</h3>
<p>Remember that everything adds up in a linear model. A regression line is a line of expected values (the expectation of <span class="math inline">\(Y\)</span> conditional on <span class="math inline">\(X\)</span>). The point on the Vehicle line at <span class="math inline">\(area\_of\_risk = 30\)</span> is <span class="math inline">\(b_0 + b_1 \cdot 30\)</span>. The point on the “Myriocin” line at <span class="math inline">\(area\_of\_risk = 30\)</span> is <span class="math inline">\(b_0 + b_1 \cdot 30 + b_2\)</span>. And, the point on the “Myriocin + DoxSa” line at <span class="math inline">\(area\_of\_risk = 30\)</span> is <span class="math inline">\(b_0 + b_1 \cdot 30 + b_3\)</span>. Understanding how the components of the linear model add up gives you phenomenonal cosmic power in statistical analysis.</p>
</div>
<div id="interpretation-of-the-estimated-marginal-means" class="section level3" number="14.2.5">
<h3><span class="header-section-number">14.2.5</span> Interpretation of the estimated marginal means</h3>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="covariates.html#cb411-1" aria-hidden="true" tabindex="-1"></a>fig4h_m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(fig4h_m1, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb411-2"><a href="covariates.html#cb411-2" aria-hidden="true" tabindex="-1"></a>fig4h_m1_emm</span></code></pre></div>
<pre><code>##  treatment        emmean    SE df lower.CL upper.CL
##  Vehicle           11.98 0.839 32     10.3     13.7
##  Myriocin           8.87 0.916 32      7.0     10.7
##  Myriocin + DoxSa   8.83 1.045 32      6.7     11.0
## 
## Confidence level used: 0.95</code></pre>
<p>The values in the column “emmean” are the expected values of each group when (“conditional on”) <span class="math inline">\(area\_at\_risk\)</span> is equal to the mean <span class="math inline">\(area\_at\_risk\)</span>.</p>
</div>
<div id="interpretation-of-the-contrasts" class="section level3" number="14.2.6">
<h3><span class="header-section-number">14.2.6</span> Interpretation of the contrasts</h3>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="covariates.html#cb413-1" aria-hidden="true" tabindex="-1"></a>fig4h_m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(fig4h_m1_emm,</span>
<span id="cb413-2"><a href="covariates.html#cb413-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb413-3"><a href="covariates.html#cb413-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb413-4"><a href="covariates.html#cb413-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb413-5"><a href="covariates.html#cb413-5" aria-hidden="true" tabindex="-1"></a>fig4h_m1_pairs</span></code></pre></div>
<pre><code>##  contrast                      estimate   SE df lower.CL upper.CL t.ratio
##  Myriocin - Vehicle             -3.1139 1.23 32    -5.62   -0.611  -2.534
##  (Myriocin + DoxSa) - Vehicle   -3.1485 1.37 32    -5.93   -0.367  -2.306
##  (Myriocin + DoxSa) - Myriocin  -0.0346 1.43 32    -2.95    2.881  -0.024
##  p.value
##   0.0164
##   0.0278
##   0.9809
## 
## Confidence level used: 0.95</code></pre>
<p>The values in the column “estimate” are the differences between the estimated marginal means in the estimated marginal means table. The first two contrasts are equal to the coefficients <span class="math inline">\(b_2\)</span> and <span class="math inline">\(b_3\)</span> in the coefficient table.</p>
</div>
<div id="adding-the-covariate-improves-inference" class="section level3" number="14.2.7">
<h3><span class="header-section-number">14.2.7</span> Adding the covariate improves inference</h3>
<p>Compare the effects in Model <span class="math inline">\(\mathcal{M}_1\)</span> (with the added covariate) to the effects in a linear model without the added covariate.</p>
<pre><code>##                           Estimate Std. Error t value Pr(&gt;|t|) 2.5 % 97.5 %
## (Intercept)                 11.200       1.39   8.070 2.60e-09  8.38 14.000
## treatmentMyriocin           -3.660       2.04  -1.790 8.26e-02 -7.82  0.499
## treatmentMyriocin + DoxSa    0.293       2.15   0.136 8.93e-01 -4.09  4.670</code></pre>
<p>Inference from these two models is very different. From the model adjusting for area at risk (Model <span class="math inline">\(\mathcal{M}_1\)</span>), we would conclude “Unexpectedly, the estimated Myriocin + DoxSa effect (-3.2 mg, 95% CI: -5.9, -0.4) is effectively as big as the Myriocin alone effect.” By contrast, using the model without the covariate, we would conclude “Relative to the Myriocin effect, the estimated Myriocin + DoxSa effect is small (.29 mg), and there is large uncertainty in its direction and magnitude (95% CI: -4.1, 4.7).” (Note that the authors published a different conclusion to either of these. I cannot recover the results leading to their conclusion using the methods published by the authors.)</p>
</div>
</div>
<div id="understanding-interaction-effects-with-covariates" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> Understanding interaction effects with covariates</h2>
<div id="fit-the-model-6" class="section level3" number="14.3.1">
<h3><span class="header-section-number">14.3.1</span> Fit the model</h3>
<p>When we add a continuous covariate to a model we sometimes want to model the <strong>interaction</strong> with the categorical factor variable. An interaction effect represents how the effect of one variable changes given the level of a second variable. The verbal model with an added interaction effect is</p>
<p><span class="math inline">\(area\_of\_necrosis \sim area\_at\_risk + treatment + area\_at\_risk \times treatment\;\;\;(\mathcal{M}_2)\)</span></p>
<p>which I’ll refer to as Model <span class="math inline">\(\mathcal{M}_2\)</span>. To understand the model coefficients, it helps to expand this into the full linear model.</p>
<p><span class="math display" id="eq:cov-fig4h-interaction">\[\begin{align}
area\_of\_necrosis = \beta_0 &amp;+ \beta_1 area\_at\_risk + \beta_2 treatment_{myriosin} + \beta_3 treatment_{Myriocin\;+\;DoxSa}\\
&amp;+ \beta_4 area\_at\_risk \cdot treatment_{myriosin}\\
&amp;+ \beta_5 area\_at\_risk \cdot treatment_{Myriocin\;+\;DoxSa}\\
&amp;+ \varepsilon
\tag{14.6}
\end{align}\]</span></p>
<p>In addition to the effects of the myriosin (<span class="math inline">\(\beta_2\)</span>) and the myriosin + DoxSa (<span class="math inline">\(\beta_3\)</span>) treatments of Model <span class="math inline">\(\mathcal{M}_1\)</span>, Model <span class="math inline">\(\mathcal{M}_2\)</span> includes coefficients for two <strong>interaction effects</strong>, the interaction between myriosin and area at risk (<span class="math inline">\(\beta_4\)</span>) and the interaction between myriosin + DoxSa and area at risk (<span class="math inline">\(\beta_4\)</span>). The parameters <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> are <strong>additive effects</strong> because they are linear (additive) “in the <span class="math inline">\(X\)</span>” variables. The parameters <span class="math inline">\(\beta_3\)</span> and <span class="math inline">\(\beta_4\)</span> are <strong>non-additive effects</strong> because they are not linear “in the <span class="math inline">\(X\)</span>” variables – these effects are coefficients of an <span class="math inline">\(X\)</span> that is the product of two variables. You can see this in the model equation but I explain this further below.</p>
<p>For the goals of the researchers in the heart necrosis study, we specifically would not want to model the interaction. Nevertheless, we would want to plot the interaction effect during the “Step 2: examine the data” phase of analysis to be sure that an additive model is a reasonable model given the data.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="covariates.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see working in R to understand this model formula</span></span>
<span id="cb416-2"><a href="covariates.html#cb416-2" aria-hidden="true" tabindex="-1"></a>fig4h_m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(area_of_necrosis <span class="sc">~</span> area_at_risk<span class="sc">*</span>treatment,</span>
<span id="cb416-3"><a href="covariates.html#cb416-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> fig4h)</span></code></pre></div>
</div>
<div id="plot-the-model-with-interaction-effect" class="section level3" number="14.3.2">
<h3><span class="header-section-number">14.3.2</span> Plot the model with interaction effect</h3>
<div class="figure"><span style="display:block;" id="fig:fig4h-m2-plot-model"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/fig4h-m2-plot-model-1.png" alt="The effect of treatment on area of necrosis, adjusted for area of risk." width="576" />
<p class="caption">
Figure 14.6: The effect of treatment on area of necrosis, adjusted for area of risk.
</p>
</div>
</div>
<div id="interpretation-of-the-model-coefficients-1" class="section level3" number="14.3.3">
<h3><span class="header-section-number">14.3.3</span> Interpretation of the model coefficients</h3>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="covariates.html#cb417-1" aria-hidden="true" tabindex="-1"></a>fig4h_m2_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(fig4h_m2)),</span>
<span id="cb417-2"><a href="covariates.html#cb417-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">confint</span>(fig4h_m2))</span>
<span id="cb417-3"><a href="covariates.html#cb417-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(fig4h_m2_coef[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)], <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##                                        Estimate Std. Error
## (Intercept)                               -6.55       3.01
## area_at_risk                               0.53       0.09
## treatmentMyriocin                          4.90       4.90
## treatmentMyriocin + DoxSa                 -1.17       5.28
## area_at_risk:treatmentMyriocin            -0.25       0.15
## area_at_risk:treatmentMyriocin + DoxSa    -0.06       0.14</code></pre>
<ol style="list-style-type: decimal">
<li>The estimate in the “(Intercept)” row (<span class="math inline">\(b_0\)</span>) is the expected value of the reference (here, this is the Vehicle group) when <span class="math inline">\(area\_at\_risk=0\)</span>. This is the same interpretation of the intercept in the additive model (Model <span class="math inline">\(\mathcal{M}_1\)</span>) but the value is different. This is because the slope coefficient (<span class="math inline">\(b_1\)</span>) estimated in Model <span class="math inline">\(\mathcal{M}_1\)</span> is a common slope (to all three groups) estimated by pooling data from all three groups. The slope coefficient in the non-additive model (Model <span class="math inline">\(\mathcal{M}_2\)</span>) is computed from just the reference data. Because the slope differs between Model <span class="math inline">\(\mathcal{M}_1\)</span> and Model <span class="math inline">\(\mathcal{M}_2\)</span>, the intercept differs (think about why they are necessarily related). As in Model <span class="math inline">\(\mathcal{M}_1\)</span>, the value and inferential statistics are meaningful for this parameterization but there are slight modifications of the model that can make this meaningful.</li>
<li>The estimate in the “area_at_risk” row (<span class="math inline">\(b_1\)</span>) is the slope of the regression line for the reference (Vehicle) group, that is, the slope conditional on <span class="math inline">\(treatment = \mathrm{&#39;&#39;Vehicle&#39;&#39;}\)</span></li>
<li>The estimate in the “treatmentMyriocin” row (<span class="math inline">\(b_2\)</span>) is the effect of <span class="math inline">\(Myriocin\)</span> on <span class="math inline">\(area\_of\_necrosis\)</span> <strong>conditional on</strong> <span class="math inline">\(area\_at\_risk = 0\)</span>. Note the difference in interpretation with <span class="math inline">\(b_2\)</span> in Model <span class="math inline">\(\mathcal{M}_1\)</span>. The difference is because of the interaction. The effect of <span class="math inline">\(Myriocin\)</span> on <span class="math inline">\(area\_of\_necrosis\)</span> is no longer constant for all values of <span class="math inline">\(area\_at\_risk\)</span>. This is easily seen in Figure <a href="covariates.html#fig:fig4h-m2-plot-model">14.6</a>, where the effect of Myriocin (the vertical distance between the Vehicle and Myriocin line) is very small at small values of area at risk but very large at large areas at risk.</li>
<li>The estimate in the “treatmentMyriocin + DoxSa” row (<span class="math inline">\(b_3\)</span>) is the effect of <span class="math inline">\(Myriocin + DoxSa\)</span> on <span class="math inline">\(area\_of\_necrosis\)</span> <strong>conditional on</strong> <span class="math inline">\(area\_at\_risk = 0\)</span>. It’s interpretation is similar to that for <span class="math inline">\(b_2\)</span>.</li>
<li>The estimate in the “area_at_risk:treatmentMyriocin” row (<span class="math inline">\(b_4\)</span>) is the <strong>interaction effect</strong> between area at risk and Myriocin. It’s value is the difference between the slope of the regression line through the Myriocin points in Figure <a href="covariates.html#fig:fig4h-m2-plot-model">14.6</a> and the slope of the regression line through the reference (Vehicle) points in Figure <a href="covariates.html#fig:fig4h-m2-plot-model">14.6</a>. Consequently, the slope of the regression line through the Myriocin points is <span class="math inline">\(b_1 + b_4\)</span>.</li>
<li>The estimate in the “area_at_risk:treatmentMyriocin + DoxSa” row (<span class="math inline">\(b_5\)</span>) is the <strong>interaction effect</strong> between area at risk and Myriocin + DoxSa It’s value is the difference between the slope of the regression line through the Myriocin + DoxSa points in Figure <a href="covariates.html#fig:fig4h-m2-plot-model">14.6</a> and the slope of the regression line through the reference (Vehicle) data in Figure <a href="covariates.html#fig:fig4h-m2-plot-model">14.6</a>. Consequently, the slope of the regression line through the Myriocin + DoxSa points is <span class="math inline">\(b_1 + b_5\)</span>.</li>
</ol>
<p>Interaction effects are <em>differences in slopes</em> (this is also true with interactions between two factor variables, even though we usually describe this as “differences in differences”) and these difference are easily seen by inspection of a plot similar to that in Figure <a href="covariates.html#fig:fig4h-m2-plot-model">14.6</a>. The bigger the interaction, the less parallel the regression line.</p>
</div>
<div id="what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends." class="section level3" number="14.3.4">
<h3><span class="header-section-number">14.3.4</span> What is the effect of a treatment, if interactions are modeled? – it depends.</h3>
<p>A very useful way to remember what an interaction <em>is</em> is “it depends”. What is the effect of Myriocin on area at risk? With an interaction term in the linear model, the answer is “it depends”. It depends on the level of <span class="math inline">\(area\_at\_risk\)</span>. At small values of area at risk, the effect of Myriocin is very small. At large values of area at risk, the effect of Myriocin is large. Likewise, what is the effect of area at risk on necrosis? It depends (if interactions are modeled). It depends on the level of treatment, for example the effect in the Myriocin group is smaller (a smaller slope) than the effect in the Vehicle group. “It depends” is the hallmark of interactions – the effect of one variable on the outcome depends on the level of a second variable.</p>
</div>
<div id="which-model-do-we-use-mathcalm_1-or-mathcalm_2" class="section level3" number="14.3.5">
<h3><span class="header-section-number">14.3.5</span> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</h3>
<p>The answer to this question depends partly on our goals. If we are explicitly interested in measuring an interaction effect (perhaps some theory predicts an positive interaction) then we would necesarily add interaction effects to the model. But if we are interested in estimating a treatment effect conditional on a covariate, then we don’t include the interaction. Remember that a purpose of initial explorations of data (“Step 2 – examine the data”) is to help decide which model to specify in the model formula. If an initial plot shows large interactions between treatment levels and the covariate, then adjusting for the covariate won’t work, or at least won’t work without additional complexity to the interpretation. “Large interactions” of course raises the question, how large is too larege to ignore interactions? Many textbooks in biostatistics recommend using an interaction <em>p</em>-value to make this decision. I disagree. There is no objective answer to the question. We lose information with all models – that is what we do in science. It is up to the researcher to be transparent with all decisions. If an additive (no interactions) model is used to condition on (adjust for) a covariate, the researcher should use the supplement to plot the model with interactions as evidence of why this decision is reasonable.</p>
</div>
</div>
<div id="understanding-ancova-tables" class="section level2" number="14.4">
<h2><span class="header-section-number">14.4</span> Understanding ANCOVA tables</h2>
</div>
<div id="working-in-r-3" class="section level2" number="14.5">
<h2><span class="header-section-number">14.5</span> Working in R</h2>
<div id="importing-the-heart-necrosis-data" class="section level3" number="14.5.1">
<h3><span class="header-section-number">14.5.1</span> Importing the heart necrosis data</h3>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="covariates.html#cb419-1" aria-hidden="true" tabindex="-1"></a>data_folder <span class="ot">&lt;-</span> <span class="st">&quot;data&quot;</span></span>
<span id="cb419-2"><a href="covariates.html#cb419-2" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;1-Deoxydihydroceramide causes anoxic death by impairing chaperonin-mediated protein folding&quot;</span></span>
<span id="cb419-3"><a href="covariates.html#cb419-3" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;42255_2019_123_MOESM7_ESM.xlsx&quot;</span></span>
<span id="cb419-4"><a href="covariates.html#cb419-4" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb419-5"><a href="covariates.html#cb419-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-6"><a href="covariates.html#cb419-6" aria-hidden="true" tabindex="-1"></a>sheet_i <span class="ot">&lt;-</span> <span class="st">&quot;Figure 4h&quot;</span></span>
<span id="cb419-7"><a href="covariates.html#cb419-7" aria-hidden="true" tabindex="-1"></a>fig4h_1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb419-8"><a href="covariates.html#cb419-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sheet =</span> sheet_i,</span>
<span id="cb419-9"><a href="covariates.html#cb419-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">range =</span> <span class="st">&quot;A5:B19&quot;</span>,</span>
<span id="cb419-10"><a href="covariates.html#cb419-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-11"><a href="covariates.html#cb419-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb419-12"><a href="covariates.html#cb419-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb419-13"><a href="covariates.html#cb419-13" aria-hidden="true" tabindex="-1"></a>fig4h_2 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb419-14"><a href="covariates.html#cb419-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sheet =</span> sheet_i,</span>
<span id="cb419-15"><a href="covariates.html#cb419-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">range =</span> <span class="st">&quot;D5:E17&quot;</span>,</span>
<span id="cb419-16"><a href="covariates.html#cb419-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-17"><a href="covariates.html#cb419-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb419-18"><a href="covariates.html#cb419-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb419-19"><a href="covariates.html#cb419-19" aria-hidden="true" tabindex="-1"></a>fig4h_3 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb419-20"><a href="covariates.html#cb419-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sheet =</span> sheet_i,</span>
<span id="cb419-21"><a href="covariates.html#cb419-21" aria-hidden="true" tabindex="-1"></a>                         <span class="at">range =</span> <span class="st">&quot;G5:H15&quot;</span>,</span>
<span id="cb419-22"><a href="covariates.html#cb419-22" aria-hidden="true" tabindex="-1"></a>                         <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-23"><a href="covariates.html#cb419-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb419-24"><a href="covariates.html#cb419-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb419-25"><a href="covariates.html#cb419-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-26"><a href="covariates.html#cb419-26" aria-hidden="true" tabindex="-1"></a>fig4h <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.table</span>(<span class="at">treatment =</span> <span class="st">&quot;Vehicle&quot;</span>, fig4h_1),</span>
<span id="cb419-27"><a href="covariates.html#cb419-27" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">data.table</span>(<span class="at">treatment =</span> <span class="st">&quot;Myriocin&quot;</span>, fig4h_2),</span>
<span id="cb419-28"><a href="covariates.html#cb419-28" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">data.table</span>(<span class="at">treatment =</span> <span class="st">&quot;Myriocin + DoxSa&quot;</span>, fig4h_3))</span>
<span id="cb419-29"><a href="covariates.html#cb419-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-30"><a href="covariates.html#cb419-30" aria-hidden="true" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Vehicle&quot;</span>, <span class="st">&quot;Myriocin&quot;</span>, <span class="st">&quot;Myriocin + DoxSa&quot;</span>)</span>
<span id="cb419-31"><a href="covariates.html#cb419-31" aria-hidden="true" tabindex="-1"></a>fig4h[, treatment <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(treatment, <span class="at">levels =</span> treatment_levels)]</span></code></pre></div>
</div>
<div id="fitting-the-model" class="section level3" number="14.5.2">
<h3><span class="header-section-number">14.5.2</span> Fitting the model</h3>
<p>For an additive model, add the covariate to the model formula using the <code>+</code> operator. The order of the variables doesn’t matter (the right-hand-side of the model formula could be <code>treatment + area_at_risk</code>).</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="covariates.html#cb420-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(area_of_necrosis <span class="sc">~</span> area_at_risk <span class="sc">+</span> treatment, <span class="at">data =</span> fig4h)</span></code></pre></div>
<p>For an nonadditive model with interactions, add the covariate to the model formula using the <code>*</code> operator. <code>~ area_at_risk * treatment</code> is a shortcut to the full model formula, which is <code>1 + area_at_risk + treatment + area_at_risk * treatment</code>. R expands the short formula to the full formula automatically. Again, the order of the variables doesn’t matter (the right-hand-side of the model formula could be <code>treatment * area_at_risk</code>).</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="covariates.html#cb421-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(area_of_necrosis <span class="sc">~</span> area_at_risk <span class="sc">*</span> treatment, <span class="at">data =</span> fig4h)</span></code></pre></div>
</div>
<div id="using-the-emmeans-function-1" class="section level3" number="14.5.3">
<h3><span class="header-section-number">14.5.3</span> Using the emmeans function</h3>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="covariates.html#cb422-1" aria-hidden="true" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1,</span>
<span id="cb422-2"><a href="covariates.html#cb422-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>))</span>
<span id="cb422-3"><a href="covariates.html#cb422-3" aria-hidden="true" tabindex="-1"></a>m1_emm</span></code></pre></div>
<pre><code>##  treatment        emmean    SE df lower.CL upper.CL
##  Vehicle           11.98 0.839 32     10.3     13.7
##  Myriocin           8.87 0.916 32      7.0     10.7
##  Myriocin + DoxSa   8.83 1.045 32      6.7     11.0
## 
## Confidence level used: 0.95</code></pre>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="covariates.html#cb424-1" aria-hidden="true" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1,</span>
<span id="cb424-2"><a href="covariates.html#cb424-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">&quot;area_at_risk&quot;</span>, <span class="st">&quot;treatment&quot;</span>))</span>
<span id="cb424-3"><a href="covariates.html#cb424-3" aria-hidden="true" tabindex="-1"></a>m1_emm</span></code></pre></div>
<pre><code>##  area_at_risk treatment        emmean    SE df lower.CL upper.CL
##            35 Vehicle           11.98 0.839 32     10.3     13.7
##            35 Myriocin           8.87 0.916 32      7.0     10.7
##            35 Myriocin + DoxSa   8.83 1.045 32      6.7     11.0
## 
## Confidence level used: 0.95</code></pre>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="covariates.html#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recenter emms at the mean of the vehicle group</span></span>
<span id="cb426-2"><a href="covariates.html#cb426-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-3"><a href="covariates.html#cb426-3" aria-hidden="true" tabindex="-1"></a>vehicle_mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(fig4h[treatment <span class="sc">==</span> <span class="st">&quot;Vehicle&quot;</span>,</span>
<span id="cb426-4"><a href="covariates.html#cb426-4" aria-hidden="true" tabindex="-1"></a>                         area_at_risk])</span>
<span id="cb426-5"><a href="covariates.html#cb426-5" aria-hidden="true" tabindex="-1"></a>m1_emm_2 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1,</span>
<span id="cb426-6"><a href="covariates.html#cb426-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">&quot;area_at_risk&quot;</span>,<span class="st">&quot;treatment&quot;</span>),</span>
<span id="cb426-7"><a href="covariates.html#cb426-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">at =</span> <span class="fu">list</span>(<span class="at">area_at_risk =</span> vehicle_mean_x))</span>
<span id="cb426-8"><a href="covariates.html#cb426-8" aria-hidden="true" tabindex="-1"></a>m1_emm_2</span></code></pre></div>
<pre><code>##  area_at_risk treatment        emmean    SE df lower.CL upper.CL
##          33.3 Vehicle           11.21 0.833 32     9.51    12.90
##          33.3 Myriocin           8.09 0.903 32     6.25     9.93
##          33.3 Myriocin + DoxSa   8.06 1.082 32     5.85    10.26
## 
## Confidence level used: 0.95</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="covariates.html#cb428-1" aria-hidden="true" tabindex="-1"></a>fig4h[, .(<span class="at">mean =</span> <span class="fu">mean</span>(area_of_necrosis)),</span>
<span id="cb428-2"><a href="covariates.html#cb428-2" aria-hidden="true" tabindex="-1"></a>      by <span class="ot">=</span> treatment]</span></code></pre></div>
<pre><code>##           treatment      mean
## 1:          Vehicle 11.206580
## 2:         Myriocin  7.546081
## 3: Myriocin + DoxSa 11.499319</code></pre>
</div>
<div id="ancova-tables" class="section level3" number="14.5.4">
<h3><span class="header-section-number">14.5.4</span> ANCOVA tables</h3>
<p>If you are going to report statistics from an ANCOVA table, be sure that what you report is what you think you are reporting – it is very easy to get this wrong in R. One way to easily get a table using Type II or III sums of squares is to set the contrast option of the factor variable to <code>contr.sum</code> (this tells R to use deviation coding to form the model matrix for the linear model) and then use the function <code>Anova</code> from the car package (not base R <code>anova</code>).</p>
<ol style="list-style-type: decimal">
<li>It is safest to set this with the <code>lm</code> function itself.</li>
<li>The coefficients of the linear model will have a different interpretation than that given above. Either understand the new interpretation (not given here) or fit two models, one without the reset contrasts and one with the reset contrasts.</li>
<li>The estimated marginal mean table and the contrast table are the same, regardless of how contrasts are set in the linear model.</li>
<li>Many websites show code that changes the default coding in the R session. I strongly caution against this. If you don’t change it back, then you are likely to misinterpret coefficients in later analyses (see point 2).</li>
</ol>
<p>For additive models, use Type II sum of squares (Type III will give same results),</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="covariates.html#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m1_aov, <span class="at">type =</span> <span class="dv">2</span>) <span class="co"># be sure to use the correct model!</span></span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: area_of_necrosis
##              Sum Sq Df F value   Pr(&gt;F)    
## treatment     82.04  2  4.2195  0.02364 *  
## area_at_risk 580.25  1 59.6874 8.28e-09 ***
## Residuals    311.09 32                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>For non-additive models with interactions</p>
<ol style="list-style-type: decimal">
<li>The statistics for the interaction effect are the same, regardless of the sum of squares used.</li>
<li>The interpretation of the main effects is problematic, at best. This is discussed more in the ANOVA chapter.</li>
<li>Some statisticians recommend using Type III sums of squares. The effect of $treatment* has a very specific interpretation with Type III – it is the effect when the covariate = 0. This can be biologically relevant if the covariate data is re-centered.</li>
</ol>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="covariates.html#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for coefficients</span></span>
<span id="cb432-2"><a href="covariates.html#cb432-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(area_of_necrosis <span class="sc">~</span> treatment <span class="sc">*</span> area_at_risk,</span>
<span id="cb432-3"><a href="covariates.html#cb432-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> fig4h)</span>
<span id="cb432-4"><a href="covariates.html#cb432-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for anova</span></span>
<span id="cb432-5"><a href="covariates.html#cb432-5" aria-hidden="true" tabindex="-1"></a>m2_aov <span class="ot">&lt;-</span> <span class="fu">lm</span>(area_of_necrosis <span class="sc">~</span> treatment <span class="sc">*</span> area_at_risk,</span>
<span id="cb432-6"><a href="covariates.html#cb432-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> fig4h,</span>
<span id="cb432-7"><a href="covariates.html#cb432-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">treatment =</span> contr.sum))</span></code></pre></div>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="covariates.html#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m2_aov, <span class="at">type =</span> <span class="dv">2</span>) <span class="co"># be sure to use the correct model!</span></span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: area_of_necrosis
##                        Sum Sq Df F value    Pr(&gt;F)    
## treatment               82.04  2  4.3369   0.02216 *  
## area_at_risk           580.25  1 61.3485 9.685e-09 ***
## treatment:area_at_risk  27.34  2  1.4453   0.25163    
## Residuals              283.75 30                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="covariates.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m2_aov, <span class="at">type =</span> <span class="dv">3</span>) <span class="co"># be sure to use the correct model!</span></span></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: area_of_necrosis
##                        Sum Sq Df F value    Pr(&gt;F)    
## (Intercept)             56.06  1  5.9270   0.02107 *  
## treatment               12.98  2  0.6863   0.51116    
## area_at_risk           491.92  1 52.0087 5.012e-08 ***
## treatment:area_at_risk  27.34  2  1.4453   0.25163    
## Residuals              283.75 30                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="plotting-the-model" class="section level3" number="14.5.5">
<h3><span class="header-section-number">14.5.5</span> Plotting the model</h3>
<div id="using-ggpubr" class="section level4" number="14.5.5.1">
<h4><span class="header-section-number">14.5.5.1</span> Using ggpubr</h4>
<p>ggpubr will only plot the model with interactions.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="covariates.html#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(<span class="at">data =</span> fig4h,</span>
<span id="cb437-2"><a href="covariates.html#cb437-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;area_at_risk&quot;</span>,</span>
<span id="cb437-3"><a href="covariates.html#cb437-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;area_of_necrosis&quot;</span>,</span>
<span id="cb437-4"><a href="covariates.html#cb437-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb437-5"><a href="covariates.html#cb437-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>,</span>
<span id="cb437-6"><a href="covariates.html#cb437-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;Area of necrosis (mg)&quot;</span>,</span>
<span id="cb437-7"><a href="covariates.html#cb437-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;Area at risk (mg)&quot;</span>,</span>
<span id="cb437-8"><a href="covariates.html#cb437-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> pal_okabe_ito</span>
<span id="cb437-9"><a href="covariates.html#cb437-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-193-1.png" width="576" /></p>
</div>
<div id="ggplot2" class="section level4" number="14.5.5.2">
<h4><span class="header-section-number">14.5.5.2</span> ggplot2</h4>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="covariates.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pal_batlow &lt;- scico(n, alpha = NULL, begin = 0, end = 1, direction = 1, palette = &quot;batlow&quot;)</span></span>
<span id="cb438-2"><a href="covariates.html#cb438-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-3"><a href="covariates.html#cb438-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(area_of_necrosis <span class="sc">~</span> area_at_risk <span class="sc">+</span> treatment,</span>
<span id="cb438-4"><a href="covariates.html#cb438-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> fig4h)</span>
<span id="cb438-5"><a href="covariates.html#cb438-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-6"><a href="covariates.html#cb438-6" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fig4h, </span>
<span id="cb438-7"><a href="covariates.html#cb438-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> area_at_risk,</span>
<span id="cb438-8"><a href="covariates.html#cb438-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> area_of_necrosis,</span>
<span id="cb438-9"><a href="covariates.html#cb438-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> treatment)) <span class="sc">+</span></span>
<span id="cb438-10"><a href="covariates.html#cb438-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>treatment)) <span class="sc">+</span></span>
<span id="cb438-11"><a href="covariates.html#cb438-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb438-12"><a href="covariates.html#cb438-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(m1, fig4h))) <span class="sc">+</span></span>
<span id="cb438-13"><a href="covariates.html#cb438-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> pal_okabe_ito,</span>
<span id="cb438-14"><a href="covariates.html#cb438-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb438-15"><a href="covariates.html#cb438-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = pal_batlow,</span></span>
<span id="cb438-16"><a href="covariates.html#cb438-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   name = NULL) +</span></span>
<span id="cb438-17"><a href="covariates.html#cb438-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Area of necrosis (mg)&quot;</span>) <span class="sc">+</span></span>
<span id="cb438-18"><a href="covariates.html#cb438-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Area at risk (mg)&quot;</span>) <span class="sc">+</span></span>
<span id="cb438-19"><a href="covariates.html#cb438-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pander</span>() <span class="sc">+</span></span>
<span id="cb438-20"><a href="covariates.html#cb438-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb438-21"><a href="covariates.html#cb438-21" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb438-22"><a href="covariates.html#cb438-22" aria-hidden="true" tabindex="-1"></a>gg</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-194-1.png" width="576" /></p>
</div>
<div id="a-response-effects-plot-using-ggplot2" class="section level4" number="14.5.5.3">
<h4><span class="header-section-number">14.5.5.3</span> A response-effects plot using ggplot2</h4>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="covariates.html#cb439-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(area_of_necrosis <span class="sc">~</span> area_at_risk <span class="sc">+</span> treatment, <span class="at">data =</span> fig4h)</span>
<span id="cb439-2"><a href="covariates.html#cb439-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(m1)</span>
<span id="cb439-3"><a href="covariates.html#cb439-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-4"><a href="covariates.html#cb439-4" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">levels</span>(fig4h<span class="sc">$</span>treatment)</span>
<span id="cb439-5"><a href="covariates.html#cb439-5" aria-hidden="true" tabindex="-1"></a>line_data <span class="ot">&lt;-</span> fig4h[, .(<span class="at">min_x =</span> <span class="fu">min</span>(area_at_risk),</span>
<span id="cb439-6"><a href="covariates.html#cb439-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">max_x =</span> <span class="fu">max</span>(area_at_risk)), by <span class="ot">=</span> treatment]</span>
<span id="cb439-7"><a href="covariates.html#cb439-7" aria-hidden="true" tabindex="-1"></a>line_data[, dummy1 <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">&quot;Myriocin&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb439-8"><a href="covariates.html#cb439-8" aria-hidden="true" tabindex="-1"></a>line_data[, dummy2 <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">&quot;Myriocin + DoxSa&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb439-9"><a href="covariates.html#cb439-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-10"><a href="covariates.html#cb439-10" aria-hidden="true" tabindex="-1"></a>line_data[, y_min <span class="sc">:</span><span class="er">=</span> b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>min_x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>dummy1 <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span>dummy2]</span>
<span id="cb439-11"><a href="covariates.html#cb439-11" aria-hidden="true" tabindex="-1"></a>line_data[, y_max <span class="sc">:</span><span class="er">=</span> b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>max_x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>dummy1 <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span>dummy2]</span>
<span id="cb439-12"><a href="covariates.html#cb439-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-13"><a href="covariates.html#cb439-13" aria-hidden="true" tabindex="-1"></a>gg_response <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fig4h,</span>
<span id="cb439-14"><a href="covariates.html#cb439-14" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> area_at_risk,</span>
<span id="cb439-15"><a href="covariates.html#cb439-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> area_of_necrosis,</span>
<span id="cb439-16"><a href="covariates.html#cb439-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> treatment)) <span class="sc">+</span></span>
<span id="cb439-17"><a href="covariates.html#cb439-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># points</span></span>
<span id="cb439-18"><a href="covariates.html#cb439-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb439-19"><a href="covariates.html#cb439-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb439-20"><a href="covariates.html#cb439-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> line_data,</span>
<span id="cb439-21"><a href="covariates.html#cb439-21" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> min_x,</span>
<span id="cb439-22"><a href="covariates.html#cb439-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y_min,</span>
<span id="cb439-23"><a href="covariates.html#cb439-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> max_x,</span>
<span id="cb439-24"><a href="covariates.html#cb439-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> y_max)) <span class="sc">+</span></span>
<span id="cb439-25"><a href="covariates.html#cb439-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> pal_okabe_ito,</span>
<span id="cb439-26"><a href="covariates.html#cb439-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb439-27"><a href="covariates.html#cb439-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Area of necrosis (mg)&quot;</span>) <span class="sc">+</span></span>
<span id="cb439-28"><a href="covariates.html#cb439-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Area at risk (mg)&quot;</span>) <span class="sc">+</span></span>
<span id="cb439-29"><a href="covariates.html#cb439-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb439-30"><a href="covariates.html#cb439-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb439-31"><a href="covariates.html#cb439-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-32"><a href="covariates.html#cb439-32" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb439-33"><a href="covariates.html#cb439-33" aria-hidden="true" tabindex="-1"></a><span class="co">#gg_response</span></span></code></pre></div>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="covariates.html#cb440-1" aria-hidden="true" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb440-2"><a href="covariates.html#cb440-2" aria-hidden="true" tabindex="-1"></a>m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb440-3"><a href="covariates.html#cb440-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb440-4"><a href="covariates.html#cb440-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb440-5"><a href="covariates.html#cb440-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb440-6"><a href="covariates.html#cb440-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb440-7"><a href="covariates.html#cb440-7" aria-hidden="true" tabindex="-1"></a><span class="co"># pvalString is from package lazyWeave</span></span>
<span id="cb440-8"><a href="covariates.html#cb440-8" aria-hidden="true" tabindex="-1"></a>m1_pairs[ , p_pretty <span class="sc">:</span><span class="er">=</span> <span class="fu">pvalString</span>(p.value)]</span>
<span id="cb440-9"><a href="covariates.html#cb440-9" aria-hidden="true" tabindex="-1"></a><span class="co"># also create a column with &quot;p-val: &quot;</span></span>
<span id="cb440-10"><a href="covariates.html#cb440-10" aria-hidden="true" tabindex="-1"></a>m1_pairs[ , pval_pretty <span class="sc">:</span><span class="er">=</span> <span class="fu">paste</span>(<span class="st">&quot;p = &quot;</span>, p_pretty)]</span>
<span id="cb440-11"><a href="covariates.html#cb440-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-12"><a href="covariates.html#cb440-12" aria-hidden="true" tabindex="-1"></a>contrast_order <span class="ot">&lt;-</span> m1_pairs[, contrast]</span>
<span id="cb440-13"><a href="covariates.html#cb440-13" aria-hidden="true" tabindex="-1"></a>m1_pairs[, contrast <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(contrast, contrast_order)]</span>
<span id="cb440-14"><a href="covariates.html#cb440-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-15"><a href="covariates.html#cb440-15" aria-hidden="true" tabindex="-1"></a>gg_effect <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> m1_pairs, </span>
<span id="cb440-16"><a href="covariates.html#cb440-16" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">y =</span> contrast,</span>
<span id="cb440-17"><a href="covariates.html#cb440-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">x =</span> estimate)) <span class="sc">+</span></span>
<span id="cb440-18"><a href="covariates.html#cb440-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># confidence level of effect</span></span>
<span id="cb440-19"><a href="covariates.html#cb440-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> lower.CL, </span>
<span id="cb440-20"><a href="covariates.html#cb440-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax =</span> upper.CL),</span>
<span id="cb440-21"><a href="covariates.html#cb440-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="dv">0</span>, </span>
<span id="cb440-22"><a href="covariates.html#cb440-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb440-23"><a href="covariates.html#cb440-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># estimate of effect</span></span>
<span id="cb440-24"><a href="covariates.html#cb440-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb440-25"><a href="covariates.html#cb440-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb440-26"><a href="covariates.html#cb440-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># draw a line at effect = 0</span></span>
<span id="cb440-27"><a href="covariates.html#cb440-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb440-28"><a href="covariates.html#cb440-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb440-29"><a href="covariates.html#cb440-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p-value. The y coordinates are set by eye</span></span>
<span id="cb440-30"><a href="covariates.html#cb440-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb440-31"><a href="covariates.html#cb440-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> m1_pairs<span class="sc">$</span>pval_pretty,</span>
<span id="cb440-32"><a href="covariates.html#cb440-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb440-33"><a href="covariates.html#cb440-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb440-34"><a href="covariates.html#cb440-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb440-35"><a href="covariates.html#cb440-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x-axis label and aesthetics</span></span>
<span id="cb440-36"><a href="covariates.html#cb440-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Effect (mg)&quot;</span>) <span class="sc">+</span></span>
<span id="cb440-37"><a href="covariates.html#cb440-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Contrast&quot;</span>) <span class="sc">+</span></span>
<span id="cb440-38"><a href="covariates.html#cb440-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>,<span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb440-39"><a href="covariates.html#cb440-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">position=</span><span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb440-40"><a href="covariates.html#cb440-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb440-41"><a href="covariates.html#cb440-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb440-42"><a href="covariates.html#cb440-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme(axis.title.x = element_blank()) +</span></span>
<span id="cb440-43"><a href="covariates.html#cb440-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb440-44"><a href="covariates.html#cb440-44" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb440-45"><a href="covariates.html#cb440-45" aria-hidden="true" tabindex="-1"></a><span class="co"># gg_effect</span></span></code></pre></div>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="covariates.html#cb441-1" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(gg_effect,</span>
<span id="cb441-2"><a href="covariates.html#cb441-2" aria-hidden="true" tabindex="-1"></a>                gg_response,</span>
<span id="cb441-3"><a href="covariates.html#cb441-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">nrow=</span><span class="dv">2</span>,</span>
<span id="cb441-4"><a href="covariates.html#cb441-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb441-5"><a href="covariates.html#cb441-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis =</span> <span class="st">&quot;rl&quot;</span>,</span>
<span id="cb441-6"><a href="covariates.html#cb441-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="dv">1</span>)</span>
<span id="cb441-7"><a href="covariates.html#cb441-7" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb441-8"><a href="covariates.html#cb441-8" aria-hidden="true" tabindex="-1"></a>gg</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-197-1.png" width="576" /></p>
</div>
</div>
</div>
<div id="best-practices" class="section level2" number="14.6">
<h2><span class="header-section-number">14.6</span> Best practices</h2>
<div id="do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate" class="section level3" number="14.6.1">
<h3><span class="header-section-number">14.6.1</span> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</h3>
</div>
<div id="do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate" class="section level3" number="14.6.2">
<h3><span class="header-section-number">14.6.2</span> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</h3>
</div>
<div id="do-not-test-for-balance-of-baseline-measures" class="section level3" number="14.6.3">
<h3><span class="header-section-number">14.6.3</span> Do not “test for balance” of baseline measures</h3>
<p>A test of the null hypothesis of no difference in mean at baseline is a “test for balance.” Researchers frequently test for balance at baseline and use the <em>p</em>-value of the test to decide the next step: 1) if <span class="math inline">\(p &gt; 0.05\)</span>, conclude that the pre-treatment means “do not differ” and use something like a simple <em>t</em> test of the post-treatment means, 2) if <span class="math inline">\(p &lt; 0.05\)</span>, then use the change score, or the percent change, as the response in a simple <em>t</em>-test, or 3) if <span class="math inline">\(p &lt; 0.05\)</span>, then use use a linear model with the pre-treatment value as a covariate. Here, and in general, hypothesis tests used to decide which of several ways to proceed do not make sense. First, a null-hypothesis significance test cannot tell you that there is “no difference” – this is not what null-hypothesis tests do. Second, any <span class="math inline">\(p\)</span>-value after the initial test isn’t strictly valid as it does not take into account this decision step, but this is minor. Third, <strong>it doesn’t matter</strong>; there will always be some difference in the actual means of the initial measures and, consequently, the conditional expectation of the final measures, or change in measures, or percent change will be dependent on this initial difference. So, if one has initial measures, one should use an linear model that adjusts for baseline measures to estimate the treatment effect in pre-post designs. And, if one isn’t planning on taking an initial measure, then maybe you should, because the initial measure used in a linear model allows a better estimate of the treatment effect, as discussed above in <a href="covariates.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest">Adding covariates can increases the precision of the effect of interest</a>.</p>
</div>
</div>
<div id="best-practices-2-use-a-covariate-instead-of-normalizing-a-response" class="section level2" number="14.7">
<h2><span class="header-section-number">14.7</span> Best practices 2: Use a covariate instead of normalizing a response</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="part-v-more-than-one-x-multivariable-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="factorial.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/32-covariates.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
