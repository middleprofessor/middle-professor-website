<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Creating Fake Data | Elements of Statistical Modeling for Experimental Biology</title>
  <meta name="description" content="A first course in statistical modeling for experimental biology researchers" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Creating Fake Data | Elements of Statistical Modeling for Experimental Biology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A first course in statistical modeling for experimental biology researchers" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Creating Fake Data | Elements of Statistical Modeling for Experimental Biology" />
  
  <meta name="twitter:description" content="A first course in statistical modeling for experimental biology researchers" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="p-values.html"/>
<link rel="next" href="part-iii-introduction-to-linear-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#math"><i class="fa fa-check"></i><b>0.1</b> Math</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#r-and-programming"><i class="fa fa-check"></i><b>0.2</b> R and programming</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-r-fundamentals.html"><a href="part-i-r-fundamentals.html"><i class="fa fa-check"></i>Part I: R fundamentals</a></li>
<li class="chapter" data-level="1" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html"><i class="fa fa-check"></i><b>1</b> Organization – R Projects and R Notebooks</a><ul>
<li class="chapter" data-level="1.1" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#r-vs-r-studio"><i class="fa fa-check"></i><b>1.1</b> R vs R Studio</a></li>
<li class="chapter" data-level="1.2" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#r-notebook-vs.-r-markdown"><i class="fa fa-check"></i><b>1.2</b> R Notebook vs. R Markdown</a></li>
<li class="chapter" data-level="1.3" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#importing-packages"><i class="fa fa-check"></i><b>1.3</b> Importing Packages</a></li>
<li class="chapter" data-level="1.4" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-an-r-studio-project-for-this-textbook"><i class="fa fa-check"></i><b>1.4</b> Create an R Studio Project for this textbook</a><ul>
<li class="chapter" data-level="1.4.1" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-an-r-notebook-for-this-chapter"><i class="fa fa-check"></i><b>1.4.1</b> Create an R Notebook for this Chapter</a></li>
<li class="chapter" data-level="1.4.2" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-a-fake-data-chunk"><i class="fa fa-check"></i><b>1.4.2</b> Create a “fake-data” chunk</a></li>
<li class="chapter" data-level="1.4.3" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-a-plot-chunk"><i class="fa fa-check"></i><b>1.4.3</b> Create a “plot” chunk</a></li>
<li class="chapter" data-level="1.4.4" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#knit"><i class="fa fa-check"></i><b>1.4.4</b> Knit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html"><i class="fa fa-check"></i><b>2</b> Data – Reading, Wrangling, and Writing</a><ul>
<li class="chapter" data-level="2.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#learning-from-this-chapter"><i class="fa fa-check"></i><b>2.1</b> Learning from this chapter</a></li>
<li class="chapter" data-level="2.2" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#data-working-in-r"><i class="fa fa-check"></i><b>2.2</b> Working in R</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#importing-data"><i class="fa fa-check"></i><b>2.2.1</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#data-wrangling"><i class="fa fa-check"></i><b>2.3</b> Data wrangling</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#reshaping-data-wide-to-long"><i class="fa fa-check"></i><b>2.3.1</b> Reshaping data – Wide to long</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#reshaping-data-transpose-turning-the-columns-into-rows"><i class="fa fa-check"></i><b>2.3.2</b> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#combining-data"><i class="fa fa-check"></i><b>2.3.3</b> Combining data</a></li>
<li class="chapter" data-level="2.3.4" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#subsetting-data"><i class="fa fa-check"></i><b>2.3.4</b> Subsetting data</a></li>
<li class="chapter" data-level="2.3.5" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#wrangling-columns"><i class="fa fa-check"></i><b>2.3.5</b> Wrangling columns</a></li>
<li class="chapter" data-level="2.3.6" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#missing-data"><i class="fa fa-check"></i><b>2.3.6</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#saving-data"><i class="fa fa-check"></i><b>2.4</b> Saving data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-some-fundamentals-of-statistical-modeling.html"><a href="part-ii-some-fundamentals-of-statistical-modeling.html"><i class="fa fa-check"></i>Part II: Some Fundamentals of Statistical Modeling</a></li>
<li class="chapter" data-level="3" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html"><i class="fa fa-check"></i><b>3</b> An Introduction to Statistical Modeling</a><ul>
<li class="chapter" data-level="3.1" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#two-specifications-of-a-linear-model"><i class="fa fa-check"></i><b>3.1</b> Two specifications of a linear model</a><ul>
<li class="chapter" data-level="3.1.1" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#the-error-draw-specification"><i class="fa fa-check"></i><b>3.1.1</b> The “error draw” specification</a></li>
<li class="chapter" data-level="3.1.2" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#the-conditional-draw-specification"><i class="fa fa-check"></i><b>3.1.2</b> The “conditional draw” specification</a></li>
<li class="chapter" data-level="3.1.3" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#comparing-the-two-ways-of-specifying-the-linear-model"><i class="fa fa-check"></i><b>3.1.3</b> Comparing the two ways of specifying the linear model</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#what-do-we-call-the-x-and-y-variables"><i class="fa fa-check"></i><b>3.2</b> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li class="chapter" data-level="3.3" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#statistical-models-are-used-for-prediction-explanation-and-description"><i class="fa fa-check"></i><b>3.3</b> Statistical models are used for prediction, explanation, and description</a></li>
<li class="chapter" data-level="3.4" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#modeling-strategy"><i class="fa fa-check"></i><b>3.4</b> Modeling strategy</a></li>
<li class="chapter" data-level="3.5" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#a-mean-is-the-simplest-model"><i class="fa fa-check"></i><b>3.5</b> A mean is the simplest model</a></li>
<li class="chapter" data-level="3.6" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#assumptions-for-inference-with-a-statistical-model"><i class="fa fa-check"></i><b>3.6</b> Assumptions for inference with a statistical model</a></li>
<li class="chapter" data-level="3.7" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#specific-assumptions-for-inference-with-a-linear-model"><i class="fa fa-check"></i><b>3.7</b> Specific assumptions for inference with a linear model</a></li>
<li class="chapter" data-level="3.8" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#statistical-model-or-regression-model"><i class="fa fa-check"></i><b>3.8</b> “Statistical model” or “regression model”?</a></li>
<li class="chapter" data-level="3.9" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#glm-vs.-glm-vs.-gls"><i class="fa fa-check"></i><b>3.9</b> GLM vs. GLM vs. GLS</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><i class="fa fa-check"></i><b>4</b> Variability and Uncertainty (Standard Deviations, Standard Errors, Confidence Intervals)</a><ul>
<li class="chapter" data-level="4.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#the-sample-standard-deviation-vs.-the-standard-error-of-the-mean"><i class="fa fa-check"></i><b>4.1</b> The sample standard deviation vs. the standard error of the mean</a><ul>
<li class="chapter" data-level="4.1.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#sample-standard-deviation"><i class="fa fa-check"></i><b>4.1.1</b> Sample standard deviation</a></li>
<li class="chapter" data-level="4.1.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>4.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>4.2</b> Using Google Sheets to generate fake data to explore the standard error</a><ul>
<li class="chapter" data-level="4.2.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#steps"><i class="fa fa-check"></i><b>4.2.1</b> Steps</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#using-r-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>4.3</b> Using R to generate fake data to explore the standard error</a><ul>
<li class="chapter" data-level="4.3.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-i"><i class="fa fa-check"></i><b>4.3.1</b> part I</a></li>
<li class="chapter" data-level="4.3.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-ii---means"><i class="fa fa-check"></i><b>4.3.2</b> part II - means</a></li>
<li class="chapter" data-level="4.3.3" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-iii---how-do-sd-and-se-change-as-sample-size-n-increases"><i class="fa fa-check"></i><b>4.3.3</b> part III - how do SD and SE change as sample size (n) increases?</a></li>
<li class="chapter" data-level="4.3.4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-iv-generating-fake-data-with-for-loops"><i class="fa fa-check"></i><b>4.3.4</b> Part IV – Generating fake data with for-loops</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#bootstrap"><i class="fa fa-check"></i><b>4.4</b> Bootstrapped standard errors</a><ul>
<li class="chapter" data-level="4.4.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#an-example-of-bootstrapped-standard-errors-using-vole-data"><i class="fa fa-check"></i><b>4.4.1</b> An example of bootstrapped standard errors using vole data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#confidence-interval"><i class="fa fa-check"></i><b>4.5</b> Confidence Interval</a><ul>
<li class="chapter" data-level="4.5.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#interpretation-of-a-confidence-interval"><i class="fa fa-check"></i><b>4.5.1</b> Interpretation of a confidence interval</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html"><i class="fa fa-check"></i><b>5</b> Covariance and Correlation</a></li>
<li class="chapter" data-level="6" data-path="p-values.html"><a href="p-values.html"><i class="fa fa-check"></i><b>6</b> P-values</a><ul>
<li class="chapter" data-level="6.1" data-path="p-values.html"><a href="p-values.html#p-values-1"><i class="fa fa-check"></i><b>6.1</b> <span class="math inline">\(p\)</span>-values</a></li>
<li class="chapter" data-level="6.2" data-path="p-values.html"><a href="p-values.html#creating-a-null-distribution."><i class="fa fa-check"></i><b>6.2</b> Creating a null distribution.</a><ul>
<li class="chapter" data-level="6.2.1" data-path="p-values.html"><a href="p-values.html#the-null-distribution"><i class="fa fa-check"></i><b>6.2.1</b> the Null Distribution</a></li>
<li class="chapter" data-level="6.2.2" data-path="p-values.html"><a href="p-values.html#t-tests"><i class="fa fa-check"></i><b>6.2.2</b> t-tests</a></li>
<li class="chapter" data-level="6.2.3" data-path="p-values.html"><a href="p-values.html#p-values-from-the-perspective-of-permutation"><i class="fa fa-check"></i><b>6.2.3</b> P-values from the perspective of permutation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="p-values.html"><a href="p-values.html#statistical-modeling-instead-of-hypothesis-testing"><i class="fa fa-check"></i><b>6.3</b> Statistical modeling instead of hypothesis testing</a></li>
<li class="chapter" data-level="6.4" data-path="p-values.html"><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values"><i class="fa fa-check"></i><b>6.4</b> frequentist probability and the interpretation of p-values</a><ul>
<li class="chapter" data-level="6.4.1" data-path="p-values.html"><a href="p-values.html#background"><i class="fa fa-check"></i><b>6.4.1</b> Background</a></li>
<li class="chapter" data-level="6.4.2" data-path="p-values.html"><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><i class="fa fa-check"></i><b>6.4.2</b> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li class="chapter" data-level="6.4.3" data-path="p-values.html"><a href="p-values.html#two-interpretations-of-the-p-value"><i class="fa fa-check"></i><b>6.4.3</b> Two interpretations of the <em>p</em>-value</a></li>
<li class="chapter" data-level="6.4.4" data-path="p-values.html"><a href="p-values.html#nhst"><i class="fa fa-check"></i><b>6.4.4</b> NHST</a></li>
<li class="chapter" data-level="6.4.5" data-path="p-values.html"><a href="p-values.html#some-major-misconceptions-of-the-p-value"><i class="fa fa-check"></i><b>6.4.5</b> Some major misconceptions of the <span class="math inline">\(p\)</span>-value</a></li>
<li class="chapter" data-level="6.4.6" data-path="p-values.html"><a href="p-values.html#recommendations"><i class="fa fa-check"></i><b>6.4.6</b> Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="p-values.html"><a href="p-values.html#problems"><i class="fa fa-check"></i><b>6.5</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="creating-fake-data.html"><a href="creating-fake-data.html"><i class="fa fa-check"></i><b>7</b> Creating Fake Data</a><ul>
<li class="chapter" data-level="7.0.1" data-path="creating-fake-data.html"><a href="creating-fake-data.html#continuous-x-fake-observational-data"><i class="fa fa-check"></i><b>7.0.1</b> Continuous X (fake observational data)</a></li>
<li class="chapter" data-level="7.0.2" data-path="creating-fake-data.html"><a href="creating-fake-data.html#categorical-x-fake-experimental-data"><i class="fa fa-check"></i><b>7.0.2</b> Categorical X (fake experimental data)</a></li>
<li class="chapter" data-level="7.0.3" data-path="creating-fake-data.html"><a href="creating-fake-data.html#correlated-x-fake-observational-data"><i class="fa fa-check"></i><b>7.0.3</b> Correlated X (fake observational data)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-introduction-to-linear-models.html"><a href="part-iii-introduction-to-linear-models.html"><i class="fa fa-check"></i>Part III: Introduction to Linear Models</a></li>
<li class="chapter" data-level="8" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html"><i class="fa fa-check"></i><b>8</b> Models with a single, continuous <em>X</em></a><ul>
<li class="chapter" data-level="8.1" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><i class="fa fa-check"></i><b>8.1</b> A linear model with a single, continuous <em>X</em> is classical “regression”</a><ul>
<li class="chapter" data-level="8.1.1" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#analysis-of-green-down-data"><i class="fa fa-check"></i><b>8.1.1</b> Analysis of “green-down” data</a></li>
<li class="chapter" data-level="8.1.2" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#learning-from-the-green-down-example"><i class="fa fa-check"></i><b>8.1.2</b> Learning from the green-down example</a></li>
<li class="chapter" data-level="8.1.3" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#what-a-regression-coefficient-means"><i class="fa fa-check"></i><b>8.1.3</b> What a regression coefficient means</a></li>
<li class="chapter" data-level="8.1.4" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#using-the-linear-model-for-prediction-prediction-models"><i class="fa fa-check"></i><b>8.1.4</b> Using the linear model for prediction – prediction models</a></li>
<li class="chapter" data-level="8.1.5" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#using-a-linear-model-for-explanation-causal-models"><i class="fa fa-check"></i><b>8.1.5</b> Using a linear model for “explanation” – causal models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#working-in-r"><i class="fa fa-check"></i><b>8.2</b> Working in R</a><ul>
<li class="chapter" data-level="8.2.1" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#fitting-the-linear-model"><i class="fa fa-check"></i><b>8.2.1</b> Fitting the linear model</a></li>
<li class="chapter" data-level="8.2.2" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#getting-to-know-the-linear-model-the-summary-function"><i class="fa fa-check"></i><b>8.2.2</b> Getting to know the linear model: the <code>summary</code> function</a></li>
<li class="chapter" data-level="8.2.3" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#inference-the-coefficient-table-and-confidence-intervals"><i class="fa fa-check"></i><b>8.2.3</b> Inference – the coefficient table and Confidence intervals</a></li>
<li class="chapter" data-level="8.2.4" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#how-good-is-our-model"><i class="fa fa-check"></i><b>8.2.4</b> How good is our model?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html"><i class="fa fa-check"></i><b>9</b> A linear model with a single, categorical <em>X</em></a><ul>
<li class="chapter" data-level="9.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#a-linear-model-with-a-single-categorical-x-estimates-the-effects-of-x-on-the-response."><i class="fa fa-check"></i><b>9.1</b> A linear model with a single, categorical <em>X</em> estimates the effects of <em>X</em> on the response.</a><ul>
<li class="chapter" data-level="9.1.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#table-of-model-coefficients"><i class="fa fa-check"></i><b>9.1.1</b> Table of model coefficients</a></li>
<li class="chapter" data-level="9.1.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#the-linear-model"><i class="fa fa-check"></i><b>9.1.2</b> The linear model</a></li>
<li class="chapter" data-level="9.1.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#reporting-results"><i class="fa fa-check"></i><b>9.1.3</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#comparing-the-results-of-a-linear-model-to-classical-hypothesis-tests"><i class="fa fa-check"></i><b>9.2</b> Comparing the results of a linear model to classical hypothesis tests</a><ul>
<li class="chapter" data-level="9.2.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#t-tests-are-special-cases-of-a-linear-model"><i class="fa fa-check"></i><b>9.2.1</b> t-tests are special cases of a linear model</a></li>
<li class="chapter" data-level="9.2.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#anova-is-a-special-case-of-a-linear-model"><i class="fa fa-check"></i><b>9.2.2</b> ANOVA is a special case of a linear model</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#working-in-r-1"><i class="fa fa-check"></i><b>9.3</b> Working in R</a><ul>
<li class="chapter" data-level="9.3.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#fitting-the-model"><i class="fa fa-check"></i><b>9.3.1</b> Fitting the model</a></li>
<li class="chapter" data-level="9.3.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#changing-the-reference-level"><i class="fa fa-check"></i><b>9.3.2</b> Changing the reference level</a></li>
<li class="chapter" data-level="9.3.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#an-introduction-to-contrasts"><i class="fa fa-check"></i><b>9.3.3</b> An introduction to contrasts</a></li>
<li class="chapter" data-level="9.3.4" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#harrell-plot"><i class="fa fa-check"></i><b>9.3.4</b> Harrell plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>10</b> Model Checking</a><ul>
<li class="chapter" data-level="10.1" data-path="model-checking.html"><a href="model-checking.html#do-coefficients-make-numeric-sense"><i class="fa fa-check"></i><b>10.1</b> Do coefficients make numeric sense?</a></li>
<li class="chapter" data-level="10.2" data-path="model-checking.html"><a href="model-checking.html#all-statistical-analyses-should-be-followed-by-model-checking"><i class="fa fa-check"></i><b>10.2</b> All statistical analyses should be followed by model checking</a></li>
<li class="chapter" data-level="10.3" data-path="model-checking.html"><a href="model-checking.html#linear-model-assumptions"><i class="fa fa-check"></i><b>10.3</b> Linear model assumptions</a></li>
<li class="chapter" data-level="10.4" data-path="model-checking.html"><a href="model-checking.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>10.4</b> Diagnostic plots use the residuals from the model fit</a><ul>
<li class="chapter" data-level="10.4.1" data-path="model-checking.html"><a href="model-checking.html#residuals"><i class="fa fa-check"></i><b>10.4.1</b> Residuals</a></li>
<li class="chapter" data-level="10.4.2" data-path="model-checking.html"><a href="model-checking.html#a-normal-q-q-plot-is-used-to-check-normality"><i class="fa fa-check"></i><b>10.4.2</b> A Normal Q-Q plot is used to check normality</a></li>
<li class="chapter" data-level="10.4.3" data-path="model-checking.html"><a href="model-checking.html#outliers---an-outlier-is-a-point-that-is-highly-unexpected-given-the-modeled-distribution."><i class="fa fa-check"></i><b>10.4.3</b> Outliers - an outlier is a point that is highly unexpected given the modeled distribution.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="model-checking.html"><a href="model-checking.html#model-checking-homoskedasticity"><i class="fa fa-check"></i><b>10.5</b> Model checking homoskedasticity</a></li>
<li class="chapter" data-level="10.6" data-path="model-checking.html"><a href="model-checking.html#model-checking-independence---hapiness-adverse-example."><i class="fa fa-check"></i><b>10.6</b> Model checking independence - hapiness adverse example.</a></li>
<li class="chapter" data-level="10.7" data-path="model-checking.html"><a href="model-checking.html#using-r"><i class="fa fa-check"></i><b>10.7</b> Using R</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html"><i class="fa fa-check"></i><b>11</b> Model Fitting and Model Fit (OLS)</a><ul>
<li class="chapter" data-level="11.1" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#least-squares-estimation-and-the-decomposition-of-variance"><i class="fa fa-check"></i><b>11.1</b> Least Squares Estimation and the Decomposition of Variance</a></li>
<li class="chapter" data-level="11.2" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#ols-regression"><i class="fa fa-check"></i><b>11.2</b> OLS regression</a></li>
<li class="chapter" data-level="11.3" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#how-well-does-the-model-fit-the-data-r2-and-variance-explained"><i class="fa fa-check"></i><b>11.3</b> How well does the model fit the data? <span class="math inline">\(R^2\)</span> and “variance explained”</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html"><i class="fa fa-check"></i><b>12</b> Best Practices – Issues in Inference</a><ul>
<li class="chapter" data-level="12.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#power"><i class="fa fa-check"></i><b>12.1</b> Power</a><ul>
<li class="chapter" data-level="12.1.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#types-of-error"><i class="fa fa-check"></i><b>12.1.1</b> “Types” of Error</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#multiple-testing"><i class="fa fa-check"></i><b>12.2</b> multiple testing</a><ul>
<li class="chapter" data-level="12.2.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#some-background"><i class="fa fa-check"></i><b>12.2.1</b> Some background</a></li>
<li class="chapter" data-level="12.2.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#multiple-testing-working-in-r"><i class="fa fa-check"></i><b>12.2.2</b> Multiple testing – working in R</a></li>
<li class="chapter" data-level="12.2.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#false-discovery-rate"><i class="fa fa-check"></i><b>12.2.3</b> False Discovery Rate</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#difference-in-p-is-not-different"><i class="fa fa-check"></i><b>12.3</b> difference in p is not different</a></li>
<li class="chapter" data-level="12.4" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#inference-when-data-are-not-normal"><i class="fa fa-check"></i><b>12.4</b> Inference when data are not Normal</a><ul>
<li class="chapter" data-level="12.4.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#working-in-r-2"><i class="fa fa-check"></i><b>12.4.1</b> Working in R</a></li>
<li class="chapter" data-level="12.4.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>12.4.2</b> Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="12.4.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#permutation-test"><i class="fa fa-check"></i><b>12.4.3</b> Permutation test</a></li>
<li class="chapter" data-level="12.4.4" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#non-parametric-tests"><i class="fa fa-check"></i><b>12.4.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="12.4.5" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#log-transformations"><i class="fa fa-check"></i><b>12.4.5</b> Log transformations</a></li>
<li class="chapter" data-level="12.4.6" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#performance-of-parametric-tests-and-alternatives"><i class="fa fa-check"></i><b>12.4.6</b> Performance of parametric tests and alternatives</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#max-vs.-mean"><i class="fa fa-check"></i><b>12.5</b> max vs. mean</a></li>
<li class="chapter" data-level="12.6" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#pre-post-normalization"><i class="fa fa-check"></i><b>12.6</b> pre-post, normalization</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="plotting-models.html"><a href="plotting-models.html"><i class="fa fa-check"></i><b>13</b> Plotting Models</a><ul>
<li class="chapter" data-level="13.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data"><i class="fa fa-check"></i><b>13.1</b> Pretty good plots show the model and the data</a><ul>
<li class="chapter" data-level="13.1.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot"><i class="fa fa-check"></i><b>13.1.1</b> Pretty good plot component 1: Modeled effects plot</a></li>
<li class="chapter" data-level="13.1.2" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot"><i class="fa fa-check"></i><b>13.1.2</b> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li class="chapter" data-level="13.1.3" data-path="plotting-models.html"><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><i class="fa fa-check"></i><b>13.1.3</b> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="plotting-models.html"><a href="plotting-models.html#some-comments-on-plot-components"><i class="fa fa-check"></i><b>13.2</b> Some comments on plot components</a></li>
<li class="chapter" data-level="13.3" data-path="plotting-models.html"><a href="plotting-models.html#working-in-r-3"><i class="fa fa-check"></i><b>13.3</b> Working in R</a><ul>
<li class="chapter" data-level="13.3.1" data-path="plotting-models.html"><a href="plotting-models.html#unpooled-se-bars-and-confidence-intervals"><i class="fa fa-check"></i><b>13.3.1</b> Unpooled SE bars and confidence intervals</a></li>
<li class="chapter" data-level="13.3.2" data-path="plotting-models.html"><a href="plotting-models.html#adding-bootstrap-intervals"><i class="fa fa-check"></i><b>13.3.2</b> Adding bootstrap intervals</a></li>
<li class="chapter" data-level="13.3.3" data-path="plotting-models.html"><a href="plotting-models.html#adding-modeled-means-and-error-intervals"><i class="fa fa-check"></i><b>13.3.3</b> Adding modeled means and error intervals</a></li>
<li class="chapter" data-level="13.3.4" data-path="plotting-models.html"><a href="plotting-models.html#adding-p-values"><i class="fa fa-check"></i><b>13.3.4</b> Adding p-values</a></li>
<li class="chapter" data-level="13.3.5" data-path="plotting-models.html"><a href="plotting-models.html#adding-custom-p-values"><i class="fa fa-check"></i><b>13.3.5</b> Adding custom p-values</a></li>
<li class="chapter" data-level="13.3.6" data-path="plotting-models.html"><a href="plotting-models.html#plotting-two-factors"><i class="fa fa-check"></i><b>13.3.6</b> Plotting two factors</a></li>
<li class="chapter" data-level="13.3.7" data-path="plotting-models.html"><a href="plotting-models.html#interaction-plot"><i class="fa fa-check"></i><b>13.3.7</b> Interaction plot</a></li>
<li class="chapter" data-level="13.3.8" data-path="plotting-models.html"><a href="plotting-models.html#plot-components"><i class="fa fa-check"></i><b>13.3.8</b> Plot components</a></li>
</ul></li>
</ul></li>
<li><a href="part-iv-more-than-one-x-multivariable-models.html#part-iv-more-than-one-x-multivariable-models">Part IV: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li class="chapter" data-level="14" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html"><i class="fa fa-check"></i><b>14</b> Adding covariates to a linear model</a><ul>
<li class="chapter" data-level="14.1" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><i class="fa fa-check"></i><b>14.1</b> Adding covariates can increases the precision of the effect of interest</a></li>
<li class="chapter" data-level="14.2" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-covariates-can-decrease-prediction-error-in-predictive-models"><i class="fa fa-check"></i><b>14.2</b> Adding covariates can decrease prediction error in predictive models</a></li>
<li class="chapter" data-level="14.3" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-covariates-can-reduce-bias-due-to-confounding-in-explanatory-models"><i class="fa fa-check"></i><b>14.3</b> Adding covariates can reduce bias due to confounding in explanatory models</a></li>
<li class="chapter" data-level="14.4" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#best-practices-1-a-pre-treatment-measure-of-the-response-should-be-a-covariate-and-not-subtracted-from-the-post-treatment-measure-regression-to-the-mean"><i class="fa fa-check"></i><b>14.4</b> Best practices 1: A pre-treatment measure of the response should be a covariate and not subtracted from the post-treatment measure (regression to the mean)</a><ul>
<li class="chapter" data-level="14.4.1" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#regression-to-the-mean-in-words"><i class="fa fa-check"></i><b>14.4.1</b> Regression to the mean in words</a></li>
<li class="chapter" data-level="14.4.2" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#regression-to-the-mean-in-pictures"><i class="fa fa-check"></i><b>14.4.2</b> Regression to the mean in pictures</a></li>
<li class="chapter" data-level="14.4.3" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#do-not-use-percent-change-believing-that-percents-account-for-effects-of-initial-weights"><i class="fa fa-check"></i><b>14.4.3</b> Do not use percent change, believing that percents account for effects of initial weights</a></li>
<li class="chapter" data-level="14.4.4" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#do-not-test-for-balance-of-baseline-measures"><i class="fa fa-check"></i><b>14.4.4</b> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><i class="fa fa-check"></i><b>14.5</b> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html"><i class="fa fa-check"></i><b>15</b> Two (or more) Categorical <span class="math inline">\(X\)</span> – Factorial designs</a><ul>
<li class="chapter" data-level="15.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#factorial-experiments"><i class="fa fa-check"></i><b>15.1</b> Factorial experiments</a><ul>
<li class="chapter" data-level="15.1.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#model-coefficients-an-interaction-effect-is-what-is-leftover-after-adding-the-treatment-effects-to-the-control"><i class="fa fa-check"></i><b>15.1.1</b> Model coefficients: an interaction effect is what is leftover after adding the treatment effects to the control</a></li>
<li class="chapter" data-level="15.1.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#what-is-the-biological-meaning-of-an-interaction-effect"><i class="fa fa-check"></i><b>15.1.2</b> What is the biological meaning of an interaction effect?</a></li>
<li class="chapter" data-level="15.1.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#the-interpretation-of-the-coefficients-in-a-factorial-model-is-entirely-dependent-on-the-reference"><i class="fa fa-check"></i><b>15.1.3</b> The interpretation of the coefficients in a factorial model is entirely dependent on the reference…</a></li>
<li class="chapter" data-level="15.1.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#estimated-marginal-means"><i class="fa fa-check"></i><b>15.1.4</b> Estimated marginal means</a></li>
<li class="chapter" data-level="15.1.5" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#in-a-factorial-model-there-are-multiple-effects-of-each-factor-simple-effects"><i class="fa fa-check"></i><b>15.1.5</b> In a factorial model, there are multiple effects of each factor (simple effects)</a></li>
<li class="chapter" data-level="15.1.6" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#marginal-effects"><i class="fa fa-check"></i><b>15.1.6</b> Marginal effects</a></li>
<li class="chapter" data-level="15.1.7" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#the-additive-model"><i class="fa fa-check"></i><b>15.1.7</b> The additive model</a></li>
<li class="chapter" data-level="15.1.8" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#reduce-models-for-the-right-reason"><i class="fa fa-check"></i><b>15.1.8</b> Reduce models for the right reason</a></li>
<li class="chapter" data-level="15.1.9" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#what-about-models-with-more-than-two-factors"><i class="fa fa-check"></i><b>15.1.9</b> What about models with more than two factors?</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#reporting-results-1"><i class="fa fa-check"></i><b>15.2</b> Reporting results</a><ul>
<li class="chapter" data-level="15.2.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#text-results"><i class="fa fa-check"></i><b>15.2.1</b> Text results</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#working-in-r-4"><i class="fa fa-check"></i><b>15.3</b> Working in R</a><ul>
<li class="chapter" data-level="15.3.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#model-formula"><i class="fa fa-check"></i><b>15.3.1</b> Model formula</a></li>
<li class="chapter" data-level="15.3.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#modeled-means"><i class="fa fa-check"></i><b>15.3.2</b> Modeled means</a></li>
<li class="chapter" data-level="15.3.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#marginal-means"><i class="fa fa-check"></i><b>15.3.3</b> Marginal means</a></li>
<li class="chapter" data-level="15.3.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#contrasts"><i class="fa fa-check"></i><b>15.3.4</b> Contrasts</a></li>
<li class="chapter" data-level="15.3.5" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#simple-effects"><i class="fa fa-check"></i><b>15.3.5</b> Simple effects</a></li>
<li class="chapter" data-level="15.3.6" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#marginal-effects-1"><i class="fa fa-check"></i><b>15.3.6</b> Marginal effects</a></li>
<li class="chapter" data-level="15.3.7" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#plotting-results"><i class="fa fa-check"></i><b>15.3.7</b> Plotting results</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#problems-1"><i class="fa fa-check"></i><b>15.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="anova-tables.html"><a href="anova-tables.html"><i class="fa fa-check"></i><b>16</b> ANOVA Tables</a><ul>
<li class="chapter" data-level="16.1" data-path="anova-tables.html"><a href="anova-tables.html#summary-of-usage"><i class="fa fa-check"></i><b>16.1</b> Summary of usage</a></li>
<li class="chapter" data-level="16.2" data-path="anova-tables.html"><a href="anova-tables.html#example-a-one-way-anova-using-the-vole-data"><i class="fa fa-check"></i><b>16.2</b> Example: a one-way ANOVA using the vole data</a></li>
<li class="chapter" data-level="16.3" data-path="anova-tables.html"><a href="anova-tables.html#example-a-two-way-anova-using-the-urchin-data"><i class="fa fa-check"></i><b>16.3</b> Example: a two-way ANOVA using the urchin data</a><ul>
<li class="chapter" data-level="16.3.1" data-path="anova-tables.html"><a href="anova-tables.html#how-to-read-an-anova-table"><i class="fa fa-check"></i><b>16.3.1</b> How to read an ANOVA table</a></li>
<li class="chapter" data-level="16.3.2" data-path="anova-tables.html"><a href="anova-tables.html#how-to-read-anova-results-reported-in-the-text"><i class="fa fa-check"></i><b>16.3.2</b> How to read ANOVA results reported in the text</a></li>
<li class="chapter" data-level="16.3.3" data-path="anova-tables.html"><a href="anova-tables.html#better-practice-estimates-and-their-uncertainty"><i class="fa fa-check"></i><b>16.3.3</b> Better practice – estimates and their uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="anova-tables.html"><a href="anova-tables.html#unbalanced-designs"><i class="fa fa-check"></i><b>16.4</b> Unbalanced designs</a><ul>
<li class="chapter" data-level="16.4.1" data-path="anova-tables.html"><a href="anova-tables.html#what-is-going-on-in-unbalanced-anova-type-i-ii-iii-sum-of-squares"><i class="fa fa-check"></i><b>16.4.1</b> What is going on in unbalanced ANOVA? – Type I, II, III sum of squares</a></li>
<li class="chapter" data-level="16.4.2" data-path="anova-tables.html"><a href="anova-tables.html#back-to-interpretation-of-main-effects"><i class="fa fa-check"></i><b>16.4.2</b> Back to interpretation of main effects</a></li>
<li class="chapter" data-level="16.4.3" data-path="anova-tables.html"><a href="anova-tables.html#the-anova-tables-for-type-i-ii-and-iii-sum-of-squares-are-the-same-if-the-design-is-balanced."><i class="fa fa-check"></i><b>16.4.3</b> The anova tables for Type I, II, and III sum of squares are the same if the design is balanced.</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="anova-tables.html"><a href="anova-tables.html#working-in-r-5"><i class="fa fa-check"></i><b>16.5</b> Working in R</a><ul>
<li class="chapter" data-level="16.5.1" data-path="anova-tables.html"><a href="anova-tables.html#type-i-sum-of-squares-in-r"><i class="fa fa-check"></i><b>16.5.1</b> Type I sum of squares in R</a></li>
<li class="chapter" data-level="16.5.2" data-path="anova-tables.html"><a href="anova-tables.html#type-ii-and-iii-sum-of-squares"><i class="fa fa-check"></i><b>16.5.2</b> Type II and III Sum of Squares</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="predictive-models.html"><a href="predictive-models.html"><i class="fa fa-check"></i><b>17</b> Predictive Models</a><ul>
<li class="chapter" data-level="17.1" data-path="predictive-models.html"><a href="predictive-models.html#overfitting"><i class="fa fa-check"></i><b>17.1</b> Overfitting</a></li>
<li class="chapter" data-level="17.2" data-path="predictive-models.html"><a href="predictive-models.html#model-building-vs.-variable-selection-vs.-model-selection"><i class="fa fa-check"></i><b>17.2</b> Model building vs. Variable selection vs. Model selection</a><ul>
<li class="chapter" data-level="17.2.1" data-path="predictive-models.html"><a href="predictive-models.html#stepwise-regression"><i class="fa fa-check"></i><b>17.2.1</b> Stepwise regression</a></li>
<li class="chapter" data-level="17.2.2" data-path="predictive-models.html"><a href="predictive-models.html#cross-validation"><i class="fa fa-check"></i><b>17.2.2</b> Cross-validation</a></li>
<li class="chapter" data-level="17.2.3" data-path="predictive-models.html"><a href="predictive-models.html#penalization"><i class="fa fa-check"></i><b>17.2.3</b> Penalization</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="predictive-models.html"><a href="predictive-models.html#shrinkage"><i class="fa fa-check"></i><b>17.3</b> Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"><a href="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"><i class="fa fa-check"></i>Part V: Expanding the Linear Model – Generalized Linear Models and Multilevel (Linear Mixed) Models</a></li>
<li class="chapter" data-level="18" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html"><i class="fa fa-check"></i><b>18</b> Linear mixed models</a><ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#random-effects"><i class="fa fa-check"></i><b>18.1</b> Random effects</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#random-effects-in-statistical-models"><i class="fa fa-check"></i><b>18.2</b> Random effects in statistical models</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#linear-mixed-models-are-flexible"><i class="fa fa-check"></i><b>18.3</b> Linear mixed models are flexible</a></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#blocking"><i class="fa fa-check"></i><b>18.4</b> Blocking</a><ul>
<li class="chapter" data-level="18.4.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#visualing-variation-due-to-blocks"><i class="fa fa-check"></i><b>18.4.1</b> Visualing variation due to blocks</a></li>
<li class="chapter" data-level="18.4.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#blocking-increases-precision-of-point-estimates"><i class="fa fa-check"></i><b>18.4.2</b> Blocking increases precision of point estimates</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#pseudoreplication"><i class="fa fa-check"></i><b>18.5</b> Pseudoreplication</a><ul>
<li class="chapter" data-level="18.5.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#visualizing-pseduoreplication"><i class="fa fa-check"></i><b>18.5.1</b> Visualizing pseduoreplication</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#mapping-nhst-to-estimation-a-paired-t-test-is-a-special-case-of-a-linear-mixed-model"><i class="fa fa-check"></i><b>18.6</b> Mapping NHST to estimation: A paired t-test is a special case of a linear mixed model</a></li>
<li class="chapter" data-level="18.7" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#advanced-topic-linear-mixed-models-shrink-coefficients-by-partial-pooling"><i class="fa fa-check"></i><b>18.7</b> Advanced topic – Linear mixed models shrink coefficients by partial pooling</a></li>
<li class="chapter" data-level="18.8" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#working-in-r-6"><i class="fa fa-check"></i><b>18.8</b> Working in R</a><ul>
<li class="chapter" data-level="18.8.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#coral-data"><i class="fa fa-check"></i><b>18.8.1</b> coral data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html"><i class="fa fa-check"></i><b>19</b> Generalized linear models I: Count data</a><ul>
<li class="chapter" data-level="19.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#the-generalized-linear-model"><i class="fa fa-check"></i><b>19.1</b> The generalized linear model</a></li>
<li class="chapter" data-level="19.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish"><i class="fa fa-check"></i><b>19.2</b> Count data example – number of trematode worm larvae in eyes of threespine stickleback fish</a><ul>
<li class="chapter" data-level="19.2.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#modeling-strategy-1"><i class="fa fa-check"></i><b>19.2.1</b> Modeling strategy</a></li>
<li class="chapter" data-level="19.2.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#checking-the-model-i-a-normal-q-q-plot"><i class="fa fa-check"></i><b>19.2.2</b> Checking the model I – a Normal Q-Q plot</a></li>
<li class="chapter" data-level="19.2.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#checking-the-model-ii-scale-location-plot-for-checking-homoskedasticity"><i class="fa fa-check"></i><b>19.2.3</b> Checking the model II – scale-location plot for checking homoskedasticity</a></li>
<li class="chapter" data-level="19.2.4" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#two-distributions-for-count-data-poisson-and-negative-binomial"><i class="fa fa-check"></i><b>19.2.4</b> Two distributions for count data – Poisson and Negative Binomial</a></li>
<li class="chapter" data-level="19.2.5" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-with-a-poisson-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>19.2.5</b> Fitting a GLM with a Poisson distribution to the worm data</a></li>
<li class="chapter" data-level="19.2.6" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#model-checking-fits-to-count-data"><i class="fa fa-check"></i><b>19.2.6</b> Model checking fits to count data</a></li>
<li class="chapter" data-level="19.2.7" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-with-a-negative-binomial-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>19.2.7</b> Fitting a GLM with a Negative Binomial distribution to the worm data</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#working-in-r-7"><i class="fa fa-check"></i><b>19.3</b> Working in R</a><ul>
<li class="chapter" data-level="19.3.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-to-count-data"><i class="fa fa-check"></i><b>19.3.1</b> Fitting a GLM to count data</a></li>
<li class="chapter" data-level="19.3.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-generalized-linear-mixed-model-glmm-to-count-data"><i class="fa fa-check"></i><b>19.3.2</b> Fitting a generalized linear mixed model (GLMM) to count data</a></li>
<li class="chapter" data-level="19.3.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-generalized-linear-model-to-continouus-data"><i class="fa fa-check"></i><b>19.3.3</b> Fitting a generalized linear model to continouus data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#problems-2"><i class="fa fa-check"></i><b>19.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="linear-models-with-heterogenous-variance.html"><a href="linear-models-with-heterogenous-variance.html"><i class="fa fa-check"></i><b>20</b> Linear models with heterogenous variance</a><ul>
<li class="chapter" data-level="20.1" data-path="linear-models-with-heterogenous-variance.html"><a href="linear-models-with-heterogenous-variance.html#gls"><i class="fa fa-check"></i><b>20.1</b> gls</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html"><i class="fa fa-check"></i>Appendix 1: Getting Started with R</a><ul>
<li class="chapter" data-level="20.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready"><i class="fa fa-check"></i><b>20.2</b> Get your computer ready</a><ul>
<li class="chapter" data-level="20.2.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r"><i class="fa fa-check"></i><b>20.2.1</b> Install R</a></li>
<li class="chapter" data-level="20.2.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-studio"><i class="fa fa-check"></i><b>20.2.2</b> Install R Studio</a></li>
<li class="chapter" data-level="20.2.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#resources-for-installing-r-and-r-studio"><i class="fa fa-check"></i><b>20.2.3</b> Resources for installing R and R Studio</a></li>
<li class="chapter" data-level="20.2.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-latex"><i class="fa fa-check"></i><b>20.2.4</b> Install LaTeX</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-learning"><i class="fa fa-check"></i><b>20.3</b> Start learning</a><ul>
<li class="chapter" data-level="20.3.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-with-data-camp-introduction-to-r"><i class="fa fa-check"></i><b>20.3.1</b> Start with Data Camp Introduction to R</a></li>
<li class="chapter" data-level="20.3.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#then-move-to-introduction-to-r-studio"><i class="fa fa-check"></i><b>20.3.2</b> Then Move to Introduction to R Studio</a></li>
<li class="chapter" data-level="20.3.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#develop-your-project-with-an-r-studio-notebook"><i class="fa fa-check"></i><b>20.3.3</b> Develop your project with an R Studio Notebook</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#getting-data-into-r"><i class="fa fa-check"></i><b>20.4</b> Getting Data into R</a></li>
<li class="chapter" data-level="20.5" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#additional-r-learning-resources"><i class="fa fa-check"></i><b>20.5</b> Additional R learning resources</a></li>
<li class="chapter" data-level="20.6" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#packages-used-extensively-in-this-text"><i class="fa fa-check"></i><b>20.6</b> Packages used extensively in this text</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><i class="fa fa-check"></i>Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="chapter" data-level="" data-path="appendix-3-fake-data-simulations.html"><a href="appendix-3-fake-data-simulations.html"><i class="fa fa-check"></i>Appendix 3: Fake Data Simulations</a><ul>
<li class="chapter" data-level="20.7" data-path="appendix-3-fake-data-simulations.html"><a href="appendix-3-fake-data-simulations.html#performance-of-blocking-relative-to-a-linear-model"><i class="fa fa-check"></i><b>20.7</b> Performance of Blocking relative to a linear model</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Elements of Statistical Modeling for Experimental Biology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="creating-fake-data" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Creating Fake Data</h1>
<p>Fake data are generated by sampling from one of R’s random sampling functions. These functions sample from different distributions including</p>
<ol style="list-style-type: decimal">
<li>uniform – function <code>runif(n, min=0, max=1)</code>, which samples n continous values between <code>min</code> and <code>max</code>.</li>
<li>normal (Gaussian) – function <code>rnorm(n, mean=0, sd=1)</code>, which samples n continous values from a distribution with the specified mean and standard deviation. The default is the “standard” normal distribution.</li>
<li>poisson – function <code>rpois(n, lambda)</code>, which samples <code>n</code> counts from a distribution with mean and variance equal to <code>lambda</code>.</li>
<li>negative binomial – <code>rnegbin(n, mu=n, theta)</code>, which samples <code>n</code> counts with mean <code>mu</code> and variance <code>mu + mu^2/theta</code>.</li>
</ol>
<div id="continuous-x-fake-observational-data" class="section level3">
<h3><span class="header-section-number">7.0.1</span> Continuous X (fake observational data)</h3>
<p>A very simple simulation of observational design (the <span class="math inline">\(X\)</span> are not at “controlled” levels)</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="creating-fake-data.html#cb124-1"></a>n &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb124-2"><a href="creating-fake-data.html#cb124-2"></a><span class="co"># the paramters</span></span>
<span id="cb124-3"><a href="creating-fake-data.html#cb124-3"></a>beta_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="dv">25</span> <span class="co"># the true intercept</span></span>
<span id="cb124-4"><a href="creating-fake-data.html#cb124-4"></a>beta_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="fl">3.4</span> <span class="co"># the true slope</span></span>
<span id="cb124-5"><a href="creating-fake-data.html#cb124-5"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># the true standard deviation</span></span>
<span id="cb124-6"><a href="creating-fake-data.html#cb124-6"></a></span>
<span id="cb124-7"><a href="creating-fake-data.html#cb124-7"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</span>
<span id="cb124-8"><a href="creating-fake-data.html#cb124-8"></a>y &lt;-<span class="st"> </span>beta_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>beta_<span class="dv">1</span><span class="op">*</span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">sd=</span>sigma)</span>
<span id="cb124-9"><a href="creating-fake-data.html#cb124-9"></a><span class="kw">qplot</span>(x, y)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-X-1.png" width="576" /></p>
<p>How well does a model fit to the data recover the true parameters?</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="creating-fake-data.html#cb125-1"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb125-2"><a href="creating-fake-data.html#cb125-2"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">coefficients</span>(<span class="kw">summary</span>(fit)), <span class="dt">digits=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">4</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="right">25.8</td>
<td align="right">0.34</td>
<td align="right">75.8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>x</td>
<td align="right">4.2</td>
<td align="right">0.40</td>
<td align="right">10.4</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>The coefficient of <span class="math inline">\(x\)</span> is the “Estimate”. How close is the estimate? Run the simulation several times to look at the variation in the estimate – this will give you a sense of the uncertainty. Increase <span class="math inline">\(n\)</span> and explore this uncertainty. Increase all the way up to <span class="math inline">\(n=10^5\)</span>. Commenting out the qplot line will make this exploration easier.</p>
</div>
<div id="categorical-x-fake-experimental-data" class="section level3">
<h3><span class="header-section-number">7.0.2</span> Categorical X (fake experimental data)</h3>
<p>Similar to above but the <span class="math inline">\(X\)</span> are at controlled levels and so this simulates an experimental design</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="creating-fake-data.html#cb126-1"></a>n &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co"># the sample size per treatment level</span></span>
<span id="cb126-2"><a href="creating-fake-data.html#cb126-2"></a></span>
<span id="cb126-3"><a href="creating-fake-data.html#cb126-3"></a>fake_data &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">Treatment=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;treated&quot;</span>), <span class="dt">each=</span>n))</span>
<span id="cb126-4"><a href="creating-fake-data.html#cb126-4"></a>beta_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="fl">10.5</span> <span class="co"># mean of untreated</span></span>
<span id="cb126-5"><a href="creating-fake-data.html#cb126-5"></a>beta_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="fl">2.1</span> <span class="co"># difference in means (treated - untreated)</span></span>
<span id="cb126-6"><a href="creating-fake-data.html#cb126-6"></a>sigma &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co"># the error standard deviation</span></span>
<span id="cb126-7"><a href="creating-fake-data.html#cb126-7"></a><span class="co"># the Y variable (&quot;Response&quot;) is a function of treatment. We use some matrix</span></span>
<span id="cb126-8"><a href="creating-fake-data.html#cb126-8"></a><span class="co"># algebra to get this done.</span></span>
<span id="cb126-9"><a href="creating-fake-data.html#cb126-9"></a><span class="co"># Turn the Treatment assignment into a model matrix. Take a peak at X!</span></span>
<span id="cb126-10"><a href="creating-fake-data.html#cb126-10"></a>X &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="st"> </span>Treatment, fake_data)</span>
<span id="cb126-11"><a href="creating-fake-data.html#cb126-11"></a><span class="co"># to make the math easier the coefficients are collected into a vector</span></span>
<span id="cb126-12"><a href="creating-fake-data.html#cb126-12"></a>beta &lt;-<span class="st"> </span><span class="kw">c</span>(beta_<span class="dv">0</span>, beta_<span class="dv">1</span>)</span>
<span id="cb126-13"><a href="creating-fake-data.html#cb126-13"></a><span class="co"># you will see the formula Y=Xb many times. Here it is coded in R</span></span>
<span id="cb126-14"><a href="creating-fake-data.html#cb126-14"></a>fake_data[, Response<span class="op">:</span><span class="er">=</span>X<span class="op">%*%</span>beta <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">sd=</span>sigma)]</span>
<span id="cb126-15"><a href="creating-fake-data.html#cb126-15"></a><span class="co"># plot it with a strip chart (often called a &quot;dot plot&quot;)</span></span>
<span id="cb126-16"><a href="creating-fake-data.html#cb126-16"></a><span class="kw">ggstripchart</span>(<span class="dt">data=</span>fake_data, <span class="dt">x=</span><span class="st">&quot;Treatment&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Response&quot;</span>, <span class="dt">add =</span> <span class="kw">c</span>(<span class="st">&quot;mean_se&quot;</span>))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/categorical-X-1.png" width="576" /></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="creating-fake-data.html#cb127-1"></a><span class="co"># fit using base R linear model function</span></span>
<span id="cb127-2"><a href="creating-fake-data.html#cb127-2"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Response <span class="op">~</span><span class="st"> </span>Treatment, <span class="dt">data=</span>fake_data)</span>
<span id="cb127-3"><a href="creating-fake-data.html#cb127-3"></a><span class="co"># display a pretty table of the coefficients</span></span>
<span id="cb127-4"><a href="creating-fake-data.html#cb127-4"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">coefficients</span>(<span class="kw">summary</span>(fit)), <span class="dt">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="right">11.626</td>
<td align="right">1.097</td>
<td align="right">10.601</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td>Treatmenttreated</td>
<td align="right">2.100</td>
<td align="right">1.551</td>
<td align="right">1.354</td>
<td align="right">0.213</td>
</tr>
</tbody>
</table>
<p>Check that the intercept is close to beta_0 and the coefficient for Treatment is close to beta_1. This coefficient is the difference in means between the treatment levels. It is the simulated effect. Again, change <span class="math inline">\(n\)</span>. Good values are <span class="math inline">\(n=20\)</span> and <span class="math inline">\(n=100\)</span>. Again, comment out the plot line to make exploration more efficient.</p>
</div>
<div id="correlated-x-fake-observational-data" class="section level3">
<h3><span class="header-section-number">7.0.3</span> Correlated X (fake observational data)</h3>
<div id="generating-correlated-x-variables" class="section level4">
<h4><span class="header-section-number">7.0.3.1</span> Generating correlated X variables</h4>
<p>It’s useful to think about how correlated data are generated because often we want to generate fake_data with an expected correlation. Let’s say we want to generate two X variables that have an expected correlation of 0.6. To generate this, we take advantage of the fact that two variables, X1 and X2, are correlated if they share a “common cause” – a variable Z that effects (or “causes”) both X1 and X2. If the expected variances of X1, X2, and Z are all 1, then the expected correlation between X1 and X2 is the product of the causal effect from Z to each X. The easiest way to implement this is to simply make the effect from Z to both X equal to <span class="math inline">\(\sqrt(0.6)\)</span>.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="creating-fake-data.html#cb128-1"></a>n &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">3</span></span>
<span id="cb128-2"><a href="creating-fake-data.html#cb128-2"></a>z &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n) <span class="co"># the common cause, with sigma = 1</span></span>
<span id="cb128-3"><a href="creating-fake-data.html#cb128-3"></a>rho &lt;-<span class="st"> </span><span class="fl">0.6</span> <span class="co"># the true correlation between X1 and X2</span></span>
<span id="cb128-4"><a href="creating-fake-data.html#cb128-4"></a>beta_z &lt;-<span class="st"> </span><span class="kw">sqrt</span>(rho) <span class="co"># the easiest way to get effects of z on X1 and X2 that generates rho</span></span>
<span id="cb128-5"><a href="creating-fake-data.html#cb128-5"></a>sigma_x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>rho) <span class="co"># we will make the variance of X1 and X2 = 1, so the &quot;explained&quot; variance in X is beta_z^2 = rho so this is the sqrt of the unexplained variance</span></span>
<span id="cb128-6"><a href="creating-fake-data.html#cb128-6"></a>x1 &lt;-<span class="st"> </span>beta_z<span class="op">*</span>z <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">sd=</span>sigma_x)</span>
<span id="cb128-7"><a href="creating-fake-data.html#cb128-7"></a>x2 &lt;-<span class="st"> </span>beta_z<span class="op">*</span>z <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">sd=</span>sigma_x)</span>
<span id="cb128-8"><a href="creating-fake-data.html#cb128-8"></a><span class="co"># check</span></span>
<span id="cb128-9"><a href="creating-fake-data.html#cb128-9"></a><span class="kw">cov</span>(<span class="kw">data.frame</span>(<span class="dt">X1=</span>x1, <span class="dt">X2=</span>x2)) <span class="co"># is the diagonal close to 1, 1?</span></span></code></pre></div>
<pre><code>##           X1        X2
## X1 1.0523598 0.5978408
## X2 0.5978408 0.9713292</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="creating-fake-data.html#cb130-1"></a><span class="kw">cor</span>(x1, x2) <span class="co"># is the value close to rho?</span></span></code></pre></div>
<pre><code>## [1] 0.5913168</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="creating-fake-data.html#cb132-1"></a><span class="kw">qplot</span>(x1, x2)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-59-1.png" width="576" /></p>
<p>Now create fake <span class="math inline">\(Y\)</span> that is a function of both <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>. Create “standardized” fake data, where <span class="math inline">\(\sigma_Y = 1\)</span>.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="creating-fake-data.html#cb133-1"></a>beta_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="fl">3.2</span></span>
<span id="cb133-2"><a href="creating-fake-data.html#cb133-2"></a>beta_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="fl">0.7</span></span>
<span id="cb133-3"><a href="creating-fake-data.html#cb133-3"></a>beta_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="fl">-0.3</span></span>
<span id="cb133-4"><a href="creating-fake-data.html#cb133-4"></a>explained_sigma &lt;-<span class="st"> </span>beta_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>beta_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>beta_<span class="dv">1</span><span class="op">*</span>beta_<span class="dv">2</span><span class="op">*</span>rho <span class="co"># Wright&#39;s rules! Compare to Trig!</span></span>
<span id="cb133-5"><a href="creating-fake-data.html#cb133-5"></a>sigma_Y.X &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>explained_sigma) <span class="co"># sqrt unexplained variance</span></span>
<span id="cb133-6"><a href="creating-fake-data.html#cb133-6"></a>y &lt;-<span class="st"> </span>beta_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>beta_<span class="dv">1</span><span class="op">*</span>x1 <span class="op">+</span><span class="st"> </span>beta_<span class="dv">2</span><span class="op">*</span>x2 <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">sd=</span>sigma_Y.X)</span>
<span id="cb133-7"><a href="creating-fake-data.html#cb133-7"></a></span>
<span id="cb133-8"><a href="creating-fake-data.html#cb133-8"></a><span class="co"># check</span></span>
<span id="cb133-9"><a href="creating-fake-data.html#cb133-9"></a><span class="kw">var</span>(y) <span class="co"># should be close to 1 as n gets bigger</span></span></code></pre></div>
<pre><code>## [1] 0.9791502</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="creating-fake-data.html#cb135-1"></a><span class="co"># check parameters</span></span>
<span id="cb135-2"><a href="creating-fake-data.html#cb135-2"></a><span class="kw">coef</span>(<span class="kw">summary</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2))) <span class="co"># should be near parameters as n gets bigger</span></span></code></pre></div>
<pre><code>##               Estimate Std. Error    t value     Pr(&gt;|t|)
## (Intercept)  3.1887712 0.02536483 125.716255 0.000000e+00
## x1           0.6885565 0.03064195  22.471043 8.422461e-91
## x2          -0.3037457 0.03189446  -9.523465 1.223898e-20</code></pre>
<p>Note that the variance of <span class="math inline">\(Y\)</span> is the variance of the explained part due to X1 and X2 and the unexplained part and if the expected variance of <span class="math inline">\(Y=1\)</span> then this sets an upper limit for the explained part. This means that</p>
<p><span class="math display">\[\begin{equation}
\beta_1^2 + \beta_2^2 + 2 \beta_1 \beta_2 \rho &lt; 1
\end{equation}\]</span></p>
<p>which means the magnitude of <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> should generally be less than 1.</p>
</div>
<div id="creating-mulitple-x-variables-using-the-package-mvtnorm" class="section level4">
<h4><span class="header-section-number">7.0.3.2</span> Creating mulitple X variables using the package mvtnorm</h4>
<p>The package mvtnorm provides a function to generate multivariate data (multiple columns) with a specified vector of means (the means of each column) and covariance matrix among the means.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="creating-fake-data.html#cb137-1"></a>rcov1 &lt;-<span class="st"> </span><span class="cf">function</span>(p){</span>
<span id="cb137-2"><a href="creating-fake-data.html#cb137-2"></a>  <span class="co"># p is the number of columns or number of variables</span></span>
<span id="cb137-3"><a href="creating-fake-data.html#cb137-3"></a>  pp &lt;-<span class="st"> </span>p<span class="op">*</span>(p<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span> <span class="co"># number of elements in lower tri</span></span>
<span id="cb137-4"><a href="creating-fake-data.html#cb137-4"></a>  max_r &lt;-<span class="st"> </span><span class="fl">0.7</span></span>
<span id="cb137-5"><a href="creating-fake-data.html#cb137-5"></a>  r &lt;-<span class="st"> </span><span class="kw">rexp</span>(pp)</span>
<span id="cb137-6"><a href="creating-fake-data.html#cb137-6"></a>  r &lt;-<span class="st"> </span>r<span class="op">*</span>max_r<span class="op">/</span><span class="kw">max</span>(r)</span>
<span id="cb137-7"><a href="creating-fake-data.html#cb137-7"></a>  </span>
<span id="cb137-8"><a href="creating-fake-data.html#cb137-8"></a>  <span class="co"># create correlation matrix</span></span>
<span id="cb137-9"><a href="creating-fake-data.html#cb137-9"></a>  R &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>, <span class="dt">nrow=</span>p, <span class="dt">ncol=</span>p)</span>
<span id="cb137-10"><a href="creating-fake-data.html#cb137-10"></a>  R[<span class="kw">lower.tri</span>(R, <span class="dt">diag=</span><span class="ot">FALSE</span>)] &lt;-<span class="st"> </span>r</span>
<span id="cb137-11"><a href="creating-fake-data.html#cb137-11"></a>  R &lt;-<span class="st"> </span><span class="kw">t</span>(R)</span>
<span id="cb137-12"><a href="creating-fake-data.html#cb137-12"></a>  R[<span class="kw">lower.tri</span>(R, <span class="dt">diag=</span><span class="ot">FALSE</span>)] &lt;-<span class="st"> </span>r</span>
<span id="cb137-13"><a href="creating-fake-data.html#cb137-13"></a>  </span>
<span id="cb137-14"><a href="creating-fake-data.html#cb137-14"></a>  <span class="co"># convert to covariance matrix</span></span>
<span id="cb137-15"><a href="creating-fake-data.html#cb137-15"></a>  L &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(<span class="kw">rexp</span>(p))) <span class="co"># standard deviations</span></span>
<span id="cb137-16"><a href="creating-fake-data.html#cb137-16"></a>  S &lt;-<span class="st"> </span>L<span class="op">%*%</span>R<span class="op">%*%</span>L</span>
<span id="cb137-17"><a href="creating-fake-data.html#cb137-17"></a>  </span>
<span id="cb137-18"><a href="creating-fake-data.html#cb137-18"></a>  <span class="co"># check -- these should be the same</span></span>
<span id="cb137-19"><a href="creating-fake-data.html#cb137-19"></a>  <span class="co"># R</span></span>
<span id="cb137-20"><a href="creating-fake-data.html#cb137-20"></a>  <span class="co"># cov2cor(S)</span></span>
<span id="cb137-21"><a href="creating-fake-data.html#cb137-21"></a>  <span class="kw">return</span>(S)</span>
<span id="cb137-22"><a href="creating-fake-data.html#cb137-22"></a>}</span></code></pre></div>
<p>Now let’s use mvtnorm to generate fake correlated X</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="creating-fake-data.html#cb138-1"></a>p &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co"># number of X variables</span></span>
<span id="cb138-2"><a href="creating-fake-data.html#cb138-2"></a>S &lt;-<span class="st"> </span><span class="kw">rcov1</span>(p)</span>
<span id="cb138-3"><a href="creating-fake-data.html#cb138-3"></a></span>
<span id="cb138-4"><a href="creating-fake-data.html#cb138-4"></a><span class="co"># make the fake X</span></span>
<span id="cb138-5"><a href="creating-fake-data.html#cb138-5"></a>n &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">5</span></span>
<span id="cb138-6"><a href="creating-fake-data.html#cb138-6"></a>mu &lt;-<span class="st"> </span><span class="kw">runif</span>(p, <span class="dt">min=</span><span class="dv">10</span>, <span class="dt">max=</span><span class="dv">100</span>) <span class="co"># vecctor of p means</span></span>
<span id="cb138-7"><a href="creating-fake-data.html#cb138-7"></a>X &lt;-<span class="st"> </span><span class="kw">rmvnorm</span>(n, <span class="dt">mean=</span>mu, <span class="dt">sigma=</span>S)</span>
<span id="cb138-8"><a href="creating-fake-data.html#cb138-8"></a></span>
<span id="cb138-9"><a href="creating-fake-data.html#cb138-9"></a><span class="co"># how close? (check the cor as this is easier to scan)</span></span>
<span id="cb138-10"><a href="creating-fake-data.html#cb138-10"></a><span class="kw">cov2cor</span>(S)</span></code></pre></div>
<pre><code>##           [,1]       [,2]       [,3]       [,4]       [,5]
## [1,] 1.0000000 0.15511020 0.11863165 0.48788949 0.14545246
## [2,] 0.1551102 1.00000000 0.70000000 0.03514487 0.04345391
## [3,] 0.1186317 0.70000000 1.00000000 0.05346376 0.54083807
## [4,] 0.4878895 0.03514487 0.05346376 1.00000000 0.44504979
## [5,] 0.1454525 0.04345391 0.54083807 0.44504979 1.00000000</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="creating-fake-data.html#cb140-1"></a><span class="kw">cor</span>(X)</span></code></pre></div>
<pre><code>##           [,1]       [,2]       [,3]       [,4]       [,5]
## [1,] 1.0000000 0.15618693 0.12146387 0.48987841 0.14569745
## [2,] 0.1561869 1.00000000 0.69709529 0.03879653 0.03961509
## [3,] 0.1214639 0.69709529 1.00000000 0.05598629 0.54138395
## [4,] 0.4898784 0.03879653 0.05598629 1.00000000 0.44214983
## [5,] 0.1456974 0.03961509 0.54138395 0.44214983 1.00000000</code></pre>
</div>
<div id="the-rcov1-algorithm-is-naive" class="section level4">
<h4><span class="header-section-number">7.0.3.3</span> The rcov1 algorithm is naive</h4>
<p>A problem with generating a fake covariance matrix as above is that it is likely to be <strong>singular</strong> as <span class="math inline">\(p\)</span> get’s bigger. A singular covariance matrix is one where there are fewer orthogonal axes of variation then there are variables. Imagine a multidimensional scatterplot of a data set with the fake covariance matrix. If we zoom around this multidimensional space, we will come across a “view” in which all the points are compressed along a single line – that is there is no variation on the axis orthogonal to this line of points. This is bad, as it means we cannot fit a linear model using least squares (because the inverse of the covariance matrix doesn’t exist).</p>
<p>Let’s explore this. If the a covariance matrix is singular, then at least one eigenvalue of the matrix is negative (eigenvalues is a multivariate term beyond the scope of this text but, effectively, these are the variances of the orthogonal axes referred to above). Here I compute the frequency of covariance matrices with at least one negative eigenvalue as <span class="math inline">\(p\)</span> increases</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="creating-fake-data.html#cb142-1"></a>niter &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb142-2"><a href="creating-fake-data.html#cb142-2"></a>p_vec &lt;-<span class="st"> </span><span class="dv">3</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb142-3"><a href="creating-fake-data.html#cb142-3"></a>counts &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(p_vec))</span>
<span id="cb142-4"><a href="creating-fake-data.html#cb142-4"></a>i &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb142-5"><a href="creating-fake-data.html#cb142-5"></a><span class="cf">for</span>(p <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span><span class="dv">10</span>){</span>
<span id="cb142-6"><a href="creating-fake-data.html#cb142-6"></a>  i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb142-7"><a href="creating-fake-data.html#cb142-7"></a>  <span class="cf">for</span>(iter <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>niter){</span>
<span id="cb142-8"><a href="creating-fake-data.html#cb142-8"></a>    counts[i] &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">eigen</span>(<span class="kw">rcov1</span>(p))<span class="op">$</span>values[p] <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>, counts[i]<span class="op">+</span><span class="dv">1</span>, counts[i])</span>
<span id="cb142-9"><a href="creating-fake-data.html#cb142-9"></a>  }</span>
<span id="cb142-10"><a href="creating-fake-data.html#cb142-10"></a>}</span>
<span id="cb142-11"><a href="creating-fake-data.html#cb142-11"></a><span class="kw">data.table</span>(<span class="dt">p=</span>p_vec, <span class="dt">freq=</span>counts<span class="op">/</span>niter)</span></code></pre></div>
<pre><code>##     p  freq
## 1:  3 0.000
## 2:  4 0.025
## 3:  5 0.066
## 4:  6 0.135
## 5:  7 0.190
## 6:  8 0.225
## 7:  9 0.275
## 8: 10 0.368</code></pre>
</div>
<div id="generating-multiple-columns-of-x-variables-with-a-non-singular-covariance-matrix" class="section level4">
<h4><span class="header-section-number">7.0.3.4</span> Generating multiple columns of X variables with a non-singular covariance matrix</h4>
<p>This section uses some ideas from matrix algebra. The goal is to create a <span class="math inline">\(n \times p\)</span> matrix of <span class="math inline">\(X\)</span> variables that have some random covariance structure that is full-rank (not singular, or no negative eigenvalues). The algorithm starts with a <span class="math inline">\(p \times p\)</span> random eigenvector matrix <span class="math inline">\(\mathbf{E}\)</span> and a <span class="math inline">\(p \times p\)</span> random eigenvalue matrix <span class="math inline">\(\mathbf{L}\)</span> and then computes the random covariance matrix using <span class="math inline">\(\mathbf{E}\mathbf{L}\mathbf{E}^\top\)</span></p>
<ol style="list-style-type: decimal">
<li>Generate a random <span class="math inline">\(p \times p\)</span> random eigenvector matrix from a covariance matrix of <span class="math inline">\(p \times p\)</span> matrix of random normal variables.</li>
</ol>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="creating-fake-data.html#cb144-1"></a>fake.eigenvectors &lt;-<span class="st"> </span><span class="cf">function</span>(p){</span>
<span id="cb144-2"><a href="creating-fake-data.html#cb144-2"></a>    a &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(p<span class="op">*</span>p), p, p) <span class="co"># only orthogonal if p is infinity so need to orthogonalize it</span></span>
<span id="cb144-3"><a href="creating-fake-data.html#cb144-3"></a>    a &lt;-<span class="st"> </span><span class="kw">t</span>(a)<span class="op">%*%</span>a <span class="co"># this is the sum-of-squares-and-cross-product-matrix</span></span>
<span id="cb144-4"><a href="creating-fake-data.html#cb144-4"></a>    E &lt;-<span class="st"> </span><span class="kw">eigen</span>(a)<span class="op">$</span>vectors <span class="co"># decompose to truly orthogonal columns</span></span>
<span id="cb144-5"><a href="creating-fake-data.html#cb144-5"></a>    <span class="kw">return</span>(E)</span>
<span id="cb144-6"><a href="creating-fake-data.html#cb144-6"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Generate <span class="math inline">\(p\)</span> random eigenvalues in descending order and that sum to 1. There are several ways to create this sequence. Here are two:</li>
</ol>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="creating-fake-data.html#cb145-1"></a><span class="co"># force the eigenvalues to descend at a constant rate</span></span>
<span id="cb145-2"><a href="creating-fake-data.html#cb145-2"></a>fake.eigenvalues &lt;-<span class="st"> </span><span class="cf">function</span>(p, <span class="dt">m=</span>p, <span class="dt">start=</span><span class="dv">1</span>, <span class="dt">rate=</span><span class="dv">1</span>){</span>
<span id="cb145-3"><a href="creating-fake-data.html#cb145-3"></a>  <span class="co"># m is the number of positive eigenvalues</span></span>
<span id="cb145-4"><a href="creating-fake-data.html#cb145-4"></a>  <span class="co"># start and rate control the decline in the eigenvalue</span></span>
<span id="cb145-5"><a href="creating-fake-data.html#cb145-5"></a>  s &lt;-<span class="st"> </span>start<span class="op">/</span><span class="kw">seq</span>(<span class="dv">1</span><span class="op">:</span>m)<span class="op">^</span>rate</span>
<span id="cb145-6"><a href="creating-fake-data.html#cb145-6"></a>  s &lt;-<span class="st"> </span><span class="kw">c</span>(s, <span class="kw">rep</span>(<span class="dv">0</span>, p<span class="op">-</span>m)) <span class="co"># add zero eigenvalues</span></span>
<span id="cb145-7"><a href="creating-fake-data.html#cb145-7"></a>  L &lt;-<span class="st"> </span><span class="kw">diag</span>(s<span class="op">/</span><span class="kw">sum</span>(s)<span class="op">*</span>m) <span class="co"># rescale so that sum(s)=m and put into matrix,</span></span>
<span id="cb145-8"><a href="creating-fake-data.html#cb145-8"></a>  <span class="co"># which would occur if all the traits are variance standardized</span></span>
<span id="cb145-9"><a href="creating-fake-data.html#cb145-9"></a>  <span class="kw">return</span>(L)</span>
<span id="cb145-10"><a href="creating-fake-data.html#cb145-10"></a>}</span>
<span id="cb145-11"><a href="creating-fake-data.html#cb145-11"></a></span>
<span id="cb145-12"><a href="creating-fake-data.html#cb145-12"></a><span class="co"># random descent</span></span>
<span id="cb145-13"><a href="creating-fake-data.html#cb145-13"></a>fake.eigenvalues.exp &lt;-<span class="st"> </span><span class="cf">function</span>(p, <span class="dt">m=</span>p, <span class="dt">rate=</span><span class="dv">1</span>){</span>
<span id="cb145-14"><a href="creating-fake-data.html#cb145-14"></a>  <span class="co"># exponential distribution of eigenvalues</span></span>
<span id="cb145-15"><a href="creating-fake-data.html#cb145-15"></a>  <span class="co"># m is the number of positive eigenvalues</span></span>
<span id="cb145-16"><a href="creating-fake-data.html#cb145-16"></a>  <span class="co"># start and rate control the decline in the eigenvalue</span></span>
<span id="cb145-17"><a href="creating-fake-data.html#cb145-17"></a>  s &lt;-<span class="st"> </span><span class="kw">rexp</span>(m, rate)</span>
<span id="cb145-18"><a href="creating-fake-data.html#cb145-18"></a>  s &lt;-<span class="st"> </span>s[<span class="kw">order</span>(s, <span class="dt">decreasing=</span><span class="ot">TRUE</span>)] <span class="co"># re-order into descending order</span></span>
<span id="cb145-19"><a href="creating-fake-data.html#cb145-19"></a>  s &lt;-<span class="st"> </span><span class="kw">c</span>(s, <span class="kw">rep</span>(<span class="dv">0</span>, p<span class="op">-</span>m)) <span class="co"># add zero eigenvalues</span></span>
<span id="cb145-20"><a href="creating-fake-data.html#cb145-20"></a>  L &lt;-<span class="st"> </span><span class="kw">diag</span>(s<span class="op">/</span><span class="kw">sum</span>(s)<span class="op">*</span>m) <span class="co"># rescale so that sum(s)=m and put into matrix,</span></span>
<span id="cb145-21"><a href="creating-fake-data.html#cb145-21"></a>  <span class="co"># which would occur if all the traits are variance standardized</span></span>
<span id="cb145-22"><a href="creating-fake-data.html#cb145-22"></a>  <span class="kw">return</span>(L)</span>
<span id="cb145-23"><a href="creating-fake-data.html#cb145-23"></a>}</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Generate the random covariance matrix</li>
</ol>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="creating-fake-data.html#cb146-1"></a>fake.cov.matrix &lt;-<span class="st"> </span><span class="cf">function</span>(p){</span>
<span id="cb146-2"><a href="creating-fake-data.html#cb146-2"></a>    <span class="co"># p is the size of the matrix (number of cols and rows)</span></span>
<span id="cb146-3"><a href="creating-fake-data.html#cb146-3"></a>    E &lt;-<span class="st"> </span><span class="kw">fake.eigenvectors</span>(p)</span>
<span id="cb146-4"><a href="creating-fake-data.html#cb146-4"></a>    L &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="kw">fake.eigenvalues</span>(p))</span>
<span id="cb146-5"><a href="creating-fake-data.html#cb146-5"></a>    S &lt;-<span class="st"> </span>E<span class="op">%*%</span>L<span class="op">%*%</span><span class="kw">t</span>(E)</span>
<span id="cb146-6"><a href="creating-fake-data.html#cb146-6"></a>    <span class="kw">return</span>(S)</span>
<span id="cb146-7"><a href="creating-fake-data.html#cb146-7"></a>}</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Generate the random <span class="math inline">\(X\)</span> variables using <span class="math inline">\(\mathbf{X} = \mathbf{X}&#39; (\mathbf{E}\sqrt{\mathbf{L}})^\top\)</span></li>
</ol>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="creating-fake-data.html#cb147-1"></a><span class="co"># two functions to compute the random data</span></span>
<span id="cb147-2"><a href="creating-fake-data.html#cb147-2"></a>fake.X &lt;-<span class="st"> </span><span class="cf">function</span>(n,p,E,L){</span>
<span id="cb147-3"><a href="creating-fake-data.html#cb147-3"></a>  <span class="co"># n is number of observations</span></span>
<span id="cb147-4"><a href="creating-fake-data.html#cb147-4"></a>  <span class="co"># p is number of variables</span></span>
<span id="cb147-5"><a href="creating-fake-data.html#cb147-5"></a>  X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span>p),<span class="dt">nrow=</span>n,<span class="dt">ncol=</span>p) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(E<span class="op">%*%</span><span class="kw">sqrt</span>(L))</span>
<span id="cb147-6"><a href="creating-fake-data.html#cb147-6"></a>    <span class="kw">return</span>(X)</span>
<span id="cb147-7"><a href="creating-fake-data.html#cb147-7"></a>}</span></code></pre></div>
<p>An example</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="creating-fake-data.html#cb148-1"></a>n &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">5</span></span>
<span id="cb148-2"><a href="creating-fake-data.html#cb148-2"></a>p &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb148-3"><a href="creating-fake-data.html#cb148-3"></a>E &lt;-<span class="st"> </span><span class="kw">fake.eigenvectors</span>(p)</span>
<span id="cb148-4"><a href="creating-fake-data.html#cb148-4"></a>L &lt;-<span class="st"> </span><span class="kw">fake.eigenvalues</span>(p, <span class="dt">start=</span><span class="dv">1</span>, <span class="dt">rate=</span><span class="dv">1</span>)</span>
<span id="cb148-5"><a href="creating-fake-data.html#cb148-5"></a>X &lt;-<span class="st"> </span><span class="kw">fake.X</span>(n, p, E, L)</span>
<span id="cb148-6"><a href="creating-fake-data.html#cb148-6"></a><span class="kw">colnames</span>(X) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="op">:</span>p)</span>
<span id="cb148-7"><a href="creating-fake-data.html#cb148-7"></a>E</span></code></pre></div>
<pre><code>##            [,1]        [,2]        [,3]        [,4]        [,5]
## [1,]  0.4762049  0.76679336  0.02189702 -0.37886958 -0.20306443
## [2,] -0.3226816  0.26514622 -0.21147219  0.50680583 -0.72387940
## [3,]  0.6343127 -0.07414265  0.40381446  0.65434666  0.03024185
## [4,]  0.2450305 -0.53523178  0.22900376 -0.40906173 -0.65856872
## [5,] -0.4546568  0.22305882  0.85982044 -0.06406746 -0.01166667</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="creating-fake-data.html#cb150-1"></a>E &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(X))<span class="op">$</span>vectors</span>
<span id="cb150-2"><a href="creating-fake-data.html#cb150-2"></a>scores &lt;-<span class="st"> </span>X<span class="op">%*%</span>E</span>
<span id="cb150-3"><a href="creating-fake-data.html#cb150-3"></a><span class="kw">colnames</span>(scores) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;pc&quot;</span>, <span class="dv">1</span><span class="op">:</span>p)</span>
<span id="cb150-4"><a href="creating-fake-data.html#cb150-4"></a><span class="kw">cor</span>(<span class="kw">cbind</span>(X, scores))[<span class="dv">1</span><span class="op">:</span>p, (p<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(p<span class="op">*</span><span class="dv">2</span>)]</span></code></pre></div>
<pre><code>##           pc1         pc2          pc3        pc4          pc5
## X1  0.6381822  0.71536319  0.009665104  0.2581645 -0.119317350
## X2 -0.5701649  0.32632936 -0.213505507 -0.4289443 -0.582102493
## X3  0.8417769 -0.06005797  0.312645510 -0.4358132  0.011149679
## X4  0.4130194 -0.64271492  0.232581875  0.3517727 -0.488358607
## X5 -0.6579685  0.23893819  0.712352851  0.0501983 -0.004418134</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="p-values.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="part-iii-introduction-to-linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/18-fake-data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
