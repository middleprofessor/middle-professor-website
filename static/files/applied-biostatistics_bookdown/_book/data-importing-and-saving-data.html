<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Elementary Statistical Modeling for Applied Biostatistics</title>
  <meta name="description" content="A first course in statistical modeling for biology students">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Elementary Statistical Modeling for Applied Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A first course in statistical modeling for biology students" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Elementary Statistical Modeling for Applied Biostatistics" />
  
  <meta name="twitter:description" content="A first course in statistical modeling for biology students" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="organization-r-projects-and-r-notebooks.html">
<link rel="next" href="part-ii-some-fundamentals-of-statistical-modeling.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#math"><i class="fa fa-check"></i><b>0.1</b> Math</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#r-and-programming"><i class="fa fa-check"></i><b>0.2</b> R and programming</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-r-fundamentals.html"><a href="part-i-r-fundamentals.html"><i class="fa fa-check"></i>Part I: R fundamentals</a></li>
<li class="chapter" data-level="1" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html"><i class="fa fa-check"></i><b>1</b> Organization – R Projects and R Notebooks</a><ul>
<li class="chapter" data-level="1.1" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#importing-packages"><i class="fa fa-check"></i><b>1.1</b> Importing Packages</a></li>
<li class="chapter" data-level="1.2" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-an-r-studio-project-for-this-class"><i class="fa fa-check"></i><b>1.2</b> Create an R Studio Project for this Class</a></li>
<li class="chapter" data-level="1.3" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#r-notebooks"><i class="fa fa-check"></i><b>1.3</b> R Notebooks</a><ul>
<li class="chapter" data-level="1.3.1" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-an-r-notebook-for-this-chapter"><i class="fa fa-check"></i><b>1.3.1</b> Create an R Notebook for this Chapter</a></li>
<li class="chapter" data-level="1.3.2" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-a-load-packages-chunk"><i class="fa fa-check"></i><b>1.3.2</b> Create a “load-packages” chunk</a></li>
<li class="chapter" data-level="1.3.3" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-a-simple-plot-chunk"><i class="fa fa-check"></i><b>1.3.3</b> Create a “simple plot” chunk</a></li>
<li class="chapter" data-level="1.3.4" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-more-r-chunks-and-explore-options-and-play-with-r-code"><i class="fa fa-check"></i><b>1.3.4</b> Create more R chunks and explore options and play with R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html"><i class="fa fa-check"></i><b>2</b> Data – Importing and Saving Data</a><ul>
<li class="chapter" data-level="2.1" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#create-new-notebook-for-this-chapter"><i class="fa fa-check"></i><b>2.1</b> Create new notebook for this chapter</a></li>
<li class="chapter" data-level="2.2" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#importing-data"><i class="fa fa-check"></i><b>2.2</b> Importing Data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#excel-file"><i class="fa fa-check"></i><b>2.2.1</b> Excel File</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#text-file"><i class="fa fa-check"></i><b>2.2.2</b> Text File</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#reshaping-data"><i class="fa fa-check"></i><b>2.3</b> Reshaping Data</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#wide-to-long"><i class="fa fa-check"></i><b>2.3.1</b> Wide to long</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#stacking-multiple-sets-of-columns"><i class="fa fa-check"></i><b>2.3.2</b> Stacking multiple sets of columns</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#miscellaneous-data-wrangling"><i class="fa fa-check"></i><b>2.4</b> Miscellaneous data wrangling</a><ul>
<li class="chapter" data-level="2.4.1" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#vole-data"><i class="fa fa-check"></i><b>2.4.1</b> Vole data</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#saving-data"><i class="fa fa-check"></i><b>2.5</b> Saving Data</a></li>
<li class="chapter" data-level="2.6" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#problems"><i class="fa fa-check"></i><b>2.6</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-some-fundamentals-of-statistical-modeling.html"><a href="part-ii-some-fundamentals-of-statistical-modeling.html"><i class="fa fa-check"></i>Part II: Some Fundamentals of Statistical Modeling</a></li>
<li class="chapter" data-level="3" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html"><i class="fa fa-check"></i><b>3</b> An Introduction to Statistical Modeling</a><ul>
<li class="chapter" data-level="3.1" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#two-specifications-of-a-linear-model"><i class="fa fa-check"></i><b>3.1</b> Two specifications of a linear model</a><ul>
<li class="chapter" data-level="3.1.1" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#the-error-draw-specification"><i class="fa fa-check"></i><b>3.1.1</b> The “error draw” specification</a></li>
<li class="chapter" data-level="3.1.2" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#the-conditional-draw-specification"><i class="fa fa-check"></i><b>3.1.2</b> The “conditional draw” specification</a></li>
<li class="chapter" data-level="3.1.3" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#comparing-the-two-ways-of-specifying-the-linear-model"><i class="fa fa-check"></i><b>3.1.3</b> Comparing the two ways of specifying the linear model</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#what-do-we-call-the-x-and-y-variables"><i class="fa fa-check"></i><b>3.2</b> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li class="chapter" data-level="3.3" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#statistical-models-are-used-for-prediction-explanation-and-description"><i class="fa fa-check"></i><b>3.3</b> Statistical models are used for prediction, explanation, and description</a></li>
<li class="chapter" data-level="3.4" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#modeling-strategy"><i class="fa fa-check"></i><b>3.4</b> Modeling strategy</a></li>
<li class="chapter" data-level="3.5" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#a-mean-is-the-simplest-model"><i class="fa fa-check"></i><b>3.5</b> A mean is the simplest model</a></li>
<li class="chapter" data-level="3.6" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#assumptions-for-inference-with-a-statistical-model"><i class="fa fa-check"></i><b>3.6</b> Assumptions for inference with a statistical model</a></li>
<li class="chapter" data-level="3.7" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#specific-assumptions-for-inference-with-a-linear-model"><i class="fa fa-check"></i><b>3.7</b> Specific assumptions for inference with a linear model</a></li>
<li class="chapter" data-level="3.8" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#statistical-model-or-regression-model"><i class="fa fa-check"></i><b>3.8</b> “Statistical model” or “regression model”?</a></li>
<li class="chapter" data-level="3.9" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#glm-vs.glm-vs.gls"><i class="fa fa-check"></i><b>3.9</b> GLM vs. GLM vs. GLS</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><i class="fa fa-check"></i><b>4</b> Variability and Uncertainty (Standard Deviations, Standard Errors, Confidence Intervals)</a><ul>
<li class="chapter" data-level="4.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#the-sample-standard-deviation-vs.the-standard-error-of-the-mean"><i class="fa fa-check"></i><b>4.1</b> The sample standard deviation vs. the standard error of the mean</a><ul>
<li class="chapter" data-level="4.1.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#sample-standard-deviation"><i class="fa fa-check"></i><b>4.1.1</b> Sample standard deviation</a></li>
<li class="chapter" data-level="4.1.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>4.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>4.2</b> Using Google Sheets to generate fake data to explore the standard error</a><ul>
<li class="chapter" data-level="4.2.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#steps"><i class="fa fa-check"></i><b>4.2.1</b> Steps</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#using-r-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>4.3</b> Using R to generate fake data to explore the standard error</a><ul>
<li class="chapter" data-level="4.3.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-i"><i class="fa fa-check"></i><b>4.3.1</b> part I</a></li>
<li class="chapter" data-level="4.3.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-ii---means"><i class="fa fa-check"></i><b>4.3.2</b> part II - means</a></li>
<li class="chapter" data-level="4.3.3" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-iii---how-do-sd-and-se-change-as-sample-size-n-increases"><i class="fa fa-check"></i><b>4.3.3</b> part III - how do SD and SE change as sample size (n) increases?</a></li>
<li class="chapter" data-level="4.3.4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-iv-generating-fake-data-with-for-loops"><i class="fa fa-check"></i><b>4.3.4</b> Part IV – Generating fake data with for-loops</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#bootstrapped-standard-errors"><i class="fa fa-check"></i><b>4.4</b> Bootstrapped standard errors</a></li>
<li class="chapter" data-level="4.5" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#confidence-interval"><i class="fa fa-check"></i><b>4.5</b> Confidence Interval</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html"><i class="fa fa-check"></i><b>5</b> Covariance and Correlation</a></li>
<li class="chapter" data-level="6" data-path="p-values.html"><a href="p-values.html"><i class="fa fa-check"></i><b>6</b> P-values</a><ul>
<li class="chapter" data-level="6.1" data-path="p-values.html"><a href="p-values.html#p-values-1"><i class="fa fa-check"></i><b>6.1</b> <span class="math inline">\(p\)</span>-values</a></li>
<li class="chapter" data-level="6.2" data-path="p-values.html"><a href="p-values.html#creating-a-null-distribution."><i class="fa fa-check"></i><b>6.2</b> Creating a null distribution.</a><ul>
<li class="chapter" data-level="6.2.1" data-path="p-values.html"><a href="p-values.html#the-null-distribution"><i class="fa fa-check"></i><b>6.2.1</b> the Null Distribution</a></li>
<li class="chapter" data-level="6.2.2" data-path="p-values.html"><a href="p-values.html#t-tests"><i class="fa fa-check"></i><b>6.2.2</b> t-tests</a></li>
<li class="chapter" data-level="6.2.3" data-path="p-values.html"><a href="p-values.html#p-values-from-the-perspective-of-permutation"><i class="fa fa-check"></i><b>6.2.3</b> P-values from the perspective of permutation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="p-values.html"><a href="p-values.html#statistical-modeling-instead-of-hypothesis-testing"><i class="fa fa-check"></i><b>6.3</b> Statistical modeling instead of hypothesis testing</a></li>
<li class="chapter" data-level="6.4" data-path="p-values.html"><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values"><i class="fa fa-check"></i><b>6.4</b> frequentist probability and the interpretation of p-values</a><ul>
<li class="chapter" data-level="6.4.1" data-path="p-values.html"><a href="p-values.html#background"><i class="fa fa-check"></i><b>6.4.1</b> Background</a></li>
<li class="chapter" data-level="6.4.2" data-path="p-values.html"><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><i class="fa fa-check"></i><b>6.4.2</b> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li class="chapter" data-level="6.4.3" data-path="p-values.html"><a href="p-values.html#two-interpretations-of-the-p-value"><i class="fa fa-check"></i><b>6.4.3</b> Two interpretations of the <em>p</em>-value</a></li>
<li class="chapter" data-level="6.4.4" data-path="p-values.html"><a href="p-values.html#nhst"><i class="fa fa-check"></i><b>6.4.4</b> NHST</a></li>
<li class="chapter" data-level="6.4.5" data-path="p-values.html"><a href="p-values.html#some-major-misconceptions-of-the-p-value"><i class="fa fa-check"></i><b>6.4.5</b> Some major misconceptions of the <span class="math inline">\(p\)</span>-value</a></li>
<li class="chapter" data-level="6.4.6" data-path="p-values.html"><a href="p-values.html#recommendations"><i class="fa fa-check"></i><b>6.4.6</b> Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="p-values.html"><a href="p-values.html#problems-1"><i class="fa fa-check"></i><b>6.5</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="creating-fake-data.html"><a href="creating-fake-data.html"><i class="fa fa-check"></i><b>7</b> Creating Fake Data</a><ul>
<li class="chapter" data-level="7.0.1" data-path="creating-fake-data.html"><a href="creating-fake-data.html#continuous-x-fake-observational-data"><i class="fa fa-check"></i><b>7.0.1</b> Continuous X (fake observational data)</a></li>
<li class="chapter" data-level="7.0.2" data-path="creating-fake-data.html"><a href="creating-fake-data.html#categorical-x-fake-experimental-data"><i class="fa fa-check"></i><b>7.0.2</b> Categorical X (fake experimental data)</a></li>
<li class="chapter" data-level="7.0.3" data-path="creating-fake-data.html"><a href="creating-fake-data.html#correlated-x-fake-observational-data"><i class="fa fa-check"></i><b>7.0.3</b> Correlated X (fake observational data)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-introduction-to-linear-models.html"><a href="part-iii-introduction-to-linear-models.html"><i class="fa fa-check"></i>Part III: Introduction to Linear Models</a></li>
<li class="chapter" data-level="8" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html"><i class="fa fa-check"></i><b>8</b> A linear model with a single, continuous <em>X</em></a><ul>
<li class="chapter" data-level="8.1" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><i class="fa fa-check"></i><b>8.1</b> A linear model with a single, continuous <em>X</em> is classical “regression”</a><ul>
<li class="chapter" data-level="8.1.1" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#using-a-linear-model-to-estimate-explanatory-effects"><i class="fa fa-check"></i><b>8.1.1</b> Using a linear model to estimate explanatory effects</a></li>
<li class="chapter" data-level="8.1.2" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#using-a-linear-model-for-prediction"><i class="fa fa-check"></i><b>8.1.2</b> Using a linear model for prediction</a></li>
<li class="chapter" data-level="8.1.3" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#reporting-results"><i class="fa fa-check"></i><b>8.1.3</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#working-in-r"><i class="fa fa-check"></i><b>8.2</b> Working in R</a><ul>
<li class="chapter" data-level="8.2.1" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#exploring-the-bivariate-relationship-between-y-and-x"><i class="fa fa-check"></i><b>8.2.1</b> Exploring the bivariate relationship between <em>Y</em> and <em>X</em></a></li>
<li class="chapter" data-level="8.2.2" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#fitting-the-linear-model"><i class="fa fa-check"></i><b>8.2.2</b> Fitting the linear model</a></li>
<li class="chapter" data-level="8.2.3" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#getting-to-know-the-linear-model-the-summary-function"><i class="fa fa-check"></i><b>8.2.3</b> Getting to know the linear model: the <code>summary</code> function</a></li>
<li class="chapter" data-level="8.2.4" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#display-an-alternative-to-summary"><i class="fa fa-check"></i><b>8.2.4</b> display: An alternative to summary</a></li>
<li class="chapter" data-level="8.2.5" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#confidence-intervals"><i class="fa fa-check"></i><b>8.2.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="8.2.6" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#how-good-is-our-model"><i class="fa fa-check"></i><b>8.2.6</b> How good is our model?</a></li>
<li class="chapter" data-level="8.2.7" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#exploring-a-lm-object"><i class="fa fa-check"></i><b>8.2.7</b> exploring a lm object</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#problems-2"><i class="fa fa-check"></i><b>8.3</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html"><i class="fa fa-check"></i><b>9</b> A linear model with a single, categorical <em>X</em></a><ul>
<li class="chapter" data-level="9.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#a-linear-model-with-a-single-categorical-x-estimates-the-effects-of-x-on-the-response."><i class="fa fa-check"></i><b>9.1</b> A linear model with a single, categorical <em>X</em> estimates the effects of <em>X</em> on the response.</a><ul>
<li class="chapter" data-level="9.1.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#table-of-model-coefficients"><i class="fa fa-check"></i><b>9.1.1</b> Table of model coefficients</a></li>
<li class="chapter" data-level="9.1.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#the-linear-model"><i class="fa fa-check"></i><b>9.1.2</b> The linear model</a></li>
<li class="chapter" data-level="9.1.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#reporting-results-1"><i class="fa fa-check"></i><b>9.1.3</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#comparing-the-results-of-a-linear-model-to-classical-hypothesis-tests"><i class="fa fa-check"></i><b>9.2</b> Comparing the results of a linear model to classical hypothesis tests</a><ul>
<li class="chapter" data-level="9.2.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#t-tests-are-special-cases-of-a-linear-model"><i class="fa fa-check"></i><b>9.2.1</b> t-tests are special cases of a linear model</a></li>
<li class="chapter" data-level="9.2.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#anova-is-a-special-case-of-a-linear-model"><i class="fa fa-check"></i><b>9.2.2</b> ANOVA is a special case of a linear model</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#working-in-r-1"><i class="fa fa-check"></i><b>9.3</b> Working in R</a><ul>
<li class="chapter" data-level="9.3.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#fitting-the-model"><i class="fa fa-check"></i><b>9.3.1</b> Fitting the model</a></li>
<li class="chapter" data-level="9.3.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#changing-the-reference-level"><i class="fa fa-check"></i><b>9.3.2</b> Changing the reference level</a></li>
<li class="chapter" data-level="9.3.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#an-introduction-to-contrasts"><i class="fa fa-check"></i><b>9.3.3</b> An introduction to contrasts</a></li>
<li class="chapter" data-level="9.3.4" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#harrell-plot"><i class="fa fa-check"></i><b>9.3.4</b> Harrell plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-checking-1.html"><a href="model-checking-1.html"><i class="fa fa-check"></i><b>10</b> Model Checking</a><ul>
<li class="chapter" data-level="10.1" data-path="model-checking-1.html"><a href="model-checking-1.html#do-coefficients-make-numeric-sense"><i class="fa fa-check"></i><b>10.1</b> Do coefficients make numeric sense?</a></li>
<li class="chapter" data-level="10.2" data-path="model-checking-1.html"><a href="model-checking-1.html#all-statistical-analyses-should-be-followed-by-model-checking"><i class="fa fa-check"></i><b>10.2</b> All statistical analyses should be followed by model checking</a></li>
<li class="chapter" data-level="10.3" data-path="model-checking-1.html"><a href="model-checking-1.html#linear-model-assumptions"><i class="fa fa-check"></i><b>10.3</b> Linear model assumptions</a></li>
<li class="chapter" data-level="10.4" data-path="model-checking-1.html"><a href="model-checking-1.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>10.4</b> Diagnostic plots use the residuals from the model fit</a><ul>
<li class="chapter" data-level="10.4.1" data-path="model-checking-1.html"><a href="model-checking-1.html#residuals"><i class="fa fa-check"></i><b>10.4.1</b> Residuals</a></li>
<li class="chapter" data-level="10.4.2" data-path="model-checking-1.html"><a href="model-checking-1.html#a-normal-q-q-plot-is-used-to-check-normality"><i class="fa fa-check"></i><b>10.4.2</b> A Normal Q-Q plot is used to check normality</a></li>
<li class="chapter" data-level="10.4.3" data-path="model-checking-1.html"><a href="model-checking-1.html#outliers---an-outlier-is-a-point-that-is-highly-unexpected-given-the-modeled-distribution."><i class="fa fa-check"></i><b>10.4.3</b> Outliers - an outlier is a point that is highly unexpected given the modeled distribution.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="model-checking-1.html"><a href="model-checking-1.html#model-checking-homoskedasticity"><i class="fa fa-check"></i><b>10.5</b> Model checking homoskedasticity</a></li>
<li class="chapter" data-level="10.6" data-path="model-checking-1.html"><a href="model-checking-1.html#model-checking-independence---hapiness-adverse-example."><i class="fa fa-check"></i><b>10.6</b> Model checking independence - hapiness adverse example.</a></li>
<li class="chapter" data-level="10.7" data-path="model-checking-1.html"><a href="model-checking-1.html#using-r"><i class="fa fa-check"></i><b>10.7</b> Using R</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html"><i class="fa fa-check"></i><b>11</b> Model Fitting and Model Fit (OLS)</a><ul>
<li class="chapter" data-level="11.1" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#least-squares-estimation-and-the-decomposition-of-variance"><i class="fa fa-check"></i><b>11.1</b> Least Squares Estimation and the Decomposition of Variance</a></li>
<li class="chapter" data-level="11.2" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#ols-regression"><i class="fa fa-check"></i><b>11.2</b> OLS regression</a></li>
<li class="chapter" data-level="11.3" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#how-well-does-the-model-fit-the-data-r2-and-variance-explained"><i class="fa fa-check"></i><b>11.3</b> How well does the model fit the data? <span class="math inline">\(R^2\)</span> and “variance explained”</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="plotting-models.html"><a href="plotting-models.html"><i class="fa fa-check"></i><b>12</b> Plotting Models</a><ul>
<li class="chapter" data-level="12.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data"><i class="fa fa-check"></i><b>12.1</b> Pretty good plots show the model and the data</a><ul>
<li class="chapter" data-level="12.1.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot"><i class="fa fa-check"></i><b>12.1.1</b> Pretty good plot component 1: Modeled effects plot</a></li>
<li class="chapter" data-level="12.1.2" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot-with-jittered-raw-data"><i class="fa fa-check"></i><b>12.1.2</b> Pretty good plot component 2: Modeled mean and CI plot with jittered raw data</a></li>
<li class="chapter" data-level="12.1.3" data-path="plotting-models.html"><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><i class="fa fa-check"></i><b>12.1.3</b> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="plotting-models.html"><a href="plotting-models.html#some-comments-on-plot-components"><i class="fa fa-check"></i><b>12.2</b> Some comments on plot components</a></li>
<li class="chapter" data-level="12.3" data-path="plotting-models.html"><a href="plotting-models.html#working-in-r-2"><i class="fa fa-check"></i><b>12.3</b> Working in R</a><ul>
<li class="chapter" data-level="12.3.1" data-path="plotting-models.html"><a href="plotting-models.html#unpooled-se-bars-and-confidence-intervals"><i class="fa fa-check"></i><b>12.3.1</b> Unpooled SE bars and confidence intervals</a></li>
<li class="chapter" data-level="12.3.2" data-path="plotting-models.html"><a href="plotting-models.html#adding-bootstrap-intervals"><i class="fa fa-check"></i><b>12.3.2</b> Adding bootstrap intervals</a></li>
<li class="chapter" data-level="12.3.3" data-path="plotting-models.html"><a href="plotting-models.html#adding-modeled-error-intervals"><i class="fa fa-check"></i><b>12.3.3</b> Adding modeled error intervals</a></li>
<li class="chapter" data-level="12.3.4" data-path="plotting-models.html"><a href="plotting-models.html#adding-p-values"><i class="fa fa-check"></i><b>12.3.4</b> Adding p-values</a></li>
<li class="chapter" data-level="12.3.5" data-path="plotting-models.html"><a href="plotting-models.html#adding-custom-p-values"><i class="fa fa-check"></i><b>12.3.5</b> Adding custom p-values</a></li>
<li class="chapter" data-level="12.3.6" data-path="plotting-models.html"><a href="plotting-models.html#plotting-two-factors"><i class="fa fa-check"></i><b>12.3.6</b> Plotting two factors</a></li>
</ul></li>
</ul></li>
<li><a href="part-iv-more-than-one-x-multivariable-models.html#part-iv-more-than-one-x-multivariable-models">Part IV: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li class="chapter" data-level="13" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html"><i class="fa fa-check"></i><b>13</b> Adding covariates to a linear model</a><ul>
<li class="chapter" data-level="13.1" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><i class="fa fa-check"></i><b>13.1</b> Adding covariates can increases the precision of the effect of interest</a></li>
<li class="chapter" data-level="13.2" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-covariates-can-decrease-prediction-error-in-predictive-models"><i class="fa fa-check"></i><b>13.2</b> Adding covariates can decrease prediction error in predictive models</a></li>
<li class="chapter" data-level="13.3" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-covariates-can-reduce-bias-due-to-confounding-in-explanatory-models"><i class="fa fa-check"></i><b>13.3</b> Adding covariates can reduce bias due to confounding in explanatory models</a></li>
<li class="chapter" data-level="13.4" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#best-practices-1-a-pre-treatment-measure-of-the-response-should-be-a-covariate-and-not-subtracted-from-the-post-treatment-measure-regression-to-the-mean"><i class="fa fa-check"></i><b>13.4</b> Best practices 1: A pre-treatment measure of the response should be a covariate and not subtracted from the post-treatment measure (regression to the mean)</a><ul>
<li class="chapter" data-level="13.4.1" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#regression-to-the-mean-in-words"><i class="fa fa-check"></i><b>13.4.1</b> Regression to the mean in words</a></li>
<li class="chapter" data-level="13.4.2" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#regression-to-the-mean-in-pictures"><i class="fa fa-check"></i><b>13.4.2</b> Regression to the mean in pictures</a></li>
<li class="chapter" data-level="13.4.3" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#do-not-use-percent-change-believing-that-percents-account-for-effects-of-initial-weights"><i class="fa fa-check"></i><b>13.4.3</b> Do not use percent change, believing that percents account for effects of initial weights</a></li>
<li class="chapter" data-level="13.4.4" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#do-not-test-for-balance-of-baseline-measures"><i class="fa fa-check"></i><b>13.4.4</b> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><i class="fa fa-check"></i><b>13.5</b> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html"><i class="fa fa-check"></i><b>14</b> Two (or more) Categorical <span class="math inline">\(X\)</span> – Factorial designs</a><ul>
<li class="chapter" data-level="14.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#factorial-experiments"><i class="fa fa-check"></i><b>14.1</b> Factorial experiments</a><ul>
<li class="chapter" data-level="14.1.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#model-coefficients-an-interaction-effect-is-what-is-leftover-after-adding-the-treatment-effects-to-the-control"><i class="fa fa-check"></i><b>14.1.1</b> Model coefficients: an interaction effect is what is leftover after adding the treatment effects to the control</a></li>
<li class="chapter" data-level="14.1.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#what-is-the-biological-meaning-of-an-interaction-effect"><i class="fa fa-check"></i><b>14.1.2</b> What is the biological meaning of an interaction effect?</a></li>
<li class="chapter" data-level="14.1.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#what-about-models-with-more-than-two-factors"><i class="fa fa-check"></i><b>14.1.3</b> What about models with more than two factors?</a></li>
<li class="chapter" data-level="14.1.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#the-additive-model"><i class="fa fa-check"></i><b>14.1.4</b> The additive model</a></li>
<li class="chapter" data-level="14.1.5" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#contrasts-simple-vs.main-effects"><i class="fa fa-check"></i><b>14.1.5</b> Contrasts – simple vs. main effects</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#reporting-results-2"><i class="fa fa-check"></i><b>14.2</b> Reporting results</a><ul>
<li class="chapter" data-level="14.2.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#text-results"><i class="fa fa-check"></i><b>14.2.1</b> Text results</a></li>
<li class="chapter" data-level="14.2.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#harrellplot"><i class="fa fa-check"></i><b>14.2.2</b> Harrellplot</a></li>
<li class="chapter" data-level="14.2.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#interaction-plots"><i class="fa fa-check"></i><b>14.2.3</b> Interaction plots</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#recommendations-1"><i class="fa fa-check"></i><b>14.3</b> Recommendations</a></li>
<li class="chapter" data-level="14.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#working-in-r-3"><i class="fa fa-check"></i><b>14.4</b> Working in R</a></li>
<li class="chapter" data-level="14.5" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#problems-3"><i class="fa fa-check"></i><b>14.5</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="anova-tables.html"><a href="anova-tables.html"><i class="fa fa-check"></i><b>15</b> ANOVA Tables</a><ul>
<li class="chapter" data-level="15.1" data-path="anova-tables.html"><a href="anova-tables.html#summary-of-usage"><i class="fa fa-check"></i><b>15.1</b> Summary of usage</a></li>
<li class="chapter" data-level="15.2" data-path="anova-tables.html"><a href="anova-tables.html#example-a-one-way-anova-using-the-vole-data"><i class="fa fa-check"></i><b>15.2</b> Example: a one-way ANOVA using the vole data</a></li>
<li class="chapter" data-level="15.3" data-path="anova-tables.html"><a href="anova-tables.html#example-a-two-way-anova-using-the-urchin-data"><i class="fa fa-check"></i><b>15.3</b> Example: a two-way ANOVA using the urchin data</a><ul>
<li class="chapter" data-level="15.3.1" data-path="anova-tables.html"><a href="anova-tables.html#how-to-read-an-anova-table"><i class="fa fa-check"></i><b>15.3.1</b> How to read an ANOVA table</a></li>
<li class="chapter" data-level="15.3.2" data-path="anova-tables.html"><a href="anova-tables.html#how-to-read-anova-results-reported-in-the-text"><i class="fa fa-check"></i><b>15.3.2</b> How to read ANOVA results reported in the text</a></li>
<li class="chapter" data-level="15.3.3" data-path="anova-tables.html"><a href="anova-tables.html#better-practice-estimates-and-their-uncertainty"><i class="fa fa-check"></i><b>15.3.3</b> Better practice – estimates and their uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="anova-tables.html"><a href="anova-tables.html#unbalanced-designs"><i class="fa fa-check"></i><b>15.4</b> Unbalanced designs</a><ul>
<li class="chapter" data-level="15.4.1" data-path="anova-tables.html"><a href="anova-tables.html#what-is-going-on-in-unbalanced-anova-type-i-ii-iii-sum-of-squares"><i class="fa fa-check"></i><b>15.4.1</b> What is going on in unbalanced ANOVA? – Type I, II, III sum of squares</a></li>
<li class="chapter" data-level="15.4.2" data-path="anova-tables.html"><a href="anova-tables.html#back-to-interpretation-of-main-effects"><i class="fa fa-check"></i><b>15.4.2</b> Back to interpretation of main effects</a></li>
<li class="chapter" data-level="15.4.3" data-path="anova-tables.html"><a href="anova-tables.html#the-anova-tables-for-type-i-ii-and-iii-sum-of-squares-are-the-same-if-the-design-is-balanced."><i class="fa fa-check"></i><b>15.4.3</b> The anova tables for Type I, II, and III sum of squares are the same if the design is balanced.</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="anova-tables.html"><a href="anova-tables.html#working-in-r-4"><i class="fa fa-check"></i><b>15.5</b> Working in R</a><ul>
<li class="chapter" data-level="15.5.1" data-path="anova-tables.html"><a href="anova-tables.html#type-i-sum-of-squares-in-r"><i class="fa fa-check"></i><b>15.5.1</b> Type I sum of squares in R</a></li>
<li class="chapter" data-level="15.5.2" data-path="anova-tables.html"><a href="anova-tables.html#type-ii-and-iii-sum-of-squares"><i class="fa fa-check"></i><b>15.5.2</b> Type II and III Sum of Squares</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="predictive-models.html"><a href="predictive-models.html"><i class="fa fa-check"></i><b>16</b> Predictive Models</a><ul>
<li class="chapter" data-level="16.1" data-path="predictive-models.html"><a href="predictive-models.html#overfitting"><i class="fa fa-check"></i><b>16.1</b> Overfitting</a></li>
<li class="chapter" data-level="16.2" data-path="predictive-models.html"><a href="predictive-models.html#model-building-vs.variable-selection-vs.model-selection"><i class="fa fa-check"></i><b>16.2</b> Model building vs. Variable selection vs. Model selection</a><ul>
<li class="chapter" data-level="16.2.1" data-path="predictive-models.html"><a href="predictive-models.html#stepwise-regression"><i class="fa fa-check"></i><b>16.2.1</b> Stepwise regression</a></li>
<li class="chapter" data-level="16.2.2" data-path="predictive-models.html"><a href="predictive-models.html#cross-validation"><i class="fa fa-check"></i><b>16.2.2</b> Cross-validation</a></li>
<li class="chapter" data-level="16.2.3" data-path="predictive-models.html"><a href="predictive-models.html#penalization"><i class="fa fa-check"></i><b>16.2.3</b> Penalization</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="predictive-models.html"><a href="predictive-models.html#shrinkage"><i class="fa fa-check"></i><b>16.3</b> Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"><a href="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"><i class="fa fa-check"></i>Part V: Expanding the Linear Model – Generalized Linear Models and Multilevel (Linear Mixed) Models</a></li>
<li class="chapter" data-level="17" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html"><i class="fa fa-check"></i><b>17</b> Generalized linear models I: Count data</a><ul>
<li class="chapter" data-level="17.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#the-generalized-linear-model"><i class="fa fa-check"></i><b>17.1</b> The generalized linear model</a></li>
<li class="chapter" data-level="17.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish"><i class="fa fa-check"></i><b>17.2</b> Count data example – number of trematode worm larvae in eyes of threespine stickleback fish</a><ul>
<li class="chapter" data-level="17.2.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#modeling-strategy-1"><i class="fa fa-check"></i><b>17.2.1</b> Modeling strategy</a></li>
<li class="chapter" data-level="17.2.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#checking-the-model-i-a-normal-q-q-plot"><i class="fa fa-check"></i><b>17.2.2</b> Checking the model I – a Normal Q-Q plot</a></li>
<li class="chapter" data-level="17.2.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#checking-the-model-ii-scale-location-plot-for-checking-homoskedasticity"><i class="fa fa-check"></i><b>17.2.3</b> Checking the model II – scale-location plot for checking homoskedasticity</a></li>
<li class="chapter" data-level="17.2.4" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#two-distributions-for-count-data-poisson-and-negative-binomial"><i class="fa fa-check"></i><b>17.2.4</b> Two distributions for count data – Poisson and Negative Binomial</a></li>
<li class="chapter" data-level="17.2.5" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-with-a-poisson-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>17.2.5</b> Fitting a GLM with a Poisson distribution to the worm data</a></li>
<li class="chapter" data-level="17.2.6" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#model-checking-fits-to-count-data"><i class="fa fa-check"></i><b>17.2.6</b> Model checking fits to count data</a></li>
<li class="chapter" data-level="17.2.7" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-with-a-negative-binomial-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>17.2.7</b> Fitting a GLM with a Negative Binomial distribution to the worm data</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#working-in-r-5"><i class="fa fa-check"></i><b>17.3</b> Working in R</a></li>
<li class="chapter" data-level="17.4" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#problems-4"><i class="fa fa-check"></i><b>17.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html"><i class="fa fa-check"></i><b>18</b> Linear mixed models</a><ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#random-effects"><i class="fa fa-check"></i><b>18.1</b> Random effects</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#random-effects-in-statistical-models"><i class="fa fa-check"></i><b>18.2</b> Random effects in statistical models</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#linear-mixed-models-are-flexible"><i class="fa fa-check"></i><b>18.3</b> Linear mixed models are flexible</a></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#visualizing-block-effects"><i class="fa fa-check"></i><b>18.4</b> Visualizing block effects</a></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#linear-mixed-models-can-increase-precision-of-point-estimates"><i class="fa fa-check"></i><b>18.5</b> Linear mixed models can increase precision of point estimates</a></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#linear-mixed-models-are-used-to-avoid-pseudoreplication"><i class="fa fa-check"></i><b>18.6</b> Linear mixed models are used to avoid pseudoreplication</a></li>
<li class="chapter" data-level="18.7" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#linear-mixed-models-shrink-coefficients-by-partial-pooling"><i class="fa fa-check"></i><b>18.7</b> Linear mixed models shrink coefficients by partial pooling</a></li>
<li class="chapter" data-level="18.8" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#working-in-r-6"><i class="fa fa-check"></i><b>18.8</b> Working in R</a><ul>
<li class="chapter" data-level="18.8.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#coral-data"><i class="fa fa-check"></i><b>18.8.1</b> coral data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-models-with-heterogenous-variance.html"><a href="linear-models-with-heterogenous-variance.html"><i class="fa fa-check"></i><b>19</b> Linear models with heterogenous variance</a><ul>
<li class="chapter" data-level="19.1" data-path="linear-models-with-heterogenous-variance.html"><a href="linear-models-with-heterogenous-variance.html#gls"><i class="fa fa-check"></i><b>19.1</b> gls</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html"><i class="fa fa-check"></i>Appendix 1: Getting Started with R</a><ul>
<li class="chapter" data-level="19.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready"><i class="fa fa-check"></i><b>19.2</b> Get your computer ready</a><ul>
<li class="chapter" data-level="19.2.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r"><i class="fa fa-check"></i><b>19.2.1</b> Install R</a></li>
<li class="chapter" data-level="19.2.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-studio"><i class="fa fa-check"></i><b>19.2.2</b> Install R Studio</a></li>
<li class="chapter" data-level="19.2.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#resources-for-installing-r-and-r-studio"><i class="fa fa-check"></i><b>19.2.3</b> Resources for installing R and R Studio</a></li>
<li class="chapter" data-level="19.2.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-latex"><i class="fa fa-check"></i><b>19.2.4</b> Install LaTeX</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-learning"><i class="fa fa-check"></i><b>19.3</b> Start learning</a><ul>
<li class="chapter" data-level="19.3.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-with-data-camp-introduction-to-r"><i class="fa fa-check"></i><b>19.3.1</b> Start with Data Camp Introduction to R</a></li>
<li class="chapter" data-level="19.3.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#then-move-to-introduction-to-r-studio"><i class="fa fa-check"></i><b>19.3.2</b> Then Move to Introduction to R Studio</a></li>
<li class="chapter" data-level="19.3.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#develop-your-project-with-an-r-studio-notebook"><i class="fa fa-check"></i><b>19.3.3</b> Develop your project with an R Studio Notebook</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#getting-data-into-r"><i class="fa fa-check"></i><b>19.4</b> Getting Data into R</a></li>
<li class="chapter" data-level="19.5" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#additional-r-learning-resources"><i class="fa fa-check"></i><b>19.5</b> Additional R learning resources</a></li>
<li class="chapter" data-level="19.6" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#packages-used-extensively-in-this-text"><i class="fa fa-check"></i><b>19.6</b> Packages used extensively in this text</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><i class="fa fa-check"></i>Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Elementary Statistical Modeling for Applied Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-importing-and-saving-data" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Data – Importing and Saving Data</h1>
<p>Importing data into R can be a struggle for new R users and, unfortunately, most online sources give easy but superficial methods that don’t follow best practices for increasing reproducibility or do not allow flexible organization of files within a project. Some examples:</p>
<p>(tl;dr – go to next section if you just want to import a file and don’t want to understand this important background information!)</p>
<ol style="list-style-type: decimal">
<li><code>df &lt;- read.table(file=&quot;clipboard&quot;)</code> imports data copied to the clipboard, from an Excel/Sheets file or from an open text file. For this to be semi-reproducible, a comment specifying the filename, worksheet and range that was copied is necessary. More problematic (catastrophically so for reproducibility), is, how does a researcher know that they highlighted and copied the correct range in the Excel sheet?</li>
<li><code>df &lt;- read.csv(file.choose())</code> opens the familiar “open file” dialog box, which lets the user navigate to the file of choice. For this to be semi-reproducible, a comment specifying the filename to import is necessary. The catastrophic problem (for reproducibility) is, how does a researcher know which file was actually opened during an R session? The researcher might think they opened “walker_maine_bee_data_clean_androscoggin.csv” but mistakenly opened “walker_maine_bee_data_clean_aroostook.csv”.</li>
<li><code>df &lt;- read.table(file=&quot;my_data.txt&quot;)</code> and <code>df &lt;- read_excel(file=&quot;my_data.xlsx&quot;)</code> are reproducible because the filename is explicitly specified. But, this method requires that “my_data” is physically located in the same folder as the file containing the R script (the notebook .Rmd file in our case) and this violates the best practice of clean project organization with different folders for the different kinds of files (data, R scripts, images, manuscript text, etc.).</li>
<li>R Studio has an elegant import tool in the environment pane that opens a custom dialog box that allows the researcher to navigate to the file, and to specify what part of the file to import, such as the specific sheet and range for an Excel file. This has the same reproducibility issues as #1 and #2 but R Studio includes the equivalent script, which adds all relevant information for reproducility. One then simply copies and pastes this script into a code chunk and voila! The next time the script is run, the data can be imported from the script without using menus and dialog boxes. Except that..the script does not seem to take into account that the <strong>working directory</strong> of an R Markdown file is not the project folder but the folder containing the R Markdown file and so this two-step method fails. More personally, I’d prefer to run a chunk that quickly opens the data file instead of re-navigating through my file system and re-specifying the sheet and range every time I re-start the project in a new R session.</li>
</ol>
<p>There are at least three solutions to the issues raised above, all requiring some understanding of <strong>file paths</strong> and directory structure in an operating system. A file such as “my_data.xlsx” has an <strong>absolute</strong> file path, which is the full address of the file (the filename is something like your house street number). The absolute file path of “my_data.xlsx” might be “/Users/jwalker/Documents/applied-biostatistics/data/my_data.xlsx”. A <strong>relative</strong> file path is the file path from the <strong>working directory</strong>. In an R Studio project, the working directory is the project directory, which is the directory containing the .Rproj file. This will be the working directory of the console. <em>Importantly</em>, the working directory of an R Markdown code chunk is the folder containing the saved R Markdown file. An R Studio Notebook is an R Markdown file so the working directory of a notebook code chunk is the folder containing the saved notebook file. If a notebook file is located within the notebooks folder, which is located within the project folder, then the relative file path to “my_file.xlsx” is “../data/my_file.xlsx”. The “..” tells the file OS to move “up” into the parent directory (which is the project folder) and the “data” tells the file OS to move “down” into the data folder. These are put together into a single address using “/”. The beauty of relative paths is that they remain the same – and so do not break one’s script – if the project folder, and all of its contents including the data folder and the notebooks folder, is moved to another location on the hard drive (say into a new “Research” folder). By contrast, the absolute file path changes, which breaks any old script.</p>
<p>The three solutions are</p>
<ol style="list-style-type: decimal">
<li>Create a <strong>relative path</strong> to the file using something like <code>file_path &lt;- &quot;../data/my_data.xlsx&quot;</code>. This should <em>always</em> work but it fails on some computers. For example, if the project folder is on a Windows OS (but not Mac OS) desktop, the assigned relative address doesn’t seem to look in the folder containing the file.</li>
<li>Create a setup chunk that reroutes the working directory to the project folder using the script</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># use this in a chuck called &quot;setup&quot; to force the working directory to be</span>
<span class="co"># at the level of the project file.</span>
knitr<span class="op">::</span>opts_knit<span class="op">$</span><span class="kw">set</span>(<span class="dt">root.dir =</span> rprojroot<span class="op">::</span><span class="kw">find_rstudio_root_file</span>())</code></pre></div>
<p>For this to work, the chunk has to be named “setup”, that is, the text inside the curly brackets at the top of the chunk should be “r setup”. Then, with this chunk, the relative file path is <code>file_path &lt;- &quot;../data/my_data.xlsx&quot;</code> if “my_data.xlsx” is immediately inside the data folder which is imediately inside the project folder. This should work on any machine, and should work even if a project folder is moved. However, it does not work when writing a book with Bookdown a Bookdown project has multiple .Rmd files and the chunk names cannot be repeated across files. There can only be one chunk called “setup”.</p>
<ol start="3" style="list-style-type: decimal">
<li>Use the function here(). The most robust solution seems to be using the function here() from the here package. The function works something like this</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_path &lt;-<span class="st"> &quot;data&quot;</span> <span class="co"># path to data that are imported</span>
file_name &lt;-<span class="st"> &quot;my_data.xlsx&quot;</span>
file_path &lt;-<span class="st"> </span><span class="kw">here</span>(data_path, file_name) <span class="co"># paste together parts of the address</span>
<span class="kw">read_excel</span>(<span class="dt">file=</span>file_path)</code></pre></div>
<p><code>here()</code> creates an absolute path, but one that is created on the fly, and will change (or should change) correctly if the project folder is moved on the same machine or to another machine. And no chunk named setup is required so this also works in every R markdown file when using Bookdown.</p>
<div id="create-new-notebook-for-this-chapter" class="section level2">
<h2><span class="header-section-number">2.1</span> Create new notebook for this chapter</h2>
<p>Create a new notebook and save it to the “notebooks” folder of your BIO_413 project. <strong>Important:</strong> In an R Studio project, the working directory is the project directory (the location of the .Rproj file) – this will be the working directory of the console. The working directory of an R Markdown code chunk is the folder containing the saved R Markdown file. An R Studio Notebook is an R Markdown file so the working directory of an notebook code chunk is the folder containing the saved notebook file. Importantly, the working directory of the code chunk isn’t “moved” to the folder containing the saved file <em>until the file is saved</em> so import/export scripts will no work properly until the file is saved!</p>
<p>Annotate your notebook with notes! Update it as you learn more! We will use data.table for importing text files in tab-delimited or comma-separated formats and the readxl package for importing excel files.</p>
<p>Start each notebook with a chunk named “setup” that loads packages and sets the address for reading and writing files (note that since this book is advocating the use of here() to set the file path, naming the setup chunk “setup” is not imperative).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(here) <span class="co"># here() creates the absolute path to the file</span>
<span class="kw">library</span>(janitor) <span class="co"># clean_names to clean col labels of imported data</span>
<span class="kw">library</span>(readxl) <span class="co"># import excel</span>
<span class="kw">library</span>(data.table) <span class="co"># make data.frames data.tables</span>
<span class="kw">library</span>(ggplot2) <span class="co"># ggplot environment</span>
<span class="kw">library</span>(ggpubr) <span class="co"># publication ready plots</span>
<span class="kw">library</span>(emmeans) <span class="co"># get estimated marginal means and CIs, used for plot</span>

here &lt;-<span class="st"> </span>here<span class="op">::</span>here <span class="co"># plyr also defines a here function</span>

<span class="co"># relative paths to project folders</span>
data_path &lt;-<span class="st"> &quot;data&quot;</span> <span class="co"># path to data that are imported</span>
output_path &lt;-<span class="st"> &quot;output&quot;</span> <span class="co"># path to data that are saved</span>
image_path &lt;-<span class="st"> &quot;images&quot;</span> <span class="co"># path to image folder</span></code></pre></div>
</div>
<div id="importing-data" class="section level2">
<h2><span class="header-section-number">2.2</span> Importing Data</h2>
<p>Throughout this book, we will download data from the <a href="https://datadryad.org" target="_blank">Dryad Digital Repository</a>, which is a major resource for increasing reproducibility in science. My own view is that <em>all data</em> should be archived on some public server (exceptions include data that are proprietary or contain sensitive information – such as human health measures).</p>
<div id="excel-file" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Excel File</h3>
<p>The Excel dataset is from an experiment on the growth response of zebra finch chicks to an incubation call that presumably signals “hot environment” to the embryos (<a href="http://science.sciencemag.org/content/353/6301/812" target="_blank">Mariette, M.M. and Buchanan, K.L., 2016. Prenatal acoustic communication programs offspring for high posthatching temperatures in a songbird. Science, 353(6301), pp.812-814</a>). The source file is from the Dryad Repository here:</p>
<p><strong>file name</strong>: “allDatasetsMarietteBuchanan2016.xls”</p>
<p><strong>source</strong>: <a href="https://datadryad.org//handle/10255/dryad.122315" class="uri">https://datadryad.org//handle/10255/dryad.122315</a></p>
<p>Steps</p>
<ol style="list-style-type: decimal">
<li>Copy the title of the Dryad page, which is “Data from: Prenatal acoustic communication programs offspring for high post-hatching temperatures in a songbird”</li>
<li>Create a new folder within “data” and paste in the copied title as the folder name</li>
<li>Remove the colon from the name, so the folder name is “Data from Prenatal acoustic communication programs offspring for high post-hatching temperatures in a songbird”</li>
<li>Download the .xls file into this folder</li>
</ol>
<p>A .xls file is an old (pre 2007) Microsoft Excel file type. It is a binary file and can only be opened into a readable format with specialized software. The more modern Excel file type is .xlsx, which contains within it multiple xml components. An xml file is a text file, and so contains readable content, but the content is xml code to display something. In general, I am a big advocate of archiving stuff as text files (manuscripts, data, scripts, blog posts) because these will <em>always</em> be readable by future software. Microsoft Excel is not likely to die anytime soon and software that can read .xls and especially .xlsx files (again, .xlsx files are text files) is even less likely to disappear but we can feel even more confident if data are archived as text files. That said, a single microsoft excel file with multiple sheets is an efficient method for distributing data and the readxl package provides excellent tools for reading different sheets of a single .xls or .xlsx file.</p>
<p>The code below uses the function <code>read_excel()</code> from the package readxl. More about the amazing power of this package is the <a href="https://readxl.tidyverse.org" target="_blank">tidyverse page</a> and <a href="http://r4ds.had.co.nz/data-import.html" target="_blank">chapter 11</a> in the <em>R for Data Science</em> book.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_folder &lt;-<span class="st"> &quot;Data from Prenatal acoustic communication programs offspring for high post-hatching temperatures in a songbird&quot;</span>
fn &lt;-<span class="st"> &quot;allDatasetsMarietteBuchanan2016.xls&quot;</span>
file_path &lt;-<span class="st"> </span><span class="kw">here</span>(data_path, data_folder, fn)
<span class="co">#file_path &lt;- paste(data_path, data_folder, fn, sep=&quot;/&quot;)</span>
chick &lt;-<span class="st"> </span><span class="kw">read_excel</span>(file_path, <span class="dt">sheet=</span><span class="st">&quot;nestlingMass&quot;</span>) <span class="co"># read the excel file</span>
chick &lt;-<span class="st"> </span><span class="kw">data.table</span>(chick) <span class="co"># convert to data.table</span></code></pre></div>
<p>In this book, we will consistently uses this protocol for storing and retrieving downloaded files. The first three lines in the script above creates the directory path to the file. This path includes</p>
<ol style="list-style-type: decimal">
<li>data_path – the relative path into the folder “data” (relative to the location of the project file)</li>
<li>data_folder – the name of the folder within “data” containing the file</li>
<li>filename – the name of the file to read</li>
</ol>
<p>These are all put together into the absolute path using the function <code>here()</code> from the here package. Take a look at the value of file_path to confirm. The <code>read_excel(file_path, sheet=&quot;nestlingMass&quot;)</code> reads the nestlingMass sheet only. The next line:<code>chick &lt;- data.table(chick)</code> converts the data.frame into a data.table.</p>
<div id="troubleshooting-file-import" class="section level4">
<h4><span class="header-section-number">2.2.1.1</span> Troubleshooting File Import</h4>
<p>If you get an error that starts with “Error: <code>path</code> does not exist:” then R is not “seeing” your specified file given the path you’ve given it.</p>
<ol style="list-style-type: decimal">
<li>Make sure you loaded the package <code>here</code> in a “load-libraries” chunk and that you have run the chunk</li>
<li>Make sure you have assigned <code>data_path &lt;- &quot;data&quot;</code> in the setup chunk and have run the chunk.</li>
<li>Make sure your “data” folder is <em>one level</em> inside your project folder. “one level” means it is not buried deeper inside other folders within the project folder.</li>
<li>Make sure your “Data from …” folder is one level inside your “data” folder</li>
<li>Make sure you have the name of the “Data from …” folder correct in your script. To do this, I do not type the name but instead go to the finder (on Mac OS) and highlight the “Data from …” folder and copy the name – the whole name – and then paste in between the quote mark in the line <code>data_folder &lt;- &quot;&quot;</code></li>
<li>Make sure your data file is one level inside the correct “Data from” folder.</li>
<li>Make sure the file name is correct in the script. As with the folder name, I go to the finder and copy the file name and paste it in place. In Windows use ctrl-a instead of ctrl-c to copy the full filename including the extension.</li>
</ol>
<p>More generally, R is <em>very literal</em> when it comes to: Spelling. Humans are very good at understanding misspelled words but the R language (or any computer language) is very literal. “Data from Quantifying the effects of” and “Data from Quantifying the efects of” are different values. Capitalization. R is <strong>case sensitive</strong> (some programming languages are not). “Data from Quantifying”, “Data from quantifying”, and “data from quantifying” are all different values. Spelling AND capitalization have to be perfect, not simply close. Humans are very good at understanding misspelled and OdDLy capitalized words but the R language (or any computer language) is very literal.</p>
</div>
<div id="peak-at-the-imported-data.table-to-check-that-the-file-was-imported-correctly-and-to-learn-about-the-contents." class="section level4">
<h4><span class="header-section-number">2.2.1.2</span> Peak at the imported data.table to check that the file was imported correctly and to learn about the contents.</h4>
<p>Insert the following after your import script and run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(chick) <span class="co"># check -- are there headers? are there the correct number of columns?</span></code></pre></div>
<p>The line <code>View(chick)</code> script opens a new tab containing a spreadsheet-like display of the data frame <code>chick</code>. This is one way to check that the data were imported correctly, to examine the column labels to ensure they conform to best practices, and to simply get to know the contents of the imported file. From the view of chick, it may not be immediately apparent that the column names contain spaces. This can be seen more easily using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(chick)</code></pre></div>
<pre><code>##  [1] &quot;chick ID&quot;                       &quot;brood ID&quot;                      
##  [3] &quot;brood composition&quot;              &quot;sex&quot;                           
##  [5] &quot;rank in nest&quot;                   &quot;playback treatment&quot;            
##  [7] &quot;nest temperature above ambient&quot; &quot;max daily temp hatch day&quot;      
##  [9] &quot;mean max temp hatch to day2&quot;    &quot;mean max temp hatch to day10&quot;  
## [11] &quot;mean max temp hatch to day13&quot;   &quot;hatching mass&quot;                 
## [13] &quot;day1 mass&quot;                      &quot;day2 mass&quot;                     
## [15] &quot;day10 mass&quot;                     &quot;day13 mass&quot;                    
## [17] &quot;day13 tarsus&quot;</code></pre>
<p>In general, it is bad practice to include spaces, parentheses, and special characters such as $ or ^, in the column names of a data frame because these increase handling costs later on. The best practice is to replace a blank with an underscore, for example <code>brood_id</code>. Some coders separate words with a period (<code>brood.id</code>). Others mash words together into a single word like this <code>broodid</code> but this should generally be avoided because the result can be hard to read. Finally, some coders use Caps to designate new words like this <code>BroodId</code>. This is easier to read than simple concatenation but the underscore is the easiest to read.</p>
<p>The <code>janitor</code> package has a nice function to clean the column names of a data frame including replacing spaces with an underscore and stripping parentheses. The default clean includes changing any uppercase letter to lower case. Many coders like to work with all lowercase variable names to avoid having to hit the shift key.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chick &lt;-<span class="st"> </span><span class="kw">clean_names</span>(chick)</code></pre></div>
<p>Importantly, <strong>resist the temptation to change the column names in the data file</strong>, which reduces reproducibility. Leave original data files original. Always increase reproducibility!</p>
</div>
<div id="best-practices-for-creating-data-files" class="section level4">
<h4><span class="header-section-number">2.2.1.3</span> Best practices for creating data files</h4>
<ol style="list-style-type: decimal">
<li><p><a href="https://www.youtube.com/watch?time_continue=309&amp;v=Ry2xjTBtNFE" class="uri">https://www.youtube.com/watch?time_continue=309&amp;v=Ry2xjTBtNFE</a> – An excellent video introduction to best practices for organizing data in a spreadsheet that will subsequently be analyzed by statistics software.</p></li>
<li><p>Broman, K. W., &amp; Woo, K. H. (2017). Data organization in spreadsheets (No. e3183v1). <a href="https://doi.org/10.7287/peerj.preprints.3183v1" class="uri">https://doi.org/10.7287/peerj.preprints.3183v1</a> – An excelllent review of best practices for organizing data in a spreadsheet.</p></li>
</ol>
</div>
<div id="explore-with-plots" class="section level4">
<h4><span class="header-section-number">2.2.1.4</span> Explore with plots</h4>
<p>Just for fun, let’s plot the data and reproduce Fig. 2A and B. We are using the <code>qplot</code> function, which is from the ggplot2 package. Two plots are made and only a subset of the rows are plotted in each (in A, the subset in which playback_treatment==“treat” and, in B, the subset in which playback_treatment==“cont”). This book uses the ggplot2 package extensively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">x=</span>nest_temperature_above_ambient, <span class="dt">y=</span>day13_mass, <span class="dt">data=</span>chick[playback_treatment<span class="op">==</span><span class="st">&quot;treat&quot;</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)</code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/data-plotchickdata-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">x=</span>nest_temperature_above_ambient, <span class="dt">y=</span>day13_mass, <span class="dt">data=</span>chick[playback_treatment<span class="op">==</span><span class="st">&quot;cont&quot;</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)</code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/data-plotchickdata-2.png" width="576" /></p>
</div>
</div>
<div id="text-file" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Text File</h3>
<p>The example dataset comes from an experiment on the effect of <a href="http://science.sciencemag.org/content/early/2012/03/28/science.1215025" target="_blank">neonicotinoid pesticides on bumble bee colony growth</a>.</p>
<p><strong>file name</strong>: “Whitehorn, O’Connor, Wackers, Goulson (2012) Data from ‘Neonicotinoid pesticide reduces bumblebee colony growth and queen production’.csv.csv”</p>
<p><strong>source</strong>: <a href="https://datadryad.org//resource/doi:10.5061/dryad.1805c973" class="uri">https://datadryad.org//resource/doi:10.5061/dryad.1805c973</a></p>
<p>Steps</p>
<ol style="list-style-type: decimal">
<li>Copy the title of the Dryad page, which is “Data from: Neonicotinoid pesticide reduces bumblebee colony growth and queen production”</li>
<li>Create a new folder within “data” and paste in the copied title as the folder name</li>
<li>Remove the colon from the name, so the folder name is “Data from Neonicotinoid pesticide reduces bumblebee colony growth and queen production”</li>
<li>Download the .csv file into this folder</li>
</ol>
<p>A .csv file is a text file that is comma-delimted, which means that the entries of a row are separated by commas. A text file is readable by any text editor software and most other kinds of software. Datasets that are stored as text files are typically saved as either .csv (where the entries of a row are separated by commas) or .txt (where the entries are separated by tabs). The base R way to read a .csv file is using <code>read.csv</code>. The <code>read.table</code> function is more versatile, as the delimiter can be specified. The function <code>fread()</code> from the data.table package is fast, smart, and flexible. It is smart in the sense that it guesses what the delimter is. Unfortunately, because of spaces in the column labels for this file, fread guesses incorrectly (another reason why spaces in column labels should be avoided). To overcome this, the statement below specifies that the file contains a “header” (a line containing column labels)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_folder &lt;-<span class="st"> &quot;Data from Neonicotinoid pesticide reduces bumblebee colony growth and queen production&quot;</span>
filename &lt;-<span class="st"> &quot;Whitehorn, O&#39;Connor, Wackers, Goulson (2012) Data from &#39;Neonicotinoid pesticide reduces bumblebee colony growth and queen production&#39;.csv.csv&quot;</span>
file_path &lt;-<span class="st"> </span><span class="kw">here</span>(data_path, data_folder, filename)
bee &lt;-<span class="st"> </span><span class="kw">fread</span>(file_path, <span class="dt">header=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>Here, as with the import of the Excel file, the first three lines create the directory path to the file. Peek at the file in the console. Again, there are spaces in the column names. <strong>Here I’ll leave it to you to change this</strong></p>
<p>Here is a reproduction of Fig 2 from the journal article.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bee[, treatment<span class="op">:</span><span class="er">=</span><span class="kw">factor</span>(treatment, <span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;High&quot;</span>))] <span class="co"># reorder factor levels</span>
<span class="kw">ggbarplot</span>(<span class="dt">data=</span>bee, <span class="dt">x=</span><span class="st">&quot;treatment&quot;</span>, <span class="dt">y=</span><span class="st">&quot;new_queens&quot;</span>, <span class="dt">add =</span> <span class="st">&quot;mean_se&quot;</span>)</code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/data-plot-bee-fig-2-1.png" width="576" /></p>
<p>The plot suggests immediately some problems with the plot itself and the associated analysis. First, the y-axis is counts, which means that negative values are impossible. But the standard error bars look like they use standard errors computed from a model that allows infinetly large negative values, and the illustrated standard error bars imply that negative values exist. So these error bars are misleading. Second, it is good practice, especially if sample sizes are modest or small, to “show the data”, which means, show the individual data points and not just a summary of the distribution.</p>
<p>Here are three alternative plots for exploratory purposes. The first simply “shows the data” but still uses the misleading standard error bars. The second uses a box plot. The last plots the means and 95% confidence intervals modeled with a GLM (generalized linear model) to account for the count data (the model used could be improved). Notice that the bar length above the mean is longer than the bar length below the mean (that is the interval is asymmetric about the mean). In order to stay focussed on importing data, I leave explanation of these plots and analysis to later chapters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggbarplot</span>(<span class="dt">data=</span>bee, <span class="dt">x=</span><span class="st">&quot;treatment&quot;</span>, <span class="dt">y=</span><span class="st">&quot;new_queens&quot;</span>, <span class="dt">add =</span> <span class="kw">c</span>(<span class="st">&quot;mean_se&quot;</span>, <span class="st">&quot;point&quot;</span>))</code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/data-alternative-plots-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggboxplot</span>(<span class="dt">data=</span>bee, <span class="dt">x=</span><span class="st">&quot;treatment&quot;</span>, <span class="dt">y=</span><span class="st">&quot;new_queens&quot;</span>)</code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/data-alternative-plots-2.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit.glm &lt;-<span class="st"> </span><span class="kw">glm</span>(new_queens <span class="op">~</span><span class="st"> </span>treatment, <span class="dt">data=</span>bee, <span class="dt">family=</span><span class="kw">poisson</span>())
means.glm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(fit.glm, <span class="dt">specs=</span><span class="st">&quot;treatment&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)
gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="kw">data.frame</span>(means.glm), <span class="kw">aes</span>(<span class="dt">x=</span>treatment, <span class="dt">y=</span>rate)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill=</span><span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">x=</span>treatment, <span class="dt">ymin=</span>asymp.LCL, <span class="dt">ymax=</span>asymp.UCL), <span class="dt">width=</span><span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;New queens&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="ot">NULL</span>
gg</code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/data-alternative-plots-3.png" width="576" /></p>
</div>
</div>
<div id="reshaping-data" class="section level2">
<h2><span class="header-section-number">2.3</span> Reshaping Data</h2>
<p>In general, your data should be in long format. What is long format? Consider data from a simple experiment with a response variable and a treatment variable with three levels. A common way to organize these data in Microsoft Excel is in <strong>wide format</strong>.</p>
<table>
<caption><span id="tab:unnamed-chunk-7">Table 2.1: </span>Root mass for three treatment levels in wide format</caption>
<thead>
<tr class="header">
<th align="right">control</th>
<th align="right">extract</th>
<th align="right">charcoal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10.18</td>
<td align="right">4.34</td>
<td align="right">9.57</td>
</tr>
<tr class="even">
<td align="right">10.40</td>
<td align="right">3.74</td>
<td align="right">8.59</td>
</tr>
<tr class="odd">
<td align="right">8.61</td>
<td align="right">4.58</td>
<td align="right">9.69</td>
</tr>
<tr class="even">
<td align="right">11.04</td>
<td align="right">4.12</td>
<td align="right">8.07</td>
</tr>
<tr class="odd">
<td align="right">9.24</td>
<td align="right">2.44</td>
<td align="right">7.63</td>
</tr>
</tbody>
</table>
<p>Wide format is efficient for computations in a spreadsheet, such as computing means and standard deviations of columns, and for plotting. For most statistical analyses in R (and most statistics software), all measures of a variable (such as root biomass in the example above) should be in a single column with a second column identifying the treatment level associated with each measure. This is called <strong>long format</strong>.</p>
<table>
<caption><span id="tab:unnamed-chunk-8">Table 2.2: </span>Root mass for three treatment levels in long format</caption>
<thead>
<tr class="header">
<th align="left">treatment</th>
<th align="right">root_mass</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">control</td>
<td align="right">10.18</td>
</tr>
<tr class="even">
<td align="left">control</td>
<td align="right">10.40</td>
</tr>
<tr class="odd">
<td align="left">control</td>
<td align="right">8.61</td>
</tr>
<tr class="even">
<td align="left">control</td>
<td align="right">11.04</td>
</tr>
<tr class="odd">
<td align="left">control</td>
<td align="right">9.24</td>
</tr>
<tr class="even">
<td align="left">extract</td>
<td align="right">4.34</td>
</tr>
<tr class="odd">
<td align="left">extract</td>
<td align="right">3.74</td>
</tr>
<tr class="even">
<td align="left">extract</td>
<td align="right">4.58</td>
</tr>
<tr class="odd">
<td align="left">extract</td>
<td align="right">4.12</td>
</tr>
<tr class="even">
<td align="left">extract</td>
<td align="right">2.44</td>
</tr>
<tr class="odd">
<td align="left">charcoal</td>
<td align="right">9.57</td>
</tr>
<tr class="even">
<td align="left">charcoal</td>
<td align="right">8.59</td>
</tr>
<tr class="odd">
<td align="left">charcoal</td>
<td align="right">9.69</td>
</tr>
<tr class="even">
<td align="left">charcoal</td>
<td align="right">8.07</td>
</tr>
<tr class="odd">
<td align="left">charcoal</td>
<td align="right">7.63</td>
</tr>
</tbody>
</table>
<div id="wide-to-long" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Wide to long</h3>
<p>There are many functions to tidy data from wide to long. <code>melt()</code> from the data.table package is especially useful. It is data.table’s version of melt from the reshape2 package.</p>
<p>The major arguments of data.table::melt are</p>
<p><code>melt(data, id.vars, measure.vars, variable.name, value.name)</code></p>
<p>melt takes the data in the columns listed in <code>measure.vars</code> and stacks these into a single column named <code>value.name</code>. The names of the columns in <code>measure.vars</code> are the values of the elements in a new column named <code>variable.name</code>. The elements of any column in <code>id.vars</code> are repeated <em>p</em> times, where <em>p</em> is the number of columns that were stacked.</p>
<p>Article: Rolig, A. S., Mittge, E. K., Ganz, J., Troll, J. V., Melancon, E., Wiles, T. J., … Guillemin, K. (2017). The enteric nervous system promotes intestinal health by constraining microbiota composition. PLOS Biology, 15(2), e2000689. <a href="https://doi.org/10.1371/journal.pbio.2000689" class="uri">https://doi.org/10.1371/journal.pbio.2000689</a></p>
<p><strong>Data source</strong> <a href="https://doi.org/10.1371/journal.pbio.2000689.s008" class="uri">https://doi.org/10.1371/journal.pbio.2000689.s008</a></p>
<p><strong>file name</strong>: “journal.pbio.2000689.s008.xlsx”</p>
<p>Let’s import and tidy the data for figure 2d. Look at the excel file and the data in Fig. 2d. There is a single treament with four levels, but the authors have organized the data in each level in separate columns and used the column header as the level name.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">folder &lt;-<span class="st"> &quot;Data from The enteric nervous system promotes intestinal health by constraining microbiota composition&quot;</span>
filename &lt;-<span class="st"> &quot;journal.pbio.2000689.s008.xlsx&quot;</span>

<span class="co"># figure 2D data</span>
sheet_i &lt;-<span class="st"> &quot;Figure 2&quot;</span>
range_i &lt;-<span class="st"> &quot;F2:I24&quot;</span>
file_path &lt;-<span class="st"> </span><span class="kw">here</span>(data_path, folder, filename)
<span class="co">#file_path &lt;- paste(data_path, folder, fn, sep=&quot;/&quot;)</span>
dt_wide &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="kw">read_excel</span>(file_path, <span class="dt">sheet=</span>sheet_i, <span class="dt">range=</span>range_i))
<span class="co"># clean names</span>
dt_wide &lt;-<span class="st"> </span><span class="kw">clean_names</span>(dt_wide)
<span class="co"># get rid of &quot;_donor&quot;</span>
new_colnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gf&quot;</span>, <span class="st">&quot;wt&quot;</span>, <span class="st">&quot;sox10&quot;</span>, <span class="st">&quot;iap_mo&quot;</span>)
<span class="kw">setnames</span>(dt_wide, <span class="dt">old=</span><span class="kw">colnames</span>(dt_wide), <span class="dt">new=</span>new_colnames)

<span class="co"># wide to long</span>
exp2d &lt;-<span class="st"> </span><span class="kw">melt</span>(dt_wide, 
              <span class="dt">measure.vars=</span><span class="kw">colnames</span>(dt_wide), 
              <span class="dt">variable.name=</span><span class="st">&quot;donor&quot;</span>, 
              <span class="dt">value.name=</span><span class="st">&quot;count&quot;</span>)</code></pre></div>
<p>Look at the wide and long data frames using View. For these data, the number of measures within the different treatments differs, and as a consequence, there are multiple cells with <code>NA</code> which indicates a missing value. To delete the rows with the missing values, use</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># delete rows with no data</span>
exp2d &lt;-<span class="st"> </span><span class="kw">na.omit</span>(exp2d)</code></pre></div>
<p>For both analysis and plots, we want to compare values to the control level, which is named “wt” for the exp2d data. That is, we want “wt” to be the <em>reference</em> level. To achieve this, the levels of the factor <em>donor</em> need to be re-ordered.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exp2d[, donor<span class="op">:</span><span class="er">=</span><span class="kw">factor</span>(donor, <span class="kw">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;gf&quot;</span>, <span class="st">&quot;sox10&quot;</span>, <span class="st">&quot;iap_mo&quot;</span>))]</code></pre></div>
<p>The example above is pretty easy, because the all columns in the original data frame are melted (stacked). Here is an example in which only a subset of columns are stacked. In addition, only a subset of the remaining columns are retained in the long format data frame. The data are from Panel A of supplement Fig. 8 (<a href="https://journals.plos.org/plosbiology/article/file?type=supplementary&amp;id=info:doi/10.1371/journal.pbio.2003467.s019" class="uri">https://journals.plos.org/plosbiology/article/file?type=supplementary&amp;id=info:doi/10.1371/journal.pbio.2003467.s019</a>) from</p>
<p>Kešnerová, L., Mars, R.A., Ellegaard, K.M., Troilo, M., Sauer, U. and Engel, P., 2017. Disentangling metabolic functions of bacteria in the honey bee gut. PLoS biology, 15(12), p.e2003467.</p>
<p>**data source*:** <a href="https://doi.org/10.1371/journal.pbio.2003467.s001" class="uri">https://doi.org/10.1371/journal.pbio.2003467.s001</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">folder &lt;-<span class="st"> &quot;Data from Disentangling metabolic functions of bacteria in the honey bee gut&quot;</span>
filename &lt;-<span class="st"> &quot;journal.pbio.2003467.s001.xlsx&quot;</span>

<span class="co"># figure 2D data</span>
sheet_i &lt;-<span class="st"> &quot;S8 Fig&quot;</span>
range_i &lt;-<span class="st"> &quot;A2:H12&quot;</span>
file_path &lt;-<span class="st"> </span><span class="kw">here</span>(data_path, folder, filename)
<span class="co">#file_path &lt;- paste(data_path, folder, fn, sep=&quot;/&quot;)</span>
dt_wide &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="kw">read_excel</span>(file_path, <span class="dt">sheet=</span>sheet_i, <span class="dt">range=</span>range_i))
<span class="co"># clean names</span>
dt_wide &lt;-<span class="st"> </span><span class="kw">clean_names</span>(dt_wide)

<span class="co"># wide to long</span>
stack_cols &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;replicate&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)
exp_s8a &lt;-<span class="st"> </span><span class="kw">melt</span>(dt_wide,
              <span class="dt">id.vars=</span><span class="kw">c</span>(<span class="st">&quot;media&quot;</span>, <span class="st">&quot;time_h&quot;</span>), <span class="co"># strain col not adding any information</span>
              <span class="dt">measure.vars=</span>stack_cols, 
              <span class="dt">variable.name=</span><span class="st">&quot;Replicate&quot;</span>, 
              <span class="dt">value.name=</span><span class="st">&quot;OD600&quot;</span>) <span class="co"># measure of absorbance at 600nm</span></code></pre></div>
</div>
<div id="stacking-multiple-sets-of-columns" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Stacking multiple sets of columns</h3>
<p>This example comes from my lab, where a student measured sprint speed in each fish three times prior to treatment and three times following treatment. The wide format data looked something like this</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
fd_wide &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">fish_ID=</span><span class="kw">paste0</span>(<span class="st">&quot;fish&quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>),
                      <span class="dt">treatment=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;cn&quot;</span>, <span class="st">&quot;tr&quot;</span>), <span class="dt">each=</span><span class="dv">2</span>),
                      <span class="dt">length=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">2</span>),
                      <span class="dt">pre_1=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">50</span>, <span class="dv">5</span>),
                      <span class="dt">pre_2=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">50</span>, <span class="dv">5</span>),
                      <span class="dt">pre_3=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">50</span>, <span class="dv">5</span>),
                      <span class="dt">post_1=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">50</span>, <span class="dv">5</span>),
                      <span class="dt">post_2=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">50</span>, <span class="dv">5</span>),
                      <span class="dt">post_3=</span><span class="kw">rnorm</span>(<span class="dv">4</span>, <span class="dv">50</span>, <span class="dv">5</span>)
                      )
knitr<span class="op">::</span><span class="kw">kable</span>(fd_wide, <span class="dt">digits=</span><span class="dv">1</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">fish_ID</th>
<th align="left">treatment</th>
<th align="right">length</th>
<th align="right">pre_1</th>
<th align="right">pre_2</th>
<th align="right">pre_3</th>
<th align="right">post_1</th>
<th align="right">post_2</th>
<th align="right">post_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">fish1</td>
<td align="left">cn</td>
<td align="right">10.7</td>
<td align="right">51.6</td>
<td align="right">52.9</td>
<td align="right">46.9</td>
<td align="right">49.9</td>
<td align="right">54.6</td>
<td align="right">53.1</td>
</tr>
<tr class="even">
<td align="left">fish2</td>
<td align="left">cn</td>
<td align="right">12.4</td>
<td align="right">45.9</td>
<td align="right">48.5</td>
<td align="right">38.9</td>
<td align="right">54.7</td>
<td align="right">53.9</td>
<td align="right">49.7</td>
</tr>
<tr class="odd">
<td align="left">fish3</td>
<td align="left">tr</td>
<td align="right">10.3</td>
<td align="right">52.4</td>
<td align="right">57.6</td>
<td align="right">55.6</td>
<td align="right">54.1</td>
<td align="right">50.4</td>
<td align="right">49.2</td>
</tr>
<tr class="even">
<td align="left">fish4</td>
<td align="left">tr</td>
<td align="right">15.2</td>
<td align="right">53.7</td>
<td align="right">51.9</td>
<td align="right">49.8</td>
<td align="right">53.0</td>
<td align="right">40.1</td>
<td align="right">42.6</td>
</tr>
</tbody>
</table>
<p>To analyze the response (post-treatment sprint) adjusted for pre-treatment sprint, the three pre-treatment sprint measures need to be stacked into a single column and the three post-treatment measures need to be stacked into a single column. This is easy using <code>data.table::melt</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pre_cols &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;pre&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>)
post_cols &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;post&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>)
fd &lt;-<span class="st"> </span><span class="kw">melt</span>(fd_wide,
           <span class="dt">id.vars=</span><span class="kw">c</span>(<span class="st">&quot;fish_ID&quot;</span>, <span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;length&quot;</span>),
           <span class="dt">measure.vars=</span><span class="kw">list</span>(pre_cols, post_cols),
           <span class="dt">variable.name=</span><span class="st">&quot;Order&quot;</span>,
           <span class="dt">value.name=</span><span class="kw">c</span>(<span class="st">&quot;sprint_pre&quot;</span>, <span class="st">&quot;sprint_post&quot;</span>))
knitr<span class="op">::</span><span class="kw">kable</span>(fd, <span class="dt">digits=</span><span class="dv">1</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">fish_ID</th>
<th align="left">treatment</th>
<th align="right">length</th>
<th align="left">Order</th>
<th align="right">sprint_pre</th>
<th align="right">sprint_post</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">fish1</td>
<td align="left">cn</td>
<td align="right">10.7</td>
<td align="left">1</td>
<td align="right">51.6</td>
<td align="right">49.9</td>
</tr>
<tr class="even">
<td align="left">fish2</td>
<td align="left">cn</td>
<td align="right">12.4</td>
<td align="left">1</td>
<td align="right">45.9</td>
<td align="right">54.7</td>
</tr>
<tr class="odd">
<td align="left">fish3</td>
<td align="left">tr</td>
<td align="right">10.3</td>
<td align="left">1</td>
<td align="right">52.4</td>
<td align="right">54.1</td>
</tr>
<tr class="even">
<td align="left">fish4</td>
<td align="left">tr</td>
<td align="right">15.2</td>
<td align="left">1</td>
<td align="right">53.7</td>
<td align="right">53.0</td>
</tr>
<tr class="odd">
<td align="left">fish1</td>
<td align="left">cn</td>
<td align="right">10.7</td>
<td align="left">2</td>
<td align="right">52.9</td>
<td align="right">54.6</td>
</tr>
<tr class="even">
<td align="left">fish2</td>
<td align="left">cn</td>
<td align="right">12.4</td>
<td align="left">2</td>
<td align="right">48.5</td>
<td align="right">53.9</td>
</tr>
<tr class="odd">
<td align="left">fish3</td>
<td align="left">tr</td>
<td align="right">10.3</td>
<td align="left">2</td>
<td align="right">57.6</td>
<td align="right">50.4</td>
</tr>
<tr class="even">
<td align="left">fish4</td>
<td align="left">tr</td>
<td align="right">15.2</td>
<td align="left">2</td>
<td align="right">51.9</td>
<td align="right">40.1</td>
</tr>
<tr class="odd">
<td align="left">fish1</td>
<td align="left">cn</td>
<td align="right">10.7</td>
<td align="left">3</td>
<td align="right">46.9</td>
<td align="right">53.1</td>
</tr>
<tr class="even">
<td align="left">fish2</td>
<td align="left">cn</td>
<td align="right">12.4</td>
<td align="left">3</td>
<td align="right">38.9</td>
<td align="right">49.7</td>
</tr>
<tr class="odd">
<td align="left">fish3</td>
<td align="left">tr</td>
<td align="right">10.3</td>
<td align="left">3</td>
<td align="right">55.6</td>
<td align="right">49.2</td>
</tr>
<tr class="even">
<td align="left">fish4</td>
<td align="left">tr</td>
<td align="right">15.2</td>
<td align="left">3</td>
<td align="right">49.8</td>
<td align="right">42.6</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="miscellaneous-data-wrangling" class="section level2">
<h2><span class="header-section-number">2.4</span> Miscellaneous data wrangling</h2>
<div id="vole-data" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Vole data</h3>
<p>This books uses data on the lifespans of voles given three different treatments (control, vitamin E supplementation, vitamin C supplmentation), from</p>
<p>Selman, C., McLaren, J.S., Collins, A.R., Duthie, G.G. and Speakman, J.R., 2013. Deleterious consequences of antioxidant supplementation on lifespan in a wild-derived mammal. Biology letters, 9(4), p.20130432.</p>
<ol style="list-style-type: decimal">
<li>Source: Dryad Digital Repository. <a href="https://doi.org/10.5061/dryad.31cc4/1" class="uri">https://doi.org/10.5061/dryad.31cc4/1</a></li>
<li>File: “RSBL-2013-0432 vole data.xlsx”</li>
<li>Sheet: “COLD VOLES LIFESPAN”</li>
</ol>
<p>The vole data were archived in a format that requires some wrangling before it can be analyzed. The “lifespan (days)” column contains the lifespan for all three treatment levels, that is, the lifespan values are “stacked” or in “long” format. What is unusual is that there is no “treatment” column specifying the three treatment levels (control, vitamin E, vitamin C). Instead there are control, vitamin E, and vitamin C columns that contain a 1, if the lifespan value belongs to that treatment, and a NULL value if not. On import, the NULL value is replaced with NA, to indicate “missing”. In order to analyze the data, the three treatment assignment columns need to be combined into a single “treatment” column.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">folder &lt;-<span class="st"> &quot;Data from Deleterious consequences of antioxidant supplementation on lifespan in a wild-derived mammal&quot;</span>
filename &lt;-<span class="st"> &quot;RSBL-2013-0432 vole data.xlsx&quot;</span>
file_path &lt;-<span class="st"> </span><span class="kw">here</span>(data_path, folder, filename)
vole &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="kw">read_excel</span>(file_path, <span class="dt">sheet=</span><span class="st">&quot;COLD VOLES LIFESPAN&quot;</span>, <span class="dt">range=</span><span class="st">&quot;a2:d98&quot;</span>))
<span class="co"># clean column names</span>
vole &lt;-<span class="st"> </span><span class="kw">clean_names</span>(vole)

<span class="co"># create treatment column</span>
<span class="co"># in rows where control=1, set treatment value to &quot;control&quot;</span>
vole[control<span class="op">==</span><span class="dv">1</span>, treatment<span class="op">:</span><span class="er">=</span><span class="st">&quot;control&quot;</span>]
<span class="co"># in rows where vitamin_e=1, set treatment value to &quot;vitamin_e&quot;</span>
vole[vitamin_e<span class="op">==</span><span class="dv">1</span>, treatment<span class="op">:</span><span class="er">=</span><span class="st">&quot;vitamin_E&quot;</span>]
<span class="co"># in rows where vitamin_c=1, set treatment value to &quot;vitamin_c&quot;</span>
vole[vitamin_c<span class="op">==</span><span class="dv">1</span>, treatment<span class="op">:</span><span class="er">=</span><span class="st">&quot;vitamin_C&quot;</span>]

<span class="co"># change column &quot;lifespan_days&quot; to &quot;lifespan&quot;</span>
<span class="kw">setnames</span>(vole, <span class="dt">old=</span><span class="st">&quot;lifespan_days&quot;</span>, <span class="st">&quot;lifespan&quot;</span>)</code></pre></div>
<p>Plot the data with a stripchart (often called a dot plot) to view the lifespan as a function of treatment level</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggstripchart</span>(<span class="dt">x=</span><span class="st">&quot;treatment&quot;</span>, <span class="dt">y=</span><span class="st">&quot;lifespan&quot;</span>, <span class="dt">data=</span>vole,
             <span class="dt">add =</span> <span class="kw">c</span>(<span class="st">&quot;mean_ci&quot;</span>))</code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/data-vole-plot-1.png" width="576" /></p>
</div>
</div>
<div id="saving-data" class="section level2">
<h2><span class="header-section-number">2.5</span> Saving Data</h2>
<p>For many projects, it is uncommon to save data. I might save simulated data if it takes a long time (tens of minutes to hours or even days) to generate these and I simply want to work with the simulated data in the future and not have to regenerate it. Or I might save processed data if it takes a long time import and process and I want to analyze the processed data in the future and not have to re-import and process it.</p>
<p>If the data will only be used in this or future R projects, the data can be saved as an R object using <code>saveRDS()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">save_file_path &lt;-<span class="st"> </span><span class="kw">here</span>(output_path, <span class="st">&quot;vole.Rds&quot;</span>)
<span class="kw">saveRDS</span>(<span class="dt">object =</span> vole, <span class="dt">file =</span> save_file_path)

<span class="co"># to read this use</span>
vole &lt;-<span class="st"> </span><span class="kw">readRDS</span>(save_file_path)</code></pre></div>
<p>Reading a large .Rds file is very fast compared to reading the same data stored as a text file. However, if the data need to be imported into some other software, such as a spreadsheet, then save the data as a text file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># save the data to output folder</span>

<span class="co"># tab delimited</span>
save_file_path &lt;-<span class="st"> </span><span class="kw">here</span>(output_path, <span class="st">&quot;vole.txt&quot;</span>)
<span class="kw">write.table</span>(vole, save_file_path, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">quote=</span><span class="ot">FALSE</span>)

<span class="co"># comma delimited</span>
save_file_path &lt;-<span class="st"> </span><span class="kw">here</span>(output_path, <span class="st">&quot;vole.csv&quot;</span>)
<span class="kw">write.table</span>(vole, save_file_path, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>, <span class="dt">quote=</span><span class="ot">FALSE</span>)</code></pre></div>
<p>Look at your project directory to make sure the file is where it should be! We used <code>write.table()</code> to create a tab-delimited text file using <code>sep=&quot;\t&quot;</code> to specify tabs to separate the row elements. “” is the standard character string for a tab. Check in your output folder and open the file in a text editor.</p>
</div>
<div id="problems" class="section level2">
<h2><span class="header-section-number">2.6</span> Problems</h2>
<ol style="list-style-type: decimal">
<li><p>Download the dataset “data-Lodjak.et.al-2016-FuncEcol.xlsx” from the Dryad repository at <a href="https://datadryad.org/resource/doi:10.5061/dryad.rd01s" class="uri">https://datadryad.org/resource/doi:10.5061/dryad.rd01s</a>. The .xlsx file presents the data cleanly but the trade-off is that the 1) multiple header rows, and 2) spaces in the header labels, 3) parentheses in the header labels make it more complex to import in a usable way. Import the data and plot Body Mass against Age (that is make Body Mass the “Y” variable and Age the “X” variable) using the qplot function. You should recode the column labels to remove spaces and parentheses using the setnames function.</p></li>
<li><p>Download the dataset “Results2015.txt” from the Dryad repository at <a href="https://datadryad.org//resource/doi:10.5061/dryad.65vk4" class="uri">https://datadryad.org//resource/doi:10.5061/dryad.65vk4</a>. Try to reproduce Fig. 1. It’s not easy. I’ve inserted the figure below but also download the paper and look at Fig. 1.</p></li>
</ol>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/problem2-1.png" width="576" /></p>
<ol start="3" style="list-style-type: decimal">
<li>(grad students only) Download and plot data from a Dryad Repository dataset of your choice.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="organization-r-projects-and-r-notebooks.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="part-ii-some-fundamentals-of-statistical-modeling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/06-data-reading_writing.Rmd",
"text": "Edit"
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
