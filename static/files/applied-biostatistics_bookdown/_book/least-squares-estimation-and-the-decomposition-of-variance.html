<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 8 Least Squares Estimation and the Decomposition of Variance | Elementary Statistical Modeling for Applied Biostatistics</title>
  <meta name="description" content="A first course in statistical modeling for biology students">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 8 Least Squares Estimation and the Decomposition of Variance | Elementary Statistical Modeling for Applied Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A first course in statistical modeling for biology students" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Least Squares Estimation and the Decomposition of Variance | Elementary Statistical Modeling for Applied Biostatistics" />
  
  <meta name="twitter:description" content="A first course in statistical modeling for biology students" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="a-linear-model-with-a-single-categorical-x.html">
<link rel="next" href="model-checking-1.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#math"><i class="fa fa-check"></i><b>0.1</b> Math</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#r-and-programming"><i class="fa fa-check"></i><b>0.2</b> R and programming</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-r-fundamentals.html"><a href="part-i-r-fundamentals.html"><i class="fa fa-check"></i>Part I: R fundamentals</a></li>
<li class="chapter" data-level="1" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html"><i class="fa fa-check"></i><b>1</b> Organization – R Projects and R Notebooks</a><ul>
<li class="chapter" data-level="1.1" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#importing-packages"><i class="fa fa-check"></i><b>1.1</b> Importing Packages</a></li>
<li class="chapter" data-level="1.2" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-an-r-studio-project-for-this-class"><i class="fa fa-check"></i><b>1.2</b> Create an R Studio Project for this Class</a></li>
<li class="chapter" data-level="1.3" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#r-notebooks"><i class="fa fa-check"></i><b>1.3</b> R Notebooks</a><ul>
<li class="chapter" data-level="1.3.1" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-an-r-notebook-for-this-chapter"><i class="fa fa-check"></i><b>1.3.1</b> Create an R Notebook for this Chapter</a></li>
<li class="chapter" data-level="1.3.2" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-a-setup-chunk"><i class="fa fa-check"></i><b>1.3.2</b> Create a “setup” chunk</a></li>
<li class="chapter" data-level="1.3.3" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-a-simple-plot-chunk"><i class="fa fa-check"></i><b>1.3.3</b> Create a “simple plot” chunk</a></li>
<li class="chapter" data-level="1.3.4" data-path="organization-r-projects-and-r-notebooks.html"><a href="organization-r-projects-and-r-notebooks.html#create-more-r-chunks-and-explore-options-and-play-with-r-code"><i class="fa fa-check"></i><b>1.3.4</b> Create more R chunks and explore options and play with R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html"><i class="fa fa-check"></i><b>2</b> Data – Importing and Saving Data</a><ul>
<li class="chapter" data-level="2.1" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#create-new-notebook-for-this-chapter"><i class="fa fa-check"></i><b>2.1</b> Create new notebook for this chapter</a></li>
<li class="chapter" data-level="2.2" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#importing-data"><i class="fa fa-check"></i><b>2.2</b> Importing Data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#excel-file"><i class="fa fa-check"></i><b>2.2.1</b> Excel File</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#text-file"><i class="fa fa-check"></i><b>2.2.2</b> Text File</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#saving-data"><i class="fa fa-check"></i><b>2.3</b> Saving Data</a></li>
<li class="chapter" data-level="2.4" data-path="data-importing-and-saving-data.html"><a href="data-importing-and-saving-data.html#problems"><i class="fa fa-check"></i><b>2.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-statistics-fundamentals.html"><a href="part-ii-statistics-fundamentals.html"><i class="fa fa-check"></i>Part II: Statistics fundamentals</a></li>
<li class="chapter" data-level="3" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><i class="fa fa-check"></i><b>3</b> Variability and Uncertainty (Standard Deviations and Standard Errors)</a><ul>
<li class="chapter" data-level="3.1" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#the-sample-standard-deviation-vs.the-standard-error-of-the-mean"><i class="fa fa-check"></i><b>3.1</b> The sample standard deviation vs. the standard error of the mean</a><ul>
<li class="chapter" data-level="3.1.1" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#sample-standard-deviation"><i class="fa fa-check"></i><b>3.1.1</b> Sample standard deviation</a></li>
<li class="chapter" data-level="3.1.2" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>3.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#using-google-sheets-to-generate-fake-data-to-explore-uncertainty"><i class="fa fa-check"></i><b>3.2</b> Using Google Sheets to generate fake data to explore uncertainty</a><ul>
<li class="chapter" data-level="3.2.1" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#steps"><i class="fa fa-check"></i><b>3.2.1</b> Steps</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#using-r-to-generate-fake-data-to-explore-uncertainty"><i class="fa fa-check"></i><b>3.3</b> Using R to generate fake data to explore uncertainty</a><ul>
<li class="chapter" data-level="3.3.1" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#part-i"><i class="fa fa-check"></i><b>3.3.1</b> part I</a></li>
<li class="chapter" data-level="3.3.2" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#part-ii---means"><i class="fa fa-check"></i><b>3.3.2</b> part II - means</a></li>
<li class="chapter" data-level="3.3.3" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#part-iii---how-do-sd-and-se-change-as-sample-size-n-increases"><i class="fa fa-check"></i><b>3.3.3</b> part III - how do SD and SE change as sample size (n) increases?</a></li>
<li class="chapter" data-level="3.3.4" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#part-iv-generating-fake-data-with-for-loops"><i class="fa fa-check"></i><b>3.3.4</b> Part IV – Generating fake data with “for loops”</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="variability-and-uncertainty-standard-deviations-and-standard-errors.html"><a href="variability-and-uncertainty-standard-deviations-and-standard-errors.html#bootstrapped-standard-errors"><i class="fa fa-check"></i><b>3.4</b> Bootstrapped standard errors</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="creating-fake-data.html"><a href="creating-fake-data.html"><i class="fa fa-check"></i><b>4</b> Creating Fake Data</a><ul>
<li class="chapter" data-level="4.0.1" data-path="creating-fake-data.html"><a href="creating-fake-data.html#continuous-x-fake-observational-data"><i class="fa fa-check"></i><b>4.0.1</b> Continuous X (fake observational data)</a></li>
<li class="chapter" data-level="4.0.2" data-path="creating-fake-data.html"><a href="creating-fake-data.html#categorical-x-fake-experimental-data"><i class="fa fa-check"></i><b>4.0.2</b> Categorical X (fake experimental data)</a></li>
<li class="chapter" data-level="4.0.3" data-path="creating-fake-data.html"><a href="creating-fake-data.html#correlated-x-fake-observational-data"><i class="fa fa-check"></i><b>4.0.3</b> Correlated X (fake observational data)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-statistical-modeling.html"><a href="part-iii-statistical-modeling.html"><i class="fa fa-check"></i>Part III: Statistical Modeling</a></li>
<li class="chapter" data-level="5" data-path="statistical-modeling.html"><a href="statistical-modeling.html"><i class="fa fa-check"></i><b>5</b> Statistical Modeling</a><ul>
<li class="chapter" data-level="5.1" data-path="statistical-modeling.html"><a href="statistical-modeling.html#two-specifications-of-a-linear-model"><i class="fa fa-check"></i><b>5.1</b> Two specifications of a linear model</a><ul>
<li class="chapter" data-level="5.1.1" data-path="statistical-modeling.html"><a href="statistical-modeling.html#the-random-error-specification"><i class="fa fa-check"></i><b>5.1.1</b> The “random error” specification</a></li>
<li class="chapter" data-level="5.1.2" data-path="statistical-modeling.html"><a href="statistical-modeling.html#the-random-draw-specification"><i class="fa fa-check"></i><b>5.1.2</b> The “random draw” specification</a></li>
<li class="chapter" data-level="5.1.3" data-path="statistical-modeling.html"><a href="statistical-modeling.html#comparing-the-two-ways-of-specifying-the-linear-model"><i class="fa fa-check"></i><b>5.1.3</b> Comparing the two ways of specifying the linear model</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="statistical-modeling.html"><a href="statistical-modeling.html#what-do-we-call-the-x-and-y-variables"><i class="fa fa-check"></i><b>5.2</b> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li class="chapter" data-level="5.3" data-path="statistical-modeling.html"><a href="statistical-modeling.html#statistical-models-are-used-for-prediction-explanation-and-description"><i class="fa fa-check"></i><b>5.3</b> Statistical models are used for prediction, explanation, and description</a></li>
<li class="chapter" data-level="5.4" data-path="statistical-modeling.html"><a href="statistical-modeling.html#modeling-strategy"><i class="fa fa-check"></i><b>5.4</b> Modeling strategy</a></li>
<li class="chapter" data-level="5.5" data-path="statistical-modeling.html"><a href="statistical-modeling.html#a-mean-is-the-simplest-model"><i class="fa fa-check"></i><b>5.5</b> A mean is the simplest model</a></li>
<li class="chapter" data-level="5.6" data-path="statistical-modeling.html"><a href="statistical-modeling.html#assumptions-for-inference-with-a-statistical-model"><i class="fa fa-check"></i><b>5.6</b> Assumptions for inference with a statistical model</a></li>
<li class="chapter" data-level="5.7" data-path="statistical-modeling.html"><a href="statistical-modeling.html#specific-assumptions-for-inference-with-a-linear-model"><i class="fa fa-check"></i><b>5.7</b> Specific assumptions for inference with a linear model</a></li>
<li class="chapter" data-level="5.8" data-path="statistical-modeling.html"><a href="statistical-modeling.html#statistical-model-or-regression-model"><i class="fa fa-check"></i><b>5.8</b> “Statistical model” or “regression model”?</a></li>
<li class="chapter" data-level="5.9" data-path="statistical-modeling.html"><a href="statistical-modeling.html#glm-vs.glm-vs.gls"><i class="fa fa-check"></i><b>5.9</b> GLM vs. GLM vs. GLS</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html"><i class="fa fa-check"></i><b>6</b> A linear model with a single, continuous <em>X</em></a><ul>
<li class="chapter" data-level="6.1" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><i class="fa fa-check"></i><b>6.1</b> A linear model with a single, continuous <em>X</em> is classical “regression”</a><ul>
<li class="chapter" data-level="6.1.1" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#using-a-linear-model-to-estimate-explanatory-effects"><i class="fa fa-check"></i><b>6.1.1</b> Using a linear model to estimate explanatory effects</a></li>
<li class="chapter" data-level="6.1.2" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#using-a-linear-model-for-prediction"><i class="fa fa-check"></i><b>6.1.2</b> Using a linear model for prediction</a></li>
<li class="chapter" data-level="6.1.3" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#reporting-results"><i class="fa fa-check"></i><b>6.1.3</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#working-in-r"><i class="fa fa-check"></i><b>6.2</b> Working in R</a><ul>
<li class="chapter" data-level="6.2.1" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#exploring-the-bivariate-relationship-between-y-and-x"><i class="fa fa-check"></i><b>6.2.1</b> Exploring the bivariate relationship between <em>Y</em> and <em>X</em></a></li>
<li class="chapter" data-level="6.2.2" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#fitting-the-linear-model"><i class="fa fa-check"></i><b>6.2.2</b> Fitting the linear model</a></li>
<li class="chapter" data-level="6.2.3" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#getting-to-know-the-linear-model-the-summary-function"><i class="fa fa-check"></i><b>6.2.3</b> Getting to know the linear model: the <code>summary</code> function</a></li>
<li class="chapter" data-level="6.2.4" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#display-an-alternative-to-summary"><i class="fa fa-check"></i><b>6.2.4</b> display: An alternative to summary</a></li>
<li class="chapter" data-level="6.2.5" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#confidence-intervals"><i class="fa fa-check"></i><b>6.2.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="6.2.6" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#how-good-is-our-model"><i class="fa fa-check"></i><b>6.2.6</b> How good is our model?</a></li>
<li class="chapter" data-level="6.2.7" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#exploring-a-lm-object"><i class="fa fa-check"></i><b>6.2.7</b> exploring a lm object</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="a-linear-model-with-a-single-continuous-x.html"><a href="a-linear-model-with-a-single-continuous-x.html#problems-1"><i class="fa fa-check"></i><b>6.3</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iv-linear-models-for-experimental-data.html"><a href="part-iv-linear-models-for-experimental-data.html"><i class="fa fa-check"></i>Part IV: Linear Models for Experimental Data</a></li>
<li class="chapter" data-level="7" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html"><i class="fa fa-check"></i><b>7</b> A linear model with a single, categorical <em>X</em></a><ul>
<li class="chapter" data-level="7.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#a-linear-model-with-a-single-categorical-x-is-the-engine-behind-a-single-factor-one-way-anova-and-a-t-test-is-a-special-case-of-this-model."><i class="fa fa-check"></i><b>7.1</b> A linear model with a single, categorical <em>X</em> is the engine behind a single factor (one-way) ANOVA and a t-test is a special case of this model.</a><ul>
<li class="chapter" data-level="7.1.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#table-of-model-coefficients"><i class="fa fa-check"></i><b>7.1.1</b> Table of model coefficients</a></li>
<li class="chapter" data-level="7.1.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#the-linear-model"><i class="fa fa-check"></i><b>7.1.2</b> The linear model</a></li>
<li class="chapter" data-level="7.1.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#reporting-results-1"><i class="fa fa-check"></i><b>7.1.3</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#working-in-r-1"><i class="fa fa-check"></i><b>7.2</b> Working in R</a><ul>
<li class="chapter" data-level="7.2.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#exploring-the-relationship-between-y-and-x"><i class="fa fa-check"></i><b>7.2.1</b> Exploring the relationship between <em>Y</em> and <em>X</em></a></li>
<li class="chapter" data-level="7.2.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#fitting-the-model"><i class="fa fa-check"></i><b>7.2.2</b> Fitting the model</a></li>
<li class="chapter" data-level="7.2.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#an-introduction-to-contrasts"><i class="fa fa-check"></i><b>7.2.3</b> An introduction to contrasts</a></li>
<li class="chapter" data-level="7.2.4" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#harrell-plot"><i class="fa fa-check"></i><b>7.2.4</b> Harrell plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="least-squares-estimation-and-the-decomposition-of-variance.html"><a href="least-squares-estimation-and-the-decomposition-of-variance.html"><i class="fa fa-check"></i><b>8</b> Least Squares Estimation and the Decomposition of Variance</a><ul>
<li class="chapter" data-level="8.1" data-path="least-squares-estimation-and-the-decomposition-of-variance.html"><a href="least-squares-estimation-and-the-decomposition-of-variance.html#ols-regression"><i class="fa fa-check"></i><b>8.1</b> OLS regression</a></li>
<li class="chapter" data-level="8.2" data-path="least-squares-estimation-and-the-decomposition-of-variance.html"><a href="least-squares-estimation-and-the-decomposition-of-variance.html#how-well-does-the-model-fit-the-data-r2-and-variance-explained"><i class="fa fa-check"></i><b>8.2</b> How well does the model fit the data? <span class="math inline">\(R^2\)</span> and “variance explained”</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="model-checking-1.html"><a href="model-checking-1.html"><i class="fa fa-check"></i><b>9</b> Model Checking</a><ul>
<li class="chapter" data-level="9.1" data-path="model-checking-1.html"><a href="model-checking-1.html#all-statistical-analyses-should-be-followed-by-model-checking"><i class="fa fa-check"></i><b>9.1</b> All statistical analyses should be followed by model checking</a></li>
<li class="chapter" data-level="9.2" data-path="model-checking-1.html"><a href="model-checking-1.html#linear-model-assumptions"><i class="fa fa-check"></i><b>9.2</b> Linear model assumptions</a></li>
<li class="chapter" data-level="9.3" data-path="model-checking-1.html"><a href="model-checking-1.html#a-common-misconception-is-that-inference-from-a-linear-model-assumes-that-the-response-y-is-iid-normal.-this-is-wrong."><i class="fa fa-check"></i><b>9.3</b> A common misconception is that inference from a linear model assumes that the <em>response</em> (<span class="math inline">\(Y\)</span>) is IID Normal. This is wrong.</a></li>
<li class="chapter" data-level="9.4" data-path="model-checking-1.html"><a href="model-checking-1.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>9.4</b> Diagnostic plots use the residuals from the model fit</a><ul>
<li class="chapter" data-level="9.4.1" data-path="model-checking-1.html"><a href="model-checking-1.html#a-normal-q-q-plot-is-used-to-check-normality"><i class="fa fa-check"></i><b>9.4.1</b> A Normal Q-Q plot is used to check normality</a></li>
<li class="chapter" data-level="9.4.2" data-path="model-checking-1.html"><a href="model-checking-1.html#outliers---an-outlier-is-a-point-that-is-highly-unexpected-given-the-modeled-distribution."><i class="fa fa-check"></i><b>9.4.2</b> Outliers - an outlier is a point that is highly unexpected given the modeled distribution.</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="model-checking-1.html"><a href="model-checking-1.html#model-checking-homoskedasticity"><i class="fa fa-check"></i><b>9.5</b> Model checking homoskedasticity</a></li>
<li class="chapter" data-level="9.6" data-path="model-checking-1.html"><a href="model-checking-1.html#model-checking-independence---hapiness-adverse-example."><i class="fa fa-check"></i><b>9.6</b> Model checking independence - hapiness adverse example.</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="plotting-models.html"><a href="plotting-models.html"><i class="fa fa-check"></i><b>10</b> Plotting Models</a><ul>
<li class="chapter" data-level="10.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data"><i class="fa fa-check"></i><b>10.1</b> Pretty good plots show the model and the data</a><ul>
<li class="chapter" data-level="10.1.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot"><i class="fa fa-check"></i><b>10.1.1</b> Pretty good plot component 1: Modeled effects plot</a></li>
<li class="chapter" data-level="10.1.2" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot-with-jittered-raw-data"><i class="fa fa-check"></i><b>10.1.2</b> Pretty good plot component 2: Modeled mean and CI plot with jittered raw data</a></li>
<li class="chapter" data-level="10.1.3" data-path="plotting-models.html"><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><i class="fa fa-check"></i><b>10.1.3</b> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="plotting-models.html"><a href="plotting-models.html#some-comments-on-plot-components"><i class="fa fa-check"></i><b>10.2</b> Some comments on plot components</a></li>
<li class="chapter" data-level="10.3" data-path="plotting-models.html"><a href="plotting-models.html#working-in-r-2"><i class="fa fa-check"></i><b>10.3</b> Working in R</a><ul>
<li class="chapter" data-level="10.3.1" data-path="plotting-models.html"><a href="plotting-models.html#adding-modeled-error-intervals"><i class="fa fa-check"></i><b>10.3.1</b> Adding modeled error intervals</a></li>
<li class="chapter" data-level="10.3.2" data-path="plotting-models.html"><a href="plotting-models.html#adding-p-values"><i class="fa fa-check"></i><b>10.3.2</b> Adding p-values</a></li>
<li class="chapter" data-level="10.3.3" data-path="plotting-models.html"><a href="plotting-models.html#adding-custom-p-values"><i class="fa fa-check"></i><b>10.3.3</b> Adding custom p-values</a></li>
<li class="chapter" data-level="10.3.4" data-path="plotting-models.html"><a href="plotting-models.html#plotting-two-factors"><i class="fa fa-check"></i><b>10.3.4</b> Plotting two factors</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Elementary Statistical Modeling for Applied Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="least-squares-estimation-and-the-decomposition-of-variance" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Least Squares Estimation and the Decomposition of Variance</h1>
<p>The linear models in the last chapter and for much of this book are fit to data using a method called “ordinary least squares” (OLS). This chapter explores the meaning of OLS and related statistics, including <span class="math inline">\(R^2\)</span>, as well as some alternative methods for bivariate regression.</p>
<div id="ols-regression" class="section level2">
<h2><span class="header-section-number">8.1</span> OLS regression</h2>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/fake-data-ma-1.png" width="576" /></p>
<p>The fake data illustrated in the scatterplot above (Figure <a href="#fig:fake-data-ma"><strong>??</strong></a>) were modeled to look something like the squirrel fecal cortisol metabolite data in the previous chapter. If a typical student is asked to draw a regression line through the scatter, they typically draw a line similar to that in Figure <a href="#fig:fake-data-ma"><strong>??</strong></a>. This line is not the OLS regression line but the major axis of an elipse that encloses the scatter of points–that students invariably draw this line suggests that the brain interprets the major axis of an elliptical scatter of points as a trend (This major axis line is an alternative method for estimating a slope and is known as standard major-axis regression. More about this at the end of this chapter.)</p>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/fake-data-ols-1.png" width="576" /></p>
<p>The OLS regression line is the red line in Figure <a href="#fig:fake-data-ols"><strong>??</strong></a> – the standard major axis line is left for comparison). The OLS regression line</p>
<ol style="list-style-type: decimal">
<li>passes through the bivariate mean (<span class="math inline">\(\bar{x}\)</span>, <span class="math inline">\(\bar{y}\)</span>) of the scatter, and</li>
<li>minimizes the sum of the squared deviations from each point to it’s modeled value <span class="math inline">\(\sum{(y_i - \hat{y}_i)^2}\)</span></li>
</ol>
<p>There are an infinite number of lines that pass through the bivariate mean (think of anchoring a line at the bivariate mean and spinning it). The OLS line is the line that minimizes the squared (vertical) deviations (“least squares”).</p>
<p>For a bivariate regression, the slope (coefficient <span class="math inline">\(b_1\)</span> of <span class="math inline">\(X\)</span>) of the OLS model fit is computed by</p>
<span class="math display">\[\begin{equation}
b_1 = \frac{\mathrm{COV}(X, Y)}{\mathrm{VAR}(X)}
\end{equation}\]</span>
<p>This equation is worth memorizing. We will generalize this into a more flexible equation in a few chapters.</p>
</div>
<div id="how-well-does-the-model-fit-the-data-r2-and-variance-explained" class="section level2">
<h2><span class="header-section-number">8.2</span> How well does the model fit the data? <span class="math inline">\(R^2\)</span> and “variance explained”</h2>
<p>Let’s switch to real data.</p>
<ol style="list-style-type: decimal">
<li>Source: Dryad Digital Repository. <a href="https://doi.org/10.5061/dryad.056r5" class="uri">https://doi.org/10.5061/dryad.056r5</a></li>
<li>File: “Diet-shift data.xls”</li>
</ol>
<p>Fish require arachidonic acid (ARA) and other highyly unsaturated fatty acids in their diet and embryo and yolk-stage larvae obtain these from yolk. Fuiman and Faulk (xxx) designed an experiment to investigate if red drum (<em>Sciaenops ocellatus</em>) mothers provision the yolk with ARA from recent dietary intake or from stored sources in somatic tissues. The data below are from experiment 8. The <em>x</em>-axis is the days since a diet shift to more and less ARA (<span class="math inline">\(days\)</span>) and the <em>y</em>-axis is the ARA content of the eggs (<span class="math inline">\(ARA\)</span>).</p>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/egg-data-1.png" width="576" /></p>
<p>The statistic <span class="math inline">\(R^2\)</span> is a measure of the fit of a model to data. The <span class="math inline">\(R^2\)</span> for the fit of the egg data is 0.42. <span class="math inline">\(R^2\)</span> is the fraction of two variances <span class="math inline">\(\frac{\mathrm{VAR}(Model)}{\mathrm{VAR}(Y)}\)</span>, or, the fraction of the variance of <span class="math inline">\(Y\)</span> “explained by the model.” The value of <span class="math inline">\(R^2\)</span> ranges from zero (the fit cannot be any worse) to one (the fit is “pefect”).</p>
<p>To understand <span class="math inline">\(R^2\)</span>, and its computation, a bit more, let’s look at three kinds of deviations.</p>
<div class="figure"><span id="fig:ols-deviations"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/ols-deviations-1.png" alt="Three kinds of deviations from a fit model. A. Deviations of the measured values from the mean. These are in the numerator of the equation of the sample variance. The dashed line is the mean ARA content. B. Deviations of the measured values from the modeled values. The sum of these deviations squared is what is minimized in an OLS fit. C. Deviations of the modeled values from the mean ARA content. The measured values are in gray, the modeled values in black" width="576" />
<p class="caption">
Figure 8.1: Three kinds of deviations from a fit model. A. Deviations of the measured values from the mean. These are in the numerator of the equation of the sample variance. The dashed line is the mean ARA content. B. Deviations of the measured values from the modeled values. The sum of these deviations squared is what is minimized in an OLS fit. C. Deviations of the modeled values from the mean ARA content. The measured values are in gray, the modeled values in black
</p>
</div>
<p>Figure <a href="least-squares-estimation-and-the-decomposition-of-variance.html#fig:ols-deviations">8.1</a>A shows the deviations from the measured values to the mean value (dashed line). These are the deviations in the numerator of the equation to compute the variance of <span class="math inline">\(ARA_EGG_MG\)</span>. Figure <a href="least-squares-estimation-and-the-decomposition-of-variance.html#fig:ols-deviations">8.1</a>B shows the deviations of the measured values from the modeled values. The sum of these deviations squared is what is minimized by the OLS fit. The bigger these deviations are, the worse the model fit. Figure <a href="least-squares-estimation-and-the-decomposition-of-variance.html#fig:ols-deviations">8.1</a>C shows the deviations of the modeled values to the mean value. The bigger these deviations are, the better the model fit.</p>
<p>The sums of the squares of these deviations (or “sums of squares”) have names:</p>
<span class="math display">\[\begin{equation}
\mathrm{SS(total)} = \sum{(y_i - \bar{y})^2}
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
\mathrm{SS(error)} = \sum{(y_i - \hat{y_i})^2}
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
\mathrm{SS(model)} = \sum{(\hat{y_i} - \bar{y})^2}
\end{equation}\]</span>
<p>Again, <span class="math inline">\(\mathrm{SS(total)}\)</span> is the numerator of the equation for the sample variance. It is called “s-s-total” because <span class="math inline">\(\mathrm{SS(total)} = \mathrm{SS(model)} + \mathrm{SS(error)}\)</span>. That is, the total sums of squares can be <strong>decomposed</strong> into two <strong>components</strong>: the modeled sums of squares and the error sums of squares. Given these components, it’s easy to understand <span class="math inline">\(R^2\)</span></p>
<span class="math display">\[\begin{equation}
R^2 = \frac{SS(model)}{SS(total)}
\end{equation}\]</span>
<p><span class="math inline">\(R^2\)</span> is the fraction of the total sums of squares that is due to (or “explained by”) the model sums of squares. Above I said that <span class="math inline">\(R^2\)</span> is the fraction of <em>variance</em> explained by the model. Equation xxx is a ratio of variance, but the <span class="math inline">\((n-1)^{-1}\)</span> in both the numerator and the denominator cancel out. Finally, many sources give the equation for <span class="math inline">\(R^2\)</span> as</p>
<span class="math display">\[\begin{equation}
R^2 = 1- \frac{SS(error)}{SS(total)}
\end{equation}\]</span>
<p>which is an obvious alternative given the decomposition. I prefer the former equation because it emphasizes the model fit instead of model ill-fit.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-linear-model-with-a-single-categorical-x.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-checking-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/26-least_squares.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
