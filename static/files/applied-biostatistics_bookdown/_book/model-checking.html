<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Model Checking | Applied Statistics for Experimental Biology</title>
  <meta name="description" content="An introduction to statistical modeling for experimental biology researchers" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Model Checking | Applied Statistics for Experimental Biology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Model Checking | Applied Statistics for Experimental Biology" />
  
  <meta name="twitter:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="oneway.html"/>
<link rel="next" href="violations.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="index.html#why-bother-with-linear-models-arent-t-tests-and-anova-good-enough" id="toc-why-bother-with-linear-models-arent-t-tests-and-anova-good-enough">Why bother with linear models – aren’t <em>t</em>-tests and ANOVA good enough?</a></li>
<li><a href="index.html#what-is-unusual-about-this-book" id="toc-what-is-unusual-about-this-book">What is unusual about this book?</a></li>
</ul></li>
<li><a href="a-table-of-models.html#a-table-of-models" id="toc-a-table-of-models">A Table of Models</a>
<ul>
<li><a href="a-table-of-models.html#including-mapping-between-linear-models-and-classical-tests" id="toc-including-mapping-between-linear-models-and-classical-tests">including mapping between linear models and classical tests</a></li>
</ul></li>
<li><a href="ask1-intro.html#ask1-intro" id="toc-ask1-intro"><span class="toc-section-number">1</span> Analyzing experimental data with a linear model</a>
<ul>
<li><a href="ask1-intro.html#this-text-is-about-using-linear-models-to-estimate-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect" id="toc-this-text-is-about-using-linear-models-to-estimate-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect"><span class="toc-section-number">1.1</span> This text is about using linear models to estimate treatment effects and the uncertainty in our estimates. This, raises the question, what is “an effect”?</a></li>
</ul></li>
<li><a href="part-i-getting-started.html#part-i-getting-started" id="toc-part-i-getting-started">Part I: Getting Started</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#getting-started-r-projects-and-r-markdown" id="toc-getting-started-r-projects-and-r-markdown"><span class="toc-section-number">2</span> Getting Started – R Projects and R Markdown</a>
<ul>
<li><a href="getting-started-r-projects-and-r-markdown.html#r-vs-r-studio" id="toc-r-vs-r-studio"><span class="toc-section-number">2.1</span> R vs R Studio</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#download-and-install-r-and-r-studio" id="toc-download-and-install-r-and-r-studio"><span class="toc-section-number">2.2</span> Download and install R and R studio</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#open-r-studio-and-modify-the-workspace-preference" id="toc-open-r-studio-and-modify-the-workspace-preference"><span class="toc-section-number">2.3</span> Open R Studio and modify the workspace preference</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it" id="toc-if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it"><span class="toc-section-number">2.4</span> If you didn’t modify the workspace preferences from the previous section, go back and do it</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#r-markdown-in-a-nutshell" id="toc-r-markdown-in-a-nutshell"><span class="toc-section-number">2.5</span> R Markdown in a nutshell</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#install-r-markdown" id="toc-install-r-markdown"><span class="toc-section-number">2.6</span> Install R Markdown</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#importing-packages" id="toc-importing-packages"><span class="toc-section-number">2.7</span> Importing Packages</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#setup-create-project" id="toc-setup-create-project"><span class="toc-section-number">2.8</span> Create an R Studio Project for this textbook</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#working-on-a-project-in-a-nutshell" id="toc-working-on-a-project-in-a-nutshell"><span class="toc-section-number">2.9</span> Working on a project, in a nutshell</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#setup-create-rmd" id="toc-setup-create-rmd"><span class="toc-section-number">2.10</span> Create and setup an R Markdown document (Rmd)</a>
<ul>
<li><a href="getting-started-r-projects-and-r-markdown.html#modify-the-yaml-header" id="toc-modify-the-yaml-header"><span class="toc-section-number">2.10.1</span> Modify the yaml header</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#modify-the-setup-chunk" id="toc-modify-the-setup-chunk"><span class="toc-section-number">2.10.2</span> Modify the “setup” chunk</a></li>
</ul></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#lets-play-around-with-an-r-markdown-file" id="toc-lets-play-around-with-an-r-markdown-file"><span class="toc-section-number">2.11</span> Let’s play around with an R Markdown file</a>
<ul>
<li><a href="getting-started-r-projects-and-r-markdown.html#create-a-fake-data-chunk" id="toc-create-a-fake-data-chunk"><span class="toc-section-number">2.11.1</span> Create a “fake-data” chunk</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#create-a-plot-chunk" id="toc-create-a-plot-chunk"><span class="toc-section-number">2.11.2</span> Create a “plot” chunk</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#knit-the-rmd" id="toc-knit-the-rmd"><span class="toc-section-number">2.11.3</span> Knit the Rmd</a></li>
</ul></li>
</ul></li>
<li><a href="part-ii-r-fundamentals.html#part-ii-r-fundamentals" id="toc-part-ii-r-fundamentals">Part II: R fundamentals</a></li>
<li><a href="data.html#data" id="toc-data"><span class="toc-section-number">3</span> Data – Reading, Wrangling, and Writing</a>
<ul>
<li><a href="data.html#data-long" id="toc-data-long"><span class="toc-section-number">3.1</span> Long data format – the way data should be</a></li>
<li><a href="data.html#data-here" id="toc-data-here"><span class="toc-section-number">3.2</span> Use the here function to construct the file path</a></li>
<li><a href="data.html#learning-from-this-chapter" id="toc-learning-from-this-chapter"><span class="toc-section-number">3.3</span> Learning from this chapter</a></li>
<li><a href="data.html#data-working-in-r" id="toc-data-working-in-r"><span class="toc-section-number">3.4</span> Working in R</a>
<ul>
<li><a href="data.html#importing-data" id="toc-importing-data"><span class="toc-section-number">3.4.1</span> Importing data</a></li>
</ul></li>
<li><a href="data.html#data-wrangling" id="toc-data-wrangling"><span class="toc-section-number">3.5</span> Data wrangling</a>
<ul>
<li><a href="data.html#reshaping-data-wide-to-long" id="toc-reshaping-data-wide-to-long"><span class="toc-section-number">3.5.1</span> Reshaping data – Wide to long</a></li>
<li><a href="data.html#reshaping-data-transpose-turning-the-columns-into-rows" id="toc-reshaping-data-transpose-turning-the-columns-into-rows"><span class="toc-section-number">3.5.2</span> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li><a href="data.html#combining-data" id="toc-combining-data"><span class="toc-section-number">3.5.3</span> Combining data</a></li>
<li><a href="data.html#data-subset" id="toc-data-subset"><span class="toc-section-number">3.5.4</span> Subsetting data</a></li>
<li><a href="data.html#wrangling-columns" id="toc-wrangling-columns"><span class="toc-section-number">3.5.5</span> Wrangling columns</a></li>
<li><a href="data.html#missing-data" id="toc-missing-data"><span class="toc-section-number">3.5.6</span> Missing data</a></li>
</ul></li>
<li><a href="data.html#saving-data" id="toc-saving-data"><span class="toc-section-number">3.6</span> Saving data</a></li>
<li><a href="data.html#exercises" id="toc-exercises"><span class="toc-section-number">3.7</span> Exercises</a></li>
</ul></li>
<li><a href="plotting-models.html#plotting-models" id="toc-plotting-models"><span class="toc-section-number">4</span> Plotting Models</a>
<ul>
<li><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data" id="toc-pretty-good-plots-show-the-model-and-the-data"><span class="toc-section-number">4.1</span> Pretty good plots show the model and the data</a>
<ul>
<li><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot" id="toc-pretty-good-plot-component-1-modeled-effects-plot"><span class="toc-section-number">4.1.1</span> Pretty good plot component 1: Modeled effects plot</a></li>
<li><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot" id="toc-pretty-good-plot-component-2-modeled-mean-and-ci-plot"><span class="toc-section-number">4.1.2</span> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot." id="toc-combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><span class="toc-section-number">4.1.3</span> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
<li><a href="plotting-models.html#some-comments-on-plot-components" id="toc-some-comments-on-plot-components"><span class="toc-section-number">4.1.4</span> Some comments on plot components</a></li>
</ul></li>
<li><a href="plotting-models.html#working-in-r" id="toc-working-in-r"><span class="toc-section-number">4.2</span> Working in R</a>
<ul>
<li><a href="plotting-models.html#source-data" id="toc-source-data"><span class="toc-section-number">4.2.1</span> Source data</a></li>
<li><a href="plotting-models.html#how-to-plot-the-model" id="toc-how-to-plot-the-model"><span class="toc-section-number">4.2.2</span> How to plot the model</a></li>
<li><a href="plotting-models.html#be-sure-ggplot_the_model-is-in-your-r-folder" id="toc-be-sure-ggplot_the_model-is-in-your-r-folder"><span class="toc-section-number">4.2.3</span> Be sure ggplot_the_model is in your R folder</a></li>
<li><a href="plotting-models.html#how-to-use-the-plot-the-model-functions" id="toc-how-to-use-the-plot-the-model-functions"><span class="toc-section-number">4.2.4</span> How to use the Plot the Model functions</a></li>
<li><a href="plotting-models.html#how-to-generate-a-response-plot-using-ggpubr" id="toc-how-to-generate-a-response-plot-using-ggpubr"><span class="toc-section-number">4.2.5</span> How to generate a Response Plot using ggpubr</a></li>
<li><a href="plotting-models.html#how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2" id="toc-how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2"><span class="toc-section-number">4.2.6</span> How to generate a Response Plot with a grid of treatments using ggplot2</a></li>
<li><a href="plotting-models.html#how-to-generate-an-effects-plot" id="toc-how-to-generate-an-effects-plot"><span class="toc-section-number">4.2.7</span> How to generate an Effects Plot</a></li>
<li><a href="plotting-models.html#how-to-combine-the-response-and-effects-plots" id="toc-how-to-combine-the-response-and-effects-plots"><span class="toc-section-number">4.2.8</span> How to combine the response and effects plots</a></li>
<li><a href="plotting-models.html#how-to-add-the-interaction-effect-to-response-and-effects-plots" id="toc-how-to-add-the-interaction-effect-to-response-and-effects-plots"><span class="toc-section-number">4.2.9</span> How to add the interaction effect to response and effects plots</a></li>
</ul></li>
</ul></li>
<li><a href="part-iii-some-fundamentals-of-statistical-modeling.html#part-iii-some-fundamentals-of-statistical-modeling" id="toc-part-iii-some-fundamentals-of-statistical-modeling">Part III: Some Fundamentals of Statistical Modeling</a></li>
<li><a href="uncertainty.html#uncertainty" id="toc-uncertainty"><span class="toc-section-number">5</span> Variability and Uncertainty (Standard Deviations, Standard Errors, and Confidence Intervals)</a>
<ul>
<li><a href="uncertainty.html#standard-errors-are-used-to-compute-p-values-and-confidence-intervals" id="toc-standard-errors-are-used-to-compute-p-values-and-confidence-intervals"><span class="toc-section-number">5.1</span> Standard errors are used to compute <em>p</em>-values and confidence intervals</a></li>
<li><a href="uncertainty.html#background" id="toc-background"><span class="toc-section-number">5.2</span> Background</a>
<ul>
<li><a href="uncertainty.html#sample-standard-deviation" id="toc-sample-standard-deviation"><span class="toc-section-number">5.2.1</span> Sample standard deviation</a></li>
<li><a href="uncertainty.html#standard-error-of-the-mean" id="toc-standard-error-of-the-mean"><span class="toc-section-number">5.2.2</span> Standard error of the mean</a></li>
</ul></li>
<li><a href="uncertainty.html#simulations-using-fake-data-as-an-intuition-pump" id="toc-simulations-using-fake-data-as-an-intuition-pump"><span class="toc-section-number">5.3</span> Simulations – using fake data as an intuition pump</a>
<ul>
<li><a href="uncertainty.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error" id="toc-using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><span class="toc-section-number">5.3.1</span> Using Google Sheets to generate fake data to explore the standard error</a></li>
<li><a href="uncertainty.html#using-r-to-generate-fake-data-to-explore-the-standard-error" id="toc-using-r-to-generate-fake-data-to-explore-the-standard-error"><span class="toc-section-number">5.3.2</span> Using R to generate fake data to explore the standard error</a></li>
</ul></li>
<li><a href="uncertainty.html#bootstrap" id="toc-bootstrap"><span class="toc-section-number">5.4</span> Bootstrapped standard errors</a>
<ul>
<li><a href="uncertainty.html#an-example-of-bootstrapped-standard-errors" id="toc-an-example-of-bootstrapped-standard-errors"><span class="toc-section-number">5.4.1</span> An example of bootstrapped standard errors</a></li>
</ul></li>
<li><a href="uncertainty.html#confidence-intervals" id="toc-confidence-intervals"><span class="toc-section-number">5.5</span> Confidence Intervals</a>
<ul>
<li><a href="uncertainty.html#just-the-math" id="toc-just-the-math"><span class="toc-section-number">5.5.1</span> Just the math</a></li>
<li><a href="uncertainty.html#interpretation-of-a-confidence-interval" id="toc-interpretation-of-a-confidence-interval"><span class="toc-section-number">5.5.2</span> Interpretation of a confidence interval</a></li>
<li><a href="uncertainty.html#bootstrap-confidence-interval" id="toc-bootstrap-confidence-interval"><span class="toc-section-number">5.5.3</span> Bootstrap confidence interval</a></li>
<li><a href="uncertainty.html#a-plot-of-a-parametric-ci-vs.-bootstrap-ci-of-the-means" id="toc-a-plot-of-a-parametric-ci-vs.-bootstrap-ci-of-the-means"><span class="toc-section-number">5.5.4</span> A plot of a “parametric” CI vs. bootstrap CI of the means</a></li>
</ul></li>
<li><a href="uncertainty.html#standard-error-of-a-difference-between-means" id="toc-standard-error-of-a-difference-between-means"><span class="toc-section-number">5.6</span> Standard error of a difference between means</a>
<ul>
<li><a href="uncertainty.html#the-standard-error-of-a-difference-between-means-is-the-standard-deviation-of-the-sampling-distribution-of-the-difference" id="toc-the-standard-error-of-a-difference-between-means-is-the-standard-deviation-of-the-sampling-distribution-of-the-difference"><span class="toc-section-number">5.6.1</span> The standard error of a difference between means is the standard deviation of the sampling distribution of the difference</a></li>
</ul></li>
<li><a href="uncertainty.html#confidence-limits-of-a-difference-between-means" id="toc-confidence-limits-of-a-difference-between-means"><span class="toc-section-number">5.7</span> Confidence limits of a difference between means</a>
<ul>
<li><a href="uncertainty.html#of-95-cis-of-the-difference-include-the-true-difference" id="toc-of-95-cis-of-the-difference-include-the-true-difference"><span class="toc-section-number">5.7.1</span> 95% of 95% CIs of the difference include the true difference</a></li>
</ul></li>
<li><a href="uncertainty.html#hidden-code" id="toc-hidden-code"><span class="toc-section-number">5.8</span> Hidden code</a>
<ul>
<li><a href="uncertainty.html#import-exp3b" id="toc-import-exp3b"><span class="toc-section-number">5.8.1</span> Import exp3b</a></li>
</ul></li>
</ul></li>
<li><a href="p-values.html#p-values" id="toc-p-values"><span class="toc-section-number">6</span> P-values</a>
<ul>
<li><a href="p-values.html#a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution" id="toc-a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution"><span class="toc-section-number">6.1</span> A <em>p</em>-value is the probability of sampling a value as or more extreme than the test statistic if sampling from a null distribution</a></li>
<li><a href="p-values.html#pump-your-intuition-creating-a-null-distribution" id="toc-pump-your-intuition-creating-a-null-distribution"><span class="toc-section-number">6.2</span> Pump your intuition – Creating a null distribution</a></li>
<li><a href="p-values.html#a-null-distribution-of-t-values-the-t-distribution" id="toc-a-null-distribution-of-t-values-the-t-distribution"><span class="toc-section-number">6.3</span> A null distribution of <em>t</em>-values – the <em>t</em> distribution</a></li>
<li><a href="p-values.html#p-values-from-the-perspective-of-permutation" id="toc-p-values-from-the-perspective-of-permutation"><span class="toc-section-number">6.4</span> P-values from the perspective of permutation</a></li>
<li><a href="p-values.html#parametric-vs.-non-parametric-statistics" id="toc-parametric-vs.-non-parametric-statistics"><span class="toc-section-number">6.5</span> Parametric vs. non-parametric statistics</a></li>
<li><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values" id="toc-frequentist-probability-and-the-interpretation-of-p-values"><span class="toc-section-number">6.6</span> frequentist probability and the interpretation of p-values</a>
<ul>
<li><a href="p-values.html#background-1" id="toc-background-1"><span class="toc-section-number">6.6.1</span> Background</a></li>
<li><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability." id="toc-this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><span class="toc-section-number">6.6.2</span> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li><a href="p-values.html#two-interpretations-of-the-p-value" id="toc-two-interpretations-of-the-p-value"><span class="toc-section-number">6.6.3</span> Two interpretations of the <em>p</em>-value</a></li>
<li><a href="p-values.html#nhst" id="toc-nhst"><span class="toc-section-number">6.6.4</span> NHST</a></li>
</ul></li>
<li><a href="p-values.html#some-major-misconceptions-of-the-p-value" id="toc-some-major-misconceptions-of-the-p-value"><span class="toc-section-number">6.7</span> Some major misconceptions of the <em>p</em>-value</a>
<ul>
<li><a href="p-values.html#misconception-p-0.05-means-there-is-no-effect-of-treatment" id="toc-misconception-p-0.05-means-there-is-no-effect-of-treatment"><span class="toc-section-number">6.7.1</span> Misconception: <span class="math inline">\(p &gt; 0.05\)</span> means there is no effect of treatment</a></li>
<li><a href="p-values.html#misconception-a-p-value-is-repeatable" id="toc-misconception-a-p-value-is-repeatable"><span class="toc-section-number">6.7.2</span> Misconception: a <em>p</em>-value is repeatable</a></li>
<li><a href="p-values.html#misconception-0.05-is-the-lifetime-rate-of-false-discoveries" id="toc-misconception-0.05-is-the-lifetime-rate-of-false-discoveries"><span class="toc-section-number">6.7.3</span> Misconception: 0.05 is the lifetime rate of false discoveries</a></li>
<li><a href="p-values.html#misconception-a-low-p-value-indicates-an-important-effect" id="toc-misconception-a-low-p-value-indicates-an-important-effect"><span class="toc-section-number">6.7.4</span> Misconception: a low <em>p</em>-value indicates an important effect</a></li>
<li><a href="p-values.html#misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity" id="toc-misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity"><span class="toc-section-number">6.7.5</span> Misconception: a low <em>p</em>-value indicates high model fit or high predictive capacity</a></li>
</ul></li>
<li><a href="p-values.html#what-the-p-value-does-not-mean" id="toc-what-the-p-value-does-not-mean"><span class="toc-section-number">6.8</span> What the <em>p</em>-value does not mean</a></li>
<li><a href="p-values.html#on-using-p-values-in-experimental-biology" id="toc-on-using-p-values-in-experimental-biology"><span class="toc-section-number">6.9</span> On using <em>p</em>-values in experimental biology</a></li>
<li><a href="p-values.html#better-reproducibility" id="toc-better-reproducibility"><span class="toc-section-number">6.10</span> Better reproducibility</a></li>
<li><a href="p-values.html#multiple-testing-and-controlling-for-false-positives" id="toc-multiple-testing-and-controlling-for-false-positives"><span class="toc-section-number">6.11</span> Multiple testing and controlling for false positives</a>
<ul>
<li><a href="p-values.html#controlling-the-family-wise-error-rate-when-all-tests-are-testing-the-same-hypothesis" id="toc-controlling-the-family-wise-error-rate-when-all-tests-are-testing-the-same-hypothesis"><span class="toc-section-number">6.11.1</span> Controlling the family-wise error rate when all tests are testing the same hypothesis</a></li>
</ul></li>
<li><a href="p-values.html#recommendations" id="toc-recommendations"><span class="toc-section-number">6.12</span> Recommendations</a>
<ul>
<li><a href="p-values.html#primary-sources-for-recommendations" id="toc-primary-sources-for-recommendations"><span class="toc-section-number">6.12.1</span> Primary sources for recommendations</a></li>
</ul></li>
<li><a href="p-values.html#problems" id="toc-problems"><span class="toc-section-number">6.13</span> Problems</a></li>
</ul></li>
<li><a href="errors-in-inference.html#errors-in-inference" id="toc-errors-in-inference"><span class="toc-section-number">7</span> Errors in inference</a>
<ul>
<li><a href="errors-in-inference.html#classical-nhst-concepts-of-wrong" id="toc-classical-nhst-concepts-of-wrong"><span class="toc-section-number">7.1</span> Classical NHST concepts of wrong</a>
<ul>
<li><a href="errors-in-inference.html#type-i-error" id="toc-type-i-error"><span class="toc-section-number">7.1.1</span> Type I error</a></li>
<li><a href="errors-in-inference.html#power" id="toc-power"><span class="toc-section-number">7.1.2</span> Power</a></li>
</ul></li>
<li><a href="errors-in-inference.html#a-non-neyman-pearson-concept-of-power" id="toc-a-non-neyman-pearson-concept-of-power"><span class="toc-section-number">7.2</span> A non-Neyman-Pearson concept of power</a>
<ul>
<li><a href="errors-in-inference.html#estimation-error" id="toc-estimation-error"><span class="toc-section-number">7.2.1</span> Estimation error</a></li>
<li><a href="errors-in-inference.html#coverage" id="toc-coverage"><span class="toc-section-number">7.2.2</span> Coverage</a></li>
<li><a href="errors-in-inference.html#type-s-error" id="toc-type-s-error"><span class="toc-section-number">7.2.3</span> Type S error</a></li>
<li><a href="errors-in-inference.html#type-m-error" id="toc-type-m-error"><span class="toc-section-number">7.2.4</span> Type M error</a></li>
</ul></li>
</ul></li>
<li><a href="part-iv-introduction-to-linear-models.html#part-iv-introduction-to-linear-models" id="toc-part-iv-introduction-to-linear-models">Part IV: Introduction to Linear Models</a></li>
<li><a href="intro-linear-models.html#intro-linear-models" id="toc-intro-linear-models"><span class="toc-section-number">8</span> An introduction to linear models</a>
<ul>
<li><a href="intro-linear-models.html#lm-specifications" id="toc-lm-specifications"><span class="toc-section-number">8.1</span> Two specifications of a linear model</a>
<ul>
<li><a href="intro-linear-models.html#the-error-draw-specification" id="toc-the-error-draw-specification"><span class="toc-section-number">8.1.1</span> The “error draw” specification</a></li>
<li><a href="intro-linear-models.html#the-conditional-draw-specification" id="toc-the-conditional-draw-specification"><span class="toc-section-number">8.1.2</span> The “conditional draw” specification</a></li>
<li><a href="intro-linear-models.html#comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model" id="toc-comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model"><span class="toc-section-number">8.1.3</span> Comparing the error-draw and conditional-draw ways of specifying the linear model</a></li>
<li><a href="intro-linear-models.html#anova-notation-of-a-linear-model" id="toc-anova-notation-of-a-linear-model"><span class="toc-section-number">8.1.4</span> ANOVA notation of a linear model</a></li>
</ul></li>
<li><a href="intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables" id="toc-a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"><span class="toc-section-number">8.2</span> A linear model can be fit to data with continuous, discrete, or categorical <span class="math inline">\(X\)</span> variables</a>
<ul>
<li><a href="intro-linear-models.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete" id="toc-fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete"><span class="toc-section-number">8.2.1</span> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is continuous or discrete</a></li>
<li><a href="intro-linear-models.html#slope" id="toc-slope"><span class="toc-section-number">8.2.2</span> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is categorical</a></li>
</ul></li>
<li><a href="intro-linear-models.html#statistical-models-are-used-for-prediction-explanation-and-description" id="toc-statistical-models-are-used-for-prediction-explanation-and-description"><span class="toc-section-number">8.3</span> Statistical models are used for prediction, explanation, and description</a></li>
<li><a href="intro-linear-models.html#what-is-the-interpretation-of-a-regression-coefficient" id="toc-what-is-the-interpretation-of-a-regression-coefficient"><span class="toc-section-number">8.4</span> What is the interpretation of a regression coefficient?</a></li>
<li><a href="intro-linear-models.html#what-do-we-call-the-x-and-y-variables" id="toc-what-do-we-call-the-x-and-y-variables"><span class="toc-section-number">8.5</span> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li><a href="intro-linear-models.html#modeling-strategy" id="toc-modeling-strategy"><span class="toc-section-number">8.6</span> Modeling strategy</a></li>
<li><a href="intro-linear-models.html#predictions-from-the-model" id="toc-predictions-from-the-model"><span class="toc-section-number">8.7</span> Predictions from the model</a></li>
<li><a href="intro-linear-models.html#inference-from-the-model" id="toc-inference-from-the-model"><span class="toc-section-number">8.8</span> Inference from the model</a>
<ul>
<li><a href="intro-linear-models.html#assumptions-for-inference-with-a-statistical-model" id="toc-assumptions-for-inference-with-a-statistical-model"><span class="toc-section-number">8.8.1</span> Assumptions for inference with a statistical model</a></li>
<li><a href="intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model" id="toc-specific-assumptions-for-inference-with-a-linear-model"><span class="toc-section-number">8.8.2</span> Specific assumptions for inference with a linear model</a></li>
</ul></li>
<li><a href="intro-linear-models.html#linear-modelregression-model-or-statistical-model" id="toc-linear-modelregression-model-or-statistical-model"><span class="toc-section-number">8.9</span> “linear model,”regression model”, or “statistical model”?</a></li>
</ul></li>
<li><a href="regression.html#regression" id="toc-regression"><span class="toc-section-number">9</span> Linear models with a single, continuous <em>X</em> (“regression”)</a>
<ul>
<li><a href="regression.html#a-linear-model-with-a-single-continuous-x-is-classical-regression" id="toc-a-linear-model-with-a-single-continuous-x-is-classical-regression"><span class="toc-section-number">9.1</span> A linear model with a single, continuous <em>X</em> is classical “regression”</a>
<ul>
<li><a href="regression.html#analysis-of-green-down-data" id="toc-analysis-of-green-down-data"><span class="toc-section-number">9.1.1</span> Analysis of “green-down” data</a></li>
<li><a href="regression.html#learning-from-the-green-down-example" id="toc-learning-from-the-green-down-example"><span class="toc-section-number">9.1.2</span> Learning from the green-down example</a></li>
<li><a href="regression.html#using-a-regression-model-for-explanation-causal-models" id="toc-using-a-regression-model-for-explanation-causal-models"><span class="toc-section-number">9.1.3</span> Using a regression model for “explanation” – causal models</a></li>
<li><a href="regression.html#using-a-regression-model-for-prediction-prediction-models" id="toc-using-a-regression-model-for-prediction-prediction-models"><span class="toc-section-number">9.1.4</span> Using a regression model for prediction – prediction models</a></li>
<li><a href="regression.html#using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data" id="toc-using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data"><span class="toc-section-number">9.1.5</span> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</a></li>
<li><a href="regression.html#using-a-regression-model-for-for-calibration" id="toc-using-a-regression-model-for-for-calibration"><span class="toc-section-number">9.1.6</span> Using a regression model for for calibration</a></li>
</ul></li>
<li><a href="regression.html#working-in-r-1" id="toc-working-in-r-1"><span class="toc-section-number">9.2</span> Working in R</a>
<ul>
<li><a href="plotting-models.html#fit-the-model" id="toc-fit-the-model"><span class="toc-section-number">9.2.1</span> Fitting the linear model</a></li>
<li><a href="regression.html#getting-to-know-the-linear-model-the-summary-function" id="toc-getting-to-know-the-linear-model-the-summary-function"><span class="toc-section-number">9.2.2</span> Getting to know the linear model: the <code>summary</code> function</a></li>
<li><a href="regression.html#inference-the-coefficient-table" id="toc-inference-the-coefficient-table"><span class="toc-section-number">9.2.3</span> Inference – the coefficient table</a></li>
<li><a href="regression.html#how-good-is-our-model-model-checking" id="toc-how-good-is-our-model-model-checking"><span class="toc-section-number">9.2.4</span> How good is our model? – Model checking</a></li>
<li><a href="regression.html#plotting-models-with-continuous-x" id="toc-plotting-models-with-continuous-x"><span class="toc-section-number">9.2.5</span> Plotting models with continuous <em>X</em></a></li>
<li><a href="regression.html#creating-a-table-of-predicted-values-and-95-prediction-intervals" id="toc-creating-a-table-of-predicted-values-and-95-prediction-intervals"><span class="toc-section-number">9.2.6</span> Creating a table of predicted values and 95% prediction intervals</a></li>
</ul></li>
<li><a href="regression.html#hidden-code-1" id="toc-hidden-code-1"><span class="toc-section-number">9.3</span> Hidden code</a>
<ul>
<li><a href="regression.html#import-and-plot-of-fig2c-ecosystem-warming-experimental-data" id="toc-import-and-plot-of-fig2c-ecosystem-warming-experimental-data"><span class="toc-section-number">9.3.1</span> Import and plot of fig2c (ecosystem warming experimental) data</a></li>
<li><a href="regression.html#import-and-plot-efig_3d-ecosysem-warming-observational-data" id="toc-import-and-plot-efig_3d-ecosysem-warming-observational-data"><span class="toc-section-number">9.3.2</span> Import and plot efig_3d (Ecosysem warming observational) data</a></li>
<li><a href="regression.html#import-and-plot-of-fig1f-methionine-restriction-data" id="toc-import-and-plot-of-fig1f-methionine-restriction-data"><span class="toc-section-number">9.3.3</span> Import and plot of fig1f (methionine restriction) data</a></li>
</ul></li>
<li><a href="regression.html#try-it" id="toc-try-it"><span class="toc-section-number">9.4</span> Try it</a>
<ul>
<li><a href="regression.html#a-prediction-model-from-the-literature" id="toc-a-prediction-model-from-the-literature"><span class="toc-section-number">9.4.1</span> A prediction model from the literature</a></li>
</ul></li>
<li><a href="regression.html#intuition-pumps" id="toc-intuition-pumps"><span class="toc-section-number">9.5</span> Intuition pumps</a>
<ul>
<li><a href="regression.html#correlation-and-r2" id="toc-correlation-and-r2"><span class="toc-section-number">9.5.1</span> Correlation and $R^2</a></li>
</ul></li>
</ul></li>
<li><a href="oneway.html#oneway" id="toc-oneway"><span class="toc-section-number">10</span> Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</a>
<ul>
<li><a href="oneway.html#oneway-data" id="toc-oneway-data"><span class="toc-section-number">10.1</span> A linear model with a single, categorical <em>X</em> variable estimates the effects of the levels of <em>X</em> on the response</a>
<ul>
<li><a href="oneway.html#oneway-example1" id="toc-oneway-example1"><span class="toc-section-number">10.1.1</span> Example 1 (fig3d) – two treatment levels (“groups”)</a></li>
<li><a href="oneway.html#understanding-the-analysis-with-two-treatment-levels" id="toc-understanding-the-analysis-with-two-treatment-levels"><span class="toc-section-number">10.1.2</span> Understanding the analysis with two treatment levels</a></li>
<li><a href="oneway.html#oneway-example2" id="toc-oneway-example2"><span class="toc-section-number">10.1.3</span> Example 2 – three treatment levels (“groups”)</a></li>
<li><a href="oneway.html#understanding-the-analysis-with-three-or-more-treatment-levels" id="toc-understanding-the-analysis-with-three-or-more-treatment-levels"><span class="toc-section-number">10.1.4</span> Understanding the analysis with three (or more) treatment levels</a></li>
</ul></li>
<li><a href="oneway.html#working-in-r-2" id="toc-working-in-r-2"><span class="toc-section-number">10.2</span> Working in R</a>
<ul>
<li><a href="oneway.html#fit-the-model-1" id="toc-fit-the-model-1"><span class="toc-section-number">10.2.1</span> Fit the model</a></li>
<li><a href="oneway.html#controlling-the-output-in-tables-using-the-coefficient-table-as-an-example" id="toc-controlling-the-output-in-tables-using-the-coefficient-table-as-an-example"><span class="toc-section-number">10.2.2</span> Controlling the output in tables using the coefficient table as an example</a></li>
<li><a href="oneway.html#using-the-emmeans-function" id="toc-using-the-emmeans-function"><span class="toc-section-number">10.2.3</span> Using the emmeans function</a></li>
<li><a href="oneway.html#using-the-contrast-function" id="toc-using-the-contrast-function"><span class="toc-section-number">10.2.4</span> Using the contrast function</a></li>
<li><a href="oneway.html#how-to-generate-anova-tables" id="toc-how-to-generate-anova-tables"><span class="toc-section-number">10.2.5</span> How to generate ANOVA tables</a></li>
</ul></li>
<li><a href="oneway.html#hidden-code-2" id="toc-hidden-code-2"><span class="toc-section-number">10.3</span> Hidden Code</a>
<ul>
<li><a href="oneway.html#importing-and-wrangling-the-fig_3d-data-for-example-1" id="toc-importing-and-wrangling-the-fig_3d-data-for-example-1"><span class="toc-section-number">10.3.1</span> Importing and wrangling the fig_3d data for example 1</a></li>
<li><a href="oneway.html#importing-and-wrangling-the-fig2a-data-for-example-2" id="toc-importing-and-wrangling-the-fig2a-data-for-example-2"><span class="toc-section-number">10.3.2</span> Importing and wrangling the fig2a data for example 2</a></li>
</ul></li>
</ul></li>
<li><a href="model-checking.html#model-checking" id="toc-model-checking"><span class="toc-section-number">11</span> Model Checking</a>
<ul>
<li><a href="model-checking.html#check-check" id="toc-check-check"><span class="toc-section-number">11.1</span> All statistical analyses should be followed by model checking</a></li>
<li><a href="model-checking.html#linear-model-assumptions" id="toc-linear-model-assumptions"><span class="toc-section-number">11.2</span> Linear model assumptions</a>
<ul>
<li><a href="model-checking.html#a-bit-about-iid" id="toc-a-bit-about-iid"><span class="toc-section-number">11.2.1</span> A bit about IID</a></li>
</ul></li>
<li><a href="model-checking.html#diagnostic-plots-use-the-residuals-from-the-model-fit" id="toc-diagnostic-plots-use-the-residuals-from-the-model-fit"><span class="toc-section-number">11.3</span> Diagnostic plots use the residuals from the model fit</a>
<ul>
<li><a href="model-checking.html#residuals" id="toc-residuals"><span class="toc-section-number">11.3.1</span> Residuals</a></li>
<li><a href="model-checking.html#normal-qq" id="toc-normal-qq"><span class="toc-section-number">11.3.2</span> A Normal Q-Q plot is used to check for characteristic departures from Normality</a></li>
<li><a href="model-checking.html#mapping-qq-plot-departures-from-normality" id="toc-mapping-qq-plot-departures-from-normality"><span class="toc-section-number">11.3.3</span> Mapping QQ-plot departures from Normality</a></li>
<li><a href="model-checking.html#model-checking-spread-level" id="toc-model-checking-spread-level"><span class="toc-section-number">11.3.4</span> Model checking homoskedasticity</a></li>
</ul></li>
<li><a href="model-checking.html#using-r" id="toc-using-r"><span class="toc-section-number">11.4</span> Using R</a></li>
<li><a href="model-checking.html#hidden-code-3" id="toc-hidden-code-3"><span class="toc-section-number">11.5</span> Hidden Code</a>
<ul>
<li><a href="model-checking.html#normal-q-q-plots" id="toc-normal-q-q-plots"><span class="toc-section-number">11.5.1</span> Normal Q-Q plots</a></li>
</ul></li>
</ul></li>
<li><a href="violations.html#violations" id="toc-violations"><span class="toc-section-number">12</span> Violations of independence, homogeneity, or Normality</a>
<ul>
<li><a href="violations.html#oneway-paired-t" id="toc-oneway-paired-t"><span class="toc-section-number">12.1</span> Lack of independence</a>
<ul>
<li><a href="violations.html#violations-paired-t" id="toc-violations-paired-t"><span class="toc-section-number">12.1.1</span> Example 1 (exp1b) – a paired t-test is a special case of a linear mixed model</a></li>
<li><a href="violations.html#violations-rmanova" id="toc-violations-rmanova"><span class="toc-section-number">12.1.2</span> Example 2 (diHOME exp2a) – A repeated measures ANOVA is a special case of a linear mixed model</a></li>
</ul></li>
<li><a href="violations.html#oneway-welch" id="toc-oneway-welch"><span class="toc-section-number">12.2</span> Heterogeneity of variances</a>
<ul>
<li><a href="violations.html#when-groups-of-the-focal-test-have-variance" id="toc-when-groups-of-the-focal-test-have-variance"><span class="toc-section-number">12.2.1</span> When groups of the focal test have &gt;&gt; variance</a></li>
</ul></li>
<li><a href="violations.html#the-conditional-response-isnt-normal" id="toc-the-conditional-response-isnt-normal"><span class="toc-section-number">12.3</span> The conditional response isn’t Normal</a>
<ul>
<li><a href="violations.html#violations-6f" id="toc-violations-6f"><span class="toc-section-number">12.3.1</span> Example 1 (fig6f) – Linear models for non-normal count data</a></li>
<li><a href="violations.html#my-data-arent-normal-what-is-the-best-practice" id="toc-my-data-arent-normal-what-is-the-best-practice"><span class="toc-section-number">12.3.2</span> My data aren’t normal, what is the best practice?</a></li>
</ul></li>
<li><a href="violations.html#hidden-code-4" id="toc-hidden-code-4"><span class="toc-section-number">12.4</span> Hidden Code</a>
<ul>
<li><a href="violations.html#importing-and-wrangling-the-exp1b-data" id="toc-importing-and-wrangling-the-exp1b-data"><span class="toc-section-number">12.4.1</span> Importing and wrangling the exp1b data</a></li>
<li><a href="violations.html#importing-and-wrangling-the-exp2a-data" id="toc-importing-and-wrangling-the-exp2a-data"><span class="toc-section-number">12.4.2</span> Importing and wrangling the exp2a data</a></li>
<li><a href="violations.html#importing-and-wrangling-the-fig6f-data" id="toc-importing-and-wrangling-the-fig6f-data"><span class="toc-section-number">12.4.3</span> Importing and wrangling the fig6f data</a></li>
</ul></li>
</ul></li>
<li><a href="issues.html#issues" id="toc-issues"><span class="toc-section-number">13</span> Issues in inference</a>
<ul>
<li><a href="issues.html#replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means" id="toc-replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means"><span class="toc-section-number">13.1</span> Replicated experiments – include <span class="math inline">\(\texttt{Experiment}\)</span> as a random factor (better than one-way ANOVA of means)</a>
<ul>
<li><a href="issues.html#issues-exp4d" id="toc-issues-exp4d"><span class="toc-section-number">13.1.1</span> Multiple experiments Example 1 (wound healing Exp4d)</a></li>
<li><a href="issues.html#issues-combined-experiments" id="toc-issues-combined-experiments"><span class="toc-section-number">13.1.2</span> Models for combining replicated experiments</a></li>
<li><a href="issues.html#understanding-model-exp4d_m1" id="toc-understanding-model-exp4d_m1"><span class="toc-section-number">13.1.3</span> Understanding Model <code>exp4d_m1</code></a></li>
<li><a href="issues.html#the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2" id="toc-the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2"><span class="toc-section-number">13.1.4</span> The univariate model is equivalent to a linear mixed model of the aggregated data (Model exp4d_m2)</a></li>
<li><a href="issues.html#a-linear-mixed-model-of-the-full-data" id="toc-a-linear-mixed-model-of-the-full-data"><span class="toc-section-number">13.1.5</span> A linear mixed model of the full data</a></li>
<li><a href="issues.html#analysis-of-the-experiment-means-has-less-precision-and-power" id="toc-analysis-of-the-experiment-means-has-less-precision-and-power"><span class="toc-section-number">13.1.6</span> Analysis of the experiment means has less precision and power</a></li>
<li><a href="issues.html#dont-do-this-a-t-testfixed-effect-anova-of-the-full-data" id="toc-dont-do-this-a-t-testfixed-effect-anova-of-the-full-data"><span class="toc-section-number">13.1.7</span> Don’t do this – a t-test/fixed-effect ANOVA of the full data</a></li>
</ul></li>
<li><a href="issues.html#issues-pre-post" id="toc-issues-pre-post"><span class="toc-section-number">13.2</span> Comparing change from baseline (pre-post)</a>
<ul>
<li><a href="issues.html#pre-post-example-1-dpp4-fig4c" id="toc-pre-post-example-1-dpp4-fig4c"><span class="toc-section-number">13.2.1</span> Pre-post example 1 (DPP4 fig4c)</a></li>
<li><a href="issues.html#what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure" id="toc-what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure"><span class="toc-section-number">13.2.2</span> What if the data in example 1 were from from an experiment where the treatment was applied prior to the baseline measure?</a></li>
<li><a href="issues.html#pre-post-example-2-xx-males-fig1c" id="toc-pre-post-example-2-xx-males-fig1c"><span class="toc-section-number">13.2.3</span> Pre-post example 2 (XX males fig1c)</a></li>
<li><a href="issues.html#issues-regression-to-mean" id="toc-issues-regression-to-mean"><span class="toc-section-number">13.2.4</span> Regression to the mean</a></li>
</ul></li>
<li><a href="issues.html#longitudinal-designs-with-more-than-one-post-baseline-measure" id="toc-longitudinal-designs-with-more-than-one-post-baseline-measure"><span class="toc-section-number">13.3</span> Longitudinal designs with more than one-post baseline measure</a>
<ul>
<li><a href="issues.html#issues-auc" id="toc-issues-auc"><span class="toc-section-number">13.3.1</span> Area under the curve (AUC)</a></li>
</ul></li>
<li><a href="issues.html#normalization-the-analysis-of-ratios" id="toc-normalization-the-analysis-of-ratios"><span class="toc-section-number">13.4</span> Normalization – the analysis of ratios</a>
<ul>
<li><a href="issues.html#kinds-of-ratios-in-experimental-biology" id="toc-kinds-of-ratios-in-experimental-biology"><span class="toc-section-number">13.4.1</span> Kinds of ratios in experimental biology</a></li>
<li><a href="issues.html#issues-offset" id="toc-issues-offset"><span class="toc-section-number">13.4.2</span> Example 1 – The ratio is a density (number of something per area)</a></li>
<li><a href="issues.html#issues-size" id="toc-issues-size"><span class="toc-section-number">13.4.3</span> Example 2 – The ratio is normalizing for size differences</a></li>
</ul></li>
<li><a href="issues.html#dont-do-this-stuff" id="toc-dont-do-this-stuff"><span class="toc-section-number">13.5</span> Don’t do this stuff</a>
<ul>
<li><a href="issues.html#normalize-the-response-so-that-all-control-values-are-equal-to-1." id="toc-normalize-the-response-so-that-all-control-values-are-equal-to-1."><span class="toc-section-number">13.5.1</span> Normalize the response so that all control values are equal to 1.</a></li>
</ul></li>
<li><a href="issues.html#a-difference-in-significance-is-not-necessarily-significant" id="toc-a-difference-in-significance-is-not-necessarily-significant"><span class="toc-section-number">13.6</span> A difference in significance is not necessarily significant</a></li>
<li><a href="issues.html#researcher-degrees-of-freedom" id="toc-researcher-degrees-of-freedom"><span class="toc-section-number">13.7</span> Researcher degrees of freedom</a></li>
<li><a href="issues.html#hidden-code-5" id="toc-hidden-code-5"><span class="toc-section-number">13.8</span> Hidden code</a>
<ul>
<li><a href="issues.html#import-exp4d-vimentin-cell-count-data-replicate-experiments-example" id="toc-import-exp4d-vimentin-cell-count-data-replicate-experiments-example"><span class="toc-section-number">13.8.1</span> Import exp4d vimentin cell count data (replicate experiments example)</a></li>
<li><a href="issues.html#import-fig4c-data" id="toc-import-fig4c-data"><span class="toc-section-number">13.8.2</span> Import Fig4c data</a></li>
<li><a href="issues.html#xx-males-fig1c" id="toc-xx-males-fig1c"><span class="toc-section-number">13.8.3</span> XX males fig1c</a></li>
<li><a href="issues.html#generation-of-fake-data-to-illustrate-regression-to-the-mean" id="toc-generation-of-fake-data-to-illustrate-regression-to-the-mean"><span class="toc-section-number">13.8.4</span> Generation of fake data to illustrate regression to the mean</a></li>
<li><a href="issues.html#import-fig3f" id="toc-import-fig3f"><span class="toc-section-number">13.8.5</span> Import fig3f</a></li>
<li><a href="issues.html#issues-import-exp3b" id="toc-issues-import-exp3b"><span class="toc-section-number">13.8.6</span> Import exp3b</a></li>
<li><a href="issues.html#issues-exp3b-plot" id="toc-issues-exp3b-plot"><span class="toc-section-number">13.8.7</span> Plot the model of exp3b (glm offset data)</a></li>
</ul></li>
</ul></li>
<li><a href="part-v-more-than-one-x-multivariable-models.html#part-v-more-than-one-x-multivariable-models" id="toc-part-v-more-than-one-x-multivariable-models">Part V: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li><a href="covariates.html#covariates" id="toc-covariates"><span class="toc-section-number">14</span> Linear models with added covariates (“ANCOVA”)</a>
<ul>
<li><a href="covariates.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest" id="toc-adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><span class="toc-section-number">14.1</span> Adding covariates can increases the precision of the effect of interest</a></li>
<li><a href="covariates.html#understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data" id="toc-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data"><span class="toc-section-number">14.2</span> Understanding a linear model with an added covariate – heart necrosis data</a>
<ul>
<li><a href="covariates.html#fit-the-model-5" id="toc-fit-the-model-5"><span class="toc-section-number">14.2.1</span> Fit the model</a></li>
<li><a href="covariates.html#plot-the-model-2" id="toc-plot-the-model-2"><span class="toc-section-number">14.2.2</span> Plot the model</a></li>
<li><a href="covariates.html#interpretation-of-the-model-coefficients" id="toc-interpretation-of-the-model-coefficients"><span class="toc-section-number">14.2.3</span> Interpretation of the model coefficients</a></li>
<li><a href="covariates.html#everything-adds-up" id="toc-everything-adds-up"><span class="toc-section-number">14.2.4</span> Everything adds up</a></li>
<li><a href="covariates.html#interpretation-of-the-estimated-marginal-means" id="toc-interpretation-of-the-estimated-marginal-means"><span class="toc-section-number">14.2.5</span> Interpretation of the estimated marginal means</a></li>
<li><a href="covariates.html#interpretation-of-the-contrasts" id="toc-interpretation-of-the-contrasts"><span class="toc-section-number">14.2.6</span> Interpretation of the contrasts</a></li>
<li><a href="covariates.html#adding-the-covariate-improves-inference" id="toc-adding-the-covariate-improves-inference"><span class="toc-section-number">14.2.7</span> Adding the covariate improves inference</a></li>
</ul></li>
<li><a href="covariates.html#understanding-interaction-effects-with-covariates" id="toc-understanding-interaction-effects-with-covariates"><span class="toc-section-number">14.3</span> Understanding interaction effects with covariates</a>
<ul>
<li><a href="covariates.html#fit-the-model-6" id="toc-fit-the-model-6"><span class="toc-section-number">14.3.1</span> Fit the model</a></li>
<li><a href="covariates.html#plot-the-model-with-interaction-effect" id="toc-plot-the-model-with-interaction-effect"><span class="toc-section-number">14.3.2</span> Plot the model with interaction effect</a></li>
<li><a href="covariates.html#interpretation-of-the-model-coefficients-1" id="toc-interpretation-of-the-model-coefficients-1"><span class="toc-section-number">14.3.3</span> Interpretation of the model coefficients</a></li>
<li><a href="covariates.html#what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends." id="toc-what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends."><span class="toc-section-number">14.3.4</span> What is the effect of a treatment, if interactions are modeled? – it depends.</a></li>
<li><a href="covariates.html#which-model-do-we-use-mathcalm_1-or-mathcalm_2" id="toc-which-model-do-we-use-mathcalm_1-or-mathcalm_2"><span class="toc-section-number">14.3.5</span> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</a></li>
</ul></li>
<li><a href="covariates.html#understanding-ancova-tables" id="toc-understanding-ancova-tables"><span class="toc-section-number">14.4</span> Understanding ANCOVA tables</a></li>
<li><a href="covariates.html#working-in-r-3" id="toc-working-in-r-3"><span class="toc-section-number">14.5</span> Working in R</a>
<ul>
<li><a href="covariates.html#importing-the-heart-necrosis-data" id="toc-importing-the-heart-necrosis-data"><span class="toc-section-number">14.5.1</span> Importing the heart necrosis data</a></li>
<li><a href="covariates.html#fitting-the-model" id="toc-fitting-the-model"><span class="toc-section-number">14.5.2</span> Fitting the model</a></li>
<li><a href="covariates.html#using-the-emmeans-function-1" id="toc-using-the-emmeans-function-1"><span class="toc-section-number">14.5.3</span> Using the emmeans function</a></li>
<li><a href="covariates.html#ancova-tables" id="toc-ancova-tables"><span class="toc-section-number">14.5.4</span> ANCOVA tables</a></li>
<li><a href="covariates.html#plotting-the-model" id="toc-plotting-the-model"><span class="toc-section-number">14.5.5</span> Plotting the model</a></li>
</ul></li>
<li><a href="covariates.html#best-practices" id="toc-best-practices"><span class="toc-section-number">14.6</span> Best practices</a>
<ul>
<li><a href="covariates.html#do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate" id="toc-do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate"><span class="toc-section-number">14.6.1</span> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</a></li>
<li><a href="covariates.html#do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate" id="toc-do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate"><span class="toc-section-number">14.6.2</span> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</a></li>
<li><a href="covariates.html#do-not-test-for-balance-of-baseline-measures" id="toc-do-not-test-for-balance-of-baseline-measures"><span class="toc-section-number">14.6.3</span> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li><a href="covariates.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response" id="toc-best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><span class="toc-section-number">14.7</span> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li><a href="factorial.html#factorial" id="toc-factorial"><span class="toc-section-number">15</span> Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</a>
<ul>
<li><a href="factorial.html#a-linear-model-with-crossed-factors-estimates-interaction-effects" id="toc-a-linear-model-with-crossed-factors-estimates-interaction-effects"><span class="toc-section-number">15.1</span> A linear model with crossed factors estimates interaction effects</a>
<ul>
<li><a href="factorial.html#an-interaction-is-a-difference-in-simple-effects" id="toc-an-interaction-is-a-difference-in-simple-effects"><span class="toc-section-number">15.1.1</span> An interaction is a difference in simple effects</a></li>
<li><a href="factorial.html#a-linear-model-with-crossed-factors-includes-interaction-effects" id="toc-a-linear-model-with-crossed-factors-includes-interaction-effects"><span class="toc-section-number">15.1.2</span> A linear model with crossed factors includes interaction effects</a></li>
<li><a href="factorial.html#factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature" id="toc-factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature"><span class="toc-section-number">15.1.3</span> factorial experiments are frequently analyzed as flattened linear models in the experimental biology literature</a></li>
</ul></li>
<li><a href="factorial.html#example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data" id="toc-example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data"><span class="toc-section-number">15.2</span> Example 1 – Estimation of a treatment effect relative to a control effect (“Something different”) (Experiment 2j glucose uptake data)</a>
<ul>
<li><a href="factorial.html#twoway-understand1" id="toc-twoway-understand1"><span class="toc-section-number">15.2.1</span> Understand the experimental design</a></li>
<li><a href="factorial.html#fit-the-linear-model" id="toc-fit-the-linear-model"><span class="toc-section-number">15.2.2</span> Fit the linear model</a></li>
<li><a href="factorial.html#twoway-exp2j-inf" id="toc-twoway-exp2j-inf"><span class="toc-section-number">15.2.3</span> Inference</a></li>
<li><a href="factorial.html#plot-the-model-3" id="toc-plot-the-model-3"><span class="toc-section-number">15.2.4</span> Plot the model</a></li>
</ul></li>
<li><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-1" id="toc-understanding-the-linear-model-with-crossed-factors-1"><span class="toc-section-number">15.3</span> Understanding the linear model with crossed factors 1</a>
<ul>
<li><a href="factorial.html#twoway-what-coefs-are" id="toc-twoway-what-coefs-are"><span class="toc-section-number">15.3.1</span> What the coefficients are</a></li>
<li><a href="factorial.html#the-interaction-effect-is-something-different" id="toc-the-interaction-effect-is-something-different"><span class="toc-section-number">15.3.2</span> The interaction effect is something different</a></li>
<li><a href="factorial.html#why-we-want-to-compare-the-treatment-effect-to-a-control-effect" id="toc-why-we-want-to-compare-the-treatment-effect-to-a-control-effect"><span class="toc-section-number">15.3.3</span> Why we want to compare the treatment effect to a control effect</a></li>
<li><a href="factorial.html#the-order-of-the-factors-in-the-model-tells-the-same-story-differently" id="toc-the-order-of-the-factors-in-the-model-tells-the-same-story-differently"><span class="toc-section-number">15.3.4</span> The order of the factors in the model tells the same story differently</a></li>
<li><a href="factorial.html#power-for-the-interaction-effect-is-less-than-that-for-simple-effects" id="toc-power-for-the-interaction-effect-is-less-than-that-for-simple-effects"><span class="toc-section-number">15.3.5</span> Power for the interaction effect is less than that for simple effects</a></li>
<li><a href="factorial.html#planned-comparisons-vs.-post-hoc-tests" id="toc-planned-comparisons-vs.-post-hoc-tests"><span class="toc-section-number">15.3.6</span> Planned comparisons vs. post-hoc tests</a></li>
</ul></li>
<li><a href="factorial.html#example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data" id="toc-example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data"><span class="toc-section-number">15.4</span> Example 2: Estimation of the effect of background condition on an effect (“it depends”) (Experiment 3e lesian area data)</a>
<ul>
<li><a href="factorial.html#understand-the-experimental-design" id="toc-understand-the-experimental-design"><span class="toc-section-number">15.4.1</span> Understand the experimental design</a></li>
<li><a href="factorial.html#fit-the-linear-model-1" id="toc-fit-the-linear-model-1"><span class="toc-section-number">15.4.2</span> Fit the linear model</a></li>
<li><a href="factorial.html#check-the-model-1" id="toc-check-the-model-1"><span class="toc-section-number">15.4.3</span> Check the model</a></li>
<li><a href="factorial.html#inference-from-the-model-2" id="toc-inference-from-the-model-2"><span class="toc-section-number">15.4.4</span> Inference from the model</a></li>
<li><a href="factorial.html#plot-the-model-4" id="toc-plot-the-model-4"><span class="toc-section-number">15.4.5</span> Plot the model</a></li>
</ul></li>
<li><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-2" id="toc-understanding-the-linear-model-with-crossed-factors-2"><span class="toc-section-number">15.5</span> Understanding the linear model with crossed factors 2</a>
<ul>
<li><a href="factorial.html#twoway-marginal-means" id="toc-twoway-marginal-means"><span class="toc-section-number">15.5.1</span> Conditional and marginal means</a></li>
<li><a href="factorial.html#simple-conditional-effects" id="toc-simple-conditional-effects"><span class="toc-section-number">15.5.2</span> Simple (conditional) effects</a></li>
<li><a href="factorial.html#twoway-marginal-effects" id="toc-twoway-marginal-effects"><span class="toc-section-number">15.5.3</span> Marginal effects</a></li>
<li><a href="factorial.html#the-additive-model" id="toc-the-additive-model"><span class="toc-section-number">15.5.4</span> The additive model</a></li>
<li><a href="factorial.html#twoway-reduce" id="toc-twoway-reduce"><span class="toc-section-number">15.5.5</span> Reduce models for the right reason</a></li>
<li><a href="factorial.html#the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird" id="toc-the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird"><span class="toc-section-number">15.5.6</span> The marginal means of an additive linear model with two factors can be weird</a></li>
</ul></li>
<li><a href="factorial.html#example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data" id="toc-example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data"><span class="toc-section-number">15.6</span> Example 3: Estimation of synergy (“More than the sum of the parts”) (Experiment 1c JA data)</a>
<ul>
<li><a href="factorial.html#examine-the-data" id="toc-examine-the-data"><span class="toc-section-number">15.6.1</span> Examine the data</a></li>
<li><a href="factorial.html#fit-the-model-7" id="toc-fit-the-model-7"><span class="toc-section-number">15.6.2</span> Fit the model</a></li>
<li><a href="factorial.html#model-check" id="toc-model-check"><span class="toc-section-number">15.6.3</span> Model check</a></li>
<li><a href="factorial.html#inference-from-the-model-3" id="toc-inference-from-the-model-3"><span class="toc-section-number">15.6.4</span> Inference from the model</a></li>
<li><a href="factorial.html#plot-the-model-5" id="toc-plot-the-model-5"><span class="toc-section-number">15.6.5</span> Plot the model</a></li>
<li><a href="factorial.html#alternative-plot" id="toc-alternative-plot"><span class="toc-section-number">15.6.6</span> Alternative plot</a></li>
</ul></li>
<li><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-3" id="toc-understanding-the-linear-model-with-crossed-factors-3"><span class="toc-section-number">15.7</span> Understanding the linear model with crossed factors 3</a>
<ul>
<li><a href="factorial.html#thinking-about-the-coefficients-of-the-linear-model" id="toc-thinking-about-the-coefficients-of-the-linear-model"><span class="toc-section-number">15.7.1</span> Thinking about the coefficients of the linear model</a></li>
</ul></li>
<li><a href="factorial.html#issues-in-inference" id="toc-issues-in-inference"><span class="toc-section-number">15.8</span> Issues in inference</a>
<ul>
<li><a href="factorial.html#for-pairwise-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model" id="toc-for-pairwise-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><span class="toc-section-number">15.8.1</span> For pairwise contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li><a href="factorial.html#for-interaction-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model" id="toc-for-interaction-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><span class="toc-section-number">15.8.2</span> For interaction contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li><a href="factorial.html#twoway-multiple-tests" id="toc-twoway-multiple-tests"><span class="toc-section-number">15.8.3</span> Adjusting <em>p</em>-values for multiple tests</a></li>
</ul></li>
<li><a href="factorial.html#two-way-anova" id="toc-two-way-anova"><span class="toc-section-number">15.9</span> Two-way ANOVA</a>
<ul>
<li><a href="factorial.html#how-to-read-a-two-way-anova-table" id="toc-how-to-read-a-two-way-anova-table"><span class="toc-section-number">15.9.1</span> How to read a two-way ANOVA table</a></li>
<li><a href="factorial.html#what-do-the-main-effects-in-an-anova-table-mean" id="toc-what-do-the-main-effects-in-an-anova-table-mean"><span class="toc-section-number">15.9.2</span> What do the main effects in an ANOVA table mean?</a></li>
</ul></li>
<li><a href="factorial.html#more-issues-in-inference" id="toc-more-issues-in-inference"><span class="toc-section-number">15.10</span> More issues in inference</a>
<ul>
<li><a href="factorial.html#longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova" id="toc-longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova"><span class="toc-section-number">15.10.1</span> Longitudinal experiments – include Time as a random factor (better than repeated measures ANOVA)</a></li>
</ul></li>
<li><a href="factorial.html#working-in-r-4" id="toc-working-in-r-4"><span class="toc-section-number">15.11</span> Working in R</a>
<ul>
<li><a href="factorial.html#model-formula" id="toc-model-formula"><span class="toc-section-number">15.11.1</span> Model formula</a></li>
<li><a href="factorial.html#using-the-emmeans-function-2" id="toc-using-the-emmeans-function-2"><span class="toc-section-number">15.11.2</span> Using the emmeans function</a></li>
<li><a href="factorial.html#contrasts" id="toc-contrasts"><span class="toc-section-number">15.11.3</span> Contrasts</a></li>
<li><a href="factorial.html#practice-safe-anova" id="toc-practice-safe-anova"><span class="toc-section-number">15.11.4</span> Practice safe ANOVA</a></li>
<li><a href="factorial.html#better-to-avoid-these" id="toc-better-to-avoid-these"><span class="toc-section-number">15.11.5</span> Better to avoid these</a></li>
</ul></li>
<li><a href="factorial.html#hidden-code-6" id="toc-hidden-code-6"><span class="toc-section-number">15.12</span> Hidden Code</a>
<ul>
<li><a href="factorial.html#import-exp2j-example-1" id="toc-import-exp2j-example-1"><span class="toc-section-number">15.12.1</span> Import exp2j (Example 1)</a></li>
<li><a href="factorial.html#import-exp3e-lesian-area-data-example-2" id="toc-import-exp3e-lesian-area-data-example-2"><span class="toc-section-number">15.12.2</span> Import exp3e lesian area data (Example 2)</a></li>
<li><a href="factorial.html#import-exp1c-ja-data-example-3" id="toc-import-exp1c-ja-data-example-3"><span class="toc-section-number">15.12.3</span> Import Exp1c JA data (Example 3)</a></li>
</ul></li>
</ul></li>
<li><a href="part-vi-expanding-the-linear-model.html#part-vi-expanding-the-linear-model" id="toc-part-vi-expanding-the-linear-model">Part VI – Expanding the Linear Model</a></li>
<li><a href="lmm.html#lmm" id="toc-lmm"><span class="toc-section-number">16</span> Models with random factors – linear mixed models</a>
<ul>
<li><a href="lmm.html#lmm-demo" id="toc-lmm-demo"><span class="toc-section-number">16.1</span> Example 1 – A random intercepts and slopes explainer (demo1)</a>
<ul>
<li><a href="lmm.html#batched-measurements-result-in-clustered-residuals" id="toc-batched-measurements-result-in-clustered-residuals"><span class="toc-section-number">16.1.1</span> Batched measurements result in clustered residuals</a></li>
<li><a href="lmm.html#lmm-corerr" id="toc-lmm-corerr"><span class="toc-section-number">16.1.2</span> Clustered residuals result in correlated error</a></li>
<li><a href="lmm.html#in-blocked-designs-clustered-residuals-adds-a-variance-component-that-masks-treatment-effects" id="toc-in-blocked-designs-clustered-residuals-adds-a-variance-component-that-masks-treatment-effects"><span class="toc-section-number">16.1.3</span> In blocked designs, clustered residuals adds a variance component that masks treatment effects</a></li>
<li><a href="lmm.html#linear-mixed-models-are-linear-models-with-added-random-factors" id="toc-linear-mixed-models-are-linear-models-with-added-random-factors"><span class="toc-section-number">16.1.4</span> Linear mixed models are linear models with added random factors</a></li>
<li><a href="lmm.html#what-the-random-effects-are" id="toc-what-the-random-effects-are"><span class="toc-section-number">16.1.5</span> What the random effects are</a></li>
<li><a href="lmm.html#in-a-blocked-design-a-linear-model-with-added-random-effects-increases-precision-of-treatment-effects" id="toc-in-a-blocked-design-a-linear-model-with-added-random-effects-increases-precision-of-treatment-effects"><span class="toc-section-number">16.1.6</span> In a blocked design, a linear model with added random effects increases precision of treatment effects</a></li>
<li><a href="lmm.html#lmm-varcorr" id="toc-lmm-varcorr"><span class="toc-section-number">16.1.7</span> The correlation among random intercepts and slopes</a></li>
<li><a href="lmm.html#clustered-residuals-create-heterogeneity-among-treatments" id="toc-clustered-residuals-create-heterogeneity-among-treatments"><span class="toc-section-number">16.1.8</span> Clustered residuals create heterogeneity among treatments</a></li>
<li><a href="lmm.html#linear-mixed-models-are-flexible" id="toc-linear-mixed-models-are-flexible"><span class="toc-section-number">16.1.9</span> Linear mixed models are flexible</a></li>
<li><a href="lmm.html#a-random-intercept-only-model" id="toc-a-random-intercept-only-model"><span class="toc-section-number">16.1.10</span> A random intercept only model</a></li>
<li><a href="lmm.html#a-model-including-an-interaction-intercept" id="toc-a-model-including-an-interaction-intercept"><span class="toc-section-number">16.1.11</span> A model including an interaction intercept</a></li>
<li><a href="lmm.html#lmm-demo-aic" id="toc-lmm-demo-aic"><span class="toc-section-number">16.1.12</span> AIC and model selection – which model to report?</a></li>
<li><a href="lmm.html#the-specification-of-random-effects-matters" id="toc-the-specification-of-random-effects-matters"><span class="toc-section-number">16.1.13</span> The specification of random effects matters</a></li>
<li><a href="lmm.html#mixed-effect-and-repeated-measures-anova" id="toc-mixed-effect-and-repeated-measures-anova"><span class="toc-section-number">16.1.14</span> Mixed Effect and Repeated Measures ANOVA</a></li>
<li><a href="lmm.html#pseudoreplication" id="toc-pseudoreplication"><span class="toc-section-number">16.1.15</span> Pseudoreplication</a></li>
</ul></li>
<li><a href="lmm.html#lmm-example2" id="toc-lmm-example2"><span class="toc-section-number">16.2</span> Example 2 – experiments without subsampling replication (exp6g)</a>
<ul>
<li><a href="lmm.html#understand-the-data" id="toc-understand-the-data"><span class="toc-section-number">16.2.1</span> Understand the data</a></li>
<li><a href="lmm.html#model-fit-and-inference" id="toc-model-fit-and-inference"><span class="toc-section-number">16.2.2</span> Model fit and inference</a></li>
<li><a href="lmm.html#the-model-exp6g_m1-adds-a-random-intercept-but-not-a-random-slope" id="toc-the-model-exp6g_m1-adds-a-random-intercept-but-not-a-random-slope"><span class="toc-section-number">16.2.3</span> The model exp6g_m1 adds a random intercept but not a random slope</a></li>
<li><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp6g_m1" id="toc-the-fixed-effect-coefficients-of-model-exp6g_m1"><span class="toc-section-number">16.2.4</span> The fixed effect coefficients of model exp6g_m1</a></li>
<li><a href="lmm.html#the-random-intercept-coefficients-of-exp6g_m1" id="toc-the-random-intercept-coefficients-of-exp6g_m1"><span class="toc-section-number">16.2.5</span> The random intercept coefficients of exp6g_m1</a></li>
<li><a href="lmm.html#the-random-and-residual-variance-and-the-intraclass-correlation-of-model-exp6g_m1" id="toc-the-random-and-residual-variance-and-the-intraclass-correlation-of-model-exp6g_m1"><span class="toc-section-number">16.2.6</span> The random and residual variance and the intraclass correlation of model exp6g_m1</a></li>
<li><a href="lmm.html#the-linear-mixed-model-exp6g_m1-increases-precision-of-treatment-effects-relative-to-a-fixed-effects-model" id="toc-the-linear-mixed-model-exp6g_m1-increases-precision-of-treatment-effects-relative-to-a-fixed-effects-model"><span class="toc-section-number">16.2.7</span> The linear mixed model exp6g_m1 increases precision of treatment effects, relative to a fixed effects model</a></li>
<li><a href="lmm.html#lmm-exp6g-alt" id="toc-lmm-exp6g-alt"><span class="toc-section-number">16.2.8</span> Alternative models for exp6g</a></li>
<li><a href="lmm.html#paired-t-tests-and-repeated-measures-anova-are-special-cases-of-linear-mixed-models" id="toc-paired-t-tests-and-repeated-measures-anova-are-special-cases-of-linear-mixed-models"><span class="toc-section-number">16.2.9</span> Paired t-tests and repeated measures ANOVA are special cases of linear mixed models</a></li>
<li><a href="lmm.html#lmm-exp6g-rmanova" id="toc-lmm-exp6g-rmanova"><span class="toc-section-number">16.2.10</span> Classical (“univariate model”) repeated measures ANOVA of exp6g</a></li>
<li><a href="lmm.html#lmm-exp6g-rmanova-multi" id="toc-lmm-exp6g-rmanova-multi"><span class="toc-section-number">16.2.11</span> “Multivariate model” repeated measures ANOVA</a></li>
<li><a href="lmm.html#linear-mixed-models-vs-repeated-measures-anova" id="toc-linear-mixed-models-vs-repeated-measures-anova"><span class="toc-section-number">16.2.12</span> Linear mixed models vs repeated measures ANOVA</a></li>
<li><a href="lmm.html#modeling-textttmouse_id-as-a-fixed-effect" id="toc-modeling-textttmouse_id-as-a-fixed-effect"><span class="toc-section-number">16.2.13</span> Modeling <span class="math inline">\(\texttt{mouse_id}\)</span> as a fixed effect</a></li>
</ul></li>
<li><a href="lmm.html#example-3-factorial-experiments-and-no-subsampling-replicates-exp5c" id="toc-example-3-factorial-experiments-and-no-subsampling-replicates-exp5c"><span class="toc-section-number">16.3</span> Example 3 – Factorial experiments and no subsampling replicates (exp5c)</a>
<ul>
<li><a href="lmm.html#understand-the-data-1" id="toc-understand-the-data-1"><span class="toc-section-number">16.3.1</span> Understand the data</a></li>
<li><a href="lmm.html#examine-the-data-1" id="toc-examine-the-data-1"><span class="toc-section-number">16.3.2</span> Examine the data</a></li>
<li><a href="lmm.html#lmm-exp5c-m1" id="toc-lmm-exp5c-m1"><span class="toc-section-number">16.3.3</span> Model fit and inference</a></li>
<li><a href="lmm.html#why-we-care-about-modeling-batch-in-exp5c" id="toc-why-we-care-about-modeling-batch-in-exp5c"><span class="toc-section-number">16.3.4</span> Why we care about modeling batch in exp5c</a></li>
<li><a href="lmm.html#the-linear-mixed-model-exp5c_m1-adds-two-random-intercepts" id="toc-the-linear-mixed-model-exp5c_m1-adds-two-random-intercepts"><span class="toc-section-number">16.3.5</span> The linear mixed model exp5c_m1 adds two random intercepts</a></li>
<li><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp5c_m1" id="toc-the-fixed-effect-coefficients-of-model-exp5c_m1"><span class="toc-section-number">16.3.6</span> The fixed effect coefficients of model exp5c_m1</a></li>
<li><a href="lmm.html#the-random-effect-coefficients-of-model-exp5c_m1" id="toc-the-random-effect-coefficients-of-model-exp5c_m1"><span class="toc-section-number">16.3.7</span> The random effect coefficients of model exp5c_m1</a></li>
<li><a href="lmm.html#lmm-exp5c-alt" id="toc-lmm-exp5c-alt"><span class="toc-section-number">16.3.8</span> Alternative models for exp5c</a></li>
<li><a href="lmm.html#lmm-rmanova-5c" id="toc-lmm-rmanova-5c"><span class="toc-section-number">16.3.9</span> Classical (“univariate model”) repeated measures ANOVA</a></li>
<li><a href="lmm.html#lmm-rmanova-5c-multi" id="toc-lmm-rmanova-5c-multi"><span class="toc-section-number">16.3.10</span> “Multivariate model” repeated measures ANOVA of exp5c</a></li>
<li><a href="lmm.html#modeling-textttdonor-as-a-fixed-effect" id="toc-modeling-textttdonor-as-a-fixed-effect"><span class="toc-section-number">16.3.11</span> Modeling <span class="math inline">\(\texttt{donor}\)</span> as a fixed effect</a></li>
</ul></li>
<li><a href="lmm.html#lmm-example4" id="toc-lmm-example4"><span class="toc-section-number">16.4</span> Example 4 – Experiments with subsampling replication (exp1g)</a>
<ul>
<li><a href="lmm.html#understand-the-data-2" id="toc-understand-the-data-2"><span class="toc-section-number">16.4.1</span> Understand the data</a></li>
<li><a href="lmm.html#examine-the-data-2" id="toc-examine-the-data-2"><span class="toc-section-number">16.4.2</span> Examine the data</a></li>
<li><a href="lmm.html#fit-the-model-9" id="toc-fit-the-model-9"><span class="toc-section-number">16.4.3</span> Fit the model</a></li>
<li><a href="lmm.html#inference-from-the-model-6" id="toc-inference-from-the-model-6"><span class="toc-section-number">16.4.4</span> Inference from the model</a></li>
<li><a href="lmm.html#plot-the-model-6" id="toc-plot-the-model-6"><span class="toc-section-number">16.4.5</span> Plot the model</a></li>
<li><a href="lmm.html#alternaplot-the-model-2" id="toc-alternaplot-the-model-2"><span class="toc-section-number">16.4.6</span> Alternaplot the model</a></li>
<li><a href="lmm.html#understanding-the-alternative-models" id="toc-understanding-the-alternative-models"><span class="toc-section-number">16.4.7</span> Understanding the alternative models</a></li>
<li><a href="lmm.html#the-varcorr-matrix-of-models-exp1g_m1a-and-exp1g_m1b" id="toc-the-varcorr-matrix-of-models-exp1g_m1a-and-exp1g_m1b"><span class="toc-section-number">16.4.8</span> The VarCorr matrix of models exp1g_m1a and exp1g_m1b</a></li>
<li><a href="lmm.html#the-linear-mixed-model-has-more-precision-and-power-than-the-fixed-effect-model-of-batch-means" id="toc-the-linear-mixed-model-has-more-precision-and-power-than-the-fixed-effect-model-of-batch-means"><span class="toc-section-number">16.4.9</span> The linear mixed model has more precision and power than the fixed effect model of batch means</a></li>
<li><a href="lmm.html#fixed-effect-models-and-pseudoreplication" id="toc-fixed-effect-models-and-pseudoreplication"><span class="toc-section-number">16.4.10</span> Fixed effect models and pseudoreplication</a></li>
<li><a href="lmm.html#mixed-effect-anova" id="toc-mixed-effect-anova"><span class="toc-section-number">16.4.11</span> Mixed-effect ANOVA</a></li>
</ul></li>
<li><a href="lmm.html#working-in-r-5" id="toc-working-in-r-5"><span class="toc-section-number">16.5</span> Working in R</a>
<ul>
<li><a href="lmm.html#fitting-linear-mixed-models" id="toc-fitting-linear-mixed-models"><span class="toc-section-number">16.5.1</span> Fitting linear mixed models</a></li>
<li><a href="lmm.html#plotting-models-fit-to-batched-data" id="toc-plotting-models-fit-to-batched-data"><span class="toc-section-number">16.5.2</span> Plotting models fit to batched data</a></li>
<li><a href="lmm.html#repeated-measures-anova-randomized-complete-block-with-no-subsampling" id="toc-repeated-measures-anova-randomized-complete-block-with-no-subsampling"><span class="toc-section-number">16.5.3</span> Repeated measures ANOVA (randomized complete block with no subsampling)</a></li>
</ul></li>
<li><a href="lmm.html#hidden-code-7" id="toc-hidden-code-7"><span class="toc-section-number">16.6</span> Hidden code</a>
<ul>
<li><a href="lmm.html#import-exp5c" id="toc-import-exp5c"><span class="toc-section-number">16.6.1</span> Import exp5c</a></li>
<li><a href="lmm.html#import-exp1g" id="toc-import-exp1g"><span class="toc-section-number">16.6.2</span> Import exp1g</a></li>
</ul></li>
</ul></li>
<li><a href="pre-post.html#pre-post" id="toc-pre-post"><span class="toc-section-number">17</span> Linear models for longitudinal experiments – I. pre-post designs</a>
<ul>
<li><a href="pre-post.html#best-practice-models" id="toc-best-practice-models"><span class="toc-section-number">17.1</span> Best practice models</a></li>
<li><a href="pre-post.html#common-alternatives-that-are-not-recommended" id="toc-common-alternatives-that-are-not-recommended"><span class="toc-section-number">17.2</span> Common alternatives that are not recommended</a></li>
<li><a href="pre-post.html#advanced-models" id="toc-advanced-models"><span class="toc-section-number">17.3</span> Advanced models</a></li>
<li><a href="pre-post.html#understanding-the-alternative-models-1" id="toc-understanding-the-alternative-models-1"><span class="toc-section-number">17.4</span> Understanding the alternative models</a>
<ul>
<li><a href="pre-post.html#m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model" id="toc-m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model"><span class="toc-section-number">17.4.1</span> (M1) Linear model with the baseline measure as the covariate (ANCOVA model)</a></li>
<li><a href="pre-post.html#m2-linear-model-of-the-change-score-change-score-model" id="toc-m2-linear-model-of-the-change-score-change-score-model"><span class="toc-section-number">17.4.2</span> (M2) Linear model of the change score (change-score model)</a></li>
<li><a href="pre-post.html#m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model" id="toc-m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model"><span class="toc-section-number">17.4.3</span> (M3) Linear model of post-baseline values without the baseline as a covariate (post model)</a></li>
<li><a href="pre-post.html#m4-linear-model-with-factorial-fixed-effects-fixed-effects-model" id="toc-m4-linear-model-with-factorial-fixed-effects-fixed-effects-model"><span class="toc-section-number">17.4.4</span> (M4) Linear model with factorial fixed effects (fixed-effects model)</a></li>
<li><a href="pre-post.html#m5-repeated-measures-anova" id="toc-m5-repeated-measures-anova"><span class="toc-section-number">17.4.5</span> (M5) Repeated measures ANOVA</a></li>
<li><a href="pre-post.html#m6-linear-mixed-model" id="toc-m6-linear-mixed-model"><span class="toc-section-number">17.4.6</span> (M6) Linear mixed model</a></li>
<li><a href="pre-post.html#m7-linear-model-with-correlated-error" id="toc-m7-linear-model-with-correlated-error"><span class="toc-section-number">17.4.7</span> (M7) Linear model with correlated error</a></li>
<li><a href="pre-post.html#m8-constrained-fixed-effects-model-with-correlated-error-clda-model" id="toc-m8-constrained-fixed-effects-model-with-correlated-error-clda-model"><span class="toc-section-number">17.4.8</span> (M8) Constrained fixed effects model with correlated error (cLDA model)</a></li>
<li><a href="pre-post.html#comparison-table" id="toc-comparison-table"><span class="toc-section-number">17.4.9</span> Comparison table</a></li>
</ul></li>
<li><a href="pre-post.html#example-1-a-single-post-baseline-measure-pre-post-design" id="toc-example-1-a-single-post-baseline-measure-pre-post-design"><span class="toc-section-number">17.5</span> Example 1 – a single post-baseline measure (pre-post design)</a></li>
<li><a href="pre-post.html#working-in-r-6" id="toc-working-in-r-6"><span class="toc-section-number">17.6</span> Working in R</a></li>
<li><a href="pre-post.html#hidden-code-8" id="toc-hidden-code-8"><span class="toc-section-number">17.7</span> Hidden code</a>
<ul>
<li><a href="pre-post.html#import-and-wrangle-mouse-sociability-data" id="toc-import-and-wrangle-mouse-sociability-data"><span class="toc-section-number">17.7.1</span> Import and wrangle mouse sociability data</a></li>
</ul></li>
</ul></li>
<li><a href="counts.html#counts" id="toc-counts"><span class="toc-section-number">18</span> Linear models for counts, binary responses, skewed responses, and ratios – Generalized Linear Models</a>
<ul>
<li><a href="counts.html#glm-counts" id="toc-glm-counts"><span class="toc-section-number">18.1</span> Introducing Generalized Linear Models using count data examples</a>
<ul>
<li><a href="counts.html#the-generalized-linear-model-glm" id="toc-the-generalized-linear-model-glm"><span class="toc-section-number">18.1.1</span> The Generalized Linear Model (GLM)</a></li>
<li><a href="counts.html#kinds-of-data-that-are-modeled-by-a-glm" id="toc-kinds-of-data-that-are-modeled-by-a-glm"><span class="toc-section-number">18.1.2</span> Kinds of data that are modeled by a GLM</a></li>
</ul></li>
<li><a href="counts.html#glm-1" id="toc-glm-1"><span class="toc-section-number">18.2</span> Example 1 – GLM models for count responses (“angiogenic sprouts” exp3a)</a>
<ul>
<li><a href="counts.html#understand-the-data-3" id="toc-understand-the-data-3"><span class="toc-section-number">18.2.1</span> Understand the data</a></li>
<li><a href="counts.html#model-fit-and-inference-1" id="toc-model-fit-and-inference-1"><span class="toc-section-number">18.2.2</span> Model fit and inference</a></li>
</ul></li>
<li><a href="counts.html#understanding-example-1" id="toc-understanding-example-1"><span class="toc-section-number">18.3</span> Understanding Example 1</a>
<ul>
<li><a href="counts.html#modeling-strategy-1" id="toc-modeling-strategy-1"><span class="toc-section-number">18.3.1</span> Modeling strategy</a></li>
<li><a href="counts.html#model-checking-fits-to-count-data" id="toc-model-checking-fits-to-count-data"><span class="toc-section-number">18.3.2</span> Model checking fits to count data</a></li>
<li><a href="counts.html#biological-count-data-are-rarely-fit-well-by-a-poisson-glm.-instead-fit-a-quasi-poisson-or-negative-binomial-glm-model." id="toc-biological-count-data-are-rarely-fit-well-by-a-poisson-glm.-instead-fit-a-quasi-poisson-or-negative-binomial-glm-model."><span class="toc-section-number">18.3.3</span> Biological count data are rarely fit well by a Poisson GLM. Instead, fit a quasi-poisson or negative binomial GLM model.</a></li>
<li><a href="counts.html#a-glm-is-a-linear-model-on-the-link-scale" id="toc-a-glm-is-a-linear-model-on-the-link-scale"><span class="toc-section-number">18.3.4</span> A GLM is a linear model on the link scale</a></li>
<li><a href="counts.html#coeffecients-of-a-generalized-linear-model-with-a-log-link-function-are-on-the-link-scale." id="toc-coeffecients-of-a-generalized-linear-model-with-a-log-link-function-are-on-the-link-scale."><span class="toc-section-number">18.3.5</span> Coeffecients of a Generalized Linear Model with a log-link function are on the link scale.</a></li>
<li><a href="counts.html#modeled-means-in-the-emmeans-table-of-a-generalized-linear-model-can-be-on-the-link-scale-or-response-scale-report-the-response-scale" id="toc-modeled-means-in-the-emmeans-table-of-a-generalized-linear-model-can-be-on-the-link-scale-or-response-scale-report-the-response-scale"><span class="toc-section-number">18.3.6</span> Modeled means in the emmeans table of a Generalized Linear Model can be on the link scale or response scale – Report the response scale</a></li>
<li><a href="counts.html#some-consequences-of-fitting-a-linear-model-to-count-data" id="toc-some-consequences-of-fitting-a-linear-model-to-count-data"><span class="toc-section-number">18.3.7</span> Some consequences of fitting a linear model to count data</a></li>
</ul></li>
<li><a href="counts.html#example-2-use-a-glm-with-an-offset-instead-of-a-ratio-of-some-measurement-per-area-dna-damage-data-exp3b" id="toc-example-2-use-a-glm-with-an-offset-instead-of-a-ratio-of-some-measurement-per-area-dna-damage-data-exp3b"><span class="toc-section-number">18.4</span> Example 2 – Use a GLM with an offset instead of a ratio of some measurement per area (“dna damage” data exp3b)</a>
<ul>
<li><a href="counts.html#exp3b-dna-damage-data" id="toc-exp3b-dna-damage-data"><span class="toc-section-number">18.4.1</span> exp3b (“dna damage”) data</a></li>
<li><a href="counts.html#understand-the-data-4" id="toc-understand-the-data-4"><span class="toc-section-number">18.4.2</span> Understand the data</a></li>
<li><a href="counts.html#model-fit-and-inference-2" id="toc-model-fit-and-inference-2"><span class="toc-section-number">18.4.3</span> Model fit and inference</a></li>
</ul></li>
<li><a href="counts.html#understanding-example-2" id="toc-understanding-example-2"><span class="toc-section-number">18.5</span> Understanding Example 2</a>
<ul>
<li><a href="counts.html#an-offset-is-an-added-covariate-with-a-coefficient-fixed-at-1" id="toc-an-offset-is-an-added-covariate-with-a-coefficient-fixed-at-1"><span class="toc-section-number">18.5.1</span> An offset is an added covariate with a coefficient fixed at 1</a></li>
<li><a href="counts.html#glm-rate" id="toc-glm-rate"><span class="toc-section-number">18.5.2</span> A count GLM with an offset models the area-normalized means</a></li>
<li><a href="counts.html#compare-an-offset-to-an-added-covariate-with-an-estimated-coefficient" id="toc-compare-an-offset-to-an-added-covariate-with-an-estimated-coefficient"><span class="toc-section-number">18.5.3</span> Compare an offset to an added covariate with an estimated coefficient</a></li>
<li><a href="counts.html#issues-with-plotting" id="toc-issues-with-plotting"><span class="toc-section-number">18.5.4</span> Issues with plotting</a></li>
</ul></li>
<li><a href="counts.html#example-3-glm-models-for-binary-responses" id="toc-example-3-glm-models-for-binary-responses"><span class="toc-section-number">18.6</span> Example 3 – GLM models for binary responses</a></li>
<li><a href="counts.html#working-in-r-7" id="toc-working-in-r-7"><span class="toc-section-number">18.7</span> Working in R</a>
<ul>
<li><a href="counts.html#fitting-glms-to-count-data" id="toc-fitting-glms-to-count-data"><span class="toc-section-number">18.7.1</span> Fitting GLMs to count data</a></li>
<li><a href="counts.html#fitting-a-glm-to-a-continuous-conditional-response-with-right-skew." id="toc-fitting-a-glm-to-a-continuous-conditional-response-with-right-skew."><span class="toc-section-number">18.7.2</span> Fitting a GLM to a continuous conditional response with right skew.</a></li>
<li><a href="counts.html#fitting-a-glm-to-a-binary-success-or-failure-presence-or-absence-survived-or-died-response" id="toc-fitting-a-glm-to-a-binary-success-or-failure-presence-or-absence-survived-or-died-response"><span class="toc-section-number">18.7.3</span> Fitting a GLM to a binary (success or failure, presence or absence, survived or died) response</a></li>
<li><a href="counts.html#fitting-generalized-linear-mixed-models" id="toc-fitting-generalized-linear-mixed-models"><span class="toc-section-number">18.7.4</span> Fitting Generalized Linear Mixed Models</a></li>
</ul></li>
<li><a href="counts.html#model-checking-glms" id="toc-model-checking-glms"><span class="toc-section-number">18.8</span> Model checking GLMs</a></li>
<li><a href="counts.html#hidden-code-9" id="toc-hidden-code-9"><span class="toc-section-number">18.9</span> Hidden code</a>
<ul>
<li><a href="counts.html#import-example-1-data-exp3a-angiogenic-sprouts" id="toc-import-example-1-data-exp3a-angiogenic-sprouts"><span class="toc-section-number">18.9.1</span> Import Example 1 data (exp3a – “angiogenic sprouts”)</a></li>
</ul></li>
</ul></li>
<li><a href="gls.html#gls" id="toc-gls"><span class="toc-section-number">19</span> Linear models with heterogenous variance</a></li>
<li><a href="appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models.html#appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models" id="toc-appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models">Appendix: An example set of analyses of experimental data with linear models</a></li>
<li><a href="ask1-bio.html#ask1-bio" id="toc-ask1-bio"><span class="toc-section-number">20</span> Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li><a href="ask1-report.html#ask1-report" id="toc-ask1-report"><span class="toc-section-number">21</span> Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a>
<ul>
<li><a href="ask1-report.html#setup" id="toc-setup"><span class="toc-section-number">21.1</span> Setup</a></li>
<li><a href="ask1-report.html#data-source" id="toc-data-source"><span class="toc-section-number">21.2</span> Data source</a></li>
<li><a href="ask1-report.html#control-the-color-palette" id="toc-control-the-color-palette"><span class="toc-section-number">21.3</span> control the color palette</a></li>
<li><a href="ask1-report.html#useful-functions" id="toc-useful-functions"><span class="toc-section-number">21.4</span> useful functions</a></li>
<li><a href="ask1-report.html#figure-2b-effect-of-ask1-deletion-on-growth-body-weight" id="toc-figure-2b-effect-of-ask1-deletion-on-growth-body-weight"><span class="toc-section-number">21.5</span> figure 2b – effect of ASK1 deletion on growth (body weight)</a>
<ul>
<li><a href="ask1-report.html#figure-2b-import" id="toc-figure-2b-import"><span class="toc-section-number">21.5.1</span> figure 2b – import</a></li>
<li><a href="ask1-report.html#figure-2b-exploratory-plots" id="toc-figure-2b-exploratory-plots"><span class="toc-section-number">21.5.2</span> figure 2b – exploratory plots</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2c-effect-of-ask1-deletion-on-final-body-weight" id="toc-figure-2c-effect-of-ask1-deletion-on-final-body-weight"><span class="toc-section-number">21.6</span> Figure 2c – Effect of ASK1 deletion on final body weight</a>
<ul>
<li><a href="ask1-report.html#figure-2c-import" id="toc-figure-2c-import"><span class="toc-section-number">21.6.1</span> Figure 2c – import</a></li>
<li><a href="ask1-report.html#figure-2c-check-own-computation-of-weight-change-v-imported-value" id="toc-figure-2c-check-own-computation-of-weight-change-v-imported-value"><span class="toc-section-number">21.6.2</span> Figure 2c – check own computation of weight change v imported value</a></li>
<li><a href="ask1-report.html#figure-2c-exploratory-plots" id="toc-figure-2c-exploratory-plots"><span class="toc-section-number">21.6.3</span> Figure 2c – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2c-fit-the-model-m1-lm" id="toc-figure-2c-fit-the-model-m1-lm"><span class="toc-section-number">21.6.4</span> Figure 2c – fit the model: m1 (lm)</a></li>
<li><a href="ask1-report.html#figure-2c-check-the-model-m1" id="toc-figure-2c-check-the-model-m1"><span class="toc-section-number">21.6.5</span> Figure 2c – check the model: m1</a></li>
<li><a href="ask1-report.html#figure-2c-fit-the-model-m2-gamma-glm" id="toc-figure-2c-fit-the-model-m2-gamma-glm"><span class="toc-section-number">21.6.6</span> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li><a href="ask1-report.html#figure-2c-check-the-model-m2" id="toc-figure-2c-check-the-model-m2"><span class="toc-section-number">21.6.7</span> Figure 2c – check the model, m2</a></li>
<li><a href="ask1-report.html#figure-2c-inference-from-the-model" id="toc-figure-2c-inference-from-the-model"><span class="toc-section-number">21.6.8</span> Figure 2c – inference from the model</a></li>
<li><a href="ask1-report.html#figure-2c-plot-the-model" id="toc-figure-2c-plot-the-model"><span class="toc-section-number">21.6.9</span> Figure 2c – plot the model</a></li>
<li><a href="ask1-report.html#figure-2c-report" id="toc-figure-2c-report"><span class="toc-section-number">21.6.10</span> Figure 2c – report</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve" id="toc-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><span class="toc-section-number">21.7</span> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a>
<ul>
<li><a href="ask1-report.html#figure-2d-import" id="toc-figure-2d-import"><span class="toc-section-number">21.7.1</span> Figure 2d – Import</a></li>
<li><a href="ask1-report.html#figure-2d-exploratory-plots" id="toc-figure-2d-exploratory-plots"><span class="toc-section-number">21.7.2</span> Figure 2d – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2d-fit-the-model" id="toc-figure-2d-fit-the-model"><span class="toc-section-number">21.7.3</span> Figure 2d – fit the model</a></li>
<li><a href="ask1-report.html#figure-2d-check-the-model" id="toc-figure-2d-check-the-model"><span class="toc-section-number">21.7.4</span> Figure 2d – check the model</a></li>
<li><a href="ask1-report.html#figure-2d-inference" id="toc-figure-2d-inference"><span class="toc-section-number">21.7.5</span> Figure 2d – inference</a></li>
<li><a href="ask1-report.html#figure-2d-plot-the-model" id="toc-figure-2d-plot-the-model"><span class="toc-section-number">21.7.6</span> Figure 2d – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure" id="toc-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure"><span class="toc-section-number">21.8</span> Figure 2e – Effect of ASK1 deletion on glucose tolerance (summary measure)</a>
<ul>
<li><a href="ask1-report.html#figure-2e-message-the-data" id="toc-figure-2e-message-the-data"><span class="toc-section-number">21.8.1</span> Figure 2e – message the data</a></li>
<li><a href="ask1-report.html#figure-2e-exploratory-plots" id="toc-figure-2e-exploratory-plots"><span class="toc-section-number">21.8.2</span> Figure 2e – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2e-fit-the-model" id="toc-figure-2e-fit-the-model"><span class="toc-section-number">21.8.3</span> Figure 2e – fit the model</a></li>
<li><a href="ask1-report.html#figure-2e-check-the-model" id="toc-figure-2e-check-the-model"><span class="toc-section-number">21.8.4</span> Figure 2e – check the model</a></li>
<li><a href="ask1-report.html#figure-2e-inference-from-the-model" id="toc-figure-2e-inference-from-the-model"><span class="toc-section-number">21.8.5</span> Figure 2e – inference from the model</a></li>
<li><a href="ask1-report.html#figure-2e-plot-the-model" id="toc-figure-2e-plot-the-model"><span class="toc-section-number">21.8.6</span> Figure 2e – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate" id="toc-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate"><span class="toc-section-number">21.9</span> Figure 2f – Effect of ASK1 deletion on glucose infusion rate</a>
<ul>
<li><a href="ask1-report.html#figure-2f-import" id="toc-figure-2f-import"><span class="toc-section-number">21.9.1</span> Figure 2f – import</a></li>
<li><a href="ask1-report.html#figure-2f-exploratory-plots" id="toc-figure-2f-exploratory-plots"><span class="toc-section-number">21.9.2</span> Figure 2f – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2f-fit-the-model" id="toc-figure-2f-fit-the-model"><span class="toc-section-number">21.9.3</span> Figure 2f – fit the model</a></li>
<li><a href="ask1-report.html#figure-2f-check-the-model" id="toc-figure-2f-check-the-model"><span class="toc-section-number">21.9.4</span> Figure 2f – check the model</a></li>
<li><a href="ask1-report.html#figure-2f-inference" id="toc-figure-2f-inference"><span class="toc-section-number">21.9.5</span> Figure 2f – inference</a></li>
<li><a href="ask1-report.html#figure-2f-plot-the-model" id="toc-figure-2f-plot-the-model"><span class="toc-section-number">21.9.6</span> Figure 2f – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake" id="toc-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake"><span class="toc-section-number">21.10</span> Figure 2g – Effect of ASK1 deletion on tissue-specific glucose uptake</a>
<ul>
<li><a href="ask1-report.html#figure-2g-import" id="toc-figure-2g-import"><span class="toc-section-number">21.10.1</span> Figure 2g – import</a></li>
<li><a href="ask1-report.html#figure-2g-exploratory-plots" id="toc-figure-2g-exploratory-plots"><span class="toc-section-number">21.10.2</span> Figure 2g – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2g-fit-the-model" id="toc-figure-2g-fit-the-model"><span class="toc-section-number">21.10.3</span> Figure 2g – fit the model</a></li>
<li><a href="ask1-report.html#figure-2g-check-the-model" id="toc-figure-2g-check-the-model"><span class="toc-section-number">21.10.4</span> Figure 2g – check the model</a></li>
<li><a href="ask1-report.html#figure-2g-inference" id="toc-figure-2g-inference"><span class="toc-section-number">21.10.5</span> Figure 2g – inference</a></li>
<li><a href="ask1-report.html#figure-2g-plot-the-model" id="toc-figure-2g-plot-the-model"><span class="toc-section-number">21.10.6</span> Figure 2g – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2h" id="toc-figure-2h"><span class="toc-section-number">21.11</span> Figure 2h</a></li>
<li><a href="ask1-report.html#figure-2i-effect-of-ask1-deletion-on-liver-tg" id="toc-figure-2i-effect-of-ask1-deletion-on-liver-tg"><span class="toc-section-number">21.12</span> Figure 2i – Effect of ASK1 deletion on liver TG</a>
<ul>
<li><a href="ask1-report.html#figure-2i-fit-the-model" id="toc-figure-2i-fit-the-model"><span class="toc-section-number">21.12.1</span> Figure 2i – fit the model</a></li>
<li><a href="ask1-report.html#figure-2i-check-the-model" id="toc-figure-2i-check-the-model"><span class="toc-section-number">21.12.2</span> Figure 2i – check the model</a></li>
<li><a href="ask1-report.html#figure-2i-inference" id="toc-figure-2i-inference"><span class="toc-section-number">21.12.3</span> Figure 2i – inference</a></li>
<li><a href="ask1-report.html#figure-2i-plot-the-model" id="toc-figure-2i-plot-the-model"><span class="toc-section-number">21.12.4</span> Figure 2i – plot the model</a></li>
<li><a href="ask1-report.html#figure-2i-report-the-model" id="toc-figure-2i-report-the-model"><span class="toc-section-number">21.12.5</span> Figure 2i – report the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2j" id="toc-figure-2j"><span class="toc-section-number">21.13</span> Figure 2j</a></li>
</ul></li>
<li><a href="count-sim.html#count-sim" id="toc-count-sim"><span class="toc-section-number">22</span> Simulations – Count data (alternatives to a t-test)</a>
<ul>
<li><a href="count-sim.html#use-data-similar-to-figure-6f-from-example-1" id="toc-use-data-similar-to-figure-6f-from-example-1"><span class="toc-section-number">22.1</span> Use data similar to Figure 6f from Example 1</a></li>
<li><a href="count-sim.html#functions" id="toc-functions"><span class="toc-section-number">22.2</span> Functions</a></li>
<li><a href="count-sim.html#simulations" id="toc-simulations"><span class="toc-section-number">22.3</span> Simulations</a>
<ul>
<li><a href="count-sim.html#type-i-pseudo-normal-distribution" id="toc-type-i-pseudo-normal-distribution"><span class="toc-section-number">22.3.1</span> Type I, Pseudo-Normal distribution</a></li>
<li><a href="count-sim.html#type-i-neg-binom-equal-n" id="toc-type-i-neg-binom-equal-n"><span class="toc-section-number">22.3.2</span> Type I, neg binom, equal n</a></li>
<li><a href="count-sim.html#type-i-neg-binom-equal-n-small-theta" id="toc-type-i-neg-binom-equal-n-small-theta"><span class="toc-section-number">22.3.3</span> Type I, neg binom, equal n, small theta</a></li>
<li><a href="count-sim.html#type-i-neg-binom-unequal-n" id="toc-type-i-neg-binom-unequal-n"><span class="toc-section-number">22.3.4</span> Type I, neg binom, unequal n</a></li>
<li><a href="count-sim.html#power-pseudo-normal-distribution-equal-n" id="toc-power-pseudo-normal-distribution-equal-n"><span class="toc-section-number">22.3.5</span> Power, Pseudo-Normal distribution, equal n</a></li>
<li><a href="count-sim.html#power-neg-binom-equal-n" id="toc-power-neg-binom-equal-n"><span class="toc-section-number">22.3.6</span> Power, neg binom, equal n</a></li>
<li><a href="count-sim.html#power-neg-binom-small-theta" id="toc-power-neg-binom-small-theta"><span class="toc-section-number">22.3.7</span> Power, neg binom, small theta</a></li>
<li><a href="count-sim.html#power-neg-binom-unequal-n" id="toc-power-neg-binom-unequal-n"><span class="toc-section-number">22.3.8</span> Power, neg binom, unequal n</a></li>
<li><a href="count-sim.html#power-neg-binom-unequal-n-unequal-theta" id="toc-power-neg-binom-unequal-n-unequal-theta"><span class="toc-section-number">22.3.9</span> Power, neg binom, unequal n, unequal theta</a></li>
<li><a href="count-sim.html#type-1-neg-binom-equal-n-unequal-theta" id="toc-type-1-neg-binom-equal-n-unequal-theta"><span class="toc-section-number">22.3.10</span> Type 1, neg binom, equal n, unequal theta</a></li>
</ul></li>
<li><a href="count-sim.html#save-it-read-it" id="toc-save-it-read-it"><span class="toc-section-number">22.4</span> Save it, Read it</a></li>
<li><a href="count-sim.html#analysis" id="toc-analysis"><span class="toc-section-number">22.5</span> Analysis</a></li>
</ul></li>
<li><a href="appendix-1-getting-started-with-r.html#appendix-1-getting-started-with-r" id="toc-appendix-1-getting-started-with-r">Appendix 1: Getting Started with R</a>
<ul>
<li><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready" id="toc-get-your-computer-ready"><span class="toc-section-number">22.6</span> Get your computer ready</a>
<ul>
<li><a href="appendix-1-getting-started-with-r.html#start-here" id="toc-start-here"><span class="toc-section-number">22.6.1</span> Start here</a></li>
<li><a href="appendix-1-getting-started-with-r.html#install-r" id="toc-install-r"><span class="toc-section-number">22.6.2</span> Install R</a></li>
<li><a href="appendix-1-getting-started-with-r.html#install-r-studio" id="toc-install-r-studio"><span class="toc-section-number">22.6.3</span> Install R Studio</a></li>
<li><a href="appendix-1-getting-started-with-r.html#install-r-markdown-1" id="toc-install-r-markdown-1"><span class="toc-section-number">22.6.4</span> Install R Markdown</a></li>
<li><a href="appendix-1-getting-started-with-r.html#optional-alternative-latex-installations" id="toc-optional-alternative-latex-installations"><span class="toc-section-number">22.6.5</span> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li><a href="appendix-1-getting-started-with-r.html#start-learning-r-studio" id="toc-start-learning-r-studio"><span class="toc-section-number">22.7</span> Start learning R Studio</a></li>
</ul></li>
<li><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html#appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r" id="toc-appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r">Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics for Experimental Biology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-checking" class="section level1" number="11">
<h1><span class="header-section-number">Chapter 11</span> Model Checking</h1>
<div id="check-check" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> All statistical analyses should be followed by model checking</h2>
<p>We us a linear model to infer effects or predict future outcomes. Our inference is uncertain. Given the model assumptions, we can quantify this uncertainty with standard errors, and from these standard errors we can compute confidence intervals and <em>p</em>-values. It is good practice to use a series of <strong>diagnostic plots</strong>, diagnostic statistics, and simulation to check how well the data approximate the fit model and model assumptions. <strong>Model checking</strong> is used to both check our subjective confidence in the modeled estimates and uncertainty and to provide empirical evidence for subjective decision making in the analysis workflow.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p><strong>NHST blues</strong> – Researchers are often encouraged by textbooks, colleagues, or the literature to test the assumptions of a <em>t</em>-test or ANOVA with formal hypothesis tests of distributions such as a Shapiro-Wilks test of normality or a Levine test of homogeneity. In this strategy, an alternative to the <em>t</em>-test/ANOVA is used if the distribution test’s p-value is less than some cut-off (such as 0.05). Common alternatives include 1) transformations of the response to either make it more normal or the variances more homogenous, 2) implementation of alternative tests such as a Mann-Whitney-Wilcoxon (MWW) test for non-normal data or a Welch <em>t</em>-test/ANOVA for heterogenous variances. The logic of a test of normality or homogeneity before a <em>t</em>-test/ANOVA isn’t consistent with frequentist thinking because the failure to reject a null hypothesis does not mean the null hypothesis is true. We shouldn’t conclude that a sample is “normal” or that the variances are “homogenous” because a distributional test’s <em>p</em>-value &gt; 0.05. But, maybe we should of the distributional pre-test as an “objective” model check? The logic of this objective decision rule suffers from several issues. <strong>First</strong>, the subsequent <em>p</em>-value of the <em>t</em>test/ANOVA test is not valid because this <em>p</em>-value is the long-run frequency of a test-statistic as large or larger than the observed statistic conditional on the null – not conditional on the subset of nulls with <span class="math inline">\(p &gt; 0.05\)</span> in the distribution test. <strong>Second</strong>, real data are only approximately normal; with small <span class="math inline">\(n\)</span>, it will be hard to reject the null of a normal distribution because of low power, but, as <span class="math inline">\(n\)</span> increses, a normality test will reject any real dataset. <strong>Third</strong>, and most importantly, our analysis should follow the logic of our goals. If our goal is the estimation of effects, we cannot get meaningful estimates from a non-parametric test (with a few exceptions) or a transformed response, as these methods are entirely about computing a “correct” <em>p</em>-value. Good alternatives to classic non-parametric tests and transformations are bootstrap estimates of confidence limits, permutation tests, and generalized linear models.</p>
</div>
</div>
<div id="linear-model-assumptions" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Linear model assumptions</h2>
<p>To facilitate explanation of assumptions of the linear model and extensions of the linear model, I will use both the error-draw and conditional-draw specifications of a linear model with a single <span class="math inline">\(X\)</span> variable.</p>
<p>error draw:
<span class="math display" id="eq:model-checking-spec1">\[\begin{align}
y &amp;= \beta_0 + \beta_1 x_i + \varepsilon_i\\
\varepsilon_i &amp;\sim N(0, \sigma^2)
\tag{11.1}
\end{align}\]</span></p>
<p>conditional draw:
<span class="math display" id="eq:model-checking-spec2">\[\begin{align}
y_i &amp;\sim N(\mu_i, \sigma^2)\\
\mathrm{E}(Y|X=x_i) &amp;= \mu_i\\
\mu_i &amp;= \beta_0 + \beta_1 x_i
\tag{11.2}
\end{align}\]</span></p>
<p>This model generates random data using the set of rules specified in the model equations. To quantify uncertainty in our estimated parameters, including standard errors, confidence intervals, and <em>p</em>-values, we make the assumption that the data from the experiment is a random sample generated using these rules.</p>
<p>The two rules specified in the model above (Model <a href="#eq:model-checking-spec">(<strong>??</strong>)</a>) are</p>
<ol style="list-style-type: decimal">
<li>The systematic component of data generation is <span class="math inline">\(\beta_0 + \beta_1 X\)</span>.</li>
</ol>
<ul>
<li>More generally, all linear models in this text specify systematic components that are <em>linear in the parameters</em>. Perhaps a better name for this is “additive in the parameters”. Additive (or linear) simply means that we can add up the products of a parameter and an <span class="math inline">\(X\)</span> variable to get the conditional expectation <span class="math inline">\(\mathrm{E}(Y|X)\)</span>.</li>
<li>For observational inference, the rule <span class="math inline">\(\mathrm{E}(Y| see\;X=x_i) = \mu_i\)</span> is sufficient. For causal inference with data from an experiment, or with observational data and a well defined causal diagram, we would need to modify this to <span class="math inline">\(\mathrm{E}(Y|do\; X=x_i) = \mu_i\)</span>.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>The stochastic component of data generation is “IID Normal”, where IID is <strong>independent and identically distributed</strong> and Normal refers to the Normal (or Gaussian) distribution. The IID assumption is common to all linear models. Again, for the purpose of this text, I define a “linear model” very broadly as a model that is linear in the parameters. This includes many extensions of the classical linear model including generalized least squares linear models, linear mixed models, generalized additive models, and generalized linear models. <strong>Parametric</strong> inference form all linear models requires the specification of a distribution family to sample. Families that we will use in this book include Normal, gamma, binomial, poisson, and negative binomial. This text will also cover <strong>distribution free</strong> methods of quantifying uncertainty using the bootstrap and permutation, which do not specify a sampling distribution family.</li>
</ol>
<div id="a-bit-about-iid" class="section level3" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> A bit about IID</h3>
<ol style="list-style-type: decimal">
<li><strong>Independent</strong> means that the random draw for one case cannot be predicted from the random draw of any other case. A lack of independence creates <em>correlated error</em>. There are lots or reasons that errors might be correlated. If individuals are measured both within and among cages, or tanks, or plots, or field sites, then we’d expect the measures within the same unit (cage, tank, plot, site) to err from the model in the same direction because of environmental features shared by individuals within the unit but not by individuals in other units. Multiple measures within experimental units create “clusters” of error. Lack of independence or clustered error can be modeled using <strong>generalized least squares (GLS)</strong> models that directly model the structure of the error and with <strong>random effects</strong> models. Random effects models go by many names including linear mixed models (common in Ecology), hierarchical models, and multilevel models. Both GLS and random effects models are variations of linear models.</li>
</ol>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p><strong>tl;dr</strong> – Measures taken within the same individual over time (<em>repeated measures</em>) are correlated and are common in all areas of biology. In ecology and evolutionary studies, measures that are taken from sites that are closer together or measures taken closer in time or measures from more closely related biological species will tend to have more similar error than measures taken from sites that are further apart or from times that are further apart or from species that are less closely related. Space and time and phylogeny create <strong>spatial, temporal, and phylogenetic autocorrelation</strong>.</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li><strong>Identical</strong> means that all random draws at a given value of <span class="math inline">\(X\)</span> are from the same distribution. Using the error-draw specification of the model above, this can be restated as, the error-draw (<span class="math inline">\(\varepsilon_i\)</span>) for every <span class="math inline">\(i\)</span> is from the same distribution <span class="math inline">\(N(0, \sigma^2\)</span>). Using the conditional-draw specification, this can be restated as, the random-draw <span class="math inline">\(y_i\)</span> for every <span class="math inline">\(i\)</span> with the same expected value <span class="math inline">\(\mu = \mu_i\)</span> is from the same distribution <span class="math inline">\(N(\mu_i, \sigma^2\)</span>). Understand the importance of this. Parametric inference using this model assumes that the sampling variance of <span class="math inline">\(\mu\)</span> <em>at a single value of <span class="math inline">\(X\)</span></em> is the same for <em>all values of <span class="math inline">\(X\)</span></em>. If <span class="math inline">\(X\)</span> is continuous, this means the spread of the points around the regression line is the same at all values of <span class="math inline">\(X\)</span> in the data. If <span class="math inline">\(X\)</span> is categorical, this means the spread of the points around the mean of a group is the same for all groups. A consequence of “identical”, then, for all classical linear models, is the assumption of homogeneity (or <strong>homoskedasticity</strong>) of variance. If the sampling variance differs among the <span class="math inline">\(X\)</span>, then the variances are heterogenous or <strong>heteroskedastic</strong>. Experimental treatments can affect the variance of the response in addition to the mean of the response. Heterogenous variance can be modeled using <strong>Generalized Least Squares (GLS)</strong> linear models. Many natural biological processes generate data in which the error is a function of the mean. For example, measures of biological variables that grow, such as size of body parts, have variances that “grow” with the mean. Or, measures of counts, such as the number of cells damaged by toxin, the number of eggs in a nest, or the number of mRNA transcripts per cell have variances that are a function of the mean. Both growth and count measures can sometimes be reasonably modeled using a linear model but more often, they are better modeled using a <strong>Generalized Linear Model</strong> (GLM).</li>
</ol>
</div>
</div>
<div id="diagnostic-plots-use-the-residuals-from-the-model-fit" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Diagnostic plots use the residuals from the model fit</h2>
<div id="residuals" class="section level3" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> Residuals</h3>
<p>A residual of a statistical model is <span class="math inline">\(y_i - \hat{y}_i\)</span>. Remember that <span class="math inline">\(\hat{y}_i\)</span> is the predicted value of <span class="math inline">\(Y\)</span> when <span class="math inline">\(X\)</span> has the value <span class="math inline">\(x_i\)</span> (compactly written as <span class="math inline">\(X=x_i\)</span>). And remember that <span class="math inline">\(\hat{y}_i\)</span> is the estimate of <span class="math inline">\(\mu_i\)</span>. For linear models (but not generalized linear models), the residuals of the fit model are estimates of the <span class="math inline">\(\varepsilon\)</span> in equation <a href="model-checking.html#eq:model-checking-spec1">(11.1)</a>. This <em>is not</em> true for generalized linear models because GLMs are not specified using <a href="model-checking.html#eq:model-checking-spec1">(11.1)</a>.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p><strong>Alert</strong> A common misconception is that inference from a linear model assumes that the <em>response</em> (the measured <span class="math inline">\(Y\)</span>) is IID Normal. This is wrong. Either specification of the linear model shows precisely why this conception is wrong. Model <a href="model-checking.html#eq:model-checking-spec1">(11.1)</a> explicitly shows that it is the error that has the normal distribution – the distribution of <span class="math inline">\(Y\)</span> is a mix of the distribution of <span class="math inline">\(X\)</span> and that of the error. A more general way of thinking about the assumed distribution uses the specification in model <a href="model-checking.html#eq:model-checking-spec2">(11.2)</a>, which shows that it is the <em>conditional</em> response that is assumed to be IID normal. Remember, a conditional response (<span class="math inline">\(y_i\)</span>) is a random draw from the infinite set of responses at a given value of <span class="math inline">\(X\)</span>.</p>
</div>
<p>Let’s look at the distribution of residuals versus the distribution of responses for a hypothetical experiment with a single, categorical <span class="math inline">\(X\)</span> variable (the experimental factor) with two levels (“Cn” for control and “Tr” for treatment). The true parameters are <span class="math inline">\(\beta_0 = 10\)</span> (the true mean for the control group, or <span class="math inline">\(\mu_{0}\)</span>), <span class="math inline">\(\beta_1=4\)</span> (the difference between the true mean for the treatment minus the true mean for the control, or <span class="math inline">\(\mu_1 - \mu_0\)</span>), and <span class="math inline">\(\sigma = 2\)</span> (the error standard deviation).</p>
<div class="figure">
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/model-check-histogram,%20model-check-residuals1-1.png" alt="Histogram of the (A) response, showing with modes near the true means of each group and (B) residuals, with a mode for both groups at zero." width="576" />
<p class="caption">
(#fig:model-check-histogram, model-check-residuals1)Histogram of the (A) response, showing with modes near the true means of each group and (B) residuals, with a mode for both groups at zero.
</p>
</div>
<p>The plot above shows a histogram of the response (A) and residuals (B). In the plot of the response, the mode (the highest bar, or bin with the most cases) includes true mean for each group. And, as expected given <span class="math inline">\(\beta_1=4\)</span>, the modes of the two groups are 4 units apart. It should be easy to see from this plot that the response does not have a normal distribution. Instead, it is distincly bimodal. But the distribution of the response <em>within</em> each level looks like these are drawn from a normal distribution – and it should. In the plot of the residuals, the values of both groups are shifted so that the mean of each group is at zero. The consequence of the shift is that the combined set of residuals does look like it is drawn from a Normal distribution.</p>
<p>The two plots suggest two different approaches for model checking. First, we could examine the responses within each level of the experimental factor. Or, second, we could examine the residuals of the fit model, ignoring that the residuals come from multiple groups. The first is inefficient because it requires as many checks as there are levels in the factor. The second requires a single check.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p><strong>Alert</strong> Some textbooks that recommend formal hypothesis tests of normality recommend the inefficient, multiple testing on each group separately. This isn’t wrong, it’s just more work than it needs to be and also suffers from “multiple testing”.</p>
</div>
</div>
<div id="normal-qq" class="section level3" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> A Normal Q-Q plot is used to check for characteristic departures from Normality</h3>
<p>A Normal Q-Q plot is a scatterplot of</p>
<ol style="list-style-type: decimal">
<li><strong>sample quantiles</strong> on the <em>y</em> axis. The sample quantiles is the vector of <span class="math inline">\(N\)</span> residuals in rank order, from smallest (most negative) to largest (most positive). Sometimes this vector is standardized by dividing the residual by the standard deviation of the residuals (doing this makes no difference to the interpretation of the Q-Q plot).</li>
<li><strong>standard normal quantiles</strong> on the <em>x</em> axis. This is the vector of standard, Normal quantiles given <span class="math inline">\(N\)</span> elements in the vector. “Standard Normal” means a normal distribution with mean zero and standard deviation (<span class="math inline">\(\sigma\)</span>) one. A Normal quantile is the expected deviation given a probability. For example, if the probability is 0.025, the Normal quantile is -1.959964. Check your understanding: 2.5% of the values in a Normal distribution with mean 0 and standard deviation one are more negative than -1.959964. The Normal quantiles of a Normal Q-Q plot are computed for the set of <span class="math inline">\(N\)</span> values that evenly split the probability span from 0 to 1. For <span class="math inline">\(N=20\)</span>, this would be</li>
</ol>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="model-checking.html#cb305-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">quantile =</span> <span class="fu">qnorm</span>(<span class="fu">ppoints</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)))</span>
<span id="cb305-2"><a href="model-checking.html#cb305-2" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(p) <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb305-3"><a href="model-checking.html#cb305-3" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>##          quantile
## 0.025 -1.95996398
## 0.075 -1.43953147
## 0.125 -1.15034938
## 0.175 -0.93458929
## 0.225 -0.75541503
## 0.275 -0.59776013
## 0.325 -0.45376219
## 0.375 -0.31863936
## 0.425 -0.18911843
## 0.475 -0.06270678
## 0.525  0.06270678
## 0.575  0.18911843
## 0.625  0.31863936
## 0.675  0.45376219
## 0.725  0.59776013
## 0.775  0.75541503
## 0.825  0.93458929
## 0.875  1.15034938
## 0.925  1.43953147
## 0.975  1.95996398</code></pre>
<p>A Normal Q-Q plot is not a test if the data are Normal. Instead, a Normal Q-Q plot is used to check for characteristic departures from Normality that are signatures of certain well-known distribution families. A researcher can look at a QQ-plot and reason that a departure is small and choose to fit a classic linear model using the Normal distribution. Or, a researcher can look at a QQ-plot and reason that the departure is large enough to fit a generalized linear model with a specific distribution family.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p><strong>Stats 101</strong> A quantile is the value of a distribution that is greater than <span class="math inline">\(p\)</span> percent of the values in the distribution. The 2.5% quantile of a uniform distribution from 0 to 1 is 0.025. The 2.5% quantile of a standard normal distribution is -1.96 (remember that 95% of the values in a standard normal distribution are between -1.96 and 1.96). The 50% quantile of a uniform distribution is 0.5 and the 50% quantile of a standard normal distribution is 0.0 (this is the median of the distribtion – 50% of the values are smaller and 50% of the values are larger).</p>
</div>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p><strong>Stats 201</strong> A Q-Q plot more generally is a scatter plot of two vectors of quantiles either of which can come from a sample or a theoretical distribution. In the GLM chapter, the text will introduce Q-Q plots of residual quantiles transformed to have an expected uniform distribution. These are plotted against theoretical uniform quantiles from 0 to 1.</p>
</div>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p><strong>Intuition Pump</strong> – Let’s construct a Normal Q-Q plot. A <strong>quantile</strong> (or percentile) of a vector of numbers is the value of the point at a specified percentage rank. The median is the 50% quantile. The 95% confidence intervals are at the 2.5% and 97.5% quantiles. In a Normal Q-Q plot, we want to plot the quantiles of the residuals against a set of theoretical quantiles.</p>
<ol style="list-style-type: decimal">
<li>To get the observed quantiles, rank the residuals of the fit linear model from most negative to most positive – these are your quantiles! For example, if you have <span class="math inline">\(n=145\)</span> residuals, then the 73rd point is the 50% quantile.</li>
<li>A theoretical quantile from the normal distribution can be constructed using the <code>qnorm</code> function which returns the normal quantiles for a specified vector of percents. Alternatively, one could randomly sample <span class="math inline">\(n\)</span> points using <code>rnorm</code>. These of course will be sampled quantiles so will only approximate the expected theoretical quantiles, but I add this here because we use this method below.</li>
</ol>
<p>Now simply plot the observed against theoretical quantiles. Often, the <strong>standardized</strong> quantiles are plotted. A standardized variable has a mean of zero and a standard deviation of one and is computed by 1) centering the vector at zero by subtracting the mean from every value, and 2) dividing each value by the standard deviation of the vector. Recognize that because a standard deviation is a function of deviations from the mean, it doesn’t matter which of these operations is done first. A standardized theoretical quantile is specified by <code>qnorm(p, mean = 0, sd = 1)</code>, which is the default.</p>
<p>Code for this would look something like this</p>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/glm1-qqplot-sim-1.png" width="576" /></p>
</div>
<div id="normal-qq-plot-of-the-fake-data-generated-above" class="section level4" number="11.3.2.1">
<h4><span class="header-section-number">11.3.2.1</span> Normal QQ-plot of the fake data generated above</h4>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/model-check-qq-1.png" width="576" /></p>
<p>If the sampled distribution approximates a sample from a normal distribution, the scatter should fall along a line from the bottom, left to the top, right of the plot. The interpretation of a normal Q-Q plot is enhanced with a line of “expected values” of the sample quantiles if the sample residuals are drawn from a normal distribution. The closer the sample quantiles are to the line, the more closely the residuals approximate the expectation from a normal distribution. Because of sampling, the sampled values always deviate from the line, especially at the ends. The shaded gray area in the Q-Q plot in Figure <a href="#fig:model-check-qq"><strong>??</strong></a> are the 95% confidence bands of the quantiles. A pattern of observed quantiles with some individual points outside of these boundaries indicates a sample that would be unusual if sampled from a Normal distribution.</p>
<p>Biological datasets frequently have departures on a Normal Q-Q plot that are characteristic of specific distribution families, including lognormal, binomial, poisson, negative binomial, gamma, and beta. It is useful to learn how to read a Normal Q-Q plot to help guide how to model your data.</p>
<p>What about the intepretation of the Q-Q plot in Figure <a href="#fig:model-check-qq"><strong>??</strong></a>? At the small end of the distribution (bottom-left), the sample values are a bit more negative than expected, which means the left tail is a bit extended. At the large end (upper-right), the sample values are, a bit less positive than expected, which means the right tail is a bit shortened. This is a departure in the direction of a left skewed distribution. Should we fit a different model given these deviations? To guide us, we compare the quantiles to the 95% confidence band of the quantiles. Clearly the observed quantiles are within the range of quantiles that we’d expect if sampling from a Normal distribution.</p>
</div>
</div>
<div id="mapping-qq-plot-departures-from-normality" class="section level3" number="11.3.3">
<h3><span class="header-section-number">11.3.3</span> Mapping QQ-plot departures from Normality</h3>
<p>Let’s look at simulated samples drawn from non-normal distributions to identify their characteristic deviations. Each set of plots below shows</p>
<ol style="list-style-type: decimal">
<li>(left panel) A histogram of 10,000 random draws from the non-Normal distribution (blue). This histogram is superimposed over that of 10,000 random draws from a Normal distribution (orange) with the same mean and variance as that of the non-normal distribution.</li>
<li>(middle panel) Box plots and strip chart of a random subset (<span class="math inline">\(N=1000\)</span>) of data in the left panel.</li>
<li>(right panel) Normal Q-Q plot of the non_Normal data only.</li>
</ol>
<p><strong>Skewed-Right Q-Q</strong></p>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-149-1.png" width="90%" /></p>
<p>The Normal Q-Q plot of a sample from a right-skewed distribution is characterized by sample quantiles at the high (right) end being more positive than the expected Normal quantiles. Often, the quantiles at the low (left) end are also less negative than the expected normal quantiles. The consequence is a concave up pattern.</p>
<p>The histograms in the left panel explain this pattern. The right tail of the skewed-right distribution extends further than the right tail of the Normal. It is easy to see from this that, if we rank the values of each distribution from small to large (these are the quantiles), the upper quantiles of the skewed-right distribution will be larger than the matching quantile of the Normal distribution. For example, the 99,990th quantile for the skewed-right distribution will be much more positive than the 99,990th quantile for the Normal distribution. The opposite occurs at the left tail, which extends further in the negative direction in the Normal than the skewed-right distribution.</p>
<p>The middle panel compares a boxplot and stripchart of samples from the two distributions to show what researchers should look for in their own publication-ready plots as well as the published plots of colleagues. The skewed-right plot exhibits several hallmarks of a skewed-right distribution including 1) a median line (the horizontal line within the box) that is closer to the 25th percentile line (the lower end of the box) than to the 75th percentile line (the upper end of the box), 2) a longer upper than lower whisker (the vertical lines extending out of the box), 3) more outliers above the upper whisker than below the lower whisker, and 4) a lengthened, upward smear of the scatter of points at the high end of the values, relative to the more compact smear at the low end of the values.</p>
<p><strong>Skewed-Left Q-Q</strong></p>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-150-1.png" width="90%" /></p>
<p>The Normal Q-Q plot of a sample from a left-skewed distribution is characterized by sample quantiles at the low (left) end being more negative than the expected Normal quantiles. Often, the quantiles at the high (right) end are also less positive than the expected normal quantiles. The consequence is a concave down pattern.</p>
<p>The histograms in the left panel explain this pattern. The left tail of the skewed-left distribution extends further than the left tail of the Normal. It is easy to see from this that, if we rank the values of each distribution from small to large (these are the quantiles), the lower quantiles of the skewed-left distribution will be more negative than the matching quantile of the Normal distribution. For example, the 10th quantile for the skewed-left distribution will be much more negative than the 10th quantile for the Normal distribution. The opposite occurs at the right tail, which extends further in the positive direction in the Normal than the skewed-left distribution.</p>
<p>The skewed-left plot in the middle panel highlights several hallmarks of a skewed-left distribution including 1) a median line (the horizontal line within the box) that is closer to the 75th percentile line (the lower end of the box) than to the 25th percentile line (the upper end of the box), 2) a longer lower than upper whisker (the vertical lines extending out of the box), 3) more outliers below the lower whisker than above the upper whisker, and 4) a lengthened, downward smear of the scatter of points at the low end of the values, relative to the more compact smear at the upper end of the values.</p>
<p><strong>Heavy Tail Q-Q</strong></p>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-151-1.png" width="90%" /></p>
<p>The Normal Q-Q plot of a sample from a heavy-tail distribution is characterized by sample quantiles at the low (left) end being more negative than the expected Normal quantiles and quantiles at the high (right) end that are more positive than the expected normal quantiles.</p>
<p>The histograms in the left panel explain this pattern. At each tail, the heavy-tail distribution has more <strong>density</strong> – there are more values far from the mean – compared to the Normal distribution. This is the origin of “heavy tail”. It is easy to see from this that, if we rank the values of each distribution from small to large (these are the quantiles), the lower quantiles of the heavy tail distribution will be more negative than the matching quantile of the Normal distribution. For example, the 10th quantile for the heavy-tail distribution will be much more negative than the 10th quantile for the Normal distribution. Likewise, the upper quantiles of the heavy tail distribution will be more positive than the matching quantile of the Normal distribution. For example, the 99,990th quantile for the heavy-tail distribution will be much more positive than the 99,990th quantile for the Normal distribution.</p>
<p>The heavy-tail plot in the middle panel shows more boxplot outliers than in the Normal plot. This would be hard to recognize in a plot of real data.</p>
<div id="mapping-characteristic-departures-on-a-q-q-plot-to-specific-distributions" class="section level4" number="11.3.3.1">
<h4><span class="header-section-number">11.3.3.1</span> Mapping characteristic departures on a Q-Q plot to specific distributions</h4>
<ol style="list-style-type: decimal">
<li>Continuous response variables of length, area, weight, or duration will often look like samples from a continous probability distribution that is right-skewed, such as the <strong>lognormal</strong> or <strong>gamma</strong> distributions.</li>
<li>Count response variables will frequently look like samples from a discrete probability distribution that is right-skewed, such as the <strong>poisson</strong>, <strong>quasi-poisson</strong>, or <strong>negative binomial</strong> distributions.</li>
<li>Proportion (fraction of a whole) response variables will frequently look like samples from a continuous probability distribution bounded by 0 and 1, such as the <strong>beta</strong> distribution. Samples from a beta distribution can be left skewed, if the mean is near 1, right-skewed, if the mean is near zero, or symmetrical, if the mean is near 0.5.</li>
</ol>
</div>
<div id="pump-your-intuition-confidence-bands-of-a-q-q-plot" class="section level4" number="11.3.3.2">
<h4><span class="header-section-number">11.3.3.2</span> Pump your intuition – confidence bands of a Q-Q plot</h4>
<p>In introducing the confidence bands of the Q-Q plot above, I stated “A pattern of observed quantiles with some individual points outside of these boundaries indicates a sample that would be unusual if sampled from a Normal distribution.” Let’s use a parametric bootstrap to explore this.</p>
<ol style="list-style-type: decimal">
<li>Sample <span class="math inline">\(n\)</span> values from a Normal distribution</li>
<li>Compute the sample quantiles by re-ordering the residuals of the sampled values from the sampled mean, from most negative to most positive.</li>
<li>Plot the quantiles against Normal quantiles for <span class="math inline">\(n\)</span> points.</li>
<li>Repeat steps 1-3 <span class="math inline">\(n\_iter\)</span> times, superimposing the new sample quantiles over all previous sample quantiles. This creates a band of all sample quantiles over <span class="math inline">\(n\_iter\)</span> iterations of sampling <span class="math inline">\(n\)</span> values from a Normal distribution.</li>
<li>At each value of the Normal quantile, compute the 95 percentile range of the sampled quantiles. Draw a ribbon inside these boundaries.</li>
</ol>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="model-checking.html#cb307-1" aria-hidden="true" tabindex="-1"></a>n_iter <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb307-2"><a href="model-checking.html#cb307-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb307-3"><a href="model-checking.html#cb307-3" aria-hidden="true" tabindex="-1"></a>normal_qq <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(n) <span class="sc">%&gt;%</span></span>
<span id="cb307-4"><a href="model-checking.html#cb307-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qnorm</span>()</span>
<span id="cb307-5"><a href="model-checking.html#cb307-5" aria-hidden="true" tabindex="-1"></a>sample_qq <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter<span class="sc">*</span>n)</span>
<span id="cb307-6"><a href="model-checking.html#cb307-6" aria-hidden="true" tabindex="-1"></a>inc <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb307-7"><a href="model-checking.html#cb307-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_iter){</span>
<span id="cb307-8"><a href="model-checking.html#cb307-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb307-9"><a href="model-checking.html#cb307-9" aria-hidden="true" tabindex="-1"></a>  y_res <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb307-10"><a href="model-checking.html#cb307-10" aria-hidden="true" tabindex="-1"></a>  sample_qq[inc] <span class="ot">&lt;-</span> y_res[<span class="fu">order</span>(y_res)]</span>
<span id="cb307-11"><a href="model-checking.html#cb307-11" aria-hidden="true" tabindex="-1"></a>  inc <span class="ot">&lt;-</span> inc <span class="sc">+</span> n</span>
<span id="cb307-12"><a href="model-checking.html#cb307-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb307-13"><a href="model-checking.html#cb307-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-14"><a href="model-checking.html#cb307-14" aria-hidden="true" tabindex="-1"></a>qq_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">normal_qq =</span> normal_qq,</span>
<span id="cb307-15"><a href="model-checking.html#cb307-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sample_qq =</span> sample_qq)</span>
<span id="cb307-16"><a href="model-checking.html#cb307-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-17"><a href="model-checking.html#cb307-17" aria-hidden="true" tabindex="-1"></a>qq_ci <span class="ot">&lt;-</span> qq_data[, .(<span class="at">median =</span> <span class="fu">median</span>(sample_qq),</span>
<span id="cb307-18"><a href="model-checking.html#cb307-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lower =</span> <span class="fu">quantile</span>(sample_qq, <span class="fl">0.025</span>),</span>
<span id="cb307-19"><a href="model-checking.html#cb307-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">upper =</span> <span class="fu">quantile</span>(sample_qq, <span class="fl">0.975</span>)),</span>
<span id="cb307-20"><a href="model-checking.html#cb307-20" aria-hidden="true" tabindex="-1"></a>                 by <span class="ot">=</span> normal_qq]</span>
<span id="cb307-21"><a href="model-checking.html#cb307-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-22"><a href="model-checking.html#cb307-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> qq_data,</span>
<span id="cb307-23"><a href="model-checking.html#cb307-23" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> normal_qq,</span>
<span id="cb307-24"><a href="model-checking.html#cb307-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> sample_qq)) <span class="sc">+</span></span>
<span id="cb307-25"><a href="model-checking.html#cb307-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb307-26"><a href="model-checking.html#cb307-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> qq_ci,</span>
<span id="cb307-27"><a href="model-checking.html#cb307-27" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> lower,</span>
<span id="cb307-28"><a href="model-checking.html#cb307-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> upper,</span>
<span id="cb307-29"><a href="model-checking.html#cb307-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> median,</span>
<span id="cb307-30"><a href="model-checking.html#cb307-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">&quot;band&quot;</span>),</span>
<span id="cb307-31"><a href="model-checking.html#cb307-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> pal_okabe_ito[<span class="dv">1</span>],</span>
<span id="cb307-32"><a href="model-checking.html#cb307-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb307-33"><a href="model-checking.html#cb307-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Normal Quantile&quot;</span>) <span class="sc">+</span></span>
<span id="cb307-34"><a href="model-checking.html#cb307-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Sample Quantile&quot;</span>) <span class="sc">+</span></span>
<span id="cb307-35"><a href="model-checking.html#cb307-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_grid</span>() <span class="sc">+</span></span>
<span id="cb307-36"><a href="model-checking.html#cb307-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb307-37"><a href="model-checking.html#cb307-37" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span></code></pre></div>
</div>
</div>
<div id="model-checking-spread-level" class="section level3" number="11.3.4">
<h3><span class="header-section-number">11.3.4</span> Model checking homoskedasticity</h3>
</div>
</div>
<div id="using-r" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Using R</h2>
</div>
<div id="hidden-code-3" class="section level2" number="11.5">
<h2><span class="header-section-number">11.5</span> Hidden Code</h2>
<p>Source: <a href="https://www.nature.com/articles/s41586-019-1450-6" target="_blank">Wellenstein, M.D., Coffelt, S.B., Duits, D.E., van Miltenburg, M.H., Slagter, M., de Rink, I., Henneman, L., Kas, S.M., Prekovic, S., Hau, C.S. and Vrijland, K., 2019. Loss of p53 triggers WNT-dependent systemic inflammation to drive breast cancer metastasis. Nature, 572(7770), pp.538-542.</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6707815/" target="_blank">Public source</a></p>
<p><a href="https://www.nature.com/articles/s41586-019-1450-6#Sec22" target="_blank">Data source</a></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="model-checking.html#cb308-1" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Loss of p53 triggers WNT-dependent systemic inflammation to drive breast cancer metastasis&quot;</span></span>
<span id="cb308-2"><a href="model-checking.html#cb308-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41586_2019_1450_MOESM3_ESM.xlsx&quot;</span></span>
<span id="cb308-3"><a href="model-checking.html#cb308-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb308-4"><a href="model-checking.html#cb308-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb308-5"><a href="model-checking.html#cb308-5" aria-hidden="true" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Trp53+/+&quot;</span>, <span class="st">&quot;Trp53-/-&quot;</span>)</span>
<span id="cb308-6"><a href="model-checking.html#cb308-6" aria-hidden="true" tabindex="-1"></a>fig1f <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb308-7"><a href="model-checking.html#cb308-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sheet =</span> <span class="st">&quot;Fig. 1f&quot;</span>,</span>
<span id="cb308-8"><a href="model-checking.html#cb308-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">range =</span> <span class="st">&quot;A2:B23&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb308-9"><a href="model-checking.html#cb308-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb308-10"><a href="model-checking.html#cb308-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">measure.vars =</span> treatment_levels,</span>
<span id="cb308-11"><a href="model-checking.html#cb308-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">variable.name =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb308-12"><a href="model-checking.html#cb308-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">value.name =</span> <span class="st">&quot;il1beta&quot;</span>)</span>
<span id="cb308-13"><a href="model-checking.html#cb308-13" aria-hidden="true" tabindex="-1"></a>fig1f[, treatment <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(treatment, treatment_levels)]</span>
<span id="cb308-14"><a href="model-checking.html#cb308-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-15"><a href="model-checking.html#cb308-15" aria-hidden="true" tabindex="-1"></a><span class="co"># be careful of the missing data. This can create mismatch between id and residual unless specified in lm</span></span>
<span id="cb308-16"><a href="model-checking.html#cb308-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-17"><a href="model-checking.html#cb308-17" aria-hidden="true" tabindex="-1"></a><span class="co"># head(fig1f)</span></span></code></pre></div>
<p>Fit a linear model</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="model-checking.html#cb309-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(il1beta <span class="sc">~</span> treatment,</span>
<span id="cb309-2"><a href="model-checking.html#cb309-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> fig1f)</span></code></pre></div>
<div id="normal-q-q-plots" class="section level3" number="11.5.1">
<h3><span class="header-section-number">11.5.1</span> Normal Q-Q plots</h3>
<p><code>car::qqPlot</code> has several important arguments to control the type of Q-Q plot. The function uses base graphics instead of ggplot2. Typically, these plots would not be published other than possibly a supplement. <a href="https://www.tjmahr.com/quantile-quantile-plots-from-scratch/" target="_blank">Q-Q Plots and Worm Plots from Scratch</a> is a good source of some of the arguments in <code>qqPlot</code>. Three important arguments are:</p>
<ol style="list-style-type: decimal">
<li>simulate. If passing a <code>lm</code> object, then the default confidence band is generated by a parametric bootstrap (<code>simulate = TRUE</code>). This band will differ somewhat each time you replot unless you set the seed with <code>set.seed</code>. Setting the argument <code>simulate = FALSE</code> returns the parametric band.</li>
<li>line. If passing a <code>lm</code> object, then the default line is a fit from a robust regression (<code>line = "robust"</code>). Setting the argument <code>line = "quartiles"</code> fits a line throught the 25th and 75th percentile (or “quartiles”) quantiles.</li>
<li>id. The default identifies the index of the two points with the most extreme quartiles. Set to FALSE to hide.</li>
</ol>
<p>The robust line is more sensitive to departures from Normality than the quartiles line.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="model-checking.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co"># defaults: robust line with bootstrap CI</span></span>
<span id="cb310-2"><a href="model-checking.html#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb310-3"><a href="model-checking.html#cb310-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(m1, <span class="at">id =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-155-1.png" width="576" /></p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="model-checking.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># classic: standard line with parametric CI</span></span>
<span id="cb311-2"><a href="model-checking.html#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(m1,</span>
<span id="cb311-3"><a href="model-checking.html#cb311-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">line =</span> <span class="st">&quot;quartiles&quot;</span>,</span>
<span id="cb311-4"><a href="model-checking.html#cb311-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">simulate =</span> <span class="cn">FALSE</span>,</span>
<span id="cb311-5"><a href="model-checking.html#cb311-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">id =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><code>ggpubr::ggqqplot</code> generates a pretty, ggplot2 based Normal Q-Q plot, using the standard method for computing the line and confidence band.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="model-checking.html#cb312-1" aria-hidden="true" tabindex="-1"></a>m1_residuals <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">m1_residuals =</span> <span class="fu">residuals</span>(m1))</span>
<span id="cb312-2"><a href="model-checking.html#cb312-2" aria-hidden="true" tabindex="-1"></a>m1_residuals[, studentized <span class="sc">:</span><span class="er">=</span> m1_residuals<span class="sc">/</span><span class="fu">sd</span>(m1_residuals)]</span>
<span id="cb312-3"><a href="model-checking.html#cb312-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(<span class="at">data =</span> m1_residuals,</span>
<span id="cb312-4"><a href="model-checking.html#cb312-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">&quot;studentized&quot;</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-157-1.png" width="576" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="oneway.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="violations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/26-model-checking.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
