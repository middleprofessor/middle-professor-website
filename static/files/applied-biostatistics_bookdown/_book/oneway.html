<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Linear models with a single, categorical X (“t-tests” and “ANOVA”) | Applied Statistics for Experimental Biology</title>
  <meta name="description" content="An introduction to statistical modeling for experimental biology researchers" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Linear models with a single, categorical X (“t-tests” and “ANOVA”) | Applied Statistics for Experimental Biology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Linear models with a single, categorical X (“t-tests” and “ANOVA”) | Applied Statistics for Experimental Biology" />
  
  <meta name="twitter:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regression.html"/>
<link rel="next" href="model-checking.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="index.html#why-bother-with-linear-models-arent-t-tests-and-anova-good-enough" id="toc-why-bother-with-linear-models-arent-t-tests-and-anova-good-enough">Why bother with linear models – aren’t <em>t</em>-tests and ANOVA good enough?</a></li>
<li><a href="index.html#what-is-unusual-about-this-book" id="toc-what-is-unusual-about-this-book">What is unusual about this book?</a></li>
</ul></li>
<li><a href="a-table-of-models.html#a-table-of-models" id="toc-a-table-of-models">A Table of Models</a>
<ul>
<li><a href="a-table-of-models.html#including-mapping-between-linear-models-and-classical-tests" id="toc-including-mapping-between-linear-models-and-classical-tests">including mapping between linear models and classical tests</a></li>
</ul></li>
<li><a href="ask1-intro.html#ask1-intro" id="toc-ask1-intro"><span class="toc-section-number">1</span> Analyzing experimental data with a linear model</a>
<ul>
<li><a href="ask1-intro.html#this-text-is-about-using-linear-models-to-estimate-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect" id="toc-this-text-is-about-using-linear-models-to-estimate-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect"><span class="toc-section-number">1.1</span> This text is about using linear models to estimate treatment effects and the uncertainty in our estimates. This, raises the question, what is “an effect”?</a></li>
</ul></li>
<li><a href="part-i-getting-started.html#part-i-getting-started" id="toc-part-i-getting-started">Part I: Getting Started</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#getting-started-r-projects-and-r-markdown" id="toc-getting-started-r-projects-and-r-markdown"><span class="toc-section-number">2</span> Getting Started – R Projects and R Markdown</a>
<ul>
<li><a href="getting-started-r-projects-and-r-markdown.html#r-vs-r-studio" id="toc-r-vs-r-studio"><span class="toc-section-number">2.1</span> R vs R Studio</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#download-and-install-r-and-r-studio" id="toc-download-and-install-r-and-r-studio"><span class="toc-section-number">2.2</span> Download and install R and R studio</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#open-r-studio-and-modify-the-workspace-preference" id="toc-open-r-studio-and-modify-the-workspace-preference"><span class="toc-section-number">2.3</span> Open R Studio and modify the workspace preference</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it" id="toc-if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it"><span class="toc-section-number">2.4</span> If you didn’t modify the workspace preferences from the previous section, go back and do it</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#r-markdown-in-a-nutshell" id="toc-r-markdown-in-a-nutshell"><span class="toc-section-number">2.5</span> R Markdown in a nutshell</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#install-r-markdown" id="toc-install-r-markdown"><span class="toc-section-number">2.6</span> Install R Markdown</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#importing-packages" id="toc-importing-packages"><span class="toc-section-number">2.7</span> Importing Packages</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#setup-create-project" id="toc-setup-create-project"><span class="toc-section-number">2.8</span> Create an R Studio Project for this textbook</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#working-on-a-project-in-a-nutshell" id="toc-working-on-a-project-in-a-nutshell"><span class="toc-section-number">2.9</span> Working on a project, in a nutshell</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#setup-create-rmd" id="toc-setup-create-rmd"><span class="toc-section-number">2.10</span> Create and setup an R Markdown document (Rmd)</a>
<ul>
<li><a href="getting-started-r-projects-and-r-markdown.html#modify-the-yaml-header" id="toc-modify-the-yaml-header"><span class="toc-section-number">2.10.1</span> Modify the yaml header</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#modify-the-setup-chunk" id="toc-modify-the-setup-chunk"><span class="toc-section-number">2.10.2</span> Modify the “setup” chunk</a></li>
</ul></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#lets-play-around-with-an-r-markdown-file" id="toc-lets-play-around-with-an-r-markdown-file"><span class="toc-section-number">2.11</span> Let’s play around with an R Markdown file</a>
<ul>
<li><a href="getting-started-r-projects-and-r-markdown.html#create-a-fake-data-chunk" id="toc-create-a-fake-data-chunk"><span class="toc-section-number">2.11.1</span> Create a “fake-data” chunk</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#create-a-plot-chunk" id="toc-create-a-plot-chunk"><span class="toc-section-number">2.11.2</span> Create a “plot” chunk</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#knit-the-rmd" id="toc-knit-the-rmd"><span class="toc-section-number">2.11.3</span> Knit the Rmd</a></li>
</ul></li>
</ul></li>
<li><a href="part-ii-r-fundamentals.html#part-ii-r-fundamentals" id="toc-part-ii-r-fundamentals">Part II: R fundamentals</a></li>
<li><a href="data.html#data" id="toc-data"><span class="toc-section-number">3</span> Data – Reading, Wrangling, and Writing</a>
<ul>
<li><a href="data.html#data-long" id="toc-data-long"><span class="toc-section-number">3.1</span> Long data format – the way data should be</a></li>
<li><a href="data.html#data-here" id="toc-data-here"><span class="toc-section-number">3.2</span> Use the here function to construct the file path</a></li>
<li><a href="data.html#learning-from-this-chapter" id="toc-learning-from-this-chapter"><span class="toc-section-number">3.3</span> Learning from this chapter</a></li>
<li><a href="data.html#data-working-in-r" id="toc-data-working-in-r"><span class="toc-section-number">3.4</span> Working in R</a>
<ul>
<li><a href="data.html#importing-data" id="toc-importing-data"><span class="toc-section-number">3.4.1</span> Importing data</a></li>
</ul></li>
<li><a href="data.html#data-wrangling" id="toc-data-wrangling"><span class="toc-section-number">3.5</span> Data wrangling</a>
<ul>
<li><a href="data.html#reshaping-data-wide-to-long" id="toc-reshaping-data-wide-to-long"><span class="toc-section-number">3.5.1</span> Reshaping data – Wide to long</a></li>
<li><a href="data.html#reshaping-data-transpose-turning-the-columns-into-rows" id="toc-reshaping-data-transpose-turning-the-columns-into-rows"><span class="toc-section-number">3.5.2</span> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li><a href="data.html#combining-data" id="toc-combining-data"><span class="toc-section-number">3.5.3</span> Combining data</a></li>
<li><a href="data.html#data-subset" id="toc-data-subset"><span class="toc-section-number">3.5.4</span> Subsetting data</a></li>
<li><a href="data.html#wrangling-columns" id="toc-wrangling-columns"><span class="toc-section-number">3.5.5</span> Wrangling columns</a></li>
<li><a href="data.html#missing-data" id="toc-missing-data"><span class="toc-section-number">3.5.6</span> Missing data</a></li>
</ul></li>
<li><a href="data.html#saving-data" id="toc-saving-data"><span class="toc-section-number">3.6</span> Saving data</a></li>
<li><a href="data.html#exercises" id="toc-exercises"><span class="toc-section-number">3.7</span> Exercises</a></li>
</ul></li>
<li><a href="plotting-models.html#plotting-models" id="toc-plotting-models"><span class="toc-section-number">4</span> Plotting Models</a>
<ul>
<li><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data" id="toc-pretty-good-plots-show-the-model-and-the-data"><span class="toc-section-number">4.1</span> Pretty good plots show the model and the data</a>
<ul>
<li><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot" id="toc-pretty-good-plot-component-1-modeled-effects-plot"><span class="toc-section-number">4.1.1</span> Pretty good plot component 1: Modeled effects plot</a></li>
<li><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot" id="toc-pretty-good-plot-component-2-modeled-mean-and-ci-plot"><span class="toc-section-number">4.1.2</span> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot." id="toc-combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><span class="toc-section-number">4.1.3</span> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
<li><a href="plotting-models.html#some-comments-on-plot-components" id="toc-some-comments-on-plot-components"><span class="toc-section-number">4.1.4</span> Some comments on plot components</a></li>
</ul></li>
<li><a href="plotting-models.html#working-in-r" id="toc-working-in-r"><span class="toc-section-number">4.2</span> Working in R</a>
<ul>
<li><a href="plotting-models.html#source-data" id="toc-source-data"><span class="toc-section-number">4.2.1</span> Source data</a></li>
<li><a href="plotting-models.html#how-to-plot-the-model" id="toc-how-to-plot-the-model"><span class="toc-section-number">4.2.2</span> How to plot the model</a></li>
<li><a href="plotting-models.html#be-sure-ggplot_the_model-is-in-your-r-folder" id="toc-be-sure-ggplot_the_model-is-in-your-r-folder"><span class="toc-section-number">4.2.3</span> Be sure ggplot_the_model is in your R folder</a></li>
<li><a href="plotting-models.html#how-to-use-the-plot-the-model-functions" id="toc-how-to-use-the-plot-the-model-functions"><span class="toc-section-number">4.2.4</span> How to use the Plot the Model functions</a></li>
<li><a href="plotting-models.html#how-to-generate-a-response-plot-using-ggpubr" id="toc-how-to-generate-a-response-plot-using-ggpubr"><span class="toc-section-number">4.2.5</span> How to generate a Response Plot using ggpubr</a></li>
<li><a href="plotting-models.html#how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2" id="toc-how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2"><span class="toc-section-number">4.2.6</span> How to generate a Response Plot with a grid of treatments using ggplot2</a></li>
<li><a href="plotting-models.html#how-to-generate-an-effects-plot" id="toc-how-to-generate-an-effects-plot"><span class="toc-section-number">4.2.7</span> How to generate an Effects Plot</a></li>
<li><a href="plotting-models.html#how-to-combine-the-response-and-effects-plots" id="toc-how-to-combine-the-response-and-effects-plots"><span class="toc-section-number">4.2.8</span> How to combine the response and effects plots</a></li>
<li><a href="plotting-models.html#how-to-add-the-interaction-effect-to-response-and-effects-plots" id="toc-how-to-add-the-interaction-effect-to-response-and-effects-plots"><span class="toc-section-number">4.2.9</span> How to add the interaction effect to response and effects plots</a></li>
</ul></li>
</ul></li>
<li><a href="part-iii-some-fundamentals-of-statistical-modeling.html#part-iii-some-fundamentals-of-statistical-modeling" id="toc-part-iii-some-fundamentals-of-statistical-modeling">Part III: Some Fundamentals of Statistical Modeling</a></li>
<li><a href="uncertainty.html#uncertainty" id="toc-uncertainty"><span class="toc-section-number">5</span> Variability and Uncertainty (Standard Deviations, Standard Errors, and Confidence Intervals)</a>
<ul>
<li><a href="uncertainty.html#standard-errors-are-used-to-compute-p-values-and-confidence-intervals" id="toc-standard-errors-are-used-to-compute-p-values-and-confidence-intervals"><span class="toc-section-number">5.1</span> Standard errors are used to compute <em>p</em>-values and confidence intervals</a></li>
<li><a href="uncertainty.html#background" id="toc-background"><span class="toc-section-number">5.2</span> Background</a>
<ul>
<li><a href="uncertainty.html#sample-standard-deviation" id="toc-sample-standard-deviation"><span class="toc-section-number">5.2.1</span> Sample standard deviation</a></li>
<li><a href="uncertainty.html#standard-error-of-the-mean" id="toc-standard-error-of-the-mean"><span class="toc-section-number">5.2.2</span> Standard error of the mean</a></li>
</ul></li>
<li><a href="uncertainty.html#simulations-using-fake-data-as-an-intuition-pump" id="toc-simulations-using-fake-data-as-an-intuition-pump"><span class="toc-section-number">5.3</span> Simulations – using fake data as an intuition pump</a>
<ul>
<li><a href="uncertainty.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error" id="toc-using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><span class="toc-section-number">5.3.1</span> Using Google Sheets to generate fake data to explore the standard error</a></li>
<li><a href="uncertainty.html#using-r-to-generate-fake-data-to-explore-the-standard-error" id="toc-using-r-to-generate-fake-data-to-explore-the-standard-error"><span class="toc-section-number">5.3.2</span> Using R to generate fake data to explore the standard error</a></li>
</ul></li>
<li><a href="uncertainty.html#bootstrap" id="toc-bootstrap"><span class="toc-section-number">5.4</span> Bootstrapped standard errors</a>
<ul>
<li><a href="uncertainty.html#an-example-of-bootstrapped-standard-errors" id="toc-an-example-of-bootstrapped-standard-errors"><span class="toc-section-number">5.4.1</span> An example of bootstrapped standard errors</a></li>
</ul></li>
<li><a href="uncertainty.html#confidence-intervals" id="toc-confidence-intervals"><span class="toc-section-number">5.5</span> Confidence Intervals</a>
<ul>
<li><a href="uncertainty.html#just-the-math" id="toc-just-the-math"><span class="toc-section-number">5.5.1</span> Just the math</a></li>
<li><a href="uncertainty.html#interpretation-of-a-confidence-interval" id="toc-interpretation-of-a-confidence-interval"><span class="toc-section-number">5.5.2</span> Interpretation of a confidence interval</a></li>
<li><a href="uncertainty.html#bootstrap-confidence-interval" id="toc-bootstrap-confidence-interval"><span class="toc-section-number">5.5.3</span> Bootstrap confidence interval</a></li>
<li><a href="uncertainty.html#a-plot-of-a-parametric-ci-vs.-bootstrap-ci-of-the-means" id="toc-a-plot-of-a-parametric-ci-vs.-bootstrap-ci-of-the-means"><span class="toc-section-number">5.5.4</span> A plot of a “parametric” CI vs. bootstrap CI of the means</a></li>
</ul></li>
<li><a href="uncertainty.html#standard-error-of-a-difference-between-means" id="toc-standard-error-of-a-difference-between-means"><span class="toc-section-number">5.6</span> Standard error of a difference between means</a>
<ul>
<li><a href="uncertainty.html#the-standard-error-of-a-difference-between-means-is-the-standard-deviation-of-the-sampling-distribution-of-the-difference" id="toc-the-standard-error-of-a-difference-between-means-is-the-standard-deviation-of-the-sampling-distribution-of-the-difference"><span class="toc-section-number">5.6.1</span> The standard error of a difference between means is the standard deviation of the sampling distribution of the difference</a></li>
</ul></li>
<li><a href="uncertainty.html#confidence-limits-of-a-difference-between-means" id="toc-confidence-limits-of-a-difference-between-means"><span class="toc-section-number">5.7</span> Confidence limits of a difference between means</a>
<ul>
<li><a href="uncertainty.html#of-95-cis-of-the-difference-include-the-true-difference" id="toc-of-95-cis-of-the-difference-include-the-true-difference"><span class="toc-section-number">5.7.1</span> 95% of 95% CIs of the difference include the true difference</a></li>
</ul></li>
<li><a href="uncertainty.html#hidden-code" id="toc-hidden-code"><span class="toc-section-number">5.8</span> Hidden code</a>
<ul>
<li><a href="uncertainty.html#import-exp3b" id="toc-import-exp3b"><span class="toc-section-number">5.8.1</span> Import exp3b</a></li>
</ul></li>
</ul></li>
<li><a href="p-values.html#p-values" id="toc-p-values"><span class="toc-section-number">6</span> P-values</a>
<ul>
<li><a href="p-values.html#a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution" id="toc-a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution"><span class="toc-section-number">6.1</span> A <em>p</em>-value is the probability of sampling a value as or more extreme than the test statistic if sampling from a null distribution</a></li>
<li><a href="p-values.html#pump-your-intuition-creating-a-null-distribution" id="toc-pump-your-intuition-creating-a-null-distribution"><span class="toc-section-number">6.2</span> Pump your intuition – Creating a null distribution</a></li>
<li><a href="p-values.html#a-null-distribution-of-t-values-the-t-distribution" id="toc-a-null-distribution-of-t-values-the-t-distribution"><span class="toc-section-number">6.3</span> A null distribution of <em>t</em>-values – the <em>t</em> distribution</a></li>
<li><a href="p-values.html#p-values-from-the-perspective-of-permutation" id="toc-p-values-from-the-perspective-of-permutation"><span class="toc-section-number">6.4</span> P-values from the perspective of permutation</a></li>
<li><a href="p-values.html#parametric-vs.-non-parametric-statistics" id="toc-parametric-vs.-non-parametric-statistics"><span class="toc-section-number">6.5</span> Parametric vs. non-parametric statistics</a></li>
<li><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values" id="toc-frequentist-probability-and-the-interpretation-of-p-values"><span class="toc-section-number">6.6</span> frequentist probability and the interpretation of p-values</a>
<ul>
<li><a href="p-values.html#background-1" id="toc-background-1"><span class="toc-section-number">6.6.1</span> Background</a></li>
<li><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability." id="toc-this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><span class="toc-section-number">6.6.2</span> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li><a href="p-values.html#two-interpretations-of-the-p-value" id="toc-two-interpretations-of-the-p-value"><span class="toc-section-number">6.6.3</span> Two interpretations of the <em>p</em>-value</a></li>
<li><a href="p-values.html#nhst" id="toc-nhst"><span class="toc-section-number">6.6.4</span> NHST</a></li>
</ul></li>
<li><a href="p-values.html#some-major-misconceptions-of-the-p-value" id="toc-some-major-misconceptions-of-the-p-value"><span class="toc-section-number">6.7</span> Some major misconceptions of the <em>p</em>-value</a>
<ul>
<li><a href="p-values.html#misconception-p-0.05-means-there-is-no-effect-of-treatment" id="toc-misconception-p-0.05-means-there-is-no-effect-of-treatment"><span class="toc-section-number">6.7.1</span> Misconception: <span class="math inline">\(p &gt; 0.05\)</span> means there is no effect of treatment</a></li>
<li><a href="p-values.html#misconception-a-p-value-is-repeatable" id="toc-misconception-a-p-value-is-repeatable"><span class="toc-section-number">6.7.2</span> Misconception: a <em>p</em>-value is repeatable</a></li>
<li><a href="p-values.html#misconception-0.05-is-the-lifetime-rate-of-false-discoveries" id="toc-misconception-0.05-is-the-lifetime-rate-of-false-discoveries"><span class="toc-section-number">6.7.3</span> Misconception: 0.05 is the lifetime rate of false discoveries</a></li>
<li><a href="p-values.html#misconception-a-low-p-value-indicates-an-important-effect" id="toc-misconception-a-low-p-value-indicates-an-important-effect"><span class="toc-section-number">6.7.4</span> Misconception: a low <em>p</em>-value indicates an important effect</a></li>
<li><a href="p-values.html#misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity" id="toc-misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity"><span class="toc-section-number">6.7.5</span> Misconception: a low <em>p</em>-value indicates high model fit or high predictive capacity</a></li>
</ul></li>
<li><a href="p-values.html#what-the-p-value-does-not-mean" id="toc-what-the-p-value-does-not-mean"><span class="toc-section-number">6.8</span> What the <em>p</em>-value does not mean</a></li>
<li><a href="p-values.html#on-using-p-values-in-experimental-biology" id="toc-on-using-p-values-in-experimental-biology"><span class="toc-section-number">6.9</span> On using <em>p</em>-values in experimental biology</a></li>
<li><a href="p-values.html#better-reproducibility" id="toc-better-reproducibility"><span class="toc-section-number">6.10</span> Better reproducibility</a></li>
<li><a href="p-values.html#multiple-testing-and-controlling-for-false-positives" id="toc-multiple-testing-and-controlling-for-false-positives"><span class="toc-section-number">6.11</span> Multiple testing and controlling for false positives</a>
<ul>
<li><a href="p-values.html#controlling-the-family-wise-error-rate-when-all-tests-are-testing-the-same-hypothesis" id="toc-controlling-the-family-wise-error-rate-when-all-tests-are-testing-the-same-hypothesis"><span class="toc-section-number">6.11.1</span> Controlling the family-wise error rate when all tests are testing the same hypothesis</a></li>
</ul></li>
<li><a href="p-values.html#recommendations" id="toc-recommendations"><span class="toc-section-number">6.12</span> Recommendations</a>
<ul>
<li><a href="p-values.html#primary-sources-for-recommendations" id="toc-primary-sources-for-recommendations"><span class="toc-section-number">6.12.1</span> Primary sources for recommendations</a></li>
</ul></li>
<li><a href="p-values.html#problems" id="toc-problems"><span class="toc-section-number">6.13</span> Problems</a></li>
</ul></li>
<li><a href="errors-in-inference.html#errors-in-inference" id="toc-errors-in-inference"><span class="toc-section-number">7</span> Errors in inference</a>
<ul>
<li><a href="errors-in-inference.html#classical-nhst-concepts-of-wrong" id="toc-classical-nhst-concepts-of-wrong"><span class="toc-section-number">7.1</span> Classical NHST concepts of wrong</a>
<ul>
<li><a href="errors-in-inference.html#type-i-error" id="toc-type-i-error"><span class="toc-section-number">7.1.1</span> Type I error</a></li>
<li><a href="errors-in-inference.html#power" id="toc-power"><span class="toc-section-number">7.1.2</span> Power</a></li>
</ul></li>
<li><a href="errors-in-inference.html#a-non-neyman-pearson-concept-of-power" id="toc-a-non-neyman-pearson-concept-of-power"><span class="toc-section-number">7.2</span> A non-Neyman-Pearson concept of power</a>
<ul>
<li><a href="errors-in-inference.html#estimation-error" id="toc-estimation-error"><span class="toc-section-number">7.2.1</span> Estimation error</a></li>
<li><a href="errors-in-inference.html#coverage" id="toc-coverage"><span class="toc-section-number">7.2.2</span> Coverage</a></li>
<li><a href="errors-in-inference.html#type-s-error" id="toc-type-s-error"><span class="toc-section-number">7.2.3</span> Type S error</a></li>
<li><a href="errors-in-inference.html#type-m-error" id="toc-type-m-error"><span class="toc-section-number">7.2.4</span> Type M error</a></li>
</ul></li>
</ul></li>
<li><a href="part-iv-introduction-to-linear-models.html#part-iv-introduction-to-linear-models" id="toc-part-iv-introduction-to-linear-models">Part IV: Introduction to Linear Models</a></li>
<li><a href="intro-linear-models.html#intro-linear-models" id="toc-intro-linear-models"><span class="toc-section-number">8</span> An introduction to linear models</a>
<ul>
<li><a href="intro-linear-models.html#lm-specifications" id="toc-lm-specifications"><span class="toc-section-number">8.1</span> Two specifications of a linear model</a>
<ul>
<li><a href="intro-linear-models.html#the-error-draw-specification" id="toc-the-error-draw-specification"><span class="toc-section-number">8.1.1</span> The “error draw” specification</a></li>
<li><a href="intro-linear-models.html#the-conditional-draw-specification" id="toc-the-conditional-draw-specification"><span class="toc-section-number">8.1.2</span> The “conditional draw” specification</a></li>
<li><a href="intro-linear-models.html#comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model" id="toc-comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model"><span class="toc-section-number">8.1.3</span> Comparing the error-draw and conditional-draw ways of specifying the linear model</a></li>
<li><a href="intro-linear-models.html#anova-notation-of-a-linear-model" id="toc-anova-notation-of-a-linear-model"><span class="toc-section-number">8.1.4</span> ANOVA notation of a linear model</a></li>
</ul></li>
<li><a href="intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables" id="toc-a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"><span class="toc-section-number">8.2</span> A linear model can be fit to data with continuous, discrete, or categorical <span class="math inline">\(X\)</span> variables</a>
<ul>
<li><a href="intro-linear-models.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete" id="toc-fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete"><span class="toc-section-number">8.2.1</span> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is continuous or discrete</a></li>
<li><a href="intro-linear-models.html#slope" id="toc-slope"><span class="toc-section-number">8.2.2</span> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is categorical</a></li>
</ul></li>
<li><a href="intro-linear-models.html#statistical-models-are-used-for-prediction-explanation-and-description" id="toc-statistical-models-are-used-for-prediction-explanation-and-description"><span class="toc-section-number">8.3</span> Statistical models are used for prediction, explanation, and description</a></li>
<li><a href="intro-linear-models.html#what-is-the-interpretation-of-a-regression-coefficient" id="toc-what-is-the-interpretation-of-a-regression-coefficient"><span class="toc-section-number">8.4</span> What is the interpretation of a regression coefficient?</a></li>
<li><a href="intro-linear-models.html#what-do-we-call-the-x-and-y-variables" id="toc-what-do-we-call-the-x-and-y-variables"><span class="toc-section-number">8.5</span> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li><a href="intro-linear-models.html#modeling-strategy" id="toc-modeling-strategy"><span class="toc-section-number">8.6</span> Modeling strategy</a></li>
<li><a href="intro-linear-models.html#predictions-from-the-model" id="toc-predictions-from-the-model"><span class="toc-section-number">8.7</span> Predictions from the model</a></li>
<li><a href="intro-linear-models.html#inference-from-the-model" id="toc-inference-from-the-model"><span class="toc-section-number">8.8</span> Inference from the model</a>
<ul>
<li><a href="intro-linear-models.html#assumptions-for-inference-with-a-statistical-model" id="toc-assumptions-for-inference-with-a-statistical-model"><span class="toc-section-number">8.8.1</span> Assumptions for inference with a statistical model</a></li>
<li><a href="intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model" id="toc-specific-assumptions-for-inference-with-a-linear-model"><span class="toc-section-number">8.8.2</span> Specific assumptions for inference with a linear model</a></li>
</ul></li>
<li><a href="intro-linear-models.html#linear-modelregression-model-or-statistical-model" id="toc-linear-modelregression-model-or-statistical-model"><span class="toc-section-number">8.9</span> “linear model,”regression model”, or “statistical model”?</a></li>
</ul></li>
<li><a href="regression.html#regression" id="toc-regression"><span class="toc-section-number">9</span> Linear models with a single, continuous <em>X</em> (“regression”)</a>
<ul>
<li><a href="regression.html#a-linear-model-with-a-single-continuous-x-is-classical-regression" id="toc-a-linear-model-with-a-single-continuous-x-is-classical-regression"><span class="toc-section-number">9.1</span> A linear model with a single, continuous <em>X</em> is classical “regression”</a>
<ul>
<li><a href="regression.html#analysis-of-green-down-data" id="toc-analysis-of-green-down-data"><span class="toc-section-number">9.1.1</span> Analysis of “green-down” data</a></li>
<li><a href="regression.html#learning-from-the-green-down-example" id="toc-learning-from-the-green-down-example"><span class="toc-section-number">9.1.2</span> Learning from the green-down example</a></li>
<li><a href="regression.html#using-a-regression-model-for-explanation-causal-models" id="toc-using-a-regression-model-for-explanation-causal-models"><span class="toc-section-number">9.1.3</span> Using a regression model for “explanation” – causal models</a></li>
<li><a href="regression.html#using-a-regression-model-for-prediction-prediction-models" id="toc-using-a-regression-model-for-prediction-prediction-models"><span class="toc-section-number">9.1.4</span> Using a regression model for prediction – prediction models</a></li>
<li><a href="regression.html#using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data" id="toc-using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data"><span class="toc-section-number">9.1.5</span> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</a></li>
<li><a href="regression.html#using-a-regression-model-for-for-calibration" id="toc-using-a-regression-model-for-for-calibration"><span class="toc-section-number">9.1.6</span> Using a regression model for for calibration</a></li>
</ul></li>
<li><a href="regression.html#working-in-r-1" id="toc-working-in-r-1"><span class="toc-section-number">9.2</span> Working in R</a>
<ul>
<li><a href="plotting-models.html#fit-the-model" id="toc-fit-the-model"><span class="toc-section-number">9.2.1</span> Fitting the linear model</a></li>
<li><a href="regression.html#getting-to-know-the-linear-model-the-summary-function" id="toc-getting-to-know-the-linear-model-the-summary-function"><span class="toc-section-number">9.2.2</span> Getting to know the linear model: the <code>summary</code> function</a></li>
<li><a href="regression.html#inference-the-coefficient-table" id="toc-inference-the-coefficient-table"><span class="toc-section-number">9.2.3</span> Inference – the coefficient table</a></li>
<li><a href="regression.html#how-good-is-our-model-model-checking" id="toc-how-good-is-our-model-model-checking"><span class="toc-section-number">9.2.4</span> How good is our model? – Model checking</a></li>
<li><a href="regression.html#plotting-models-with-continuous-x" id="toc-plotting-models-with-continuous-x"><span class="toc-section-number">9.2.5</span> Plotting models with continuous <em>X</em></a></li>
<li><a href="regression.html#creating-a-table-of-predicted-values-and-95-prediction-intervals" id="toc-creating-a-table-of-predicted-values-and-95-prediction-intervals"><span class="toc-section-number">9.2.6</span> Creating a table of predicted values and 95% prediction intervals</a></li>
</ul></li>
<li><a href="regression.html#hidden-code-1" id="toc-hidden-code-1"><span class="toc-section-number">9.3</span> Hidden code</a>
<ul>
<li><a href="regression.html#import-and-plot-of-fig2c-ecosystem-warming-experimental-data" id="toc-import-and-plot-of-fig2c-ecosystem-warming-experimental-data"><span class="toc-section-number">9.3.1</span> Import and plot of fig2c (ecosystem warming experimental) data</a></li>
<li><a href="regression.html#import-and-plot-efig_3d-ecosysem-warming-observational-data" id="toc-import-and-plot-efig_3d-ecosysem-warming-observational-data"><span class="toc-section-number">9.3.2</span> Import and plot efig_3d (Ecosysem warming observational) data</a></li>
<li><a href="regression.html#import-and-plot-of-fig1f-methionine-restriction-data" id="toc-import-and-plot-of-fig1f-methionine-restriction-data"><span class="toc-section-number">9.3.3</span> Import and plot of fig1f (methionine restriction) data</a></li>
</ul></li>
<li><a href="regression.html#try-it" id="toc-try-it"><span class="toc-section-number">9.4</span> Try it</a>
<ul>
<li><a href="regression.html#a-prediction-model-from-the-literature" id="toc-a-prediction-model-from-the-literature"><span class="toc-section-number">9.4.1</span> A prediction model from the literature</a></li>
</ul></li>
<li><a href="regression.html#intuition-pumps" id="toc-intuition-pumps"><span class="toc-section-number">9.5</span> Intuition pumps</a>
<ul>
<li><a href="regression.html#correlation-and-r2" id="toc-correlation-and-r2"><span class="toc-section-number">9.5.1</span> Correlation and $R^2</a></li>
</ul></li>
</ul></li>
<li><a href="oneway.html#oneway" id="toc-oneway"><span class="toc-section-number">10</span> Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</a>
<ul>
<li><a href="oneway.html#oneway-data" id="toc-oneway-data"><span class="toc-section-number">10.1</span> A linear model with a single, categorical <em>X</em> variable estimates the effects of the levels of <em>X</em> on the response</a>
<ul>
<li><a href="oneway.html#oneway-example1" id="toc-oneway-example1"><span class="toc-section-number">10.1.1</span> Example 1 (fig3d) – two treatment levels (“groups”)</a></li>
<li><a href="oneway.html#understanding-the-analysis-with-two-treatment-levels" id="toc-understanding-the-analysis-with-two-treatment-levels"><span class="toc-section-number">10.1.2</span> Understanding the analysis with two treatment levels</a></li>
<li><a href="oneway.html#oneway-example2" id="toc-oneway-example2"><span class="toc-section-number">10.1.3</span> Example 2 – three treatment levels (“groups”)</a></li>
<li><a href="oneway.html#understanding-the-analysis-with-three-or-more-treatment-levels" id="toc-understanding-the-analysis-with-three-or-more-treatment-levels"><span class="toc-section-number">10.1.4</span> Understanding the analysis with three (or more) treatment levels</a></li>
</ul></li>
<li><a href="oneway.html#working-in-r-2" id="toc-working-in-r-2"><span class="toc-section-number">10.2</span> Working in R</a>
<ul>
<li><a href="oneway.html#fit-the-model-1" id="toc-fit-the-model-1"><span class="toc-section-number">10.2.1</span> Fit the model</a></li>
<li><a href="oneway.html#controlling-the-output-in-tables-using-the-coefficient-table-as-an-example" id="toc-controlling-the-output-in-tables-using-the-coefficient-table-as-an-example"><span class="toc-section-number">10.2.2</span> Controlling the output in tables using the coefficient table as an example</a></li>
<li><a href="oneway.html#using-the-emmeans-function" id="toc-using-the-emmeans-function"><span class="toc-section-number">10.2.3</span> Using the emmeans function</a></li>
<li><a href="oneway.html#using-the-contrast-function" id="toc-using-the-contrast-function"><span class="toc-section-number">10.2.4</span> Using the contrast function</a></li>
<li><a href="oneway.html#how-to-generate-anova-tables" id="toc-how-to-generate-anova-tables"><span class="toc-section-number">10.2.5</span> How to generate ANOVA tables</a></li>
</ul></li>
<li><a href="oneway.html#hidden-code-2" id="toc-hidden-code-2"><span class="toc-section-number">10.3</span> Hidden Code</a>
<ul>
<li><a href="oneway.html#importing-and-wrangling-the-fig_3d-data-for-example-1" id="toc-importing-and-wrangling-the-fig_3d-data-for-example-1"><span class="toc-section-number">10.3.1</span> Importing and wrangling the fig_3d data for example 1</a></li>
<li><a href="oneway.html#importing-and-wrangling-the-fig2a-data-for-example-2" id="toc-importing-and-wrangling-the-fig2a-data-for-example-2"><span class="toc-section-number">10.3.2</span> Importing and wrangling the fig2a data for example 2</a></li>
</ul></li>
</ul></li>
<li><a href="model-checking.html#model-checking" id="toc-model-checking"><span class="toc-section-number">11</span> Model Checking</a>
<ul>
<li><a href="model-checking.html#check-check" id="toc-check-check"><span class="toc-section-number">11.1</span> All statistical analyses should be followed by model checking</a></li>
<li><a href="model-checking.html#linear-model-assumptions" id="toc-linear-model-assumptions"><span class="toc-section-number">11.2</span> Linear model assumptions</a>
<ul>
<li><a href="model-checking.html#a-bit-about-iid" id="toc-a-bit-about-iid"><span class="toc-section-number">11.2.1</span> A bit about IID</a></li>
</ul></li>
<li><a href="model-checking.html#diagnostic-plots-use-the-residuals-from-the-model-fit" id="toc-diagnostic-plots-use-the-residuals-from-the-model-fit"><span class="toc-section-number">11.3</span> Diagnostic plots use the residuals from the model fit</a>
<ul>
<li><a href="model-checking.html#residuals" id="toc-residuals"><span class="toc-section-number">11.3.1</span> Residuals</a></li>
<li><a href="model-checking.html#normal-qq" id="toc-normal-qq"><span class="toc-section-number">11.3.2</span> A Normal Q-Q plot is used to check for characteristic departures from Normality</a></li>
<li><a href="model-checking.html#mapping-qq-plot-departures-from-normality" id="toc-mapping-qq-plot-departures-from-normality"><span class="toc-section-number">11.3.3</span> Mapping QQ-plot departures from Normality</a></li>
<li><a href="model-checking.html#model-checking-spread-level" id="toc-model-checking-spread-level"><span class="toc-section-number">11.3.4</span> Model checking homoskedasticity</a></li>
</ul></li>
<li><a href="model-checking.html#using-r" id="toc-using-r"><span class="toc-section-number">11.4</span> Using R</a></li>
<li><a href="model-checking.html#hidden-code-3" id="toc-hidden-code-3"><span class="toc-section-number">11.5</span> Hidden Code</a>
<ul>
<li><a href="model-checking.html#normal-q-q-plots" id="toc-normal-q-q-plots"><span class="toc-section-number">11.5.1</span> Normal Q-Q plots</a></li>
</ul></li>
</ul></li>
<li><a href="violations.html#violations" id="toc-violations"><span class="toc-section-number">12</span> Violations of independence, homogeneity, or Normality</a>
<ul>
<li><a href="violations.html#oneway-paired-t" id="toc-oneway-paired-t"><span class="toc-section-number">12.1</span> Lack of independence</a>
<ul>
<li><a href="violations.html#violations-paired-t" id="toc-violations-paired-t"><span class="toc-section-number">12.1.1</span> Example 1 (exp1b) – a paired t-test is a special case of a linear mixed model</a></li>
<li><a href="violations.html#violations-rmanova" id="toc-violations-rmanova"><span class="toc-section-number">12.1.2</span> Example 2 (diHOME exp2a) – A repeated measures ANOVA is a special case of a linear mixed model</a></li>
</ul></li>
<li><a href="violations.html#oneway-welch" id="toc-oneway-welch"><span class="toc-section-number">12.2</span> Heterogeneity of variances</a>
<ul>
<li><a href="violations.html#when-groups-of-the-focal-test-have-variance" id="toc-when-groups-of-the-focal-test-have-variance"><span class="toc-section-number">12.2.1</span> When groups of the focal test have &gt;&gt; variance</a></li>
</ul></li>
<li><a href="violations.html#the-conditional-response-isnt-normal" id="toc-the-conditional-response-isnt-normal"><span class="toc-section-number">12.3</span> The conditional response isn’t Normal</a>
<ul>
<li><a href="violations.html#violations-6f" id="toc-violations-6f"><span class="toc-section-number">12.3.1</span> Example 1 (fig6f) – Linear models for non-normal count data</a></li>
<li><a href="violations.html#my-data-arent-normal-what-is-the-best-practice" id="toc-my-data-arent-normal-what-is-the-best-practice"><span class="toc-section-number">12.3.2</span> My data aren’t normal, what is the best practice?</a></li>
</ul></li>
<li><a href="violations.html#hidden-code-4" id="toc-hidden-code-4"><span class="toc-section-number">12.4</span> Hidden Code</a>
<ul>
<li><a href="violations.html#importing-and-wrangling-the-exp1b-data" id="toc-importing-and-wrangling-the-exp1b-data"><span class="toc-section-number">12.4.1</span> Importing and wrangling the exp1b data</a></li>
<li><a href="violations.html#importing-and-wrangling-the-exp2a-data" id="toc-importing-and-wrangling-the-exp2a-data"><span class="toc-section-number">12.4.2</span> Importing and wrangling the exp2a data</a></li>
<li><a href="violations.html#importing-and-wrangling-the-fig6f-data" id="toc-importing-and-wrangling-the-fig6f-data"><span class="toc-section-number">12.4.3</span> Importing and wrangling the fig6f data</a></li>
</ul></li>
</ul></li>
<li><a href="issues.html#issues" id="toc-issues"><span class="toc-section-number">13</span> Issues in inference</a>
<ul>
<li><a href="issues.html#replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means" id="toc-replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means"><span class="toc-section-number">13.1</span> Replicated experiments – include <span class="math inline">\(\texttt{Experiment}\)</span> as a random factor (better than one-way ANOVA of means)</a>
<ul>
<li><a href="issues.html#issues-exp4d" id="toc-issues-exp4d"><span class="toc-section-number">13.1.1</span> Multiple experiments Example 1 (wound healing Exp4d)</a></li>
<li><a href="issues.html#issues-combined-experiments" id="toc-issues-combined-experiments"><span class="toc-section-number">13.1.2</span> Models for combining replicated experiments</a></li>
<li><a href="issues.html#understanding-model-exp4d_m1" id="toc-understanding-model-exp4d_m1"><span class="toc-section-number">13.1.3</span> Understanding Model <code>exp4d_m1</code></a></li>
<li><a href="issues.html#the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2" id="toc-the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2"><span class="toc-section-number">13.1.4</span> The univariate model is equivalent to a linear mixed model of the aggregated data (Model exp4d_m2)</a></li>
<li><a href="issues.html#a-linear-mixed-model-of-the-full-data" id="toc-a-linear-mixed-model-of-the-full-data"><span class="toc-section-number">13.1.5</span> A linear mixed model of the full data</a></li>
<li><a href="issues.html#analysis-of-the-experiment-means-has-less-precision-and-power" id="toc-analysis-of-the-experiment-means-has-less-precision-and-power"><span class="toc-section-number">13.1.6</span> Analysis of the experiment means has less precision and power</a></li>
<li><a href="issues.html#dont-do-this-a-t-testfixed-effect-anova-of-the-full-data" id="toc-dont-do-this-a-t-testfixed-effect-anova-of-the-full-data"><span class="toc-section-number">13.1.7</span> Don’t do this – a t-test/fixed-effect ANOVA of the full data</a></li>
</ul></li>
<li><a href="issues.html#issues-pre-post" id="toc-issues-pre-post"><span class="toc-section-number">13.2</span> Comparing change from baseline (pre-post)</a>
<ul>
<li><a href="issues.html#pre-post-example-1-dpp4-fig4c" id="toc-pre-post-example-1-dpp4-fig4c"><span class="toc-section-number">13.2.1</span> Pre-post example 1 (DPP4 fig4c)</a></li>
<li><a href="issues.html#what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure" id="toc-what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure"><span class="toc-section-number">13.2.2</span> What if the data in example 1 were from from an experiment where the treatment was applied prior to the baseline measure?</a></li>
<li><a href="issues.html#pre-post-example-2-xx-males-fig1c" id="toc-pre-post-example-2-xx-males-fig1c"><span class="toc-section-number">13.2.3</span> Pre-post example 2 (XX males fig1c)</a></li>
<li><a href="issues.html#issues-regression-to-mean" id="toc-issues-regression-to-mean"><span class="toc-section-number">13.2.4</span> Regression to the mean</a></li>
</ul></li>
<li><a href="issues.html#longitudinal-designs-with-more-than-one-post-baseline-measure" id="toc-longitudinal-designs-with-more-than-one-post-baseline-measure"><span class="toc-section-number">13.3</span> Longitudinal designs with more than one-post baseline measure</a>
<ul>
<li><a href="issues.html#issues-auc" id="toc-issues-auc"><span class="toc-section-number">13.3.1</span> Area under the curve (AUC)</a></li>
</ul></li>
<li><a href="issues.html#normalization-the-analysis-of-ratios" id="toc-normalization-the-analysis-of-ratios"><span class="toc-section-number">13.4</span> Normalization – the analysis of ratios</a>
<ul>
<li><a href="issues.html#kinds-of-ratios-in-experimental-biology" id="toc-kinds-of-ratios-in-experimental-biology"><span class="toc-section-number">13.4.1</span> Kinds of ratios in experimental biology</a></li>
<li><a href="issues.html#issues-offset" id="toc-issues-offset"><span class="toc-section-number">13.4.2</span> Example 1 – The ratio is a density (number of something per area)</a></li>
<li><a href="issues.html#issues-size" id="toc-issues-size"><span class="toc-section-number">13.4.3</span> Example 2 – The ratio is normalizing for size differences</a></li>
</ul></li>
<li><a href="issues.html#dont-do-this-stuff" id="toc-dont-do-this-stuff"><span class="toc-section-number">13.5</span> Don’t do this stuff</a>
<ul>
<li><a href="issues.html#normalize-the-response-so-that-all-control-values-are-equal-to-1." id="toc-normalize-the-response-so-that-all-control-values-are-equal-to-1."><span class="toc-section-number">13.5.1</span> Normalize the response so that all control values are equal to 1.</a></li>
</ul></li>
<li><a href="issues.html#a-difference-in-significance-is-not-necessarily-significant" id="toc-a-difference-in-significance-is-not-necessarily-significant"><span class="toc-section-number">13.6</span> A difference in significance is not necessarily significant</a></li>
<li><a href="issues.html#researcher-degrees-of-freedom" id="toc-researcher-degrees-of-freedom"><span class="toc-section-number">13.7</span> Researcher degrees of freedom</a></li>
<li><a href="issues.html#hidden-code-5" id="toc-hidden-code-5"><span class="toc-section-number">13.8</span> Hidden code</a>
<ul>
<li><a href="issues.html#import-exp4d-vimentin-cell-count-data-replicate-experiments-example" id="toc-import-exp4d-vimentin-cell-count-data-replicate-experiments-example"><span class="toc-section-number">13.8.1</span> Import exp4d vimentin cell count data (replicate experiments example)</a></li>
<li><a href="issues.html#import-fig4c-data" id="toc-import-fig4c-data"><span class="toc-section-number">13.8.2</span> Import Fig4c data</a></li>
<li><a href="issues.html#xx-males-fig1c" id="toc-xx-males-fig1c"><span class="toc-section-number">13.8.3</span> XX males fig1c</a></li>
<li><a href="issues.html#generation-of-fake-data-to-illustrate-regression-to-the-mean" id="toc-generation-of-fake-data-to-illustrate-regression-to-the-mean"><span class="toc-section-number">13.8.4</span> Generation of fake data to illustrate regression to the mean</a></li>
<li><a href="issues.html#import-fig3f" id="toc-import-fig3f"><span class="toc-section-number">13.8.5</span> Import fig3f</a></li>
<li><a href="issues.html#issues-import-exp3b" id="toc-issues-import-exp3b"><span class="toc-section-number">13.8.6</span> Import exp3b</a></li>
<li><a href="issues.html#issues-exp3b-plot" id="toc-issues-exp3b-plot"><span class="toc-section-number">13.8.7</span> Plot the model of exp3b (glm offset data)</a></li>
</ul></li>
</ul></li>
<li><a href="part-v-more-than-one-x-multivariable-models.html#part-v-more-than-one-x-multivariable-models" id="toc-part-v-more-than-one-x-multivariable-models">Part V: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li><a href="covariates.html#covariates" id="toc-covariates"><span class="toc-section-number">14</span> Linear models with added covariates (“ANCOVA”)</a>
<ul>
<li><a href="covariates.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest" id="toc-adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><span class="toc-section-number">14.1</span> Adding covariates can increases the precision of the effect of interest</a></li>
<li><a href="covariates.html#understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data" id="toc-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data"><span class="toc-section-number">14.2</span> Understanding a linear model with an added covariate – heart necrosis data</a>
<ul>
<li><a href="covariates.html#fit-the-model-5" id="toc-fit-the-model-5"><span class="toc-section-number">14.2.1</span> Fit the model</a></li>
<li><a href="covariates.html#plot-the-model-2" id="toc-plot-the-model-2"><span class="toc-section-number">14.2.2</span> Plot the model</a></li>
<li><a href="covariates.html#interpretation-of-the-model-coefficients" id="toc-interpretation-of-the-model-coefficients"><span class="toc-section-number">14.2.3</span> Interpretation of the model coefficients</a></li>
<li><a href="covariates.html#everything-adds-up" id="toc-everything-adds-up"><span class="toc-section-number">14.2.4</span> Everything adds up</a></li>
<li><a href="covariates.html#interpretation-of-the-estimated-marginal-means" id="toc-interpretation-of-the-estimated-marginal-means"><span class="toc-section-number">14.2.5</span> Interpretation of the estimated marginal means</a></li>
<li><a href="covariates.html#interpretation-of-the-contrasts" id="toc-interpretation-of-the-contrasts"><span class="toc-section-number">14.2.6</span> Interpretation of the contrasts</a></li>
<li><a href="covariates.html#adding-the-covariate-improves-inference" id="toc-adding-the-covariate-improves-inference"><span class="toc-section-number">14.2.7</span> Adding the covariate improves inference</a></li>
</ul></li>
<li><a href="covariates.html#understanding-interaction-effects-with-covariates" id="toc-understanding-interaction-effects-with-covariates"><span class="toc-section-number">14.3</span> Understanding interaction effects with covariates</a>
<ul>
<li><a href="covariates.html#fit-the-model-6" id="toc-fit-the-model-6"><span class="toc-section-number">14.3.1</span> Fit the model</a></li>
<li><a href="covariates.html#plot-the-model-with-interaction-effect" id="toc-plot-the-model-with-interaction-effect"><span class="toc-section-number">14.3.2</span> Plot the model with interaction effect</a></li>
<li><a href="covariates.html#interpretation-of-the-model-coefficients-1" id="toc-interpretation-of-the-model-coefficients-1"><span class="toc-section-number">14.3.3</span> Interpretation of the model coefficients</a></li>
<li><a href="covariates.html#what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends." id="toc-what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends."><span class="toc-section-number">14.3.4</span> What is the effect of a treatment, if interactions are modeled? – it depends.</a></li>
<li><a href="covariates.html#which-model-do-we-use-mathcalm_1-or-mathcalm_2" id="toc-which-model-do-we-use-mathcalm_1-or-mathcalm_2"><span class="toc-section-number">14.3.5</span> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</a></li>
</ul></li>
<li><a href="covariates.html#understanding-ancova-tables" id="toc-understanding-ancova-tables"><span class="toc-section-number">14.4</span> Understanding ANCOVA tables</a></li>
<li><a href="covariates.html#working-in-r-3" id="toc-working-in-r-3"><span class="toc-section-number">14.5</span> Working in R</a>
<ul>
<li><a href="covariates.html#importing-the-heart-necrosis-data" id="toc-importing-the-heart-necrosis-data"><span class="toc-section-number">14.5.1</span> Importing the heart necrosis data</a></li>
<li><a href="covariates.html#fitting-the-model" id="toc-fitting-the-model"><span class="toc-section-number">14.5.2</span> Fitting the model</a></li>
<li><a href="covariates.html#using-the-emmeans-function-1" id="toc-using-the-emmeans-function-1"><span class="toc-section-number">14.5.3</span> Using the emmeans function</a></li>
<li><a href="covariates.html#ancova-tables" id="toc-ancova-tables"><span class="toc-section-number">14.5.4</span> ANCOVA tables</a></li>
<li><a href="covariates.html#plotting-the-model" id="toc-plotting-the-model"><span class="toc-section-number">14.5.5</span> Plotting the model</a></li>
</ul></li>
<li><a href="covariates.html#best-practices" id="toc-best-practices"><span class="toc-section-number">14.6</span> Best practices</a>
<ul>
<li><a href="covariates.html#do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate" id="toc-do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate"><span class="toc-section-number">14.6.1</span> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</a></li>
<li><a href="covariates.html#do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate" id="toc-do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate"><span class="toc-section-number">14.6.2</span> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</a></li>
<li><a href="covariates.html#do-not-test-for-balance-of-baseline-measures" id="toc-do-not-test-for-balance-of-baseline-measures"><span class="toc-section-number">14.6.3</span> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li><a href="covariates.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response" id="toc-best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><span class="toc-section-number">14.7</span> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li><a href="factorial.html#factorial" id="toc-factorial"><span class="toc-section-number">15</span> Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</a>
<ul>
<li><a href="factorial.html#a-linear-model-with-crossed-factors-estimates-interaction-effects" id="toc-a-linear-model-with-crossed-factors-estimates-interaction-effects"><span class="toc-section-number">15.1</span> A linear model with crossed factors estimates interaction effects</a>
<ul>
<li><a href="factorial.html#an-interaction-is-a-difference-in-simple-effects" id="toc-an-interaction-is-a-difference-in-simple-effects"><span class="toc-section-number">15.1.1</span> An interaction is a difference in simple effects</a></li>
<li><a href="factorial.html#a-linear-model-with-crossed-factors-includes-interaction-effects" id="toc-a-linear-model-with-crossed-factors-includes-interaction-effects"><span class="toc-section-number">15.1.2</span> A linear model with crossed factors includes interaction effects</a></li>
<li><a href="factorial.html#factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature" id="toc-factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature"><span class="toc-section-number">15.1.3</span> factorial experiments are frequently analyzed as flattened linear models in the experimental biology literature</a></li>
</ul></li>
<li><a href="factorial.html#example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data" id="toc-example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data"><span class="toc-section-number">15.2</span> Example 1 – Estimation of a treatment effect relative to a control effect (“Something different”) (Experiment 2j glucose uptake data)</a>
<ul>
<li><a href="factorial.html#twoway-understand1" id="toc-twoway-understand1"><span class="toc-section-number">15.2.1</span> Understand the experimental design</a></li>
<li><a href="factorial.html#fit-the-linear-model" id="toc-fit-the-linear-model"><span class="toc-section-number">15.2.2</span> Fit the linear model</a></li>
<li><a href="factorial.html#twoway-exp2j-inf" id="toc-twoway-exp2j-inf"><span class="toc-section-number">15.2.3</span> Inference</a></li>
<li><a href="factorial.html#plot-the-model-3" id="toc-plot-the-model-3"><span class="toc-section-number">15.2.4</span> Plot the model</a></li>
</ul></li>
<li><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-1" id="toc-understanding-the-linear-model-with-crossed-factors-1"><span class="toc-section-number">15.3</span> Understanding the linear model with crossed factors 1</a>
<ul>
<li><a href="factorial.html#twoway-what-coefs-are" id="toc-twoway-what-coefs-are"><span class="toc-section-number">15.3.1</span> What the coefficients are</a></li>
<li><a href="factorial.html#the-interaction-effect-is-something-different" id="toc-the-interaction-effect-is-something-different"><span class="toc-section-number">15.3.2</span> The interaction effect is something different</a></li>
<li><a href="factorial.html#why-we-want-to-compare-the-treatment-effect-to-a-control-effect" id="toc-why-we-want-to-compare-the-treatment-effect-to-a-control-effect"><span class="toc-section-number">15.3.3</span> Why we want to compare the treatment effect to a control effect</a></li>
<li><a href="factorial.html#the-order-of-the-factors-in-the-model-tells-the-same-story-differently" id="toc-the-order-of-the-factors-in-the-model-tells-the-same-story-differently"><span class="toc-section-number">15.3.4</span> The order of the factors in the model tells the same story differently</a></li>
<li><a href="factorial.html#power-for-the-interaction-effect-is-less-than-that-for-simple-effects" id="toc-power-for-the-interaction-effect-is-less-than-that-for-simple-effects"><span class="toc-section-number">15.3.5</span> Power for the interaction effect is less than that for simple effects</a></li>
<li><a href="factorial.html#planned-comparisons-vs.-post-hoc-tests" id="toc-planned-comparisons-vs.-post-hoc-tests"><span class="toc-section-number">15.3.6</span> Planned comparisons vs. post-hoc tests</a></li>
</ul></li>
<li><a href="factorial.html#example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data" id="toc-example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data"><span class="toc-section-number">15.4</span> Example 2: Estimation of the effect of background condition on an effect (“it depends”) (Experiment 3e lesian area data)</a>
<ul>
<li><a href="factorial.html#understand-the-experimental-design" id="toc-understand-the-experimental-design"><span class="toc-section-number">15.4.1</span> Understand the experimental design</a></li>
<li><a href="factorial.html#fit-the-linear-model-1" id="toc-fit-the-linear-model-1"><span class="toc-section-number">15.4.2</span> Fit the linear model</a></li>
<li><a href="factorial.html#check-the-model-1" id="toc-check-the-model-1"><span class="toc-section-number">15.4.3</span> Check the model</a></li>
<li><a href="factorial.html#inference-from-the-model-2" id="toc-inference-from-the-model-2"><span class="toc-section-number">15.4.4</span> Inference from the model</a></li>
<li><a href="factorial.html#plot-the-model-4" id="toc-plot-the-model-4"><span class="toc-section-number">15.4.5</span> Plot the model</a></li>
</ul></li>
<li><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-2" id="toc-understanding-the-linear-model-with-crossed-factors-2"><span class="toc-section-number">15.5</span> Understanding the linear model with crossed factors 2</a>
<ul>
<li><a href="factorial.html#twoway-marginal-means" id="toc-twoway-marginal-means"><span class="toc-section-number">15.5.1</span> Conditional and marginal means</a></li>
<li><a href="factorial.html#simple-conditional-effects" id="toc-simple-conditional-effects"><span class="toc-section-number">15.5.2</span> Simple (conditional) effects</a></li>
<li><a href="factorial.html#twoway-marginal-effects" id="toc-twoway-marginal-effects"><span class="toc-section-number">15.5.3</span> Marginal effects</a></li>
<li><a href="factorial.html#the-additive-model" id="toc-the-additive-model"><span class="toc-section-number">15.5.4</span> The additive model</a></li>
<li><a href="factorial.html#twoway-reduce" id="toc-twoway-reduce"><span class="toc-section-number">15.5.5</span> Reduce models for the right reason</a></li>
<li><a href="factorial.html#the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird" id="toc-the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird"><span class="toc-section-number">15.5.6</span> The marginal means of an additive linear model with two factors can be weird</a></li>
</ul></li>
<li><a href="factorial.html#example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data" id="toc-example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data"><span class="toc-section-number">15.6</span> Example 3: Estimation of synergy (“More than the sum of the parts”) (Experiment 1c JA data)</a>
<ul>
<li><a href="factorial.html#examine-the-data" id="toc-examine-the-data"><span class="toc-section-number">15.6.1</span> Examine the data</a></li>
<li><a href="factorial.html#fit-the-model-7" id="toc-fit-the-model-7"><span class="toc-section-number">15.6.2</span> Fit the model</a></li>
<li><a href="factorial.html#model-check" id="toc-model-check"><span class="toc-section-number">15.6.3</span> Model check</a></li>
<li><a href="factorial.html#inference-from-the-model-3" id="toc-inference-from-the-model-3"><span class="toc-section-number">15.6.4</span> Inference from the model</a></li>
<li><a href="factorial.html#plot-the-model-5" id="toc-plot-the-model-5"><span class="toc-section-number">15.6.5</span> Plot the model</a></li>
<li><a href="factorial.html#alternative-plot" id="toc-alternative-plot"><span class="toc-section-number">15.6.6</span> Alternative plot</a></li>
</ul></li>
<li><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-3" id="toc-understanding-the-linear-model-with-crossed-factors-3"><span class="toc-section-number">15.7</span> Understanding the linear model with crossed factors 3</a>
<ul>
<li><a href="factorial.html#thinking-about-the-coefficients-of-the-linear-model" id="toc-thinking-about-the-coefficients-of-the-linear-model"><span class="toc-section-number">15.7.1</span> Thinking about the coefficients of the linear model</a></li>
</ul></li>
<li><a href="factorial.html#issues-in-inference" id="toc-issues-in-inference"><span class="toc-section-number">15.8</span> Issues in inference</a>
<ul>
<li><a href="factorial.html#for-pairwise-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model" id="toc-for-pairwise-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><span class="toc-section-number">15.8.1</span> For pairwise contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li><a href="factorial.html#for-interaction-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model" id="toc-for-interaction-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><span class="toc-section-number">15.8.2</span> For interaction contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li><a href="factorial.html#twoway-multiple-tests" id="toc-twoway-multiple-tests"><span class="toc-section-number">15.8.3</span> Adjusting <em>p</em>-values for multiple tests</a></li>
</ul></li>
<li><a href="factorial.html#two-way-anova" id="toc-two-way-anova"><span class="toc-section-number">15.9</span> Two-way ANOVA</a>
<ul>
<li><a href="factorial.html#how-to-read-a-two-way-anova-table" id="toc-how-to-read-a-two-way-anova-table"><span class="toc-section-number">15.9.1</span> How to read a two-way ANOVA table</a></li>
<li><a href="factorial.html#what-do-the-main-effects-in-an-anova-table-mean" id="toc-what-do-the-main-effects-in-an-anova-table-mean"><span class="toc-section-number">15.9.2</span> What do the main effects in an ANOVA table mean?</a></li>
</ul></li>
<li><a href="factorial.html#more-issues-in-inference" id="toc-more-issues-in-inference"><span class="toc-section-number">15.10</span> More issues in inference</a>
<ul>
<li><a href="factorial.html#longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova" id="toc-longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova"><span class="toc-section-number">15.10.1</span> Longitudinal experiments – include Time as a random factor (better than repeated measures ANOVA)</a></li>
</ul></li>
<li><a href="factorial.html#working-in-r-4" id="toc-working-in-r-4"><span class="toc-section-number">15.11</span> Working in R</a>
<ul>
<li><a href="factorial.html#model-formula" id="toc-model-formula"><span class="toc-section-number">15.11.1</span> Model formula</a></li>
<li><a href="factorial.html#using-the-emmeans-function-2" id="toc-using-the-emmeans-function-2"><span class="toc-section-number">15.11.2</span> Using the emmeans function</a></li>
<li><a href="factorial.html#contrasts" id="toc-contrasts"><span class="toc-section-number">15.11.3</span> Contrasts</a></li>
<li><a href="factorial.html#practice-safe-anova" id="toc-practice-safe-anova"><span class="toc-section-number">15.11.4</span> Practice safe ANOVA</a></li>
<li><a href="factorial.html#better-to-avoid-these" id="toc-better-to-avoid-these"><span class="toc-section-number">15.11.5</span> Better to avoid these</a></li>
</ul></li>
<li><a href="factorial.html#hidden-code-6" id="toc-hidden-code-6"><span class="toc-section-number">15.12</span> Hidden Code</a>
<ul>
<li><a href="factorial.html#import-exp2j-example-1" id="toc-import-exp2j-example-1"><span class="toc-section-number">15.12.1</span> Import exp2j (Example 1)</a></li>
<li><a href="factorial.html#import-exp3e-lesian-area-data-example-2" id="toc-import-exp3e-lesian-area-data-example-2"><span class="toc-section-number">15.12.2</span> Import exp3e lesian area data (Example 2)</a></li>
<li><a href="factorial.html#import-exp1c-ja-data-example-3" id="toc-import-exp1c-ja-data-example-3"><span class="toc-section-number">15.12.3</span> Import Exp1c JA data (Example 3)</a></li>
</ul></li>
</ul></li>
<li><a href="part-vi-expanding-the-linear-model.html#part-vi-expanding-the-linear-model" id="toc-part-vi-expanding-the-linear-model">Part VI – Expanding the Linear Model</a></li>
<li><a href="lmm.html#lmm" id="toc-lmm"><span class="toc-section-number">16</span> Models with random factors – linear mixed models</a>
<ul>
<li><a href="lmm.html#lmm-demo" id="toc-lmm-demo"><span class="toc-section-number">16.1</span> Example 1 – A random intercepts and slopes explainer (demo1)</a>
<ul>
<li><a href="lmm.html#batched-measurements-result-in-clustered-residuals" id="toc-batched-measurements-result-in-clustered-residuals"><span class="toc-section-number">16.1.1</span> Batched measurements result in clustered residuals</a></li>
<li><a href="lmm.html#lmm-corerr" id="toc-lmm-corerr"><span class="toc-section-number">16.1.2</span> Clustered residuals result in correlated error</a></li>
<li><a href="lmm.html#in-blocked-designs-clustered-residuals-adds-a-variance-component-that-masks-treatment-effects" id="toc-in-blocked-designs-clustered-residuals-adds-a-variance-component-that-masks-treatment-effects"><span class="toc-section-number">16.1.3</span> In blocked designs, clustered residuals adds a variance component that masks treatment effects</a></li>
<li><a href="lmm.html#linear-mixed-models-are-linear-models-with-added-random-factors" id="toc-linear-mixed-models-are-linear-models-with-added-random-factors"><span class="toc-section-number">16.1.4</span> Linear mixed models are linear models with added random factors</a></li>
<li><a href="lmm.html#what-the-random-effects-are" id="toc-what-the-random-effects-are"><span class="toc-section-number">16.1.5</span> What the random effects are</a></li>
<li><a href="lmm.html#in-a-blocked-design-a-linear-model-with-added-random-effects-increases-precision-of-treatment-effects" id="toc-in-a-blocked-design-a-linear-model-with-added-random-effects-increases-precision-of-treatment-effects"><span class="toc-section-number">16.1.6</span> In a blocked design, a linear model with added random effects increases precision of treatment effects</a></li>
<li><a href="lmm.html#lmm-varcorr" id="toc-lmm-varcorr"><span class="toc-section-number">16.1.7</span> The correlation among random intercepts and slopes</a></li>
<li><a href="lmm.html#clustered-residuals-create-heterogeneity-among-treatments" id="toc-clustered-residuals-create-heterogeneity-among-treatments"><span class="toc-section-number">16.1.8</span> Clustered residuals create heterogeneity among treatments</a></li>
<li><a href="lmm.html#linear-mixed-models-are-flexible" id="toc-linear-mixed-models-are-flexible"><span class="toc-section-number">16.1.9</span> Linear mixed models are flexible</a></li>
<li><a href="lmm.html#a-random-intercept-only-model" id="toc-a-random-intercept-only-model"><span class="toc-section-number">16.1.10</span> A random intercept only model</a></li>
<li><a href="lmm.html#a-model-including-an-interaction-intercept" id="toc-a-model-including-an-interaction-intercept"><span class="toc-section-number">16.1.11</span> A model including an interaction intercept</a></li>
<li><a href="lmm.html#lmm-demo-aic" id="toc-lmm-demo-aic"><span class="toc-section-number">16.1.12</span> AIC and model selection – which model to report?</a></li>
<li><a href="lmm.html#the-specification-of-random-effects-matters" id="toc-the-specification-of-random-effects-matters"><span class="toc-section-number">16.1.13</span> The specification of random effects matters</a></li>
<li><a href="lmm.html#mixed-effect-and-repeated-measures-anova" id="toc-mixed-effect-and-repeated-measures-anova"><span class="toc-section-number">16.1.14</span> Mixed Effect and Repeated Measures ANOVA</a></li>
<li><a href="lmm.html#pseudoreplication" id="toc-pseudoreplication"><span class="toc-section-number">16.1.15</span> Pseudoreplication</a></li>
</ul></li>
<li><a href="lmm.html#lmm-example2" id="toc-lmm-example2"><span class="toc-section-number">16.2</span> Example 2 – experiments without subsampling replication (exp6g)</a>
<ul>
<li><a href="lmm.html#understand-the-data" id="toc-understand-the-data"><span class="toc-section-number">16.2.1</span> Understand the data</a></li>
<li><a href="lmm.html#model-fit-and-inference" id="toc-model-fit-and-inference"><span class="toc-section-number">16.2.2</span> Model fit and inference</a></li>
<li><a href="lmm.html#the-model-exp6g_m1-adds-a-random-intercept-but-not-a-random-slope" id="toc-the-model-exp6g_m1-adds-a-random-intercept-but-not-a-random-slope"><span class="toc-section-number">16.2.3</span> The model exp6g_m1 adds a random intercept but not a random slope</a></li>
<li><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp6g_m1" id="toc-the-fixed-effect-coefficients-of-model-exp6g_m1"><span class="toc-section-number">16.2.4</span> The fixed effect coefficients of model exp6g_m1</a></li>
<li><a href="lmm.html#the-random-intercept-coefficients-of-exp6g_m1" id="toc-the-random-intercept-coefficients-of-exp6g_m1"><span class="toc-section-number">16.2.5</span> The random intercept coefficients of exp6g_m1</a></li>
<li><a href="lmm.html#the-random-and-residual-variance-and-the-intraclass-correlation-of-model-exp6g_m1" id="toc-the-random-and-residual-variance-and-the-intraclass-correlation-of-model-exp6g_m1"><span class="toc-section-number">16.2.6</span> The random and residual variance and the intraclass correlation of model exp6g_m1</a></li>
<li><a href="lmm.html#the-linear-mixed-model-exp6g_m1-increases-precision-of-treatment-effects-relative-to-a-fixed-effects-model" id="toc-the-linear-mixed-model-exp6g_m1-increases-precision-of-treatment-effects-relative-to-a-fixed-effects-model"><span class="toc-section-number">16.2.7</span> The linear mixed model exp6g_m1 increases precision of treatment effects, relative to a fixed effects model</a></li>
<li><a href="lmm.html#lmm-exp6g-alt" id="toc-lmm-exp6g-alt"><span class="toc-section-number">16.2.8</span> Alternative models for exp6g</a></li>
<li><a href="lmm.html#paired-t-tests-and-repeated-measures-anova-are-special-cases-of-linear-mixed-models" id="toc-paired-t-tests-and-repeated-measures-anova-are-special-cases-of-linear-mixed-models"><span class="toc-section-number">16.2.9</span> Paired t-tests and repeated measures ANOVA are special cases of linear mixed models</a></li>
<li><a href="lmm.html#lmm-exp6g-rmanova" id="toc-lmm-exp6g-rmanova"><span class="toc-section-number">16.2.10</span> Classical (“univariate model”) repeated measures ANOVA of exp6g</a></li>
<li><a href="lmm.html#lmm-exp6g-rmanova-multi" id="toc-lmm-exp6g-rmanova-multi"><span class="toc-section-number">16.2.11</span> “Multivariate model” repeated measures ANOVA</a></li>
<li><a href="lmm.html#linear-mixed-models-vs-repeated-measures-anova" id="toc-linear-mixed-models-vs-repeated-measures-anova"><span class="toc-section-number">16.2.12</span> Linear mixed models vs repeated measures ANOVA</a></li>
<li><a href="lmm.html#modeling-textttmouse_id-as-a-fixed-effect" id="toc-modeling-textttmouse_id-as-a-fixed-effect"><span class="toc-section-number">16.2.13</span> Modeling <span class="math inline">\(\texttt{mouse_id}\)</span> as a fixed effect</a></li>
</ul></li>
<li><a href="lmm.html#example-3-factorial-experiments-and-no-subsampling-replicates-exp5c" id="toc-example-3-factorial-experiments-and-no-subsampling-replicates-exp5c"><span class="toc-section-number">16.3</span> Example 3 – Factorial experiments and no subsampling replicates (exp5c)</a>
<ul>
<li><a href="lmm.html#understand-the-data-1" id="toc-understand-the-data-1"><span class="toc-section-number">16.3.1</span> Understand the data</a></li>
<li><a href="lmm.html#examine-the-data-1" id="toc-examine-the-data-1"><span class="toc-section-number">16.3.2</span> Examine the data</a></li>
<li><a href="lmm.html#lmm-exp5c-m1" id="toc-lmm-exp5c-m1"><span class="toc-section-number">16.3.3</span> Model fit and inference</a></li>
<li><a href="lmm.html#why-we-care-about-modeling-batch-in-exp5c" id="toc-why-we-care-about-modeling-batch-in-exp5c"><span class="toc-section-number">16.3.4</span> Why we care about modeling batch in exp5c</a></li>
<li><a href="lmm.html#the-linear-mixed-model-exp5c_m1-adds-two-random-intercepts" id="toc-the-linear-mixed-model-exp5c_m1-adds-two-random-intercepts"><span class="toc-section-number">16.3.5</span> The linear mixed model exp5c_m1 adds two random intercepts</a></li>
<li><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp5c_m1" id="toc-the-fixed-effect-coefficients-of-model-exp5c_m1"><span class="toc-section-number">16.3.6</span> The fixed effect coefficients of model exp5c_m1</a></li>
<li><a href="lmm.html#the-random-effect-coefficients-of-model-exp5c_m1" id="toc-the-random-effect-coefficients-of-model-exp5c_m1"><span class="toc-section-number">16.3.7</span> The random effect coefficients of model exp5c_m1</a></li>
<li><a href="lmm.html#lmm-exp5c-alt" id="toc-lmm-exp5c-alt"><span class="toc-section-number">16.3.8</span> Alternative models for exp5c</a></li>
<li><a href="lmm.html#lmm-rmanova-5c" id="toc-lmm-rmanova-5c"><span class="toc-section-number">16.3.9</span> Classical (“univariate model”) repeated measures ANOVA</a></li>
<li><a href="lmm.html#lmm-rmanova-5c-multi" id="toc-lmm-rmanova-5c-multi"><span class="toc-section-number">16.3.10</span> “Multivariate model” repeated measures ANOVA of exp5c</a></li>
<li><a href="lmm.html#modeling-textttdonor-as-a-fixed-effect" id="toc-modeling-textttdonor-as-a-fixed-effect"><span class="toc-section-number">16.3.11</span> Modeling <span class="math inline">\(\texttt{donor}\)</span> as a fixed effect</a></li>
</ul></li>
<li><a href="lmm.html#lmm-example4" id="toc-lmm-example4"><span class="toc-section-number">16.4</span> Example 4 – Experiments with subsampling replication (exp1g)</a>
<ul>
<li><a href="lmm.html#understand-the-data-2" id="toc-understand-the-data-2"><span class="toc-section-number">16.4.1</span> Understand the data</a></li>
<li><a href="lmm.html#examine-the-data-2" id="toc-examine-the-data-2"><span class="toc-section-number">16.4.2</span> Examine the data</a></li>
<li><a href="lmm.html#fit-the-model-9" id="toc-fit-the-model-9"><span class="toc-section-number">16.4.3</span> Fit the model</a></li>
<li><a href="lmm.html#inference-from-the-model-6" id="toc-inference-from-the-model-6"><span class="toc-section-number">16.4.4</span> Inference from the model</a></li>
<li><a href="lmm.html#plot-the-model-6" id="toc-plot-the-model-6"><span class="toc-section-number">16.4.5</span> Plot the model</a></li>
<li><a href="lmm.html#alternaplot-the-model-2" id="toc-alternaplot-the-model-2"><span class="toc-section-number">16.4.6</span> Alternaplot the model</a></li>
<li><a href="lmm.html#understanding-the-alternative-models" id="toc-understanding-the-alternative-models"><span class="toc-section-number">16.4.7</span> Understanding the alternative models</a></li>
<li><a href="lmm.html#the-varcorr-matrix-of-models-exp1g_m1a-and-exp1g_m1b" id="toc-the-varcorr-matrix-of-models-exp1g_m1a-and-exp1g_m1b"><span class="toc-section-number">16.4.8</span> The VarCorr matrix of models exp1g_m1a and exp1g_m1b</a></li>
<li><a href="lmm.html#the-linear-mixed-model-has-more-precision-and-power-than-the-fixed-effect-model-of-batch-means" id="toc-the-linear-mixed-model-has-more-precision-and-power-than-the-fixed-effect-model-of-batch-means"><span class="toc-section-number">16.4.9</span> The linear mixed model has more precision and power than the fixed effect model of batch means</a></li>
<li><a href="lmm.html#fixed-effect-models-and-pseudoreplication" id="toc-fixed-effect-models-and-pseudoreplication"><span class="toc-section-number">16.4.10</span> Fixed effect models and pseudoreplication</a></li>
<li><a href="lmm.html#mixed-effect-anova" id="toc-mixed-effect-anova"><span class="toc-section-number">16.4.11</span> Mixed-effect ANOVA</a></li>
</ul></li>
<li><a href="lmm.html#working-in-r-5" id="toc-working-in-r-5"><span class="toc-section-number">16.5</span> Working in R</a>
<ul>
<li><a href="lmm.html#fitting-linear-mixed-models" id="toc-fitting-linear-mixed-models"><span class="toc-section-number">16.5.1</span> Fitting linear mixed models</a></li>
<li><a href="lmm.html#plotting-models-fit-to-batched-data" id="toc-plotting-models-fit-to-batched-data"><span class="toc-section-number">16.5.2</span> Plotting models fit to batched data</a></li>
<li><a href="lmm.html#repeated-measures-anova-randomized-complete-block-with-no-subsampling" id="toc-repeated-measures-anova-randomized-complete-block-with-no-subsampling"><span class="toc-section-number">16.5.3</span> Repeated measures ANOVA (randomized complete block with no subsampling)</a></li>
</ul></li>
<li><a href="lmm.html#hidden-code-7" id="toc-hidden-code-7"><span class="toc-section-number">16.6</span> Hidden code</a>
<ul>
<li><a href="lmm.html#import-exp5c" id="toc-import-exp5c"><span class="toc-section-number">16.6.1</span> Import exp5c</a></li>
<li><a href="lmm.html#import-exp1g" id="toc-import-exp1g"><span class="toc-section-number">16.6.2</span> Import exp1g</a></li>
</ul></li>
</ul></li>
<li><a href="pre-post.html#pre-post" id="toc-pre-post"><span class="toc-section-number">17</span> Linear models for longitudinal experiments – I. pre-post designs</a>
<ul>
<li><a href="pre-post.html#best-practice-models" id="toc-best-practice-models"><span class="toc-section-number">17.1</span> Best practice models</a></li>
<li><a href="pre-post.html#common-alternatives-that-are-not-recommended" id="toc-common-alternatives-that-are-not-recommended"><span class="toc-section-number">17.2</span> Common alternatives that are not recommended</a></li>
<li><a href="pre-post.html#advanced-models" id="toc-advanced-models"><span class="toc-section-number">17.3</span> Advanced models</a></li>
<li><a href="pre-post.html#understanding-the-alternative-models-1" id="toc-understanding-the-alternative-models-1"><span class="toc-section-number">17.4</span> Understanding the alternative models</a>
<ul>
<li><a href="pre-post.html#m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model" id="toc-m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model"><span class="toc-section-number">17.4.1</span> (M1) Linear model with the baseline measure as the covariate (ANCOVA model)</a></li>
<li><a href="pre-post.html#m2-linear-model-of-the-change-score-change-score-model" id="toc-m2-linear-model-of-the-change-score-change-score-model"><span class="toc-section-number">17.4.2</span> (M2) Linear model of the change score (change-score model)</a></li>
<li><a href="pre-post.html#m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model" id="toc-m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model"><span class="toc-section-number">17.4.3</span> (M3) Linear model of post-baseline values without the baseline as a covariate (post model)</a></li>
<li><a href="pre-post.html#m4-linear-model-with-factorial-fixed-effects-fixed-effects-model" id="toc-m4-linear-model-with-factorial-fixed-effects-fixed-effects-model"><span class="toc-section-number">17.4.4</span> (M4) Linear model with factorial fixed effects (fixed-effects model)</a></li>
<li><a href="pre-post.html#m5-repeated-measures-anova" id="toc-m5-repeated-measures-anova"><span class="toc-section-number">17.4.5</span> (M5) Repeated measures ANOVA</a></li>
<li><a href="pre-post.html#m6-linear-mixed-model" id="toc-m6-linear-mixed-model"><span class="toc-section-number">17.4.6</span> (M6) Linear mixed model</a></li>
<li><a href="pre-post.html#m7-linear-model-with-correlated-error" id="toc-m7-linear-model-with-correlated-error"><span class="toc-section-number">17.4.7</span> (M7) Linear model with correlated error</a></li>
<li><a href="pre-post.html#m8-constrained-fixed-effects-model-with-correlated-error-clda-model" id="toc-m8-constrained-fixed-effects-model-with-correlated-error-clda-model"><span class="toc-section-number">17.4.8</span> (M8) Constrained fixed effects model with correlated error (cLDA model)</a></li>
<li><a href="pre-post.html#comparison-table" id="toc-comparison-table"><span class="toc-section-number">17.4.9</span> Comparison table</a></li>
</ul></li>
<li><a href="pre-post.html#example-1-a-single-post-baseline-measure-pre-post-design" id="toc-example-1-a-single-post-baseline-measure-pre-post-design"><span class="toc-section-number">17.5</span> Example 1 – a single post-baseline measure (pre-post design)</a></li>
<li><a href="pre-post.html#working-in-r-6" id="toc-working-in-r-6"><span class="toc-section-number">17.6</span> Working in R</a></li>
<li><a href="pre-post.html#hidden-code-8" id="toc-hidden-code-8"><span class="toc-section-number">17.7</span> Hidden code</a>
<ul>
<li><a href="pre-post.html#import-and-wrangle-mouse-sociability-data" id="toc-import-and-wrangle-mouse-sociability-data"><span class="toc-section-number">17.7.1</span> Import and wrangle mouse sociability data</a></li>
</ul></li>
</ul></li>
<li><a href="counts.html#counts" id="toc-counts"><span class="toc-section-number">18</span> Linear models for counts, binary responses, skewed responses, and ratios – Generalized Linear Models</a>
<ul>
<li><a href="counts.html#glm-counts" id="toc-glm-counts"><span class="toc-section-number">18.1</span> Introducing Generalized Linear Models using count data examples</a>
<ul>
<li><a href="counts.html#the-generalized-linear-model-glm" id="toc-the-generalized-linear-model-glm"><span class="toc-section-number">18.1.1</span> The Generalized Linear Model (GLM)</a></li>
<li><a href="counts.html#kinds-of-data-that-are-modeled-by-a-glm" id="toc-kinds-of-data-that-are-modeled-by-a-glm"><span class="toc-section-number">18.1.2</span> Kinds of data that are modeled by a GLM</a></li>
</ul></li>
<li><a href="counts.html#glm-1" id="toc-glm-1"><span class="toc-section-number">18.2</span> Example 1 – GLM models for count responses (“angiogenic sprouts” exp3a)</a>
<ul>
<li><a href="counts.html#understand-the-data-3" id="toc-understand-the-data-3"><span class="toc-section-number">18.2.1</span> Understand the data</a></li>
<li><a href="counts.html#model-fit-and-inference-1" id="toc-model-fit-and-inference-1"><span class="toc-section-number">18.2.2</span> Model fit and inference</a></li>
</ul></li>
<li><a href="counts.html#understanding-example-1" id="toc-understanding-example-1"><span class="toc-section-number">18.3</span> Understanding Example 1</a>
<ul>
<li><a href="counts.html#modeling-strategy-1" id="toc-modeling-strategy-1"><span class="toc-section-number">18.3.1</span> Modeling strategy</a></li>
<li><a href="counts.html#model-checking-fits-to-count-data" id="toc-model-checking-fits-to-count-data"><span class="toc-section-number">18.3.2</span> Model checking fits to count data</a></li>
<li><a href="counts.html#biological-count-data-are-rarely-fit-well-by-a-poisson-glm.-instead-fit-a-quasi-poisson-or-negative-binomial-glm-model." id="toc-biological-count-data-are-rarely-fit-well-by-a-poisson-glm.-instead-fit-a-quasi-poisson-or-negative-binomial-glm-model."><span class="toc-section-number">18.3.3</span> Biological count data are rarely fit well by a Poisson GLM. Instead, fit a quasi-poisson or negative binomial GLM model.</a></li>
<li><a href="counts.html#a-glm-is-a-linear-model-on-the-link-scale" id="toc-a-glm-is-a-linear-model-on-the-link-scale"><span class="toc-section-number">18.3.4</span> A GLM is a linear model on the link scale</a></li>
<li><a href="counts.html#coeffecients-of-a-generalized-linear-model-with-a-log-link-function-are-on-the-link-scale." id="toc-coeffecients-of-a-generalized-linear-model-with-a-log-link-function-are-on-the-link-scale."><span class="toc-section-number">18.3.5</span> Coeffecients of a Generalized Linear Model with a log-link function are on the link scale.</a></li>
<li><a href="counts.html#modeled-means-in-the-emmeans-table-of-a-generalized-linear-model-can-be-on-the-link-scale-or-response-scale-report-the-response-scale" id="toc-modeled-means-in-the-emmeans-table-of-a-generalized-linear-model-can-be-on-the-link-scale-or-response-scale-report-the-response-scale"><span class="toc-section-number">18.3.6</span> Modeled means in the emmeans table of a Generalized Linear Model can be on the link scale or response scale – Report the response scale</a></li>
<li><a href="counts.html#some-consequences-of-fitting-a-linear-model-to-count-data" id="toc-some-consequences-of-fitting-a-linear-model-to-count-data"><span class="toc-section-number">18.3.7</span> Some consequences of fitting a linear model to count data</a></li>
</ul></li>
<li><a href="counts.html#example-2-use-a-glm-with-an-offset-instead-of-a-ratio-of-some-measurement-per-area-dna-damage-data-exp3b" id="toc-example-2-use-a-glm-with-an-offset-instead-of-a-ratio-of-some-measurement-per-area-dna-damage-data-exp3b"><span class="toc-section-number">18.4</span> Example 2 – Use a GLM with an offset instead of a ratio of some measurement per area (“dna damage” data exp3b)</a>
<ul>
<li><a href="counts.html#exp3b-dna-damage-data" id="toc-exp3b-dna-damage-data"><span class="toc-section-number">18.4.1</span> exp3b (“dna damage”) data</a></li>
<li><a href="counts.html#understand-the-data-4" id="toc-understand-the-data-4"><span class="toc-section-number">18.4.2</span> Understand the data</a></li>
<li><a href="counts.html#model-fit-and-inference-2" id="toc-model-fit-and-inference-2"><span class="toc-section-number">18.4.3</span> Model fit and inference</a></li>
</ul></li>
<li><a href="counts.html#understanding-example-2" id="toc-understanding-example-2"><span class="toc-section-number">18.5</span> Understanding Example 2</a>
<ul>
<li><a href="counts.html#an-offset-is-an-added-covariate-with-a-coefficient-fixed-at-1" id="toc-an-offset-is-an-added-covariate-with-a-coefficient-fixed-at-1"><span class="toc-section-number">18.5.1</span> An offset is an added covariate with a coefficient fixed at 1</a></li>
<li><a href="counts.html#glm-rate" id="toc-glm-rate"><span class="toc-section-number">18.5.2</span> A count GLM with an offset models the area-normalized means</a></li>
<li><a href="counts.html#compare-an-offset-to-an-added-covariate-with-an-estimated-coefficient" id="toc-compare-an-offset-to-an-added-covariate-with-an-estimated-coefficient"><span class="toc-section-number">18.5.3</span> Compare an offset to an added covariate with an estimated coefficient</a></li>
<li><a href="counts.html#issues-with-plotting" id="toc-issues-with-plotting"><span class="toc-section-number">18.5.4</span> Issues with plotting</a></li>
</ul></li>
<li><a href="counts.html#example-3-glm-models-for-binary-responses" id="toc-example-3-glm-models-for-binary-responses"><span class="toc-section-number">18.6</span> Example 3 – GLM models for binary responses</a></li>
<li><a href="counts.html#working-in-r-7" id="toc-working-in-r-7"><span class="toc-section-number">18.7</span> Working in R</a>
<ul>
<li><a href="counts.html#fitting-glms-to-count-data" id="toc-fitting-glms-to-count-data"><span class="toc-section-number">18.7.1</span> Fitting GLMs to count data</a></li>
<li><a href="counts.html#fitting-a-glm-to-a-continuous-conditional-response-with-right-skew." id="toc-fitting-a-glm-to-a-continuous-conditional-response-with-right-skew."><span class="toc-section-number">18.7.2</span> Fitting a GLM to a continuous conditional response with right skew.</a></li>
<li><a href="counts.html#fitting-a-glm-to-a-binary-success-or-failure-presence-or-absence-survived-or-died-response" id="toc-fitting-a-glm-to-a-binary-success-or-failure-presence-or-absence-survived-or-died-response"><span class="toc-section-number">18.7.3</span> Fitting a GLM to a binary (success or failure, presence or absence, survived or died) response</a></li>
<li><a href="counts.html#fitting-generalized-linear-mixed-models" id="toc-fitting-generalized-linear-mixed-models"><span class="toc-section-number">18.7.4</span> Fitting Generalized Linear Mixed Models</a></li>
</ul></li>
<li><a href="counts.html#model-checking-glms" id="toc-model-checking-glms"><span class="toc-section-number">18.8</span> Model checking GLMs</a></li>
<li><a href="counts.html#hidden-code-9" id="toc-hidden-code-9"><span class="toc-section-number">18.9</span> Hidden code</a>
<ul>
<li><a href="counts.html#import-example-1-data-exp3a-angiogenic-sprouts" id="toc-import-example-1-data-exp3a-angiogenic-sprouts"><span class="toc-section-number">18.9.1</span> Import Example 1 data (exp3a – “angiogenic sprouts”)</a></li>
</ul></li>
</ul></li>
<li><a href="gls.html#gls" id="toc-gls"><span class="toc-section-number">19</span> Linear models with heterogenous variance</a></li>
<li><a href="appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models.html#appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models" id="toc-appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models">Appendix: An example set of analyses of experimental data with linear models</a></li>
<li><a href="ask1-bio.html#ask1-bio" id="toc-ask1-bio"><span class="toc-section-number">20</span> Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li><a href="ask1-report.html#ask1-report" id="toc-ask1-report"><span class="toc-section-number">21</span> Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a>
<ul>
<li><a href="ask1-report.html#setup" id="toc-setup"><span class="toc-section-number">21.1</span> Setup</a></li>
<li><a href="ask1-report.html#data-source" id="toc-data-source"><span class="toc-section-number">21.2</span> Data source</a></li>
<li><a href="ask1-report.html#control-the-color-palette" id="toc-control-the-color-palette"><span class="toc-section-number">21.3</span> control the color palette</a></li>
<li><a href="ask1-report.html#useful-functions" id="toc-useful-functions"><span class="toc-section-number">21.4</span> useful functions</a></li>
<li><a href="ask1-report.html#figure-2b-effect-of-ask1-deletion-on-growth-body-weight" id="toc-figure-2b-effect-of-ask1-deletion-on-growth-body-weight"><span class="toc-section-number">21.5</span> figure 2b – effect of ASK1 deletion on growth (body weight)</a>
<ul>
<li><a href="ask1-report.html#figure-2b-import" id="toc-figure-2b-import"><span class="toc-section-number">21.5.1</span> figure 2b – import</a></li>
<li><a href="ask1-report.html#figure-2b-exploratory-plots" id="toc-figure-2b-exploratory-plots"><span class="toc-section-number">21.5.2</span> figure 2b – exploratory plots</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2c-effect-of-ask1-deletion-on-final-body-weight" id="toc-figure-2c-effect-of-ask1-deletion-on-final-body-weight"><span class="toc-section-number">21.6</span> Figure 2c – Effect of ASK1 deletion on final body weight</a>
<ul>
<li><a href="ask1-report.html#figure-2c-import" id="toc-figure-2c-import"><span class="toc-section-number">21.6.1</span> Figure 2c – import</a></li>
<li><a href="ask1-report.html#figure-2c-check-own-computation-of-weight-change-v-imported-value" id="toc-figure-2c-check-own-computation-of-weight-change-v-imported-value"><span class="toc-section-number">21.6.2</span> Figure 2c – check own computation of weight change v imported value</a></li>
<li><a href="ask1-report.html#figure-2c-exploratory-plots" id="toc-figure-2c-exploratory-plots"><span class="toc-section-number">21.6.3</span> Figure 2c – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2c-fit-the-model-m1-lm" id="toc-figure-2c-fit-the-model-m1-lm"><span class="toc-section-number">21.6.4</span> Figure 2c – fit the model: m1 (lm)</a></li>
<li><a href="ask1-report.html#figure-2c-check-the-model-m1" id="toc-figure-2c-check-the-model-m1"><span class="toc-section-number">21.6.5</span> Figure 2c – check the model: m1</a></li>
<li><a href="ask1-report.html#figure-2c-fit-the-model-m2-gamma-glm" id="toc-figure-2c-fit-the-model-m2-gamma-glm"><span class="toc-section-number">21.6.6</span> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li><a href="ask1-report.html#figure-2c-check-the-model-m2" id="toc-figure-2c-check-the-model-m2"><span class="toc-section-number">21.6.7</span> Figure 2c – check the model, m2</a></li>
<li><a href="ask1-report.html#figure-2c-inference-from-the-model" id="toc-figure-2c-inference-from-the-model"><span class="toc-section-number">21.6.8</span> Figure 2c – inference from the model</a></li>
<li><a href="ask1-report.html#figure-2c-plot-the-model" id="toc-figure-2c-plot-the-model"><span class="toc-section-number">21.6.9</span> Figure 2c – plot the model</a></li>
<li><a href="ask1-report.html#figure-2c-report" id="toc-figure-2c-report"><span class="toc-section-number">21.6.10</span> Figure 2c – report</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve" id="toc-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><span class="toc-section-number">21.7</span> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a>
<ul>
<li><a href="ask1-report.html#figure-2d-import" id="toc-figure-2d-import"><span class="toc-section-number">21.7.1</span> Figure 2d – Import</a></li>
<li><a href="ask1-report.html#figure-2d-exploratory-plots" id="toc-figure-2d-exploratory-plots"><span class="toc-section-number">21.7.2</span> Figure 2d – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2d-fit-the-model" id="toc-figure-2d-fit-the-model"><span class="toc-section-number">21.7.3</span> Figure 2d – fit the model</a></li>
<li><a href="ask1-report.html#figure-2d-check-the-model" id="toc-figure-2d-check-the-model"><span class="toc-section-number">21.7.4</span> Figure 2d – check the model</a></li>
<li><a href="ask1-report.html#figure-2d-inference" id="toc-figure-2d-inference"><span class="toc-section-number">21.7.5</span> Figure 2d – inference</a></li>
<li><a href="ask1-report.html#figure-2d-plot-the-model" id="toc-figure-2d-plot-the-model"><span class="toc-section-number">21.7.6</span> Figure 2d – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure" id="toc-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure"><span class="toc-section-number">21.8</span> Figure 2e – Effect of ASK1 deletion on glucose tolerance (summary measure)</a>
<ul>
<li><a href="ask1-report.html#figure-2e-message-the-data" id="toc-figure-2e-message-the-data"><span class="toc-section-number">21.8.1</span> Figure 2e – message the data</a></li>
<li><a href="ask1-report.html#figure-2e-exploratory-plots" id="toc-figure-2e-exploratory-plots"><span class="toc-section-number">21.8.2</span> Figure 2e – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2e-fit-the-model" id="toc-figure-2e-fit-the-model"><span class="toc-section-number">21.8.3</span> Figure 2e – fit the model</a></li>
<li><a href="ask1-report.html#figure-2e-check-the-model" id="toc-figure-2e-check-the-model"><span class="toc-section-number">21.8.4</span> Figure 2e – check the model</a></li>
<li><a href="ask1-report.html#figure-2e-inference-from-the-model" id="toc-figure-2e-inference-from-the-model"><span class="toc-section-number">21.8.5</span> Figure 2e – inference from the model</a></li>
<li><a href="ask1-report.html#figure-2e-plot-the-model" id="toc-figure-2e-plot-the-model"><span class="toc-section-number">21.8.6</span> Figure 2e – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate" id="toc-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate"><span class="toc-section-number">21.9</span> Figure 2f – Effect of ASK1 deletion on glucose infusion rate</a>
<ul>
<li><a href="ask1-report.html#figure-2f-import" id="toc-figure-2f-import"><span class="toc-section-number">21.9.1</span> Figure 2f – import</a></li>
<li><a href="ask1-report.html#figure-2f-exploratory-plots" id="toc-figure-2f-exploratory-plots"><span class="toc-section-number">21.9.2</span> Figure 2f – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2f-fit-the-model" id="toc-figure-2f-fit-the-model"><span class="toc-section-number">21.9.3</span> Figure 2f – fit the model</a></li>
<li><a href="ask1-report.html#figure-2f-check-the-model" id="toc-figure-2f-check-the-model"><span class="toc-section-number">21.9.4</span> Figure 2f – check the model</a></li>
<li><a href="ask1-report.html#figure-2f-inference" id="toc-figure-2f-inference"><span class="toc-section-number">21.9.5</span> Figure 2f – inference</a></li>
<li><a href="ask1-report.html#figure-2f-plot-the-model" id="toc-figure-2f-plot-the-model"><span class="toc-section-number">21.9.6</span> Figure 2f – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake" id="toc-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake"><span class="toc-section-number">21.10</span> Figure 2g – Effect of ASK1 deletion on tissue-specific glucose uptake</a>
<ul>
<li><a href="ask1-report.html#figure-2g-import" id="toc-figure-2g-import"><span class="toc-section-number">21.10.1</span> Figure 2g – import</a></li>
<li><a href="ask1-report.html#figure-2g-exploratory-plots" id="toc-figure-2g-exploratory-plots"><span class="toc-section-number">21.10.2</span> Figure 2g – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2g-fit-the-model" id="toc-figure-2g-fit-the-model"><span class="toc-section-number">21.10.3</span> Figure 2g – fit the model</a></li>
<li><a href="ask1-report.html#figure-2g-check-the-model" id="toc-figure-2g-check-the-model"><span class="toc-section-number">21.10.4</span> Figure 2g – check the model</a></li>
<li><a href="ask1-report.html#figure-2g-inference" id="toc-figure-2g-inference"><span class="toc-section-number">21.10.5</span> Figure 2g – inference</a></li>
<li><a href="ask1-report.html#figure-2g-plot-the-model" id="toc-figure-2g-plot-the-model"><span class="toc-section-number">21.10.6</span> Figure 2g – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2h" id="toc-figure-2h"><span class="toc-section-number">21.11</span> Figure 2h</a></li>
<li><a href="ask1-report.html#figure-2i-effect-of-ask1-deletion-on-liver-tg" id="toc-figure-2i-effect-of-ask1-deletion-on-liver-tg"><span class="toc-section-number">21.12</span> Figure 2i – Effect of ASK1 deletion on liver TG</a>
<ul>
<li><a href="ask1-report.html#figure-2i-fit-the-model" id="toc-figure-2i-fit-the-model"><span class="toc-section-number">21.12.1</span> Figure 2i – fit the model</a></li>
<li><a href="ask1-report.html#figure-2i-check-the-model" id="toc-figure-2i-check-the-model"><span class="toc-section-number">21.12.2</span> Figure 2i – check the model</a></li>
<li><a href="ask1-report.html#figure-2i-inference" id="toc-figure-2i-inference"><span class="toc-section-number">21.12.3</span> Figure 2i – inference</a></li>
<li><a href="ask1-report.html#figure-2i-plot-the-model" id="toc-figure-2i-plot-the-model"><span class="toc-section-number">21.12.4</span> Figure 2i – plot the model</a></li>
<li><a href="ask1-report.html#figure-2i-report-the-model" id="toc-figure-2i-report-the-model"><span class="toc-section-number">21.12.5</span> Figure 2i – report the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2j" id="toc-figure-2j"><span class="toc-section-number">21.13</span> Figure 2j</a></li>
</ul></li>
<li><a href="count-sim.html#count-sim" id="toc-count-sim"><span class="toc-section-number">22</span> Simulations – Count data (alternatives to a t-test)</a>
<ul>
<li><a href="count-sim.html#use-data-similar-to-figure-6f-from-example-1" id="toc-use-data-similar-to-figure-6f-from-example-1"><span class="toc-section-number">22.1</span> Use data similar to Figure 6f from Example 1</a></li>
<li><a href="count-sim.html#functions" id="toc-functions"><span class="toc-section-number">22.2</span> Functions</a></li>
<li><a href="count-sim.html#simulations" id="toc-simulations"><span class="toc-section-number">22.3</span> Simulations</a>
<ul>
<li><a href="count-sim.html#type-i-pseudo-normal-distribution" id="toc-type-i-pseudo-normal-distribution"><span class="toc-section-number">22.3.1</span> Type I, Pseudo-Normal distribution</a></li>
<li><a href="count-sim.html#type-i-neg-binom-equal-n" id="toc-type-i-neg-binom-equal-n"><span class="toc-section-number">22.3.2</span> Type I, neg binom, equal n</a></li>
<li><a href="count-sim.html#type-i-neg-binom-equal-n-small-theta" id="toc-type-i-neg-binom-equal-n-small-theta"><span class="toc-section-number">22.3.3</span> Type I, neg binom, equal n, small theta</a></li>
<li><a href="count-sim.html#type-i-neg-binom-unequal-n" id="toc-type-i-neg-binom-unequal-n"><span class="toc-section-number">22.3.4</span> Type I, neg binom, unequal n</a></li>
<li><a href="count-sim.html#power-pseudo-normal-distribution-equal-n" id="toc-power-pseudo-normal-distribution-equal-n"><span class="toc-section-number">22.3.5</span> Power, Pseudo-Normal distribution, equal n</a></li>
<li><a href="count-sim.html#power-neg-binom-equal-n" id="toc-power-neg-binom-equal-n"><span class="toc-section-number">22.3.6</span> Power, neg binom, equal n</a></li>
<li><a href="count-sim.html#power-neg-binom-small-theta" id="toc-power-neg-binom-small-theta"><span class="toc-section-number">22.3.7</span> Power, neg binom, small theta</a></li>
<li><a href="count-sim.html#power-neg-binom-unequal-n" id="toc-power-neg-binom-unequal-n"><span class="toc-section-number">22.3.8</span> Power, neg binom, unequal n</a></li>
<li><a href="count-sim.html#power-neg-binom-unequal-n-unequal-theta" id="toc-power-neg-binom-unequal-n-unequal-theta"><span class="toc-section-number">22.3.9</span> Power, neg binom, unequal n, unequal theta</a></li>
<li><a href="count-sim.html#type-1-neg-binom-equal-n-unequal-theta" id="toc-type-1-neg-binom-equal-n-unequal-theta"><span class="toc-section-number">22.3.10</span> Type 1, neg binom, equal n, unequal theta</a></li>
</ul></li>
<li><a href="count-sim.html#save-it-read-it" id="toc-save-it-read-it"><span class="toc-section-number">22.4</span> Save it, Read it</a></li>
<li><a href="count-sim.html#analysis" id="toc-analysis"><span class="toc-section-number">22.5</span> Analysis</a></li>
</ul></li>
<li><a href="appendix-1-getting-started-with-r.html#appendix-1-getting-started-with-r" id="toc-appendix-1-getting-started-with-r">Appendix 1: Getting Started with R</a>
<ul>
<li><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready" id="toc-get-your-computer-ready"><span class="toc-section-number">22.6</span> Get your computer ready</a>
<ul>
<li><a href="appendix-1-getting-started-with-r.html#start-here" id="toc-start-here"><span class="toc-section-number">22.6.1</span> Start here</a></li>
<li><a href="appendix-1-getting-started-with-r.html#install-r" id="toc-install-r"><span class="toc-section-number">22.6.2</span> Install R</a></li>
<li><a href="appendix-1-getting-started-with-r.html#install-r-studio" id="toc-install-r-studio"><span class="toc-section-number">22.6.3</span> Install R Studio</a></li>
<li><a href="appendix-1-getting-started-with-r.html#install-r-markdown-1" id="toc-install-r-markdown-1"><span class="toc-section-number">22.6.4</span> Install R Markdown</a></li>
<li><a href="appendix-1-getting-started-with-r.html#optional-alternative-latex-installations" id="toc-optional-alternative-latex-installations"><span class="toc-section-number">22.6.5</span> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li><a href="appendix-1-getting-started-with-r.html#start-learning-r-studio" id="toc-start-learning-r-studio"><span class="toc-section-number">22.7</span> Start learning R Studio</a></li>
</ul></li>
<li><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html#appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r" id="toc-appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r">Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics for Experimental Biology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="oneway" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</h1>
<div id="oneway-data" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> A linear model with a single, categorical <em>X</em> variable estimates the effects of the levels of <em>X</em> on the response</h2>
<p>To introduce a linear model with a single, categorical <span class="math inline">\(X\)</span> variable, I’ll use data from a set of experiments designed to measure the effect of the lipid 12,13-diHOME on brown adipose tissue (BAT) thermoregulation and the mechanism of this effect.</p>
<p><a href="https://www.nature.com/articles/nm.4297" target="_blank">Lynes, M.D., Leiria, L.O., Lundh, M., Bartelt, A., Shamsi, F., Huang, T.L., Takahashi, H., Hirshman, M.F., Schlein, C., Lee, A. and Baer, L.A., 2017. The cold-induced lipokine 12, 13-diHOME promotes fatty acid transport into brown adipose tissue. Nature medicine, 23(5), pp.631-637.</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5699924/pdf/nihms916046.pdf" target="_blank">Public source</a></p>
<p><a href="https://www.nature.com/articles/nm.4297#Sec14" target="_blank">Data source</a></p>
<p>Download the source data files and move to a new folder named “The cold-induced lipokine 12,13-diHOME promotes fatty acid transport into brown adipose tissue”.</p>
<p>Cold temperature and the neurotransmitter/hormone norepinephrine are known to stimulate increased thermogenesis in BAT cells. In this project, the researchers probed the question “what is the pathway that mediates the effect of cold-exposure on BAT thermogenesis?”. In the “discovery” component of this project, the researchers measured plasma levels of 88 lipids with known signaling properties in humans exposed to one hour of both normal (20 °C) and cold temperature (14 °C) temperature. Of the 88 lipids, 12,13-diHOME had the largest response to the cold treatment. The researchers followed this up with experiments on mice.</p>
<div id="oneway-example1" class="section level3" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Example 1 (fig3d) – two treatment levels (“groups”)</h3>
<p>Let’s start with the experiment in Figure 3d, which was designed to measure the effect of 12,13-diHOME on plasma triglyceride level. If 12,13-diHOME stimulates BAT activity, then levels in the 12,13-diHOME mice should be less than levels in the control mice.</p>
<div id="step-1-understand-the-experiment-design" class="section level4" number="10.1.1.1">
<h4><span class="header-section-number">10.1.1.1</span> Step 1 – Understand the experiment design</h4>
<p><strong>Response variable</strong>: <span class="math inline">\(\texttt{serum_tg}\)</span>, A measure of serum triglycerides (mg/dl). <span class="math inline">\(\texttt{serum_tg}\)</span> is a continuous variable.</p>
<p><strong>Factor variable</strong>: <span class="math inline">\(\texttt{treatment}\)</span>, with levels: “Vehicle”, “12,13-diHOME” (the control or “Vehicle” mice were injected with saline). Coded as a factor.</p>
<p><strong>Design</strong>: single, categorical <em>X</em></p>
</div>
<div id="step-2-import" class="section level4" number="10.1.1.2">
<h4><span class="header-section-number">10.1.1.2</span> Step 2 – import</h4>
<p>Open the data and, if necessary, wrangle into an analyzable format. The script to import these data is in the section Hidden code below.</p>
</div>
<div id="step-3-inspect-the-data" class="section level4" number="10.1.1.3">
<h4><span class="header-section-number">10.1.1.3</span> Step 3 – inspect the data</h4>
<p>The second step is to examine the data to</p>
<ol style="list-style-type: decimal">
<li>get a sense of sample size and balance</li>
<li>check for biologically implausible outliers that suggest measurement failure, or transcription error (from a notebook, not in a cell)</li>
<li>assess outliers for outlier strategy or robust analysis</li>
<li>assess reasonable distributions and models for analysis.</li>
</ol>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="oneway.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> serum_tg, <span class="at">data =</span> fig_3d)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-120-1.png" width="576" /></p>
<p>There are no obviously implausible data points. A normal distribution is a good, reasonable start. This can be checked more thoroughly after fitting the model.</p>
</div>
<div id="step-4-fit-the-model" class="section level4" number="10.1.1.4">
<h4><span class="header-section-number">10.1.1.4</span> Step 4 – fit the model</h4>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="oneway.html#cb253-1" aria-hidden="true" tabindex="-1"></a>fig3d_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(serum_tg <span class="sc">~</span> treatment, <span class="at">data =</span> fig_3d)</span></code></pre></div>
</div>
<div id="step-5-check-the-model" class="section level4" number="10.1.1.5">
<h4><span class="header-section-number">10.1.1.5</span> Step 5 – check the model</h4>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="oneway.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb254-2"><a href="oneway.html#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(fig3d_m1, <span class="at">id=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-122-1.png" width="576" /></p>
<p>The Q-Q plot indicates the distribution of residuals is well within that expected for a normal sample and there is no cause for concern with inference.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="oneway.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spreadLevelPlot</span>(fig3d_m1, <span class="at">id=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-123-1.png" width="576" /></p>
<pre><code>## 
## Suggested power transformation:  0.8167264</code></pre>
<p>The spread-location plot shows no conspicuous trend in how the spread changes with the conditonal mean. There is no cause for concern with inference.</p>
</div>
<div id="step-6-inference" class="section level4" number="10.1.1.6">
<h4><span class="header-section-number">10.1.1.6</span> Step 6 – inference</h4>
<div id="coefficient-table" class="section level5" number="10.1.1.6.1">
<h5><span class="header-section-number">10.1.1.6.1</span> coefficient table</h5>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="oneway.html#cb257-1" aria-hidden="true" tabindex="-1"></a>fig3d_m1_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(fig3d_m1)),</span>
<span id="cb257-2"><a href="oneway.html#cb257-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">confint</span>(fig3d_m1))</span>
<span id="cb257-3"><a href="oneway.html#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(fig3d_m1_coef, <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb257-4"><a href="oneway.html#cb257-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std. Error
</th>
<th style="text-align:right;">
t value
</th>
<th style="text-align:right;">
Pr(&gt;|t|)
</th>
<th style="text-align:right;">
2.5 %
</th>
<th style="text-align:right;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
42.6
</td>
<td style="text-align:right;">
1.67
</td>
<td style="text-align:right;">
25.6
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
38.9
</td>
<td style="text-align:right;">
46.3
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment12,13-diHOME
</td>
<td style="text-align:right;">
-7.2
</td>
<td style="text-align:right;">
2.36
</td>
<td style="text-align:right;">
-3.0
</td>
<td style="text-align:right;">
0.0125
</td>
<td style="text-align:right;">
-12.4
</td>
<td style="text-align:right;">
-1.9
</td>
</tr>
</tbody>
</table>
</div>
<div id="emmeans-table" class="section level5" number="10.1.1.6.2">
<h5><span class="header-section-number">10.1.1.6.2</span> emmeans table</h5>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="oneway.html#cb258-1" aria-hidden="true" tabindex="-1"></a>fig3d_m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(fig3d_m1, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb258-2"><a href="oneway.html#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(fig3d_m1_emm, <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb258-3"><a href="oneway.html#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:right;">
emmean
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Vehicle
</td>
<td style="text-align:right;">
42.6
</td>
<td style="text-align:right;">
1.67
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
38.9
</td>
<td style="text-align:right;">
46.3
</td>
</tr>
<tr>
<td style="text-align:left;">
12,13-diHOME
</td>
<td style="text-align:right;">
35.5
</td>
<td style="text-align:right;">
1.67
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
31.7
</td>
<td style="text-align:right;">
39.2
</td>
</tr>
</tbody>
</table>
</div>
<div id="contrasts-table" class="section level5" number="10.1.1.6.3">
<h5><span class="header-section-number">10.1.1.6.3</span> contrasts table</h5>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="oneway.html#cb259-1" aria-hidden="true" tabindex="-1"></a>fig3d_m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(fig3d_m1_emm,</span>
<span id="cb259-2"><a href="oneway.html#cb259-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb259-3"><a href="oneway.html#cb259-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb259-4"><a href="oneway.html#cb259-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-5"><a href="oneway.html#cb259-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(fig3d_m1_pairs, <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb259-6"><a href="oneway.html#cb259-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(12,13-diHOME) - Vehicle
</td>
<td style="text-align:right;">
-7.2
</td>
<td style="text-align:right;">
2.4
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
-12.4
</td>
<td style="text-align:right;">
-1.9
</td>
<td style="text-align:right;">
-3.04
</td>
<td style="text-align:right;">
0.0125
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="step-6-plot-the-model" class="section level4" number="10.1.1.7">
<h4><span class="header-section-number">10.1.1.7</span> Step 6 – plot the model</h4>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="oneway.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_the_model</span>(</span>
<span id="cb260-2"><a href="oneway.html#cb260-2" aria-hidden="true" tabindex="-1"></a>  fig3d_m1,</span>
<span id="cb260-3"><a href="oneway.html#cb260-3" aria-hidden="true" tabindex="-1"></a>  fig3d_m1_emm,</span>
<span id="cb260-4"><a href="oneway.html#cb260-4" aria-hidden="true" tabindex="-1"></a>  fig3d_m1_pairs,</span>
<span id="cb260-5"><a href="oneway.html#cb260-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend_position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb260-6"><a href="oneway.html#cb260-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="st">&quot;Serum TG (µg/dL)&quot;</span>,</span>
<span id="cb260-7"><a href="oneway.html#cb260-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">effect_label =</span> <span class="st">&quot;Effects (µg/dL)&quot;</span>,</span>
<span id="cb260-8"><a href="oneway.html#cb260-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb260-9"><a href="oneway.html#cb260-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>)</span>
<span id="cb260-10"><a href="oneway.html#cb260-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/ggplot_the_model-1.png" width="576" /></p>
</div>
<div id="step-7-report-the-model-results" class="section level4" number="10.1.1.8">
<h4><span class="header-section-number">10.1.1.8</span> Step 7 – report the model results</h4>
<ol style="list-style-type: decimal">
<li>Different ways of reporting the results without making claims that are not evidenced by the statistical analysis</li>
</ol>
<p>“The estimated average effect of 12,13-diHOME on serum TG is 7.17 µg/dL (95% CI: -12.4, -1.9, <span class="math inline">\(p = 0.012\)</span>).”</p>
<p>“Mean serum TG in mice with 12,13-diHOME (35.5 µg/dL, 95% CI: 31.7, 39.2) was 7.17 µg/dL less (95% CI: -12.4, -1.9, p = 0.012) than mean serum TG in control mice (42.6 µg/dL, 95% CI: 38.9, 46.3).”</p>
<ol start="2" style="list-style-type: decimal">
<li>Problematic reports</li>
</ol>
<p>“12,13-diHOME significantly reduced serum TG (<span class="math inline">\(p = 0.012\)</span>)” (1. In English, the current use of “significant” means “large” or “important”. Only knowledge of the physiological consequences of TG reduction over the range of the CI can be use as evidence of importance. 2. The statistics do not provide evidence that it is the serum TG that caused this reduction. While 7.17 µg/dL is the difference, some or all of the effect could be due to, in general, sampling, execution errors such as non-random treatment assignment, clustered caging, clustered application of assays, or non-blinded measurement of the response.</p>
</div>
</div>
<div id="understanding-the-analysis-with-two-treatment-levels" class="section level3" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> Understanding the analysis with two treatment levels</h3>
<p>The variable <span class="math inline">\(\texttt{treatment}\)</span> in the Figure 3d mouse experiment, is a single, categorical <span class="math inline">\(X\)</span> variable. In a linear model, categorical variables are called <strong>factors</strong>. <span class="math inline">\(\texttt{treatment}\)</span> can take two different values, “Vehicle” and “12,13-diHOME”. The different values in a factor are the <strong>factor levels</strong> (or just “levels”). “Levels” is a strange usage of this word; a less formal name for levels is “groups”. In a <strong>Nominal</strong> categorical factor, the levels have no units and are unordered, even if the variable is based on a numeric measurement. For example, I might design an experiment in which mice are randomly assigned to one of three treatments: one hour at 14 °C, one hour at 18 °C, or one hour at 26 °C. If I model this treatment as a nominal categorical factor, then I simply have three levels. While I would certainly choose to arrange these levels in a meaningful way in a plot, for the analysis itself, these levels have no units and there is no order. <strong>Ordinal</strong> categorical factors have levels that are ordered but there is no information on relative distance. The treatment at 18 °C is not more similar to 14 °C than to 26 °C. Nominal categorical factors is the default in R and how all factors are analyzed in this text.</p>
<div id="linear-models-are-regression-models" class="section level4" number="10.1.2.1">
<h4><span class="header-section-number">10.1.2.1</span> Linear models are regression models</h4>
<p>The linear model fit to the serum TG data is</p>
<p><span class="math display" id="eq:lm-model-example-1">\[\begin{align}
serum\_tg &amp;= treatment + \varepsilon\\
\varepsilon &amp;\sim N(0, \sigma^2)
\tag{10.1}
\end{align}\]</span></p>
<p>This notation is potentially confusing because the variable <span class="math inline">\(\texttt{treatment}\)</span> is a factor containing the words “Vehicle” and “12,13-diHOME” and not numbers. The linear model in <a href="oneway.html#eq:lm-model-example-1">(10.1)</a> can be specified using notation for a regression model using</p>
<p><span class="math display" id="eq:reg-model-example-1">\[\begin{align}
serum\_tg &amp;= \beta_0 + \beta_1 treatment_{12,13-diHOME} + \varepsilon\\
\varepsilon &amp;\sim N(0, \sigma^2)
\tag{10.2}
\end{align}\]</span></p>
<p>Model <a href="oneway.html#eq:reg-model-example-1">(10.2)</a> is a regression model where <span class="math inline">\(treatment_{12,13-diHOME}\)</span> is not the variable <span class="math inline">\(\texttt{treatment}\)</span>, containing the words “Vehicle” or “12,13-diHOME” but a numeric variable that indicates membership in the group “12,13-diHOME”. This variable contains the number 1 if the mouse belongs to “12,13-diHOME” and the number 0 if the mouse doesn’t belong to “12,13-diHOME”. <span class="math inline">\(treatment_{12,13-diHOME}\)</span> is known as an <strong>indicator variable</strong> because it indicates group membership. There are several ways of coding indicator variables and the way described here is called <strong>dummy</strong> or treatment coding. Dummy-coded indicator variables are sometimes called <strong>dummy variables</strong>.</p>
<p>The <code>lm</code> function creates indicator variables under the table, in something called the <strong>model matrix</strong>.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="oneway.html#cb261-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> treatment, <span class="at">data =</span> fig_3d)</span>
<span id="cb261-2"><a href="oneway.html#cb261-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb261-3"><a href="oneway.html#cb261-3" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span><span class="sc">:</span>N,]</span></code></pre></div>
<pre><code>##    (Intercept) treatment12,13-diHOME
## 1            1                     0
## 2            1                     0
## 3            1                     0
## 4            1                     0
## 5            1                     0
## 6            1                     0
## 7            1                     1
## 8            1                     1
## 9            1                     1
## 10           1                     1
## 11           1                     1
## 12           1                     1</code></pre>
<p>The columns of the model matrix are the names of the <strong>model terms</strong> in the fit model. R names dummy variables by combining the names of the factor and the name of the level within the factor. So the <span class="math inline">\(X\)</span> variable that R creates in the model matrix for the fit linear model in model <a href="oneway.html#eq:reg-model-example-1">(10.2)</a> is <span class="math inline">\(treatment12,13-diHOME\)</span>. You can see these names as terms in the coefficient table of the fit model.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>There are alternatives to dummy coding for creating indicator variables. Dummy coding is the default in R and it makes sense when thinking about experimental data with an obvious control level. I also like the interpretation of a “interaction effect” using Dummy coding. The classical coding for ANOVA is deviation effect coding, which creates coefficients that are deviations from the grand mean. In contrast to R, Deviation coding is the default in many statistical software packages including SAS, SPSS, and JMP. The method of coding can make a difference in an ANOVA table. Watch out for this – I’ve found several published papers where the researchers used the default dummy coding but interpreted the ANOVA table as if they had used deviation coding. This is both getting ahead of ourselves and somewhat moot, because I don’t advocate reporting ANOVA tables.</p>
</div>
<p><br></p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>Recall from stats 101 that the slope of <span class="math inline">\(X\)</span> in the model <span class="math inline">\(Y = b_0 + b_1 X\)</span> is <span class="math inline">\(b_1 = \frac{\textrm{COV}(X,Y)}{\textrm{VAR}(X)}\)</span>. This can be generalized using the equation</p>
<p><span class="math display">\[\begin{equation}
\mathbf{b} = (\mathbf{X}^\top \mathbf{X})^{-1} \mathbf{X}^\top \mathbf{y}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mathbf{X}\)</span> is the model matrix containing a column for an intercept, columns for all indicator variables, and columns for all numeric covariates. <span class="math inline">\(\mathbf{b}\)</span> is a vector containing the model coefficients, including the intercept in the first element. The first part of the RHS (<span class="math inline">\(\mathbf{X}^\top \mathbf{X}\)</span>) is a matrix of the “sums of squares and cross-products” of the columns of <span class="math inline">\(\mathbf{X}\)</span>. Dividing each element of this matrix by <span class="math inline">\(N-1\)</span> gives us the covariance matrix of the <span class="math inline">\(\mathbf{X}\)</span>, which contains the variances of the <span class="math inline">\(X\)</span> columns along the diagonal, so this component has the role of the denominator in the stats 101 equation. Matrix algebra doesn’t do division, so the inverse of this matrix is multiplied by the second part. The second part or the RHS (<span class="math inline">\(\mathbf{X}^\top \mathbf{y}\)</span>) is a vector containing the cross-products of each column of <span class="math inline">\(\mathbf{X}\)</span> with <span class="math inline">\(\mathbf{y}\)</span>. Dividing each element of this vector by <span class="math inline">\(N-1\)</span> gives us the covariances of each <span class="math inline">\(X\)</span> with <span class="math inline">\(y\)</span>, so this component has the role of the numerator in the stats 101 equation.</p>
</div>
<p><br></p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>Self-learning. <code>lm</code> fits the model <code>y ~ X</code> where X is the model matrix. Fit the model using the standard formula and the model using the model matrix. The coefficient table should be the same.</p>
<p><code>m1 &lt;- lm(serum_tg ~ treatment, data = fig_3d)</code></p>
<p><code>X &lt;- model.matrix(~ treatment, data = fig_3d)</code></p>
<p><code>m2 &lt;- lm(serum_tg ~ X, data = fig_3d)</code></p>
<p><code>coef(summary(m1))</code></p>
<p><code>coef(summary(m2))</code></p>
</div>
</div>
<div id="the-estimates-in-the-coefficient-table-are-estimates-of-the-parameters-of-the-linear-model-fit-to-the-data." class="section level4" number="10.1.2.2">
<h4><span class="header-section-number">10.1.2.2</span> The Estimates in the coefficient table are estimates of the parameters of the linear model fit to the data.</h4>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std. Error
</th>
<th style="text-align:right;">
t value
</th>
<th style="text-align:right;">
Pr(&gt;|t|)
</th>
<th style="text-align:right;">
2.5 %
</th>
<th style="text-align:right;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
42.6
</td>
<td style="text-align:right;">
1.67
</td>
<td style="text-align:right;">
25.6
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
38.9
</td>
<td style="text-align:right;">
46.3
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment12,13-diHOME
</td>
<td style="text-align:right;">
-7.2
</td>
<td style="text-align:right;">
2.36
</td>
<td style="text-align:right;">
-3.0
</td>
<td style="text-align:right;">
0.0125
</td>
<td style="text-align:right;">
-12.4
</td>
<td style="text-align:right;">
-1.9
</td>
</tr>
</tbody>
</table>
<p>The row names of the coefficient table are the column names of the model matrix. These are the model terms. There are two terms (two rows) because there are two parameters in the regression model <a href="oneway.html#eq:reg-model-example-1">(10.2)</a>. The values in the column <span class="math inline">\(\texttt{Estimate}\)</span> in the coefficient table are the estimates of the regression parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. These estimates are the coefficients of the fit model, <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>.</p>
</div>
<div id="oneway-what-coefs-are" class="section level4" number="10.1.2.3">
<h4><span class="header-section-number">10.1.2.3</span> The coefficients of a linear model using dummy coding have a useful interpretation</h4>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:example1-coef-understanding">Table 10.1: </span>Understanding model coefficients of a linear model with a single treatment variable with two groups. The means in the interpretation column are conditional means.
</caption>
<thead>
<tr>
<th style="text-align:left;">
coefficient
</th>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:left;">
model term
</th>
<th style="text-align:left;">
interpretation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(b_0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\beta_0\)</span>
</td>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:left;">
<span class="math inline">\(\overline{Vehicle}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(b_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\beta_1\)</span>
</td>
<td style="text-align:left;">
treatment12,13-diHOME
</td>
<td style="text-align:left;">
<span class="math inline">\(\overline{12,13\;diHOME} - \overline{Vehicle}\)</span>
</td>
</tr>
</tbody>
</table>
<p>It is important to understand the interpretation of the coefficients of the fit linear model <a href="oneway.html#eq:lm-model-example-1">(10.1)</a> (Table <a href="oneway.html#tab:example1-coef-understanding">10.1</a>).</p>
<ol style="list-style-type: decimal">
<li>The coefficient <span class="math inline">\(b_0\)</span> is the is the conditional mean of the response for the reference level, which is “Vehicle”. Remember that a conditional mean is the mean of a group that all have the same value for one or more <span class="math inline">\(X\)</span> variables.</li>
<li>The coefficient <span class="math inline">\(b_1\)</span> is the difference between the conditional means of the “12,13-diHOME” level and the reference (“Vehicle”) level:</li>
</ol>
<p><span class="math display">\[\begin{equation}
\mathrm{E}[serum\_tg|treatment = \texttt{&quot;12,13-diHOME&quot;}] - \mathrm{E}[serum\_tg|treatment = \texttt{&quot;Vehicle&quot;}]
\end{equation}\]</span></p>
<p>Because there are no additional covariates in model, this difference is equal to the difference between the sample means <span class="math inline">\(\bar{Y}_{12,13-diHOME} - \bar{Y}_{Vehicle}\)</span>. The <em>direction</em> of this difference is important – it is non-reference level minus the reference level.</p>
<p>The estimate <span class="math inline">\(b_1\)</span> is the <strong>effect</strong> that we are interested in. Specifically, it is the measured effect of 12,13-diHOME on serum TG. When we inject 12,13-diHOME, we find the mean serum TG decreased by -7.2 µg/dL relative to the mean serum TG in the mice that were injected with saline. Importantly, the reference level is not a property of an experiment but is set by whomever is analyzing the data. Since the non-reference estimates are differences in means, it often makes sense to set the “control” treatment level as the reference level.</p>
<p>Many beginners mistakenly memorize the coefficient <span class="math inline">\(b_1\)</span> to equal the mean of the non-reference group (“12,13-diHOME”). Don’t do this. In a regression model, only <span class="math inline">\(b_0\)</span> is a mean. The coefficient <span class="math inline">\(b_1\)</span> in model <a href="oneway.html#eq:reg-model-example-1">(10.2)</a> is a difference in means.</p>
<div class="figure"><span style="display:block;" id="fig:cat-x-coef-fig"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/cat-x-coef-fig-1.png" alt="What the coefficients of a linear model with a single categorical X mean. The means of the two treatment levels for the serum TG data are shown with the large, filled circles and the dashed lines. The intercept ($b_0$) is the mean of the reference treatment level (&quot;Vehicle&quot;). The coefficient $b_1$ is the difference between the treatment level's mean and the reference mean. As with a linear model with a continuous $X$, the coefficient $b_1$ is an effect." width="576" />
<p class="caption">
Figure 10.1: What the coefficients of a linear model with a single categorical X mean. The means of the two treatment levels for the serum TG data are shown with the large, filled circles and the dashed lines. The intercept (<span class="math inline">\(b_0\)</span>) is the mean of the reference treatment level (“Vehicle”). The coefficient <span class="math inline">\(b_1\)</span> is the difference between the treatment level’s mean and the reference mean. As with a linear model with a continuous <span class="math inline">\(X\)</span>, the coefficient <span class="math inline">\(b_1\)</span> is an effect.
</p>
</div>
<p>A geometric interpretation of the coefficients is illustrated in Figure <a href="oneway.html#fig:cat-x-coef-fig">10.1</a>. <span class="math inline">\(b_0\)</span> is the conditional mean of the reference level (“Vehicle”) and is an estimate of <span class="math inline">\(\beta_0\)</span>, the true, conditional mean of the population. <span class="math inline">\(b_1\)</span> is the difference in the conditional means of the first non-reference level (“12,13-diHOME”) and the reference level (“Vehicle”) and is an estimate of <span class="math inline">\(\beta_1\)</span>, the true difference in the conditional means of the population with and without the treatment 12,13-diHOME.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>tl;dr. What is a population? In the experimental biology examples in this text, we might consider the population as a very idealized, infinitely large set of mice, or fish, or fruit flies, or communities from which our sample is a reasonably representative subset. For the experiments in the 12,13-diHOME study, the population might be conceived of as the hypothetical, infinitely large set of 12-week-old, male, C57BL/6J mice, raised in the mouse facility at Joslin Diabetes Center. An even more abstract way to way to think about what the population could be is the infinitely large set of values that could generated by the linear model.</p>
</div>
</div>
<div id="better-know-the-coefficient-table" class="section level4" number="10.1.2.4">
<h4><span class="header-section-number">10.1.2.4</span> Better know the coefficient table</h4>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="oneway.html#cb263-1" aria-hidden="true" tabindex="-1"></a>fig3d_m1_coef <span class="sc">%&gt;%</span></span>
<span id="cb263-2"><a href="oneway.html#cb263-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb263-3"><a href="oneway.html#cb263-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std. Error
</th>
<th style="text-align:right;">
t value
</th>
<th style="text-align:right;">
Pr(&gt;|t|)
</th>
<th style="text-align:right;">
2.5 %
</th>
<th style="text-align:right;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
42.6
</td>
<td style="text-align:right;">
1.67
</td>
<td style="text-align:right;">
25.6
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
38.9
</td>
<td style="text-align:right;">
46.3
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment12,13-diHOME
</td>
<td style="text-align:right;">
-7.2
</td>
<td style="text-align:right;">
2.36
</td>
<td style="text-align:right;">
-3.0
</td>
<td style="text-align:right;">
0.0125
</td>
<td style="text-align:right;">
-12.4
</td>
<td style="text-align:right;">
-1.9
</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>The <span class="math inline">\(\texttt{(Intercept)}\)</span> row contains the statistics for <span class="math inline">\(b_0\)</span> (the estimate of <span class="math inline">\(\beta_0\)</span>). Remember that <span class="math inline">\(b_0\)</span> is the conditional mean of the reference treatment (“Vehicle”).</li>
<li>The <span class="math inline">\(\texttt{treatment12,13-diHOME}\)</span> row contains the statistics for <span class="math inline">\(b_1\)</span> (the estimate of <span class="math inline">\(\beta_1\)</span>). Remember that <span class="math inline">\(b_1\)</span> is the difference in conditional means of the groups “12,13-diHOME” and “Vehicle”.</li>
<li>The column <span class="math inline">\(\texttt{Estimate}\)</span> contains the model coefficients, which are estimates of the parameters.</li>
<li>The column <span class="math inline">\(\texttt{Std. Error}\)</span> contains the model SEs of the coefficients. The SE of <span class="math inline">\(\texttt{(Intercept)}\)</span> is a standard error of a mean (SEM). The SE of <span class="math inline">\(\texttt{treatment12,13-diHOME}\)</span> is a standard error of a difference (SED).</li>
<li>The column <span class="math inline">\(\texttt{t value}\)</span> contains the test statistic of the coefficients. This value is the ratio <span class="math inline">\(\frac{Estimate}{SE}\)</span>. For this model, we are only interested in the test statistic for <span class="math inline">\(b_1\)</span>. Effectively, we will never be interested in the test statistic for <span class="math inline">\(b_0\)</span> because the mean of a group will never be zero.</li>
<li>The column <span class="math inline">\(\texttt{Pr(&gt;|t|)}\)</span> contains the <em>p</em>-values for the test statistic of the coefficients. For this model, and all models in this text, we are only interested in the <em>p</em>-value for the non-intercept coefficients.</li>
<li>The columns <span class="math inline">\(\texttt{2.5 %}\)</span> and <span class="math inline">\(\texttt{97.5 %}\)</span> contain the lower and upper limits of the 95% confidence interval of the estimate.</li>
</ol>
</div>
<div id="the-emmeans-table-is-a-table-of-modeled-means-and-inferential-statistics" class="section level4" number="10.1.2.5">
<h4><span class="header-section-number">10.1.2.5</span> The emmeans table is a table of modeled means and inferential statistics</h4>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:fig3d_m1_emm_kable)Estimated marginal means table for model fig3d_m1.
</caption>
<thead>
<tr>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:right;">
emmean
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Vehicle
</td>
<td style="text-align:right;">
42.6
</td>
<td style="text-align:right;">
1.67
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
38.9
</td>
<td style="text-align:right;">
46.3
</td>
</tr>
<tr>
<td style="text-align:left;">
12,13-diHOME
</td>
<td style="text-align:right;">
35.5
</td>
<td style="text-align:right;">
1.67
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
31.7
</td>
<td style="text-align:right;">
39.2
</td>
</tr>
</tbody>
</table>
<p>The table of marginal means for the model fit to the fig3d serum TG data (Model <a href="oneway.html#eq:lm-model-example-1">(10.1)</a>) is given in Table @ref(tab:fig3d_m1_emm_kable). The table of marginal means gives the **modeled* mean, standard error and confidence interval for all specified groups. There is no test-statistic with a <em>p</em>-value because there is no significance test. In this text, I’ll refer to this table as the “emmeans table”, since it is the output from the <code>emmeans</code> function (“em” is the abbreviation for “estimated marginal”). I’ll use “modeled means” to refer to the means themselves as these are the estimate of means from a fit linear model.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>A <strong>marginal mean</strong> is the mean over a set of conditional means. For example, if a treatment factor has three levels, the conditional means are the means for each level and the marginal mean is the mean of the three means. Or, if the conditional means are the expected values given a continous covariate, the marginal mean is the expected value at the mean of covariate. The specified emmeans table of the fig3d data is not too exciting because it simply contains the conditional means – the values are not marginalized over any <span class="math inline">\(X\)</span>. Because the emmeans table contains different sorts of means (conditional, marginal, adjusted), this text will generally refer to the means in this table as “modeled means”.</p>
</div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:cat-x-emmeans-table">Table 10.2: </span>The emmeans table contains modeled means, SE, and CIs.
</caption>
<thead>
<tr>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:right;">
emmean
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Vehicle
</td>
<td style="text-align:right;">
42.62004
</td>
<td style="text-align:right;">
1.66723
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
38.90523
</td>
<td style="text-align:right;">
46.33485
</td>
</tr>
<tr>
<td style="text-align:left;">
12,13-diHOME
</td>
<td style="text-align:right;">
35.45233
</td>
<td style="text-align:right;">
1.66723
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
31.73752
</td>
<td style="text-align:right;">
39.16714
</td>
</tr>
</tbody>
</table>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:cat-x-summary-table">Table 10.3: </span>A summary table contains sampled means, SE, and CIs.
</caption>
<thead>
<tr>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Vehicle
</td>
<td style="text-align:right;">
42.62004
</td>
<td style="text-align:right;">
1.77325
</td>
<td style="text-align:right;">
38.66899
</td>
<td style="text-align:right;">
46.57109
</td>
</tr>
<tr>
<td style="text-align:left;">
12,13-diHOME
</td>
<td style="text-align:right;">
35.45233
</td>
<td style="text-align:right;">
1.55398
</td>
<td style="text-align:right;">
31.98984
</td>
<td style="text-align:right;">
38.91482
</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>The means in the emmeans table are modeled means. Here, and for many linear models, these will be equal to the sampled means. This will not be the case in models with one or more continuous covariates, or if marginal means are explicitly specified.</li>
<li>Unlike the modeled means, the modeled standard errors and confidence intervals will, effectively, never equal sample standard errors and confidence intervals. In many models, plots using sample statistics can lead to very deceiving inference of differences between groups. This is why this text advocates plotting the model – using modeled means and confidence intervals in plots.</li>
</ol>
<p>It is exceptionally important to understand the difference between the means, SEs, and CIs in the emmeans table and the statistics of the same name in a summary table of the data.</p>
<ol style="list-style-type: decimal">
<li>The statistics in a summary table are <strong>sampled</strong> means, SEs, and CIs – these statistics are computed for the group using <em>only the data in the group</em>.</li>
<li>To understand modeled SEs and CIs, recall that the standard error of a sample mean is <span class="math inline">\(\frac{s}{\sqrt{n}}\)</span>, where <span class="math inline">\(s\)</span> is the sample standard deviation and <span class="math inline">\(n\)</span> is the sample size in the group. The computation of the SE in the emmeans table uses the same equation, except the numerator is not the sample standard deviation of the group but the model standard deviation <span class="math inline">\(\hat{\sigma}\)</span>. As with the sample SE, the denominator for the modeled SE is the sample size <span class="math inline">\(n\)</span> for the group. Since the numerator of the modeled SE is the same for all groups, the modeled SE will be the same in all groups that have the same sample size, as seen in the marginal means table for the model fit to the Figure 3d data. This is not true for sampled SEs, since sampled standard deviations will always differ.</li>
</ol>
<p>It may seem odd to use a common standard deviation in the computation of the modeled SEs. It is not. Remember that an assumption of the linear model is homogeneity of variances – that all residuals <span class="math inline">\(e_i\)</span> are drawn from the same distribution (<span class="math inline">\(N(0, \sigma^2)\)</span>) (a “single hat”) regardless of group. The model standard deviation <span class="math inline">\(\hat{\sigma}\)</span> is the estimate of the square root of the variance of this distribution. Given this interpretation, it is useful to think of each sample standard deviation as an estimate of <span class="math inline">\(\sigma\)</span> (the linear model assumes that all differences among the sample standard deviations are due entirely to sampling). The model standard deviation is a more precise estimate of <span class="math inline">\(\sigma\)</span> since it is computed from a larger sample (all <span class="math inline">\(N\)</span> residuals).</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>The model standard deviation is called the “pooled” standard deviation in the ANOVA literature and is computed as a sample-size weighted average of the sample standard deviations.</p>
</div>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>The modeled standard error of the mean uses the estimate of <span class="math inline">\(\sigma\)</span> from the fit model. This estimate is</p>
<p><span class="math display">\[\begin{equation}
\hat{\sigma} = \sqrt{\frac{\sum{(y_i - \hat{y}_i)^2}}{df}}
\end{equation}\]</span></p>
<p>Create a code chunk that computes this. Recall that <span class="math inline">\((y_i - \hat{y}_i)\)</span> is the set of residuals from the model, which can be extracted using <code>residuals(fit)</code> where “fit” is the fit model object. <span class="math inline">\(df\)</span> is the model degrees of freedom, which is <span class="math inline">\(N-k\)</span>, where <span class="math inline">\(N\)</span> is the total sample size and <span class="math inline">\(k\)</span> is the number of parameters that are fit. This makes sense – for the sample variance there is one parameter that is fit, the mean of the group. In model fig3d_m1, there are two parameters that are fit, the intercept and the coefficient of treatment12,13-diHOME.</p>
</div>
</div>
<div id="estimates-of-the-effects-are-in-the-contrasts-table" class="section level4" number="10.1.2.6">
<h4><span class="header-section-number">10.1.2.6</span> Estimates of the effects are in the contrasts table</h4>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(12,13-diHOME) - Vehicle
</td>
<td style="text-align:right;">
-7.2
</td>
<td style="text-align:right;">
2.36
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
-12.4
</td>
<td style="text-align:right;">
-1.9
</td>
<td style="text-align:right;">
-3
</td>
<td style="text-align:right;">
0.012
</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>This table is important for reporting treatment effects and CIs and for plotting the model. A contrast is a difference in means. With only two treatment levels, the table of contrasts doesn’t give any more information than the coefficient table – the single contrast is the coefficient <span class="math inline">\(b_1\)</span> in the coefficient table. Nevertheless, I advocate computing this table to stay consistent and because the script (or function) to plot the model uses this table and not the coefficient table.</li>
<li>The value in the column <span class="math inline">\(\texttt{Estimate}\)</span> is the mean of the non-reference group (“12,13-diHOME”) minus the mean of the reference group (“Vehicle”).</li>
<li>The value in the “SE” column is the standard error of the difference (SED), specifically the difference in the estimate column. This SE is computed using the model standard deviation <span class="math inline">\(\sigma\)</span>.</li>
<li>The values in the “lower.CL” and “upper.CL” columns are the bounds of the 95% confidence interval of the estimate. Remember (from Chapter <a href="#variability"><strong>??</strong></a>) to think of this interval as containing potential values of the true parameter (the true difference in means between the two groups) that are reasonably compatible with the data. Don’t think of the interval as having 95% probability of containing the true effect. Remember that a confidence interval applies to the procedure and not a parameter – 95% of the CIs from hypothetical, replicate experiments that meet all the assumptions used to compute the CI will include the true effect.</li>
<li>The columns “t.ratio” and “p.value” contains the <em>t</em> and <em>p</em> values of the significance (not hypothesis!) test of the estimate. The <em>t</em>-statistic is the ratio of the estimate to the SE of the estimate (use the console to confirm this given the values in the table). It is a signal (the estimate) to noise (SE of the estimate) ratio. The <em>p</em>-value is the probability of sampling from normal distribution with the observed standard deviation, randomly assigning the sampled values to either “Vehicle” or “12,13-diHOME”, fitting the linear model, and observing a <em>t</em>-value as or more extreme than the observed <em>t</em>. A very small <em>p</em>-value is consistent with the experiment “not sampling from distributions with the same mean” – meaning that adding a treatment affects the mean of the distribution. This is the logic used to infer a treatment effect. Unfortunately, it is also consistent with the experiment not approximating other conditions of the model, including non-random assignment, non-independence, non-normal conditional responses, and variance heterogeneity. It is up to the rigorous researcher to be sure that these other model conditions are approximated or “good enough” to use the <em>p</em>-value to infer a treatment effect on the mean.</li>
</ol>
</div>
<div id="t-and-p-from-the-contrasts-table-when-there-are-only-two-levels-in-x-are-the-same-as-t-and-p-from-a-t-test" class="section level4" number="10.1.2.7">
<h4><span class="header-section-number">10.1.2.7</span> <em>t</em> and <em>p</em> from the contrasts table – when there are only two levels in <span class="math inline">\(X\)</span> – are the same as <em>t</em> and <em>p</em> from a <em>t</em>-test</h4>
<p>Compare</p>
<p>coefficient table:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="oneway.html#cb264-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(serum_tg <span class="sc">~</span> treatment, <span class="at">data =</span> fig_3d)</span>
<span id="cb264-2"><a href="oneway.html#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(m1)) <span class="sc">%&gt;%</span></span>
<span id="cb264-3"><a href="oneway.html#cb264-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb264-4"><a href="oneway.html#cb264-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std. Error
</th>
<th style="text-align:right;">
t value
</th>
<th style="text-align:right;">
Pr(&gt;|t|)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
42.620042
</td>
<td style="text-align:right;">
1.667226
</td>
<td style="text-align:right;">
25.563447
</td>
<td style="text-align:right;">
0.000000
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment12,13-diHOME
</td>
<td style="text-align:right;">
-7.167711
</td>
<td style="text-align:right;">
2.357813
</td>
<td style="text-align:right;">
-3.039982
</td>
<td style="text-align:right;">
0.012463
</td>
</tr>
</tbody>
</table>
<p>contrast table:</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="oneway.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb265-2"><a href="oneway.html#cb265-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb265-3"><a href="oneway.html#cb265-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb265-4"><a href="oneway.html#cb265-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(12,13-diHOME) - Vehicle
</td>
<td style="text-align:right;">
-7.167711
</td>
<td style="text-align:right;">
2.357813
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
-3.039982
</td>
<td style="text-align:right;">
0.012463
</td>
</tr>
</tbody>
</table>
<p>t-test:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="oneway.html#cb266-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(fig_3d[treatment <span class="sc">==</span> <span class="st">&quot;12,13-diHOME&quot;</span>, serum_tg],</span>
<span id="cb266-2"><a href="oneway.html#cb266-2" aria-hidden="true" tabindex="-1"></a>             fig_3d[treatment <span class="sc">==</span> <span class="st">&quot;Vehicle&quot;</span>, serum_tg],</span>
<span id="cb266-3"><a href="oneway.html#cb266-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb266-4"><a href="oneway.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(m2) <span class="sc">%&gt;%</span> <span class="co"># glance is from the broom package</span></span>
<span id="cb266-5"><a href="oneway.html#cb266-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb266-6"><a href="oneway.html#cb266-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
estimate1
</th>
<th style="text-align:right;">
estimate2
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
parameter
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
<th style="text-align:left;">
method
</th>
<th style="text-align:left;">
alternative
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-7.167711
</td>
<td style="text-align:right;">
35.45233
</td>
<td style="text-align:right;">
42.62004
</td>
<td style="text-align:right;">
-3.039982
</td>
<td style="text-align:right;">
0.012463
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
-12.42125
</td>
<td style="text-align:right;">
-1.914175
</td>
<td style="text-align:left;">
Two Sample t-test
</td>
<td style="text-align:left;">
two.sided
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The default <code>t.test</code> in R is the Welch t-test for heterogenous variance. To compute the Student t-test, use <code>var.equal = TRUE</code>.</li>
<li>The “statistic” in the t-test output contains the <em>t</em>-value of the <em>t</em>-test. It is precisely the same as the <em>t</em>-statistic in the coefficient table and the contrast table.</li>
<li>The <em>p</em>-values in all three tables are precisely the same.</li>
</ol>
<p>The <em>t</em> and <em>p</em> values for the <em>t</em>-test are the same as those for the linear model, because the <em>t</em>-test is a specific case of the linear model. Reasons to abandon classic <em>t</em>-tests and learn the linear modeling strategy include</p>
<ol style="list-style-type: decimal">
<li>A linear modeling strategy encourages researchers to think about the effect and uncertainty in the effect and not just a <em>p</em>-value.</li>
<li>The linear model is nearly infinitely flexible and expandible while the <em>t</em>-test is limited to a few variations.</li>
</ol>
<p>There is rarely a reason to ever use the <code>t.test()</code> function. Throw the function away. Ignore web pages that teach you to use it. The <em>t</em>-test is easy to learn, which encourages its overuse. If your only tool is a t-test, every problem looks like a comparison between two-means.</p>
</div>
</div>
<div id="oneway-example2" class="section level3" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> Example 2 – three treatment levels (“groups”)</h3>
<div id="understand-the-experiment-design" class="section level4" number="10.1.3.1">
<h4><span class="header-section-number">10.1.3.1</span> Understand the experiment design</h4>
<p>The data come from the experiment reported in Figure 2a of the 12,13-diHOME article described above. This experiment was designed to probe the hypothesis that 12,13-diHOME is a mediator of known stimulators of increased BAT activity (exposure to cold temperature and sympathetic nervous system activation). Mice were assigned to control (30 °C), one-hour exposure to 4 °C, or 30 minute norepinephrine (NE) treatment level (NE is the neurotransmitter of the sympathetic neurons targeting peripheral tissues).</p>
<p><strong>response variable</strong>: <span class="math inline">\(\texttt{diHOME}\)</span>, the serum concentration of 12,13-diHOME. a continuous variable.</p>
<p><strong>treatment variable</strong>: <span class="math inline">\(\texttt{treatment}\)</span>, with levels: “Control”, “1 hour cold”, “30 min NE”. Coded as a factor.</p>
<ol style="list-style-type: decimal">
<li>“Control” – the negative control. We expect diHOME to be low relative to the two treated conditions.</li>
<li>“1 hour cold” – focal treatment 1. If diHOME is a mediator, then response should be relatively high.</li>
<li>“30 min NE” – focal treatment 2. If diHOME is a mediator, then response should be relatively high.</li>
</ol>
<p><strong>planned comparisons</strong></p>
<ol style="list-style-type: decimal">
<li>“1 hour cold” - “Control” – If diHOME is a mediator of cold, then difference should be positive.</li>
<li>“30 min NE” - “Control” – If diHOME is a mediator of NE, then difference should be positive.</li>
</ol>
<p><strong>design</strong>: single, categorical <em>X</em></p>
</div>
<div id="fig2a-m1" class="section level4" number="10.1.3.2">
<h4><span class="header-section-number">10.1.3.2</span> fit the model</h4>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="oneway.html#cb267-1" aria-hidden="true" tabindex="-1"></a>fig2a_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(diHOME <span class="sc">~</span> treatment, <span class="at">data =</span> fig2a)</span></code></pre></div>
</div>
<div id="check-the-model" class="section level4" number="10.1.3.3">
<h4><span class="header-section-number">10.1.3.3</span> check the model</h4>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="oneway.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb268-2"><a href="oneway.html#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(fig2a_m1)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-132-1.png" width="576" /></p>
<pre><code>## [1]  3 18</code></pre>
<p>The Q-Q plot indicates potential issues at the extreme quantiles, what is called “heavy tails”. The two values are the extreme values in the “30 min NE” group. This could be the result of a small sample from a response with a larger variance.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="oneway.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spreadLevelPlot</span>(fig2a_m1, <span class="at">id=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-133-1.png" width="576" /></p>
<pre><code>## 
## Suggested power transformation:  0.4430799</code></pre>
<p>The combination of the raw residuals and the spread-level plot suggests heterogeneity but low confidence in anything given the small sample size.</p>
</div>
<div id="inference-from-the-model-1" class="section level4" number="10.1.3.4">
<h4><span class="header-section-number">10.1.3.4</span> Inference from the model</h4>
<div id="coefficient-table-1" class="section level5" number="10.1.3.4.1">
<h5><span class="header-section-number">10.1.3.4.1</span> coefficient table</h5>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="oneway.html#cb272-1" aria-hidden="true" tabindex="-1"></a>fig2a_m1_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(fig2a_m1)),</span>
<span id="cb272-2"><a href="oneway.html#cb272-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">confint</span>(fig2a_m1))</span>
<span id="cb272-3"><a href="oneway.html#cb272-3" aria-hidden="true" tabindex="-1"></a>fig2a_m1_coef <span class="sc">%&gt;%</span></span>
<span id="cb272-4"><a href="oneway.html#cb272-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb272-5"><a href="oneway.html#cb272-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std. Error
</th>
<th style="text-align:right;">
t value
</th>
<th style="text-align:right;">
Pr(&gt;|t|)
</th>
<th style="text-align:right;">
2.5 %
</th>
<th style="text-align:right;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
12.0
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:right;">
3.9
</td>
<td style="text-align:right;">
0.0016
</td>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
18.6
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment1 hour cold
</td>
<td style="text-align:right;">
7.1
</td>
<td style="text-align:right;">
4.57
</td>
<td style="text-align:right;">
1.6
</td>
<td style="text-align:right;">
0.1405
</td>
<td style="text-align:right;">
-2.7
</td>
<td style="text-align:right;">
16.9
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment30 min NE
</td>
<td style="text-align:right;">
14.8
</td>
<td style="text-align:right;">
4.36
</td>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:right;">
0.0044
</td>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
24.1
</td>
</tr>
</tbody>
</table>
</div>
<div id="emmeans-table-1" class="section level5" number="10.1.3.4.2">
<h5><span class="header-section-number">10.1.3.4.2</span> emmeans table</h5>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="oneway.html#cb273-1" aria-hidden="true" tabindex="-1"></a>fig2a_m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(fig2a_m1, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb273-2"><a href="oneway.html#cb273-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-3"><a href="oneway.html#cb273-3" aria-hidden="true" tabindex="-1"></a>fig2a_m1_emm <span class="sc">%&gt;%</span></span>
<span id="cb273-4"><a href="oneway.html#cb273-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb273-5"><a href="oneway.html#cb273-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:right;">
emmean
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
12.0
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
18.6
</td>
</tr>
<tr>
<td style="text-align:left;">
1 hour cold
</td>
<td style="text-align:right;">
19.2
</td>
<td style="text-align:right;">
3.38
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
11.9
</td>
<td style="text-align:right;">
26.4
</td>
</tr>
<tr>
<td style="text-align:left;">
30 min NE
</td>
<td style="text-align:right;">
26.8
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
20.2
</td>
<td style="text-align:right;">
33.4
</td>
</tr>
</tbody>
</table>
</div>
<div id="contrasts-table-1" class="section level5" number="10.1.3.4.3">
<h5><span class="header-section-number">10.1.3.4.3</span> contrasts table</h5>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="oneway.html#cb274-1" aria-hidden="true" tabindex="-1"></a>fig2a_m1_planned <span class="ot">&lt;-</span> <span class="fu">contrast</span>(fig2a_m1_emm,</span>
<span id="cb274-2"><a href="oneway.html#cb274-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">&quot;trt.vs.ctrl&quot;</span>,</span>
<span id="cb274-3"><a href="oneway.html#cb274-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb274-4"><a href="oneway.html#cb274-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">level =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span></span>
<span id="cb274-5"><a href="oneway.html#cb274-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb274-6"><a href="oneway.html#cb274-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-7"><a href="oneway.html#cb274-7" aria-hidden="true" tabindex="-1"></a>fig2a_m1_planned <span class="sc">%&gt;%</span></span>
<span id="cb274-8"><a href="oneway.html#cb274-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb274-9"><a href="oneway.html#cb274-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1 hour cold - Control
</td>
<td style="text-align:right;">
7.1
</td>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
-2.7
</td>
<td style="text-align:right;">
16.9
</td>
<td style="text-align:right;">
1.56
</td>
<td style="text-align:right;">
0.1405
</td>
</tr>
<tr>
<td style="text-align:left;">
30 min NE - Control
</td>
<td style="text-align:right;">
14.8
</td>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
24.1
</td>
<td style="text-align:right;">
3.40
</td>
<td style="text-align:right;">
0.0044
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="plot-the-model" class="section level4" number="10.1.3.5">
<h4><span class="header-section-number">10.1.3.5</span> plot the model</h4>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="oneway.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_the_model</span>(</span>
<span id="cb275-2"><a href="oneway.html#cb275-2" aria-hidden="true" tabindex="-1"></a>  fig2a_m1,</span>
<span id="cb275-3"><a href="oneway.html#cb275-3" aria-hidden="true" tabindex="-1"></a>  fig2a_m1_emm,</span>
<span id="cb275-4"><a href="oneway.html#cb275-4" aria-hidden="true" tabindex="-1"></a>  fig2a_m1_planned,</span>
<span id="cb275-5"><a href="oneway.html#cb275-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend_position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb275-6"><a href="oneway.html#cb275-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="st">&quot;12,13-diHOME (pmol/mL)&quot;</span>,</span>
<span id="cb275-7"><a href="oneway.html#cb275-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">effect_label =</span> <span class="st">&quot;Effects (pmol/mL)&quot;</span>,</span>
<span id="cb275-8"><a href="oneway.html#cb275-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb275-9"><a href="oneway.html#cb275-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>)</span>
<span id="cb275-10"><a href="oneway.html#cb275-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-136-1.png" width="576" /></p>
</div>
<div id="report-the-model-results" class="section level4" number="10.1.3.6">
<h4><span class="header-section-number">10.1.3.6</span> Report the model results</h4>
<p>Compared to control mice (12.0 pmol/mL, 95% CI: 5.4, 18.6), mean serum 12,13-diHOME in mice exposed to one-hour cold (19.2 pmol/mL, 95% CI: 11.9, 26.4) was 7.1 pmol/mL higher (95% CI: -2.7, 16.9, <span class="math inline">\(p = 0.14\)</span>) while mean Serum 12,13-diHOME in mice exposed to 30 minutes NE (26.8 pmol/mL, 95% CI: 20.2, 33.3) was 14.8 pmol/mL higher (95% CI: 5.4, 24.1 <span class="math inline">\(p = 0.004\)</span>).</p>
</div>
</div>
<div id="understanding-the-analysis-with-three-or-more-treatment-levels" class="section level3" number="10.1.4">
<h3><span class="header-section-number">10.1.4</span> Understanding the analysis with three (or more) treatment levels</h3>
<div id="better-know-the-coefficient-table-1" class="section level4" number="10.1.4.1">
<h4><span class="header-section-number">10.1.4.1</span> Better know the coefficient table</h4>
<p>The fit regression model for the data in Figure 2a is</p>
<p><span class="math display" id="eq:fit-dihome">\[\begin{equation}
diHOME_i = b_0 + b_1 treatment_{1\_hour\_cold,i} + b_2 treatment_{30\_min\_NE,i} + e_i
\tag{10.3}
\end{equation}\]</span></p>
<p>The coefficients of the model are in the <span class="math inline">\(\texttt{Estimate}\)</span> column of the coefficient table.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std. Error
</th>
<th style="text-align:right;">
t value
</th>
<th style="text-align:right;">
Pr(&gt;|t|)
</th>
<th style="text-align:right;">
2.5 %
</th>
<th style="text-align:right;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
12.0
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
3.9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
18.6
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment1 hour cold
</td>
<td style="text-align:right;">
7.1
</td>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
1.6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-2.7
</td>
<td style="text-align:right;">
16.9
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment30 min NE
</td>
<td style="text-align:right;">
14.8
</td>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
24.1
</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>The <span class="math inline">\(\texttt{(Intercept)}\)</span> row contains the statistics for <span class="math inline">\(b_0\)</span> (the estimate of <span class="math inline">\(\beta_0\)</span>). Here, <span class="math inline">\(b_0\)</span> is the mean of the reference group, which is “Control”.</li>
<li>The <span class="math inline">\(\texttt{treatment1 hour cold}\)</span> row contains the statistics for <span class="math inline">\(b_1\)</span> (the estimate of <span class="math inline">\(\beta_1\)</span>). Here, <span class="math inline">\(b_1\)</span> is the difference <span class="math inline">\(\mathrm{E}[diHOME|treatment = \texttt{&quot;1 hour cold&quot;}] - \mathrm{E}[diHOME|treatment = \texttt{&quot;Control&quot;}]\)</span>. This difference in conditional means is equal to the difference in the sample means of the two groups <em>for this model</em> because there are no additional covariates in the model.</li>
<li>The <span class="math inline">\(\texttt{treatment30 min NE}\)</span> row contains the statistics for <span class="math inline">\(b_2\)</span> (the estimate of <span class="math inline">\(\beta_2\)</span>). Here, <span class="math inline">\(b_2\)</span> is the difference <span class="math inline">\(\mathrm{E}[diHOME|treatment = \texttt{&quot;30 min NE&quot;}] - \mathrm{E}[diHOME|treatment = \texttt{&quot;Control&quot;}]\)</span>. Do not make the mistake in thinking that the value in <span class="math inline">\(\texttt{Estimate}\)</span> is the mean of the “30 min NE” group.</li>
<li>The number of non-intercept coefficients generalizes to any number of levels of the factor variable. If there are <span class="math inline">\(k\)</span> levels of the factor, there are <span class="math inline">\(k-1\)</span> indicator variables, each with its own coefficient (<span class="math inline">\(b_1\)</span> through <span class="math inline">\(b_{k-1}\)</span>) estimating the effect of that treatment level relative to the control (if using dummy coding).</li>
</ol>
<p>Again – Do not make the mistake in thinking that the values in <span class="math inline">\(\texttt{Estimate}\)</span> for the <span class="math inline">\(\texttt{treatment1 hour cold}\)</span> and <span class="math inline">\(\texttt{treatment30 min NE}\)</span> rows are the <em>means</em> of the “1 hour cold” and “30 min NE” groups. These coefficients are differences in means. And, to emphasize further understanding of these coefficients, both <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> are “slopes”. Don’t visualize this as a single line from the control mean through both non-control means. as two lines. Slopes is plural – there are two regression lines. <span class="math inline">\(b_1\)</span> is the slope of the line from the control mean to the “1 hour cold” mean. <span class="math inline">\(b_2\)</span> is the slope of the line from the control mean to the “30 min NE” mean. The numerator of each slope is the difference between that group’s mean and the control mean. The denominator of each slope is 1 (because each has the value 1 when the row is assigned to that group).</p>
<p>Two understand the names of the model terms, it’s useful to recall the order of the factor levels of <span class="math inline">\(\texttt{treatment}\)</span>, which is</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="oneway.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(fig2a<span class="sc">$</span>treatment) </span></code></pre></div>
<pre><code>## [1] &quot;Control&quot;     &quot;1 hour cold&quot; &quot;30 min NE&quot;</code></pre>
<p>Given this ordering, the <code>lm</code> function creates a regression model with an intercept column for the “Control” group (because it is first in the list), an indicator variable for the “1 hour cold” group called <code>treatment1 hour cold</code>, and an indicator variable for the “30 min NE” group called <code>treatment30 min NE</code>. We can see these model names by peeking at the model matrix of the fit model</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="oneway.html#cb278-1" aria-hidden="true" tabindex="-1"></a>fig2a_m1_X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(fig2a_m1)</span>
<span id="cb278-2"><a href="oneway.html#cb278-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-3"><a href="oneway.html#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fig2a_m1_X)</span></code></pre></div>
<pre><code>##   (Intercept) treatment1 hour cold treatment30 min NE
## 1           1                    0                  0
## 2           1                    1                  0
## 3           1                    0                  1
## 4           1                    0                  0
## 5           1                    1                  0
## 6           1                    0                  1</code></pre>
<p>The column <span class="math inline">\(\texttt{treatment1 hour cold}\)</span> is a dummy-coded indicator variable containing the number 1, if the individual is in the “1 hour cold” group, or the number 0, otherwise. The column <span class="math inline">\(\texttt{treatment30 min NE}\)</span> is a dummy-coded indicator variable containing the number 1, if the individual is in the “30 min NE” group, or the number 0, otherwise.</p>
<p>The model coefficients, parameters, model term, and interpretation are summarized in the following table.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-139">Table 10.4: </span>Understanding model coefficients of a linear model with a single treatment variable with three groups. The means in the interpreation column are conditional means.
</caption>
<thead>
<tr>
<th style="text-align:left;">
coefficient
</th>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:left;">
model term
</th>
<th style="text-align:left;">
interpretation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(b_0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\beta_0\)</span>
</td>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:left;">
<span class="math inline">\(\overline{Control}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(b_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\beta_1\)</span>
</td>
<td style="text-align:left;">
treatment1 hour cold
</td>
<td style="text-align:left;">
<span class="math inline">\(\overline{1\;hour\;cold} - \overline{Control}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(b_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\beta_2\)</span>
</td>
<td style="text-align:left;">
treatment30 min NE
</td>
<td style="text-align:left;">
<span class="math inline">\(\overline{30\;min\;NE} - \overline{Control}\)</span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="the-emmeans-table" class="section level4" number="10.1.4.2">
<h4><span class="header-section-number">10.1.4.2</span> The emmeans table</h4>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:right;">
emmean
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
12.0
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
18.6
</td>
</tr>
<tr>
<td style="text-align:left;">
1 hour cold
</td>
<td style="text-align:right;">
19.2
</td>
<td style="text-align:right;">
3.38
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
11.9
</td>
<td style="text-align:right;">
26.4
</td>
</tr>
<tr>
<td style="text-align:left;">
30 min NE
</td>
<td style="text-align:right;">
26.8
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
20.2
</td>
<td style="text-align:right;">
33.4
</td>
</tr>
</tbody>
</table>
<p>This table is important for reporting means and CIs and for plotting the model. As in example 1, the values in the column “emmean” are the sample means of each group (what you would compute if you simply computed the mean for that group). Again, this is true for this model, but is not generally true.</p>
<p>And again, as in example 1, the SE for each mean is <em>not</em> the sample SE but the modeled SE – it is computed from the residuals of the model and is an estimate of <span class="math inline">\(\sigma\)</span>. <em>These are the SEs that you should report</em> because it is these SEs that are used to compute the <em>p</em>-value and CI that you report, that is, they tell the same “story”. The SE for the “1 hour cold” group is a bit higher because the sample size <span class="math inline">\(n\)</span> for this group is smaller by 1.</p>
</div>
<div id="the-contrasts-table" class="section level4" number="10.1.4.3">
<h4><span class="header-section-number">10.1.4.3</span> The contrasts table</h4>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1 hour cold - Control
</td>
<td style="text-align:right;">
7.1
</td>
<td style="text-align:right;">
4.57
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
-2.7
</td>
<td style="text-align:right;">
16.9
</td>
<td style="text-align:right;">
1.6
</td>
<td style="text-align:right;">
0.1405
</td>
</tr>
<tr>
<td style="text-align:left;">
30 min NE - Control
</td>
<td style="text-align:right;">
14.8
</td>
<td style="text-align:right;">
4.36
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
24.1
</td>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:right;">
0.0044
</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>This table is important for reporting treatment effects and CIs and for plotting the model. A contrast is a difference in means.</li>
<li>The contrast table here has no more information than is in the coefficient table, but that is not generally true for models with treatment factors with more than two groups. In “Working in R” below, I show how to compute a contrast table with all pairwise comparisons (contrasts between all possible pairings of the groups)</li>
<li>The column <span class="math inline">\(\texttt{Contrast}\)</span> contains the names of the contrasts. Note that the name gives the direction of the difference.</li>
<li>The values in the column <span class="math inline">\(\texttt{estimate}\)</span> are the contrasts. These are the differences in the conditional means of the groups identified in the <span class="math inline">\(\texttt{Contrast}\)</span> column. These are the <strong>effects</strong> that we are interested in.</li>
<li>The value in the “SE” column is the standard error of the difference (SED) of each contrast. This SE is computed using the model standard deviation <span class="math inline">\(\sigma\)</span>.</li>
<li>The values in the “lower.CL” and “upper.CL” columns are the bounds of the 95% confidence interval of the estimate. Remember (from Chapter <a href="#variability"><strong>??</strong></a>) to think of this interval as containing potential values of the true parameter (the true difference in means between the two groups) that are reasonably compatible with the data. Don’t think of the interval as having 95% probability of containing the true effect. Remember that a confidence interval applies to the procedure and not a parameter – 95% of the CIs from hypothetical, replicate experiments that meet all the assumptions used to compute the CI will include the true effect.</li>
<li>The columns “t.ratio” and “p.value” contains the <em>t</em> and <em>p</em> values of the significance (not hypothesis!) test of the estimate. The <em>t</em>-statistic is the ratio of the estimate to the SE of the estimate (use the console to confirm this given the values in the table). It is a signal (the estimate) to noise (SE of the estimate) ratio. The <em>p</em>-value is the probability of sampling from normal distribution with the observed standard deviation, randomly assigning the sampled values to the three groups (using the original sample sizes for each), fitting the linear model, and observing a <em>t</em>-value as or more extreme than the observed <em>t</em>. A very small <em>p</em>-value is consistent with the experiment “not sampling from distributions with the same mean” – meaning that adding a treatment affects the mean of the distribution. This is the logic used to infer a treatment effect. Unfortunately, it is also consistent with the experiment not approximating other conditions of the model, including non-random assignment, non-independence, non-normal conditional responses, and variance heterogeneity. It is up to the rigorous researcher to be sure that these other model conditions are approximated or “good enough” to use the <em>p</em>-value to infer a treatment effect on the mean.</li>
</ol>
</div>
<div id="oneway-ttest" class="section level4" number="10.1.4.4">
<h4><span class="header-section-number">10.1.4.4</span> <em>t</em> and <em>p</em> from the contrasts table – when there are more than two levels in <span class="math inline">\(X\)</span> – are not the same as those from pairwise <em>t</em>-tests among pairs of groups</h4>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="oneway.html#cb280-1" aria-hidden="true" tabindex="-1"></a>fig2a_m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(fig2a_m1_emm,</span>
<span id="cb280-2"><a href="oneway.html#cb280-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb280-3"><a href="oneway.html#cb280-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb280-4"><a href="oneway.html#cb280-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The chunk above computes a contrast table that includes comparisons of all pairs of groups in the factor <span class="math inline">\(\texttt{treatment}\)</span> (this adds a 3rd comparison to the contrast table of planned comparisons above). The <em>t</em>-tests for the contrasts are derived from a single fit linear model.</p>
<p>In contrast to the analysis in the chunk above, researchers commonly fit separate <em>t</em>-tests for each pair of treatment levels.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="oneway.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># classic t-test</span></span>
<span id="cb281-2"><a href="oneway.html#cb281-2" aria-hidden="true" tabindex="-1"></a>test1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(fig2a[treatment <span class="sc">==</span> <span class="st">&quot;1 hour cold&quot;</span>, diHOME],</span>
<span id="cb281-3"><a href="oneway.html#cb281-3" aria-hidden="true" tabindex="-1"></a>                fig2a[treatment <span class="sc">==</span> <span class="st">&quot;Control&quot;</span>, diHOME],</span>
<span id="cb281-4"><a href="oneway.html#cb281-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb281-5"><a href="oneway.html#cb281-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-6"><a href="oneway.html#cb281-6" aria-hidden="true" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(fig2a[treatment <span class="sc">==</span> <span class="st">&quot;30 min NE&quot;</span>, diHOME],</span>
<span id="cb281-7"><a href="oneway.html#cb281-7" aria-hidden="true" tabindex="-1"></a>                fig2a[treatment <span class="sc">==</span> <span class="st">&quot;Control&quot;</span>, diHOME],</span>
<span id="cb281-8"><a href="oneway.html#cb281-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb281-9"><a href="oneway.html#cb281-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-10"><a href="oneway.html#cb281-10" aria-hidden="true" tabindex="-1"></a>test3 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(fig2a[treatment <span class="sc">==</span> <span class="st">&quot;30 min NE&quot;</span>, diHOME],</span>
<span id="cb281-11"><a href="oneway.html#cb281-11" aria-hidden="true" tabindex="-1"></a>                fig2a[treatment <span class="sc">==</span> <span class="st">&quot;1 hour cold&quot;</span>, diHOME],</span>
<span id="cb281-12"><a href="oneway.html#cb281-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>Again, the default t.test in R is the Welch t-test for heterogenous variance. To compute the Student t-test, use <code>var.equal = TRUE</code></li>
<li>To see the full <code>t.test</code> output, type “test1” into the console.</li>
</ol>
<p>Compare the <em>t</em> and <em>p</em> values from the three independent tests with the <em>t</em> and <em>p</em>-values from the single linear model.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
t (lm)
</th>
<th style="text-align:right;">
p (lm)
</th>
<th style="text-align:right;">
t (t-test)
</th>
<th style="text-align:right;">
p (t-test)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1 hour cold - Control
</td>
<td style="text-align:right;">
1.562324
</td>
<td style="text-align:right;">
0.1405278
</td>
<td style="text-align:right;">
2.415122
</td>
<td style="text-align:right;">
0.0389207
</td>
</tr>
<tr>
<td style="text-align:left;">
30 min NE - 1 hour cold
</td>
<td style="text-align:right;">
1.674696
</td>
<td style="text-align:right;">
0.1161773
</td>
<td style="text-align:right;">
1.380666
</td>
<td style="text-align:right;">
0.2007006
</td>
</tr>
<tr>
<td style="text-align:left;">
30 min NE - Control
</td>
<td style="text-align:right;">
3.395015
</td>
<td style="text-align:right;">
0.0043559
</td>
<td style="text-align:right;">
3.238158
</td>
<td style="text-align:right;">
0.0088971
</td>
</tr>
</tbody>
</table>
<p>The <em>t</em> and <em>p</em>-values computed from three separate tests differ from the <em>t</em> and <em>p</em>-values computed from the single linear model shown in the contrasts table above. The values differ because the SE in the denominators used to compute the <span class="math inline">\(t\)</span>-values differ. The linear model uses the same value of <span class="math inline">\(\sigma\)</span> to compute the SED (the denominator of <em>t</em>) for all three t-tests in the contrast table. Each separate t-test uses a different value of <span class="math inline">\(\sigma\)</span> to compute the SED. Which is correct? Neither – they simply make different assumptions about the data generating model.</p>
<ol style="list-style-type: decimal">
<li>Most importantly, <strong>never</strong> do both methods, look at the <em>p</em>-values, and then convince yourself that the method with the <em>p</em>-values that match your hypothesis is the correct method. Human brains are very, very good at doing this. This is called p-hacking. When you p-hack, the interpretation of the <em>p</em>-value is effectively meaningless. P-hacking leads to irreproducible science.</li>
<li>In general, using the linear model is a better practice than the separate <em>t</em>-tests. The reason is the homogeneity of variance assumption. If we assume homogeneity of variances, then we can think of the sample standard deviation of all three groups as an estimate of <span class="math inline">\(\sigma\)</span>. In the linear model, we use three groups to estimate <span class="math inline">\(\sigma\)</span> but in each separate <em>t</em>-test, we use only two groups. Consequently, our estimate of <span class="math inline">\(\sigma\)</span> in the linear model is more precise than that in the <em>t</em>-tests. While the difference can be large with any individual data set (it’s pretty big with the fig2a data), the long-run advantage of using the linear model instead of separate <em>t</em>-tests is pretty small, especially with only three groups (the precision increases with more groups).</li>
<li>We can drop the homogeneity of variance assumption with either the linear model or the three, separate <em>t</em>-tests. This is outlined below in “Heterogeneity of variance”. In this case, the <em>t</em> and <em>p</em>-values for the three comparisons are the same. Still, the linear model (that models heterogenity) is better practice than the separate <em>t</em>-tests because the linear model is much more flexible and expandable.</li>
</ol>
</div>
<div id="the-contrasts-table-when-there-are-more-than-two-levels-in-x-has-multiple-p-values.-how-to-handle-this-multiple-testing-is-highly-controversial" class="section level4" number="10.1.4.5">
<h4><span class="header-section-number">10.1.4.5</span> The contrasts table – when there are more than two levels in <span class="math inline">\(X\)</span> – has multiple p-values. How to handle this “multiple testing” is highly controversial</h4>
<p><strong>Multiple testing</strong> is the practice of adjusting <em>p</em>-values and confidence intervals to account for the expected increase in the frequency of Type I error in a batch, or <em>family</em>, of tests. Multiple testing is a concept that exists because of Neyman-Pearson hypothesis testing strategy. If multiple tests are used to answer the same question then, these are in the same family. Issues surrounding multiple testing are fleshed out in more detail in Chapter xxx “Best Practices”. Computing adjusted values is covered below in the “Working in R” section.</p>
</div>
</div>
</div>
<div id="working-in-r-2" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Working in R</h2>
<div id="fit-the-model-1" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Fit the model</h3>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="oneway.html#cb282-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(diHOME <span class="sc">~</span> treatment, <span class="at">data =</span> fig2a)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>As described in <a href="plotting-models.html#fit-the-model">Fitting the linear model</a>, <code>diHOME ~ treatment</code> is the model formula. All functions that will be used to fit models in this text will use a model formula. Many base R and package functions that are meant to be either “easy” or follow an ANOVA strategy use lists of dependent and independent variables instead of a model formula. We won’t use these because they are not consistent with a linear modeling way of thinking about data analysis.</li>
<li><span class="math inline">\(\texttt{treatment}\)</span> was specifically coded as a factor variable in the import and wrangle chunk and R will automatically create the correct indicator variables. If categorical variables on the RHS of the formula have not be converted to factors by the user, then R will treat character variables as factors and create the indicator variables. If the categorical variable is numeric (for example, the variable <code>time</code> might have levels 1, 2, 3 instead of “1 hour”, “2 hours”, “three hours”), R will treat the variable as numeric and not create the indicator variables. A user could use the formula <code>y ~ factor(time)</code> to force R to create the indicator variable. I prefer to explicitly create a version of the variable that is recoded as factor using something like <code>dt[, time_fac := factor(time, levels = c("1", "2", "3"))]</code>.</li>
</ol>
</div>
<div id="controlling-the-output-in-tables-using-the-coefficient-table-as-an-example" class="section level3" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Controlling the output in tables using the coefficient table as an example</h3>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="oneway.html#cb283-1" aria-hidden="true" tabindex="-1"></a>m1_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(m1)),</span>
<span id="cb283-2"><a href="oneway.html#cb283-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">confint</span>(m1))</span>
<span id="cb283-3"><a href="oneway.html#cb283-3" aria-hidden="true" tabindex="-1"></a>m1_coef</span></code></pre></div>
<pre><code>##                       Estimate Std. Error  t value    Pr(&gt;|t|)     2.5 %
## (Intercept)          12.023075   3.081337 3.901902 0.001595771  5.414264
## treatment1 hour cold  7.140386   4.570362 1.562324 0.140527829 -2.662066
## treatment30 min NE   14.794354   4.357669 3.395015 0.004355868  5.448083
##                        97.5 %
## (Intercept)          18.63189
## treatment1 hour cold 16.94284
## treatment30 min NE   24.14063</code></pre>
<p>The standard print of the <code>m1_coef</code> object is too long for the display and often wraps when printed on the display, which can make it hard to read. I use <code>knitr::kable</code> to print the table with fewer decimal places and <code>kableExtra::kable_styling</code> to make it a little prettier.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="oneway.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the row names are not part of the m1_coef object</span></span>
<span id="cb285-2"><a href="oneway.html#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="co"># so there is no digit designation for this column</span></span>
<span id="cb285-3"><a href="oneway.html#cb285-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-4"><a href="oneway.html#cb285-4" aria-hidden="true" tabindex="-1"></a>m1_coef <span class="sc">%&gt;%</span> <span class="co"># pipe the m1_coef object to kable</span></span>
<span id="cb285-5"><a href="oneway.html#cb285-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb285-6"><a href="oneway.html#cb285-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std. Error
</th>
<th style="text-align:right;">
t value
</th>
<th style="text-align:right;">
Pr(&gt;|t|)
</th>
<th style="text-align:right;">
2.5 %
</th>
<th style="text-align:right;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
12.02
</td>
<td style="text-align:right;">
3.081
</td>
<td style="text-align:right;">
3.902
</td>
<td style="text-align:right;">
0.00160
</td>
<td style="text-align:right;">
5.41
</td>
<td style="text-align:right;">
18.63
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment1 hour cold
</td>
<td style="text-align:right;">
7.14
</td>
<td style="text-align:right;">
4.570
</td>
<td style="text-align:right;">
1.562
</td>
<td style="text-align:right;">
0.14053
</td>
<td style="text-align:right;">
-2.66
</td>
<td style="text-align:right;">
16.94
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment30 min NE
</td>
<td style="text-align:right;">
14.79
</td>
<td style="text-align:right;">
4.358
</td>
<td style="text-align:right;">
3.395
</td>
<td style="text-align:right;">
0.00436
</td>
<td style="text-align:right;">
5.45
</td>
<td style="text-align:right;">
24.14
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="oneway.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explore other styles in the kableExtra package</span></span></code></pre></div>
</div>
<div id="using-the-emmeans-function" class="section level3" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Using the emmeans function</h3>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="oneway.html#cb287-1" aria-hidden="true" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb287-2"><a href="oneway.html#cb287-2" aria-hidden="true" tabindex="-1"></a>m1_emm</span></code></pre></div>
<pre><code>##  treatment   emmean   SE df lower.CL upper.CL
##  Control       12.0 3.08 14     5.41     18.6
##  1 hour cold   19.2 3.38 14    11.92     26.4
##  30 min NE     26.8 3.08 14    20.21     33.4
## 
## Confidence level used: 0.95</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>Note that printing the <code>emmeans</code> object displays useful information. Here, this information includes the confidence level used. If the object is printed using <code>kable</code> (as in the “Inference” and “Understanding” sections above), only the table is printed and the additional information is lost.</li>
<li><code>emmeans</code> computes the modeled means of all combinations of the levels of the factor variables specified in <code>specs</code>.</li>
<li>If there are two factor variables in the model, and both are passed to <code>specs</code>, then the modeled means of all combinations of the levels of the two variables are computed. If only one factor variable is passed, then the marginal means (averaged over all levels of the missing factor) are computed. This will become more clear in the chapter “Models for two (or more) categorical X variables”.</li>
<li>If there are continuous covariates in the model, the modeled means are computed at the average values of these covariates. These covariates do not need to be passed to the <code>specs</code> argument.</li>
<li>You can pass numeric and integer covariates to <code>specs</code> to control the value of the covariates used compute the modeled means. This is outlined in <a href="chapter-covariates">Adding covariates to a linear model</a></li>
</ol>
</div>
<div id="using-the-contrast-function" class="section level3" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Using the contrast function</h3>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="oneway.html#cb289-1" aria-hidden="true" tabindex="-1"></a>m1_planned <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb289-2"><a href="oneway.html#cb289-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;trt.vs.ctrl&quot;</span>,</span>
<span id="cb289-3"><a href="oneway.html#cb289-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb289-4"><a href="oneway.html#cb289-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">level =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span></span>
<span id="cb289-5"><a href="oneway.html#cb289-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb289-6"><a href="oneway.html#cb289-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-7"><a href="oneway.html#cb289-7" aria-hidden="true" tabindex="-1"></a>m1_planned</span></code></pre></div>
<pre><code>##  contrast              estimate   SE df lower.CL upper.CL t.ratio p.value
##  1 hour cold - Control     7.14 4.57 14    -2.66     16.9   1.562  0.1405
##  30 min NE - Control      14.79 4.36 14     5.45     24.1   3.395  0.0044
## 
## Confidence level used: 0.95</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>Note that printing the <code>contrast</code> object displays useful information, including the confidence level used and the method of adjustment for multiple tests. If the object is printed using <code>kable() %&gt;% kable_styling()</code> (as in the “Inference” and “Understanding” sections above), only the table is printed and the additional information is lost.</li>
<li>The <code>method</code> argument is used to control the set of contrasts that are computed. See below.</li>
<li>The <code>adjust</code> argument controls if and how to adjust for multiple tests. Each <code>method</code> has a default adjustment method. See below.</li>
<li>The <code>level</code> argument controls the percentile boundaries of the confidence interval. The default is 0.95. Including this argument with this value makes this level transparent.</li>
</ol>
<div id="method-argument" class="section level4" number="10.2.4.1">
<h4><span class="header-section-number">10.2.4.1</span> method argument</h4>
<p>The <code>method =</code> argument is used to control the set of contrasts that are computed. Type <code>help("contrast-methods")</code> into the console to see the list of available methods. Also, read the <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html" target="_blank">comparisons and contrasts vignette</a> for more on <code>emmeans::contrast()</code></p>
<ol style="list-style-type: decimal">
<li><code>method = "trt.vs.ctrl"</code> computes all non-reference minus reference contrasts. This method was used in the “Inference” section because it gives the two contrasts of the planned comparisons identified in the “understand the experimental design” step.</li>
<li>The default adjustment for multiple tests is “dunnettx”, which is <a href="https://en.wikipedia.org/wiki/Dunnett%27s_test" target="_blank">Dunnett’s test</a>. “none” was specified in the inference section because both comparisons were planned.</li>
</ol>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="oneway.html#cb291-1" aria-hidden="true" tabindex="-1"></a>m1_tukey <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb291-2"><a href="oneway.html#cb291-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb291-3"><a href="oneway.html#cb291-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">adjust =</span> <span class="st">&quot;tukey&quot;</span>,</span>
<span id="cb291-4"><a href="oneway.html#cb291-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">level =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span></span>
<span id="cb291-5"><a href="oneway.html#cb291-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb291-6"><a href="oneway.html#cb291-6" aria-hidden="true" tabindex="-1"></a>m1_tukey</span></code></pre></div>
<pre><code>##  contrast                estimate   SE df lower.CL upper.CL t.ratio p.value
##  1 hour cold - Control       7.14 4.57 14    -4.82     19.1   1.562  0.2936
##  30 min NE - Control        14.79 4.36 14     3.39     26.2   3.395  0.0114
##  30 min NE - 1 hour cold     7.65 4.57 14    -4.31     19.6   1.675  0.2490
## 
## Confidence level used: 0.95 
## Conf-level adjustment: tukey method for comparing a family of 3 estimates 
## P value adjustment: tukey method for comparing a family of 3 estimates</code></pre>
<ol style="list-style-type: decimal">
<li>Both <code>method = "pairwise"</code> and <code>method = "revpairwise"</code> compute all pairwise comparisons. I prefer “revpairwise” because the contrasts that include the reference are in the direction non-reference minus reference.</li>
<li>The default adjustment for multiple tests is “tukey”, which is the <a href="https://en.wikipedia.org/wiki/Tukey%27s_range_test" target="_blank">Tukey’s HSD method</a>.</li>
</ol>
</div>
<div id="adjustment-for-multiple-tests" class="section level4" number="10.2.4.2">
<h4><span class="header-section-number">10.2.4.2</span> Adjustment for multiple tests</h4>
<p>See the Section <a href="factorial.html#twoway-multiple-tests">15.8.3</a> in the chapter “Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models” for a more thorough explanation of the <em>p</em>-value adjustment for multiple tests that arise if an experiment has more than two treatment groups. Here, I just outline choices available in the <code>emmeans::contrast</code> function.</p>
<ol style="list-style-type: decimal">
<li>“none” – no adjustment</li>
<li>“dunnettx” – <a href="https://en.wikipedia.org/wiki/Dunnett%27s_test" target="_blank">Dunnett’s test</a> is a method used when comparing all treatments to a single control.</li>
<li>“tukey” – <a href="https://en.wikipedia.org/wiki/Tukey%27s_range_test" target="_blank">Tukey’s HSD method</a> is a method used to compare all pairwise comparisons.</li>
<li>“bonferroni” – <a href="https://en.wikipedia.org/wiki/Bonferroni_correction" target="_blank">Bonferroni</a> is a general purpose method to compare any set of multiple tests. The test is conservative. A better method is “holm”</li>
<li>“holm” – <a href="https://en.wikipedia.org/wiki/Holm–Bonferroni_method" target="_blank">Holm-Bonferroni</a> is a general purpose method like the Bonferroni but is more powerful.</li>
<li>“fdr” – controls the <a href="https://en.wikipedia.org/wiki/False_discovery_rate" target="_blank">false discovery rate</a> not the Type I error rate for a family of tests. One might use this in an exploratory experiment.</li>
<li>“mvt” – based on the multivariate <em>t</em> distribution and using covariance structure of the variables.</li>
</ol>
</div>
<div id="planned-comparisons-using-custom-contrasts" class="section level4" number="10.2.4.3">
<h4><span class="header-section-number">10.2.4.3</span> Planned comparisons using custom contrasts</h4>
<p>With any but purely exploratory experiment, we have certain contrasts that test the focal hypotheses. We care little to none about other contrasts. We can limit the contrasts computed using <code>emmeans::contrast()</code> by passing custom contrasts to <code>method</code>.</p>
<ol style="list-style-type: decimal">
<li>create a set of vectors with as many elements as there are rows in the emmeans table. Name each vector using the (or a) group name for the row in the emmeans table. For the vector created for row <em>j</em>, set the value of the <em>j</em>th element to 1 and set all other values to zero.</li>
<li>create a list of contrasts, with each set in the list the difference of two of the named vectors from step 1.</li>
</ol>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="oneway.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># m1_emm # print in console to get row numbers</span></span>
<span id="cb293-2"><a href="oneway.html#cb293-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set the mean as the row number from the emmeans table</span></span>
<span id="cb293-3"><a href="oneway.html#cb293-3" aria-hidden="true" tabindex="-1"></a>cn <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># control is in row 1</span></span>
<span id="cb293-4"><a href="oneway.html#cb293-4" aria-hidden="true" tabindex="-1"></a>cold <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>) <span class="co"># cold in in row 2</span></span>
<span id="cb293-5"><a href="oneway.html#cb293-5" aria-hidden="true" tabindex="-1"></a>ne <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="co"># ne is in row 3</span></span>
<span id="cb293-6"><a href="oneway.html#cb293-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-7"><a href="oneway.html#cb293-7" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts are the difference in the vectors created above</span></span>
<span id="cb293-8"><a href="oneway.html#cb293-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the focal contrasts are in the understand the experimental</span></span>
<span id="cb293-9"><a href="oneway.html#cb293-9" aria-hidden="true" tabindex="-1"></a><span class="co"># design section</span></span>
<span id="cb293-10"><a href="oneway.html#cb293-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. (cold - cn) </span></span>
<span id="cb293-11"><a href="oneway.html#cb293-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. (ne - cn)</span></span>
<span id="cb293-12"><a href="oneway.html#cb293-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-13"><a href="oneway.html#cb293-13" aria-hidden="true" tabindex="-1"></a>planned_contrasts <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb293-14"><a href="oneway.html#cb293-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Cold - Cn&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(cold <span class="sc">-</span> cn),</span>
<span id="cb293-15"><a href="oneway.html#cb293-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;NE - Cn&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(ne <span class="sc">-</span> cn)</span>
<span id="cb293-16"><a href="oneway.html#cb293-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb293-17"><a href="oneway.html#cb293-17" aria-hidden="true" tabindex="-1"></a>m1_planned <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb293-18"><a href="oneway.html#cb293-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> planned_contrasts,</span>
<span id="cb293-19"><a href="oneway.html#cb293-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb293-20"><a href="oneway.html#cb293-20" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb293-21"><a href="oneway.html#cb293-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb293-22"><a href="oneway.html#cb293-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-23"><a href="oneway.html#cb293-23" aria-hidden="true" tabindex="-1"></a>m1_planned <span class="sc">%&gt;%</span></span>
<span id="cb293-24"><a href="oneway.html#cb293-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb293-25"><a href="oneway.html#cb293-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
t.ratio
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Cold - Cn
</td>
<td style="text-align:right;">
7.1
</td>
<td style="text-align:right;">
4.57
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
-2.7
</td>
<td style="text-align:right;">
16.9
</td>
<td style="text-align:right;">
1.6
</td>
<td style="text-align:right;">
0.1405
</td>
</tr>
<tr>
<td style="text-align:left;">
NE - Cn
</td>
<td style="text-align:right;">
14.8
</td>
<td style="text-align:right;">
4.36
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
24.1
</td>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:right;">
0.0044
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="how-to-generate-anova-tables" class="section level3" number="10.2.5">
<h3><span class="header-section-number">10.2.5</span> How to generate ANOVA tables</h3>
<p>ANOVA is Analysis of Variance. Researchers frequently use the term “ANOVA” as the name for an analysis of an experiment with single-factor with more than two groups. However, ANOVA is a general method of inference for complex experimental designs. ANOVA models and regression models are different ways of expressing the same underlying linear model.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:fig2a-anova-table">Table 10.5: </span>ANOVA table for the Figure 2a (example 2) data.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
F value
</th>
<th style="text-align:right;">
Pr(&gt;F)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
656.9
</td>
<td style="text-align:right;">
328.4
</td>
<td style="text-align:right;">
5.765
</td>
<td style="text-align:right;">
0.015
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
797.5
</td>
<td style="text-align:right;">
57.0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>Do not confuse the statistics in an ANOVA table with those in a coefficient table.</li>
<li>The ANOVA table <a href="oneway.html#tab:fig2a-anova-table">10.5</a> has two rows. The first row contains the statistics for the factor <span class="math inline">\(\texttt{treatment}\)</span>. The statistics address the null hypothesis “there is no effect of treatment – all groups have the same population mean”. This is a <em>p</em> value about the factor as a whole and not the individual comparisons of different groups within the factor.</li>
<li>The second row contains the statistics for the error – the residuals of the model.</li>
<li><span class="math inline">\(\texttt{F value}\)</span> is the test statistic. It is a ratio of variances, which is why this analysis is called Analysis of Variance. The numerator variance is the <span class="math inline">\(\texttt{Mean Sq}\)</span> of <span class="math inline">\(\texttt{treatment}\)</span>. The numerator variance is the value in $ of <span class="math inline">\(\texttt{treatment}\)</span>. The denominator variance is the value in $ of <span class="math inline">\(\texttt{Residuals}\)</span>.</li>
<li><span class="math inline">\(\texttt{Mean Sq}\)</span> contains the <strong>mean square</strong> for each term (row) in the table. The mean square is a variance. Remember that the numerator of a variance is a sum of squared differences between observed and mean values. The numerator of <span class="math inline">\(\texttt{Mean Sq}\)</span> is the value in <span class="math inline">\(\texttt{Sum Sq}\)</span> from the same row. And, remember that the denominator of a variance is a degree of freedom. The denominator of <span class="math inline">\(\texttt{Mean Sq}\)</span> is the value in <span class="math inline">\(\texttt{DF}\)</span> from the same row.</li>
</ol>
<p>An ANOVA table for a single factor with more than two groups has a single <em>p</em>-value for the treatment term. The single <em>p</em>-value is the probability of sampling a value of <em>F</em> as large or larger than the observed <em>F</em> under the null (no true effects of either treatment and all specifications of the generating model are true). There is not much we can do with this number - we want to estimate the effect sizes and their uncertainty and we don’t get this from an ANOVA table. Many textbooks, websites, and colleagues suggest to 1) fit the ANOVA, 2) check the <em>F</em>, and, if <span class="math inline">\(F &lt; 0.05\)</span>, 3) do “tests after an ANOVA”. These tests after an ANOVA are the planned comparisons and post-hoc tests described above using the linear model. In classical ANOVA, the initial computation of the cell means (means of treatment combinations) and sums of squares was a logical first step to the decomposition of these sums of squares to compute the contrasts. With modern linear models using regression, the ANOVA first step is unnecessary and not recommended.</p>
<p>If your PI, manager, thesis committee, or journal editor insists that you do ANOVA, and you cannot convince them otherwise, here is how to generate an ANOVA table in R. Note that even though we are generating that table, the computation of the contrast table and all inference from that is not part of the ANOVA.</p>
<div id="the-afex-aov_4-function" class="section level4" number="10.2.5.1">
<h4><span class="header-section-number">10.2.5.1</span> The afex aov_4 function</h4>
<p>The package afex was developed to make it much easier for researchers to generate ANOVA tables that look like those from other statistics packages including SAS, SPSS, JMP, and Graphpad Prism.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="oneway.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .I is a data.table function that returns the row number</span></span>
<span id="cb294-2"><a href="oneway.html#cb294-2" aria-hidden="true" tabindex="-1"></a>fig2a[, fake_id <span class="sc">:</span><span class="er">=</span> <span class="fu">paste</span>(<span class="st">&quot;mouse&quot;</span>, .I)]</span>
<span id="cb294-3"><a href="oneway.html#cb294-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-4"><a href="oneway.html#cb294-4" aria-hidden="true" tabindex="-1"></a>m1_aov4 <span class="ot">&lt;-</span> <span class="fu">aov_4</span>(diHOME <span class="sc">~</span> treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>fake_id),</span>
<span id="cb294-5"><a href="oneway.html#cb294-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> fig2a)</span>
<span id="cb294-6"><a href="oneway.html#cb294-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-7"><a href="oneway.html#cb294-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1_aov4)</span></code></pre></div>
<pre><code>## Anova Table (Type 3 tests)
## 
## Response: diHOME
##           num Df den Df    MSE      F     ges  Pr(&gt;F)  
## treatment      2     14 56.968 5.7651 0.45163 0.01491 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>The afex package has three function names for generating the same ANOVA table and statistics – here I’m using <code>aov_4</code> because this functions uses a linear model formula argument (specifically, that used in the lme4 package), which is consistent with the rest of this text.</li>
<li>The formula includes the addition of a random factor (<code>(1|id)</code>) even though there really is no random factor in this model. See Section <a href="violations.html#oneway-paired-t">12.1</a> below for a brief explanation of a random factor. The random factor (the factor variable “id” created in the line before the fit model line) identifies the individual mouse from which the response variable was measured. Because the response was only measured once on each individual mouse, “id” is not really a random factor but the addition of this in the model formula is necessary for the <code>aov_4</code> function to work.</li>
<li>It is easy to get an ANOVA table that you don’t want in R. If you want an ANOVA table that matches one from Graphpad Prism or JMP or similar software, the best practice is using the ANOVA functions from the afex package.</li>
<li>What do I mean by “an ANOVA table that you don’t want”? With factorial ANOVA with unbalanced data, there are three ways to compute the sums of squares for the different terms of the ANOVA table. SAS termed these Type I, II, and III sums of squares and these names have stuck. Following SAS, almost all statistics packages use Type III as the default (or only) method for computing ANOVA tables. R uses Type I as the default. There are very good arguments for using Type II. This distinction is moot for single factor ANOVA or multi-factor ANOVA for balanced designs but is not moot for unbalanced multi-factor ANOVA or any ANOVA with covariates. If you want an ANOVA table from R to match what would be generated by Graphpad Prism or JMP (Type III), then the afex package is the best practice.</li>
</ol>
</div>
<div id="the-car-anova-function" class="section level4" number="10.2.5.2">
<h4><span class="header-section-number">10.2.5.2</span> The car Anova function</h4>
<p>The car package has the extremely useful <code>Anova</code> function although using it is a bit like doing brain surgery having only watched a youtube video.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="oneway.html#cb296-1" aria-hidden="true" tabindex="-1"></a>type3 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">treatment =</span> contr.sum)</span>
<span id="cb296-2"><a href="oneway.html#cb296-2" aria-hidden="true" tabindex="-1"></a>m1_type3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(diHOME <span class="sc">~</span> treatment,</span>
<span id="cb296-3"><a href="oneway.html#cb296-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> fig2a,</span>
<span id="cb296-4"><a href="oneway.html#cb296-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">contrasts =</span> type3)</span>
<span id="cb296-5"><a href="oneway.html#cb296-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m1_type3, <span class="at">type=</span><span class="st">&quot;3&quot;</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: diHOME
##             Sum Sq Df  F value   Pr(&gt;F)    
## (Intercept) 6308.4  1 110.7355 4.95e-08 ***
## treatment    656.9  2   5.7651  0.01491 *  
## Residuals    797.5 14                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li><code>car::Anova</code> has arguments for reporting the Type III sum of squares. Again, this is not relevant to a single factor ANOVA with no covariates but to avoid catastrophic code in the future, its good to know about best practices now, so I’m pre-peating what is written in Section <a href="factorial.html#twoway-car-anova">15.11.4.2</a>.</li>
<li>Background: The default model matrix in the <code>lm</code> function uses dummy (or treatment) coding. For a Type 3 SS ANOVA (the kind that matches that in Graphpad Prism or JMP), we need to tell <code>lm</code> to use sum (or deviation) coding.</li>
<li>The best practice method for changing the contrasts in the model matrix is using the <code>contrasts</code> argument within the <code>lm</code> function, as in the code above to fit <code>m1_type3</code>. This is the safest practice because this sets the contrasts only for this specific fit.</li>
<li>The coefficients of <code>m1_type3</code> will be different from <code>m1</code>. The intercept will be the grand mean and the coefficients of the non-reference levels (the effects) will be their deviations from the grand mean. I don’t find this definition of “effects” very useful for most experiments in biology.</li>
<li>The contrasts (differences in the means among pairs of groups) in the contrast table will be the same, regardless of the contrast coding.</li>
</ol>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>Danger!. Many online sites suggest this bit of code before a Type III ANOVA using car::Anova:</p>
<p><code>options(contrasts = c("contr.sum", "contr.poly")</code></p>
<p>If you’re reading this book, you almost certainly don’t want to do this because this code resets how R computes coefficients of linear models and SS of ANOVA tables. This will effect all future analysis until the contrasts are set to something else or a new R session is started.</p>
</div>
<p><strong>base R aov and anova</strong></p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="oneway.html#cb298-1" aria-hidden="true" tabindex="-1"></a>m1_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(diHOME <span class="sc">~</span> treatment, <span class="at">data =</span> fig2a)</span>
<span id="cb298-2"><a href="oneway.html#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1_aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## treatment    2  656.9   328.4   5.765 0.0149 *
## Residuals   14  797.5    57.0                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 1 observation deleted due to missingness</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="oneway.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same as m1 in the Example 2 section</span></span>
<span id="cb300-2"><a href="oneway.html#cb300-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(diHOME <span class="sc">~</span> treatment, <span class="at">data =</span> fig2a)</span>
<span id="cb300-3"><a href="oneway.html#cb300-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: diHOME
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)  
## treatment  2 656.85  328.43  5.7651 0.01491 *
## Residuals 14 797.55   56.97                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>Many introduction to statistics textbooks and websites use the base R <code>aov</code> function. I don’t find this function useful given the afex package functions.</li>
<li>The base R <code>anova</code> is useful if you know what you are doing with it.</li>
</ol>
</div>
</div>
</div>
<div id="hidden-code-2" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Hidden Code</h2>
<div id="importing-and-wrangling-the-fig_3d-data-for-example-1" class="section level3" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Importing and wrangling the fig_3d data for example 1</h3>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="oneway.html#cb302-1" aria-hidden="true" tabindex="-1"></a>data_folder <span class="ot">&lt;-</span> <span class="st">&quot;data&quot;</span></span>
<span id="cb302-2"><a href="oneway.html#cb302-2" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;The cold-induced lipokine 12,13-diHOME promotes fatty acid transport into brown adipose tissue&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="oneway.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># need data_folder and data_from from earlier chunk</span></span>
<span id="cb303-2"><a href="oneway.html#cb303-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41591_2017_BFnm4297_MOESM3_ESM.xlsx&quot;</span></span>
<span id="cb303-3"><a href="oneway.html#cb303-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb303-4"><a href="oneway.html#cb303-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-5"><a href="oneway.html#cb303-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ignore the column with animal ID. Based on methods, I am inferring</span></span>
<span id="cb303-6"><a href="oneway.html#cb303-6" aria-hidden="true" tabindex="-1"></a><span class="co"># that the six mice in vehicle group *are different* from the</span></span>
<span id="cb303-7"><a href="oneway.html#cb303-7" aria-hidden="true" tabindex="-1"></a><span class="co"># six mice in the 1213 group.</span></span>
<span id="cb303-8"><a href="oneway.html#cb303-8" aria-hidden="true" tabindex="-1"></a>col_names_3d <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Vehicle&quot;</span>, <span class="st">&quot;1213&quot;</span>)</span>
<span id="cb303-9"><a href="oneway.html#cb303-9" aria-hidden="true" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Vehicle&quot;</span>, <span class="st">&quot;12,13-diHOME&quot;</span>)</span>
<span id="cb303-10"><a href="oneway.html#cb303-10" aria-hidden="true" tabindex="-1"></a>fig_3d <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb303-11"><a href="oneway.html#cb303-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sheet =</span> <span class="st">&quot;Figure 3d&quot;</span>,</span>
<span id="cb303-12"><a href="oneway.html#cb303-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">range =</span> <span class="st">&quot;B3:C9&quot;</span>,</span>
<span id="cb303-13"><a href="oneway.html#cb303-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb303-14"><a href="oneway.html#cb303-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb303-15"><a href="oneway.html#cb303-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">measure.vars =</span> col_names_3d,</span>
<span id="cb303-16"><a href="oneway.html#cb303-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">variable.name =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb303-17"><a href="oneway.html#cb303-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">value.name =</span> <span class="st">&quot;serum_tg&quot;</span>)</span>
<span id="cb303-18"><a href="oneway.html#cb303-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-19"><a href="oneway.html#cb303-19" aria-hidden="true" tabindex="-1"></a><span class="co"># change group name of &quot;1213&quot;</span></span>
<span id="cb303-20"><a href="oneway.html#cb303-20" aria-hidden="true" tabindex="-1"></a>fig_3d[treatment <span class="sc">==</span> <span class="st">&quot;1213&quot;</span>, treatment <span class="sc">:</span><span class="er">=</span> <span class="st">&quot;12,13-diHOME&quot;</span>]</span>
<span id="cb303-21"><a href="oneway.html#cb303-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-22"><a href="oneway.html#cb303-22" aria-hidden="true" tabindex="-1"></a><span class="co"># make treatment a factor with the order in &quot;treatment_levels&quot;</span></span>
<span id="cb303-23"><a href="oneway.html#cb303-23" aria-hidden="true" tabindex="-1"></a>fig_3d[, treatment <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(treatment, treatment_levels)]</span>
<span id="cb303-24"><a href="oneway.html#cb303-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-25"><a href="oneway.html#cb303-25" aria-hidden="true" tabindex="-1"></a><span class="co">#View(fig_3d)</span></span></code></pre></div>
</div>
<div id="importing-and-wrangling-the-fig2a-data-for-example-2" class="section level3" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> Importing and wrangling the fig2a data for example 2</h3>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="oneway.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co"># need data_folder and data_from from earlier chunk</span></span>
<span id="cb304-2"><a href="oneway.html#cb304-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41591_2017_BFnm4297_MOESM2_ESM.xlsx&quot;</span></span>
<span id="cb304-3"><a href="oneway.html#cb304-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb304-4"><a href="oneway.html#cb304-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-5"><a href="oneway.html#cb304-5" aria-hidden="true" tabindex="-1"></a><span class="co"># assuming mice are independent and not same mouse used for all three treatment</span></span>
<span id="cb304-6"><a href="oneway.html#cb304-6" aria-hidden="true" tabindex="-1"></a>melt_col_names <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Animal&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb304-7"><a href="oneway.html#cb304-7" aria-hidden="true" tabindex="-1"></a>fig2a <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb304-8"><a href="oneway.html#cb304-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sheet =</span> <span class="st">&quot;Fig 2a&quot;</span>,</span>
<span id="cb304-9"><a href="oneway.html#cb304-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">range =</span> <span class="st">&quot;A3:G6&quot;</span>,</span>
<span id="cb304-10"><a href="oneway.html#cb304-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb304-11"><a href="oneway.html#cb304-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb304-12"><a href="oneway.html#cb304-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">measure.vars =</span> melt_col_names,</span>
<span id="cb304-13"><a href="oneway.html#cb304-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">variable.name =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb304-14"><a href="oneway.html#cb304-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">value.name =</span> <span class="st">&quot;diHOME&quot;</span>) <span class="co"># cannot start a variable with number</span></span>
<span id="cb304-15"><a href="oneway.html#cb304-15" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(fig2a, <span class="at">old =</span> <span class="fu">colnames</span>(fig2a)[<span class="dv">1</span>], <span class="at">new =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb304-16"><a href="oneway.html#cb304-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-17"><a href="oneway.html#cb304-17" aria-hidden="true" tabindex="-1"></a>treatment_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;1 hour cold&quot;</span>, <span class="st">&quot;30 min NE&quot;</span>)</span>
<span id="cb304-18"><a href="oneway.html#cb304-18" aria-hidden="true" tabindex="-1"></a>fig2a[, treatment <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(treatment, treatment_order)] <span class="co"># order levels</span></span>
<span id="cb304-19"><a href="oneway.html#cb304-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-20"><a href="oneway.html#cb304-20" aria-hidden="true" tabindex="-1"></a><span class="co">#View(fig2a)</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-checking.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/24-categorical_X.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
