<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data – Reading, Wrangling, and Writing | Statistics for the Experimental Biologist</title>
  <meta name="description" content="An introduction to statistical modeling for experimental biology researchers" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data – Reading, Wrangling, and Writing | Statistics for the Experimental Biologist" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data – Reading, Wrangling, and Writing | Statistics for the Experimental Biologist" />
  
  <meta name="twitter:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="part-ii-r-fundamentals.html"/>
<link rel="next" href="plotting-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistics for the Experimental Biologist</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-bother-with-linear-regession-models-arent-t-tests-and-anova-good-enough"><i class="fa fa-check"></i>Why bother with linear (regession!) models – aren’t <em>t</em>-tests and ANOVA good enough?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-unusual-about-this-book"><i class="fa fa-check"></i>What is unusual about this book?</a></li>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#motivations"><i class="fa fa-check"></i><b>0.1</b> Motivations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-table-of-models.html"><a href="a-table-of-models.html"><i class="fa fa-check"></i>A Table of Models</a>
<ul>
<li class="chapter" data-level="" data-path="a-table-of-models.html"><a href="a-table-of-models.html#including-mapping-between-linear-models-and-classical-tests"><i class="fa fa-check"></i>including mapping between linear models and classical tests</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ask1-intro.html"><a href="ask1-intro.html"><i class="fa fa-check"></i><b>1</b> Analyzing experimental data with a linear model</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ask1-intro.html"><a href="ask1-intro.html#this-text-is-about-using-linear-models-to-estimate-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect"><i class="fa fa-check"></i><b>1.1</b> This text is about using linear models to estimate treatment effects and the uncertainty in our estimates. This, raises the question, what is “an effect”?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-getting-started.html"><a href="part-i-getting-started.html"><i class="fa fa-check"></i>Part I: Getting Started</a></li>
<li class="chapter" data-level="2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html"><i class="fa fa-check"></i><b>2</b> Getting Started – R Projects and R Markdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-vs-r-studio"><i class="fa fa-check"></i><b>2.1</b> R vs R Studio</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#download-and-install-r-and-r-studio"><i class="fa fa-check"></i><b>2.2</b> Download and install R and R studio</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#open-r-studio-and-modify-the-workspace-preference"><i class="fa fa-check"></i><b>2.3</b> Open R Studio and modify the workspace preference</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it"><i class="fa fa-check"></i><b>2.4</b> If you didn’t modify the workspace preferences from the previous section, go back and do it</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-markdown-in-a-nutshell"><i class="fa fa-check"></i><b>2.5</b> R Markdown in a nutshell</a></li>
<li class="chapter" data-level="2.6" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#install-r-markdown"><i class="fa fa-check"></i><b>2.6</b> Install R Markdown</a></li>
<li class="chapter" data-level="2.7" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#importing-packages"><i class="fa fa-check"></i><b>2.7</b> Importing Packages</a></li>
<li class="chapter" data-level="2.8" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#setup-create-project"><i class="fa fa-check"></i><b>2.8</b> Create an R Studio Project for this textbook</a></li>
<li class="chapter" data-level="2.9" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#working-on-a-project-in-a-nutshell"><i class="fa fa-check"></i><b>2.9</b> Working on a project, in a nutshell</a></li>
<li class="chapter" data-level="2.10" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#setup-create-rmd"><i class="fa fa-check"></i><b>2.10</b> Create and setup an R Markdown document (Rmd)</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#modify-the-yaml-header"><i class="fa fa-check"></i><b>2.10.1</b> Modify the yaml header</a></li>
<li class="chapter" data-level="2.10.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#modify-the-setup-chunk"><i class="fa fa-check"></i><b>2.10.2</b> Modify the “setup” chunk</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#lets-play-around-with-an-r-markdown-file"><i class="fa fa-check"></i><b>2.11</b> Let’s play around with an R Markdown file</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-fake-data-chunk"><i class="fa fa-check"></i><b>2.11.1</b> Create a “fake-data” chunk</a></li>
<li class="chapter" data-level="2.11.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-plot-chunk"><i class="fa fa-check"></i><b>2.11.2</b> Create a “plot” chunk</a></li>
<li class="chapter" data-level="2.11.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#knit-the-rmd"><i class="fa fa-check"></i><b>2.11.3</b> Knit the Rmd</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-r-fundamentals.html"><a href="part-ii-r-fundamentals.html"><i class="fa fa-check"></i>Part II: R fundamentals</a></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data – Reading, Wrangling, and Writing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#data-long"><i class="fa fa-check"></i><b>3.1</b> Long data format – the way data should be</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#data-here"><i class="fa fa-check"></i><b>3.2</b> Use the here function to construct the file path</a></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#learning-from-this-chapter"><i class="fa fa-check"></i><b>3.3</b> Learning from this chapter</a></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#data-working-in-r"><i class="fa fa-check"></i><b>3.4</b> Working in R</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data.html"><a href="data.html#importing-data"><i class="fa fa-check"></i><b>3.4.1</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data.html"><a href="data.html#data-wrangling"><i class="fa fa-check"></i><b>3.5</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data.html"><a href="data.html#reshaping-data-wide-to-long"><i class="fa fa-check"></i><b>3.5.1</b> Reshaping data – Wide to long</a></li>
<li class="chapter" data-level="3.5.2" data-path="data.html"><a href="data.html#reshaping-data-transpose-turning-the-columns-into-rows"><i class="fa fa-check"></i><b>3.5.2</b> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li class="chapter" data-level="3.5.3" data-path="data.html"><a href="data.html#combining-data"><i class="fa fa-check"></i><b>3.5.3</b> Combining data</a></li>
<li class="chapter" data-level="3.5.4" data-path="data.html"><a href="data.html#data-subset"><i class="fa fa-check"></i><b>3.5.4</b> Subsetting data</a></li>
<li class="chapter" data-level="3.5.5" data-path="data.html"><a href="data.html#wrangling-columns"><i class="fa fa-check"></i><b>3.5.5</b> Wrangling columns</a></li>
<li class="chapter" data-level="3.5.6" data-path="data.html"><a href="data.html#missing-data"><i class="fa fa-check"></i><b>3.5.6</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data.html"><a href="data.html#saving-data"><i class="fa fa-check"></i><b>3.6</b> Saving data</a></li>
<li class="chapter" data-level="3.7" data-path="data.html"><a href="data.html#exercises"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting-models.html"><a href="plotting-models.html"><i class="fa fa-check"></i><b>4</b> Plotting Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data"><i class="fa fa-check"></i><b>4.1</b> Pretty good plots show the model and the data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot"><i class="fa fa-check"></i><b>4.1.1</b> Pretty good plot component 1: Modeled effects plot</a></li>
<li class="chapter" data-level="4.1.2" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot"><i class="fa fa-check"></i><b>4.1.2</b> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li class="chapter" data-level="4.1.3" data-path="plotting-models.html"><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><i class="fa fa-check"></i><b>4.1.3</b> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
<li class="chapter" data-level="4.1.4" data-path="plotting-models.html"><a href="plotting-models.html#some-comments-on-plot-components"><i class="fa fa-check"></i><b>4.1.4</b> Some comments on plot components</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="plotting-models.html"><a href="plotting-models.html#working-in-r"><i class="fa fa-check"></i><b>4.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="plotting-models.html"><a href="plotting-models.html#source-data"><i class="fa fa-check"></i><b>4.2.1</b> Source data</a></li>
<li class="chapter" data-level="4.2.2" data-path="plotting-models.html"><a href="plotting-models.html#how-to-plot-the-model"><i class="fa fa-check"></i><b>4.2.2</b> How to plot the model</a></li>
<li class="chapter" data-level="4.2.3" data-path="plotting-models.html"><a href="plotting-models.html#be-sure-ggplot_the_model-is-in-your-r-folder"><i class="fa fa-check"></i><b>4.2.3</b> Be sure ggplot_the_model is in your R folder</a></li>
<li class="chapter" data-level="4.2.4" data-path="plotting-models.html"><a href="plotting-models.html#how-to-use-the-plot-the-model-functions"><i class="fa fa-check"></i><b>4.2.4</b> How to use the Plot the Model functions</a></li>
<li class="chapter" data-level="4.2.5" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-a-response-plot-using-ggpubr"><i class="fa fa-check"></i><b>4.2.5</b> How to generate a Response Plot using ggpubr</a></li>
<li class="chapter" data-level="4.2.6" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2"><i class="fa fa-check"></i><b>4.2.6</b> How to generate a Response Plot with a grid of treatments using ggplot2</a></li>
<li class="chapter" data-level="4.2.7" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-an-effects-plot"><i class="fa fa-check"></i><b>4.2.7</b> How to generate an Effects Plot</a></li>
<li class="chapter" data-level="4.2.8" data-path="plotting-models.html"><a href="plotting-models.html#how-to-combine-the-response-and-effects-plots"><i class="fa fa-check"></i><b>4.2.8</b> How to combine the response and effects plots</a></li>
<li class="chapter" data-level="4.2.9" data-path="plotting-models.html"><a href="plotting-models.html#how-to-add-the-interaction-effect-to-response-and-effects-plots"><i class="fa fa-check"></i><b>4.2.9</b> How to add the interaction effect to response and effects plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-some-fundamentals-of-statistical-modeling.html"><a href="part-iii-some-fundamentals-of-statistical-modeling.html"><i class="fa fa-check"></i>Part III: Some Fundamentals of Statistical Modeling</a></li>
<li class="chapter" data-level="5" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>5</b> Variability and Uncertainty (Standard Deviations, Standard Errors, and Confidence Intervals)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="uncertainty.html"><a href="uncertainty.html#standard-errors-are-used-to-compute-p-values-and-confidence-intervals"><i class="fa fa-check"></i><b>5.1</b> Standard errors are used to compute <em>p</em>-values and confidence intervals</a></li>
<li class="chapter" data-level="5.2" data-path="uncertainty.html"><a href="uncertainty.html#background"><i class="fa fa-check"></i><b>5.2</b> Background</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="uncertainty.html"><a href="uncertainty.html#sample-standard-deviation"><i class="fa fa-check"></i><b>5.2.1</b> Sample standard deviation</a></li>
<li class="chapter" data-level="5.2.2" data-path="uncertainty.html"><a href="uncertainty.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.2.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="uncertainty.html"><a href="uncertainty.html#simulations-using-fake-data-as-an-intuition-pump"><i class="fa fa-check"></i><b>5.3</b> Simulations – using fake data as an intuition pump</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="uncertainty.html"><a href="uncertainty.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.3.1</b> Using Google Sheets to generate fake data to explore the standard error</a></li>
<li class="chapter" data-level="5.3.2" data-path="uncertainty.html"><a href="uncertainty.html#using-r-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.3.2</b> Using R to generate fake data to explore the standard error</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="uncertainty.html"><a href="uncertainty.html#bootstrap"><i class="fa fa-check"></i><b>5.4</b> Bootstrapped standard errors</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="uncertainty.html"><a href="uncertainty.html#an-example-of-bootstrapped-standard-errors"><i class="fa fa-check"></i><b>5.4.1</b> An example of bootstrapped standard errors</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="uncertainty.html"><a href="uncertainty.html#confidence-intervals"><i class="fa fa-check"></i><b>5.5</b> Confidence Intervals</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="uncertainty.html"><a href="uncertainty.html#just-the-math"><i class="fa fa-check"></i><b>5.5.1</b> Just the math</a></li>
<li class="chapter" data-level="5.5.2" data-path="uncertainty.html"><a href="uncertainty.html#interpretation-of-a-confidence-interval"><i class="fa fa-check"></i><b>5.5.2</b> Interpretation of a confidence interval</a></li>
<li class="chapter" data-level="5.5.3" data-path="uncertainty.html"><a href="uncertainty.html#bootstrap-confidence-interval"><i class="fa fa-check"></i><b>5.5.3</b> Bootstrap confidence interval</a></li>
<li class="chapter" data-level="5.5.4" data-path="uncertainty.html"><a href="uncertainty.html#a-plot-of-a-parametric-ci-vs.-bootstrap-ci-of-the-means"><i class="fa fa-check"></i><b>5.5.4</b> A plot of a “parametric” CI vs. bootstrap CI of the means</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="uncertainty.html"><a href="uncertainty.html#standard-error-of-a-difference-between-means"><i class="fa fa-check"></i><b>5.6</b> Standard error of a difference between means</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="uncertainty.html"><a href="uncertainty.html#the-standard-error-of-a-difference-between-means-is-the-standard-deviation-of-the-sampling-distribution-of-the-difference"><i class="fa fa-check"></i><b>5.6.1</b> The standard error of a difference between means is the standard deviation of the sampling distribution of the difference</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="uncertainty.html"><a href="uncertainty.html#confidence-limits-of-a-difference-between-means"><i class="fa fa-check"></i><b>5.7</b> Confidence limits of a difference between means</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="uncertainty.html"><a href="uncertainty.html#of-95-cis-of-the-difference-include-the-true-difference"><i class="fa fa-check"></i><b>5.7.1</b> 95% of 95% CIs of the difference include the true difference</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="uncertainty.html"><a href="uncertainty.html#hidden-code"><i class="fa fa-check"></i><b>5.8</b> Hidden code</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="uncertainty.html"><a href="uncertainty.html#import-exp3b"><i class="fa fa-check"></i><b>5.8.1</b> Import exp3b</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="p-values.html"><a href="p-values.html"><i class="fa fa-check"></i><b>6</b> P-values</a>
<ul>
<li class="chapter" data-level="6.1" data-path="p-values.html"><a href="p-values.html#a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution"><i class="fa fa-check"></i><b>6.1</b> A <em>p</em>-value is the probability of sampling a value as or more extreme than the test statistic if sampling from a null distribution</a></li>
<li class="chapter" data-level="6.2" data-path="p-values.html"><a href="p-values.html#pump-your-intuition-creating-a-null-distribution"><i class="fa fa-check"></i><b>6.2</b> Pump your intuition – Creating a null distribution</a></li>
<li class="chapter" data-level="6.3" data-path="p-values.html"><a href="p-values.html#a-null-distribution-of-t-values-the-t-distribution"><i class="fa fa-check"></i><b>6.3</b> A null distribution of <em>t</em>-values – the <em>t</em> distribution</a></li>
<li class="chapter" data-level="6.4" data-path="p-values.html"><a href="p-values.html#p-values-from-the-perspective-of-permutation"><i class="fa fa-check"></i><b>6.4</b> P-values from the perspective of permutation</a></li>
<li class="chapter" data-level="6.5" data-path="p-values.html"><a href="p-values.html#parametric-vs.-non-parametric-statistics"><i class="fa fa-check"></i><b>6.5</b> Parametric vs. non-parametric statistics</a></li>
<li class="chapter" data-level="6.6" data-path="p-values.html"><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values"><i class="fa fa-check"></i><b>6.6</b> frequentist probability and the interpretation of p-values</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="p-values.html"><a href="p-values.html#background-1"><i class="fa fa-check"></i><b>6.6.1</b> Background</a></li>
<li class="chapter" data-level="6.6.2" data-path="p-values.html"><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><i class="fa fa-check"></i><b>6.6.2</b> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li class="chapter" data-level="6.6.3" data-path="p-values.html"><a href="p-values.html#two-interpretations-of-the-p-value"><i class="fa fa-check"></i><b>6.6.3</b> Two interpretations of the <em>p</em>-value</a></li>
<li class="chapter" data-level="6.6.4" data-path="p-values.html"><a href="p-values.html#nhst"><i class="fa fa-check"></i><b>6.6.4</b> NHST</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="p-values.html"><a href="p-values.html#some-major-misconceptions-of-the-p-value"><i class="fa fa-check"></i><b>6.7</b> Some major misconceptions of the <em>p</em>-value</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="p-values.html"><a href="p-values.html#misconception-p-0.05-means-there-is-no-effect-of-treatment"><i class="fa fa-check"></i><b>6.7.1</b> Misconception: <span class="math inline">\(p &gt; 0.05\)</span> means there is no effect of treatment</a></li>
<li class="chapter" data-level="6.7.2" data-path="p-values.html"><a href="p-values.html#misconception-a-p-value-is-repeatable"><i class="fa fa-check"></i><b>6.7.2</b> Misconception: a <em>p</em>-value is repeatable</a></li>
<li class="chapter" data-level="6.7.3" data-path="p-values.html"><a href="p-values.html#misconception-0.05-is-the-lifetime-rate-of-false-discoveries"><i class="fa fa-check"></i><b>6.7.3</b> Misconception: 0.05 is the lifetime rate of false discoveries</a></li>
<li class="chapter" data-level="6.7.4" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-an-important-effect"><i class="fa fa-check"></i><b>6.7.4</b> Misconception: a low <em>p</em>-value indicates an important effect</a></li>
<li class="chapter" data-level="6.7.5" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity"><i class="fa fa-check"></i><b>6.7.5</b> Misconception: a low <em>p</em>-value indicates high model fit or high predictive capacity</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="p-values.html"><a href="p-values.html#what-the-p-value-does-not-mean"><i class="fa fa-check"></i><b>6.8</b> What the <em>p</em>-value does not mean</a></li>
<li class="chapter" data-level="6.9" data-path="p-values.html"><a href="p-values.html#on-using-p-values-in-experimental-biology"><i class="fa fa-check"></i><b>6.9</b> On using <em>p</em>-values in experimental biology</a></li>
<li class="chapter" data-level="6.10" data-path="p-values.html"><a href="p-values.html#better-reproducibility"><i class="fa fa-check"></i><b>6.10</b> Better reproducibility</a></li>
<li class="chapter" data-level="6.11" data-path="p-values.html"><a href="p-values.html#multiple-testing-and-controlling-for-false-positives"><i class="fa fa-check"></i><b>6.11</b> Multiple testing and controlling for false positives</a>
<ul>
<li class="chapter" data-level="6.11.1" data-path="p-values.html"><a href="p-values.html#controlling-the-family-wise-error-rate-when-all-tests-are-testing-the-same-hypothesis"><i class="fa fa-check"></i><b>6.11.1</b> Controlling the family-wise error rate when all tests are testing the same hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="6.12" data-path="p-values.html"><a href="p-values.html#recommendations"><i class="fa fa-check"></i><b>6.12</b> Recommendations</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="p-values.html"><a href="p-values.html#primary-sources-for-recommendations"><i class="fa fa-check"></i><b>6.12.1</b> Primary sources for recommendations</a></li>
</ul></li>
<li class="chapter" data-level="6.13" data-path="p-values.html"><a href="p-values.html#problems"><i class="fa fa-check"></i><b>6.13</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="errors-in-inference.html"><a href="errors-in-inference.html"><i class="fa fa-check"></i><b>7</b> Errors in inference</a>
<ul>
<li class="chapter" data-level="7.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#classical-nhst-concepts-of-wrong"><i class="fa fa-check"></i><b>7.1</b> Classical NHST concepts of wrong</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-i-error"><i class="fa fa-check"></i><b>7.1.1</b> Type I error</a></li>
<li class="chapter" data-level="7.1.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#power"><i class="fa fa-check"></i><b>7.1.2</b> Power</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#a-non-neyman-pearson-concept-of-power"><i class="fa fa-check"></i><b>7.2</b> A non-Neyman-Pearson concept of power</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#estimation-error"><i class="fa fa-check"></i><b>7.2.1</b> Estimation error</a></li>
<li class="chapter" data-level="7.2.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#coverage"><i class="fa fa-check"></i><b>7.2.2</b> Coverage</a></li>
<li class="chapter" data-level="7.2.3" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-s-error"><i class="fa fa-check"></i><b>7.2.3</b> Type S error</a></li>
<li class="chapter" data-level="7.2.4" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-m-error"><i class="fa fa-check"></i><b>7.2.4</b> Type M error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iv-introduction-to-linear-models.html"><a href="part-iv-introduction-to-linear-models.html"><i class="fa fa-check"></i>Part IV: Introduction to Linear Models</a></li>
<li class="chapter" data-level="8" data-path="intro-linear-models.html"><a href="intro-linear-models.html"><i class="fa fa-check"></i><b>8</b> An introduction to linear models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#lm-specifications"><i class="fa fa-check"></i><b>8.1</b> Two specifications of a linear model</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#the-error-draw-specification"><i class="fa fa-check"></i><b>8.1.1</b> The “error draw” specification</a></li>
<li class="chapter" data-level="8.1.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#the-conditional-draw-specification"><i class="fa fa-check"></i><b>8.1.2</b> The “conditional draw” specification</a></li>
<li class="chapter" data-level="8.1.3" data-path="intro-linear-models.html"><a href="intro-linear-models.html#comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model"><i class="fa fa-check"></i><b>8.1.3</b> Comparing the error-draw and conditional-draw ways of specifying the linear model</a></li>
<li class="chapter" data-level="8.1.4" data-path="intro-linear-models.html"><a href="intro-linear-models.html#anova-notation-of-a-linear-model"><i class="fa fa-check"></i><b>8.1.4</b> ANOVA notation of a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"><i class="fa fa-check"></i><b>8.2</b> A linear model can be fit to data with continuous, discrete, or categorical <span class="math inline">\(X\)</span> variables</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete"><i class="fa fa-check"></i><b>8.2.1</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is continuous or discrete</a></li>
<li class="chapter" data-level="8.2.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#slope"><i class="fa fa-check"></i><b>8.2.2</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is categorical</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="intro-linear-models.html"><a href="intro-linear-models.html#statistical-models-are-used-for-prediction-explanation-and-description"><i class="fa fa-check"></i><b>8.3</b> Statistical models are used for prediction, explanation, and description</a></li>
<li class="chapter" data-level="8.4" data-path="intro-linear-models.html"><a href="intro-linear-models.html#what-is-the-interpretation-of-a-regression-coefficient"><i class="fa fa-check"></i><b>8.4</b> What is the interpretation of a regression coefficient?</a></li>
<li class="chapter" data-level="8.5" data-path="intro-linear-models.html"><a href="intro-linear-models.html#what-do-we-call-the-x-and-y-variables"><i class="fa fa-check"></i><b>8.5</b> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li class="chapter" data-level="8.6" data-path="intro-linear-models.html"><a href="intro-linear-models.html#modeling-strategy"><i class="fa fa-check"></i><b>8.6</b> Modeling strategy</a></li>
<li class="chapter" data-level="8.7" data-path="intro-linear-models.html"><a href="intro-linear-models.html#predictions-from-the-model"><i class="fa fa-check"></i><b>8.7</b> Predictions from the model</a></li>
<li class="chapter" data-level="8.8" data-path="intro-linear-models.html"><a href="intro-linear-models.html#inference-from-the-model"><i class="fa fa-check"></i><b>8.8</b> Inference from the model</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="intro-linear-models.html"><a href="intro-linear-models.html#assumptions-for-inference-with-a-statistical-model"><i class="fa fa-check"></i><b>8.8.1</b> Assumptions for inference with a statistical model</a></li>
<li class="chapter" data-level="8.8.2" data-path="intro-linear-models.html"><a href="intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model"><i class="fa fa-check"></i><b>8.8.2</b> Specific assumptions for inference with a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="intro-linear-models.html"><a href="intro-linear-models.html#linear-modelregression-model-or-statistical-model"><i class="fa fa-check"></i><b>8.9</b> “linear model,”regression model”, or “statistical model”?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> Linear models with a single, continuous <em>X</em> (“regression”)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><i class="fa fa-check"></i><b>9.1</b> A linear model with a single, continuous <em>X</em> is classical “regression”</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="regression.html"><a href="regression.html#analysis-of-green-down-data"><i class="fa fa-check"></i><b>9.1.1</b> Analysis of “green-down” data</a></li>
<li class="chapter" data-level="9.1.2" data-path="regression.html"><a href="regression.html#learning-from-the-green-down-example"><i class="fa fa-check"></i><b>9.1.2</b> Learning from the green-down example</a></li>
<li class="chapter" data-level="9.1.3" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-explanation-causal-models"><i class="fa fa-check"></i><b>9.1.3</b> Using a regression model for “explanation” – causal models</a></li>
<li class="chapter" data-level="9.1.4" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-prediction-prediction-models"><i class="fa fa-check"></i><b>9.1.4</b> Using a regression model for prediction – prediction models</a></li>
<li class="chapter" data-level="9.1.5" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data"><i class="fa fa-check"></i><b>9.1.5</b> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</a></li>
<li class="chapter" data-level="9.1.6" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-for-calibration"><i class="fa fa-check"></i><b>9.1.6</b> Using a regression model for for calibration</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#working-in-r-1"><i class="fa fa-check"></i><b>9.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="plotting-models.html"><a href="plotting-models.html#fit-the-model"><i class="fa fa-check"></i><b>9.2.1</b> Fitting the linear model</a></li>
<li class="chapter" data-level="9.2.2" data-path="regression.html"><a href="regression.html#getting-to-know-the-linear-model-the-summary-function"><i class="fa fa-check"></i><b>9.2.2</b> Getting to know the linear model: the <code>summary</code> function</a></li>
<li class="chapter" data-level="9.2.3" data-path="regression.html"><a href="regression.html#inference-the-coefficient-table"><i class="fa fa-check"></i><b>9.2.3</b> Inference – the coefficient table</a></li>
<li class="chapter" data-level="9.2.4" data-path="regression.html"><a href="regression.html#how-good-is-our-model-model-checking"><i class="fa fa-check"></i><b>9.2.4</b> How good is our model? – Model checking</a></li>
<li class="chapter" data-level="9.2.5" data-path="regression.html"><a href="regression.html#plotting-models-with-continuous-x"><i class="fa fa-check"></i><b>9.2.5</b> Plotting models with continuous <em>X</em></a></li>
<li class="chapter" data-level="9.2.6" data-path="regression.html"><a href="regression.html#creating-a-table-of-predicted-values-and-95-prediction-intervals"><i class="fa fa-check"></i><b>9.2.6</b> Creating a table of predicted values and 95% prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="regression.html"><a href="regression.html#hidden-code-1"><i class="fa fa-check"></i><b>9.3</b> Hidden code</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="regression.html"><a href="regression.html#import-and-plot-of-fig2c-ecosystem-warming-experimental-data"><i class="fa fa-check"></i><b>9.3.1</b> Import and plot of fig2c (ecosystem warming experimental) data</a></li>
<li class="chapter" data-level="9.3.2" data-path="regression.html"><a href="regression.html#import-and-plot-efig_3d-ecosysem-warming-observational-data"><i class="fa fa-check"></i><b>9.3.2</b> Import and plot efig_3d (Ecosysem warming observational) data</a></li>
<li class="chapter" data-level="9.3.3" data-path="regression.html"><a href="regression.html#import-and-plot-of-fig1f-methionine-restriction-data"><i class="fa fa-check"></i><b>9.3.3</b> Import and plot of fig1f (methionine restriction) data</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="regression.html"><a href="regression.html#try-it"><i class="fa fa-check"></i><b>9.4</b> Try it</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="regression.html"><a href="regression.html#a-prediction-model-from-the-literature"><i class="fa fa-check"></i><b>9.4.1</b> A prediction model from the literature</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="regression.html"><a href="regression.html#intuition-pumps"><i class="fa fa-check"></i><b>9.5</b> Intuition pumps</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="regression.html"><a href="regression.html#correlation-and-r2"><i class="fa fa-check"></i><b>9.5.1</b> Correlation and $R^2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="oneway.html"><a href="oneway.html"><i class="fa fa-check"></i><b>10</b> Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="oneway.html"><a href="oneway.html#oneway-data"><i class="fa fa-check"></i><b>10.1</b> A linear model with a single factor (categorical <em>X</em>variable) estimates the effects of the levels of factor on the response</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="oneway.html"><a href="oneway.html#oneway-example1"><i class="fa fa-check"></i><b>10.1.1</b> Example 1 (fig3d) – two treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.2" data-path="oneway.html"><a href="oneway.html#understanding-the-analysis-with-two-treatment-levels"><i class="fa fa-check"></i><b>10.1.2</b> Understanding the analysis with two treatment levels</a></li>
<li class="chapter" data-level="10.1.3" data-path="oneway.html"><a href="oneway.html#oneway-example2"><i class="fa fa-check"></i><b>10.1.3</b> Example 2 – three treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.4" data-path="oneway.html"><a href="oneway.html#understanding-the-analysis-with-three-or-more-treatment-levels"><i class="fa fa-check"></i><b>10.1.4</b> Understanding the analysis with three (or more) treatment levels</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="oneway.html"><a href="oneway.html#working-in-r-2"><i class="fa fa-check"></i><b>10.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="oneway.html"><a href="oneway.html#fit-the-model-1"><i class="fa fa-check"></i><b>10.2.1</b> Fit the model</a></li>
<li class="chapter" data-level="10.2.2" data-path="oneway.html"><a href="oneway.html#controlling-the-output-in-tables-using-the-coefficient-table-as-an-example"><i class="fa fa-check"></i><b>10.2.2</b> Controlling the output in tables using the coefficient table as an example</a></li>
<li class="chapter" data-level="10.2.3" data-path="oneway.html"><a href="oneway.html#using-the-emmeans-function"><i class="fa fa-check"></i><b>10.2.3</b> Using the emmeans function</a></li>
<li class="chapter" data-level="10.2.4" data-path="oneway.html"><a href="oneway.html#using-the-contrast-function"><i class="fa fa-check"></i><b>10.2.4</b> Using the contrast function</a></li>
<li class="chapter" data-level="10.2.5" data-path="oneway.html"><a href="oneway.html#how-to-generate-anova-tables"><i class="fa fa-check"></i><b>10.2.5</b> How to generate ANOVA tables</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="oneway.html"><a href="oneway.html#hidden-code-2"><i class="fa fa-check"></i><b>10.3</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="oneway.html"><a href="oneway.html#importing-and-wrangling-the-fig3d-data-for-example-1"><i class="fa fa-check"></i><b>10.3.1</b> Importing and wrangling the fig3d data for example 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="oneway.html"><a href="oneway.html#importing-and-wrangling-the-fig2a-data-for-example-2"><i class="fa fa-check"></i><b>10.3.2</b> Importing and wrangling the fig2a data for example 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>11</b> Model Checking</a>
<ul>
<li class="chapter" data-level="11.1" data-path="model-checking.html"><a href="model-checking.html#check-check"><i class="fa fa-check"></i><b>11.1</b> All statistical analyses should be followed by model checking</a></li>
<li class="chapter" data-level="11.2" data-path="model-checking.html"><a href="model-checking.html#linear-model-assumptions"><i class="fa fa-check"></i><b>11.2</b> Linear model assumptions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="model-checking.html"><a href="model-checking.html#a-bit-about-iid"><i class="fa fa-check"></i><b>11.2.1</b> A bit about IID</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="model-checking.html"><a href="model-checking.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>11.3</b> Diagnostic plots use the residuals from the model fit</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="model-checking.html"><a href="model-checking.html#residuals"><i class="fa fa-check"></i><b>11.3.1</b> Residuals</a></li>
<li class="chapter" data-level="11.3.2" data-path="model-checking.html"><a href="model-checking.html#normal-qq"><i class="fa fa-check"></i><b>11.3.2</b> A Normal Q-Q plot is used to check for characteristic departures from Normality</a></li>
<li class="chapter" data-level="11.3.3" data-path="model-checking.html"><a href="model-checking.html#mapping-qq-plot-departures-from-normality"><i class="fa fa-check"></i><b>11.3.3</b> Mapping QQ-plot departures from Normality</a></li>
<li class="chapter" data-level="11.3.4" data-path="model-checking.html"><a href="model-checking.html#model-checking-spread-level"><i class="fa fa-check"></i><b>11.3.4</b> Model checking homoskedasticity</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="model-checking.html"><a href="model-checking.html#using-r"><i class="fa fa-check"></i><b>11.4</b> Using R</a></li>
<li class="chapter" data-level="11.5" data-path="model-checking.html"><a href="model-checking.html#hidden-code-3"><i class="fa fa-check"></i><b>11.5</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="model-checking.html"><a href="model-checking.html#normal-q-q-plots"><i class="fa fa-check"></i><b>11.5.1</b> Normal Q-Q plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="violations.html"><a href="violations.html"><i class="fa fa-check"></i><b>12</b> Violations of independence, homogeneity, or Normality</a>
<ul>
<li class="chapter" data-level="12.1" data-path="violations.html"><a href="violations.html#oneway-paired-t"><i class="fa fa-check"></i><b>12.1</b> Lack of independence</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="violations.html"><a href="violations.html#violations-paired-t"><i class="fa fa-check"></i><b>12.1.1</b> Example 1 (exp1b) – a paired t-test is a special case of a linear mixed model</a></li>
<li class="chapter" data-level="12.1.2" data-path="violations.html"><a href="violations.html#violations-rmanova"><i class="fa fa-check"></i><b>12.1.2</b> Example 2 (diHOME exp2a) – A repeated measures ANOVA is a special case of a linear mixed model</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="violations.html"><a href="violations.html#oneway-welch"><i class="fa fa-check"></i><b>12.2</b> Heterogeneity of variances</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="violations.html"><a href="violations.html#when-groups-of-the-focal-test-have-variance"><i class="fa fa-check"></i><b>12.2.1</b> When groups of the focal test have &gt;&gt; variance</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="violations.html"><a href="violations.html#the-conditional-response-isnt-normal"><i class="fa fa-check"></i><b>12.3</b> The conditional response isn’t Normal</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="violations.html"><a href="violations.html#violations-6f"><i class="fa fa-check"></i><b>12.3.1</b> Example 1 (fig6f) – Linear models for non-normal count data</a></li>
<li class="chapter" data-level="12.3.2" data-path="violations.html"><a href="violations.html#my-data-arent-normal-what-is-the-best-practice"><i class="fa fa-check"></i><b>12.3.2</b> My data aren’t normal, what is the best practice?</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="violations.html"><a href="violations.html#hidden-code-4"><i class="fa fa-check"></i><b>12.4</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-exp1b-data"><i class="fa fa-check"></i><b>12.4.1</b> Importing and wrangling the exp1b data</a></li>
<li class="chapter" data-level="12.4.2" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-exp2a-data"><i class="fa fa-check"></i><b>12.4.2</b> Importing and wrangling the exp2a data</a></li>
<li class="chapter" data-level="12.4.3" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-fig6f-data"><i class="fa fa-check"></i><b>12.4.3</b> Importing and wrangling the fig6f data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="issues.html"><a href="issues.html"><i class="fa fa-check"></i><b>13</b> Issues in inference</a>
<ul>
<li class="chapter" data-level="13.1" data-path="issues.html"><a href="issues.html#replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means"><i class="fa fa-check"></i><b>13.1</b> Replicated experiments – include <span class="math inline">\(\texttt{Experiment}\)</span> as a random factor (better than one-way ANOVA of means)</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="issues.html"><a href="issues.html#issues-exp4d"><i class="fa fa-check"></i><b>13.1.1</b> Multiple experiments Example 1 (wound healing Exp4d)</a></li>
<li class="chapter" data-level="13.1.2" data-path="issues.html"><a href="issues.html#issues-combined-experiments"><i class="fa fa-check"></i><b>13.1.2</b> Models for combining replicated experiments</a></li>
<li class="chapter" data-level="13.1.3" data-path="issues.html"><a href="issues.html#understanding-model-exp4d_m1"><i class="fa fa-check"></i><b>13.1.3</b> Understanding Model <code>exp4d_m1</code></a></li>
<li class="chapter" data-level="13.1.4" data-path="issues.html"><a href="issues.html#the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2"><i class="fa fa-check"></i><b>13.1.4</b> The univariate model is equivalent to a linear mixed model of the aggregated data (Model exp4d_m2)</a></li>
<li class="chapter" data-level="13.1.5" data-path="issues.html"><a href="issues.html#a-linear-mixed-model-of-the-full-data"><i class="fa fa-check"></i><b>13.1.5</b> A linear mixed model of the full data</a></li>
<li class="chapter" data-level="13.1.6" data-path="issues.html"><a href="issues.html#analysis-of-the-experiment-means-has-less-precision-and-power"><i class="fa fa-check"></i><b>13.1.6</b> Analysis of the experiment means has less precision and power</a></li>
<li class="chapter" data-level="13.1.7" data-path="issues.html"><a href="issues.html#dont-do-this-a-t-testfixed-effect-anova-of-the-full-data"><i class="fa fa-check"></i><b>13.1.7</b> Don’t do this – a t-test/fixed-effect ANOVA of the full data</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="issues.html"><a href="issues.html#issues-pre-post"><i class="fa fa-check"></i><b>13.2</b> Comparing change from baseline (pre-post)</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="issues.html"><a href="issues.html#pre-post-example-1-dpp4-fig4c"><i class="fa fa-check"></i><b>13.2.1</b> Pre-post example 1 (DPP4 fig4c)</a></li>
<li class="chapter" data-level="13.2.2" data-path="issues.html"><a href="issues.html#what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure"><i class="fa fa-check"></i><b>13.2.2</b> What if the data in example 1 were from from an experiment where the treatment was applied prior to the baseline measure?</a></li>
<li class="chapter" data-level="13.2.3" data-path="issues.html"><a href="issues.html#pre-post-example-2-xx-males-fig1c"><i class="fa fa-check"></i><b>13.2.3</b> Pre-post example 2 (XX males fig1c)</a></li>
<li class="chapter" data-level="13.2.4" data-path="issues.html"><a href="issues.html#issues-regression-to-mean"><i class="fa fa-check"></i><b>13.2.4</b> Regression to the mean</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="issues.html"><a href="issues.html#longitudinal-designs-with-more-than-one-post-baseline-measure"><i class="fa fa-check"></i><b>13.3</b> Longitudinal designs with more than one-post baseline measure</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="issues.html"><a href="issues.html#issues-auc"><i class="fa fa-check"></i><b>13.3.1</b> Area under the curve (AUC)</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="issues.html"><a href="issues.html#normalization-the-analysis-of-ratios"><i class="fa fa-check"></i><b>13.4</b> Normalization – the analysis of ratios</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="issues.html"><a href="issues.html#kinds-of-ratios-in-experimental-biology"><i class="fa fa-check"></i><b>13.4.1</b> Kinds of ratios in experimental biology</a></li>
<li class="chapter" data-level="13.4.2" data-path="issues.html"><a href="issues.html#issues-offset"><i class="fa fa-check"></i><b>13.4.2</b> Example 1 – The ratio is a density (number of something per area)</a></li>
<li class="chapter" data-level="13.4.3" data-path="issues.html"><a href="issues.html#issues-size"><i class="fa fa-check"></i><b>13.4.3</b> Example 2 – The ratio is normalizing for size differences</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="issues.html"><a href="issues.html#dont-do-this-stuff"><i class="fa fa-check"></i><b>13.5</b> Don’t do this stuff</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="issues.html"><a href="issues.html#normalize-the-response-so-that-all-control-values-are-equal-to-1."><i class="fa fa-check"></i><b>13.5.1</b> Normalize the response so that all control values are equal to 1.</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="issues.html"><a href="issues.html#a-difference-in-significance-is-not-necessarily-significant"><i class="fa fa-check"></i><b>13.6</b> A difference in significance is not necessarily significant</a></li>
<li class="chapter" data-level="13.7" data-path="issues.html"><a href="issues.html#researcher-degrees-of-freedom"><i class="fa fa-check"></i><b>13.7</b> Researcher degrees of freedom</a></li>
<li class="chapter" data-level="13.8" data-path="issues.html"><a href="issues.html#hidden-code-5"><i class="fa fa-check"></i><b>13.8</b> Hidden code</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="issues.html"><a href="issues.html#import-exp4d-vimentin-cell-count-data-replicate-experiments-example"><i class="fa fa-check"></i><b>13.8.1</b> Import exp4d vimentin cell count data (replicate experiments example)</a></li>
<li class="chapter" data-level="13.8.2" data-path="issues.html"><a href="issues.html#import-fig4c-data"><i class="fa fa-check"></i><b>13.8.2</b> Import Fig4c data</a></li>
<li class="chapter" data-level="13.8.3" data-path="issues.html"><a href="issues.html#xx-males-fig1c"><i class="fa fa-check"></i><b>13.8.3</b> XX males fig1c</a></li>
<li class="chapter" data-level="13.8.4" data-path="issues.html"><a href="issues.html#generation-of-fake-data-to-illustrate-regression-to-the-mean"><i class="fa fa-check"></i><b>13.8.4</b> Generation of fake data to illustrate regression to the mean</a></li>
<li class="chapter" data-level="13.8.5" data-path="issues.html"><a href="issues.html#import-fig3f"><i class="fa fa-check"></i><b>13.8.5</b> Import fig3f</a></li>
<li class="chapter" data-level="13.8.6" data-path="issues.html"><a href="issues.html#issues-import-exp3b"><i class="fa fa-check"></i><b>13.8.6</b> Import exp3b</a></li>
<li class="chapter" data-level="13.8.7" data-path="issues.html"><a href="issues.html#issues-exp3b-plot"><i class="fa fa-check"></i><b>13.8.7</b> Plot the model of exp3b (glm offset data)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-more-than-one-x-multivariable-models.html"><a href="part-v-more-than-one-x-multivariable-models.html"><i class="fa fa-check"></i>Part V: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li class="chapter" data-level="14" data-path="covariates.html"><a href="covariates.html"><i class="fa fa-check"></i><b>14</b> Linear models with added covariates (“ANCOVA”)</a>
<ul>
<li class="chapter" data-level="14.1" data-path="covariates.html"><a href="covariates.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><i class="fa fa-check"></i><b>14.1</b> Adding covariates can increases the precision of the effect of interest</a></li>
<li class="chapter" data-level="14.2" data-path="covariates.html"><a href="covariates.html#understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data"><i class="fa fa-check"></i><b>14.2</b> Understanding a linear model with an added covariate – heart necrosis data</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="covariates.html"><a href="covariates.html#fit-the-model-5"><i class="fa fa-check"></i><b>14.2.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.2.2" data-path="covariates.html"><a href="covariates.html#plot-the-model-2"><i class="fa fa-check"></i><b>14.2.2</b> Plot the model</a></li>
<li class="chapter" data-level="14.2.3" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-model-coefficients"><i class="fa fa-check"></i><b>14.2.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.2.4" data-path="covariates.html"><a href="covariates.html#everything-adds-up"><i class="fa fa-check"></i><b>14.2.4</b> Everything adds up</a></li>
<li class="chapter" data-level="14.2.5" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-estimated-marginal-means"><i class="fa fa-check"></i><b>14.2.5</b> Interpretation of the estimated marginal means</a></li>
<li class="chapter" data-level="14.2.6" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-contrasts"><i class="fa fa-check"></i><b>14.2.6</b> Interpretation of the contrasts</a></li>
<li class="chapter" data-level="14.2.7" data-path="covariates.html"><a href="covariates.html#adding-the-covariate-improves-inference"><i class="fa fa-check"></i><b>14.2.7</b> Adding the covariate improves inference</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="covariates.html"><a href="covariates.html#understanding-interaction-effects-with-covariates"><i class="fa fa-check"></i><b>14.3</b> Understanding interaction effects with covariates</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="covariates.html"><a href="covariates.html#fit-the-model-6"><i class="fa fa-check"></i><b>14.3.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.3.2" data-path="covariates.html"><a href="covariates.html#plot-the-model-with-interaction-effect"><i class="fa fa-check"></i><b>14.3.2</b> Plot the model with interaction effect</a></li>
<li class="chapter" data-level="14.3.3" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-model-coefficients-1"><i class="fa fa-check"></i><b>14.3.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.3.4" data-path="covariates.html"><a href="covariates.html#what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends."><i class="fa fa-check"></i><b>14.3.4</b> What is the effect of a treatment, if interactions are modeled? – it depends.</a></li>
<li class="chapter" data-level="14.3.5" data-path="covariates.html"><a href="covariates.html#which-model-do-we-use-mathcalm_1-or-mathcalm_2"><i class="fa fa-check"></i><b>14.3.5</b> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="covariates.html"><a href="covariates.html#understanding-ancova-tables"><i class="fa fa-check"></i><b>14.4</b> Understanding ANCOVA tables</a></li>
<li class="chapter" data-level="14.5" data-path="covariates.html"><a href="covariates.html#working-in-r-3"><i class="fa fa-check"></i><b>14.5</b> Working in R</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="covariates.html"><a href="covariates.html#importing-the-heart-necrosis-data"><i class="fa fa-check"></i><b>14.5.1</b> Importing the heart necrosis data</a></li>
<li class="chapter" data-level="14.5.2" data-path="covariates.html"><a href="covariates.html#fitting-the-model"><i class="fa fa-check"></i><b>14.5.2</b> Fitting the model</a></li>
<li class="chapter" data-level="14.5.3" data-path="covariates.html"><a href="covariates.html#using-the-emmeans-function-1"><i class="fa fa-check"></i><b>14.5.3</b> Using the emmeans function</a></li>
<li class="chapter" data-level="14.5.4" data-path="covariates.html"><a href="covariates.html#ancova-tables"><i class="fa fa-check"></i><b>14.5.4</b> ANCOVA tables</a></li>
<li class="chapter" data-level="14.5.5" data-path="covariates.html"><a href="covariates.html#plotting-the-model"><i class="fa fa-check"></i><b>14.5.5</b> Plotting the model</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="covariates.html"><a href="covariates.html#best-practices"><i class="fa fa-check"></i><b>14.6</b> Best practices</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="covariates.html"><a href="covariates.html#do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate"><i class="fa fa-check"></i><b>14.6.1</b> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</a></li>
<li class="chapter" data-level="14.6.2" data-path="covariates.html"><a href="covariates.html#do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate"><i class="fa fa-check"></i><b>14.6.2</b> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</a></li>
<li class="chapter" data-level="14.6.3" data-path="covariates.html"><a href="covariates.html#do-not-test-for-balance-of-baseline-measures"><i class="fa fa-check"></i><b>14.6.3</b> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="covariates.html"><a href="covariates.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><i class="fa fa-check"></i><b>14.7</b> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="factorial.html"><a href="factorial.html"><i class="fa fa-check"></i><b>15</b> Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</a>
<ul>
<li class="chapter" data-level="15.1" data-path="factorial.html"><a href="factorial.html#a-linear-model-with-crossed-factors-estimates-interaction-effects"><i class="fa fa-check"></i><b>15.1</b> A linear model with crossed factors estimates interaction effects</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="factorial.html"><a href="factorial.html#an-interaction-is-a-difference-in-simple-effects"><i class="fa fa-check"></i><b>15.1.1</b> An interaction is a difference in simple effects</a></li>
<li class="chapter" data-level="15.1.2" data-path="factorial.html"><a href="factorial.html#a-linear-model-with-crossed-factors-includes-interaction-effects"><i class="fa fa-check"></i><b>15.1.2</b> A linear model with crossed factors includes interaction effects</a></li>
<li class="chapter" data-level="15.1.3" data-path="factorial.html"><a href="factorial.html#factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature"><i class="fa fa-check"></i><b>15.1.3</b> factorial experiments are frequently analyzed as flattened linear models in the experimental biology literature</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="factorial.html"><a href="factorial.html#example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data"><i class="fa fa-check"></i><b>15.2</b> Example 1 – Estimation of a treatment effect relative to a control effect (“Something different”) (Experiment 2j glucose uptake data)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="factorial.html"><a href="factorial.html#twoway-understand1"><i class="fa fa-check"></i><b>15.2.1</b> Understand the experimental design</a></li>
<li class="chapter" data-level="15.2.2" data-path="factorial.html"><a href="factorial.html#fit-the-linear-model"><i class="fa fa-check"></i><b>15.2.2</b> Fit the linear model</a></li>
<li class="chapter" data-level="15.2.3" data-path="factorial.html"><a href="factorial.html#twoway-exp2j-inf"><i class="fa fa-check"></i><b>15.2.3</b> Inference</a></li>
<li class="chapter" data-level="15.2.4" data-path="factorial.html"><a href="factorial.html#plot-the-model-3"><i class="fa fa-check"></i><b>15.2.4</b> Plot the model</a></li>
<li class="chapter" data-level="15.2.5" data-path="factorial.html"><a href="factorial.html#alternaplot-the-model"><i class="fa fa-check"></i><b>15.2.5</b> alternaPlot the model</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-1"><i class="fa fa-check"></i><b>15.3</b> Understanding the linear model with crossed factors 1</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="factorial.html"><a href="factorial.html#twoway-what-coefs-are"><i class="fa fa-check"></i><b>15.3.1</b> What the coefficients are</a></li>
<li class="chapter" data-level="15.3.2" data-path="factorial.html"><a href="factorial.html#the-interaction-effect-is-something-different"><i class="fa fa-check"></i><b>15.3.2</b> The interaction effect is something different</a></li>
<li class="chapter" data-level="15.3.3" data-path="factorial.html"><a href="factorial.html#why-we-want-to-compare-the-treatment-effect-to-a-control-effect"><i class="fa fa-check"></i><b>15.3.3</b> Why we want to compare the treatment effect to a control effect</a></li>
<li class="chapter" data-level="15.3.4" data-path="factorial.html"><a href="factorial.html#the-order-of-the-factors-in-the-model-tells-the-same-story-differently"><i class="fa fa-check"></i><b>15.3.4</b> The order of the factors in the model tells the same story differently</a></li>
<li class="chapter" data-level="15.3.5" data-path="factorial.html"><a href="factorial.html#power-for-the-interaction-effect-is-less-than-that-for-simple-effects"><i class="fa fa-check"></i><b>15.3.5</b> Power for the interaction effect is less than that for simple effects</a></li>
<li class="chapter" data-level="15.3.6" data-path="factorial.html"><a href="factorial.html#planned-comparisons-vs.-post-hoc-tests"><i class="fa fa-check"></i><b>15.3.6</b> Planned comparisons vs. post-hoc tests</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="factorial.html"><a href="factorial.html#example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data"><i class="fa fa-check"></i><b>15.4</b> Example 2: Estimation of the effect of background condition on an effect (“it depends”) (Experiment 3e lesian area data)</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="factorial.html"><a href="factorial.html#understand-the-experimental-design"><i class="fa fa-check"></i><b>15.4.1</b> Understand the experimental design</a></li>
<li class="chapter" data-level="15.4.2" data-path="factorial.html"><a href="factorial.html#fit-the-linear-model-1"><i class="fa fa-check"></i><b>15.4.2</b> Fit the linear model</a></li>
<li class="chapter" data-level="15.4.3" data-path="factorial.html"><a href="factorial.html#check-the-model-1"><i class="fa fa-check"></i><b>15.4.3</b> Check the model</a></li>
<li class="chapter" data-level="15.4.4" data-path="factorial.html"><a href="factorial.html#inference-from-the-model-2"><i class="fa fa-check"></i><b>15.4.4</b> Inference from the model</a></li>
<li class="chapter" data-level="15.4.5" data-path="factorial.html"><a href="factorial.html#plot-the-model-4"><i class="fa fa-check"></i><b>15.4.5</b> Plot the model</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-2"><i class="fa fa-check"></i><b>15.5</b> Understanding the linear model with crossed factors 2</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="factorial.html"><a href="factorial.html#twoway-marginal-means"><i class="fa fa-check"></i><b>15.5.1</b> Conditional and marginal means</a></li>
<li class="chapter" data-level="15.5.2" data-path="factorial.html"><a href="factorial.html#simple-conditional-effects"><i class="fa fa-check"></i><b>15.5.2</b> Simple (conditional) effects</a></li>
<li class="chapter" data-level="15.5.3" data-path="factorial.html"><a href="factorial.html#twoway-marginal-effects"><i class="fa fa-check"></i><b>15.5.3</b> Marginal effects</a></li>
<li class="chapter" data-level="15.5.4" data-path="factorial.html"><a href="factorial.html#the-additive-model"><i class="fa fa-check"></i><b>15.5.4</b> The additive model</a></li>
<li class="chapter" data-level="15.5.5" data-path="factorial.html"><a href="factorial.html#twoway-reduce"><i class="fa fa-check"></i><b>15.5.5</b> Reduce models for the right reason</a></li>
<li class="chapter" data-level="15.5.6" data-path="factorial.html"><a href="factorial.html#the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird"><i class="fa fa-check"></i><b>15.5.6</b> The marginal means of an additive linear model with two factors can be weird</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="factorial.html"><a href="factorial.html#example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data"><i class="fa fa-check"></i><b>15.6</b> Example 3: Estimation of synergy (“More than the sum of the parts”) (Experiment 1c JA data)</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="factorial.html"><a href="factorial.html#examine-the-data"><i class="fa fa-check"></i><b>15.6.1</b> Examine the data</a></li>
<li class="chapter" data-level="15.6.2" data-path="factorial.html"><a href="factorial.html#fit-the-model-7"><i class="fa fa-check"></i><b>15.6.2</b> Fit the model</a></li>
<li class="chapter" data-level="15.6.3" data-path="factorial.html"><a href="factorial.html#model-check"><i class="fa fa-check"></i><b>15.6.3</b> Model check</a></li>
<li class="chapter" data-level="15.6.4" data-path="factorial.html"><a href="factorial.html#inference-from-the-model-3"><i class="fa fa-check"></i><b>15.6.4</b> Inference from the model</a></li>
<li class="chapter" data-level="15.6.5" data-path="factorial.html"><a href="factorial.html#plot-the-model-5"><i class="fa fa-check"></i><b>15.6.5</b> Plot the model</a></li>
<li class="chapter" data-level="15.6.6" data-path="factorial.html"><a href="factorial.html#alternative-plot"><i class="fa fa-check"></i><b>15.6.6</b> Alternative plot</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-3"><i class="fa fa-check"></i><b>15.7</b> Understanding the linear model with crossed factors 3</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="factorial.html"><a href="factorial.html#thinking-about-the-coefficients-of-the-linear-model"><i class="fa fa-check"></i><b>15.7.1</b> Thinking about the coefficients of the linear model</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="factorial.html"><a href="factorial.html#issues-in-inference"><i class="fa fa-check"></i><b>15.8</b> Issues in inference</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="factorial.html"><a href="factorial.html#for-pairwise-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><i class="fa fa-check"></i><b>15.8.1</b> For pairwise contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li class="chapter" data-level="15.8.2" data-path="factorial.html"><a href="factorial.html#for-interaction-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><i class="fa fa-check"></i><b>15.8.2</b> For interaction contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li class="chapter" data-level="15.8.3" data-path="factorial.html"><a href="factorial.html#twoway-multiple-tests"><i class="fa fa-check"></i><b>15.8.3</b> Adjusting <em>p</em>-values for multiple tests</a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="factorial.html"><a href="factorial.html#two-way-anova"><i class="fa fa-check"></i><b>15.9</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="15.9.1" data-path="factorial.html"><a href="factorial.html#how-to-read-a-two-way-anova-table"><i class="fa fa-check"></i><b>15.9.1</b> How to read a two-way ANOVA table</a></li>
<li class="chapter" data-level="15.9.2" data-path="factorial.html"><a href="factorial.html#what-do-the-main-effects-in-an-anova-table-mean"><i class="fa fa-check"></i><b>15.9.2</b> What do the main effects in an ANOVA table mean?</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="factorial.html"><a href="factorial.html#more-issues-in-inference"><i class="fa fa-check"></i><b>15.10</b> More issues in inference</a>
<ul>
<li class="chapter" data-level="15.10.1" data-path="factorial.html"><a href="factorial.html#longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova"><i class="fa fa-check"></i><b>15.10.1</b> Longitudinal experiments – include Time as a random factor (better than repeated measures ANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="factorial.html"><a href="factorial.html#working-in-r-4"><i class="fa fa-check"></i><b>15.11</b> Working in R</a>
<ul>
<li class="chapter" data-level="15.11.1" data-path="factorial.html"><a href="factorial.html#model-formula"><i class="fa fa-check"></i><b>15.11.1</b> Model formula</a></li>
<li class="chapter" data-level="15.11.2" data-path="factorial.html"><a href="factorial.html#using-the-emmeans-function-2"><i class="fa fa-check"></i><b>15.11.2</b> Using the emmeans function</a></li>
<li class="chapter" data-level="15.11.3" data-path="factorial.html"><a href="factorial.html#contrasts"><i class="fa fa-check"></i><b>15.11.3</b> Contrasts</a></li>
<li class="chapter" data-level="15.11.4" data-path="factorial.html"><a href="factorial.html#practice-safe-anova"><i class="fa fa-check"></i><b>15.11.4</b> Practice safe ANOVA</a></li>
<li class="chapter" data-level="15.11.5" data-path="factorial.html"><a href="factorial.html#better-to-avoid-these"><i class="fa fa-check"></i><b>15.11.5</b> Better to avoid these</a></li>
</ul></li>
<li class="chapter" data-level="15.12" data-path="factorial.html"><a href="factorial.html#hidden-code-6"><i class="fa fa-check"></i><b>15.12</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="15.12.1" data-path="factorial.html"><a href="factorial.html#import-exp2j-example-1"><i class="fa fa-check"></i><b>15.12.1</b> Import exp2j (Example 1)</a></li>
<li class="chapter" data-level="15.12.2" data-path="factorial.html"><a href="factorial.html#import-exp3e-lesian-area-data-example-2"><i class="fa fa-check"></i><b>15.12.2</b> Import exp3e lesian area data (Example 2)</a></li>
<li class="chapter" data-level="15.12.3" data-path="factorial.html"><a href="factorial.html#import-exp1c-ja-data-example-3"><i class="fa fa-check"></i><b>15.12.3</b> Import Exp1c JA data (Example 3)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-vi-expanding-the-linear-model.html"><a href="part-vi-expanding-the-linear-model.html"><i class="fa fa-check"></i>Part VI – Expanding the Linear Model</a></li>
<li class="chapter" data-level="16" data-path="lmm.html"><a href="lmm.html"><i class="fa fa-check"></i><b>16</b> Models with random factors – linear mixed models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="lmm.html"><a href="lmm.html#chapter-summary"><i class="fa fa-check"></i><b>16.1</b> Chapter summary</a></li>
<li class="chapter" data-level="16.2" data-path="lmm.html"><a href="lmm.html#introduction"><i class="fa fa-check"></i><b>16.2</b> Introduction</a></li>
<li class="chapter" data-level="16.3" data-path="lmm.html"><a href="lmm.html#experimental-designs-in-experimental-bench-biology"><i class="fa fa-check"></i><b>16.3</b> Experimental designs in experimental bench biology</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="lmm.html"><a href="lmm.html#notation-for-models"><i class="fa fa-check"></i><b>16.3.1</b> Notation for models</a></li>
<li class="chapter" data-level="16.3.2" data-path="lmm.html"><a href="lmm.html#completely-randomized-design-crd"><i class="fa fa-check"></i><b>16.3.2</b> Completely Randomized Design (CRD)</a></li>
<li class="chapter" data-level="16.3.3" data-path="lmm.html"><a href="lmm.html#completely-randomized-design-with-subsampling-crds-or-nested-design"><i class="fa fa-check"></i><b>16.3.3</b> Completely Randomized Design with Subsampling (CRDS) or “Nested Design”</a></li>
<li class="chapter" data-level="16.3.4" data-path="lmm.html"><a href="lmm.html#randomized-complete-block-design-rcbd"><i class="fa fa-check"></i><b>16.3.4</b> Randomized Complete Block Design (RCBD)</a></li>
<li class="chapter" data-level="16.3.5" data-path="lmm.html"><a href="lmm.html#randomized-split-plot-design-rspd"><i class="fa fa-check"></i><b>16.3.5</b> Randomized Split Plot Design (RSPD)</a></li>
<li class="chapter" data-level="16.3.6" data-path="lmm.html"><a href="lmm.html#generalized-randomized-complete-block-design-grcbd"><i class="fa fa-check"></i><b>16.3.6</b> Generalized Randomized Complete Block Design (GRCBD)</a></li>
<li class="chapter" data-level="16.3.7" data-path="lmm.html"><a href="lmm.html#nested-randomized-complete-block-design-nrcbd"><i class="fa fa-check"></i><b>16.3.7</b> Nested Randomized Complete Block Design (NRCBD)</a></li>
<li class="chapter" data-level="16.3.8" data-path="lmm.html"><a href="lmm.html#longitudinal-randomized-complete-block-design-lrcbd"><i class="fa fa-check"></i><b>16.3.8</b> Longitudinal Randomized Complete Block Design (LRCBD)</a></li>
<li class="chapter" data-level="16.3.9" data-path="lmm.html"><a href="lmm.html#variations-due-to-multiple-measures-of-the-response-variable"><i class="fa fa-check"></i><b>16.3.9</b> Variations due to multiple measures of the response variable</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="lmm.html"><a href="lmm.html#building-the-linear-mixed-model-for-clustered-data"><i class="fa fa-check"></i><b>16.4</b> Building the linear (mixed) model for clustered data</a></li>
<li class="chapter" data-level="16.5" data-path="lmm.html"><a href="lmm.html#lmm-demo"><i class="fa fa-check"></i><b>16.5</b> Example 1 – A random intercepts and slopes explainer (demo1)</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="lmm.html"><a href="lmm.html#batched-measurements-result-in-clustered-residuals"><i class="fa fa-check"></i><b>16.5.1</b> Batched measurements result in clustered residuals</a></li>
<li class="chapter" data-level="16.5.2" data-path="lmm.html"><a href="lmm.html#lmm-corerr"><i class="fa fa-check"></i><b>16.5.2</b> Clustered residuals result in correlated error</a></li>
<li class="chapter" data-level="16.5.3" data-path="lmm.html"><a href="lmm.html#in-blocked-designs-clustered-residuals-adds-a-variance-component-that-masks-treatment-effects"><i class="fa fa-check"></i><b>16.5.3</b> In blocked designs, clustered residuals adds a variance component that masks treatment effects</a></li>
<li class="chapter" data-level="16.5.4" data-path="lmm.html"><a href="lmm.html#linear-mixed-models-are-linear-models-with-added-random-factors"><i class="fa fa-check"></i><b>16.5.4</b> Linear mixed models are linear models with added random factors</a></li>
<li class="chapter" data-level="16.5.5" data-path="lmm.html"><a href="lmm.html#what-the-random-effects-are"><i class="fa fa-check"></i><b>16.5.5</b> What the random effects are</a></li>
<li class="chapter" data-level="16.5.6" data-path="lmm.html"><a href="lmm.html#in-a-blocked-design-a-linear-model-with-added-random-effects-increases-precision-of-treatment-effects"><i class="fa fa-check"></i><b>16.5.6</b> In a blocked design, a linear model with added random effects increases precision of treatment effects</a></li>
<li class="chapter" data-level="16.5.7" data-path="lmm.html"><a href="lmm.html#lmm-varcorr"><i class="fa fa-check"></i><b>16.5.7</b> The correlation among random intercepts and slopes</a></li>
<li class="chapter" data-level="16.5.8" data-path="lmm.html"><a href="lmm.html#clustered-residuals-create-heterogeneity-among-treatments"><i class="fa fa-check"></i><b>16.5.8</b> Clustered residuals create heterogeneity among treatments</a></li>
<li class="chapter" data-level="16.5.9" data-path="lmm.html"><a href="lmm.html#linear-mixed-models-are-flexible"><i class="fa fa-check"></i><b>16.5.9</b> Linear mixed models are flexible</a></li>
<li class="chapter" data-level="16.5.10" data-path="lmm.html"><a href="lmm.html#a-random-intercept-only-model"><i class="fa fa-check"></i><b>16.5.10</b> A random intercept only model</a></li>
<li class="chapter" data-level="16.5.11" data-path="lmm.html"><a href="lmm.html#a-model-including-an-interaction-intercept"><i class="fa fa-check"></i><b>16.5.11</b> A model including an interaction intercept</a></li>
<li class="chapter" data-level="16.5.12" data-path="lmm.html"><a href="lmm.html#lmm-demo-aic"><i class="fa fa-check"></i><b>16.5.12</b> AIC and model selection – which model to report?</a></li>
<li class="chapter" data-level="16.5.13" data-path="lmm.html"><a href="lmm.html#the-specification-of-random-effects-matters"><i class="fa fa-check"></i><b>16.5.13</b> The specification of random effects matters</a></li>
<li class="chapter" data-level="16.5.14" data-path="lmm.html"><a href="lmm.html#mixed-effect-and-repeated-measures-anova"><i class="fa fa-check"></i><b>16.5.14</b> Mixed Effect and Repeated Measures ANOVA</a></li>
<li class="chapter" data-level="16.5.15" data-path="lmm.html"><a href="lmm.html#pseudoreplication"><i class="fa fa-check"></i><b>16.5.15</b> Pseudoreplication</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="lmm.html"><a href="lmm.html#lmm-example2"><i class="fa fa-check"></i><b>16.6</b> Example 2 – experiments without subsampling replication (exp6g)</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="lmm.html"><a href="lmm.html#understand-the-data"><i class="fa fa-check"></i><b>16.6.1</b> Understand the data</a></li>
<li class="chapter" data-level="16.6.2" data-path="lmm.html"><a href="lmm.html#model-fit-and-inference"><i class="fa fa-check"></i><b>16.6.2</b> Model fit and inference</a></li>
<li class="chapter" data-level="16.6.3" data-path="lmm.html"><a href="lmm.html#the-model-exp6g_m1-adds-a-random-intercept-but-not-a-random-slope"><i class="fa fa-check"></i><b>16.6.3</b> The model exp6g_m1 adds a random intercept but not a random slope</a></li>
<li class="chapter" data-level="16.6.4" data-path="lmm.html"><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp6g_m1"><i class="fa fa-check"></i><b>16.6.4</b> The fixed effect coefficients of model exp6g_m1</a></li>
<li class="chapter" data-level="16.6.5" data-path="lmm.html"><a href="lmm.html#the-random-intercept-coefficients-of-exp6g_m1"><i class="fa fa-check"></i><b>16.6.5</b> The random intercept coefficients of exp6g_m1</a></li>
<li class="chapter" data-level="16.6.6" data-path="lmm.html"><a href="lmm.html#the-random-and-residual-variance-and-the-intraclass-correlation-of-model-exp6g_m1"><i class="fa fa-check"></i><b>16.6.6</b> The random and residual variance and the intraclass correlation of model exp6g_m1</a></li>
<li class="chapter" data-level="16.6.7" data-path="lmm.html"><a href="lmm.html#the-linear-mixed-model-exp6g_m1-increases-precision-of-treatment-effects-relative-to-a-fixed-effects-model"><i class="fa fa-check"></i><b>16.6.7</b> The linear mixed model exp6g_m1 increases precision of treatment effects, relative to a fixed effects model</a></li>
<li class="chapter" data-level="16.6.8" data-path="lmm.html"><a href="lmm.html#lmm-exp6g-alt"><i class="fa fa-check"></i><b>16.6.8</b> Alternative models for exp6g</a></li>
<li class="chapter" data-level="16.6.9" data-path="lmm.html"><a href="lmm.html#paired-t-tests-and-repeated-measures-anova-are-special-cases-of-linear-mixed-models"><i class="fa fa-check"></i><b>16.6.9</b> Paired t-tests and repeated measures ANOVA are special cases of linear mixed models</a></li>
<li class="chapter" data-level="16.6.10" data-path="lmm.html"><a href="lmm.html#lmm-exp6g-rmanova"><i class="fa fa-check"></i><b>16.6.10</b> Classical (“univariate model”) repeated measures ANOVA of exp6g</a></li>
<li class="chapter" data-level="16.6.11" data-path="lmm.html"><a href="lmm.html#lmm-exp6g-rmanova-multi"><i class="fa fa-check"></i><b>16.6.11</b> “Multivariate model” repeated measures ANOVA</a></li>
<li class="chapter" data-level="16.6.12" data-path="lmm.html"><a href="lmm.html#linear-mixed-models-vs-repeated-measures-anova"><i class="fa fa-check"></i><b>16.6.12</b> Linear mixed models vs repeated measures ANOVA</a></li>
<li class="chapter" data-level="16.6.13" data-path="lmm.html"><a href="lmm.html#modeling-textttmouse_id-as-a-fixed-effect"><i class="fa fa-check"></i><b>16.6.13</b> Modeling <span class="math inline">\(\texttt{mouse_id}\)</span> as a fixed effect</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="lmm.html"><a href="lmm.html#example-3-factorial-experiments-and-no-subsampling-replicates-exp5c"><i class="fa fa-check"></i><b>16.7</b> Example 3 – Factorial experiments and no subsampling replicates (exp5c)</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="lmm.html"><a href="lmm.html#understand-the-data-1"><i class="fa fa-check"></i><b>16.7.1</b> Understand the data</a></li>
<li class="chapter" data-level="16.7.2" data-path="lmm.html"><a href="lmm.html#examine-the-data-1"><i class="fa fa-check"></i><b>16.7.2</b> Examine the data</a></li>
<li class="chapter" data-level="16.7.3" data-path="lmm.html"><a href="lmm.html#lmm-exp5c-m1"><i class="fa fa-check"></i><b>16.7.3</b> Model fit and inference</a></li>
<li class="chapter" data-level="16.7.4" data-path="lmm.html"><a href="lmm.html#why-we-care-about-modeling-batch-in-exp5c"><i class="fa fa-check"></i><b>16.7.4</b> Why we care about modeling batch in exp5c</a></li>
<li class="chapter" data-level="16.7.5" data-path="lmm.html"><a href="lmm.html#the-linear-mixed-model-exp5c_m1-adds-two-random-intercepts"><i class="fa fa-check"></i><b>16.7.5</b> The linear mixed model exp5c_m1 adds two random intercepts</a></li>
<li class="chapter" data-level="16.7.6" data-path="lmm.html"><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp5c_m1"><i class="fa fa-check"></i><b>16.7.6</b> The fixed effect coefficients of model exp5c_m1</a></li>
<li class="chapter" data-level="16.7.7" data-path="lmm.html"><a href="lmm.html#the-random-effect-coefficients-of-model-exp5c_m1"><i class="fa fa-check"></i><b>16.7.7</b> The random effect coefficients of model exp5c_m1</a></li>
<li class="chapter" data-level="16.7.8" data-path="lmm.html"><a href="lmm.html#lmm-exp5c-alt"><i class="fa fa-check"></i><b>16.7.8</b> Alternative models for exp5c</a></li>
<li class="chapter" data-level="16.7.9" data-path="lmm.html"><a href="lmm.html#lmm-rmanova-5c"><i class="fa fa-check"></i><b>16.7.9</b> Classical (“univariate model”) repeated measures ANOVA</a></li>
<li class="chapter" data-level="16.7.10" data-path="lmm.html"><a href="lmm.html#lmm-rmanova-5c-multi"><i class="fa fa-check"></i><b>16.7.10</b> “Multivariate model” repeated measures ANOVA of exp5c</a></li>
<li class="chapter" data-level="16.7.11" data-path="lmm.html"><a href="lmm.html#modeling-textttdonor-as-a-fixed-effect"><i class="fa fa-check"></i><b>16.7.11</b> Modeling <span class="math inline">\(\texttt{donor}\)</span> as a fixed effect</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="lmm.html"><a href="lmm.html#lmm-example4"><i class="fa fa-check"></i><b>16.8</b> Example 4 – Experiments with subsampling replication (exp1g)</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="lmm.html"><a href="lmm.html#understand-the-data-2"><i class="fa fa-check"></i><b>16.8.1</b> Understand the data</a></li>
<li class="chapter" data-level="16.8.2" data-path="lmm.html"><a href="lmm.html#examine-the-data-2"><i class="fa fa-check"></i><b>16.8.2</b> Examine the data</a></li>
<li class="chapter" data-level="16.8.3" data-path="lmm.html"><a href="lmm.html#fit-the-model-9"><i class="fa fa-check"></i><b>16.8.3</b> Fit the model</a></li>
<li class="chapter" data-level="16.8.4" data-path="lmm.html"><a href="lmm.html#inference-from-the-model-6"><i class="fa fa-check"></i><b>16.8.4</b> Inference from the model</a></li>
<li class="chapter" data-level="16.8.5" data-path="lmm.html"><a href="lmm.html#plot-the-model-6"><i class="fa fa-check"></i><b>16.8.5</b> Plot the model</a></li>
<li class="chapter" data-level="16.8.6" data-path="lmm.html"><a href="lmm.html#alternaplot-the-model-3"><i class="fa fa-check"></i><b>16.8.6</b> Alternaplot the model</a></li>
<li class="chapter" data-level="16.8.7" data-path="lmm.html"><a href="lmm.html#understanding-the-alternative-models"><i class="fa fa-check"></i><b>16.8.7</b> Understanding the alternative models</a></li>
<li class="chapter" data-level="16.8.8" data-path="lmm.html"><a href="lmm.html#the-varcorr-matrix-of-models-exp1g_m1a-and-exp1g_m1b"><i class="fa fa-check"></i><b>16.8.8</b> The VarCorr matrix of models exp1g_m1a and exp1g_m1b</a></li>
<li class="chapter" data-level="16.8.9" data-path="lmm.html"><a href="lmm.html#the-linear-mixed-model-has-more-precision-and-power-than-the-fixed-effect-model-of-batch-means"><i class="fa fa-check"></i><b>16.8.9</b> The linear mixed model has more precision and power than the fixed effect model of batch means</a></li>
<li class="chapter" data-level="16.8.10" data-path="lmm.html"><a href="lmm.html#fixed-effect-models-and-pseudoreplication"><i class="fa fa-check"></i><b>16.8.10</b> Fixed effect models and pseudoreplication</a></li>
<li class="chapter" data-level="16.8.11" data-path="lmm.html"><a href="lmm.html#mixed-effect-anova"><i class="fa fa-check"></i><b>16.8.11</b> Mixed-effect ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="16.9" data-path="lmm.html"><a href="lmm.html#statistical-models-for-experimental-designs"><i class="fa fa-check"></i><b>16.9</b> Statistical models for experimental designs</a>
<ul>
<li class="chapter" data-level="16.9.1" data-path="lmm.html"><a href="lmm.html#models-for-completely-randomized-designs-crd"><i class="fa fa-check"></i><b>16.9.1</b> Models for Completely Randomized Designs (CRD)</a></li>
<li class="chapter" data-level="16.9.2" data-path="lmm.html"><a href="lmm.html#models-for-batched-data-crds-rcbd-rspd-grcbd-nrcbd"><i class="fa fa-check"></i><b>16.9.2</b> Models for batched data (CRDS, RCBD, RSPD, GRCBD, NRCBD)</a></li>
</ul></li>
<li class="chapter" data-level="16.10" data-path="lmm.html"><a href="lmm.html#which-model-and-why"><i class="fa fa-check"></i><b>16.10</b> Which model and why?</a>
<ul>
<li class="chapter" data-level="16.10.1" data-path="lmm.html"><a href="lmm.html#crd"><i class="fa fa-check"></i><b>16.10.1</b> CRD</a></li>
<li class="chapter" data-level="16.10.2" data-path="lmm.html"><a href="lmm.html#crds"><i class="fa fa-check"></i><b>16.10.2</b> CRDS</a></li>
<li class="chapter" data-level="16.10.3" data-path="lmm.html"><a href="lmm.html#rcbd"><i class="fa fa-check"></i><b>16.10.3</b> RCBD</a></li>
<li class="chapter" data-level="16.10.4" data-path="lmm.html"><a href="lmm.html#rspd"><i class="fa fa-check"></i><b>16.10.4</b> RSPD</a></li>
<li class="chapter" data-level="16.10.5" data-path="lmm.html"><a href="lmm.html#rcbds"><i class="fa fa-check"></i><b>16.10.5</b> RCBDS</a></li>
<li class="chapter" data-level="16.10.6" data-path="lmm.html"><a href="lmm.html#grcbd"><i class="fa fa-check"></i><b>16.10.6</b> GRCBD</a></li>
<li class="chapter" data-level="16.10.7" data-path="lmm.html"><a href="lmm.html#grcbds"><i class="fa fa-check"></i><b>16.10.7</b> GRCBDS</a></li>
</ul></li>
<li class="chapter" data-level="16.11" data-path="lmm.html"><a href="lmm.html#working-in-r-5"><i class="fa fa-check"></i><b>16.11</b> Working in R</a>
<ul>
<li class="chapter" data-level="16.11.1" data-path="lmm.html"><a href="lmm.html#plotting-models-fit-to-batched-data"><i class="fa fa-check"></i><b>16.11.1</b> Plotting models fit to batched data</a></li>
<li class="chapter" data-level="16.11.2" data-path="lmm.html"><a href="lmm.html#repeated-measures-anova-randomized-complete-block-with-no-subsampling"><i class="fa fa-check"></i><b>16.11.2</b> Repeated measures ANOVA (randomized complete block with no subsampling)</a></li>
</ul></li>
<li class="chapter" data-level="16.12" data-path="lmm.html"><a href="lmm.html#hidden-code-7"><i class="fa fa-check"></i><b>16.12</b> Hidden code</a>
<ul>
<li class="chapter" data-level="16.12.1" data-path="lmm.html"><a href="lmm.html#import-exp5c"><i class="fa fa-check"></i><b>16.12.1</b> Import exp5c</a></li>
<li class="chapter" data-level="16.12.2" data-path="lmm.html"><a href="lmm.html#import-exp1g"><i class="fa fa-check"></i><b>16.12.2</b> Import exp1g</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="pre-post.html"><a href="pre-post.html"><i class="fa fa-check"></i><b>17</b> Linear models for longitudinal experiments – I. pre-post designs</a>
<ul>
<li class="chapter" data-level="17.1" data-path="pre-post.html"><a href="pre-post.html#best-practice-models"><i class="fa fa-check"></i><b>17.1</b> Best practice models</a></li>
<li class="chapter" data-level="17.2" data-path="pre-post.html"><a href="pre-post.html#common-alternatives-that-are-not-recommended"><i class="fa fa-check"></i><b>17.2</b> Common alternatives that are not recommended</a></li>
<li class="chapter" data-level="17.3" data-path="pre-post.html"><a href="pre-post.html#advanced-models"><i class="fa fa-check"></i><b>17.3</b> Advanced models</a></li>
<li class="chapter" data-level="17.4" data-path="pre-post.html"><a href="pre-post.html#understanding-the-alternative-models-1"><i class="fa fa-check"></i><b>17.4</b> Understanding the alternative models</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="pre-post.html"><a href="pre-post.html#m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model"><i class="fa fa-check"></i><b>17.4.1</b> (M1) Linear model with the baseline measure as the covariate (ANCOVA model)</a></li>
<li class="chapter" data-level="17.4.2" data-path="pre-post.html"><a href="pre-post.html#m2-linear-model-of-the-change-score-change-score-model"><i class="fa fa-check"></i><b>17.4.2</b> (M2) Linear model of the change score (change-score model)</a></li>
<li class="chapter" data-level="17.4.3" data-path="pre-post.html"><a href="pre-post.html#m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model"><i class="fa fa-check"></i><b>17.4.3</b> (M3) Linear model of post-baseline values without the baseline as a covariate (post model)</a></li>
<li class="chapter" data-level="17.4.4" data-path="pre-post.html"><a href="pre-post.html#m4-linear-model-with-factorial-fixed-effects-fixed-effects-model"><i class="fa fa-check"></i><b>17.4.4</b> (M4) Linear model with factorial fixed effects (fixed-effects model)</a></li>
<li class="chapter" data-level="17.4.5" data-path="pre-post.html"><a href="pre-post.html#m5-repeated-measures-anova"><i class="fa fa-check"></i><b>17.4.5</b> (M5) Repeated measures ANOVA</a></li>
<li class="chapter" data-level="17.4.6" data-path="pre-post.html"><a href="pre-post.html#m6-linear-mixed-model"><i class="fa fa-check"></i><b>17.4.6</b> (M6) Linear mixed model</a></li>
<li class="chapter" data-level="17.4.7" data-path="pre-post.html"><a href="pre-post.html#m7-linear-model-with-correlated-error"><i class="fa fa-check"></i><b>17.4.7</b> (M7) Linear model with correlated error</a></li>
<li class="chapter" data-level="17.4.8" data-path="pre-post.html"><a href="pre-post.html#m8-constrained-fixed-effects-model-with-correlated-error-clda-model"><i class="fa fa-check"></i><b>17.4.8</b> (M8) Constrained fixed effects model with correlated error (cLDA model)</a></li>
<li class="chapter" data-level="17.4.9" data-path="pre-post.html"><a href="pre-post.html#comparison-table"><i class="fa fa-check"></i><b>17.4.9</b> Comparison table</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="pre-post.html"><a href="pre-post.html#example-1-a-single-post-baseline-measure-pre-post-design"><i class="fa fa-check"></i><b>17.5</b> Example 1 – a single post-baseline measure (pre-post design)</a></li>
<li class="chapter" data-level="17.6" data-path="pre-post.html"><a href="pre-post.html#working-in-r-6"><i class="fa fa-check"></i><b>17.6</b> Working in R</a></li>
<li class="chapter" data-level="17.7" data-path="pre-post.html"><a href="pre-post.html#hidden-code-8"><i class="fa fa-check"></i><b>17.7</b> Hidden code</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="pre-post.html"><a href="pre-post.html#import-and-wrangle-mouse-sociability-data"><i class="fa fa-check"></i><b>17.7.1</b> Import and wrangle mouse sociability data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="counts.html"><a href="counts.html"><i class="fa fa-check"></i><b>18</b> Linear models for counts, binary responses, skewed responses, and ratios – Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="18.1" data-path="counts.html"><a href="counts.html#glm-counts"><i class="fa fa-check"></i><b>18.1</b> Introducing Generalized Linear Models using count data examples</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="counts.html"><a href="counts.html#the-generalized-linear-model-glm"><i class="fa fa-check"></i><b>18.1.1</b> The Generalized Linear Model (GLM)</a></li>
<li class="chapter" data-level="18.1.2" data-path="counts.html"><a href="counts.html#kinds-of-data-that-are-modeled-by-a-glm"><i class="fa fa-check"></i><b>18.1.2</b> Kinds of data that are modeled by a GLM</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="counts.html"><a href="counts.html#glm-1"><i class="fa fa-check"></i><b>18.2</b> Example 1 – GLM models for count responses (“angiogenic sprouts” fig3a)</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="counts.html"><a href="counts.html#understand-the-data-3"><i class="fa fa-check"></i><b>18.2.1</b> Understand the data</a></li>
<li class="chapter" data-level="18.2.2" data-path="counts.html"><a href="counts.html#model-fit-and-inference-1"><i class="fa fa-check"></i><b>18.2.2</b> Model fit and inference</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="counts.html"><a href="counts.html#understanding-example-1"><i class="fa fa-check"></i><b>18.3</b> Understanding Example 1</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="counts.html"><a href="counts.html#modeling-strategy-1"><i class="fa fa-check"></i><b>18.3.1</b> Modeling strategy</a></li>
<li class="chapter" data-level="18.3.2" data-path="counts.html"><a href="counts.html#model-checking-fits-to-count-data"><i class="fa fa-check"></i><b>18.3.2</b> Model checking fits to count data</a></li>
<li class="chapter" data-level="18.3.3" data-path="counts.html"><a href="counts.html#biological-count-data-are-rarely-fit-well-by-a-poisson-glm.-instead-fit-a-quasi-poisson-or-negative-binomial-glm-model."><i class="fa fa-check"></i><b>18.3.3</b> Biological count data are rarely fit well by a Poisson GLM. Instead, fit a quasi-poisson or negative binomial GLM model.</a></li>
<li class="chapter" data-level="18.3.4" data-path="counts.html"><a href="counts.html#a-glm-is-a-linear-model-on-the-link-scale"><i class="fa fa-check"></i><b>18.3.4</b> A GLM is a linear model on the link scale</a></li>
<li class="chapter" data-level="18.3.5" data-path="counts.html"><a href="counts.html#coeffecients-of-a-generalized-linear-model-with-a-log-link-function-are-on-the-link-scale."><i class="fa fa-check"></i><b>18.3.5</b> Coeffecients of a Generalized Linear Model with a log-link function are on the link scale.</a></li>
<li class="chapter" data-level="18.3.6" data-path="counts.html"><a href="counts.html#modeled-means-in-the-emmeans-table-of-a-generalized-linear-model-can-be-on-the-link-scale-or-response-scale-report-the-response-scale"><i class="fa fa-check"></i><b>18.3.6</b> Modeled means in the emmeans table of a Generalized Linear Model can be on the link scale or response scale – Report the response scale</a></li>
<li class="chapter" data-level="18.3.7" data-path="counts.html"><a href="counts.html#some-consequences-of-fitting-a-linear-model-to-count-data"><i class="fa fa-check"></i><b>18.3.7</b> Some consequences of fitting a linear model to count data</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="counts.html"><a href="counts.html#example-2-use-a-glm-with-an-offset-instead-of-a-ratio-of-some-measurement-per-total-dna-damage-data-fig3b-glm_offset"><i class="fa fa-check"></i><b>18.4</b> Example 2 – Use a GLM with an offset instead of a ratio of some measurement per total (“dna damage” data fig3b) #glm_offset</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="counts.html"><a href="counts.html#fig3b-dna-damage-data"><i class="fa fa-check"></i><b>18.4.1</b> fig3b (“dna damage”) data</a></li>
<li class="chapter" data-level="18.4.2" data-path="counts.html"><a href="counts.html#understand-the-data-4"><i class="fa fa-check"></i><b>18.4.2</b> Understand the data</a></li>
<li class="chapter" data-level="18.4.3" data-path="counts.html"><a href="counts.html#model-fit-and-inference-2"><i class="fa fa-check"></i><b>18.4.3</b> Model fit and inference</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="counts.html"><a href="counts.html#understanding-example-2"><i class="fa fa-check"></i><b>18.5</b> Understanding Example 2</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="counts.html"><a href="counts.html#an-offset-is-an-added-covariate-with-a-coefficient-fixed-at-1"><i class="fa fa-check"></i><b>18.5.1</b> An offset is an added covariate with a coefficient fixed at 1</a></li>
<li class="chapter" data-level="18.5.2" data-path="counts.html"><a href="counts.html#glm-rate"><i class="fa fa-check"></i><b>18.5.2</b> A count GLM with an offset models the area-normalized means</a></li>
<li class="chapter" data-level="18.5.3" data-path="counts.html"><a href="counts.html#compare-an-offset-to-an-added-covariate-with-an-estimated-coefficient"><i class="fa fa-check"></i><b>18.5.3</b> Compare an offset to an added covariate with an estimated coefficient</a></li>
<li class="chapter" data-level="18.5.4" data-path="counts.html"><a href="counts.html#issues-with-plotting"><i class="fa fa-check"></i><b>18.5.4</b> Issues with plotting</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="counts.html"><a href="counts.html#example-3-glm-models-for-binary-responses"><i class="fa fa-check"></i><b>18.6</b> Example 3 – GLM models for binary responses</a></li>
<li class="chapter" data-level="18.7" data-path="counts.html"><a href="counts.html#working-in-r-7"><i class="fa fa-check"></i><b>18.7</b> Working in R</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="counts.html"><a href="counts.html#fitting-glms-to-count-data"><i class="fa fa-check"></i><b>18.7.1</b> Fitting GLMs to count data</a></li>
<li class="chapter" data-level="18.7.2" data-path="counts.html"><a href="counts.html#fitting-a-glm-to-a-continuous-conditional-response-with-right-skew."><i class="fa fa-check"></i><b>18.7.2</b> Fitting a GLM to a continuous conditional response with right skew.</a></li>
<li class="chapter" data-level="18.7.3" data-path="counts.html"><a href="counts.html#fitting-a-glm-to-a-binary-success-or-failure-presence-or-absence-survived-or-died-response"><i class="fa fa-check"></i><b>18.7.3</b> Fitting a GLM to a binary (success or failure, presence or absence, survived or died) response</a></li>
<li class="chapter" data-level="18.7.4" data-path="counts.html"><a href="counts.html#fitting-generalized-linear-mixed-models"><i class="fa fa-check"></i><b>18.7.4</b> Fitting Generalized Linear Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="counts.html"><a href="counts.html#model-checking-glms"><i class="fa fa-check"></i><b>18.8</b> Model checking GLMs</a></li>
<li class="chapter" data-level="18.9" data-path="counts.html"><a href="counts.html#hidden-code-9"><i class="fa fa-check"></i><b>18.9</b> Hidden code</a>
<ul>
<li class="chapter" data-level="18.9.1" data-path="counts.html"><a href="counts.html#import-example-1-data-fig3a-angiogenic-sprouts"><i class="fa fa-check"></i><b>18.9.1</b> Import Example 1 data (fig3a – “angiogenic sprouts”)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="gls.html"><a href="gls.html"><i class="fa fa-check"></i><b>19</b> Linear models with heterogenous variance</a></li>
<li class="chapter" data-level="" data-path="appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models.html"><a href="appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models.html"><i class="fa fa-check"></i>Appendix: An example set of analyses of experimental data with linear models</a></li>
<li class="chapter" data-level="20" data-path="ask1-bio.html"><a href="ask1-bio.html"><i class="fa fa-check"></i><b>20</b> Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li class="chapter" data-level="21" data-path="ask1-report.html"><a href="ask1-report.html"><i class="fa fa-check"></i><b>21</b> Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a>
<ul>
<li class="chapter" data-level="21.1" data-path="ask1-report.html"><a href="ask1-report.html#setup"><i class="fa fa-check"></i><b>21.1</b> Setup</a></li>
<li class="chapter" data-level="21.2" data-path="ask1-report.html"><a href="ask1-report.html#data-source"><i class="fa fa-check"></i><b>21.2</b> Data source</a></li>
<li class="chapter" data-level="21.3" data-path="ask1-report.html"><a href="ask1-report.html#control-the-color-palette"><i class="fa fa-check"></i><b>21.3</b> control the color palette</a></li>
<li class="chapter" data-level="21.4" data-path="ask1-report.html"><a href="ask1-report.html#useful-functions"><i class="fa fa-check"></i><b>21.4</b> useful functions</a></li>
<li class="chapter" data-level="21.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2b-effect-of-ask1-deletion-on-growth-body-weight"><i class="fa fa-check"></i><b>21.5</b> figure 2b – effect of ASK1 deletion on growth (body weight)</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2b-import"><i class="fa fa-check"></i><b>21.5.1</b> figure 2b – import</a></li>
<li class="chapter" data-level="21.5.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2b-exploratory-plots"><i class="fa fa-check"></i><b>21.5.2</b> figure 2b – exploratory plots</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-effect-of-ask1-deletion-on-final-body-weight"><i class="fa fa-check"></i><b>21.6</b> Figure 2c – Effect of ASK1 deletion on final body weight</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-import"><i class="fa fa-check"></i><b>21.6.1</b> Figure 2c – import</a></li>
<li class="chapter" data-level="21.6.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-check-own-computation-of-weight-change-v-imported-value"><i class="fa fa-check"></i><b>21.6.2</b> Figure 2c – check own computation of weight change v imported value</a></li>
<li class="chapter" data-level="21.6.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-exploratory-plots"><i class="fa fa-check"></i><b>21.6.3</b> Figure 2c – exploratory plots</a></li>
<li class="chapter" data-level="21.6.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-fit-the-model-m1-lm"><i class="fa fa-check"></i><b>21.6.4</b> Figure 2c – fit the model: m1 (lm)</a></li>
<li class="chapter" data-level="21.6.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-check-the-model-m1"><i class="fa fa-check"></i><b>21.6.5</b> Figure 2c – check the model: m1</a></li>
<li class="chapter" data-level="21.6.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-fit-the-model-m2-gamma-glm"><i class="fa fa-check"></i><b>21.6.6</b> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li class="chapter" data-level="21.6.7" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-check-the-model-m2"><i class="fa fa-check"></i><b>21.6.7</b> Figure 2c – check the model, m2</a></li>
<li class="chapter" data-level="21.6.8" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-inference-from-the-model"><i class="fa fa-check"></i><b>21.6.8</b> Figure 2c – inference from the model</a></li>
<li class="chapter" data-level="21.6.9" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-plot-the-model"><i class="fa fa-check"></i><b>21.6.9</b> Figure 2c – plot the model</a></li>
<li class="chapter" data-level="21.6.10" data-path="ask1-report.html"><a href="ask1-report.html#figure-2c-report"><i class="fa fa-check"></i><b>21.6.10</b> Figure 2c – report</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><i class="fa fa-check"></i><b>21.7</b> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a>
<ul>
<li class="chapter" data-level="21.7.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-import"><i class="fa fa-check"></i><b>21.7.1</b> Figure 2d – Import</a></li>
<li class="chapter" data-level="21.7.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-exploratory-plots"><i class="fa fa-check"></i><b>21.7.2</b> Figure 2d – exploratory plots</a></li>
<li class="chapter" data-level="21.7.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-fit-the-model"><i class="fa fa-check"></i><b>21.7.3</b> Figure 2d – fit the model</a></li>
<li class="chapter" data-level="21.7.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-check-the-model"><i class="fa fa-check"></i><b>21.7.4</b> Figure 2d – check the model</a></li>
<li class="chapter" data-level="21.7.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-inference"><i class="fa fa-check"></i><b>21.7.5</b> Figure 2d – inference</a></li>
<li class="chapter" data-level="21.7.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2d-plot-the-model"><i class="fa fa-check"></i><b>21.7.6</b> Figure 2d – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.8" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure"><i class="fa fa-check"></i><b>21.8</b> Figure 2e – Effect of ASK1 deletion on glucose tolerance (summary measure)</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-message-the-data"><i class="fa fa-check"></i><b>21.8.1</b> Figure 2e – message the data</a></li>
<li class="chapter" data-level="21.8.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-exploratory-plots"><i class="fa fa-check"></i><b>21.8.2</b> Figure 2e – exploratory plots</a></li>
<li class="chapter" data-level="21.8.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-fit-the-model"><i class="fa fa-check"></i><b>21.8.3</b> Figure 2e – fit the model</a></li>
<li class="chapter" data-level="21.8.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-check-the-model"><i class="fa fa-check"></i><b>21.8.4</b> Figure 2e – check the model</a></li>
<li class="chapter" data-level="21.8.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-inference-from-the-model"><i class="fa fa-check"></i><b>21.8.5</b> Figure 2e – inference from the model</a></li>
<li class="chapter" data-level="21.8.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2e-plot-the-model"><i class="fa fa-check"></i><b>21.8.6</b> Figure 2e – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate"><i class="fa fa-check"></i><b>21.9</b> Figure 2f – Effect of ASK1 deletion on glucose infusion rate</a>
<ul>
<li class="chapter" data-level="21.9.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-import"><i class="fa fa-check"></i><b>21.9.1</b> Figure 2f – import</a></li>
<li class="chapter" data-level="21.9.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-exploratory-plots"><i class="fa fa-check"></i><b>21.9.2</b> Figure 2f – exploratory plots</a></li>
<li class="chapter" data-level="21.9.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-fit-the-model"><i class="fa fa-check"></i><b>21.9.3</b> Figure 2f – fit the model</a></li>
<li class="chapter" data-level="21.9.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-check-the-model"><i class="fa fa-check"></i><b>21.9.4</b> Figure 2f – check the model</a></li>
<li class="chapter" data-level="21.9.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-inference"><i class="fa fa-check"></i><b>21.9.5</b> Figure 2f – inference</a></li>
<li class="chapter" data-level="21.9.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2f-plot-the-model"><i class="fa fa-check"></i><b>21.9.6</b> Figure 2f – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.10" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake"><i class="fa fa-check"></i><b>21.10</b> Figure 2g – Effect of ASK1 deletion on tissue-specific glucose uptake</a>
<ul>
<li class="chapter" data-level="21.10.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-import"><i class="fa fa-check"></i><b>21.10.1</b> Figure 2g – import</a></li>
<li class="chapter" data-level="21.10.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-exploratory-plots"><i class="fa fa-check"></i><b>21.10.2</b> Figure 2g – exploratory plots</a></li>
<li class="chapter" data-level="21.10.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-fit-the-model"><i class="fa fa-check"></i><b>21.10.3</b> Figure 2g – fit the model</a></li>
<li class="chapter" data-level="21.10.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-check-the-model"><i class="fa fa-check"></i><b>21.10.4</b> Figure 2g – check the model</a></li>
<li class="chapter" data-level="21.10.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-inference"><i class="fa fa-check"></i><b>21.10.5</b> Figure 2g – inference</a></li>
<li class="chapter" data-level="21.10.6" data-path="ask1-report.html"><a href="ask1-report.html#figure-2g-plot-the-model"><i class="fa fa-check"></i><b>21.10.6</b> Figure 2g – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="21.11" data-path="ask1-report.html"><a href="ask1-report.html#figure-2h"><i class="fa fa-check"></i><b>21.11</b> Figure 2h</a></li>
<li class="chapter" data-level="21.12" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-effect-of-ask1-deletion-on-liver-tg"><i class="fa fa-check"></i><b>21.12</b> Figure 2i – Effect of ASK1 deletion on liver TG</a>
<ul>
<li class="chapter" data-level="21.12.1" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-fit-the-model"><i class="fa fa-check"></i><b>21.12.1</b> Figure 2i – fit the model</a></li>
<li class="chapter" data-level="21.12.2" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-check-the-model"><i class="fa fa-check"></i><b>21.12.2</b> Figure 2i – check the model</a></li>
<li class="chapter" data-level="21.12.3" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-inference"><i class="fa fa-check"></i><b>21.12.3</b> Figure 2i – inference</a></li>
<li class="chapter" data-level="21.12.4" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-plot-the-model"><i class="fa fa-check"></i><b>21.12.4</b> Figure 2i – plot the model</a></li>
<li class="chapter" data-level="21.12.5" data-path="ask1-report.html"><a href="ask1-report.html#figure-2i-report-the-model"><i class="fa fa-check"></i><b>21.12.5</b> Figure 2i – report the model</a></li>
</ul></li>
<li class="chapter" data-level="21.13" data-path="ask1-report.html"><a href="ask1-report.html#figure-2j"><i class="fa fa-check"></i><b>21.13</b> Figure 2j</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="count-sim.html"><a href="count-sim.html"><i class="fa fa-check"></i><b>22</b> Simulations – Count data (alternatives to a t-test)</a>
<ul>
<li class="chapter" data-level="22.1" data-path="count-sim.html"><a href="count-sim.html#use-data-similar-to-figure-6f-from-example-1"><i class="fa fa-check"></i><b>22.1</b> Use data similar to Figure 6f from Example 1</a></li>
<li class="chapter" data-level="22.2" data-path="count-sim.html"><a href="count-sim.html#functions"><i class="fa fa-check"></i><b>22.2</b> Functions</a></li>
<li class="chapter" data-level="22.3" data-path="count-sim.html"><a href="count-sim.html#simulations"><i class="fa fa-check"></i><b>22.3</b> Simulations</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="count-sim.html"><a href="count-sim.html#type-i-pseudo-normal-distribution"><i class="fa fa-check"></i><b>22.3.1</b> Type I, Pseudo-Normal distribution</a></li>
<li class="chapter" data-level="22.3.2" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-equal-n"><i class="fa fa-check"></i><b>22.3.2</b> Type I, neg binom, equal n</a></li>
<li class="chapter" data-level="22.3.3" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-equal-n-small-theta"><i class="fa fa-check"></i><b>22.3.3</b> Type I, neg binom, equal n, small theta</a></li>
<li class="chapter" data-level="22.3.4" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-unequal-n"><i class="fa fa-check"></i><b>22.3.4</b> Type I, neg binom, unequal n</a></li>
<li class="chapter" data-level="22.3.5" data-path="count-sim.html"><a href="count-sim.html#power-pseudo-normal-distribution-equal-n"><i class="fa fa-check"></i><b>22.3.5</b> Power, Pseudo-Normal distribution, equal n</a></li>
<li class="chapter" data-level="22.3.6" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-equal-n"><i class="fa fa-check"></i><b>22.3.6</b> Power, neg binom, equal n</a></li>
<li class="chapter" data-level="22.3.7" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-small-theta"><i class="fa fa-check"></i><b>22.3.7</b> Power, neg binom, small theta</a></li>
<li class="chapter" data-level="22.3.8" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-unequal-n"><i class="fa fa-check"></i><b>22.3.8</b> Power, neg binom, unequal n</a></li>
<li class="chapter" data-level="22.3.9" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-unequal-n-unequal-theta"><i class="fa fa-check"></i><b>22.3.9</b> Power, neg binom, unequal n, unequal theta</a></li>
<li class="chapter" data-level="22.3.10" data-path="count-sim.html"><a href="count-sim.html#type-1-neg-binom-equal-n-unequal-theta"><i class="fa fa-check"></i><b>22.3.10</b> Type 1, neg binom, equal n, unequal theta</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="count-sim.html"><a href="count-sim.html#save-it-read-it"><i class="fa fa-check"></i><b>22.4</b> Save it, Read it</a></li>
<li class="chapter" data-level="22.5" data-path="count-sim.html"><a href="count-sim.html#analysis"><i class="fa fa-check"></i><b>22.5</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html"><i class="fa fa-check"></i>Appendix 1: Getting Started with R</a>
<ul>
<li class="chapter" data-level="22.6" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready"><i class="fa fa-check"></i><b>22.6</b> Get your computer ready</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-here"><i class="fa fa-check"></i><b>22.6.1</b> Start here</a></li>
<li class="chapter" data-level="22.6.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r"><i class="fa fa-check"></i><b>22.6.2</b> Install R</a></li>
<li class="chapter" data-level="22.6.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-studio"><i class="fa fa-check"></i><b>22.6.3</b> Install R Studio</a></li>
<li class="chapter" data-level="22.6.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-markdown-1"><i class="fa fa-check"></i><b>22.6.4</b> Install R Markdown</a></li>
<li class="chapter" data-level="22.6.5" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#optional-alternative-latex-installations"><i class="fa fa-check"></i><b>22.6.5</b> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-learning-r-studio"><i class="fa fa-check"></i><b>22.7</b> Start learning R Studio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><i class="fa fa-check"></i>Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics for the Experimental Biologist</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Data – Reading, Wrangling, and Writing<a href="data.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This text avoids canned data sets from R packages because importing and wrangling data is a major obstacle in <em>doing</em> statistics for new R learners. Coding the import of raw data archived in text (or Excel or Google sheets) format is a best practice for increasing replicability.</p>
<p>Importing data is difficult for new R learners for two reasons</p>
<ol style="list-style-type: decimal">
<li>Many experimental biology researchers archive the data in a format that might make sense for analysis in Excel, but doesn’t work for analysis in most other statistical software, including R, without significant post-import processing (or <strong>wrangling</strong>) the data. This includes</li>
</ol>
<ul>
<li>data in <strong>wide format</strong>, where the measures of the response variable for each treatment level is in a different column</li>
<li>data in <strong>transposed format</strong>, where the measures of the response variable are in a row instead of a column (or the measures for each treatment level are in a separate row)</li>
<li>missing values that are represented by different things, sometimes in the same table. These things include blank cells, periods, hyphens, the word “NA”, or numbers such as -9999.</li>
<li>column headers that have multiple words separated by spaces</li>
<li>sheets with a variable number of empty cells that separate values within different groups</li>
<li>sheets that contain information about the data using colored blocks of cells or other formats</li>
</ul>
<p>These issues are solved by archiving data in (tidy data format)<span target="_blank"><a href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html" class="uri">https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html</a></span>. The hallmark of tidy data is data in <strong>long format</strong>, which is introduced in the next section (Section @data-long). Nevertheless, most students and researchers will have colleagues that share non-tidy data and a critical skill for R users is the ability to tidy data.</p>
<ol start="2" style="list-style-type: decimal">
<li>A file on a hard drive has an address, or <strong>file path</strong> that is specific to both place (the specific computer) and time (the file organization of the computer). If we move a data file to another computer, or even to another directory within the same computer, the address changes. Modern computer users are at least vaguely familiar with the hierarchical organization of file storage (most students in my classes seem to store everything they create on the desktop) but are unaware of the concept of a file path and confused by what this path is. When we use a menu-driven system to open a file, the OS is constructing the file path under the hood. But when coding, we need to give R the file path. There are several imperfect methods for coding the path the the data file. There is one perfect method – the function <code>here</code> from the here package. This is discussed in <a href="#data-here%7D">Use the here function to construct the file path</a></li>
</ol>
<div id="data-long" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Long data format – the way data should be<a href="data.html#data-long" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Some best practices for archiving data tables, including archived data at journal websites, are illustrated by the format of the data in Table <a href="data.html#tab:data-diet-table">3.1</a>.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:data-diet-table">Table 3.1: </span>First six rows of the diet data set.
</caption>
<thead>
<tr>
<th style="text-align:left;">
subject_id
</th>
<th style="text-align:left;">
institution
</th>
<th style="text-align:left;">
diet
</th>
<th style="text-align:right;">
vo2
</th>
<th style="text-align:right;">
lean_mass
</th>
<th style="text-align:right;">
fat_mass
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
D1
</td>
<td style="text-align:left;">
UC Davis
</td>
<td style="text-align:left;">
HF
</td>
<td style="text-align:right;">
129.5653
</td>
<td style="text-align:right;">
24.33708
</td>
<td style="text-align:right;">
15.862920
</td>
</tr>
<tr>
<td style="text-align:left;">
D10
</td>
<td style="text-align:left;">
UC Davis
</td>
<td style="text-align:left;">
LF
</td>
<td style="text-align:right;">
100.0749
</td>
<td style="text-align:right;">
21.08880
</td>
<td style="text-align:right;">
3.151200
</td>
</tr>
<tr>
<td style="text-align:left;">
D11
</td>
<td style="text-align:left;">
UC Davis
</td>
<td style="text-align:left;">
LF
</td>
<td style="text-align:right;">
118.3097
</td>
<td style="text-align:right;">
22.56076
</td>
<td style="text-align:right;">
6.659238
</td>
</tr>
<tr>
<td style="text-align:left;">
D12
</td>
<td style="text-align:left;">
UC Davis
</td>
<td style="text-align:left;">
LF
</td>
<td style="text-align:right;">
107.7487
</td>
<td style="text-align:right;">
22.11884
</td>
<td style="text-align:right;">
5.351156
</td>
</tr>
<tr>
<td style="text-align:left;">
D13
</td>
<td style="text-align:left;">
UC Davis
</td>
<td style="text-align:left;">
LF
</td>
<td style="text-align:right;">
104.7367
</td>
<td style="text-align:right;">
21.17438
</td>
<td style="text-align:right;">
5.005616
</td>
</tr>
<tr>
<td style="text-align:left;">
D14
</td>
<td style="text-align:left;">
UC Davis
</td>
<td style="text-align:left;">
HF
</td>
<td style="text-align:right;">
138.6420
</td>
<td style="text-align:right;">
24.64885
</td>
<td style="text-align:right;">
16.501150
</td>
</tr>
</tbody>
</table>
<p>The best practices included in the archived data include</p>
<ol style="list-style-type: decimal">
<li>The data table contains all measures on each individual. In most of the archived Excel files that I download from journal websites, the researchers have separated each variable into separate tables and exclude all information from these tables other than the treatment group. For example, researchers would typically archive the vo2 values in Table <a href="data.html#tab:data-diet-table">3.1</a> in a separate table within an Excel sheet and with the values split by diet group (high fat “HF” and low fat “LF”)(Figure <a href="data.html#fig:data-vo2-table-wide">3.1</a>). Don’t do this.</li>
</ol>
<div class="figure"><span style="display:block;" id="fig:data-vo2-table-wide"></span>
<img src="images/data-vo2_wide.png" alt="The vo2 values separated from the rest of the data and split into separate diet groups." width="199" />
<p class="caption">
Figure 3.1: The vo2 values separated from the rest of the data and split into separate diet groups.
</p>
</div>
<ul>
<li>We don’t want to separate each variable into separate tables because we often want to use information from other measures of the same individual in our analysis. For example, for the comparison of <span class="math inline">\(\texttt{vo2}\)</span> among treatment levels, we would want to add the measure of <span class="math inline">\(\texttt{lean_mass}\)</span> to the model as a covariate (what is often called an ANCOVA model). To do this, we’d need to know which values of <span class="math inline">\(\texttt{vo2}\)</span> and values of <span class="math inline">\(\texttt{lean_mass}\)</span> belong to the same individual.</li>
<li>Even if you think you have analyzed the data using a best practice, don’t separate each variable into separate tables. Researchers sometimes fail to recognize best practices. Any re-analysis of published data using best practices often require information from other measures of the same individual. For example, many researchers would compare the ratio of <span class="math inline">\(\texttt{vo2}\)</span> to <span class="math inline">\(\texttt{total_mass}\)</span> among treatment levels. This isn’t a best practice and if I want to check the researchers conclusions, I’d need a table like Table <a href="data.html#tab:data-diet-table">3.1</a> to re-analyze the data.</li>
<li>Even if you have used what is considered a best practice, don’t separate each variable into separate tables. Sometimes a researcher wants to use data from published data sets to parameterize a mechanistic model. Or, use data from published data sets to explore patterns of relationships among variables, for example how fat mass scales with lean mass (or total mass). For these, we need a table like Table <a href="data.html#tab:data-diet-table">3.1</a> to re-analyze the data.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>The researchers organized the table with individuals in rows. A data table with all measures for each individual could organize the data with each row or each column belonging to one individual. The best practice for most analysis in R (and most other statistical software) is to organize individuals to rows (there are exceptions in some R packages that analyze genomics datasets).</li>
<li>The researchers organized the data in <strong>long format</strong> – that is, each column contains <em>all</em> measures of a single variable. In general, do not organize the data in <strong>wide format</strong>, by splitting the values of a variable into multiple columns, with each column representing the values for a different group. An example of wide format is in Figure <a href="data.html#fig:data-vo2-table-wide">3.1</a>, which is the <span class="math inline">\(\texttt{vo2}\)</span> subset of data split by the groups in the columne <span class="math inline">\(\texttt{diet}\)</span>. By contrast, the <span class="math inline">\(\texttt{vo2}\)</span> data are in long format in the original table (Table <a href="data.html#tab:data-diet-table">3.1</a>). It might be useful to think of long format for a variable as a single column with the values for each group <strong>stacked</strong> on top of each other.</li>
</ol>
<p>In general, R and almost all other statistical software (one exception is Graphpad Prism) require the data to be in long format.</p>
<ul>
<li>A reason for this is because the long format is consistent with the math underneath the statistical modeling of data. For example, the least squares solution of the linear model is</li>
</ul>
<p><span class="math display">\[
\mathbf{b} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{y}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{X}\)</span> is the <strong>model matrix</strong>, a table of numeric values with each row containing the values of the <span class="math inline">\(X\)</span> variables for an individual (categorical variables such as <span class="math inline">\(\texttt{diet}\)</span> are recoded into one or more numeric <strong>indicator variables</strong> indicating group membership). The model matrix is in long format.
* A second reason is organizational simplicity. Statistical models often include multiple variables measured on the same individual – the example above with <span class="math inline">\(\texttt{lean_mass}\)</span> added as a covariate is an example. With data in wide format, there is no non-awkward way to match values of <span class="math inline">\(\texttt{lean_mass}\)</span> with values of <span class="math inline">\(\texttt{vo2}\)</span> from the same individual. Or, in models with <a href="factorial.html#factorial">crossed factor variables</a>, for example, an experiment with four groups repesenting all four combinations of the variables <span class="math inline">\(\texttt{genotype}\)</span> (with levels “WT” and “KO”) and <span class="math inline">\(\texttt{treatment}\)</span> (with levels “Control” and “HFD”), there is no non-awkward way (at least in a table with a single header row) to indicate that the design is two crossed factors. In wide format, the design appears to be a single factor with four groups.</p>
<p>Don’t confuse a data table with multiple columns of <em>different</em> variables with a data table in wide format. Long and wide are relevant to how a single variable is organized – if split into multiple columns the table is wide, if stacked into a single column, the table is long.</p>
<p>One exception to long format is a <strong>longitudinal</strong> or a <strong>repeated measures</strong> data set (Chapter <a href="pre-post.html#pre-post">17</a>), in which the response variable is measured multiple times on each individual. An example might be a <em>pre-post</em> design where a variable is measured both before and after a treatment is applied or an experiment where the response is measured each week for multiple weeks. In <strong>univariate</strong> models for the analyses of these data, the multiple measures for an individual are stacked into long format. As a consequence, there are now multiple rows of data for each individual (one for each measure of the variable). In <strong>multivariate</strong> models for the analyses of these data, the multiple measures for an individual are treated as if they are different variables and are spread out into wide format.</p>
<ol start="4" style="list-style-type: decimal">
<li>The table includes the raw values. Many researchers normalize or standarize the values of a variable by constructing a ratio of the raw value divided by some standardizing value. Almost always, the best practice is to leave the response variable alone (do not make a ratio) and include the standardizing value as a covariate (or offset) in the model. But, if I want to check th conclusions of a particular result in which the researchers used a ratio as the response variable, then I would need the raw measures and the standardizing values.</li>
</ol>
</div>
<div id="data-here" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Use the here function to construct the file path<a href="data.html#data-here" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Importing data into R can be a struggle for new R users and, unfortunately, most online “how to import” sources give easy but superficial methods that don’t follow best practices for increasing reproducibility or do not allow flexible organization of files within a project.</p>
<p>(TL;DR – use <code>here()</code> from the here package)</p>
<ol style="list-style-type: decimal">
<li><code>df &lt;- read.table(file="clipboard")</code> imports data copied to the clipboard, from an Excel/Sheets file or from an open text file. For this to be semi-reproducible, a comment specifying the filename, worksheet and range that was copied is necessary. More problematic (catastrophically so for reproducibility), is, how does a researcher know that they highlighted and copied the correct range in the Excel sheet?</li>
<li><code>df &lt;- read.csv(file.choose())</code> opens the familiar “open file” dialog box, which lets the user navigate to the file of choice. For this to be semi-reproducible, a comment specifying the filename to import is necessary. The catastrophic problem (for reproducibility) is, how does a researcher know which file was actually opened during an R session? The researcher might think they opened “walker_maine_bee_data_clean_androscoggin.csv” but mistakenly opened “walker_maine_bee_data_clean_aroostook.csv”.</li>
<li><code>df &lt;- read.table(file="my_data.txt")</code> and <code>df &lt;- read_excel(file="my_data.xlsx")</code> are reproducible because the filename is explicitly specified. But, this method requires that “my_data” is physically located in the same folder as the file containing the R script (the .Rmd file in our case) and this violates the best practice of clean project organization with different folders for the different kinds of files (data, R scripts, images, manuscript text, etc.).</li>
<li>R Studio has an elegant import tool in the environment pane that opens a custom dialog box that allows the researcher to navigate to the file, and to specify what part of the file to import, such as the specific sheet and range for an Excel file. This has the same reproducibility issues as #1 and #2 but R Studio includes the equivalent script, which adds all relevant information for reproducility. One then simply copies and pastes this script into a code chunk and voila! The next time the script is run, the data can be imported from the script without using menus and dialog boxes. Except that..the script does not seem to take into account that the <strong>working directory</strong> of an R Markdown file is not the project folder but the folder containing the R Markdown file and so this two-step method fails. More personally, I’d prefer to run a chunk that quickly opens the data file instead of re-navigating through my file system and re-specifying the sheet and range every time I re-start the project in a new R session.</li>
</ol>
<p>There are at least three solutions to the issues raised above, all requiring some understanding of <strong>file paths</strong> and directory structure in an operating system. A file such as “my_data.xlsx” has an <strong>absolute</strong> file path, which is the full address of the file (the filename is something like your house street number). The absolute file path of “my_data.xlsx” might be “/Users/jwalker/Documents/applied-biostatistics/data/my_data.xlsx”. A <strong>relative</strong> file path is the file path from the <strong>working directory</strong>. In an R Studio project, the working directory is the project directory, which is the directory containing the .Rproj file. This will be the working directory of the console. <em>Importantly</em>, the working directory of an R Markdown code chunk is the folder containing the saved R Markdown file. An R Studio Notebook is an R Markdown file so the working directory of a notebook code chunk is the folder containing the saved notebook file. If an R Markdown file is located within the <em>rmd</em> folder, which is located within the project folder, then the relative file path to “my_file.xlsx” is “../data/my_file.xlsx”. The “..” tells the file OS to move “up” into the parent directory (which is the project folder) and the “data” tells the file OS to move “down” into the data folder. These are put together into a single address using “/”. The beauty of relative paths is that they remain the same – and so do not break one’s script – if the project folder, and all of its contents including the <em>data</em> folder and the <em>rmd</em> folder, is moved to another location on the hard drive (say into a new “Research” folder). By contrast, the absolute file path changes, which breaks any old script.</p>
<p>The three solutions are</p>
<ol style="list-style-type: decimal">
<li>Create a <strong>relative path</strong> to the file using something like <code>file_path &lt;- "../data/my_data.xlsx"</code>. This should <em>always</em> work but it fails on some computers. For example, if the project folder is on a Windows OS (but not Mac OS) desktop, the assigned relative address doesn’t seem to look in the folder containing the file.</li>
<li>Create a setup chunk that reroutes the working directory to the project folder using the script</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data.html#cb10-1" tabindex="-1"></a><span class="co"># use this in a chuck called &quot;setup&quot; to force the working directory to be</span></span>
<span id="cb10-2"><a href="data.html#cb10-2" tabindex="-1"></a><span class="co"># at the level of the project file.</span></span>
<span id="cb10-3"><a href="data.html#cb10-3" tabindex="-1"></a>knitr<span class="sc">::</span>opts_knit<span class="sc">$</span><span class="fu">set</span>(<span class="at">root.dir =</span> rprojroot<span class="sc">::</span><span class="fu">find_rstudio_root_file</span>())</span></code></pre></div>
<p>For this to work, the chunk has to be named “setup”, that is, the text inside the curly brackets at the top of the chunk should be “r setup”. Then, with this chunk, the relative file path is <code>file_path &lt;- "../data/my_data.xlsx"</code> if “my_data.xlsx” is immediately inside the data folder which is immediately inside the project folder. This should work on any machine, and should work even if a project folder is moved.</p>
<ol start="3" style="list-style-type: decimal">
<li>Use the function <code>here()</code>. The most robust solution seems to be using the function <code>here()</code> from the here package. The function works something like this</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data.html#cb11-1" tabindex="-1"></a>data_folder <span class="ot">&lt;-</span> <span class="st">&quot;data&quot;</span> <span class="co"># path to data that are imported</span></span>
<span id="cb11-2"><a href="data.html#cb11-2" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;my_data.xlsx&quot;</span></span>
<span id="cb11-3"><a href="data.html#cb11-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, file_name) <span class="co"># paste together parts of the address</span></span>
<span id="cb11-4"><a href="data.html#cb11-4" tabindex="-1"></a>my_file <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">file =</span> file_path)</span></code></pre></div>
<p><code>here()</code> creates an absolute path, but one that is created on the fly, and will change (or should change) correctly if the project folder is moved on the same machine, to a cloud drive, or to another machine altogether.</p>
</div>
<div id="learning-from-this-chapter" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Learning from this chapter<a href="data.html#learning-from-this-chapter" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It will be easiest to learn from this chapter by starting with a clean R Markdown document for this chapter. Create a new R Markdown file and save it to the “Rmd” folder of your project. To create and setup the Rmd, follow the steps in <a href="getting-started-r-projects-and-r-markdown.html#setup-create-rmd">Create and setup an R Markdown document (Rmd)</a></p>
<p><strong>Important:</strong> The import method given here will not work properly until the Rmd file is saved! Get in the habit of creating the file, saving it immediately, and saving it often.</p>
<p><strong>Important:</strong> The import method will not work properly unless you are working within your R studio project. If you don’t see the name of the project in the upper right of the R Studio toolbar, then you are not in the project. Open the project before moving forward. A good habit is to open R studio by double clicking the project file icon (and not the R Studio icon or the Rmd document that you are working on).</p>
<p>Notes on the setup chunk from <a href="getting-started-r-projects-and-r-markdown.html#setup-create-rmd">Create and setup an R Markdown document (Rmd)</a></p>
<ol style="list-style-type: decimal">
<li>As you become a better R programmer, be kind to the future you by loading only the packages necessary for the code in the R Markdown file that you are working on. If your default is to load everything, the future you will be confused why something was installed. Again, we’ve disregarded this best practice in this textbook to make sure that chunks don’t fail because of a missing function.</li>
<li>Be kind to the future you by commenting on why a package is loaded; usually this is a specific function from the package</li>
<li><code>here &lt;- here::here</code> is my favorite script ever. What is it doing? One can read this as “assign the function here from the here package to the object here” (this is reading the script right to left). Why do this? It turns out the multiple packages define a function called “here”. If any of these packages are loaded after the here package, then <code>here</code> from here won’t work – it will be replaced by <code>here</code> from the more recently loaded package. To make sure that <code>here</code> uses the function from the here package, I simply reassign <code>here</code> from the here package to the object “here” <em>after</em> loading in all packages.</li>
</ol>
</div>
<div id="data-working-in-r" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Working in R<a href="data.html#data-working-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="importing-data" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Importing data<a href="data.html#importing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="importing-excel-files" class="section level4 hasAnchor" number="3.4.1.1">
<h4><span class="header-section-number">3.4.1.1</span> Importing Excel files<a href="data.html#importing-excel-files" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Source article</strong>: <a href="https://elifesciences.org/articles/59399" target="_blank">Lyu, Yang, et al. “Drosophila serotonin 2A receptor signaling coordinates central metabolic processes to modulate aging in response to nutrient choice.” Elife 10 (2021): e59399.</a></p>
<p><strong>file name</strong>: <a href="https://cdn.elifesciences.org/articles/59399/elife-59399-fig1-data1-v2.xlsx" target="_blank">elife-59399-fig1-data1-v2.xlsx</a></p>
<p>Let’s open the data for Fig. 1H.</p>
<p>Steps</p>
<ol style="list-style-type: decimal">
<li>Highlight and copy the title of the article, which is “Drosophila serotonin 2A receptor signaling coordinates central metabolic processes to modulate aging in response to nutrient choice”</li>
<li>Create a new folder within the “data” folder. Name the folder the title of the paper by pasting the name from the clipboard. This is the “data from” folder, since it contains the data from the publication with the title of the folder.</li>
<li>Download the .xlsx file and move it into this folder</li>
</ol>
<p>The code below uses the function <code>read_excel()</code> from the package readxl. More about the amazing power of this package is the <a href="https://readxl.tidyverse.org" target="_blank">tidyverse page</a> and <a href="http://r4ds.had.co.nz/data-import.html" target="_blank">chapter 11</a> in the <em>R for Data Science</em> book.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data.html#cb12-1" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Drosophila serotonin 2A receptor signaling coordinates central metabolic processes to modulate aging in response to nutrient choice&quot;</span></span>
<span id="cb12-2"><a href="data.html#cb12-2" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;elife-59399-fig1-data1-v2.xlsx&quot;</span></span>
<span id="cb12-3"><a href="data.html#cb12-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb12-4"><a href="data.html#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="data.html#cb12-5" tabindex="-1"></a>exp1h <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path, </span>
<span id="cb12-6"><a href="data.html#cb12-6" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;H&quot;</span>)</span>
<span id="cb12-7"><a href="data.html#cb12-7" tabindex="-1"></a>exp1h <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(exp1h) <span class="co"># clean column names</span></span>
<span id="cb12-8"><a href="data.html#cb12-8" tabindex="-1"></a>exp1h <span class="ot">&lt;-</span> <span class="fu">data.table</span>(exp1h) <span class="co"># convert to data.table</span></span>
<span id="cb12-9"><a href="data.html#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="data.html#cb12-10" tabindex="-1"></a><span class="co"># View(exp1h)</span></span></code></pre></div>
<p>This book will consistently uses this protocol for importing downloaded Excel files. For <em>any</em> tidy archived data in Excel, a user would simply copy this chunk, paste it into their Rmd, and modify the stuff inside the quotes to import the data. But this is mindless programming. Don’t do this. Understand what each line in the chunk does.</p>
<div id="view-the-data" class="section level5 hasAnchor" number="3.4.1.1.1">
<h5><span class="header-section-number">3.4.1.1.1</span> View the data<a href="data.html#view-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Let’s start with the last line, which is commented out</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="data.html#cb13-1" tabindex="-1"></a><span class="co"># View(exp1h)</span></span></code></pre></div>
<p>The <strong>comment</strong> (or hashtag) symbol (#) tells R to ignore everything in the line following the symbol. Usually a comment symbol is followed by a brief comment on the code. This comment if mostly for the future you – when you come back after a six month hiatus and wonder what a line or block of code is doing, the comment gives you this information. Sometimes a comment is used in front of R code to keep the R code from running. That is the purpose of the comment symbol here.</p>
<p><code>View(exp1h)</code> tells R to open a window showing a spreadsheet view of the data.table <code>exp1h</code>. In R studio, this window is opened as a new tab in the Source editor pane (the pane with your Rmd content). To run this code, highlight “View(exp1h)” but not the comment symbol and click the “Run selected line(s)” item in the Run pop-up menu (right side of pane’s tool bar). We don’t include the comment sign in the highlight because this would tell R to ignore everything after it.</p>
<p>We can view the data in <code>exp1h</code> more easily by holding the command key (Mac OS) or the control key (Windows) and clicking the mouse in “exp1h” in any of the lines. Even though I use the mouse click method, I like to have the <code>View(exp1h)</code> at the end of my import chunk to remind me to View the data to make sure everthing imported correctly.</p>
</div>
<div id="what-does-each-line-in-the-chunk-do" class="section level5 hasAnchor" number="3.4.1.1.2">
<h5><span class="header-section-number">3.4.1.1.2</span> What does each line in the chunk do?<a href="data.html#what-does-each-line-in-the-chunk-do" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The first three lines in the chunk create the directory path to the file. This path includes three variables</p>
<ol style="list-style-type: decimal">
<li><code>data_folder</code> – assigned to “data” in the setup chunk. “data” is a folder within the project folder that contains (or will contain) all datasets for this text. The data come from many different published papers, so the data for each publication gets its own folder within “data”.</li>
<li><code>data_from</code> – the name of the “data from” folder within “data” containing the data files. In this text, these folder names will always be the name of the published paper.</li>
<li><code>filename</code> – the name of the file to read. There may be multiple data files within the publication’s data folder.</li>
</ol>
<p>These are all put together into the absolute path using the function <code>here()</code> from the here package. Take a look at the value of file_path to confirm.</p>
<p>The next three lines (starting with <code>exp1h &lt;-</code>)</p>
<ol style="list-style-type: decimal">
<li><code>read_excel</code> imports the data and assign this to a data.frame named <code>exp1h</code></li>
<li><code>clean_names</code> cleans the column names of <code>exp1h</code></li>
<li><code>data.table</code> converts <code>exp1h</code> to a data.table. A data.table is a data.frame with magical properties.</li>
</ol>
<p>In steps 2 and 3, the functions take the data.frame and process it in some way and then assigned the processed data.frame to an object that has the same name (<code>exp1h</code>). This script can be made slightly more “elegant” using the “pipe” operator <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data.html#cb14-1" tabindex="-1"></a>exp1h <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb14-2"><a href="data.html#cb14-2" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;H&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="data.html#cb14-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="data.html#cb14-4" tabindex="-1"></a>  <span class="fu">data.table</span>()</span></code></pre></div>
<p>This is a single line of code containing three separate operations all piped together. A way to think about this is</p>
<ol style="list-style-type: decimal">
<li>The <code>read_excel</code> function imports the data from the file located at file_path and assigns this data to <code>exp1h</code>. The pipe operator then sends this to</li>
<li>the <code>clean_names</code> function, which cleans the column names of <code>exp1h</code>. The pipe operator then sends this to</li>
<li>the <code>data.table</code> function, which convert the data.frame to a data.table.</li>
</ol>
<p>A 3rd way to do this is with nested functions.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data.html#cb15-1" tabindex="-1"></a>exp1h <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="fu">clean_names</span>(<span class="fu">read_excel</span>(file_path,</span>
<span id="cb15-2"><a href="data.html#cb15-2" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;H&quot;</span>))) <span class="co"># convert to data.table</span></span></code></pre></div>
<p>Prior to the creation of the pipe operator, I nested functions to make code more compact. However, nested functions are often less readable, and I now mostly avoid these and use the pipe operator instead.</p>
<p>Let’s back up to understand the steps, and especially the <code>clean_names</code> step. Here is the first line, which is the line that imports the file.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="data.html#cb16-1" tabindex="-1"></a>exp1h <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb16-2"><a href="data.html#cb16-2" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;H&quot;</span>)</span></code></pre></div>
<p>Look at the column names (or column headers in Excel lingo) of the imported data using <code>names</code> or <code>colnames</code> (yes, there are elebenty million ways to do anything in R) (<code>names</code> is very general in that it can be used to return the names of the parts of any list, while <code>colnames</code> is specific to matrix-like objects). Type this into the console, not into your R Markdown chunk:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="data.html#cb17-1" tabindex="-1"></a><span class="fu">names</span>(exp1h)</span></code></pre></div>
<pre><code>## [1] &quot;Diet&quot;             &quot;Replicate&quot;        &quot;Weight (mg/fly)&quot;  &quot;TAG (ug/fly)&quot;    
## [5] &quot;Protein (ug/fly)&quot; &quot;TAG/Protein&quot;</code></pre>
<p>In general, it is bad practice to include spaces, parentheses, and special characters such as /, -, $, or ^, in the column names of a data frame because these symbols have specific meanings in R functions. The best practice for spaces is to replace the space with an underscore, for example the column header ““Weight (mg/fly)” could be <code>weight_mg_per_fly</code>. Some coders separate words with a period (<code>weight.mg.per.fly</code>). Others mash words together into a single word like this <code>weightmgperfly</code> but this should generally be avoided because the result can be hard to read. Finally, some coders use Caps to separate words like this <code>WeightMgPerFly</code>. This is easier to read than simple concatenation but the underscore is the easiest to read.</p>
<p>The <code>clean_names</code> from the janitor package is a beautiful function to clean the column names of a data frame including replacing spaces with an underscore and stripping parentheses. The default format is <a href="https://en.wikipedia.org/wiki/Snake_case" target="_blank">snake_case</a>, which replaces all spaces with underscores and changes any uppercase letter with lowercase. Many coders like to work with all lowercase variable names to avoid having to hit the shift key. I am one of these.</p>
<p>Now run the line and look at the column names.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="data.html#cb19-1" tabindex="-1"></a>exp1h <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(exp1h)</span>
<span id="cb19-2"><a href="data.html#cb19-2" tabindex="-1"></a><span class="fu">names</span>(exp1h)</span></code></pre></div>
<pre><code>## [1] &quot;diet&quot;           &quot;replicate&quot;      &quot;weight_mg_fly&quot;  &quot;tag_ug_fly&quot;    
## [5] &quot;protein_ug_fly&quot; &quot;tag_protein&quot;</code></pre>
<p>Finally, run the line</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="data.html#cb21-1" tabindex="-1"></a>exp1h <span class="ot">&lt;-</span> <span class="fu">data.table</span>(exp1h)</span></code></pre></div>
<p>You won’t see any difference if you View the data or peak at the column names. But you’ve transformed the data frame to a data.table and given it magical properties.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p><strong>Worst Practices</strong> – resist the temptation to change the column names in the data file, which reduces reproducibility. Leave original data files original. Always increase reproducibility!</p>
</div>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p><strong>colleague blues</strong> – Most researchers live in an Excel world and save data in a way that is efficient for computing stuff in Excel but not efficient for statistical analysis using R or other statistical computing software packages (with the exception of Graphpad Prism). Analyzing data will be much less frustrating if the data are saved in a format that facilitates analysis. Best practices for creating data files</p>
<ol style="list-style-type: decimal">
<li><p><a href="https://www.youtube.com/watch?time_continue=309&amp;v=Ry2xjTBtNFE" class="uri">https://www.youtube.com/watch?time_continue=309&amp;v=Ry2xjTBtNFE</a> – An excellent video introduction to best practices for organizing data in a spreadsheet that will subsequently be analyzed by statistics software.</p></li>
<li><p>Broman, K. W., &amp; Woo, K. H. (2017). Data organization in spreadsheets (No. e3183v1). <a href="https://doi.org/10.7287/peerj.preprints.3183v1" class="uri">https://doi.org/10.7287/peerj.preprints.3183v1</a> – An excelllent review of best practices for organizing data in a spreadsheet.</p></li>
</ol>
</div>
</div>
<div id="the-read_excel-function" class="section level5 hasAnchor" number="3.4.1.1.3">
<h5><span class="header-section-number">3.4.1.1.3</span> The read_excel function<a href="data.html#the-read_excel-function" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><code>read_excel</code> is a beautifully flexible function because Excel. Data can be in different sheets and there can be different datasets within a single sheet. And, researchers tend to use Excel like a blackboard in that an Excel sheet often contains calculations such as means, standard deviations and t-tests. When using <code>read_excel</code> it is important to send the function enough information to read the correct data. For the exp1h data, if we simply used</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="data.html#cb22-1" tabindex="-1"></a>exp1h <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path) <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="data.html#cb22-2" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="data.html#cb22-3" tabindex="-1"></a>  <span class="fu">data.table</span>()</span></code></pre></div>
<p>without specifying the sheet, <code>read_excel</code> defaults to reading the first sheet (“A”), which is not what we wanted.</p>
<p>We can specify the exact range to important using the <code>range =</code> argument</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="data.html#cb23-1" tabindex="-1"></a>exp1h <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb23-2"><a href="data.html#cb23-2" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;H&quot;</span>,</span>
<span id="cb23-3"><a href="data.html#cb23-3" tabindex="-1"></a>                    <span class="at">range =</span> <span class="st">&quot;A1:F49&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="data.html#cb23-4" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="data.html#cb23-5" tabindex="-1"></a>  <span class="fu">data.table</span>()</span></code></pre></div>
<p>This isn’t necessary for these data because the “H” sheet contains only a matrix of data and not extraneous information and the <code>read_excel</code> function is smart enough to figure this out. For many of the data sets in wet bench experimental biology, the range argument will be crucial because multiple datasets are archived on a single sheet.</p>
<p>We can also specify other arguments. For example, the following code explicitly tells read_excel to use the first row of the data range to be used as the column names and not the first row of data. TRUE is the default argument, so this isn’t necessary for the exp1h data but if the data we want to import doesn’t have column names (and this can be common in archived data sets) then we need to pass the argument “col_names = FALSE”.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="data.html#cb24-1" tabindex="-1"></a>exp1h <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb24-2"><a href="data.html#cb24-2" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;H&quot;</span>,</span>
<span id="cb24-3"><a href="data.html#cb24-3" tabindex="-1"></a>                    <span class="at">range =</span> <span class="st">&quot;A1:F49&quot;</span>,</span>
<span id="cb24-4"><a href="data.html#cb24-4" tabindex="-1"></a>                    <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="data.html#cb24-5" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="data.html#cb24-6" tabindex="-1"></a>  <span class="fu">data.table</span>()</span></code></pre></div>
</div>
<div id="a-quick-plot-of-the-exp1h-data" class="section level5 hasAnchor" number="3.4.1.1.4">
<h5><span class="header-section-number">3.4.1.1.4</span> A quick plot of the exp1h data<a href="data.html#a-quick-plot-of-the-exp1h-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Just for fun, let’s use the <code>ggboxplot</code> function from the ggpubr package to reproduce something close to Fig. 1H. We could make a plot that looks exactly like Fig. 1H but this would require some of the wrangling outlined below.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="data.html#cb25-1" tabindex="-1"></a><span class="fu">ggboxplot</span>(<span class="at">data =</span> exp1h,</span>
<span id="cb25-2"><a href="data.html#cb25-2" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;diet&quot;</span>,</span>
<span id="cb25-3"><a href="data.html#cb25-3" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;tag_protein&quot;</span>,</span>
<span id="cb25-4"><a href="data.html#cb25-4" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;TAG/Protein&quot;</span>,</span>
<span id="cb25-5"><a href="data.html#cb25-5" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb25-6"><a href="data.html#cb25-6" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">&quot;jitter&quot;</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/data-plot-exp1h-1.png" width="576" /></p>
<p>Notes on the code to make this plot</p>
<ol style="list-style-type: decimal">
<li>the names of the columns to use as the x and y axes were passed inside quotes. In some R functions, column names are passed inside quotes and in other R functions, the column names are passed as-is. There is little rhyme or reason for this.</li>
</ol>
</div>
</div>
<div id="importing-text-files" class="section level4 hasAnchor" number="3.4.1.2">
<h4><span class="header-section-number">3.4.1.2</span> Importing text files<a href="data.html#importing-text-files" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Source article</strong>: <a href="https://elifesciences.org/articles/53560" target="_blank">Corrigan, June K., et al. “A big-data approach to understanding metabolic rate and response to obesity in laboratory mice.” Elife 9 (2020): e53560.</a>.</p>
<p><strong>file name</strong>: <a href="https://raw.githubusercontent.com/elifesciences-publications/Cal-Repository/master/mmpc_all_phases.csv" target="_blank">mmpc_all_phases.csv</a></p>
<p>Let’s open the data for Fig. 1.</p>
<p>Steps</p>
<ol style="list-style-type: decimal">
<li>Copy the title of the paper title, which is “A big-data approach to understanding metabolic rate and response to obesity in laboratory mice”</li>
<li>Create a new folder within “data”. Name the folder the title of the paper by pasting from the clipboard. This is the “data from” folder, since it contains the data from the publication with the title of the folder.</li>
<li>Click on the link to the file above, highlight all values in the window by clicking inside the window and typing command-a (Mac os) or control-a (Windows) and copy.</li>
<li>Paste into a an open, blank text document and save it as “mmpc_all_phases.csv”. If saved elsewhere, move this file into the “A big-data approach to understanding metabolic rate and response to obesity in laboratory mice” folder within the “data” folder.</li>
<li>If you don’t have a dedicated text editor such as BBEdit on MacOS, then open a new R (not Rmd!) document in R studio. This will open as a new tab in the Script Editor pane. Paste the data into the R document window. Save it as “mmpc_all_phases.csv”. R Studio will ask to be sure you want the extension to be .csv and not .R. Yes you are sure. If saved elsewhere, move this file into the “A big-data approach to understanding metabolic rate and response to obesity in laboratory mice” folder within the “data” folder.</li>
</ol>
<p>A .csv file is a <strong>comma-delimited</strong> text file, which means that the entries of a row are separated by commas. A text file is readable by any text editor software and most other kinds of software. Datasets that are stored as text files are typically saved as either .csv (where the entries of a row are separated by commas) or .txt (where the entries are separated by tabs). The base R way to read a .csv file is using <code>read.csv</code>. The <code>read.table</code> function is more versatile, as the delimiter can be specified. The function <code>fread()</code> from the data.table package is fast, smart, and flexible. It is smart in the sense that it guesses what the delimter is.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="data.html#cb26-1" tabindex="-1"></a><span class="co"># construct file path</span></span>
<span id="cb26-2"><a href="data.html#cb26-2" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;A big-data approach to understanding metabolic rate and response to obesity in laboratory mice&quot;</span></span>
<span id="cb26-3"><a href="data.html#cb26-3" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;mmpc_all_phases.csv&quot;</span></span>
<span id="cb26-4"><a href="data.html#cb26-4" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb26-5"><a href="data.html#cb26-5" tabindex="-1"></a></span>
<span id="cb26-6"><a href="data.html#cb26-6" tabindex="-1"></a><span class="co"># open file and assign to exp1, then pipe to clean_names</span></span>
<span id="cb26-7"><a href="data.html#cb26-7" tabindex="-1"></a><span class="co"># to change column names to snake_case</span></span>
<span id="cb26-8"><a href="data.html#cb26-8" tabindex="-1"></a>exp1 <span class="ot">&lt;-</span> <span class="fu">fread</span>(file_path) <span class="sc">%&gt;%</span></span>
<span id="cb26-9"><a href="data.html#cb26-9" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code></pre></div>
<p>Be sure to read the section on importing Excel files above to understand this code. Here, as with the import of the Excel file, the first three lines create the directory path to the file. There is no need to pipe <code>exp1</code> to the <code>data.table</code> function because <code>fread</code> automatically opens the data as a data.table. As with the imported Excel file above, this code sends the data object to <code>clean_names</code> to change the column labels to snake_case.</p>
<div id="a-quick-plot-of-the-exp1-data" class="section level5 hasAnchor" number="3.4.1.2.1">
<h5><span class="header-section-number">3.4.1.2.1</span> A quick plot of the exp1 data<a href="data.html#a-quick-plot-of-the-exp1-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Let’s use the <code>ggscatter</code> function from the ggpubr package to reproduce something close to Fig. 1D. We could make a plot that looks exactly like Fig. 1D but this would require some additional plot arguments.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="data.html#cb27-1" tabindex="-1"></a><span class="fu">ggscatter</span>(<span class="at">data =</span> exp1[diet <span class="sc">==</span> <span class="st">&quot;HF&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb27-2"><a href="data.html#cb27-2" tabindex="-1"></a>                    acclimation <span class="sc">==</span> <span class="cn">TRUE</span>],</span>
<span id="cb27-3"><a href="data.html#cb27-3" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;total_mass&quot;</span>,</span>
<span id="cb27-4"><a href="data.html#cb27-4" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;ee&quot;</span>,</span>
<span id="cb27-5"><a href="data.html#cb27-5" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;institution&quot;</span>,</span>
<span id="cb27-6"><a href="data.html#cb27-6" tabindex="-1"></a>          <span class="at">palette =</span> pal_okabe_ito_4,</span>
<span id="cb27-7"><a href="data.html#cb27-7" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>,</span>
<span id="cb27-8"><a href="data.html#cb27-8" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;energy expenditure (kcal/hr)&quot;</span>,</span>
<span id="cb27-9"><a href="data.html#cb27-9" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;body mass (g)&quot;</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-17-1.png" width="576" /></p>
</div>
</div>
<div id="troubleshooting-file-import" class="section level4 hasAnchor" number="3.4.1.3">
<h4><span class="header-section-number">3.4.1.3</span> Troubleshooting file import<a href="data.html#troubleshooting-file-import" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If you get an error that starts with “Error: <code>path</code> does not exist:” then R is not “seeing” your specified file given the path you’ve given it.</p>
<ol style="list-style-type: decimal">
<li>Make sure that you are working within the project by checking the project name on the right side of the R Studio tool bar. If the project is “None” or you are working within a different project, then open the new project.</li>
<li>Make sure you loaded the package <code>here</code> in a “setup” chunk and that you have run the setup chunk</li>
<li>Make sure you have assigned <code>data_folder &lt;- "data"</code> in the setup chunk and have run the chunk.</li>
<li>Make sure your “data” folder is <em>one level</em> inside your project folder. “one level” means it is not buried deeper inside other folders within the project folder.</li>
<li>Make sure your “data from” folder (the folder with the title of the publication) is one level inside your “data” folder</li>
<li>Make sure your data file is one level inside the correct “data from” folder.</li>
<li><strong>Bug alert</strong> Make sure you have the name of the “data from …” folder correct in your script. Do not type the name of the folder. Instead, go to the finder and highlight the folder containing the data file, copy the name, return to the R markdown script, type <code>folder &lt;- ""</code> and then paste the clipboard (the name of the folder) in between the quote marks.</li>
<li><strong>Bug alert</strong> Make sure the file name is correct in the script. As with the folder name, I go to the finder and copy the file name and paste it in place. In Windows use ctrl-a instead of ctrl-c to copy the full filename including the extension.</li>
</ol>
<p>More generally, Humans are very good at understanding misspelld and OdDLy capitalized words but the R language (or any computer language) is very literal. R is <strong>case sensitive</strong> (some programming languages are not). “Prenatal acoustic communication”, “Prenatal Acoustic Communication”, and “prenatal acoustic communication” are all different values. Spelling AND capitalization have to be perfect, not simply close. Spelling includes <em>spaces</em>. A frequent bug is a file name typed as “Prenatal acoustic communication” when the actual name is “Prenatal acoustic communication”. Can you spot the bug? The original (what we need to copy) has two spaces between “acoustic” and “communication” while the incorrect copy has only one.</p>
<p>Spelling bugs are avoided by simply copying and pasting names of folders, names of files, column names of data frames, and level names of factors, which leads to a general rule of R scripting…</p>
</div>
<div id="rule-number-one-in-r-scripting-rule1" class="section level4 hasAnchor" number="3.4.1.4">
<h4><span class="header-section-number">3.4.1.4</span> Rule number one in R scripting {# rule1}<a href="data.html#rule-number-one-in-r-scripting-rule1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Always copy and paste any text that will be inserted into quotes</strong></p>
<p>Do not try to type it out. You have been warned.</p>
</div>
</div>
</div>
<div id="data-wrangling" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Data wrangling<a href="data.html#data-wrangling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data archived in Excel spreadsheets, at least in wet-bench experimental biology projects, are generally not in a format this is readily analyzed in R, or any statistical software other than perhaps Graphpad Prism. Use these examples as templates for how to import and wrangle Excel-archived data in your project.</p>
<div id="reshaping-data-wide-to-long" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Reshaping data – Wide to long<a href="data.html#reshaping-data-wide-to-long" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="wide-to-long-adipsin-data" class="section level4 hasAnchor" number="3.5.1.1">
<h4><span class="header-section-number">3.5.1.1</span> Wide to long – Adipsin data<a href="data.html#wide-to-long-adipsin-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Source: <a href="https://www.nature.com/articles/s41591-019-0610-4" target="_blank">Adipsin preserves beta cells in diabetic mice and associates with protection from type 2 diabetes in humans</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7256970/" target="_blank">Public source</a> – the Adipsin paper is behind a paywall. A public source of the paper from NIH is available.</p>
<p><a href="https://www.nature.com/articles/s41591-019-0610-4#Sec39" target="_blank">Link to source data</a></p>
<p><img src="images/adipsin_1k_wide.png" width="60%" /></p>
<p>Fig. 1k of the Adipsin paper presents a bar plot of the glucose uptake in response to control (GFP) or <a href="https://en.wikipedia.org/wiki/Factor_D" target="_blank">adipsin</a> treatment. A screenshot of the Excel-archived data is shown above. The data are in <strong>wide format</strong>. In wide-format, the values of a single variable (here, this is glucose uptake level) are given in separate columns for each treatment level (group). The values for the GFP group are in Column A and the values for the Adipsin group are in Column B. Wide format is efficient for computations in a spreadsheet, such as computing means and standard deviations of columns of data, and for plotting.</p>
<p>For most statistical analyses of experimental data in R (and most statistics software), all values of a single variable should be in a single column. This is called <strong>long format</strong>. I’ve manually rearranged the data from the archived spread sheet into long format by stacking each group’s values into a single column, shown in the screen capture below. All values of glucose uptake are in a single column. In long format, there needs to be a way to identify which values belong to which group and this is achieved here with column “treatment”. In adition to the treatment column.</p>
<p><img src="images/adipsin_1k_long.png" width="60%" /></p>
<p>The difference between wide and long also reflects how we think about statistical analysis. When we do a <em>t</em>-test to compare the means of glucose uptake between GFP and Adipsin groups, we might think we have two things: the set of glucose uptake values for the GFP group and the set of values for the Adipsin group. When we fit a linear model, we also have two things, the variable <em>treatment</em> containing treatment level assignment and the variable <em>glucose_uptake</em> containing the glucose uptake values. In wide format, there is nothing to suggest that <em>treatment</em> is a variable.</p>
<p>There are many functions to tidy data from wide to long. <code>melt</code> from the data.table package is especially useful. It is data.table’s version of melt from the reshape2 package.</p>
<p>The major arguments of <code>data.table::melt</code> are</p>
<p><code>melt(data, id.vars, measure.vars, variable.name, value.name)</code></p>
<p><code>melt</code> takes the data in the columns listed in <code>measure.vars</code> and stacks these into a single column named <code>value.name</code>. The names of the columns in <code>measure.vars</code> are the values of the elements in a new column named <code>variable.name</code>. The elements of any column in <code>id.vars</code> are repeated <em>p</em> times, where <em>p</em> is the number of columns that were stacked.</p>
<p>Let’s melt the three different response variables of the adipsin data and <code>merge</code> them into a single data.table. There are several ways to combine data sets including <code>merge</code> and <code>cbind</code>. We’ll compare these later.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="data.html#cb28-1" tabindex="-1"></a>file_folder <span class="ot">&lt;-</span> <span class="st">&quot;Adipsin preserves beta cells in diabetic mice and associates with protection from type 2 diabetes in humans&quot;</span></span>
<span id="cb28-2"><a href="data.html#cb28-2" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="st">&quot;41591_2019_610_MOESM3_ESM.xlsx&quot;</span></span>
<span id="cb28-3"><a href="data.html#cb28-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, file_folder, fn)</span>
<span id="cb28-4"><a href="data.html#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="data.html#cb28-5" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;db/db-GFP&quot;</span>, <span class="st">&quot;db/db-Adipsin&quot;</span>)</span>
<span id="cb28-6"><a href="data.html#cb28-6" tabindex="-1"></a></span>
<span id="cb28-7"><a href="data.html#cb28-7" tabindex="-1"></a><span class="co"># as separate line</span></span>
<span id="cb28-8"><a href="data.html#cb28-8" tabindex="-1"></a>fig_1k_wide <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb28-9"><a href="data.html#cb28-9" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;Figure 1k&quot;</span>,</span>
<span id="cb28-10"><a href="data.html#cb28-10" tabindex="-1"></a>                    <span class="at">range =</span> <span class="st">&quot;A3:B9&quot;</span>)</span>
<span id="cb28-11"><a href="data.html#cb28-11" tabindex="-1"></a>fig_1k_wide <span class="ot">&lt;-</span> <span class="fu">data.table</span>(fig_1k_wide)</span>
<span id="cb28-12"><a href="data.html#cb28-12" tabindex="-1"></a>fig_1k <span class="ot">&lt;-</span> <span class="fu">melt</span>(fig_1k_wide,</span>
<span id="cb28-13"><a href="data.html#cb28-13" tabindex="-1"></a>               <span class="at">measure.vars =</span> treatment_levels,</span>
<span id="cb28-14"><a href="data.html#cb28-14" tabindex="-1"></a>               <span class="at">variable.name =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb28-15"><a href="data.html#cb28-15" tabindex="-1"></a>               <span class="at">value.name =</span> <span class="st">&quot;glucose_uptake&quot;</span>)</span>
<span id="cb28-16"><a href="data.html#cb28-16" tabindex="-1"></a></span>
<span id="cb28-17"><a href="data.html#cb28-17" tabindex="-1"></a><span class="co"># or piped -- which do you prefer?</span></span>
<span id="cb28-18"><a href="data.html#cb28-18" tabindex="-1"></a>fig_1k <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb28-19"><a href="data.html#cb28-19" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;Figure 1k&quot;</span>,</span>
<span id="cb28-20"><a href="data.html#cb28-20" tabindex="-1"></a>                    <span class="at">range =</span> <span class="st">&quot;A3:B9&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-21"><a href="data.html#cb28-21" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-22"><a href="data.html#cb28-22" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">measure.vars =</span> treatment_levels,</span>
<span id="cb28-23"><a href="data.html#cb28-23" tabindex="-1"></a>       <span class="at">variable.name =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb28-24"><a href="data.html#cb28-24" tabindex="-1"></a>       <span class="at">value.name =</span> <span class="st">&quot;glucose_uptake&quot;</span>)</span>
<span id="cb28-25"><a href="data.html#cb28-25" tabindex="-1"></a></span>
<span id="cb28-26"><a href="data.html#cb28-26" tabindex="-1"></a><span class="co"># View(fig_1k) # highlight without the comment sign and &quot;run selected lines()&quot; to view</span></span></code></pre></div>
<p>A pretty-good-plot using the <code>ggpubr</code> package</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="data.html#cb29-1" tabindex="-1"></a><span class="co"># put warning=FALSE into the chunk header to supress the warning</span></span>
<span id="cb29-2"><a href="data.html#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="data.html#cb29-3" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggstripchart</span>(<span class="at">x =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb29-4"><a href="data.html#cb29-4" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">&quot;glucose_uptake&quot;</span>,</span>
<span id="cb29-5"><a href="data.html#cb29-5" tabindex="-1"></a>                   <span class="at">add =</span> <span class="st">&quot;mean_se&quot;</span>,</span>
<span id="cb29-6"><a href="data.html#cb29-6" tabindex="-1"></a>                   <span class="at">data =</span> fig_1k)</span>
<span id="cb29-7"><a href="data.html#cb29-7" tabindex="-1"></a></span>
<span id="cb29-8"><a href="data.html#cb29-8" tabindex="-1"></a>gg</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-21-1.png" width="576" /></p>
</div>
<div id="wide-to-long-enteric-nervous-system-data" class="section level4 hasAnchor" number="3.5.1.2">
<h4><span class="header-section-number">3.5.1.2</span> Wide to long – Enteric nervous system data<a href="data.html#wide-to-long-enteric-nervous-system-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Source: <a href="https://doi.org/10.1371/journal.pbio.2000689" target="_blank">Rolig, A. S., Mittge, E. K., Ganz, J., Troll, J. V., Melancon, E., Wiles, T. J., … Guillemin, K. (2017). The enteric nervous system promotes intestinal health by constraining microbiota composition. PLOS Biology, 15(2), e2000689.</a></p>
<p><a href="https://doi.org/10.1371/journal.pbio.2000689.s008" target="_blank">Source data</a></p>
<p>Let’s import and reshape the data for figure 2d. Look at the excel file and the data in Fig. 2d. There is a single treament with four levels, but the authors have organized the data in each level in separate columns and used the column header as the level name.</p>
<p><img src="images/enteric_fig2d_wide.png" width="60%" /></p>
<p>Let’s melt the data from wide to long by stacking the four columns into a single column “neutrophil_count” and adding a treatment column identifying the group.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="data.html#cb30-1" tabindex="-1"></a>folder <span class="ot">&lt;-</span> <span class="st">&quot;The enteric nervous system promotes intestinal health by constraining microbiota composition&quot;</span></span>
<span id="cb30-2"><a href="data.html#cb30-2" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;journal.pbio.2000689.s008.xlsx&quot;</span></span>
<span id="cb30-3"><a href="data.html#cb30-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, folder, filename)</span>
<span id="cb30-4"><a href="data.html#cb30-4" tabindex="-1"></a></span>
<span id="cb30-5"><a href="data.html#cb30-5" tabindex="-1"></a><span class="co"># figure 2D data</span></span>
<span id="cb30-6"><a href="data.html#cb30-6" tabindex="-1"></a>sheet_i <span class="ot">&lt;-</span> <span class="st">&quot;Figure 2&quot;</span></span>
<span id="cb30-7"><a href="data.html#cb30-7" tabindex="-1"></a>range_i <span class="ot">&lt;-</span> <span class="st">&quot;F2:I24&quot;</span></span>
<span id="cb30-8"><a href="data.html#cb30-8" tabindex="-1"></a>fig_2d_wide <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path, <span class="at">sheet=</span>sheet_i, <span class="at">range=</span>range_i) <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="data.html#cb30-9" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-10"><a href="data.html#cb30-10" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb30-11"><a href="data.html#cb30-11" tabindex="-1"></a></span>
<span id="cb30-12"><a href="data.html#cb30-12" tabindex="-1"></a><span class="co"># change column names by replacing without &quot;_donor&quot; in each name</span></span>
<span id="cb30-13"><a href="data.html#cb30-13" tabindex="-1"></a><span class="co"># these new column names will become the levels of the treatment factor</span></span>
<span id="cb30-14"><a href="data.html#cb30-14" tabindex="-1"></a>new_colnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;gf&quot;</span>, <span class="st">&quot;wt&quot;</span>, <span class="st">&quot;sox10&quot;</span>, <span class="st">&quot;iap_mo&quot;</span>)</span>
<span id="cb30-15"><a href="data.html#cb30-15" tabindex="-1"></a><span class="fu">setnames</span>(fig_2d_wide, <span class="at">old=</span><span class="fu">colnames</span>(fig_2d_wide), <span class="at">new=</span>new_colnames)</span>
<span id="cb30-16"><a href="data.html#cb30-16" tabindex="-1"></a></span>
<span id="cb30-17"><a href="data.html#cb30-17" tabindex="-1"></a><span class="co"># wide to long</span></span>
<span id="cb30-18"><a href="data.html#cb30-18" tabindex="-1"></a>fig_2d <span class="ot">&lt;-</span> <span class="fu">melt</span>(fig_2d_wide, </span>
<span id="cb30-19"><a href="data.html#cb30-19" tabindex="-1"></a>              <span class="at">measure.vars=</span><span class="fu">colnames</span>(fig_2d_wide), </span>
<span id="cb30-20"><a href="data.html#cb30-20" tabindex="-1"></a>              <span class="at">variable.name=</span><span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb30-21"><a href="data.html#cb30-21" tabindex="-1"></a>              <span class="at">value.name=</span><span class="st">&quot;neutrophil_count&quot;</span>)</span>
<span id="cb30-22"><a href="data.html#cb30-22" tabindex="-1"></a></span>
<span id="cb30-23"><a href="data.html#cb30-23" tabindex="-1"></a><span class="co"># omit empty rows</span></span>
<span id="cb30-24"><a href="data.html#cb30-24" tabindex="-1"></a>fig_2d <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(fig_2d)</span>
<span id="cb30-25"><a href="data.html#cb30-25" tabindex="-1"></a></span>
<span id="cb30-26"><a href="data.html#cb30-26" tabindex="-1"></a><span class="co"># re-order factors</span></span>
<span id="cb30-27"><a href="data.html#cb30-27" tabindex="-1"></a>fig_2d[, treatment <span class="sc">:=</span> <span class="fu">factor</span>(treatment,</span>
<span id="cb30-28"><a href="data.html#cb30-28" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;gf&quot;</span>, <span class="st">&quot;sox10&quot;</span>, <span class="st">&quot;iap_mo&quot;</span>))]</span>
<span id="cb30-29"><a href="data.html#cb30-29" tabindex="-1"></a></span>
<span id="cb30-30"><a href="data.html#cb30-30" tabindex="-1"></a><span class="co"># View(fig_2d)</span></span></code></pre></div>
<p>To learn (instead of just copy and modify), it’s best to do this in steps and not run the whole chunk. At each step, look at the result using View. The script above includes three extra wrangling steps.</p>
<ol style="list-style-type: decimal">
<li><p>Changing column names in fig_2d_wide. The column names in wide format will become the treatment level names of the <em>treatment</em> factor after reshaping. It will be easier down the road if these names are shorter and the “_donor” in each name is redundant. The <code>setnames</code> function renames the column names.</p></li>
<li><p>For these data, the number of measures within the different treatments differs and, as a consequence, there are multiple cells with <code>NA</code> which indicates a missing value. <code>View(fig_2d_wide)</code> (this can be typed in the console) to see this. After reshaping to long format (fig_2d), the rows with missing values become empty rows – there is no useful information in them (View this). To see this, re-run the lines of the chunk up to the line “# omit empty rows”. The <code>na.omit</code> function deletes any row with missing values. Here, this deletes these information-less rows. Be very careful with <code>na.omit</code>. You do not want to delete rows of data that contain information you want.</p></li>
<li><p>For both analysis and plots, we want to compare values to the control level, which is named “wt” for the fig_2d data. That is, we want “wt” to be the <em>reference</em> level. To achieve this, the levels of the factor <em>treatment</em> need to be re-ordered using the <code>levels</code> argument. (note, I typically do not add “levels =”, but simply pass the list of levels)</p></li>
</ol>
</div>
<div id="wide-to-long-bee-data" class="section level4 hasAnchor" number="3.5.1.3">
<h4><span class="header-section-number">3.5.1.3</span> Wide to long – bee data<a href="data.html#wide-to-long-bee-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The example above is pretty easy, because the all columns in the original data frame are melted (stacked). Here is an example in which only a subset of columns are stacked. In addition, only a subset of the remaining columns are retained in the long format data frame. The data are from Panel A of supplement Fig. 8 (<a href="https://journals.plos.org/plosbiology/article/file?type=supplementary&amp;id=info:doi/10.1371/journal.pbio.2003467.s019" class="uri">https://journals.plos.org/plosbiology/article/file?type=supplementary&amp;id=info:doi/10.1371/journal.pbio.2003467.s019</a>){target=“_blank”} from</p>
<p>Source: <a href="https://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.2003467" target="_blank">Kešnerová, L., Mars, R.A., Ellegaard, K.M., Troilo, M., Sauer, U. and Engel, P., 2017. Disentangling metabolic functions of bacteria in the honey bee gut. PLoS biology, 15(12), p.e2003467.</a></p>
<p><a href="https://doi.org/10.1371/journal.pbio.2003467.s001" target="_blank">Source data</a></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="data.html#cb31-1" tabindex="-1"></a>folder <span class="ot">&lt;-</span> <span class="st">&quot;Data from Disentangling metabolic functions of bacteria in the honey bee gut&quot;</span></span>
<span id="cb31-2"><a href="data.html#cb31-2" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;journal.pbio.2003467.s001.xlsx&quot;</span></span>
<span id="cb31-3"><a href="data.html#cb31-3" tabindex="-1"></a></span>
<span id="cb31-4"><a href="data.html#cb31-4" tabindex="-1"></a><span class="co"># figure 2D data</span></span>
<span id="cb31-5"><a href="data.html#cb31-5" tabindex="-1"></a>sheet_i <span class="ot">&lt;-</span> <span class="st">&quot;S8 Fig&quot;</span></span>
<span id="cb31-6"><a href="data.html#cb31-6" tabindex="-1"></a>range_i <span class="ot">&lt;-</span> <span class="st">&quot;A2:H12&quot;</span></span>
<span id="cb31-7"><a href="data.html#cb31-7" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, folder, filename)</span>
<span id="cb31-8"><a href="data.html#cb31-8" tabindex="-1"></a>fig_s8a_wide <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb31-9"><a href="data.html#cb31-9" tabindex="-1"></a>                      <span class="at">sheet=</span>sheet_i,</span>
<span id="cb31-10"><a href="data.html#cb31-10" tabindex="-1"></a>                      <span class="at">range=</span>range_i) <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="data.html#cb31-11" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-12"><a href="data.html#cb31-12" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb31-13"><a href="data.html#cb31-13" tabindex="-1"></a></span>
<span id="cb31-14"><a href="data.html#cb31-14" tabindex="-1"></a><span class="co"># wide to long</span></span>
<span id="cb31-15"><a href="data.html#cb31-15" tabindex="-1"></a>stack_cols <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;replicate&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb31-16"><a href="data.html#cb31-16" tabindex="-1"></a>fig_s8a <span class="ot">&lt;-</span> <span class="fu">melt</span>(fig_s8a_wide,</span>
<span id="cb31-17"><a href="data.html#cb31-17" tabindex="-1"></a>              <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">&quot;media&quot;</span>, <span class="st">&quot;time_h&quot;</span>),</span>
<span id="cb31-18"><a href="data.html#cb31-18" tabindex="-1"></a>              <span class="at">measure.vars =</span> stack_cols, </span>
<span id="cb31-19"><a href="data.html#cb31-19" tabindex="-1"></a>              <span class="at">variable.name =</span> <span class="st">&quot;Replicate&quot;</span>, </span>
<span id="cb31-20"><a href="data.html#cb31-20" tabindex="-1"></a>              <span class="at">value.name =</span> <span class="st">&quot;OD600&quot;</span>) <span class="co"># measure of absorbance at 600nm</span></span></code></pre></div>
</div>
<div id="wide-to-long-stacking-multiple-sets-of-columns" class="section level4 hasAnchor" number="3.5.1.4">
<h4><span class="header-section-number">3.5.1.4</span> Wide to long – stacking multiple sets of columns<a href="data.html#wide-to-long-stacking-multiple-sets-of-columns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Article: <a href="https://www.nature.com/articles/s42003-020-01564-2#MOESM4" target="_blank">GPR109A mediates the effects of hippuric acid on regulating osteoclastogenesis and bone resorption in mice</a></p>
<p><a href="https://www.nature.com/articles/s42003-020-01564-2#MOESM4" target="_blank">source data</a></p>
<p>The data are from Fig. 1b</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="data.html#cb32-1" tabindex="-1"></a>folder <span class="ot">&lt;-</span> <span class="st">&quot;GPR109A mediates the effects of hippuric acid on regulating osteoclastogenesis and bone resorption in mice&quot;</span></span>
<span id="cb32-2"><a href="data.html#cb32-2" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;42003_2020_1564_MOESM4_ESM.xlsx&quot;</span></span>
<span id="cb32-3"><a href="data.html#cb32-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, folder, file_name)</span>
<span id="cb32-4"><a href="data.html#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="data.html#cb32-5" tabindex="-1"></a>fig1b_wide <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb32-6"><a href="data.html#cb32-6" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;Fig. 1b&quot;</span>,</span>
<span id="cb32-7"><a href="data.html#cb32-7" tabindex="-1"></a>                    <span class="at">range =</span> <span class="st">&quot;C4:R9&quot;</span>,</span>
<span id="cb32-8"><a href="data.html#cb32-8" tabindex="-1"></a>                    <span class="at">col_names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="data.html#cb32-9" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb32-10"><a href="data.html#cb32-10" tabindex="-1"></a></span>
<span id="cb32-11"><a href="data.html#cb32-11" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Wild type&quot;</span>, <span class="st">&quot;GPR109A-/-&quot;</span>)</span>
<span id="cb32-12"><a href="data.html#cb32-12" tabindex="-1"></a>treatment_abbrev <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;ko&quot;</span>)</span>
<span id="cb32-13"><a href="data.html#cb32-13" tabindex="-1"></a>measures <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;BV/TV&quot;</span>, <span class="st">&quot;Tb.Th&quot;</span>, <span class="st">&quot;Tb.Sp&quot;</span>, <span class="st">&quot;Tb.N&quot;</span>, <span class="st">&quot;BMD&quot;</span>, <span class="st">&quot;Cs.Th&quot;</span>, <span class="st">&quot;BV&quot;</span>, <span class="st">&quot;MA&quot;</span>)</span>
<span id="cb32-14"><a href="data.html#cb32-14" tabindex="-1"></a>new_colnames <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">rep</span>(measures, <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb32-15"><a href="data.html#cb32-15" tabindex="-1"></a>                              treatment_abbrev,</span>
<span id="cb32-16"><a href="data.html#cb32-16" tabindex="-1"></a>                              <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb32-17"><a href="data.html#cb32-17" tabindex="-1"></a><span class="fu">setnames</span>(fig1b_wide,</span>
<span id="cb32-18"><a href="data.html#cb32-18" tabindex="-1"></a>         <span class="at">old =</span> <span class="fu">colnames</span>(fig1b_wide),</span>
<span id="cb32-19"><a href="data.html#cb32-19" tabindex="-1"></a>         <span class="at">new =</span> new_colnames)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
BV/TV_wt
</th>
<th style="text-align:right;">
BV/TV_ko
</th>
<th style="text-align:right;">
Tb.Th_wt
</th>
<th style="text-align:right;">
Tb.Th_ko
</th>
<th style="text-align:right;">
Tb.Sp_wt
</th>
<th style="text-align:right;">
Tb.Sp_ko
</th>
<th style="text-align:right;">
Tb.N_wt
</th>
<th style="text-align:right;">
Tb.N_ko
</th>
<th style="text-align:right;">
BMD_wt
</th>
<th style="text-align:right;">
BMD_ko
</th>
<th style="text-align:right;">
Cs.Th_wt
</th>
<th style="text-align:right;">
Cs.Th_ko
</th>
<th style="text-align:right;">
BV_wt
</th>
<th style="text-align:right;">
BV_ko
</th>
<th style="text-align:right;">
MA_wt
</th>
<th style="text-align:right;">
MA_ko
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5.229493
</td>
<td style="text-align:right;">
6.697880
</td>
<td style="text-align:right;">
0.0379685
</td>
<td style="text-align:right;">
0.0436415
</td>
<td style="text-align:right;">
0.3383573
</td>
<td style="text-align:right;">
0.3507201
</td>
<td style="text-align:right;">
1.377323
</td>
<td style="text-align:right;">
1.534749
</td>
<td style="text-align:right;">
0.0927138
</td>
<td style="text-align:right;">
0.1125594
</td>
<td style="text-align:right;">
0.1363595
</td>
<td style="text-align:right;">
0.1445718
</td>
<td style="text-align:right;">
0.2296399
</td>
<td style="text-align:right;">
0.2250816
</td>
<td style="text-align:right;">
0.3832690
</td>
<td style="text-align:right;">
0.4268379
</td>
</tr>
<tr>
<td style="text-align:right;">
5.171787
</td>
<td style="text-align:right;">
7.271222
</td>
<td style="text-align:right;">
0.0386800
</td>
<td style="text-align:right;">
0.0425357
</td>
<td style="text-align:right;">
0.3579566
</td>
<td style="text-align:right;">
0.3946835
</td>
<td style="text-align:right;">
1.337071
</td>
<td style="text-align:right;">
1.709440
</td>
<td style="text-align:right;">
0.0930417
</td>
<td style="text-align:right;">
0.1129723
</td>
<td style="text-align:right;">
0.1387652
</td>
<td style="text-align:right;">
0.1430709
</td>
<td style="text-align:right;">
0.1946119
</td>
<td style="text-align:right;">
0.2422370
</td>
<td style="text-align:right;">
0.4216582
</td>
<td style="text-align:right;">
0.3553190
</td>
</tr>
<tr>
<td style="text-align:right;">
4.287585
</td>
<td style="text-align:right;">
9.873900
</td>
<td style="text-align:right;">
0.0385307
</td>
<td style="text-align:right;">
0.0438999
</td>
<td style="text-align:right;">
0.4401164
</td>
<td style="text-align:right;">
0.3019478
</td>
<td style="text-align:right;">
1.112770
</td>
<td style="text-align:right;">
2.249185
</td>
<td style="text-align:right;">
0.0782485
</td>
<td style="text-align:right;">
0.1330846
</td>
<td style="text-align:right;">
0.1334085
</td>
<td style="text-align:right;">
0.1588262
</td>
<td style="text-align:right;">
0.1568608
</td>
<td style="text-align:right;">
0.3700646
</td>
<td style="text-align:right;">
0.3620063
</td>
<td style="text-align:right;">
0.4698913
</td>
</tr>
<tr>
<td style="text-align:right;">
4.308528
</td>
<td style="text-align:right;">
5.557610
</td>
<td style="text-align:right;">
0.0374626
</td>
<td style="text-align:right;">
0.0372947
</td>
<td style="text-align:right;">
0.3576182
</td>
<td style="text-align:right;">
0.3328132
</td>
<td style="text-align:right;">
1.150088
</td>
<td style="text-align:right;">
1.490186
</td>
<td style="text-align:right;">
0.0841214
</td>
<td style="text-align:right;">
0.1007773
</td>
<td style="text-align:right;">
0.1369047
</td>
<td style="text-align:right;">
0.1288561
</td>
<td style="text-align:right;">
0.1555844
</td>
<td style="text-align:right;">
0.2050777
</td>
<td style="text-align:right;">
0.3661425
</td>
<td style="text-align:right;">
0.4413361
</td>
</tr>
<tr>
<td style="text-align:right;">
5.175202
</td>
<td style="text-align:right;">
6.673029
</td>
<td style="text-align:right;">
0.0406120
</td>
<td style="text-align:right;">
0.0400175
</td>
<td style="text-align:right;">
0.4541035
</td>
<td style="text-align:right;">
0.3604716
</td>
<td style="text-align:right;">
1.274303
</td>
<td style="text-align:right;">
1.667530
</td>
<td style="text-align:right;">
0.0921535
</td>
<td style="text-align:right;">
0.1189364
</td>
<td style="text-align:right;">
0.1299124
</td>
<td style="text-align:right;">
0.1438411
</td>
<td style="text-align:right;">
0.1521829
</td>
<td style="text-align:right;">
0.2224382
</td>
<td style="text-align:right;">
0.3578702
</td>
<td style="text-align:right;">
0.4556137
</td>
</tr>
</tbody>
</table>
<p>To analyze each response, the two treatment levels for each measure need to be stacked into a single column. This is easy using <code>melt</code> from the data.table package. Add this to your chunk.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="data.html#cb33-1" tabindex="-1"></a>fig1b <span class="ot">&lt;-</span> <span class="fu">melt</span>(fig1b_wide,</span>
<span id="cb33-2"><a href="data.html#cb33-2" tabindex="-1"></a>              <span class="at">measure.vars =</span> <span class="fu">list</span>(</span>
<span id="cb33-3"><a href="data.html#cb33-3" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">&quot;BV/TV_wt&quot;</span>, <span class="st">&quot;BV/TV_ko&quot;</span>),</span>
<span id="cb33-4"><a href="data.html#cb33-4" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">&quot;Tb.Th_wt&quot;</span>, <span class="st">&quot;Tb.Th_ko&quot;</span>),</span>
<span id="cb33-5"><a href="data.html#cb33-5" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">&quot;Tb.Sp_wt&quot;</span>, <span class="st">&quot;Tb.Sp_ko&quot;</span>),</span>
<span id="cb33-6"><a href="data.html#cb33-6" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">&quot;Tb.N_wt&quot;</span>, <span class="st">&quot;Tb.N_ko&quot;</span>),</span>
<span id="cb33-7"><a href="data.html#cb33-7" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">&quot;BMD_wt&quot;</span>, <span class="st">&quot;BMD_ko&quot;</span>),</span>
<span id="cb33-8"><a href="data.html#cb33-8" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">&quot;Cs.Th_wt&quot;</span>, <span class="st">&quot;Cs.Th_ko&quot;</span>),</span>
<span id="cb33-9"><a href="data.html#cb33-9" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">&quot;BV_wt&quot;</span>, <span class="st">&quot;BV_ko&quot;</span>),</span>
<span id="cb33-10"><a href="data.html#cb33-10" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">&quot;MA_wt&quot;</span>, <span class="st">&quot;MA_ko&quot;</span>)),</span>
<span id="cb33-11"><a href="data.html#cb33-11" tabindex="-1"></a>              <span class="at">variable.name =</span> <span class="st">&quot;treatment_id&quot;</span>,</span>
<span id="cb33-12"><a href="data.html#cb33-12" tabindex="-1"></a>              <span class="at">value.name =</span> measures)</span>
<span id="cb33-13"><a href="data.html#cb33-13" tabindex="-1"></a>fig1b[, treatment <span class="sc">:=</span> <span class="fu">ifelse</span>(treatment_id <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb33-14"><a href="data.html#cb33-14" tabindex="-1"></a>                            treatment_levels[<span class="dv">1</span>],</span>
<span id="cb33-15"><a href="data.html#cb33-15" tabindex="-1"></a>                            treatment_levels[<span class="dv">2</span>])]</span>
<span id="cb33-16"><a href="data.html#cb33-16" tabindex="-1"></a>fig1b[, treatment <span class="sc">:=</span> <span class="fu">factor</span>(treatment,</span>
<span id="cb33-17"><a href="data.html#cb33-17" tabindex="-1"></a>                            <span class="at">levels =</span> treatment_levels)]</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
treatment_id
</th>
<th style="text-align:right;">
BV/TV
</th>
<th style="text-align:right;">
Tb.Th
</th>
<th style="text-align:right;">
Tb.Sp
</th>
<th style="text-align:right;">
Tb.N
</th>
<th style="text-align:right;">
BMD
</th>
<th style="text-align:right;">
Cs.Th
</th>
<th style="text-align:right;">
BV
</th>
<th style="text-align:right;">
MA
</th>
<th style="text-align:left;">
treatment
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
5.229493
</td>
<td style="text-align:right;">
0.0379685
</td>
<td style="text-align:right;">
0.3383573
</td>
<td style="text-align:right;">
1.377323
</td>
<td style="text-align:right;">
0.0927138
</td>
<td style="text-align:right;">
0.1363595
</td>
<td style="text-align:right;">
0.2296399
</td>
<td style="text-align:right;">
0.3832690
</td>
<td style="text-align:left;">
Wild type
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
5.171787
</td>
<td style="text-align:right;">
0.0386800
</td>
<td style="text-align:right;">
0.3579566
</td>
<td style="text-align:right;">
1.337071
</td>
<td style="text-align:right;">
0.0930417
</td>
<td style="text-align:right;">
0.1387652
</td>
<td style="text-align:right;">
0.1946119
</td>
<td style="text-align:right;">
0.4216582
</td>
<td style="text-align:left;">
Wild type
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
4.287585
</td>
<td style="text-align:right;">
0.0385307
</td>
<td style="text-align:right;">
0.4401164
</td>
<td style="text-align:right;">
1.112770
</td>
<td style="text-align:right;">
0.0782485
</td>
<td style="text-align:right;">
0.1334085
</td>
<td style="text-align:right;">
0.1568608
</td>
<td style="text-align:right;">
0.3620063
</td>
<td style="text-align:left;">
Wild type
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
4.308528
</td>
<td style="text-align:right;">
0.0374626
</td>
<td style="text-align:right;">
0.3576182
</td>
<td style="text-align:right;">
1.150088
</td>
<td style="text-align:right;">
0.0841214
</td>
<td style="text-align:right;">
0.1369047
</td>
<td style="text-align:right;">
0.1555844
</td>
<td style="text-align:right;">
0.3661425
</td>
<td style="text-align:left;">
Wild type
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
5.175202
</td>
<td style="text-align:right;">
0.0406120
</td>
<td style="text-align:right;">
0.4541035
</td>
<td style="text-align:right;">
1.274303
</td>
<td style="text-align:right;">
0.0921535
</td>
<td style="text-align:right;">
0.1299124
</td>
<td style="text-align:right;">
0.1521829
</td>
<td style="text-align:right;">
0.3578702
</td>
<td style="text-align:left;">
Wild type
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="reshaping-data-transpose-turning-the-columns-into-rows" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Reshaping data – Transpose (turning the columns into rows)<a href="data.html#reshaping-data-transpose-turning-the-columns-into-rows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="transpose-pi3k-inhibitors-data" class="section level4 hasAnchor" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Transpose – PI3K inhibitors data<a href="data.html#transpose-pi3k-inhibitors-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Source: <a href="https://www.nature.com/articles/s41586-018-0343-4">Suppression of insulin feedback enhances the efficacy of PI3K inhibitors</a></p>
<p><a href="https://www.nature.com/articles/s41586-018-0343-4#Sec15">Source data</a></p>
<p>Figure 3A of this publication is a plot of blood glucose level taken on the same individual mice from four treatment groups over six time periods. Data on a single variable such as blood glucose, taken on the same individual at multiple time points, are known as <strong>longitudial data</strong> but are often mistakenly called <strong>repeated measures data</strong>. There are mulitple ways to analyze longitudinal data, some goood, some less good. There are two reasonable ways to archive longitudinal data for analysis in R. The Excel-archived data for Figure 3A is neither. A screen capture of two of the four treatment groups is shown below.</p>
<p><img src="images/pi3k-inhibitors.png" width="60%" /></p>
<p>In the archived data the individual mice are in columns. The measure at each time point is in rows. And the treatment group is in blocks. Typical data for analysis in R should have the individual mice in rows and each variable in columns (an exception in experimental biology is omics data, such as RNA expression levels. Many packages with functions to analyze these data have the genes on each row and the individual on each column). The Figure 3A data are turned on its side. We need to <strong>transpose</strong> the data, or rotate the matrix 90 degrees (make the columns rows and the rows columns) to turn the data into wide format. From this we can create a new data.table with the data in long format.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="data.html#cb34-1" tabindex="-1"></a>folder <span class="ot">&lt;-</span> <span class="st">&quot;Suppression of insulin feedback enhances the efficacy of PI3K inhibitors&quot;</span></span>
<span id="cb34-2"><a href="data.html#cb34-2" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;41586_2018_343_MOESM6_ESM.xlsx&quot;</span></span>
<span id="cb34-3"><a href="data.html#cb34-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, folder, filename)</span>
<span id="cb34-4"><a href="data.html#cb34-4" tabindex="-1"></a>pi3k_side <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb34-5"><a href="data.html#cb34-5" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;Figure 3A (Blood Glucose)&quot;</span>,</span>
<span id="cb34-6"><a href="data.html#cb34-6" tabindex="-1"></a>                    <span class="at">range =</span> <span class="st">&quot;A2:U7&quot;</span>,</span>
<span id="cb34-7"><a href="data.html#cb34-7" tabindex="-1"></a>                    <span class="at">col_names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="data.html#cb34-8" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb34-9"><a href="data.html#cb34-9" tabindex="-1"></a></span>
<span id="cb34-10"><a href="data.html#cb34-10" tabindex="-1"></a><span class="co"># give columns names as the treatment of each mouse</span></span>
<span id="cb34-11"><a href="data.html#cb34-11" tabindex="-1"></a><span class="co"># verify n=5 per group</span></span>
<span id="cb34-12"><a href="data.html#cb34-12" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Chow&quot;</span>, <span class="st">&quot;Ketogenic&quot;</span>, <span class="st">&quot;Metformin&quot;</span>, <span class="st">&quot;SGLT2i&quot;</span>)</span>
<span id="cb34-13"><a href="data.html#cb34-13" tabindex="-1"></a><span class="fu">colnames</span>(pi3k_side) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;time&quot;</span>,</span>
<span id="cb34-14"><a href="data.html#cb34-14" tabindex="-1"></a>                         <span class="fu">rep</span>(treatment_levels, <span class="at">each =</span> <span class="dv">5</span>))</span>
<span id="cb34-15"><a href="data.html#cb34-15" tabindex="-1"></a></span>
<span id="cb34-16"><a href="data.html#cb34-16" tabindex="-1"></a><span class="co"># transpose</span></span>
<span id="cb34-17"><a href="data.html#cb34-17" tabindex="-1"></a><span class="co"># keep colnames in &quot;side&quot; as values of treatment col in &quot;wide&quot;</span></span>
<span id="cb34-18"><a href="data.html#cb34-18" tabindex="-1"></a><span class="co"># make values of &quot;time&quot; in &quot;side&quot; the colnames in &quot;wide&quot;</span></span>
<span id="cb34-19"><a href="data.html#cb34-19" tabindex="-1"></a>pi3k_wide <span class="ot">&lt;-</span> <span class="fu">transpose</span>(pi3k_side,</span>
<span id="cb34-20"><a href="data.html#cb34-20" tabindex="-1"></a>                       <span class="at">keep.names =</span> <span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb34-21"><a href="data.html#cb34-21" tabindex="-1"></a>                       <span class="at">make.names =</span> <span class="st">&quot;time&quot;</span>)</span>
<span id="cb34-22"><a href="data.html#cb34-22" tabindex="-1"></a></span>
<span id="cb34-23"><a href="data.html#cb34-23" tabindex="-1"></a><span class="co"># make a baseline column </span></span>
<span id="cb34-24"><a href="data.html#cb34-24" tabindex="-1"></a>pi3k_wide[, glucose_0 <span class="sc">:=</span> <span class="fu">get</span>(<span class="st">&quot;0&quot;</span>)]</span>
<span id="cb34-25"><a href="data.html#cb34-25" tabindex="-1"></a></span>
<span id="cb34-26"><a href="data.html#cb34-26" tabindex="-1"></a><span class="co"># make-up a mouse id for each mouse</span></span>
<span id="cb34-27"><a href="data.html#cb34-27" tabindex="-1"></a>pi3k_wide[, id <span class="sc">:=</span> <span class="fu">paste</span>(treatment, <span class="dv">1</span><span class="sc">:</span>.N, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>), by <span class="ot">=</span> treatment]</span>
<span id="cb34-28"><a href="data.html#cb34-28" tabindex="-1"></a></span>
<span id="cb34-29"><a href="data.html#cb34-29" tabindex="-1"></a><span class="co"># make treatement a factor with &quot;chow&quot; as reference</span></span>
<span id="cb34-30"><a href="data.html#cb34-30" tabindex="-1"></a>pi3k_wide[, treatment <span class="sc">:=</span> <span class="fu">factor</span>(treatment, treatment_levels)]</span>
<span id="cb34-31"><a href="data.html#cb34-31" tabindex="-1"></a></span>
<span id="cb34-32"><a href="data.html#cb34-32" tabindex="-1"></a><span class="co"># make a long version</span></span>
<span id="cb34-33"><a href="data.html#cb34-33" tabindex="-1"></a>pi3k_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(pi3k_wide,</span>
<span id="cb34-34"><a href="data.html#cb34-34" tabindex="-1"></a>                  <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;id&quot;</span>, <span class="st">&quot;glucose_0&quot;</span>),</span>
<span id="cb34-35"><a href="data.html#cb34-35" tabindex="-1"></a>                  <span class="at">variable.name =</span> <span class="st">&quot;time&quot;</span>,</span>
<span id="cb34-36"><a href="data.html#cb34-36" tabindex="-1"></a>                  <span class="at">value.name =</span> <span class="st">&quot;glucose&quot;</span>)</span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>Read the comments on the usage of the <code>keep.names</code> and <code>make.names</code> arguments of <code>transpose</code>. These are powerful.</li>
<li>pi3k_wide has column names that are times (in minutes). This presents wrangling problems (column names shouldn’t be numbers. Here it is useful to create the long format data.table with a time column of numbers). For example, the code above creates copies the column “0” into a new column “glucose_0” using <code>glucose_0 := get("0")</code>. Had the code been <code>glucose_0 := "0"</code>, all values would be the character “0”. Had the code been <code>glucose_0 := 0</code>, all values would be the number 0. <code>get</code> looks for the column with the name of whatever is inside the parentheses.</li>
</ol>
<p>Let’s do a quick plot to examine the data</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="data.html#cb35-1" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> time,</span>
<span id="cb35-2"><a href="data.html#cb35-2" tabindex="-1"></a>      <span class="at">y =</span> glucose,</span>
<span id="cb35-3"><a href="data.html#cb35-3" tabindex="-1"></a>      <span class="at">data =</span> pi3k_long,</span>
<span id="cb35-4"><a href="data.html#cb35-4" tabindex="-1"></a>      <span class="at">color =</span> treatment) <span class="sc">+</span></span>
<span id="cb35-5"><a href="data.html#cb35-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-31-1.png" width="576" /></p>
</div>
</div>
<div id="combining-data" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Combining data<a href="data.html#combining-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Source <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0200817">Bak, A.M., Vendelbo, M.H., Christensen, B., Viggers, R., Bibby, B.M., Rungby, J., Jørgensen, J.O.L., Møller, N. and Jessen, N., 2018. Prolonged fasting-induced metabolic signatures in human skeletal muscle of lean and obese men. PloS one, 13(9), p.e0200817.</a></p>
<p><a href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.6121hj7">Source data</a></p>
<p>The data are from a randomized <strong>crossover</strong> design where 18 men (9 lean and 9 obese) were measured for multiple metabolic markers at two times: 1) in a post-absorptive state after 12 hours overnight fast, and 2) in a prolonged fasting state after 72 hours of fasting. In addition, at each time point, metabolic markers were measured prior to and after an insulin infusion. Here, we want to reproduce values in Table 2, which are measures of mean blood insulin and metabolite levels after 12 hours and 72 hours fasting in both the lean and obese groups.</p>
<p>A difficulty for the analyst is that the response data are in the “Table 2” sheet but the variable containing the assignment to “lean” or “obese” group is in the “Table 1” sheet. To analyze these response, the two datasets need to be combined into a single data frame. The important consideration when combining data is that <em>like is matched with like</em>. For the fasting dataset, “like” is the subject id, and we have some data for each subject id in Table 1 and other data for the same subject ids in Table 2. This means that we essentially want to glue the columns of table 2 to the columns of table 1 in a way that insures that the correct data for each subject id is on the same row. This is a bit more complicated for these data because Table 1 contains 18 data rows, one for each subject id and Table 2 contains 36 data rows, 2 for each subject id, because each subject has data measured at 12 hours and at 72 hours.</p>
</div>
<div id="data-subset" class="section level3 hasAnchor" number="3.5.4">
<h3><span class="header-section-number">3.5.4</span> Subsetting data<a href="data.html#data-subset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is common to see researchers create multiple subsets of data for further processing. This practice should be be discouraged because the same variables will be in multiple data frames and it can be hard to keep track of any processing of variables in the different datasets. Instead, subset the data at the level of analysis.</p>
<p>There are many ways to subset data in R. Experienced users tend to divide up into those using base R, those using the tidyverse packages, or those using data.table. Learn one well. This book uses data.table. Before outlining usage in data.table, let’s back up a bit and review different <em>indexing</em> systems.</p>
<ul>
<li>In Excel, rows are specified (or “indexed”) by numbers and columns by letters. Every cell has an address, for example C2 is the cell in the 2nd row and 3rd column. Notice that in Excel, the column part of the address comes before the row part.</li>
<li>In statistics, it is extremely common to use a system where <span class="math inline">\(x_{ij}\)</span> is the value of the element in the <em>i</em>th row and <em>j</em>th column of the matrix <strong>X</strong>. Notice that in this notatin, the row index (<em>i</em>) comes before the column index (<em>j</em>).</li>
<li>In programming languages, including R, it is extremely common to use a system where my_data[i, j] is the value of the element in the <em>i</em>th row and <em>j</em>th column of the matrix-like object named “my_data” (such as a data frame in R).</li>
<li>data.table explicitly refers to the row index and column index as <em>i</em> and <em>j</em>.</li>
</ul>
<div id="specifying-a-subset-of-rows-observations-or-cases" class="section level4 hasAnchor" number="3.5.4.1">
<h4><span class="header-section-number">3.5.4.1</span> Specifying a subset of rows (“observations” or “cases”)<a href="data.html#specifying-a-subset-of-rows-observations-or-cases" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A subset of rows is specified using either a list of row numbers or</p>
<p>In a data.table, a subset of rows is specified using either a list of row numbers or a combination of comparison operators (==, !=, &gt;, &lt;, &gt;=, &lt;=, %in%) and Boolean logic operators (&amp;, |, ! – these are “and”, “or”, “not”) as <em>i</em>.</p>
<p>Let’s use the pi3k_long data from above to explore this. First, the plot of plasma glucose for all individuals in each treatment group across all time points.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="data.html#cb36-1" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> time,</span>
<span id="cb36-2"><a href="data.html#cb36-2" tabindex="-1"></a>      <span class="at">y =</span> glucose,</span>
<span id="cb36-3"><a href="data.html#cb36-3" tabindex="-1"></a>      <span class="at">data =</span> pi3k_long,</span>
<span id="cb36-4"><a href="data.html#cb36-4" tabindex="-1"></a>      <span class="at">color =</span> treatment) <span class="sc">+</span></span>
<span id="cb36-5"><a href="data.html#cb36-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-32-1.png" width="576" /></p>
<p><code>pi3k_long[treatment == "Chow",])</code> is the subset of rows in which entries in the column “treatment” take the value “Chow” using the “is equal” (“==”) operator</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="data.html#cb37-1" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> time,</span>
<span id="cb37-2"><a href="data.html#cb37-2" tabindex="-1"></a>      <span class="at">y =</span> glucose,</span>
<span id="cb37-3"><a href="data.html#cb37-3" tabindex="-1"></a>      <span class="at">data =</span> pi3k_long[treatment <span class="sc">==</span> <span class="st">&quot;Chow&quot;</span>,],</span>
<span id="cb37-4"><a href="data.html#cb37-4" tabindex="-1"></a>      <span class="at">color =</span> treatment) <span class="sc">+</span></span>
<span id="cb37-5"><a href="data.html#cb37-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-33-1.png" width="576" /></p>
<p>And the subset of rows in which entries in the column “treatment” take any value but “Chow” using the “not equal” operator (“!=”).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="data.html#cb38-1" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> time,</span>
<span id="cb38-2"><a href="data.html#cb38-2" tabindex="-1"></a>      <span class="at">y =</span> glucose,</span>
<span id="cb38-3"><a href="data.html#cb38-3" tabindex="-1"></a>      <span class="at">data =</span> pi3k_long[treatment <span class="sc">!=</span> <span class="st">&quot;Chow&quot;</span>,],</span>
<span id="cb38-4"><a href="data.html#cb38-4" tabindex="-1"></a>      <span class="at">color =</span> treatment) <span class="sc">+</span></span>
<span id="cb38-5"><a href="data.html#cb38-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-34-1.png" width="576" /></p>
<p>The subset of rows in which entries in the column “treatment” take either the value “Chow” or the value “SGLT2i” by combining two “is equal” (“==”) operators using the OR (“|”) boolean operator</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="data.html#cb39-1" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> time,</span>
<span id="cb39-2"><a href="data.html#cb39-2" tabindex="-1"></a>      <span class="at">y =</span> glucose,</span>
<span id="cb39-3"><a href="data.html#cb39-3" tabindex="-1"></a>      <span class="at">data =</span> pi3k_long[treatment <span class="sc">==</span> <span class="st">&quot;Chow&quot;</span> <span class="sc">|</span> treatment <span class="sc">==</span> <span class="st">&quot;SGLT2i&quot;</span>,],</span>
<span id="cb39-4"><a href="data.html#cb39-4" tabindex="-1"></a>      <span class="at">color =</span> treatment) <span class="sc">+</span></span>
<span id="cb39-5"><a href="data.html#cb39-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-35-1.png" width="576" /></p>
<p>The subset of rows in which entries in the column “time” take either the value “30” or the value “60” using the “in a list” operator (%in%). The values in the “time” column look like integers but are actually treatment levels (which act like string or character variables).</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="data.html#cb40-1" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> time,</span>
<span id="cb40-2"><a href="data.html#cb40-2" tabindex="-1"></a>      <span class="at">y =</span> glucose,</span>
<span id="cb40-3"><a href="data.html#cb40-3" tabindex="-1"></a>      <span class="at">data =</span> pi3k_long[time  <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;30&quot;</span>, <span class="st">&quot;60&quot;</span>),],</span>
<span id="cb40-4"><a href="data.html#cb40-4" tabindex="-1"></a>      <span class="at">color =</span> treatment) <span class="sc">+</span></span>
<span id="cb40-5"><a href="data.html#cb40-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-36-1.png" width="576" /></p>
<p>The subset of rows in which entries in the column “time_c” are less than or equal to 60 using the “less than or equal to” operator AND the value in the treatment column is in the list (“Chow”, “SGLT2i”). The two comparisons are combined with the AND (“&amp;”) Boolean operator.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="data.html#cb41-1" tabindex="-1"></a>pi3k_long[, time_c <span class="sc">:=</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(time))]</span>
<span id="cb41-2"><a href="data.html#cb41-2" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> time,</span>
<span id="cb41-3"><a href="data.html#cb41-3" tabindex="-1"></a>      <span class="at">y =</span> glucose,</span>
<span id="cb41-4"><a href="data.html#cb41-4" tabindex="-1"></a>      <span class="at">data =</span> pi3k_long[time_c <span class="sc">&lt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> treatment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Chow&quot;</span>, <span class="st">&quot;SGLT2i&quot;</span>),],</span>
<span id="cb41-5"><a href="data.html#cb41-5" tabindex="-1"></a>      <span class="at">color =</span> treatment) <span class="sc">+</span></span>
<span id="cb41-6"><a href="data.html#cb41-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-37-1.png" width="576" /></p>
<p>The same result as above but using different operators. I would describe this as, the subset of rows in which entries in the column “time_c” are less than or equal to 60 using the “less than or equal to” operator AND the value in the treatment column is either “Chow” OR “SGLT2i”. The two comparisons are combined with the AND (“&amp;”) Boolean operator. The order of operations is determined by the parentheses, as with all algebra.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="data.html#cb42-1" tabindex="-1"></a>pi3k_long[, time_c <span class="sc">:=</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(time))]</span>
<span id="cb42-2"><a href="data.html#cb42-2" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> time,</span>
<span id="cb42-3"><a href="data.html#cb42-3" tabindex="-1"></a>      <span class="at">y =</span> glucose,</span>
<span id="cb42-4"><a href="data.html#cb42-4" tabindex="-1"></a>      <span class="at">data =</span> pi3k_long[time_c <span class="sc">&lt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> (treatment <span class="sc">==</span> <span class="st">&quot;Chow&quot;</span> <span class="sc">|</span> treatment <span class="sc">==</span> <span class="st">&quot;SGLT2i&quot;</span>),],</span>
<span id="cb42-5"><a href="data.html#cb42-5" tabindex="-1"></a>      <span class="at">color =</span> treatment) <span class="sc">+</span></span>
<span id="cb42-6"><a href="data.html#cb42-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-38-1.png" width="576" /></p>
</div>
</div>
<div id="wrangling-columns" class="section level3 hasAnchor" number="3.5.5">
<h3><span class="header-section-number">3.5.5</span> Wrangling columns<a href="data.html#wrangling-columns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="creating-new-columns-that-are-functions-of-values-in-existing-columnes" class="section level4 hasAnchor" number="3.5.5.1">
<h4><span class="header-section-number">3.5.5.1</span> Creating new columns that are functions of values in existing columnes<a href="data.html#creating-new-columns-that-are-functions-of-values-in-existing-columnes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>data.table allows math within the index arguments.</p>
<p><strong>Example 1: create a new column whose value is a function of values in other columns</strong></p>
<p>In this example, I create a column that contains the number of marked cells as a percent of the total cell count.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="data.html#cb43-1" tabindex="-1"></a><span class="co"># count to fraction - but probably want to analyze as a count! See xxx</span></span>
<span id="cb43-2"><a href="data.html#cb43-2" tabindex="-1"></a>figx[, marked_cells_perc <span class="sc">:=</span> marked_cells<span class="sc">/</span>total_cells <span class="sc">*</span> <span class="dv">100</span>]</span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\texttt{marked_cells}\)</span> and <span class="math inline">\(\texttt{total_cells}\)</span> are columns in the data.table <code>figx</code></li>
<li>You almost certainly want to analyze the original count column and use <span class="math inline">\(\texttt{total_cells}\)</span> as an offset in the model. See the section <a href="#glm_offset">Use a GLM with an offset instead of a ratio of some measurement per total</a></li>
</ol>
<p><strong>Example 2: create a new column whose value is a function of values in other columns</strong></p>
<p>In this example, I create the column <span class="math inline">\(\texttt{glucose_auc}\)</span>, which is the area under the curve of glucose measures at the different time points of glucose tolerance test. This computation requires the <code>auc</code> function below (typically, I put chunks with functions at the top of a R Markdown document). The computation uses the base R <code>apply</code> function.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="data.html#cb44-1" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">method=</span><span class="st">&quot;auc&quot;</span>){</span>
<span id="cb44-2"><a href="data.html#cb44-2" tabindex="-1"></a>  <span class="co"># method = &quot;auc&quot;, auc computed using trapezoidal calc</span></span>
<span id="cb44-3"><a href="data.html#cb44-3" tabindex="-1"></a>  <span class="co"># method = &quot;iauc&quot; is an incremental AUC of Le Floch</span></span>
<span id="cb44-4"><a href="data.html#cb44-4" tabindex="-1"></a>  <span class="co"># method = &quot;pos.iauc&quot; is a &quot;positive&quot; incremental AUC of Le Floch but not Wolever</span></span>
<span id="cb44-5"><a href="data.html#cb44-5" tabindex="-1"></a>  <span class="co"># method = &quot;pb.auc&quot; is AUC of post-time0 values</span></span>
<span id="cb44-6"><a href="data.html#cb44-6" tabindex="-1"></a>  <span class="cf">if</span>(method<span class="sc">==</span><span class="st">&quot;iauc&quot;</span>){y <span class="ot">&lt;-</span> y <span class="sc">-</span> y[<span class="dv">1</span>]}</span>
<span id="cb44-7"><a href="data.html#cb44-7" tabindex="-1"></a>  <span class="cf">if</span>(method<span class="sc">==</span><span class="st">&quot;pos.iauc&quot;</span>){y[y <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>}</span>
<span id="cb44-8"><a href="data.html#cb44-8" tabindex="-1"></a>  <span class="cf">if</span>(method<span class="sc">==</span><span class="st">&quot;pb.auc&quot;</span>){</span>
<span id="cb44-9"><a href="data.html#cb44-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb44-10"><a href="data.html#cb44-10" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb44-11"><a href="data.html#cb44-11" tabindex="-1"></a>  }</span>
<span id="cb44-12"><a href="data.html#cb44-12" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb44-13"><a href="data.html#cb44-13" tabindex="-1"></a>  area <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb44-14"><a href="data.html#cb44-14" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb44-15"><a href="data.html#cb44-15" tabindex="-1"></a>    area <span class="ot">&lt;-</span> area <span class="sc">+</span> (x[i] <span class="sc">-</span> x[i<span class="dv">-1</span>])<span class="sc">*</span>(y[i<span class="dv">-1</span>] <span class="sc">+</span> y[i])</span>
<span id="cb44-16"><a href="data.html#cb44-16" tabindex="-1"></a>  }</span>
<span id="cb44-17"><a href="data.html#cb44-17" tabindex="-1"></a>  area<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb44-18"><a href="data.html#cb44-18" tabindex="-1"></a>}</span></code></pre></div>
<p>Here is the implementation. The object <code>time_cols</code> is a vector containing the names of the columns containing the data at each time point.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="data.html#cb45-1" tabindex="-1"></a>time_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;time_0&quot;</span>, <span class="st">&quot;time_15&quot;</span>, <span class="st">&quot;time_30&quot;</span>, <span class="st">&quot;time_60&quot;</span>, <span class="st">&quot;time_90&quot;</span>, <span class="st">&quot;time_120&quot;</span>)</span>
<span id="cb45-2"><a href="data.html#cb45-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> figx_wide[, .SD, .SDcols <span class="ot">=</span> time_cols]</span>
<span id="cb45-3"><a href="data.html#cb45-3" tabindex="-1"></a>figx_wide[, glucose_auc <span class="sc">:=</span> <span class="fu">apply</span>(Y, <span class="dv">1</span>, auc, <span class="at">x =</span> times)]</span></code></pre></div>
</div>
<div id="change-the-reference-level-of-a-factor" class="section level4 hasAnchor" number="3.5.5.2">
<h4><span class="header-section-number">3.5.5.2</span> Change the reference level of a factor<a href="data.html#change-the-reference-level-of-a-factor" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Factor levels should always be arranged in a sensible order both for model fitting and for plotting. The first level in the vector is the reference level, which is an important concept for understanding the coefficients of the statistical models fit in this book.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="data.html#cb46-1" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;WT&quot;</span>, <span class="st">&quot;KO&quot;</span>, <span class="st">&quot;KO_drug&quot;</span>)</span>
<span id="cb46-2"><a href="data.html#cb46-2" tabindex="-1"></a>figx[, treatment <span class="sc">:=</span> <span class="fu">factor</span>(treatment,</span>
<span id="cb46-3"><a href="data.html#cb46-3" tabindex="-1"></a>                           <span class="at">levels =</span> treatment_levels)]</span></code></pre></div>
</div>
<div id="converting-a-single-column-with-all-combinations-of-a-2-x-2-factorial-experiment-into-two-columns-each-containing-the-two-levels-of-a-factor" class="section level4 hasAnchor" number="3.5.5.3">
<h4><span class="header-section-number">3.5.5.3</span> Converting a single column with all combinations of a 2 x 2 factorial experiment into two columns, each containing the two levels of a factor<a href="data.html#converting-a-single-column-with-all-combinations-of-a-2-x-2-factorial-experiment-into-two-columns-each-containing-the-two-levels-of-a-factor" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="example-1-tstrspl" class="section level5 hasAnchor" number="3.5.5.3.1">
<h5><span class="header-section-number">3.5.5.3.1</span> Example 1 (tstrspl)<a href="data.html#example-1-tstrspl" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The example data are analyzed in the chapter <a href="factorial.html#factorial">Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</a></p>
<p>Article source: <a href="https://www.nature.com/articles/s41586-020-1992-7" target="_blank">TLR9 and beclin 1 crosstalk regulates muscle AMPK activation in exercise</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7047589/" target="_blank">Public source</a></p>
<p>The data are from Figure 2j.</p>
<p><a href="https://www.nature.com/articles/s41586-020-1992-7#Sec27" target="_blank">Data source</a></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="data.html#cb47-1" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;TLR9 and beclin 1 crosstalk regulates muscle AMPK activation in exercise&quot;</span></span>
<span id="cb47-2"><a href="data.html#cb47-2" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41586_2020_1992_MOESM4_ESM.xlsx&quot;</span></span>
<span id="cb47-3"><a href="data.html#cb47-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb47-4"><a href="data.html#cb47-4" tabindex="-1"></a></span>
<span id="cb47-5"><a href="data.html#cb47-5" tabindex="-1"></a>treatment_levels  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;WT Resting&quot;</span>,</span>
<span id="cb47-6"><a href="data.html#cb47-6" tabindex="-1"></a>                       <span class="st">&quot;WT Active&quot;</span>,</span>
<span id="cb47-7"><a href="data.html#cb47-7" tabindex="-1"></a>                       <span class="st">&quot;Tlr9-/- Resting&quot;</span>,</span>
<span id="cb47-8"><a href="data.html#cb47-8" tabindex="-1"></a>                       <span class="st">&quot;Tlr9-/- Active&quot;</span>)</span>
<span id="cb47-9"><a href="data.html#cb47-9" tabindex="-1"></a>exp2j_wide <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb47-10"><a href="data.html#cb47-10" tabindex="-1"></a>                         <span class="at">sheet =</span> <span class="st">&quot;2j&quot;</span>,</span>
<span id="cb47-11"><a href="data.html#cb47-11" tabindex="-1"></a>                         <span class="at">range =</span> <span class="st">&quot;A5:D13&quot;</span>,</span>
<span id="cb47-12"><a href="data.html#cb47-12" tabindex="-1"></a>                         <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-13"><a href="data.html#cb47-13" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb47-14"><a href="data.html#cb47-14" tabindex="-1"></a></span>
<span id="cb47-15"><a href="data.html#cb47-15" tabindex="-1"></a><span class="fu">colnames</span>(exp2j_wide) <span class="ot">&lt;-</span> treatment_levels</span>
<span id="cb47-16"><a href="data.html#cb47-16" tabindex="-1"></a></span>
<span id="cb47-17"><a href="data.html#cb47-17" tabindex="-1"></a>exp2j <span class="ot">&lt;-</span> <span class="fu">melt</span>(exp2j_wide,</span>
<span id="cb47-18"><a href="data.html#cb47-18" tabindex="-1"></a>              <span class="at">measure.vars =</span> treatment_levels,</span>
<span id="cb47-19"><a href="data.html#cb47-19" tabindex="-1"></a>              <span class="at">variable.name =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb47-20"><a href="data.html#cb47-20" tabindex="-1"></a>              <span class="at">value.name =</span> <span class="st">&quot;glucose_uptake&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-21"><a href="data.html#cb47-21" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="co"># danger!</span></span>
<span id="cb47-22"><a href="data.html#cb47-22" tabindex="-1"></a></span>
<span id="cb47-23"><a href="data.html#cb47-23" tabindex="-1"></a>exp2j[, <span class="fu">c</span>(<span class="st">&quot;genotype&quot;</span>, <span class="st">&quot;stimulation&quot;</span>) <span class="sc">:=</span> <span class="fu">tstrsplit</span>(treatment,</span>
<span id="cb47-24"><a href="data.html#cb47-24" tabindex="-1"></a>                                                  <span class="st">&quot; &quot;</span>,</span>
<span id="cb47-25"><a href="data.html#cb47-25" tabindex="-1"></a>                                                  <span class="at">fixed =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb47-26"><a href="data.html#cb47-26" tabindex="-1"></a></span>
<span id="cb47-27"><a href="data.html#cb47-27" tabindex="-1"></a>genotype_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;WT&quot;</span>, <span class="st">&quot;Tlr9-/-&quot;</span>)</span>
<span id="cb47-28"><a href="data.html#cb47-28" tabindex="-1"></a>stimulation_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Resting&quot;</span>, <span class="st">&quot;Active&quot;</span>)</span>
<span id="cb47-29"><a href="data.html#cb47-29" tabindex="-1"></a>exp2j[, genotype <span class="sc">:=</span> <span class="fu">factor</span>(genotype,</span>
<span id="cb47-30"><a href="data.html#cb47-30" tabindex="-1"></a>                           <span class="at">levels =</span> genotype_levels)]</span>
<span id="cb47-31"><a href="data.html#cb47-31" tabindex="-1"></a>exp2j[, stimulation <span class="sc">:=</span> <span class="fu">factor</span>(stimulation,</span>
<span id="cb47-32"><a href="data.html#cb47-32" tabindex="-1"></a>                              <span class="at">levels =</span> stimulation_levels)]</span>
<span id="cb47-33"><a href="data.html#cb47-33" tabindex="-1"></a><span class="co"># View(exp2j)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Melting the wide data creates a column <span class="math inline">\(\texttt{treatment}\)</span> containing the column names of the wide data. The column type is character (often called “string” because each the variable is a string of characters). We want to split the string at the space, and put the first part into one new column and the second part into a second new column.</li>
<li>The <code>tstrsplit()</code> function from the data.table package does this split for us. The first argument is the name of the column that contains the strings that we want to split. The second argument is the character that we want to split on. <code>c("genotype", "stimulation")</code> before <code>:=</code> sets the names of the new columns containing. This is a really elegant solution.</li>
<li>I replaced the original column names of initial import for several reasons:</li>
</ol>
<ul>
<li>“Electrical Stimulation” is too long and will make the coefficient names unwieldy. This could be shortened to “Stimulation”, but…</li>
<li>I don’t want a factor name to include a level with the same name. I like the factor name <span class="math inline">\(\texttt{stimulation}\)</span>, so I I renamed the level “Electrical Stimulation” to “Active”.</li>
<li>We are splitting the column names using the space character ” ” and two of the original column names have two spaces, the 2nd inside what should be a single level (“Electrical Stimulation”)</li>
<li>The read_excel function removed a space in the last column name, which is read as “Tlr9-/-Electrical Stimulation”.</li>
</ul>
<p>Here is a peek at the data prior to melting wide to long</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
WT Resting
</th>
<th style="text-align:right;">
WT Active
</th>
<th style="text-align:right;">
Tlr9-/- Resting
</th>
<th style="text-align:right;">
Tlr9-/- Active
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5.437741
</td>
<td style="text-align:right;">
9.511914
</td>
<td style="text-align:right;">
7.969706
</td>
<td style="text-align:right;">
7.793486
</td>
</tr>
<tr>
<td style="text-align:right;">
6.026892
</td>
<td style="text-align:right;">
9.901527
</td>
<td style="text-align:right;">
9.660112
</td>
<td style="text-align:right;">
9.561649
</td>
</tr>
<tr>
<td style="text-align:right;">
7.731616
</td>
<td style="text-align:right;">
13.038920
</td>
<td style="text-align:right;">
6.709424
</td>
<td style="text-align:right;">
8.055529
</td>
</tr>
<tr>
<td style="text-align:right;">
6.285710
</td>
<td style="text-align:right;">
9.665391
</td>
<td style="text-align:right;">
5.259744
</td>
<td style="text-align:right;">
7.739374
</td>
</tr>
<tr>
<td style="text-align:right;">
7.343797
</td>
<td style="text-align:right;">
8.590693
</td>
<td style="text-align:right;">
8.244721
</td>
<td style="text-align:right;">
10.312190
</td>
</tr>
</tbody>
</table>
<p>And a peek of the first three and last three rows after the melt.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:right;">
glucose_uptake
</th>
<th style="text-align:left;">
genotype
</th>
<th style="text-align:left;">
stimulation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
WT Resting
</td>
<td style="text-align:right;">
5.437741
</td>
<td style="text-align:left;">
WT
</td>
<td style="text-align:left;">
Resting
</td>
</tr>
<tr>
<td style="text-align:left;">
WT Resting
</td>
<td style="text-align:right;">
6.026892
</td>
<td style="text-align:left;">
WT
</td>
<td style="text-align:left;">
Resting
</td>
</tr>
<tr>
<td style="text-align:left;">
WT Resting
</td>
<td style="text-align:right;">
7.731616
</td>
<td style="text-align:left;">
WT
</td>
<td style="text-align:left;">
Resting
</td>
</tr>
<tr>
<td style="text-align:left;">
Tlr9-/- Active
</td>
<td style="text-align:right;">
10.312190
</td>
<td style="text-align:left;">
Tlr9-/-
</td>
<td style="text-align:left;">
Active
</td>
</tr>
<tr>
<td style="text-align:left;">
Tlr9-/- Active
</td>
<td style="text-align:right;">
7.943574
</td>
<td style="text-align:left;">
Tlr9-/-
</td>
<td style="text-align:left;">
Active
</td>
</tr>
<tr>
<td style="text-align:left;">
Tlr9-/- Active
</td>
<td style="text-align:right;">
9.292673
</td>
<td style="text-align:left;">
Tlr9-/-
</td>
<td style="text-align:left;">
Active
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-2" class="section level5 hasAnchor" number="3.5.5.3.2">
<h5><span class="header-section-number">3.5.5.3.2</span> Example 2<a href="data.html#example-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Source: <a href="2018">Tauriello, D., Palomo-Ponce, S., Stork, D. et al. TGFβ drives immune evasion in genetically reconstituted colon cancer metastasis. Nature 554, 538–543</a> <a href="doi:10.1038/nature25492" class="uri">doi:10.1038/nature25492</a></p>
<p><a href="https://www.nature.com/articles/nature25492#Sec23">Source data</a></p>
<p>filename: “41586_2018_BFnature25492_MOESM10_ESM.xlsx”</p>
<p>sheet: “Fig. 4h-tumours”</p>
<p>The analysis of the data in Fig. 4h specifies a single <span class="math inline">\(X\)</span> variable “Treatment” with four levels (or groups): “Con”, “Gal”, “aPD-L1”, and “Gal+aPD-L1”. These levels indicate that the design is actually <strong>factorial</strong> with two factors, each with two levels. The first factor has levels “no Gal” and “Gal”. The second factor has levels “no aPD-L1”, “aPD-L1”. The single column Treatment “flattens” the 2 X 2 factorial design to a 4 x 1 design. In general, we would want to analyze an experiment like this as factorial model, because this allows us to make inferences about the <em>interaction effect</em> between the two factors. For these inferences, we need a standard error, or a confidence interval, or a <em>p</em>-value of the estimate, which we can easily get from the factorial model. In order to analyze the data with a factorial model, we need to create two new columns – one column is the factor variable containing the two levels of Gal and one column is the factor variable containing the two levels of aPD-L1.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="data.html#cb48-1" tabindex="-1"></a>gal_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;no Gal&quot;</span>, <span class="st">&quot;Gal&quot;</span>)</span>
<span id="cb48-2"><a href="data.html#cb48-2" tabindex="-1"></a>tumor[, gal <span class="sc">:=</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">&quot;Gal&quot;</span> <span class="sc">|</span> treatment <span class="sc">==</span> <span class="st">&quot;Gal+aPD-L1&quot;</span>,</span>
<span id="cb48-3"><a href="data.html#cb48-3" tabindex="-1"></a>                      gal_levels[<span class="dv">2</span>],</span>
<span id="cb48-4"><a href="data.html#cb48-4" tabindex="-1"></a>                      gal_levels[<span class="dv">1</span>])]</span>
<span id="cb48-5"><a href="data.html#cb48-5" tabindex="-1"></a></span>
<span id="cb48-6"><a href="data.html#cb48-6" tabindex="-1"></a>apd_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;no aPD-L1&quot;</span>, <span class="st">&quot;aPD-L1&quot;</span>)</span>
<span id="cb48-7"><a href="data.html#cb48-7" tabindex="-1"></a>tumor[, apdl1 <span class="sc">:=</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">&quot;aPD-L1&quot;</span> <span class="sc">|</span> treatment <span class="sc">==</span> <span class="st">&quot;Gal+aPD-L1&quot;</span>,</span>
<span id="cb48-8"><a href="data.html#cb48-8" tabindex="-1"></a>                      apd_levels[<span class="dv">2</span>],</span>
<span id="cb48-9"><a href="data.html#cb48-9" tabindex="-1"></a>                      apd_levels[<span class="dv">1</span>])]</span>
<span id="cb48-10"><a href="data.html#cb48-10" tabindex="-1"></a></span>
<span id="cb48-11"><a href="data.html#cb48-11" tabindex="-1"></a><span class="co"># re-order factor levels</span></span>
<span id="cb48-12"><a href="data.html#cb48-12" tabindex="-1"></a>tumor[, gal<span class="sc">:=</span><span class="fu">factor</span>(gal, gal_levels)]</span>
<span id="cb48-13"><a href="data.html#cb48-13" tabindex="-1"></a>tumor[, apdl1<span class="sc">:=</span><span class="fu">factor</span>(apdl1, apd_levels)]</span></code></pre></div>
<p>A way to check the results to make sure that our conversion is correct is to compute the sample size for the 2 x 2 combinations, but include the original treatment column in the <code>by</code> list.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="data.html#cb49-1" tabindex="-1"></a>tumor[<span class="sc">!</span><span class="fu">is.na</span>(num_positive_per_mm), .(<span class="at">N=</span>.N), by<span class="ot">=</span>.(treatment, gal, apdl1)]</span></code></pre></div>
<pre><code>##     treatment    gal     apdl1   N
## 1:        Con no Gal no aPD-L1 124
## 2:        Gal    Gal no aPD-L1  89
## 3:     aPD-L1 no Gal    aPD-L1 101
## 4: Gal+aPD-L1    Gal    aPD-L1  58</code></pre>
<p>That looks good.</p>
<p><strong>Bug alert</strong> If you break Rule #1, and type in the treatment level “Gal+aPD-L1” as “Gal + aPD-L1”, then you will get new columns containing junk.</p>
<pre><code>##     treatment    gal     apdl1   N
## 1:        Con no Gal no aPD-L1 124
## 2:        Gal    Gal no aPD-L1  89
## 3:     aPD-L1 no Gal    aPD-L1 101
## 4: Gal+aPD-L1 no Gal no aPD-L1  58</code></pre>
<p>Remember Rule #1. Always copy and paste any text that will be inserted into quotes. This is easily done here by typing <code>unique(tumor$treatment)</code> into the console. This function returns the unique values of the column “treatment” of the data.table “tumor”.</p>
<blockquote>
<p>unique(tumor$treatment)
[1] “Con” “Gal” “aPD-L1” “Gal+aPD-L1”</p>
</blockquote>
<p>Now, copy the name of a level and paste into your code. Repeat until done.</p>
</div>
</div>
</div>
<div id="missing-data" class="section level3 hasAnchor" number="3.5.6">
<h3><span class="header-section-number">3.5.6</span> Missing data<a href="data.html#missing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Source: <a href="https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1008002">Deletion of Cdkn1b in ACI rats leads to increased proliferation and pregnancy-associated changes in the mammary gland due to perturbed systemic endocrine environment</a></p>
<p><a href="https://doi.org/10.1371/journal.pgen.1008002.s008">Source data</a></p>
<p>Supplement Figure 1F of this paper shows weight as a function of age class and genotype for the whole body and 8 organs. There are some missing weights in the Excel-archived data. These missing data are designated with a minus “-” sign. To import these data in correctly, use the <code>na =</code> argument in the <code>read_excel</code> function.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="data.html#cb52-1" tabindex="-1"></a>file_folder <span class="ot">&lt;-</span> <span class="st">&quot;Deletion of Cdkn1b in ACI rats leads to increased proliferation and pregnancy-associated changes in the mammary gland due to perturbed systemic endocrine environment&quot;</span></span>
<span id="cb52-2"><a href="data.html#cb52-2" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;journal.pgen.1008002.s008.xlsx&quot;</span></span>
<span id="cb52-3"><a href="data.html#cb52-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, file_folder, file_name)</span>
<span id="cb52-4"><a href="data.html#cb52-4" tabindex="-1"></a>  </span>
<span id="cb52-5"><a href="data.html#cb52-5" tabindex="-1"></a>fig_s1f <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb52-6"><a href="data.html#cb52-6" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;all weights&quot;</span>,</span>
<span id="cb52-7"><a href="data.html#cb52-7" tabindex="-1"></a>                    <span class="at">range =</span> <span class="st">&quot;A2:K57&quot;</span>,</span>
<span id="cb52-8"><a href="data.html#cb52-8" tabindex="-1"></a>                    <span class="at">na =</span> <span class="st">&quot;-&quot;</span>,</span>
<span id="cb52-9"><a href="data.html#cb52-9" tabindex="-1"></a>                    <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-10"><a href="data.html#cb52-10" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-11"><a href="data.html#cb52-11" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb52-12"><a href="data.html#cb52-12" tabindex="-1"></a></span>
<span id="cb52-13"><a href="data.html#cb52-13" tabindex="-1"></a>fig_s1f[, genotype <span class="sc">:=</span> <span class="fu">factor</span>(genotype, <span class="fu">c</span>(<span class="st">&quot;+/+&quot;</span>, <span class="st">&quot;-/-&quot;</span>))]</span>
<span id="cb52-14"><a href="data.html#cb52-14" tabindex="-1"></a>fig_s1f[, age_class <span class="sc">:=</span> <span class="fu">ifelse</span>(age_at_sac_wks <span class="sc">&lt;=</span> <span class="fl">6.0</span>, <span class="st">&quot;4-6&quot;</span>, <span class="st">&quot;8+&quot;</span>)]</span>
<span id="cb52-15"><a href="data.html#cb52-15" tabindex="-1"></a></span>
<span id="cb52-16"><a href="data.html#cb52-16" tabindex="-1"></a><span class="co"># View(fig_s1f)</span></span></code></pre></div>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li>In R, a value of “NA” represents missing.</li>
<li>The default value for <code>na =</code> is an empty (or blank) cell (not a space but a cell that is empty).</li>
<li><code>na =</code> accepts a list of strings, for example <code>na = c("", "-99", "--")</code> that will all be read as na.</li>
</ol>
<div id="handling-missing-data" class="section level4 hasAnchor" number="3.5.6.1">
<h4><span class="header-section-number">3.5.6.1</span> Handling missing data<a href="data.html#handling-missing-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="many-base-r-functions-used-for-summary-measures-require-na-handling" class="section level5 hasAnchor" number="3.5.6.1.1">
<h5><span class="header-section-number">3.5.6.1.1</span> Many base R functions used for summary measures require NA handling<a href="data.html#many-base-r-functions-used-for-summary-measures-require-na-handling" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="data.html#cb53-1" tabindex="-1"></a><span class="fu">mean</span>(fig_s1f[, ovary]) <span class="co"># returns &quot;NA&quot;</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="data.html#cb55-1" tabindex="-1"></a><span class="fu">mean</span>(fig_s1f[, ovary], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># returns the mean</span></span></code></pre></div>
<pre><code>## [1] 0.2489524</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="data.html#cb57-1" tabindex="-1"></a><span class="fu">sd</span>(fig_s1f[, ovary]) <span class="co"># returns &quot;NA&quot;</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="data.html#cb59-1" tabindex="-1"></a><span class="fu">sd</span>(fig_s1f[, ovary], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># returns the mean</span></span></code></pre></div>
<pre><code>## [1] 0.151694</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="data.html#cb61-1" tabindex="-1"></a><span class="fu">sum</span>(fig_s1f[, ovary]) <span class="co"># returns &quot;NA&quot;</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="data.html#cb63-1" tabindex="-1"></a><span class="fu">sum</span>(fig_s1f[, ovary], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># returns the mean</span></span></code></pre></div>
<pre><code>## [1] 10.456</code></pre>
<p>There are many ways to get the sample size for a particular variable. Be careful if using <code>length()</code> which counts NA as part of the vector of values.</p>
</div>
<div id="the-is.na-function-is-useful" class="section level5 hasAnchor" number="3.5.6.1.2">
<h5><span class="header-section-number">3.5.6.1.2</span> The !is.na function is useful<a href="data.html#the-is.na-function-is-useful" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="data.html#cb65-1" tabindex="-1"></a><span class="fu">length</span>(fig_s1f[, ovary])</span></code></pre></div>
<pre><code>## [1] 55</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="data.html#cb67-1" tabindex="-1"></a><span class="fu">length</span>(fig_s1f[<span class="sc">!</span><span class="fu">is.na</span>(ovary), ovary])</span></code></pre></div>
<pre><code>## [1] 42</code></pre>
<p>Notes</p>
<ol style="list-style-type: decimal">
<li><code>!is.na(ovary)</code> is taking the subset of rows of fig_s1f for which the value of “ovary” is not NA (!is.na is read “not is.na”)</li>
</ol>
<p>This is especially useful if you are creating your own code uses counts. Here I create a table of means, standard error of the mean, and 95% CIs of the mean for each genotype group. But first, this script generates the wrong N for each group (since there are missing values), although the mean and SD are correct.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="data.html#cb69-1" tabindex="-1"></a>fig_s1f[, .(<span class="at">mean =</span> <span class="fu">mean</span>(spleen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb69-2"><a href="data.html#cb69-2" tabindex="-1"></a>            <span class="at">n =</span> .N,</span>
<span id="cb69-3"><a href="data.html#cb69-3" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(spleen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb69-4"><a href="data.html#cb69-4" tabindex="-1"></a>        by <span class="ot">=</span> genotype]</span></code></pre></div>
<pre><code>##    genotype      mean  n         sd
## 1:      -/- 0.5801333 21 0.13680480
## 2:      +/+ 0.2956667 34 0.04460855</code></pre>
<p>To compute the correct <em>n</em>, which will be necessary for computing the SE and the CI, use <code>!is.na</code></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="data.html#cb71-1" tabindex="-1"></a>spleen_summary <span class="ot">&lt;-</span> fig_s1f[<span class="sc">!</span><span class="fu">is.na</span>(spleen), .(<span class="at">mean =</span> <span class="fu">mean</span>(spleen),</span>
<span id="cb71-2"><a href="data.html#cb71-2" tabindex="-1"></a>            <span class="at">n =</span> .N,</span>
<span id="cb71-3"><a href="data.html#cb71-3" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(spleen)),</span>
<span id="cb71-4"><a href="data.html#cb71-4" tabindex="-1"></a>        by <span class="ot">=</span> genotype]</span>
<span id="cb71-5"><a href="data.html#cb71-5" tabindex="-1"></a>spleen_summary[, se <span class="sc">:=</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n)]</span>
<span id="cb71-6"><a href="data.html#cb71-6" tabindex="-1"></a>spleen_summary[, lower <span class="sc">:=</span> mean <span class="sc">+</span> se<span class="sc">*</span><span class="fu">qt</span>(.<span class="dv">025</span>, (n<span class="dv">-1</span>))]</span>
<span id="cb71-7"><a href="data.html#cb71-7" tabindex="-1"></a>spleen_summary[, upper <span class="sc">:=</span> mean <span class="sc">+</span> se<span class="sc">*</span><span class="fu">qt</span>(.<span class="dv">975</span>, (n<span class="dv">-1</span>))]</span>
<span id="cb71-8"><a href="data.html#cb71-8" tabindex="-1"></a>spleen_summary</span></code></pre></div>
<pre><code>##    genotype      mean  n         sd         se     lower     upper
## 1:      -/- 0.5801333 15 0.13680480 0.03532285 0.5043734 0.6558933
## 2:      +/+ 0.2956667 27 0.04460855 0.00858492 0.2780201 0.3133132</code></pre>
</div>
<div id="ggplot-functions-automatically-handle-missing-values" class="section level5 hasAnchor" number="3.5.6.1.3">
<h5><span class="header-section-number">3.5.6.1.3</span> ggplot functions automatically handle missing values<a href="data.html#ggplot-functions-automatically-handle-missing-values" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>with a useful warning.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="data.html#cb73-1" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> body_wt_g_sac,</span>
<span id="cb73-2"><a href="data.html#cb73-2" tabindex="-1"></a>      <span class="at">y =</span> spleen,</span>
<span id="cb73-3"><a href="data.html#cb73-3" tabindex="-1"></a>      <span class="at">color =</span> genotype,</span>
<span id="cb73-4"><a href="data.html#cb73-4" tabindex="-1"></a>      <span class="at">data =</span> fig_s1f)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-48-1.png" width="576" /></p>
</div>
<div id="regression-model-functions-lm-glm-gls-etc.-handle-missing-values-by-default" class="section level5 hasAnchor" number="3.5.6.1.4">
<h5><span class="header-section-number">3.5.6.1.4</span> Regression model functions (lm, glm, gls, etc.) handle missing values by default<a href="data.html#regression-model-functions-lm-glm-gls-etc.-handle-missing-values-by-default" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Missing data in regression model functions such as <code>lm</code> are handled using the argument <code>na.action =</code> and the default is “na.omit”, which omits any rows that contain a missing value in one or more of the model variables (it includes rows if these contain missing values only in the columns not included in the model). It’s as if the user took the subset of data including only the columns containing the model variables and then deleted any row with missing values.</p>
<p>Here is the coefficient table of the fit model object that did not explictly tell the <code>lm</code> function how to handle missing data.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="data.html#cb74-1" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(spleen <span class="sc">~</span> body_wt_g_sac <span class="sc">+</span> genotype,</span>
<span id="cb74-2"><a href="data.html#cb74-2" tabindex="-1"></a>         <span class="at">data =</span> fig_s1f)</span>
<span id="cb74-3"><a href="data.html#cb74-3" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(m1))</span></code></pre></div>
<pre><code>##                 Estimate   Std. Error   t value     Pr(&gt;|t|)
## (Intercept)   0.04238009 0.0242993900  1.744081 8.902319e-02
## body_wt_g_sac 0.00167493 0.0001506493 11.118067 1.170042e-13
## genotype-/-   0.23760586 0.0147600545 16.097898 8.072069e-19</code></pre>
<p>Here is the coefficient table of the fit model object that did explicitly tell <code>lm</code> how to handle missing data, using the argument <code>na.action = "na.exclude"</code>. These coefficient tables are the same.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="data.html#cb76-1" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(spleen <span class="sc">~</span> body_wt_g_sac <span class="sc">+</span> genotype,</span>
<span id="cb76-2"><a href="data.html#cb76-2" tabindex="-1"></a>         <span class="at">data =</span> fig_s1f,</span>
<span id="cb76-3"><a href="data.html#cb76-3" tabindex="-1"></a>         <span class="at">na.action =</span> <span class="st">&quot;na.exclude&quot;</span>)</span>
<span id="cb76-4"><a href="data.html#cb76-4" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(m2))</span></code></pre></div>
<pre><code>##                 Estimate   Std. Error   t value     Pr(&gt;|t|)
## (Intercept)   0.04238009 0.0242993900  1.744081 8.902319e-02
## body_wt_g_sac 0.00167493 0.0001506493 11.118067 1.170042e-13
## genotype-/-   0.23760586 0.0147600545 16.097898 8.072069e-19</code></pre>
</div>
</div>
<div id="butbeware-of-fitted-predicted-or-residual-values-from-regression-model-functions-unless-youve-explictly-told-the-function-how-to-handle-missing-values" class="section level4 hasAnchor" number="3.5.6.2">
<h4><span class="header-section-number">3.5.6.2</span> But…beware of fitted, predicted, or residual values from regression model functions unless you’ve explictly told the function how to handle missing values<a href="data.html#butbeware-of-fitted-predicted-or-residual-values-from-regression-model-functions-unless-youve-explictly-told-the-function-how-to-handle-missing-values" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Use <code>na.action = "na.exclude"</code></strong> if you want to add the fitted (or predicted) values or residuals as new columns in the original data object (fig_sf1). Compare the length of the fitted values vector from models m1 (using the default “na.omit”) and m2 (using the “na.exclude”).</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="data.html#cb78-1" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">fitted</span>(m1))</span></code></pre></div>
<pre><code>## [1] 42</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="data.html#cb80-1" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">fitted</span>(m2))</span></code></pre></div>
<pre><code>## [1] 55</code></pre>
<p>There are 55 observations (rows in the data) but only 42 complete rows with no missing values. The vector of fitted values from m1 has 42 fitted values. The vector of fitted values from m2 has 55 elements, the 42 fitted values plus 13 NA elements.</p>
<p>This is important if we want to do something like add the fitted values (or residuals, or some function of these) to the original data object (fig_sf1). Here I compute the spleen weights adjusted to the mean body weight of the control (“+/+”) group using the residuals from m1 and m2.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="data.html#cb82-1" tabindex="-1"></a>mean_x_control <span class="ot">&lt;-</span> <span class="fu">mean</span>(fig_s1f[genotype <span class="sc">==</span> <span class="st">&quot;+/+&quot;</span>, body_wt_g_sac])</span>
<span id="cb82-2"><a href="data.html#cb82-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(m1)</span>
<span id="cb82-3"><a href="data.html#cb82-3" tabindex="-1"></a>fig_s1f[, spleen_adj_m1 <span class="sc">:=</span> b[<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb82-4"><a href="data.html#cb82-4" tabindex="-1"></a>          b[<span class="dv">2</span>]<span class="sc">*</span>mean_x_control <span class="sc">+</span></span>
<span id="cb82-5"><a href="data.html#cb82-5" tabindex="-1"></a>          b[<span class="dv">3</span>]<span class="sc">*</span>(<span class="fu">as.integer</span>(genotype)<span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb82-6"><a href="data.html#cb82-6" tabindex="-1"></a>          <span class="fu">residuals</span>(m1))]</span>
<span id="cb82-7"><a href="data.html#cb82-7" tabindex="-1"></a>fig_s1f[, spleen_adj_m2 <span class="sc">:=</span> b[<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb82-8"><a href="data.html#cb82-8" tabindex="-1"></a>          b[<span class="dv">2</span>]<span class="sc">*</span>mean_x_control <span class="sc">+</span></span>
<span id="cb82-9"><a href="data.html#cb82-9" tabindex="-1"></a>          b[<span class="dv">3</span>]<span class="sc">*</span>(<span class="fu">as.integer</span>(genotype)<span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb82-10"><a href="data.html#cb82-10" tabindex="-1"></a>          <span class="fu">residuals</span>(m2))]</span>
<span id="cb82-11"><a href="data.html#cb82-11" tabindex="-1"></a><span class="co"># View(fig_s1f)</span></span></code></pre></div>
<p>The computation of “spleen_adj_m1” returns a warning that the values of <code>residuals(m1)</code> were recycled (the first 42 elements of the new column were filled with the 42 residuals and the last 13 elements of the new column were filled with the first 13 residuals) – after the first row of missing data, all of these computed adjusted values are wrong. Using <code>residuals(m2</code>), the adjusted values are matched to the correct row and the rows with missing variables do not have an adjusted value (because there is no residual to compute this).</p>
</div>
</div>
</div>
<div id="saving-data" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Saving data<a href="data.html#saving-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For many projects, it is uncommon to save data. I might save simulated data if it takes a long time (tens of minutes to hours or even days) to generate these and I simply want to work with the simulated data in the future and not have to regenerate it. Or I might save wrangled data if it takes a long time to import and wrangle and I want to analyze the wrangled data in the future and not have to re-import and re-wrangle it.</p>
<p>If the data will only be used in this or future R projects, the data can be saved as an R object using <code>saveRDS()</code></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="data.html#cb83-1" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Drosophila serotonin 2A receptor signaling coordinates central metabolic processes to modulate aging in response to nutrient choice&quot;</span></span>
<span id="cb83-2"><a href="data.html#cb83-2" tabindex="-1"></a>outfile_name <span class="ot">&lt;-</span> <span class="st">&quot;elife-59399-fig1h.Rds&quot;</span></span>
<span id="cb83-3"><a href="data.html#cb83-3" tabindex="-1"></a>save_file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, outfile_name)</span>
<span id="cb83-4"><a href="data.html#cb83-4" tabindex="-1"></a><span class="fu">saveRDS</span>(<span class="at">object =</span> exp1h, <span class="at">file =</span> save_file_path)</span>
<span id="cb83-5"><a href="data.html#cb83-5" tabindex="-1"></a></span>
<span id="cb83-6"><a href="data.html#cb83-6" tabindex="-1"></a><span class="co"># to read this use</span></span>
<span id="cb83-7"><a href="data.html#cb83-7" tabindex="-1"></a>exp1h <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(save_file_path)</span></code></pre></div>
<p>Reading a large .Rds file is very fast compared to reading the same data stored as a text file. However, if the data need to be imported into some other software, such as a spreadsheet, then save the data as a text file.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="data.html#cb84-1" tabindex="-1"></a><span class="co"># save the data to correct data_from folder</span></span>
<span id="cb84-2"><a href="data.html#cb84-2" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Drosophila serotonin 2A receptor signaling coordinates central metabolic processes to modulate aging in response to nutrient choice&quot;</span></span>
<span id="cb84-3"><a href="data.html#cb84-3" tabindex="-1"></a></span>
<span id="cb84-4"><a href="data.html#cb84-4" tabindex="-1"></a><span class="co"># tab delimited</span></span>
<span id="cb84-5"><a href="data.html#cb84-5" tabindex="-1"></a>outfile_name <span class="ot">&lt;-</span> <span class="st">&quot;elife-59399-fig1h.txt&quot;</span></span>
<span id="cb84-6"><a href="data.html#cb84-6" tabindex="-1"></a>save_file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, outfile_name)</span>
<span id="cb84-7"><a href="data.html#cb84-7" tabindex="-1"></a><span class="fu">write.table</span>(exp1h, save_file_path, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb84-8"><a href="data.html#cb84-8" tabindex="-1"></a></span>
<span id="cb84-9"><a href="data.html#cb84-9" tabindex="-1"></a><span class="co"># comma delimited</span></span>
<span id="cb84-10"><a href="data.html#cb84-10" tabindex="-1"></a>outfile_name <span class="ot">&lt;-</span> <span class="st">&quot;elife-59399-fig1h.csv&quot;</span></span>
<span id="cb84-11"><a href="data.html#cb84-11" tabindex="-1"></a>save_file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, outfile_name)</span>
<span id="cb84-12"><a href="data.html#cb84-12" tabindex="-1"></a><span class="fu">write.table</span>(exp1h, save_file_path, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Look at your project directory to make sure the file is where it should be! We used <code>write.table()</code> to create a tab-delimited text file using <code>sep = "\t"</code> to specify tabs to separate the row elements. “ is the standard character string for a tab. Check in your data_from folder (with the name”Drosophila serotonin 2A receptor signaling coordinates central metabolic processes to modulate aging in response to nutrient choice”) and open the file in a text editor.</p>
</div>
<div id="exercises" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Exercises<a href="data.html#exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Import and pretty-good-plot the data for Figure 2i of the Adipsin paper. You will need to download and archive the Excel file for “Figure 2”. Store this within the “Adipsin preserves beta cells…” folder.</li>
</ol>
<ul>
<li>The data are the percent of cells staining for <a href="https://en.wikipedia.org/wiki/NKX6-1">NKX6.1</a>, which is a transcription factor protein that regulates beta cell development in the pancreas. Beta cells sense glucose levels in the blood and secrete insulin. Disruption of the insulin signaling system results in Diabetes mellitus.</li>
<li>The data are in wide format, with each treatment group in a separate column. The data need to be melted into long format with a new column called “treatment”.</li>
<li>This will give you a pretty good plot of the data (if the data object is named “adipsin_fig2i”)</li>
</ul>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="data.html#cb85-1" tabindex="-1"></a><span class="fu">ggstripchart</span>(<span class="at">data =</span> adipsin_fig2i,</span>
<span id="cb85-2"><a href="data.html#cb85-2" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb85-3"><a href="data.html#cb85-3" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">&quot;nkx6_1&quot;</span>,</span>
<span id="cb85-4"><a href="data.html#cb85-4" tabindex="-1"></a>             <span class="at">add =</span> <span class="st">&quot;mean_se&quot;</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-54-1.png" width="576" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Import and quick pretty-good-plot the data for Figure 3b of the PI3K paper. You will need to download and archive the Excel file for “Figure 3”. Store this within the “Suppression of insulin feedback enhances…” folder.</li>
</ol>
<ul>
<li>The data are <a href="https://en.wikipedia.org/wiki/C-peptide">c-peptide</a> levels in response to the treatments. C-peptide is cleaved from the pro-insulin polypeptide and circulates in the blood and is a marker of how much insulin is being produced by the beta cells of the pancreas.</li>
<li>The data are in wide format, with each treatment group in a separate column. The data need to be melted into long format with a new column called “treatment”.</li>
<li>Modify the code from exercise 1 to pretty-good-plot the data as in exercise 1.</li>
</ul>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-56-1.png" width="576" /></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p><a href="https://elifesciences.org/articles/53560" target="_blank">Corrigan, June K., et al. “A big-data approach to understanding metabolic rate and response to obesity in laboratory mice.” Elife 9 (2020): e53560.</a>)<a href="data.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="part-ii-r-fundamentals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/06-data-reading_writing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
