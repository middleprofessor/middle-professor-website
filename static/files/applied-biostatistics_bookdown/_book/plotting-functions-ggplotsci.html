<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 19 Plotting functions (#ggplotsci) | Elements of Statistical Modeling for Experimental Biology</title>
  <meta name="description" content="A first course in statistical modeling for experimental biology researchers" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 19 Plotting functions (#ggplotsci) | Elements of Statistical Modeling for Experimental Biology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A first course in statistical modeling for experimental biology researchers" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 19 Plotting functions (#ggplotsci) | Elements of Statistical Modeling for Experimental Biology" />
  
  <meta name="twitter:description" content="A first course in statistical modeling for experimental biology researchers" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"/>
<link rel="next" href="appendix-1-getting-started-with-r.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#math"><i class="fa fa-check"></i><b>0.1</b> Math</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#r-and-programming"><i class="fa fa-check"></i><b>0.2</b> R and programming</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-r-fundamentals.html"><a href="part-i-r-fundamentals.html"><i class="fa fa-check"></i>Part I: R fundamentals</a></li>
<li class="chapter" data-level="1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html"><i class="fa fa-check"></i><b>1</b> Getting Started – R Projects and R Markdown</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-vs-r-studio"><i class="fa fa-check"></i><b>1.1</b> R vs R Studio</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#download-and-install-r-and-r-studio"><i class="fa fa-check"></i><b>1.2</b> Download and install R and R studio</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#install-r-markdown"><i class="fa fa-check"></i><b>1.3</b> Install R Markdown</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#importing-packages"><i class="fa fa-check"></i><b>1.4</b> Importing Packages</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-an-r-studio-project-for-this-textbook"><i class="fa fa-check"></i><b>1.5</b> Create an R Studio Project for this textbook</a><ul>
<li class="chapter" data-level="1.5.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-an-r-markdown-file-for-this-chapter"><i class="fa fa-check"></i><b>1.5.1</b> Create an R Markdown file for this Chapter</a></li>
<li class="chapter" data-level="1.5.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-fake-data-chunk"><i class="fa fa-check"></i><b>1.5.2</b> Create a “fake-data” chunk</a></li>
<li class="chapter" data-level="1.5.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-plot-chunk"><i class="fa fa-check"></i><b>1.5.3</b> Create a “plot” chunk</a></li>
<li class="chapter" data-level="1.5.4" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#knit"><i class="fa fa-check"></i><b>1.5.4</b> Knit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-a-worked-example.html"><a href="part-ii-a-worked-example.html"><i class="fa fa-check"></i>Part II: A Worked Example</a></li>
<li class="chapter" data-level="2" data-path="analyzing-experimental-data-with-a-linear-model.html"><a href="analyzing-experimental-data-with-a-linear-model.html"><i class="fa fa-check"></i><b>2</b> Analyzing experimental data with a linear model</a><ul>
<li class="chapter" data-level="2.1" data-path="analyzing-experimental-data-with-a-linear-model.html"><a href="analyzing-experimental-data-with-a-linear-model.html#this-text-is-about-the-estimation-of-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect"><i class="fa fa-check"></i><b>2.1</b> This text is about the estimation of treatment effects and the uncertainty in our estimates. This, raises the question, what is “an effect”?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="background-physiology-to-the-experiments-in-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="background-physiology-to-the-experiments-in-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><i class="fa fa-check"></i>Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li class="chapter" data-level="" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><i class="fa fa-check"></i>Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a><ul>
<li class="chapter" data-level="2.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#useful-functions"><i class="fa fa-check"></i><b>2.2</b> useful functions</a></li>
<li class="chapter" data-level="2.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2b-effect-of-ask1-ko-on-growth-body-weight"><i class="fa fa-check"></i><b>2.3</b> figure 2b – effect of ASK1 KO on growth (body weight)</a><ul>
<li class="chapter" data-level="2.3.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2b-import"><i class="fa fa-check"></i><b>2.3.1</b> figure 2b – import</a></li>
<li class="chapter" data-level="2.3.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2b-exploratory-plots"><i class="fa fa-check"></i><b>2.3.2</b> figure 2b – exploratory plots</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-effect-of-ask1-ko-on-final-body-weight"><i class="fa fa-check"></i><b>2.4</b> Figure 2c – Effect of ASK1 KO on final body weight</a><ul>
<li class="chapter" data-level="2.4.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-import"><i class="fa fa-check"></i><b>2.4.1</b> Figure 2c – import</a></li>
<li class="chapter" data-level="2.4.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-check-own-computation-of-weight-change-v-imported-value"><i class="fa fa-check"></i><b>2.4.2</b> Figure 2c – check own computation of weight change v imported value</a></li>
<li class="chapter" data-level="2.4.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-exploratory-plots"><i class="fa fa-check"></i><b>2.4.3</b> Figure 2c – exploratory plots</a></li>
<li class="chapter" data-level="2.4.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-fit-the-model-m1-lm"><i class="fa fa-check"></i><b>2.4.4</b> Figure 2c – fit the model: m1 (lm)</a></li>
<li class="chapter" data-level="2.4.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-check-the-model-m1"><i class="fa fa-check"></i><b>2.4.5</b> Figure 2c – check the model: m1</a></li>
<li class="chapter" data-level="2.4.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-fit-the-model-m2-gamma-glm"><i class="fa fa-check"></i><b>2.4.6</b> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li class="chapter" data-level="2.4.7" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-check-the-model-m2"><i class="fa fa-check"></i><b>2.4.7</b> Figure 2c – check the model, m2</a></li>
<li class="chapter" data-level="2.4.8" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-inference-from-the-model"><i class="fa fa-check"></i><b>2.4.8</b> Figure 2c – inference from the model</a></li>
<li class="chapter" data-level="2.4.9" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-plot-the-model"><i class="fa fa-check"></i><b>2.4.9</b> Figure 2c – plot the model</a></li>
<li class="chapter" data-level="2.4.10" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-report"><i class="fa fa-check"></i><b>2.4.10</b> Figure 2c – report</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><i class="fa fa-check"></i><b>2.5</b> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a><ul>
<li class="chapter" data-level="2.5.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-import"><i class="fa fa-check"></i><b>2.5.1</b> Figure 2d – Import</a></li>
<li class="chapter" data-level="2.5.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-exploratory-plots"><i class="fa fa-check"></i><b>2.5.2</b> Figure 2d – exploratory plots</a></li>
<li class="chapter" data-level="2.5.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-fit-the-model"><i class="fa fa-check"></i><b>2.5.3</b> Figure 2d – fit the model</a></li>
<li class="chapter" data-level="2.5.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-check-the-model"><i class="fa fa-check"></i><b>2.5.4</b> Figure 2d – check the model</a></li>
<li class="chapter" data-level="2.5.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-inference"><i class="fa fa-check"></i><b>2.5.5</b> Figure 2d – inference</a></li>
<li class="chapter" data-level="2.5.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-plot-the-model"><i class="fa fa-check"></i><b>2.5.6</b> Figure 2d – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-effect-of-ask1-ko-on-glucose-tolerance-summary-measure"><i class="fa fa-check"></i><b>2.6</b> Figure 2e – Effect of ASK1 KO on glucose tolerance (summary measure)</a><ul>
<li class="chapter" data-level="2.6.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-message-the-data"><i class="fa fa-check"></i><b>2.6.1</b> Figure 2e – message the data</a></li>
<li class="chapter" data-level="2.6.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-exploratory-plots"><i class="fa fa-check"></i><b>2.6.2</b> Figure 2e – exploratory plots</a></li>
<li class="chapter" data-level="2.6.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-fit-the-model"><i class="fa fa-check"></i><b>2.6.3</b> Figure 2e – fit the model</a></li>
<li class="chapter" data-level="2.6.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-check-the-model"><i class="fa fa-check"></i><b>2.6.4</b> Figure 2e – check the model</a></li>
<li class="chapter" data-level="2.6.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-inference-from-the-model"><i class="fa fa-check"></i><b>2.6.5</b> Figure 2e – inference from the model</a></li>
<li class="chapter" data-level="2.6.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-plot-the-model"><i class="fa fa-check"></i><b>2.6.6</b> Figure 2e – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-effect-of-ask1-on-glucose-infusion-rate"><i class="fa fa-check"></i><b>2.7</b> Figure 2f – Effect of ASK1 on glucose infusion rate</a><ul>
<li class="chapter" data-level="2.7.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-import"><i class="fa fa-check"></i><b>2.7.1</b> Figure 2f – import</a></li>
<li class="chapter" data-level="2.7.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-exploratory-plots"><i class="fa fa-check"></i><b>2.7.2</b> Figure 2f – exploratory plots</a></li>
<li class="chapter" data-level="2.7.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-fit-the-model"><i class="fa fa-check"></i><b>2.7.3</b> Figure 2f – fit the model</a></li>
<li class="chapter" data-level="2.7.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-check-the-model"><i class="fa fa-check"></i><b>2.7.4</b> Figure 2f – check the model</a></li>
<li class="chapter" data-level="2.7.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-inference"><i class="fa fa-check"></i><b>2.7.5</b> Figure 2f – inference</a></li>
<li class="chapter" data-level="2.7.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-plot-the-model"><i class="fa fa-check"></i><b>2.7.6</b> Figure 2f – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g"><i class="fa fa-check"></i><b>2.8</b> Figure 2g</a><ul>
<li class="chapter" data-level="2.8.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-import"><i class="fa fa-check"></i><b>2.8.1</b> Figure 2g – import</a></li>
<li class="chapter" data-level="2.8.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-exploratory-plots"><i class="fa fa-check"></i><b>2.8.2</b> Figure 2g – exploratory plots</a></li>
<li class="chapter" data-level="2.8.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-fit-the-model"><i class="fa fa-check"></i><b>2.8.3</b> Figure 2g – fit the model</a></li>
<li class="chapter" data-level="2.8.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-check-the-model"><i class="fa fa-check"></i><b>2.8.4</b> Figure 2g – check the model</a></li>
<li class="chapter" data-level="2.8.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-inference"><i class="fa fa-check"></i><b>2.8.5</b> Figure 2g – inference</a></li>
<li class="chapter" data-level="2.8.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-plot-the-model"><i class="fa fa-check"></i><b>2.8.6</b> Figure 2g – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2h"><i class="fa fa-check"></i><b>2.9</b> Figure 2h</a></li>
<li class="chapter" data-level="2.10" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i"><i class="fa fa-check"></i><b>2.10</b> Figure 2i</a></li>
<li class="chapter" data-level="2.11" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2j"><i class="fa fa-check"></i><b>2.11</b> Figure 2j</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-r-fundamentals.html"><a href="part-iii-r-fundamentals.html"><i class="fa fa-check"></i>Part III: R fundamentals</a></li>
<li class="chapter" data-level="3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html"><i class="fa fa-check"></i><b>3</b> Data – Reading, Wrangling, and Writing</a><ul>
<li class="chapter" data-level="3.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#learning-from-this-chapter"><i class="fa fa-check"></i><b>3.1</b> Learning from this chapter</a></li>
<li class="chapter" data-level="3.2" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#data-working-in-r"><i class="fa fa-check"></i><b>3.2</b> Working in R</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#importing-data"><i class="fa fa-check"></i><b>3.2.1</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#data-wrangling"><i class="fa fa-check"></i><b>3.3</b> Data wrangling</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#reshaping-data-wide-to-long"><i class="fa fa-check"></i><b>3.3.1</b> Reshaping data – Wide to long</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#reshaping-data-transpose-turning-the-columns-into-rows"><i class="fa fa-check"></i><b>3.3.2</b> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#combining-data"><i class="fa fa-check"></i><b>3.3.3</b> Combining data</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#subsetting-data"><i class="fa fa-check"></i><b>3.3.4</b> Subsetting data</a></li>
<li class="chapter" data-level="3.3.5" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#wrangling-columns"><i class="fa fa-check"></i><b>3.3.5</b> Wrangling columns</a></li>
<li class="chapter" data-level="3.3.6" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#missing-data"><i class="fa fa-check"></i><b>3.3.6</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#saving-data"><i class="fa fa-check"></i><b>3.4</b> Saving data</a></li>
<li class="chapter" data-level="3.5" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#exercises"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting-models.html"><a href="plotting-models.html"><i class="fa fa-check"></i><b>4</b> Plotting Models</a><ul>
<li class="chapter" data-level="4.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data"><i class="fa fa-check"></i><b>4.1</b> Pretty good plots show the model and the data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot"><i class="fa fa-check"></i><b>4.1.1</b> Pretty good plot component 1: Modeled effects plot</a></li>
<li class="chapter" data-level="4.1.2" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot"><i class="fa fa-check"></i><b>4.1.2</b> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li class="chapter" data-level="4.1.3" data-path="plotting-models.html"><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><i class="fa fa-check"></i><b>4.1.3</b> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="plotting-models.html"><a href="plotting-models.html#some-comments-on-plot-components"><i class="fa fa-check"></i><b>4.2</b> Some comments on plot components</a></li>
<li class="chapter" data-level="4.3" data-path="plotting-models.html"><a href="plotting-models.html#working-in-r"><i class="fa fa-check"></i><b>4.3</b> Working in R</a><ul>
<li class="chapter" data-level="4.3.1" data-path="plotting-models.html"><a href="plotting-models.html#unpooled-se-bars-and-confidence-intervals"><i class="fa fa-check"></i><b>4.3.1</b> Unpooled SE bars and confidence intervals</a></li>
<li class="chapter" data-level="4.3.2" data-path="plotting-models.html"><a href="plotting-models.html#adding-bootstrap-intervals"><i class="fa fa-check"></i><b>4.3.2</b> Adding bootstrap intervals</a></li>
<li class="chapter" data-level="4.3.3" data-path="plotting-models.html"><a href="plotting-models.html#adding-modeled-means-and-error-intervals"><i class="fa fa-check"></i><b>4.3.3</b> Adding modeled means and error intervals</a></li>
<li class="chapter" data-level="4.3.4" data-path="plotting-models.html"><a href="plotting-models.html#adding-p-values"><i class="fa fa-check"></i><b>4.3.4</b> Adding p-values</a></li>
<li class="chapter" data-level="4.3.5" data-path="plotting-models.html"><a href="plotting-models.html#adding-custom-p-values"><i class="fa fa-check"></i><b>4.3.5</b> Adding custom p-values</a></li>
<li class="chapter" data-level="4.3.6" data-path="plotting-models.html"><a href="plotting-models.html#plotting-two-factors"><i class="fa fa-check"></i><b>4.3.6</b> Plotting two factors</a></li>
<li class="chapter" data-level="4.3.7" data-path="plotting-models.html"><a href="plotting-models.html#interaction-plot"><i class="fa fa-check"></i><b>4.3.7</b> Interaction plot</a></li>
<li class="chapter" data-level="4.3.8" data-path="plotting-models.html"><a href="plotting-models.html#plot-components"><i class="fa fa-check"></i><b>4.3.8</b> Plot components</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iv-some-fundamentals-of-statistical-modeling.html"><a href="part-iv-some-fundamentals-of-statistical-modeling.html"><i class="fa fa-check"></i>Part IV: Some Fundamentals of Statistical Modeling</a></li>
<li class="chapter" data-level="5" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><i class="fa fa-check"></i><b>5</b> Variability and Uncertainty (Standard Deviations, Standard Errors, Confidence Intervals)</a><ul>
<li class="chapter" data-level="5.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#the-sample-standard-deviation-vs.-the-standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.1</b> The sample standard deviation vs. the standard error of the mean</a><ul>
<li class="chapter" data-level="5.1.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#sample-standard-deviation"><i class="fa fa-check"></i><b>5.1.1</b> Sample standard deviation</a></li>
<li class="chapter" data-level="5.1.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.2</b> Using Google Sheets to generate fake data to explore the standard error</a><ul>
<li class="chapter" data-level="5.2.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#steps"><i class="fa fa-check"></i><b>5.2.1</b> Steps</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#using-r-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.3</b> Using R to generate fake data to explore the standard error</a><ul>
<li class="chapter" data-level="5.3.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-i"><i class="fa fa-check"></i><b>5.3.1</b> part I</a></li>
<li class="chapter" data-level="5.3.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-ii---means"><i class="fa fa-check"></i><b>5.3.2</b> part II - means</a></li>
<li class="chapter" data-level="5.3.3" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-iii---how-do-sd-and-se-change-as-sample-size-n-increases"><i class="fa fa-check"></i><b>5.3.3</b> part III - how do SD and SE change as sample size (n) increases?</a></li>
<li class="chapter" data-level="5.3.4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#part-iv-generating-fake-data-with-for-loops"><i class="fa fa-check"></i><b>5.3.4</b> Part IV – Generating fake data with for-loops</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#bootstrap"><i class="fa fa-check"></i><b>5.4</b> Bootstrapped standard errors</a><ul>
<li class="chapter" data-level="5.4.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#an-example-of-bootstrapped-standard-errors-using-vole-data"><i class="fa fa-check"></i><b>5.4.1</b> An example of bootstrapped standard errors using vole data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#confidence-interval"><i class="fa fa-check"></i><b>5.5</b> Confidence Interval</a><ul>
<li class="chapter" data-level="5.5.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals.html#interpretation-of-a-confidence-interval"><i class="fa fa-check"></i><b>5.5.1</b> Interpretation of a confidence interval</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-introduction-to-linear-models.html"><a href="part-v-introduction-to-linear-models.html"><i class="fa fa-check"></i>Part V: Introduction to Linear Models</a></li>
<li class="chapter" data-level="6" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html"><i class="fa fa-check"></i><b>6</b> An Introduction to Statistical Modeling</a><ul>
<li class="chapter" data-level="6.1" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#this-text-is-about-the-estimation-of-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect-1"><i class="fa fa-check"></i><b>6.1</b> This text is about the estimation of treatment effects and the uncertainty in our estimates. This, raises the question, what is “an effect”?</a></li>
<li class="chapter" data-level="6.2" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#an-introduction-to-linear-models"><i class="fa fa-check"></i><b>6.2</b> An introduction to linear models</a></li>
<li class="chapter" data-level="6.3" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#two-specifications-of-a-linear-model"><i class="fa fa-check"></i><b>6.3</b> Two specifications of a linear model</a><ul>
<li class="chapter" data-level="6.3.1" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#the-error-draw-specification"><i class="fa fa-check"></i><b>6.3.1</b> The “error draw” specification</a></li>
<li class="chapter" data-level="6.3.2" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#the-conditional-draw-specification"><i class="fa fa-check"></i><b>6.3.2</b> The “conditional draw” specification</a></li>
<li class="chapter" data-level="6.3.3" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#comparing-the-two-ways-of-specifying-the-linear-model"><i class="fa fa-check"></i><b>6.3.3</b> Comparing the two ways of specifying the linear model</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#statistical-models-are-used-for-prediction-explanation-and-description"><i class="fa fa-check"></i><b>6.4</b> Statistical models are used for prediction, explanation, and description</a></li>
<li class="chapter" data-level="6.5" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#what-do-we-call-the-x-and-y-variables"><i class="fa fa-check"></i><b>6.5</b> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li class="chapter" data-level="6.6" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#modeling-strategy"><i class="fa fa-check"></i><b>6.6</b> Modeling strategy</a></li>
<li class="chapter" data-level="6.7" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#fitting-the-model"><i class="fa fa-check"></i><b>6.7</b> Fitting the model</a></li>
<li class="chapter" data-level="6.8" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#models-fit-to-data-in-which-the-x-are-treatment-variables-are-regression-models"><i class="fa fa-check"></i><b>6.8</b> Models fit to data in which the <span class="math inline">\(X\)</span> are treatment variables are regression models</a></li>
<li class="chapter" data-level="6.9" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#assumptions-for-inference-with-a-statistical-model"><i class="fa fa-check"></i><b>6.9</b> Assumptions for inference with a statistical model</a></li>
<li class="chapter" data-level="6.10" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#specific-assumptions-for-inference-with-a-linear-model"><i class="fa fa-check"></i><b>6.10</b> Specific assumptions for inference with a linear model</a></li>
<li class="chapter" data-level="6.11" data-path="an-introduction-to-statistical-modeling.html"><a href="an-introduction-to-statistical-modeling.html#linear-modelregression-model-orstatistical-model"><i class="fa fa-check"></i><b>6.11</b> “linear model,”regression model“, or”statistical model"?</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html"><i class="fa fa-check"></i><b>7</b> Models with a single, continuous <em>X</em></a><ul>
<li class="chapter" data-level="7.1" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><i class="fa fa-check"></i><b>7.1</b> A linear model with a single, continuous <em>X</em> is classical “regression”</a><ul>
<li class="chapter" data-level="7.1.1" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#analysis-of-green-down-data"><i class="fa fa-check"></i><b>7.1.1</b> Analysis of “green-down” data</a></li>
<li class="chapter" data-level="7.1.2" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#learning-from-the-green-down-example"><i class="fa fa-check"></i><b>7.1.2</b> Learning from the green-down example</a></li>
<li class="chapter" data-level="7.1.3" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#what-a-regression-coefficient-means"><i class="fa fa-check"></i><b>7.1.3</b> What a regression coefficient means</a></li>
<li class="chapter" data-level="7.1.4" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#using-the-linear-model-for-prediction-prediction-models"><i class="fa fa-check"></i><b>7.1.4</b> Using the linear model for prediction – prediction models</a></li>
<li class="chapter" data-level="7.1.5" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#using-a-linear-model-for-explanation-causal-models"><i class="fa fa-check"></i><b>7.1.5</b> Using a linear model for “explanation” – causal models</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#working-in-r-1"><i class="fa fa-check"></i><b>7.2</b> Working in R</a><ul>
<li class="chapter" data-level="7.2.1" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#fitting-the-linear-model"><i class="fa fa-check"></i><b>7.2.1</b> Fitting the linear model</a></li>
<li class="chapter" data-level="7.2.2" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#getting-to-know-the-linear-model-the-summary-function"><i class="fa fa-check"></i><b>7.2.2</b> Getting to know the linear model: the <code>summary</code> function</a></li>
<li class="chapter" data-level="7.2.3" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#inference-the-coefficient-table-and-confidence-intervals"><i class="fa fa-check"></i><b>7.2.3</b> Inference – the coefficient table and Confidence intervals</a></li>
<li class="chapter" data-level="7.2.4" data-path="models-with-a-single-continuous-x.html"><a href="models-with-a-single-continuous-x.html#how-good-is-our-model"><i class="fa fa-check"></i><b>7.2.4</b> How good is our model?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html"><i class="fa fa-check"></i><b>8</b> A linear model with a single, categorical <em>X</em></a><ul>
<li class="chapter" data-level="8.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#a-linear-model-with-a-single-categorical-x-estimates-the-effects-of-x-on-the-response."><i class="fa fa-check"></i><b>8.1</b> A linear model with a single, categorical <em>X</em> estimates the effects of <em>X</em> on the response.</a><ul>
<li class="chapter" data-level="8.1.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#table-of-model-coefficients"><i class="fa fa-check"></i><b>8.1.1</b> Table of model coefficients</a></li>
<li class="chapter" data-level="8.1.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#the-linear-model"><i class="fa fa-check"></i><b>8.1.2</b> The linear model</a></li>
<li class="chapter" data-level="8.1.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#reporting-results"><i class="fa fa-check"></i><b>8.1.3</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#comparing-the-results-of-a-linear-model-to-classical-hypothesis-tests"><i class="fa fa-check"></i><b>8.2</b> Comparing the results of a linear model to classical hypothesis tests</a><ul>
<li class="chapter" data-level="8.2.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#t-tests-are-special-cases-of-a-linear-model"><i class="fa fa-check"></i><b>8.2.1</b> t-tests are special cases of a linear model</a></li>
<li class="chapter" data-level="8.2.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#anova-is-a-special-case-of-a-linear-model"><i class="fa fa-check"></i><b>8.2.2</b> ANOVA is a special case of a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#working-in-r-2"><i class="fa fa-check"></i><b>8.3</b> Working in R</a><ul>
<li class="chapter" data-level="8.3.1" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#fitting-the-model-1"><i class="fa fa-check"></i><b>8.3.1</b> Fitting the model</a></li>
<li class="chapter" data-level="8.3.2" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#changing-the-reference-level"><i class="fa fa-check"></i><b>8.3.2</b> Changing the reference level</a></li>
<li class="chapter" data-level="8.3.3" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#an-introduction-to-contrasts"><i class="fa fa-check"></i><b>8.3.3</b> An introduction to contrasts</a></li>
<li class="chapter" data-level="8.3.4" data-path="a-linear-model-with-a-single-categorical-x.html"><a href="a-linear-model-with-a-single-categorical-x.html#harrell-plot"><i class="fa fa-check"></i><b>8.3.4</b> Harrell plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>9</b> Model Checking</a><ul>
<li class="chapter" data-level="9.1" data-path="model-checking.html"><a href="model-checking.html#do-coefficients-make-numeric-sense"><i class="fa fa-check"></i><b>9.1</b> Do coefficients make numeric sense?</a></li>
<li class="chapter" data-level="9.2" data-path="model-checking.html"><a href="model-checking.html#all-statistical-analyses-should-be-followed-by-model-checking"><i class="fa fa-check"></i><b>9.2</b> All statistical analyses should be followed by model checking</a></li>
<li class="chapter" data-level="9.3" data-path="model-checking.html"><a href="model-checking.html#linear-model-assumptions"><i class="fa fa-check"></i><b>9.3</b> Linear model assumptions</a></li>
<li class="chapter" data-level="9.4" data-path="model-checking.html"><a href="model-checking.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>9.4</b> Diagnostic plots use the residuals from the model fit</a><ul>
<li class="chapter" data-level="9.4.1" data-path="model-checking.html"><a href="model-checking.html#residuals"><i class="fa fa-check"></i><b>9.4.1</b> Residuals</a></li>
<li class="chapter" data-level="9.4.2" data-path="model-checking.html"><a href="model-checking.html#a-normal-q-q-plot-is-used-to-check-normality"><i class="fa fa-check"></i><b>9.4.2</b> A Normal Q-Q plot is used to check normality</a></li>
<li class="chapter" data-level="9.4.3" data-path="model-checking.html"><a href="model-checking.html#outliers---an-outlier-is-a-point-that-is-highly-unexpected-given-the-modeled-distribution."><i class="fa fa-check"></i><b>9.4.3</b> Outliers - an outlier is a point that is highly unexpected given the modeled distribution.</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="model-checking.html"><a href="model-checking.html#model-checking-homoskedasticity"><i class="fa fa-check"></i><b>9.5</b> Model checking homoskedasticity</a></li>
<li class="chapter" data-level="9.6" data-path="model-checking.html"><a href="model-checking.html#model-checking-independence---hapiness-adverse-example."><i class="fa fa-check"></i><b>9.6</b> Model checking independence - hapiness adverse example.</a></li>
<li class="chapter" data-level="9.7" data-path="model-checking.html"><a href="model-checking.html#using-r"><i class="fa fa-check"></i><b>9.7</b> Using R</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html"><i class="fa fa-check"></i><b>10</b> Model Fitting and Model Fit (OLS)</a><ul>
<li class="chapter" data-level="10.1" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#least-squares-estimation-and-the-decomposition-of-variance"><i class="fa fa-check"></i><b>10.1</b> Least Squares Estimation and the Decomposition of Variance</a></li>
<li class="chapter" data-level="10.2" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#ols-regression"><i class="fa fa-check"></i><b>10.2</b> OLS regression</a></li>
<li class="chapter" data-level="10.3" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#how-well-does-the-model-fit-the-data-r2-and-variance-explained"><i class="fa fa-check"></i><b>10.3</b> How well does the model fit the data? <span class="math inline">\(R^2\)</span> and “variance explained”</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html"><i class="fa fa-check"></i><b>11</b> Best Practices – Issues in Inference</a><ul>
<li class="chapter" data-level="11.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#power"><i class="fa fa-check"></i><b>11.1</b> Power</a><ul>
<li class="chapter" data-level="11.1.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#types-of-error"><i class="fa fa-check"></i><b>11.1.1</b> “Types” of Error</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#multiple-testing"><i class="fa fa-check"></i><b>11.2</b> multiple testing</a><ul>
<li class="chapter" data-level="11.2.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#some-background"><i class="fa fa-check"></i><b>11.2.1</b> Some background</a></li>
<li class="chapter" data-level="11.2.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#multiple-testing-working-in-r"><i class="fa fa-check"></i><b>11.2.2</b> Multiple testing – working in R</a></li>
<li class="chapter" data-level="11.2.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#false-discovery-rate"><i class="fa fa-check"></i><b>11.2.3</b> False Discovery Rate</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#difference-in-p-is-not-different"><i class="fa fa-check"></i><b>11.3</b> difference in p is not different</a></li>
<li class="chapter" data-level="11.4" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#inference-when-data-are-not-normal"><i class="fa fa-check"></i><b>11.4</b> Inference when data are not Normal</a><ul>
<li class="chapter" data-level="11.4.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#working-in-r-3"><i class="fa fa-check"></i><b>11.4.1</b> Working in R</a></li>
<li class="chapter" data-level="11.4.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>11.4.2</b> Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="11.4.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#permutation-test"><i class="fa fa-check"></i><b>11.4.3</b> Permutation test</a></li>
<li class="chapter" data-level="11.4.4" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#non-parametric-tests"><i class="fa fa-check"></i><b>11.4.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="11.4.5" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#log-transformations"><i class="fa fa-check"></i><b>11.4.5</b> Log transformations</a></li>
<li class="chapter" data-level="11.4.6" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#performance-of-parametric-tests-and-alternatives"><i class="fa fa-check"></i><b>11.4.6</b> Performance of parametric tests and alternatives</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#max-vs.-mean"><i class="fa fa-check"></i><b>11.5</b> max vs. mean</a></li>
<li class="chapter" data-level="11.6" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#pre-post-normalization"><i class="fa fa-check"></i><b>11.6</b> pre-post, normalization</a></li>
</ul></li>
<li><a href="part-vi-more-than-one-x-multivariable-models.html#part-vi-more-than-one-x-multivariable-models">Part VI: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li class="chapter" data-level="12" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html"><i class="fa fa-check"></i><b>12</b> Adding covariates to a linear model</a><ul>
<li class="chapter" data-level="12.1" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><i class="fa fa-check"></i><b>12.1</b> Adding covariates can increases the precision of the effect of interest</a></li>
<li class="chapter" data-level="12.2" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-covariates-can-decrease-prediction-error-in-predictive-models"><i class="fa fa-check"></i><b>12.2</b> Adding covariates can decrease prediction error in predictive models</a></li>
<li class="chapter" data-level="12.3" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#adding-covariates-can-reduce-bias-due-to-confounding-in-explanatory-models"><i class="fa fa-check"></i><b>12.3</b> Adding covariates can reduce bias due to confounding in explanatory models</a></li>
<li class="chapter" data-level="12.4" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#best-practices-1-a-pre-treatment-measure-of-the-response-should-be-a-covariate-and-not-subtracted-from-the-post-treatment-measure-regression-to-the-mean"><i class="fa fa-check"></i><b>12.4</b> Best practices 1: A pre-treatment measure of the response should be a covariate and not subtracted from the post-treatment measure (regression to the mean)</a><ul>
<li class="chapter" data-level="12.4.1" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#regression-to-the-mean-in-words"><i class="fa fa-check"></i><b>12.4.1</b> Regression to the mean in words</a></li>
<li class="chapter" data-level="12.4.2" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#regression-to-the-mean-in-pictures"><i class="fa fa-check"></i><b>12.4.2</b> Regression to the mean in pictures</a></li>
<li class="chapter" data-level="12.4.3" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#do-not-use-percent-change-believing-that-percents-account-for-effects-of-initial-weights"><i class="fa fa-check"></i><b>12.4.3</b> Do not use percent change, believing that percents account for effects of initial weights</a></li>
<li class="chapter" data-level="12.4.4" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#do-not-test-for-balance-of-baseline-measures"><i class="fa fa-check"></i><b>12.4.4</b> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="adding-covariates-to-a-linear-model.html"><a href="adding-covariates-to-a-linear-model.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><i class="fa fa-check"></i><b>12.5</b> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html"><i class="fa fa-check"></i><b>13</b> Two (or more) Categorical <span class="math inline">\(X\)</span> – Factorial designs</a><ul>
<li class="chapter" data-level="13.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#factorial-experiments"><i class="fa fa-check"></i><b>13.1</b> Factorial experiments</a><ul>
<li class="chapter" data-level="13.1.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#model-coefficients-an-interaction-effect-is-what-is-leftover-after-adding-the-treatment-effects-to-the-control"><i class="fa fa-check"></i><b>13.1.1</b> Model coefficients: an interaction effect is what is leftover after adding the treatment effects to the control</a></li>
<li class="chapter" data-level="13.1.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#what-is-the-biological-meaning-of-an-interaction-effect"><i class="fa fa-check"></i><b>13.1.2</b> What is the biological meaning of an interaction effect?</a></li>
<li class="chapter" data-level="13.1.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#the-interpretation-of-the-coefficients-in-a-factorial-model-is-entirely-dependent-on-the-reference"><i class="fa fa-check"></i><b>13.1.3</b> The interpretation of the coefficients in a factorial model is entirely dependent on the reference…</a></li>
<li class="chapter" data-level="13.1.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#estimated-marginal-means"><i class="fa fa-check"></i><b>13.1.4</b> Estimated marginal means</a></li>
<li class="chapter" data-level="13.1.5" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#in-a-factorial-model-there-are-multiple-effects-of-each-factor-simple-effects"><i class="fa fa-check"></i><b>13.1.5</b> In a factorial model, there are multiple effects of each factor (simple effects)</a></li>
<li class="chapter" data-level="13.1.6" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#marginal-effects"><i class="fa fa-check"></i><b>13.1.6</b> Marginal effects</a></li>
<li class="chapter" data-level="13.1.7" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#the-additive-model"><i class="fa fa-check"></i><b>13.1.7</b> The additive model</a></li>
<li class="chapter" data-level="13.1.8" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#reduce-models-for-the-right-reason"><i class="fa fa-check"></i><b>13.1.8</b> Reduce models for the right reason</a></li>
<li class="chapter" data-level="13.1.9" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#what-about-models-with-more-than-two-factors"><i class="fa fa-check"></i><b>13.1.9</b> What about models with more than two factors?</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#reporting-results-1"><i class="fa fa-check"></i><b>13.2</b> Reporting results</a><ul>
<li class="chapter" data-level="13.2.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#text-results"><i class="fa fa-check"></i><b>13.2.1</b> Text results</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#working-in-r-4"><i class="fa fa-check"></i><b>13.3</b> Working in R</a><ul>
<li class="chapter" data-level="13.3.1" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#model-formula"><i class="fa fa-check"></i><b>13.3.1</b> Model formula</a></li>
<li class="chapter" data-level="13.3.2" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#modeled-means"><i class="fa fa-check"></i><b>13.3.2</b> Modeled means</a></li>
<li class="chapter" data-level="13.3.3" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#marginal-means"><i class="fa fa-check"></i><b>13.3.3</b> Marginal means</a></li>
<li class="chapter" data-level="13.3.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#contrasts"><i class="fa fa-check"></i><b>13.3.4</b> Contrasts</a></li>
<li class="chapter" data-level="13.3.5" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#simple-effects"><i class="fa fa-check"></i><b>13.3.5</b> Simple effects</a></li>
<li class="chapter" data-level="13.3.6" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#marginal-effects-1"><i class="fa fa-check"></i><b>13.3.6</b> Marginal effects</a></li>
<li class="chapter" data-level="13.3.7" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#plotting-results"><i class="fa fa-check"></i><b>13.3.7</b> Plotting results</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="two-or-more-categorical-x-factorial-designs.html"><a href="two-or-more-categorical-x-factorial-designs.html#problems"><i class="fa fa-check"></i><b>13.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="anova-tables.html"><a href="anova-tables.html"><i class="fa fa-check"></i><b>14</b> ANOVA Tables</a><ul>
<li class="chapter" data-level="14.1" data-path="anova-tables.html"><a href="anova-tables.html#summary-of-usage"><i class="fa fa-check"></i><b>14.1</b> Summary of usage</a></li>
<li class="chapter" data-level="14.2" data-path="anova-tables.html"><a href="anova-tables.html#example-a-one-way-anova-using-the-vole-data"><i class="fa fa-check"></i><b>14.2</b> Example: a one-way ANOVA using the vole data</a></li>
<li class="chapter" data-level="14.3" data-path="anova-tables.html"><a href="anova-tables.html#example-a-two-way-anova-using-the-urchin-data"><i class="fa fa-check"></i><b>14.3</b> Example: a two-way ANOVA using the urchin data</a><ul>
<li class="chapter" data-level="14.3.1" data-path="anova-tables.html"><a href="anova-tables.html#how-to-read-an-anova-table"><i class="fa fa-check"></i><b>14.3.1</b> How to read an ANOVA table</a></li>
<li class="chapter" data-level="14.3.2" data-path="anova-tables.html"><a href="anova-tables.html#how-to-read-anova-results-reported-in-the-text"><i class="fa fa-check"></i><b>14.3.2</b> How to read ANOVA results reported in the text</a></li>
<li class="chapter" data-level="14.3.3" data-path="anova-tables.html"><a href="anova-tables.html#better-practice-estimates-and-their-uncertainty"><i class="fa fa-check"></i><b>14.3.3</b> Better practice – estimates and their uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="anova-tables.html"><a href="anova-tables.html#unbalanced-designs"><i class="fa fa-check"></i><b>14.4</b> Unbalanced designs</a><ul>
<li class="chapter" data-level="14.4.1" data-path="anova-tables.html"><a href="anova-tables.html#what-is-going-on-in-unbalanced-anova-type-i-ii-iii-sum-of-squares"><i class="fa fa-check"></i><b>14.4.1</b> What is going on in unbalanced ANOVA? – Type I, II, III sum of squares</a></li>
<li class="chapter" data-level="14.4.2" data-path="anova-tables.html"><a href="anova-tables.html#back-to-interpretation-of-main-effects"><i class="fa fa-check"></i><b>14.4.2</b> Back to interpretation of main effects</a></li>
<li class="chapter" data-level="14.4.3" data-path="anova-tables.html"><a href="anova-tables.html#the-anova-tables-for-type-i-ii-and-iii-sum-of-squares-are-the-same-if-the-design-is-balanced."><i class="fa fa-check"></i><b>14.4.3</b> The anova tables for Type I, II, and III sum of squares are the same if the design is balanced.</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="anova-tables.html"><a href="anova-tables.html#working-in-r-5"><i class="fa fa-check"></i><b>14.5</b> Working in R</a><ul>
<li class="chapter" data-level="14.5.1" data-path="anova-tables.html"><a href="anova-tables.html#type-i-sum-of-squares-in-r"><i class="fa fa-check"></i><b>14.5.1</b> Type I sum of squares in R</a></li>
<li class="chapter" data-level="14.5.2" data-path="anova-tables.html"><a href="anova-tables.html#type-ii-and-iii-sum-of-squares"><i class="fa fa-check"></i><b>14.5.2</b> Type II and III Sum of Squares</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="predictive-models.html"><a href="predictive-models.html"><i class="fa fa-check"></i><b>15</b> Predictive Models</a><ul>
<li class="chapter" data-level="15.1" data-path="predictive-models.html"><a href="predictive-models.html#overfitting"><i class="fa fa-check"></i><b>15.1</b> Overfitting</a></li>
<li class="chapter" data-level="15.2" data-path="predictive-models.html"><a href="predictive-models.html#model-building-vs.-variable-selection-vs.-model-selection"><i class="fa fa-check"></i><b>15.2</b> Model building vs. Variable selection vs. Model selection</a><ul>
<li class="chapter" data-level="15.2.1" data-path="predictive-models.html"><a href="predictive-models.html#stepwise-regression"><i class="fa fa-check"></i><b>15.2.1</b> Stepwise regression</a></li>
<li class="chapter" data-level="15.2.2" data-path="predictive-models.html"><a href="predictive-models.html#cross-validation"><i class="fa fa-check"></i><b>15.2.2</b> Cross-validation</a></li>
<li class="chapter" data-level="15.2.3" data-path="predictive-models.html"><a href="predictive-models.html#penalization"><i class="fa fa-check"></i><b>15.2.3</b> Penalization</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="predictive-models.html"><a href="predictive-models.html#shrinkage"><i class="fa fa-check"></i><b>15.3</b> Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-vii-expanding-the-linear-model.html"><a href="part-vii-expanding-the-linear-model.html"><i class="fa fa-check"></i>Part VII – Expanding the Linear Model</a></li>
<li class="chapter" data-level="16" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html"><i class="fa fa-check"></i><b>16</b> Linear mixed models</a><ul>
<li class="chapter" data-level="16.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#random-effects"><i class="fa fa-check"></i><b>16.1</b> Random effects</a></li>
<li class="chapter" data-level="16.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#random-effects-in-statistical-models"><i class="fa fa-check"></i><b>16.2</b> Random effects in statistical models</a></li>
<li class="chapter" data-level="16.3" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#linear-mixed-models-are-flexible"><i class="fa fa-check"></i><b>16.3</b> Linear mixed models are flexible</a></li>
<li class="chapter" data-level="16.4" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#blocking"><i class="fa fa-check"></i><b>16.4</b> Blocking</a><ul>
<li class="chapter" data-level="16.4.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#visualing-variation-due-to-blocks"><i class="fa fa-check"></i><b>16.4.1</b> Visualing variation due to blocks</a></li>
<li class="chapter" data-level="16.4.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#blocking-increases-precision-of-point-estimates"><i class="fa fa-check"></i><b>16.4.2</b> Blocking increases precision of point estimates</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#pseudoreplication"><i class="fa fa-check"></i><b>16.5</b> Pseudoreplication</a><ul>
<li class="chapter" data-level="16.5.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#visualizing-pseduoreplication"><i class="fa fa-check"></i><b>16.5.1</b> Visualizing pseduoreplication</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#mapping-nhst-to-estimation-a-paired-t-test-is-a-special-case-of-a-linear-mixed-model"><i class="fa fa-check"></i><b>16.6</b> Mapping NHST to estimation: A paired t-test is a special case of a linear mixed model</a></li>
<li class="chapter" data-level="16.7" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#advanced-topic-linear-mixed-models-shrink-coefficients-by-partial-pooling"><i class="fa fa-check"></i><b>16.7</b> Advanced topic – Linear mixed models shrink coefficients by partial pooling</a></li>
<li class="chapter" data-level="16.8" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#working-in-r-6"><i class="fa fa-check"></i><b>16.8</b> Working in R</a><ul>
<li class="chapter" data-level="16.8.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#coral-data"><i class="fa fa-check"></i><b>16.8.1</b> coral data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html"><i class="fa fa-check"></i><b>17</b> Generalized linear models I: Count data</a><ul>
<li class="chapter" data-level="17.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#the-generalized-linear-model"><i class="fa fa-check"></i><b>17.1</b> The generalized linear model</a></li>
<li class="chapter" data-level="17.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish"><i class="fa fa-check"></i><b>17.2</b> Count data example – number of trematode worm larvae in eyes of threespine stickleback fish</a><ul>
<li class="chapter" data-level="17.2.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#modeling-strategy-1"><i class="fa fa-check"></i><b>17.2.1</b> Modeling strategy</a></li>
<li class="chapter" data-level="17.2.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#checking-the-model-i-a-normal-q-q-plot"><i class="fa fa-check"></i><b>17.2.2</b> Checking the model I – a Normal Q-Q plot</a></li>
<li class="chapter" data-level="17.2.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#checking-the-model-ii-scale-location-plot-for-checking-homoskedasticity"><i class="fa fa-check"></i><b>17.2.3</b> Checking the model II – scale-location plot for checking homoskedasticity</a></li>
<li class="chapter" data-level="17.2.4" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#two-distributions-for-count-data-poisson-and-negative-binomial"><i class="fa fa-check"></i><b>17.2.4</b> Two distributions for count data – Poisson and Negative Binomial</a></li>
<li class="chapter" data-level="17.2.5" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-with-a-poisson-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>17.2.5</b> Fitting a GLM with a Poisson distribution to the worm data</a></li>
<li class="chapter" data-level="17.2.6" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#model-checking-fits-to-count-data"><i class="fa fa-check"></i><b>17.2.6</b> Model checking fits to count data</a></li>
<li class="chapter" data-level="17.2.7" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-with-a-negative-binomial-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>17.2.7</b> Fitting a GLM with a Negative Binomial distribution to the worm data</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#working-in-r-7"><i class="fa fa-check"></i><b>17.3</b> Working in R</a><ul>
<li class="chapter" data-level="17.3.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-to-count-data"><i class="fa fa-check"></i><b>17.3.1</b> Fitting a GLM to count data</a></li>
<li class="chapter" data-level="17.3.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-generalized-linear-mixed-model-glmm-to-count-data"><i class="fa fa-check"></i><b>17.3.2</b> Fitting a generalized linear mixed model (GLMM) to count data</a></li>
<li class="chapter" data-level="17.3.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-generalized-linear-model-to-continouus-data"><i class="fa fa-check"></i><b>17.3.3</b> Fitting a generalized linear model to continouus data</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#problems-1"><i class="fa fa-check"></i><b>17.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-models-with-heterogenous-variance.html"><a href="linear-models-with-heterogenous-variance.html"><i class="fa fa-check"></i><b>18</b> Linear models with heterogenous variance</a><ul>
<li class="chapter" data-level="18.1" data-path="linear-models-with-heterogenous-variance.html"><a href="linear-models-with-heterogenous-variance.html#gls"><i class="fa fa-check"></i><b>18.1</b> gls</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"><a href="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"><i class="fa fa-check"></i>Part V: Expanding the Linear Model – Generalized Linear Models and Multilevel (Linear Mixed) Models</a></li>
<li class="chapter" data-level="19" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html"><i class="fa fa-check"></i><b>19</b> Plotting functions (#ggplotsci)</a><ul>
<li class="chapter" data-level="19.1" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#odd-even"><i class="fa fa-check"></i><b>19.1</b> odd-even</a></li>
<li class="chapter" data-level="19.2" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#estimate-response-and-effects-with-emmeans"><i class="fa fa-check"></i><b>19.2</b> estimate response and effects with emmeans</a></li>
<li class="chapter" data-level="19.3" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#emm_table"><i class="fa fa-check"></i><b>19.3</b> emm_table</a></li>
<li class="chapter" data-level="19.4" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#pairs_table"><i class="fa fa-check"></i><b>19.4</b> pairs_table</a></li>
<li class="chapter" data-level="19.5" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#gg_mean_error"><i class="fa fa-check"></i><b>19.5</b> gg_mean_error</a></li>
<li class="chapter" data-level="19.6" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#gg_ancova"><i class="fa fa-check"></i><b>19.6</b> gg_ancova</a></li>
<li class="chapter" data-level="19.7" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#gg_mean_ci_ancova"><i class="fa fa-check"></i><b>19.7</b> gg_mean_ci_ancova</a></li>
<li class="chapter" data-level="19.8" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#gg_effects"><i class="fa fa-check"></i><b>19.8</b> gg_effects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html"><i class="fa fa-check"></i>Appendix 1: Getting Started with R</a><ul>
<li class="chapter" data-level="19.9" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready"><i class="fa fa-check"></i><b>19.9</b> Get your computer ready</a><ul>
<li class="chapter" data-level="19.9.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-here"><i class="fa fa-check"></i><b>19.9.1</b> Start here</a></li>
<li class="chapter" data-level="19.9.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r"><i class="fa fa-check"></i><b>19.9.2</b> Install R</a></li>
<li class="chapter" data-level="19.9.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-studio"><i class="fa fa-check"></i><b>19.9.3</b> Install R Studio</a></li>
<li class="chapter" data-level="19.9.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-markdown-1"><i class="fa fa-check"></i><b>19.9.4</b> Install R Markdown</a></li>
<li class="chapter" data-level="19.9.5" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#optional-alternative-latex-installations"><i class="fa fa-check"></i><b>19.9.5</b> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-learning-r-studio"><i class="fa fa-check"></i><b>19.10</b> Start learning R Studio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><i class="fa fa-check"></i>Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="chapter" data-level="" data-path="appendix-3-fake-data-simulations.html"><a href="appendix-3-fake-data-simulations.html"><i class="fa fa-check"></i>Appendix 3: Fake Data Simulations</a><ul>
<li class="chapter" data-level="19.11" data-path="appendix-3-fake-data-simulations.html"><a href="appendix-3-fake-data-simulations.html#performance-of-blocking-relative-to-a-linear-model"><i class="fa fa-check"></i><b>19.11</b> Performance of Blocking relative to a linear model</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Elements of Statistical Modeling for Experimental Biology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-functions-ggplotsci" class="section level1">
<h1><span class="header-section-number">Chapter 19</span> Plotting functions (#ggplotsci)</h1>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="plotting-functions-ggplotsci.html#cb344-1"></a><span class="co"># palettes</span></span>
<span id="cb344-2"><a href="plotting-functions-ggplotsci.html#cb344-2"></a></span>
<span id="cb344-3"><a href="plotting-functions-ggplotsci.html#cb344-3"></a><span class="co"># http://mkweb.bcgsc.ca/colorblind/palettes.mhtml#page-container</span></span>
<span id="cb344-4"><a href="plotting-functions-ggplotsci.html#cb344-4"></a>pal_nature &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb344-5"><a href="plotting-functions-ggplotsci.html#cb344-5"></a>  <span class="st">&quot;#2271B2&quot;</span>, <span class="co"># honolulu blue</span></span>
<span id="cb344-6"><a href="plotting-functions-ggplotsci.html#cb344-6"></a>  <span class="st">&quot;#3DB7E9&quot;</span>, <span class="co"># summer sky</span></span>
<span id="cb344-7"><a href="plotting-functions-ggplotsci.html#cb344-7"></a>  <span class="st">&quot;#F748A5&quot;</span>, <span class="co"># barbi pink</span></span>
<span id="cb344-8"><a href="plotting-functions-ggplotsci.html#cb344-8"></a>  <span class="st">&quot;#359B73&quot;</span>, <span class="co"># ocean green</span></span>
<span id="cb344-9"><a href="plotting-functions-ggplotsci.html#cb344-9"></a>  <span class="st">&quot;#d55e00&quot;</span>, <span class="co"># bamboo</span></span>
<span id="cb344-10"><a href="plotting-functions-ggplotsci.html#cb344-10"></a>  <span class="st">&quot;#e69f00&quot;</span>, <span class="co"># gamboge, squash, buttercup</span></span>
<span id="cb344-11"><a href="plotting-functions-ggplotsci.html#cb344-11"></a>  <span class="st">&quot;#f0e442&quot;</span> <span class="co"># holiday, </span></span>
<span id="cb344-12"><a href="plotting-functions-ggplotsci.html#cb344-12"></a>)</span>
<span id="cb344-13"><a href="plotting-functions-ggplotsci.html#cb344-13"></a></span>
<span id="cb344-14"><a href="plotting-functions-ggplotsci.html#cb344-14"></a>pal_nature_black &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb344-15"><a href="plotting-functions-ggplotsci.html#cb344-15"></a>  <span class="st">&quot;#000000&quot;</span>, <span class="co"># black</span></span>
<span id="cb344-16"><a href="plotting-functions-ggplotsci.html#cb344-16"></a>  <span class="st">&quot;#2271B2&quot;</span>, <span class="co"># honolulu blue</span></span>
<span id="cb344-17"><a href="plotting-functions-ggplotsci.html#cb344-17"></a>  <span class="st">&quot;#3DB7E9&quot;</span>, <span class="co"># summer sky</span></span>
<span id="cb344-18"><a href="plotting-functions-ggplotsci.html#cb344-18"></a>  <span class="st">&quot;#F748A5&quot;</span>, <span class="co"># barbi pink</span></span>
<span id="cb344-19"><a href="plotting-functions-ggplotsci.html#cb344-19"></a>  <span class="st">&quot;#359B73&quot;</span>, <span class="co"># ocean green</span></span>
<span id="cb344-20"><a href="plotting-functions-ggplotsci.html#cb344-20"></a>  <span class="st">&quot;#d55e00&quot;</span>, <span class="co"># bamboo</span></span>
<span id="cb344-21"><a href="plotting-functions-ggplotsci.html#cb344-21"></a>  <span class="st">&quot;#e69f00&quot;</span>, <span class="co"># gamboge, squash, buttercup</span></span>
<span id="cb344-22"><a href="plotting-functions-ggplotsci.html#cb344-22"></a>  <span class="st">&quot;#f0e442&quot;</span> <span class="co"># holiday, </span></span>
<span id="cb344-23"><a href="plotting-functions-ggplotsci.html#cb344-23"></a>)</span>
<span id="cb344-24"><a href="plotting-functions-ggplotsci.html#cb344-24"></a></span>
<span id="cb344-25"><a href="plotting-functions-ggplotsci.html#cb344-25"></a>pal_nature_black_mod &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb344-26"><a href="plotting-functions-ggplotsci.html#cb344-26"></a>  <span class="st">&quot;#000000&quot;</span>, <span class="co"># black</span></span>
<span id="cb344-27"><a href="plotting-functions-ggplotsci.html#cb344-27"></a>  <span class="st">&quot;#3DB7E9&quot;</span>, <span class="co"># summer sky</span></span>
<span id="cb344-28"><a href="plotting-functions-ggplotsci.html#cb344-28"></a>  <span class="st">&quot;#e69f00&quot;</span>, <span class="co"># gamboge, squash, buttercup</span></span>
<span id="cb344-29"><a href="plotting-functions-ggplotsci.html#cb344-29"></a>  <span class="st">&quot;#359B73&quot;</span>, <span class="co"># ocean green</span></span>
<span id="cb344-30"><a href="plotting-functions-ggplotsci.html#cb344-30"></a>  <span class="st">&quot;#2271B2&quot;</span>, <span class="co"># honolulu blue</span></span>
<span id="cb344-31"><a href="plotting-functions-ggplotsci.html#cb344-31"></a>  <span class="st">&quot;#f0e442&quot;</span>, <span class="co"># holiday, </span></span>
<span id="cb344-32"><a href="plotting-functions-ggplotsci.html#cb344-32"></a>  <span class="st">&quot;#F748A5&quot;</span>, <span class="co"># barbi pink</span></span>
<span id="cb344-33"><a href="plotting-functions-ggplotsci.html#cb344-33"></a>  <span class="st">&quot;#d55e00&quot;</span> <span class="co"># bamboo</span></span>
<span id="cb344-34"><a href="plotting-functions-ggplotsci.html#cb344-34"></a>)</span>
<span id="cb344-35"><a href="plotting-functions-ggplotsci.html#cb344-35"></a></span>
<span id="cb344-36"><a href="plotting-functions-ggplotsci.html#cb344-36"></a>pal_nature_mod &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb344-37"><a href="plotting-functions-ggplotsci.html#cb344-37"></a>  <span class="st">&quot;#3DB7E9&quot;</span>, <span class="co"># summer sky</span></span>
<span id="cb344-38"><a href="plotting-functions-ggplotsci.html#cb344-38"></a>  <span class="st">&quot;#e69f00&quot;</span>, <span class="co"># gamboge, squash, buttercup</span></span>
<span id="cb344-39"><a href="plotting-functions-ggplotsci.html#cb344-39"></a>  <span class="st">&quot;#359B73&quot;</span>, <span class="co"># ocean green</span></span>
<span id="cb344-40"><a href="plotting-functions-ggplotsci.html#cb344-40"></a>  <span class="st">&quot;#2271B2&quot;</span>, <span class="co"># honolulu blue</span></span>
<span id="cb344-41"><a href="plotting-functions-ggplotsci.html#cb344-41"></a>  <span class="st">&quot;#f0e442&quot;</span>, <span class="co"># holiday, </span></span>
<span id="cb344-42"><a href="plotting-functions-ggplotsci.html#cb344-42"></a>  <span class="st">&quot;#F748A5&quot;</span>, <span class="co"># barbi pink</span></span>
<span id="cb344-43"><a href="plotting-functions-ggplotsci.html#cb344-43"></a>  <span class="st">&quot;#d55e00&quot;</span> <span class="co"># bamboo</span></span>
<span id="cb344-44"><a href="plotting-functions-ggplotsci.html#cb344-44"></a>)</span>
<span id="cb344-45"><a href="plotting-functions-ggplotsci.html#cb344-45"></a></span>
<span id="cb344-46"><a href="plotting-functions-ggplotsci.html#cb344-46"></a>pal_nature_alt &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb344-47"><a href="plotting-functions-ggplotsci.html#cb344-47"></a>  <span class="st">&quot;#AA0DB4&quot;</span>, <span class="co"># barney</span></span>
<span id="cb344-48"><a href="plotting-functions-ggplotsci.html#cb344-48"></a>  <span class="st">&quot;#FF54ED&quot;</span>, <span class="co"># light magenta</span></span>
<span id="cb344-49"><a href="plotting-functions-ggplotsci.html#cb344-49"></a>  <span class="st">&quot;#00B19F&quot;</span>, <span class="co"># strong opal</span></span>
<span id="cb344-50"><a href="plotting-functions-ggplotsci.html#cb344-50"></a>  <span class="st">&quot;#EB057A&quot;</span>, <span class="co"># vivid rose</span></span>
<span id="cb344-51"><a href="plotting-functions-ggplotsci.html#cb344-51"></a>  <span class="st">&quot;#F8071D&quot;</span>, <span class="co"># vivid red</span></span>
<span id="cb344-52"><a href="plotting-functions-ggplotsci.html#cb344-52"></a>  <span class="st">&quot;#FF8D1A&quot;</span>, <span class="co"># dark orange</span></span>
<span id="cb344-53"><a href="plotting-functions-ggplotsci.html#cb344-53"></a>  <span class="st">&quot;#9EFF37&quot;</span> <span class="co"># french lime, </span></span>
<span id="cb344-54"><a href="plotting-functions-ggplotsci.html#cb344-54"></a>)</span>
<span id="cb344-55"><a href="plotting-functions-ggplotsci.html#cb344-55"></a></span>
<span id="cb344-56"><a href="plotting-functions-ggplotsci.html#cb344-56"></a></span>
<span id="cb344-57"><a href="plotting-functions-ggplotsci.html#cb344-57"></a><span class="co"># https://mikemol.github.io/technique/colorblind/2018/02/11/color-safe-palette.html</span></span>
<span id="cb344-58"><a href="plotting-functions-ggplotsci.html#cb344-58"></a><span class="co"># https://thenode.biologists.com/data-visualization-with-flying-colors/research/</span></span>
<span id="cb344-59"><a href="plotting-functions-ggplotsci.html#cb344-59"></a></span>
<span id="cb344-60"><a href="plotting-functions-ggplotsci.html#cb344-60"></a>pal_okabe_ito &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb344-61"><a href="plotting-functions-ggplotsci.html#cb344-61"></a>  <span class="st">&quot;#E69F00&quot;</span>,</span>
<span id="cb344-62"><a href="plotting-functions-ggplotsci.html#cb344-62"></a>  <span class="st">&quot;#56B4E9&quot;</span>,</span>
<span id="cb344-63"><a href="plotting-functions-ggplotsci.html#cb344-63"></a>  <span class="st">&quot;#009E73&quot;</span>,</span>
<span id="cb344-64"><a href="plotting-functions-ggplotsci.html#cb344-64"></a>  <span class="st">&quot;#F0E442&quot;</span>,</span>
<span id="cb344-65"><a href="plotting-functions-ggplotsci.html#cb344-65"></a>  <span class="st">&quot;#0072B2&quot;</span>,</span>
<span id="cb344-66"><a href="plotting-functions-ggplotsci.html#cb344-66"></a>  <span class="st">&quot;#D55E00&quot;</span>,</span>
<span id="cb344-67"><a href="plotting-functions-ggplotsci.html#cb344-67"></a>  <span class="st">&quot;#CC79A7&quot;</span></span>
<span id="cb344-68"><a href="plotting-functions-ggplotsci.html#cb344-68"></a>)</span></code></pre></div>
<div id="odd-even" class="section level2">
<h2><span class="header-section-number">19.1</span> odd-even</h2>
<p>This is a function used in the funtion to create a p-value table that is used in the plots. A user is unlikely to ever directly call this function.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="plotting-functions-ggplotsci.html#cb345-1"></a>odd &lt;-<span class="st"> </span><span class="cf">function</span>(x) x<span class="op">%%</span><span class="dv">2</span> <span class="op">!=</span><span class="st"> </span><span class="dv">0</span></span>
<span id="cb345-2"><a href="plotting-functions-ggplotsci.html#cb345-2"></a>even &lt;-<span class="st"> </span><span class="cf">function</span>(x) x<span class="op">%%</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span></span></code></pre></div>
</div>
<div id="estimate-response-and-effects-with-emmeans" class="section level2">
<h2><span class="header-section-number">19.2</span> estimate response and effects with emmeans</h2>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="plotting-functions-ggplotsci.html#cb346-1"></a>estimate &lt;-<span class="st"> </span><span class="cf">function</span>(fit, <span class="co"># model fit</span></span>
<span id="cb346-2"><a href="plotting-functions-ggplotsci.html#cb346-2"></a>                     specs, <span class="co"># factor(s)</span></span>
<span id="cb346-3"><a href="plotting-functions-ggplotsci.html#cb346-3"></a>                     <span class="dt">method =</span> <span class="st">&quot;revpairwise&quot;</span>, <span class="co"># revpairwise</span></span>
<span id="cb346-4"><a href="plotting-functions-ggplotsci.html#cb346-4"></a>                     <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="co"># &quot;link&quot;, &quot;response&quot;</span></span>
<span id="cb346-5"><a href="plotting-functions-ggplotsci.html#cb346-5"></a>                     <span class="dt">adjust =</span> <span class="st">&quot;none&quot;</span> <span class="co"># p-value</span></span>
<span id="cb346-6"><a href="plotting-functions-ggplotsci.html#cb346-6"></a>){</span>
<span id="cb346-7"><a href="plotting-functions-ggplotsci.html#cb346-7"></a>  <span class="co"># response table</span></span>
<span id="cb346-8"><a href="plotting-functions-ggplotsci.html#cb346-8"></a>  fit_emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(fit, <span class="dt">specs =</span> specs, <span class="dt">type =</span> type)</span>
<span id="cb346-9"><a href="plotting-functions-ggplotsci.html#cb346-9"></a>  response_table &lt;-<span class="st"> </span><span class="kw">emm_table</span>(fit_emm)</span>
<span id="cb346-10"><a href="plotting-functions-ggplotsci.html#cb346-10"></a>  </span>
<span id="cb346-11"><a href="plotting-functions-ggplotsci.html#cb346-11"></a>  <span class="co"># effect table</span></span>
<span id="cb346-12"><a href="plotting-functions-ggplotsci.html#cb346-12"></a>  fit_pairs &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">contrast</span>(fit_emm,</span>
<span id="cb346-13"><a href="plotting-functions-ggplotsci.html#cb346-13"></a>                                <span class="dt">method =</span> method,</span>
<span id="cb346-14"><a href="plotting-functions-ggplotsci.html#cb346-14"></a>                                <span class="dt">type =</span> type,</span>
<span id="cb346-15"><a href="plotting-functions-ggplotsci.html#cb346-15"></a>                                <span class="dt">adjust =</span> adjust,</span>
<span id="cb346-16"><a href="plotting-functions-ggplotsci.html#cb346-16"></a>                                <span class="dt">simple =</span> <span class="st">&quot;each&quot;</span>,</span>
<span id="cb346-17"><a href="plotting-functions-ggplotsci.html#cb346-17"></a>                                <span class="dt">combine =</span> <span class="ot">TRUE</span>),</span>
<span id="cb346-18"><a href="plotting-functions-ggplotsci.html#cb346-18"></a>                       <span class="dt">infer =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb346-19"><a href="plotting-functions-ggplotsci.html#cb346-19"></a><span class="st">    </span><span class="kw">data.table</span>()</span>
<span id="cb346-20"><a href="plotting-functions-ggplotsci.html#cb346-20"></a>  effect_table &lt;-<span class="st"> </span><span class="kw">pairs_table</span>(fit_pairs)</span>
<span id="cb346-21"><a href="plotting-functions-ggplotsci.html#cb346-21"></a>  </span>
<span id="cb346-22"><a href="plotting-functions-ggplotsci.html#cb346-22"></a>  <span class="kw">return</span>(<span class="kw">list</span>(</span>
<span id="cb346-23"><a href="plotting-functions-ggplotsci.html#cb346-23"></a>    <span class="dt">response =</span> response_table,</span>
<span id="cb346-24"><a href="plotting-functions-ggplotsci.html#cb346-24"></a>    <span class="dt">effect =</span> effect_table))</span>
<span id="cb346-25"><a href="plotting-functions-ggplotsci.html#cb346-25"></a>}</span></code></pre></div>
</div>
<div id="emm_table" class="section level2">
<h2><span class="header-section-number">19.3</span> emm_table</h2>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="plotting-functions-ggplotsci.html#cb347-1"></a>emm_table &lt;-<span class="st"> </span><span class="cf">function</span>(fit_emm){</span>
<span id="cb347-2"><a href="plotting-functions-ggplotsci.html#cb347-2"></a>  table_out &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="kw">summary</span>(fit_emm))</span>
<span id="cb347-3"><a href="plotting-functions-ggplotsci.html#cb347-3"></a>  <span class="cf">if</span>(<span class="st">&quot;response&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">colnames</span>(table_out)){</span>
<span id="cb347-4"><a href="plotting-functions-ggplotsci.html#cb347-4"></a>    <span class="co"># if the lm with log(y) or glm with log link, use &quot; / &quot;</span></span>
<span id="cb347-5"><a href="plotting-functions-ggplotsci.html#cb347-5"></a>    <span class="kw">setnames</span>(table_out,</span>
<span id="cb347-6"><a href="plotting-functions-ggplotsci.html#cb347-6"></a>             <span class="dt">old =</span> <span class="kw">c</span>(<span class="st">&quot;response&quot;</span>),</span>
<span id="cb347-7"><a href="plotting-functions-ggplotsci.html#cb347-7"></a>             <span class="dt">new =</span> <span class="kw">c</span>(<span class="st">&quot;emmean&quot;</span>))</span>
<span id="cb347-8"><a href="plotting-functions-ggplotsci.html#cb347-8"></a>  }</span>
<span id="cb347-9"><a href="plotting-functions-ggplotsci.html#cb347-9"></a>  <span class="cf">if</span>(<span class="st">&quot;asymp.LCL&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">colnames</span>(table_out)){</span>
<span id="cb347-10"><a href="plotting-functions-ggplotsci.html#cb347-10"></a>    <span class="co"># if the lm with log(y) or glm with log link, use &quot; / &quot;</span></span>
<span id="cb347-11"><a href="plotting-functions-ggplotsci.html#cb347-11"></a>    <span class="kw">setnames</span>(table_out,</span>
<span id="cb347-12"><a href="plotting-functions-ggplotsci.html#cb347-12"></a>             <span class="dt">old =</span> <span class="kw">c</span>(<span class="st">&quot;asymp.LCL&quot;</span>, <span class="st">&quot;asymp.UCL&quot;</span>),</span>
<span id="cb347-13"><a href="plotting-functions-ggplotsci.html#cb347-13"></a>             <span class="dt">new =</span> <span class="kw">c</span>(<span class="st">&quot;lower.CL&quot;</span>, <span class="st">&quot;upper.CL&quot;</span>))</span>
<span id="cb347-14"><a href="plotting-functions-ggplotsci.html#cb347-14"></a>  }</span>
<span id="cb347-15"><a href="plotting-functions-ggplotsci.html#cb347-15"></a>  <span class="kw">return</span>(table_out)</span>
<span id="cb347-16"><a href="plotting-functions-ggplotsci.html#cb347-16"></a>}</span></code></pre></div>
</div>
<div id="pairs_table" class="section level2">
<h2><span class="header-section-number">19.4</span> pairs_table</h2>
<p>This function takes the output from emmeans::contrast and creates a table used by the plot functions to show p-values on the plot. A user would only call this function directly if they wanted to do some major modifications of the template here.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="plotting-functions-ggplotsci.html#cb348-1"></a>pairs_table &lt;-<span class="st"> </span><span class="cf">function</span>(fit_pairs){</span>
<span id="cb348-2"><a href="plotting-functions-ggplotsci.html#cb348-2"></a>  </span>
<span id="cb348-3"><a href="plotting-functions-ggplotsci.html#cb348-3"></a>   <span class="cf">if</span>(<span class="st">&quot;ratio&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">colnames</span>(fit_pairs)){</span>
<span id="cb348-4"><a href="plotting-functions-ggplotsci.html#cb348-4"></a>    <span class="co"># if the lm with log(y) or glm with log link, use &quot; / &quot;</span></span>
<span id="cb348-5"><a href="plotting-functions-ggplotsci.html#cb348-5"></a>    groups &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">str_split</span>(fit_pairs<span class="op">$</span>contrast, <span class="st">&quot; / &quot;</span>))</span>
<span id="cb348-6"><a href="plotting-functions-ggplotsci.html#cb348-6"></a>    <span class="kw">setnames</span>(fit_pairs, <span class="dt">old =</span> <span class="st">&quot;ratio&quot;</span>, <span class="dt">new =</span> <span class="st">&quot;estimate&quot;</span>)</span>
<span id="cb348-7"><a href="plotting-functions-ggplotsci.html#cb348-7"></a>  }<span class="cf">else</span>{</span>
<span id="cb348-8"><a href="plotting-functions-ggplotsci.html#cb348-8"></a>    <span class="co"># if lm use &quot; - &quot;</span></span>
<span id="cb348-9"><a href="plotting-functions-ggplotsci.html#cb348-9"></a>    groups &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">str_split</span>(fit_pairs<span class="op">$</span>contrast, <span class="st">&quot; - &quot;</span>))</span>
<span id="cb348-10"><a href="plotting-functions-ggplotsci.html#cb348-10"></a>  }</span>
<span id="cb348-11"><a href="plotting-functions-ggplotsci.html#cb348-11"></a>  </span>
<span id="cb348-12"><a href="plotting-functions-ggplotsci.html#cb348-12"></a>  <span class="cf">if</span>(<span class="st">&quot;asymp.LCL&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">colnames</span>(fit_pairs)){</span>
<span id="cb348-13"><a href="plotting-functions-ggplotsci.html#cb348-13"></a>    <span class="co"># if the lm with log(y) or glm with log link, use &quot; / &quot;</span></span>
<span id="cb348-14"><a href="plotting-functions-ggplotsci.html#cb348-14"></a>    <span class="kw">setnames</span>(fit_pairs,</span>
<span id="cb348-15"><a href="plotting-functions-ggplotsci.html#cb348-15"></a>             <span class="dt">old =</span> <span class="kw">c</span>(<span class="st">&quot;asymp.LCL&quot;</span>, <span class="st">&quot;asymp.UCL&quot;</span>),</span>
<span id="cb348-16"><a href="plotting-functions-ggplotsci.html#cb348-16"></a>             <span class="dt">new =</span> <span class="kw">c</span>(<span class="st">&quot;lower.CL&quot;</span>, <span class="st">&quot;upper.CL&quot;</span>))</span>
<span id="cb348-17"><a href="plotting-functions-ggplotsci.html#cb348-17"></a>  }</span>
<span id="cb348-18"><a href="plotting-functions-ggplotsci.html#cb348-18"></a>  </span>
<span id="cb348-19"><a href="plotting-functions-ggplotsci.html#cb348-19"></a>  <span class="co"># add the group1 and group 2 columns</span></span>
<span id="cb348-20"><a href="plotting-functions-ggplotsci.html#cb348-20"></a>  fit_pairs[, group1 <span class="op">:</span><span class="er">=</span><span class="st"> </span>groups[<span class="kw">odd</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(groups))]]</span>
<span id="cb348-21"><a href="plotting-functions-ggplotsci.html#cb348-21"></a>  fit_pairs[, group2 <span class="op">:</span><span class="er">=</span><span class="st"> </span>groups[<span class="kw">even</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(groups))]]</span>
<span id="cb348-22"><a href="plotting-functions-ggplotsci.html#cb348-22"></a>  </span>
<span id="cb348-23"><a href="plotting-functions-ggplotsci.html#cb348-23"></a>  <span class="co"># for simple = each, beautify contrast column and group1, group2</span></span>
<span id="cb348-24"><a href="plotting-functions-ggplotsci.html#cb348-24"></a>  <span class="cf">if</span>(<span class="kw">which</span>(<span class="kw">colnames</span>(fit_pairs)<span class="op">==</span><span class="st">&quot;contrast&quot;</span>) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>){</span>
<span id="cb348-25"><a href="plotting-functions-ggplotsci.html#cb348-25"></a>    <span class="co"># replace &quot;.&quot; with blank</span></span>
<span id="cb348-26"><a href="plotting-functions-ggplotsci.html#cb348-26"></a>    g_col &lt;-<span class="st"> </span><span class="kw">colnames</span>(fit_pairs)[<span class="dv">1</span>]</span>
<span id="cb348-27"><a href="plotting-functions-ggplotsci.html#cb348-27"></a>    x_col &lt;-<span class="st"> </span><span class="kw">colnames</span>(fit_pairs)[<span class="dv">2</span>]</span>
<span id="cb348-28"><a href="plotting-functions-ggplotsci.html#cb348-28"></a>    <span class="cf">for</span>(col <span class="cf">in</span> <span class="kw">names</span>(fit_pairs)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]){</span>
<span id="cb348-29"><a href="plotting-functions-ggplotsci.html#cb348-29"></a>      <span class="kw">set</span>(fit_pairs,</span>
<span id="cb348-30"><a href="plotting-functions-ggplotsci.html#cb348-30"></a>          <span class="dt">i=</span><span class="kw">which</span>(fit_pairs[[col]]<span class="op">==</span><span class="st">&quot;.&quot;</span>),</span>
<span id="cb348-31"><a href="plotting-functions-ggplotsci.html#cb348-31"></a>          <span class="dt">j=</span>col, <span class="dt">value=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb348-32"><a href="plotting-functions-ggplotsci.html#cb348-32"></a>    }</span>
<span id="cb348-33"><a href="plotting-functions-ggplotsci.html#cb348-33"></a> </span>
<span id="cb348-34"><a href="plotting-functions-ggplotsci.html#cb348-34"></a>    fit_pairs[, contrast <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(<span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">1</span>]),</span>
<span id="cb348-35"><a href="plotting-functions-ggplotsci.html#cb348-35"></a>                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">2</span>]),</span>
<span id="cb348-36"><a href="plotting-functions-ggplotsci.html#cb348-36"></a>                                 <span class="st">&quot;: &quot;</span>,</span>
<span id="cb348-37"><a href="plotting-functions-ggplotsci.html#cb348-37"></a>                                 contrast)]</span>
<span id="cb348-38"><a href="plotting-functions-ggplotsci.html#cb348-38"></a>    fit_pairs[<span class="kw">get</span>(g_col) <span class="op">==</span><span class="st"> &quot;&quot;</span>, group1 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(<span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">1</span>]),</span>
<span id="cb348-39"><a href="plotting-functions-ggplotsci.html#cb348-39"></a>                                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">2</span>]),</span>
<span id="cb348-40"><a href="plotting-functions-ggplotsci.html#cb348-40"></a>                                                 <span class="st">&quot;,&quot;</span>,</span>
<span id="cb348-41"><a href="plotting-functions-ggplotsci.html#cb348-41"></a>                                                 group1)]</span>
<span id="cb348-42"><a href="plotting-functions-ggplotsci.html#cb348-42"></a>    fit_pairs[<span class="kw">get</span>(g_col) <span class="op">==</span><span class="st"> &quot;&quot;</span>, group2 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(<span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">1</span>]),</span>
<span id="cb348-43"><a href="plotting-functions-ggplotsci.html#cb348-43"></a>                                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">2</span>]),</span>
<span id="cb348-44"><a href="plotting-functions-ggplotsci.html#cb348-44"></a>                                                 <span class="st">&quot;,&quot;</span>,</span>
<span id="cb348-45"><a href="plotting-functions-ggplotsci.html#cb348-45"></a>                                                 group2)]</span>
<span id="cb348-46"><a href="plotting-functions-ggplotsci.html#cb348-46"></a>    fit_pairs[<span class="kw">get</span>(x_col) <span class="op">==</span><span class="st"> &quot;&quot;</span>, group1 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(group1,</span>
<span id="cb348-47"><a href="plotting-functions-ggplotsci.html#cb348-47"></a>                                                 <span class="st">&quot;,&quot;</span>,</span>
<span id="cb348-48"><a href="plotting-functions-ggplotsci.html#cb348-48"></a>                                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">1</span>]),</span>
<span id="cb348-49"><a href="plotting-functions-ggplotsci.html#cb348-49"></a>                                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">2</span>]))]</span>
<span id="cb348-50"><a href="plotting-functions-ggplotsci.html#cb348-50"></a>    fit_pairs[<span class="kw">get</span>(x_col) <span class="op">==</span><span class="st"> &quot;&quot;</span>, group2 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(group2,</span>
<span id="cb348-51"><a href="plotting-functions-ggplotsci.html#cb348-51"></a>                                                 <span class="st">&quot;,&quot;</span>,</span>
<span id="cb348-52"><a href="plotting-functions-ggplotsci.html#cb348-52"></a>                                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">1</span>]),</span>
<span id="cb348-53"><a href="plotting-functions-ggplotsci.html#cb348-53"></a>                                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">2</span>]))]</span>
<span id="cb348-54"><a href="plotting-functions-ggplotsci.html#cb348-54"></a></span>
<span id="cb348-55"><a href="plotting-functions-ggplotsci.html#cb348-55"></a> }</span>
<span id="cb348-56"><a href="plotting-functions-ggplotsci.html#cb348-56"></a>  </span>
<span id="cb348-57"><a href="plotting-functions-ggplotsci.html#cb348-57"></a>  <span class="co"># create a column of nicely formatted p-values for display.</span></span>
<span id="cb348-58"><a href="plotting-functions-ggplotsci.html#cb348-58"></a>  fit_pairs[, p <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">pvalString</span>(p.value)]</span>
<span id="cb348-59"><a href="plotting-functions-ggplotsci.html#cb348-59"></a>}</span></code></pre></div>
</div>
<div id="gg_mean_error" class="section level2">
<h2><span class="header-section-number">19.5</span> gg_mean_error</h2>
<p><code>gg_mean_error</code> generates mean-and-CI plots that look like those published in most wet-bench experimental biology papers. I describe this more in the output below.</p>
<p>The arguments to the function are (the bold face arguments are required):</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong> the data.table</li>
<li><strong>x_col</strong> the name of the treatment column (“diet” for this file) containing the treatment groups</li>
<li><strong>y_col</strong> the name of response column (<em>not</em> the column of ratios!)</li>
<li>x_label = “none”, this is the label for the x-axis on the plot. “none” is the default (so no need to include) and results in no label (the plot looks better without it)</li>
<li>y_label = “Response (units)”, this is the label for the y-axis on the plot. You do want to replace the default with something meaningful and sense the y-variable is the <em>adjusted</em> response, it is important to include this in the label, so something like: y_label = “adj. SCAT (g)”</li>
<li>dots = “sina”, this controls how the dots are plotted. “sina” is clever.</li>
<li>dodge_width = 0.8, this controls how closely spaced the groups are in the plot</li>
<li>adjust = 0.5, this controls how wide the dots within each group</li>
<li>p_adjust = “none”, this controls p-value adjustment for multiple comparisons. This doesn’t matter for these data because there are only 2 groups in the diet treatment, so only 1 comparison (MR - CN).</li>
<li>p_show = 0, is the row number in fit_pairs with the p-values to show</li>
<li>p_pos = NULL, is the relative vertical position (bottom to top) of the p-values - the order matches the row index in p_show.</li>
</ol>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="plotting-functions-ggplotsci.html#cb349-1"></a>gg_mean_error &lt;-<span class="st"> </span><span class="cf">function</span>(data,</span>
<span id="cb349-2"><a href="plotting-functions-ggplotsci.html#cb349-2"></a>                          fit, <span class="co"># model fit from lm, lmer, nlme, glmmTMB</span></span>
<span id="cb349-3"><a href="plotting-functions-ggplotsci.html#cb349-3"></a>                          fit_emm,</span>
<span id="cb349-4"><a href="plotting-functions-ggplotsci.html#cb349-4"></a>                          fit_pairs,</span>
<span id="cb349-5"><a href="plotting-functions-ggplotsci.html#cb349-5"></a>                          x_col,</span>
<span id="cb349-6"><a href="plotting-functions-ggplotsci.html#cb349-6"></a>                          y_col,</span>
<span id="cb349-7"><a href="plotting-functions-ggplotsci.html#cb349-7"></a>                          <span class="dt">g_col=</span><span class="ot">NULL</span>,</span>
<span id="cb349-8"><a href="plotting-functions-ggplotsci.html#cb349-8"></a>                          <span class="dt">wrap_col=</span><span class="ot">NULL</span>,</span>
<span id="cb349-9"><a href="plotting-functions-ggplotsci.html#cb349-9"></a>                          <span class="dt">x_label =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb349-10"><a href="plotting-functions-ggplotsci.html#cb349-10"></a>                          <span class="dt">y_label =</span> <span class="st">&quot;Response (units)&quot;</span>,</span>
<span id="cb349-11"><a href="plotting-functions-ggplotsci.html#cb349-11"></a>                          <span class="dt">g_label =</span> <span class="ot">NULL</span>,</span>
<span id="cb349-12"><a href="plotting-functions-ggplotsci.html#cb349-12"></a>                          <span class="dt">dots =</span> <span class="st">&quot;jitter&quot;</span>,</span>
<span id="cb349-13"><a href="plotting-functions-ggplotsci.html#cb349-13"></a>                          <span class="dt">dodge_width =</span> <span class="fl">0.8</span>,</span>
<span id="cb349-14"><a href="plotting-functions-ggplotsci.html#cb349-14"></a>                          <span class="dt">adjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb349-15"><a href="plotting-functions-ggplotsci.html#cb349-15"></a>                          <span class="dt">p_show =</span> <span class="dv">0</span>,</span>
<span id="cb349-16"><a href="plotting-functions-ggplotsci.html#cb349-16"></a>                          <span class="dt">p_pos =</span> <span class="ot">NULL</span>){</span>
<span id="cb349-17"><a href="plotting-functions-ggplotsci.html#cb349-17"></a> </span>
<span id="cb349-18"><a href="plotting-functions-ggplotsci.html#cb349-18"></a></span>
<span id="cb349-19"><a href="plotting-functions-ggplotsci.html#cb349-19"></a>  dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(data)</span>
<span id="cb349-20"><a href="plotting-functions-ggplotsci.html#cb349-20"></a>  gg &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb349-21"><a href="plotting-functions-ggplotsci.html#cb349-21"></a>  </span>
<span id="cb349-22"><a href="plotting-functions-ggplotsci.html#cb349-22"></a>  <span class="cf">if</span>(<span class="kw">is.factor</span>(dt[, <span class="kw">get</span>(x_col)]) <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>){</span>
<span id="cb349-23"><a href="plotting-functions-ggplotsci.html#cb349-23"></a>    dt[, (x_col) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(<span class="kw">get</span>(x_col))]</span>
<span id="cb349-24"><a href="plotting-functions-ggplotsci.html#cb349-24"></a>  }</span>
<span id="cb349-25"><a href="plotting-functions-ggplotsci.html#cb349-25"></a>  <span class="cf">if</span>(<span class="kw">is.factor</span>(dt[, <span class="kw">get</span>(g_col)]) <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>){</span>
<span id="cb349-26"><a href="plotting-functions-ggplotsci.html#cb349-26"></a>    dt[, (g_col) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(<span class="kw">get</span>(g_col))]</span>
<span id="cb349-27"><a href="plotting-functions-ggplotsci.html#cb349-27"></a>  }</span>
<span id="cb349-28"><a href="plotting-functions-ggplotsci.html#cb349-28"></a></span>
<span id="cb349-29"><a href="plotting-functions-ggplotsci.html#cb349-29"></a>  fit_emm_dt &lt;-<span class="st"> </span><span class="kw">emm_table</span>(fit_emm)</span>
<span id="cb349-30"><a href="plotting-functions-ggplotsci.html#cb349-30"></a>  fit_pairs_dt &lt;-<span class="st"> </span><span class="kw">pairs_table</span>(<span class="kw">data.table</span>(fit_pairs))</span>
<span id="cb349-31"><a href="plotting-functions-ggplotsci.html#cb349-31"></a></span>
<span id="cb349-32"><a href="plotting-functions-ggplotsci.html#cb349-32"></a>  <span class="cf">if</span>(g_col <span class="op">==</span><span class="st"> </span>x_col <span class="op">|</span><span class="st"> </span><span class="kw">is.null</span>(g_col)){</span>
<span id="cb349-33"><a href="plotting-functions-ggplotsci.html#cb349-33"></a>    pd &lt;-<span class="st"> </span><span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="dv">0</span>)</span>
<span id="cb349-34"><a href="plotting-functions-ggplotsci.html#cb349-34"></a>    fit_pairs_dt[, x_min_col <span class="op">:</span><span class="er">=</span><span class="st"> </span>group1]</span>
<span id="cb349-35"><a href="plotting-functions-ggplotsci.html#cb349-35"></a>    fit_pairs_dt[, x_max_col <span class="op">:</span><span class="er">=</span><span class="st"> </span>group2]</span>
<span id="cb349-36"><a href="plotting-functions-ggplotsci.html#cb349-36"></a>  }<span class="cf">else</span>{</span>
<span id="cb349-37"><a href="plotting-functions-ggplotsci.html#cb349-37"></a>    pd &lt;-<span class="st"> </span><span class="kw">position_dodge</span>(<span class="dt">width =</span> dodge_width)</span>
<span id="cb349-38"><a href="plotting-functions-ggplotsci.html#cb349-38"></a>    fit_pairs_dt[, x_min_col <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="ot">NA</span>]</span>
<span id="cb349-39"><a href="plotting-functions-ggplotsci.html#cb349-39"></a>    fit_pairs_dt[, x_max_col <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="ot">NA</span>]</span>
<span id="cb349-40"><a href="plotting-functions-ggplotsci.html#cb349-40"></a>    <span class="cf">if</span>(<span class="kw">is.null</span>(g_label)){</span>
<span id="cb349-41"><a href="plotting-functions-ggplotsci.html#cb349-41"></a>      g_label &lt;-<span class="st"> </span>g_col</span>
<span id="cb349-42"><a href="plotting-functions-ggplotsci.html#cb349-42"></a>    }</span>
<span id="cb349-43"><a href="plotting-functions-ggplotsci.html#cb349-43"></a>  }</span>
<span id="cb349-44"><a href="plotting-functions-ggplotsci.html#cb349-44"></a></span>
<span id="cb349-45"><a href="plotting-functions-ggplotsci.html#cb349-45"></a></span>
<span id="cb349-46"><a href="plotting-functions-ggplotsci.html#cb349-46"></a>  gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>dt, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">get</span>(x_col),</span>
<span id="cb349-47"><a href="plotting-functions-ggplotsci.html#cb349-47"></a>                            <span class="dt">y =</span> <span class="kw">get</span>(y_col),</span>
<span id="cb349-48"><a href="plotting-functions-ggplotsci.html#cb349-48"></a>                            <span class="dt">color =</span> <span class="kw">get</span>(g_col)))</span>
<span id="cb349-49"><a href="plotting-functions-ggplotsci.html#cb349-49"></a>  <span class="co"># plot points</span></span>
<span id="cb349-50"><a href="plotting-functions-ggplotsci.html#cb349-50"></a>  <span class="cf">if</span>(dots <span class="op">==</span><span class="st"> &quot;sina&quot;</span>){</span>
<span id="cb349-51"><a href="plotting-functions-ggplotsci.html#cb349-51"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">geom_sina</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb349-52"><a href="plotting-functions-ggplotsci.html#cb349-52"></a>                         <span class="dt">position =</span> pd,</span>
<span id="cb349-53"><a href="plotting-functions-ggplotsci.html#cb349-53"></a>                         <span class="dt">adjust =</span> adjust)</span>
<span id="cb349-54"><a href="plotting-functions-ggplotsci.html#cb349-54"></a>  }</span>
<span id="cb349-55"><a href="plotting-functions-ggplotsci.html#cb349-55"></a>  <span class="cf">if</span>(dots <span class="op">==</span><span class="st"> &quot;jitter&quot;</span>){</span>
<span id="cb349-56"><a href="plotting-functions-ggplotsci.html#cb349-56"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb349-57"><a href="plotting-functions-ggplotsci.html#cb349-57"></a>                         <span class="dt">position =</span> <span class="st">&quot;jitter&quot;</span>)</span>
<span id="cb349-58"><a href="plotting-functions-ggplotsci.html#cb349-58"></a>  }</span>
<span id="cb349-59"><a href="plotting-functions-ggplotsci.html#cb349-59"></a>  <span class="cf">if</span>(dots <span class="op">==</span><span class="st"> &quot;dotplot&quot;</span>){</span>
<span id="cb349-60"><a href="plotting-functions-ggplotsci.html#cb349-60"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">geom_dotplot</span>(<span class="dt">binaxis=</span><span class="st">&#39;y&#39;</span>,</span>
<span id="cb349-61"><a href="plotting-functions-ggplotsci.html#cb349-61"></a>                            <span class="dt">stackdir=</span><span class="st">&#39;center&#39;</span>,</span>
<span id="cb349-62"><a href="plotting-functions-ggplotsci.html#cb349-62"></a>                            <span class="dt">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb349-63"><a href="plotting-functions-ggplotsci.html#cb349-63"></a>                            <span class="dt">position =</span> pd)</span>
<span id="cb349-64"><a href="plotting-functions-ggplotsci.html#cb349-64"></a></span>
<span id="cb349-65"><a href="plotting-functions-ggplotsci.html#cb349-65"></a>  }</span>
<span id="cb349-66"><a href="plotting-functions-ggplotsci.html#cb349-66"></a></span>
<span id="cb349-67"><a href="plotting-functions-ggplotsci.html#cb349-67"></a>  <span class="co"># plot means and CI</span></span>
<span id="cb349-68"><a href="plotting-functions-ggplotsci.html#cb349-68"></a>  gg &lt;-<span class="st"> </span>gg <span class="op">+</span></span>
<span id="cb349-69"><a href="plotting-functions-ggplotsci.html#cb349-69"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> fit_emm_dt, <span class="kw">aes</span>(<span class="dt">y =</span> emmean,</span>
<span id="cb349-70"><a href="plotting-functions-ggplotsci.html#cb349-70"></a>                                           <span class="dt">ymin =</span> lower.CL,</span>
<span id="cb349-71"><a href="plotting-functions-ggplotsci.html#cb349-71"></a>                                           <span class="dt">ymax =</span> upper.CL,</span>
<span id="cb349-72"><a href="plotting-functions-ggplotsci.html#cb349-72"></a>                                        <span class="dt">color =</span> <span class="kw">get</span>(g_col)),</span>
<span id="cb349-73"><a href="plotting-functions-ggplotsci.html#cb349-73"></a>               <span class="dt">width =</span> <span class="dv">0</span>,</span>
<span id="cb349-74"><a href="plotting-functions-ggplotsci.html#cb349-74"></a>              <span class="dt">position =</span> pd</span>
<span id="cb349-75"><a href="plotting-functions-ggplotsci.html#cb349-75"></a>    ) <span class="op">+</span></span>
<span id="cb349-76"><a href="plotting-functions-ggplotsci.html#cb349-76"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> fit_emm_dt, <span class="kw">aes</span>(<span class="dt">y =</span> emmean,</span>
<span id="cb349-77"><a href="plotting-functions-ggplotsci.html#cb349-77"></a>                                        <span class="dt">color =</span> <span class="kw">get</span>(g_col)),</span>
<span id="cb349-78"><a href="plotting-functions-ggplotsci.html#cb349-78"></a>               <span class="dt">size =</span> <span class="dv">3</span>,</span>
<span id="cb349-79"><a href="plotting-functions-ggplotsci.html#cb349-79"></a>              <span class="dt">position =</span> pd</span>
<span id="cb349-80"><a href="plotting-functions-ggplotsci.html#cb349-80"></a>    ) <span class="op">+</span></span>
<span id="cb349-81"><a href="plotting-functions-ggplotsci.html#cb349-81"></a></span>
<span id="cb349-82"><a href="plotting-functions-ggplotsci.html#cb349-82"></a><span class="st">    </span><span class="co"># aesthetics</span></span>
<span id="cb349-83"><a href="plotting-functions-ggplotsci.html#cb349-83"></a><span class="st">    </span><span class="kw">ylab</span>(y_label) <span class="op">+</span></span>
<span id="cb349-84"><a href="plotting-functions-ggplotsci.html#cb349-84"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>pal_nature_mod,</span>
<span id="cb349-85"><a href="plotting-functions-ggplotsci.html#cb349-85"></a>                       <span class="dt">name =</span> g_col) <span class="op">+</span></span>
<span id="cb349-86"><a href="plotting-functions-ggplotsci.html#cb349-86"></a><span class="st">    </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb349-87"><a href="plotting-functions-ggplotsci.html#cb349-87"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb349-88"><a href="plotting-functions-ggplotsci.html#cb349-88"></a></span>
<span id="cb349-89"><a href="plotting-functions-ggplotsci.html#cb349-89"></a><span class="st">    </span><span class="ot">NULL</span></span>
<span id="cb349-90"><a href="plotting-functions-ggplotsci.html#cb349-90"></a>  </span>
<span id="cb349-91"><a href="plotting-functions-ggplotsci.html#cb349-91"></a>  </span>
<span id="cb349-92"><a href="plotting-functions-ggplotsci.html#cb349-92"></a>  <span class="cf">if</span>(g_col <span class="op">==</span><span class="st"> </span>x_col){</span>
<span id="cb349-93"><a href="plotting-functions-ggplotsci.html#cb349-93"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb349-94"><a href="plotting-functions-ggplotsci.html#cb349-94"></a>  }</span>
<span id="cb349-95"><a href="plotting-functions-ggplotsci.html#cb349-95"></a>  </span>
<span id="cb349-96"><a href="plotting-functions-ggplotsci.html#cb349-96"></a>  <span class="cf">if</span>(<span class="kw">is.null</span>(g_label)){</span>
<span id="cb349-97"><a href="plotting-functions-ggplotsci.html#cb349-97"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="ot">NULL</span>))</span>
<span id="cb349-98"><a href="plotting-functions-ggplotsci.html#cb349-98"></a>  }<span class="cf">else</span>{</span>
<span id="cb349-99"><a href="plotting-functions-ggplotsci.html#cb349-99"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title=</span>g_label))</span>
<span id="cb349-100"><a href="plotting-functions-ggplotsci.html#cb349-100"></a>  }</span>
<span id="cb349-101"><a href="plotting-functions-ggplotsci.html#cb349-101"></a></span>
<span id="cb349-102"><a href="plotting-functions-ggplotsci.html#cb349-102"></a>  <span class="cf">if</span>(<span class="kw">sum</span>(p_show) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){ <span class="co"># show p-values</span></span>
<span id="cb349-103"><a href="plotting-functions-ggplotsci.html#cb349-103"></a>    <span class="co"># get x positions for p-values</span></span>
<span id="cb349-104"><a href="plotting-functions-ggplotsci.html#cb349-104"></a>    <span class="co"># [[3]] is 3rd layer which is means</span></span>
<span id="cb349-105"><a href="plotting-functions-ggplotsci.html#cb349-105"></a>    <span class="cf">if</span>(<span class="kw">is.na</span>(fit_pairs_dt[<span class="dv">1</span>, x_min_col])){</span>
<span id="cb349-106"><a href="plotting-functions-ggplotsci.html#cb349-106"></a>      gg_data &lt;-<span class="st"> </span><span class="kw">cbind</span>(fit_emm_dt,</span>
<span id="cb349-107"><a href="plotting-functions-ggplotsci.html#cb349-107"></a>                       <span class="kw">ggplot_build</span>(gg)<span class="op">$</span>data[[<span class="dv">3</span>]])</span>
<span id="cb349-108"><a href="plotting-functions-ggplotsci.html#cb349-108"></a></span>
<span id="cb349-109"><a href="plotting-functions-ggplotsci.html#cb349-109"></a>      gg_data[, cell <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste</span>(<span class="kw">get</span>(x_col), <span class="kw">get</span>(g_col), <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)]</span>
<span id="cb349-110"><a href="plotting-functions-ggplotsci.html#cb349-110"></a>      match_it_ref &lt;-<span class="st"> </span><span class="kw">match</span>(fit_pairs_dt<span class="op">$</span>group1, gg_data<span class="op">$</span>cell)</span>
<span id="cb349-111"><a href="plotting-functions-ggplotsci.html#cb349-111"></a></span>
<span id="cb349-112"><a href="plotting-functions-ggplotsci.html#cb349-112"></a>      fit_pairs_dt[, rowa <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">match</span>(group1, gg_data<span class="op">$</span>cell)]</span>
<span id="cb349-113"><a href="plotting-functions-ggplotsci.html#cb349-113"></a>      fit_pairs_dt[, rowb <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">match</span>(group2, gg_data<span class="op">$</span>cell)]</span>
<span id="cb349-114"><a href="plotting-functions-ggplotsci.html#cb349-114"></a>      fit_pairs_dt[, x_min_col <span class="op">:</span><span class="er">=</span><span class="st"> </span>gg_data[rowa, x]]</span>
<span id="cb349-115"><a href="plotting-functions-ggplotsci.html#cb349-115"></a>      fit_pairs_dt[, x_max_col <span class="op">:</span><span class="er">=</span><span class="st"> </span>gg_data[rowb, x]]</span>
<span id="cb349-116"><a href="plotting-functions-ggplotsci.html#cb349-116"></a>    }</span>
<span id="cb349-117"><a href="plotting-functions-ggplotsci.html#cb349-117"></a></span>
<span id="cb349-118"><a href="plotting-functions-ggplotsci.html#cb349-118"></a>    <span class="cf">if</span>(<span class="kw">is.null</span>(p_pos)){</span>
<span id="cb349-119"><a href="plotting-functions-ggplotsci.html#cb349-119"></a>      p_pos &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(p_show)</span>
<span id="cb349-120"><a href="plotting-functions-ggplotsci.html#cb349-120"></a>    }</span>
<span id="cb349-121"><a href="plotting-functions-ggplotsci.html#cb349-121"></a>    max_y &lt;-<span class="st"> </span><span class="kw">max</span>(dt[, <span class="kw">get</span>(y_col)], <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb349-122"><a href="plotting-functions-ggplotsci.html#cb349-122"></a>    min_y &lt;-<span class="st"> </span><span class="kw">min</span>(dt[, <span class="kw">get</span>(y_col)], <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb349-123"><a href="plotting-functions-ggplotsci.html#cb349-123"></a>    increment &lt;-<span class="st"> </span><span class="fl">0.1</span><span class="op">*</span>(max_y <span class="op">-</span><span class="st"> </span>min_y)</span>
<span id="cb349-124"><a href="plotting-functions-ggplotsci.html#cb349-124"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(p_pos)){</span>
<span id="cb349-125"><a href="plotting-functions-ggplotsci.html#cb349-125"></a>      pos &lt;-<span class="st"> </span>p_pos[i]</span>
<span id="cb349-126"><a href="plotting-functions-ggplotsci.html#cb349-126"></a>      y_position &lt;-<span class="st"> </span>max_y <span class="op">+</span><span class="st"> </span>increment<span class="op">*</span>pos</span>
<span id="cb349-127"><a href="plotting-functions-ggplotsci.html#cb349-127"></a>      row &lt;-<span class="st"> </span>p_show[i]</span>
<span id="cb349-128"><a href="plotting-functions-ggplotsci.html#cb349-128"></a>      gg &lt;-<span class="st"> </span>gg <span class="op">+</span></span>
<span id="cb349-129"><a href="plotting-functions-ggplotsci.html#cb349-129"></a><span class="st">        </span><span class="kw">stat_pvalue_manual</span>(fit_pairs_dt[row],</span>
<span id="cb349-130"><a href="plotting-functions-ggplotsci.html#cb349-130"></a>                           <span class="dt">label =</span> <span class="st">&quot;p&quot;</span>,</span>
<span id="cb349-131"><a href="plotting-functions-ggplotsci.html#cb349-131"></a>                           <span class="dt">y.position=</span>y_position,</span>
<span id="cb349-132"><a href="plotting-functions-ggplotsci.html#cb349-132"></a>                           <span class="dt">xmin =</span> <span class="st">&quot;x_min_col&quot;</span>,</span>
<span id="cb349-133"><a href="plotting-functions-ggplotsci.html#cb349-133"></a>                           <span class="dt">xmax =</span> <span class="st">&quot;x_max_col&quot;</span>,</span>
<span id="cb349-134"><a href="plotting-functions-ggplotsci.html#cb349-134"></a>                           <span class="dt">tip.length =</span> <span class="fl">0.01</span>)</span>
<span id="cb349-135"><a href="plotting-functions-ggplotsci.html#cb349-135"></a>    }</span>
<span id="cb349-136"><a href="plotting-functions-ggplotsci.html#cb349-136"></a></span>
<span id="cb349-137"><a href="plotting-functions-ggplotsci.html#cb349-137"></a>    <span class="co"># make sure ylim includes p-value</span></span>
<span id="cb349-138"><a href="plotting-functions-ggplotsci.html#cb349-138"></a>    y_hi &lt;-<span class="st"> </span>max_y <span class="op">+</span><span class="st"> </span><span class="fl">0.05</span><span class="op">*</span>(max_y <span class="op">-</span><span class="st"> </span>min_y) <span class="op">+</span></span>
<span id="cb349-139"><a href="plotting-functions-ggplotsci.html#cb349-139"></a><span class="st">      </span>increment<span class="op">*</span><span class="kw">max</span>(p_pos)</span>
<span id="cb349-140"><a href="plotting-functions-ggplotsci.html#cb349-140"></a>    y_lo &lt;-<span class="st"> </span>min_y <span class="op">-</span><span class="st"> </span><span class="fl">0.05</span><span class="op">*</span>(max_y <span class="op">-</span><span class="st"> </span>min_y)</span>
<span id="cb349-141"><a href="plotting-functions-ggplotsci.html#cb349-141"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(y_lo, y_hi))</span>
<span id="cb349-142"><a href="plotting-functions-ggplotsci.html#cb349-142"></a>  }</span>
<span id="cb349-143"><a href="plotting-functions-ggplotsci.html#cb349-143"></a></span>
<span id="cb349-144"><a href="plotting-functions-ggplotsci.html#cb349-144"></a></span>
<span id="cb349-145"><a href="plotting-functions-ggplotsci.html#cb349-145"></a>  <span class="co"># remove x axis title</span></span>
<span id="cb349-146"><a href="plotting-functions-ggplotsci.html#cb349-146"></a>  <span class="cf">if</span>(x_label <span class="op">==</span><span class="st"> &quot;none&quot;</span>){</span>
<span id="cb349-147"><a href="plotting-functions-ggplotsci.html#cb349-147"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>())</span>
<span id="cb349-148"><a href="plotting-functions-ggplotsci.html#cb349-148"></a>  }<span class="cf">else</span>{</span>
<span id="cb349-149"><a href="plotting-functions-ggplotsci.html#cb349-149"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(x_label)}</span>
<span id="cb349-150"><a href="plotting-functions-ggplotsci.html#cb349-150"></a></span>
<span id="cb349-151"><a href="plotting-functions-ggplotsci.html#cb349-151"></a>  gg</span>
<span id="cb349-152"><a href="plotting-functions-ggplotsci.html#cb349-152"></a></span>
<span id="cb349-153"><a href="plotting-functions-ggplotsci.html#cb349-153"></a>  <span class="kw">return</span>(gg)</span>
<span id="cb349-154"><a href="plotting-functions-ggplotsci.html#cb349-154"></a>}</span></code></pre></div>
</div>
<div id="gg_ancova" class="section level2">
<h2><span class="header-section-number">19.6</span> gg_ancova</h2>
<p><code>gg_ancova</code> generates a classic <a href="presenting-results-as-ancova-plots">“ANCOVA” plot</a>. This function would be directly called by a user.</p>
<p>The arguments to the function are (the bold face arguments are required):</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong> the data.table</li>
<li><strong>x_col</strong> the name of the treatment column (“diet” for this file) containing the treatment groups</li>
<li><strong>y_col</strong> the name of response column (<em>not</em> the column of ratios!)</li>
<li><strong>cov_col</strong>, the name of the column containing the covariate (“bw_02_05_18” for this file)</li>
<li>cov_label = “covariate (units)”, this is the label for the x-axis on the plot which is the name of the covariate column. You do want to replace the default with something meaningful. For these data, something like: cov_label = “Body Mass (g)”</li>
<li>y_label = “Response (units)”, this is the label for the y-axis on the plot. You do want to replace the default with something meaningful like: y_label = “SCAT (g)”</li>
<li>add_p = TRUE, the defaults adds the p-value of the treatment (x_col) effect</li>
<li>p_pos = “center”, controls the x-position of the p-value on the graph</li>
<li>p_adjust = “none”, this controls p-value adjustment for multiple comparisons. This doesn’t matter for these data because there are only 2 groups in the diet treatment, so only 1 comparison (MR - CN).</li>
</ol>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="plotting-functions-ggplotsci.html#cb350-1"></a>gg_ancova &lt;-<span class="st"> </span><span class="cf">function</span>(data,</span>
<span id="cb350-2"><a href="plotting-functions-ggplotsci.html#cb350-2"></a>                      fit, <span class="co"># model fit from lm, lmer, nlme, glmmTMB</span></span>
<span id="cb350-3"><a href="plotting-functions-ggplotsci.html#cb350-3"></a>                      fit_emm,</span>
<span id="cb350-4"><a href="plotting-functions-ggplotsci.html#cb350-4"></a>                      fit_pairs,</span>
<span id="cb350-5"><a href="plotting-functions-ggplotsci.html#cb350-5"></a>                      x_col,</span>
<span id="cb350-6"><a href="plotting-functions-ggplotsci.html#cb350-6"></a>                      y_col,</span>
<span id="cb350-7"><a href="plotting-functions-ggplotsci.html#cb350-7"></a>                      cov_col,</span>
<span id="cb350-8"><a href="plotting-functions-ggplotsci.html#cb350-8"></a>                      <span class="dt">cov_label =</span> <span class="st">&quot;covariate (units)&quot;</span>,</span>
<span id="cb350-9"><a href="plotting-functions-ggplotsci.html#cb350-9"></a>                      <span class="dt">y_label =</span> <span class="st">&quot;Response (units)&quot;</span>,</span>
<span id="cb350-10"><a href="plotting-functions-ggplotsci.html#cb350-10"></a>                      <span class="dt">add_ci =</span> <span class="ot">TRUE</span>,</span>
<span id="cb350-11"><a href="plotting-functions-ggplotsci.html#cb350-11"></a>                      <span class="dt">add_p =</span> <span class="ot">TRUE</span>,</span>
<span id="cb350-12"><a href="plotting-functions-ggplotsci.html#cb350-12"></a>                      <span class="dt">p_show =</span> <span class="ot">NULL</span>,</span>
<span id="cb350-13"><a href="plotting-functions-ggplotsci.html#cb350-13"></a>                      <span class="dt">p_pos =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb350-14"><a href="plotting-functions-ggplotsci.html#cb350-14"></a>                      <span class="dt">p_adjust =</span> <span class="st">&quot;none&quot;</span>){</span>
<span id="cb350-15"><a href="plotting-functions-ggplotsci.html#cb350-15"></a>  </span>
<span id="cb350-16"><a href="plotting-functions-ggplotsci.html#cb350-16"></a>  dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(data)[, .SD, .SDcols =<span class="st"> </span><span class="kw">c</span>(x_col, y_col, cov_col)]</span>
<span id="cb350-17"><a href="plotting-functions-ggplotsci.html#cb350-17"></a>  </span>
<span id="cb350-18"><a href="plotting-functions-ggplotsci.html#cb350-18"></a>  dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(fit<span class="op">$</span>model)</span>
<span id="cb350-19"><a href="plotting-functions-ggplotsci.html#cb350-19"></a>  <span class="cf">if</span>(<span class="kw">is.factor</span>(dt[, <span class="kw">get</span>(x_col)]) <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>){</span>
<span id="cb350-20"><a href="plotting-functions-ggplotsci.html#cb350-20"></a>    dt[, (x_col) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(<span class="kw">get</span>(x_col))]</span>
<span id="cb350-21"><a href="plotting-functions-ggplotsci.html#cb350-21"></a>  }</span>
<span id="cb350-22"><a href="plotting-functions-ggplotsci.html#cb350-22"></a>  </span>
<span id="cb350-23"><a href="plotting-functions-ggplotsci.html#cb350-23"></a>  </span>
<span id="cb350-24"><a href="plotting-functions-ggplotsci.html#cb350-24"></a>  fit_emm_dt &lt;-<span class="st"> </span><span class="kw">emm_table</span>(fit_emm)</span>
<span id="cb350-25"><a href="plotting-functions-ggplotsci.html#cb350-25"></a>  fit_pairs_dt &lt;-<span class="st"> </span><span class="kw">pairs_table</span>(<span class="kw">data.table</span>(fit_pairs))</span>
<span id="cb350-26"><a href="plotting-functions-ggplotsci.html#cb350-26"></a></span>
<span id="cb350-27"><a href="plotting-functions-ggplotsci.html#cb350-27"></a>  g &lt;-<span class="st"> </span>x_col</span>
<span id="cb350-28"><a href="plotting-functions-ggplotsci.html#cb350-28"></a>  y &lt;-<span class="st"> </span>y_col</span>
<span id="cb350-29"><a href="plotting-functions-ggplotsci.html#cb350-29"></a>  x &lt;-<span class="st"> </span>cov_col</span>
<span id="cb350-30"><a href="plotting-functions-ggplotsci.html#cb350-30"></a>  </span>
<span id="cb350-31"><a href="plotting-functions-ggplotsci.html#cb350-31"></a>  new_wide &lt;-<span class="st"> </span>dt[, .(<span class="dt">xmin =</span> <span class="kw">min</span>(<span class="kw">get</span>(x)), <span class="dt">xmax =</span> <span class="kw">max</span>(<span class="kw">get</span>(x))), by =<span class="st"> </span><span class="kw">get</span>(g)]</span>
<span id="cb350-32"><a href="plotting-functions-ggplotsci.html#cb350-32"></a>  new_long &lt;-<span class="st"> </span><span class="kw">melt</span>(new_wide,</span>
<span id="cb350-33"><a href="plotting-functions-ggplotsci.html#cb350-33"></a>                   <span class="dt">measure.vars =</span> <span class="kw">c</span>(<span class="st">&quot;xmin&quot;</span>, <span class="st">&quot;xmax&quot;</span>),</span>
<span id="cb350-34"><a href="plotting-functions-ggplotsci.html#cb350-34"></a>                   <span class="dt">value.name =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb350-35"><a href="plotting-functions-ggplotsci.html#cb350-35"></a>  <span class="kw">setnames</span>(new_long, <span class="dt">old =</span> <span class="kw">c</span>(<span class="st">&quot;get&quot;</span>, <span class="st">&quot;x&quot;</span>), <span class="dt">new =</span> <span class="kw">c</span>(g, x))</span>
<span id="cb350-36"><a href="plotting-functions-ggplotsci.html#cb350-36"></a>  yhat &lt;-<span class="st"> </span><span class="kw">predict</span>(fit,</span>
<span id="cb350-37"><a href="plotting-functions-ggplotsci.html#cb350-37"></a>                  new_long,</span>
<span id="cb350-38"><a href="plotting-functions-ggplotsci.html#cb350-38"></a>                  <span class="dt">interval =</span> <span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb350-39"><a href="plotting-functions-ggplotsci.html#cb350-39"></a>  new_long &lt;-<span class="st"> </span><span class="kw">cbind</span>(new_long, yhat)</span>
<span id="cb350-40"><a href="plotting-functions-ggplotsci.html#cb350-40"></a>  <span class="kw">setnames</span>(new_long, <span class="dt">old =</span> <span class="kw">c</span>(<span class="st">&quot;fit&quot;</span>), <span class="dt">new =</span> <span class="kw">c</span>(y))</span>
<span id="cb350-41"><a href="plotting-functions-ggplotsci.html#cb350-41"></a>  </span>
<span id="cb350-42"><a href="plotting-functions-ggplotsci.html#cb350-42"></a>  gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dt, <span class="kw">aes</span>(</span>
<span id="cb350-43"><a href="plotting-functions-ggplotsci.html#cb350-43"></a>    <span class="dt">x =</span> <span class="kw">get</span>(x),</span>
<span id="cb350-44"><a href="plotting-functions-ggplotsci.html#cb350-44"></a>    <span class="dt">y =</span> <span class="kw">get</span>(y),</span>
<span id="cb350-45"><a href="plotting-functions-ggplotsci.html#cb350-45"></a>    <span class="dt">color =</span> <span class="kw">get</span>(g)</span>
<span id="cb350-46"><a href="plotting-functions-ggplotsci.html#cb350-46"></a>  )) <span class="op">+</span></span>
<span id="cb350-47"><a href="plotting-functions-ggplotsci.html#cb350-47"></a><span class="st">    </span></span>
<span id="cb350-48"><a href="plotting-functions-ggplotsci.html#cb350-48"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb350-49"><a href="plotting-functions-ggplotsci.html#cb350-49"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> x,</span>
<span id="cb350-50"><a href="plotting-functions-ggplotsci.html#cb350-50"></a>         <span class="dt">y =</span> y,</span>
<span id="cb350-51"><a href="plotting-functions-ggplotsci.html#cb350-51"></a>         <span class="dt">color =</span> g) <span class="op">+</span></span>
<span id="cb350-52"><a href="plotting-functions-ggplotsci.html#cb350-52"></a><span class="st">    </span><span class="ot">NULL</span></span>
<span id="cb350-53"><a href="plotting-functions-ggplotsci.html#cb350-53"></a>  </span>
<span id="cb350-54"><a href="plotting-functions-ggplotsci.html#cb350-54"></a>  g_levels &lt;-<span class="st"> </span><span class="kw">levels</span>(dt[, <span class="kw">get</span>(g)])</span>
<span id="cb350-55"><a href="plotting-functions-ggplotsci.html#cb350-55"></a>  new_long[, get <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">get</span>(g)] <span class="co"># not sure how to avoid this</span></span>
<span id="cb350-56"><a href="plotting-functions-ggplotsci.html#cb350-56"></a>  </span>
<span id="cb350-57"><a href="plotting-functions-ggplotsci.html#cb350-57"></a>  <span class="co"># add ci ribbons</span></span>
<span id="cb350-58"><a href="plotting-functions-ggplotsci.html#cb350-58"></a>  <span class="cf">if</span>(add_ci <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){</span>
<span id="cb350-59"><a href="plotting-functions-ggplotsci.html#cb350-59"></a>    <span class="cf">for</span>(g_i <span class="cf">in</span> g_levels){</span>
<span id="cb350-60"><a href="plotting-functions-ggplotsci.html#cb350-60"></a>      gg &lt;-<span class="st"> </span>gg <span class="op">+</span></span>
<span id="cb350-61"><a href="plotting-functions-ggplotsci.html#cb350-61"></a><span class="st">        </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> new_long[get <span class="op">==</span><span class="st"> </span>g_i,],</span>
<span id="cb350-62"><a href="plotting-functions-ggplotsci.html#cb350-62"></a>                    <span class="kw">aes</span>(<span class="dt">ymin =</span> lwr,</span>
<span id="cb350-63"><a href="plotting-functions-ggplotsci.html#cb350-63"></a>                        <span class="dt">ymax =</span> upr,</span>
<span id="cb350-64"><a href="plotting-functions-ggplotsci.html#cb350-64"></a>                        <span class="co">#                     fill = get(g),</span></span>
<span id="cb350-65"><a href="plotting-functions-ggplotsci.html#cb350-65"></a>                        <span class="dt">linetype =</span> <span class="ot">NA</span></span>
<span id="cb350-66"><a href="plotting-functions-ggplotsci.html#cb350-66"></a>                    ),</span>
<span id="cb350-67"><a href="plotting-functions-ggplotsci.html#cb350-67"></a>                    <span class="dt">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb350-68"><a href="plotting-functions-ggplotsci.html#cb350-68"></a>                    <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</span>
<span id="cb350-69"><a href="plotting-functions-ggplotsci.html#cb350-69"></a>    }</span>
<span id="cb350-70"><a href="plotting-functions-ggplotsci.html#cb350-70"></a>  }</span>
<span id="cb350-71"><a href="plotting-functions-ggplotsci.html#cb350-71"></a>  </span>
<span id="cb350-72"><a href="plotting-functions-ggplotsci.html#cb350-72"></a>  <span class="co"># add regression lines</span></span>
<span id="cb350-73"><a href="plotting-functions-ggplotsci.html#cb350-73"></a>  <span class="cf">for</span>(g_i <span class="cf">in</span> g_levels){</span>
<span id="cb350-74"><a href="plotting-functions-ggplotsci.html#cb350-74"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span></span>
<span id="cb350-75"><a href="plotting-functions-ggplotsci.html#cb350-75"></a><span class="st">      </span><span class="kw">geom_path</span>(<span class="dt">data =</span> new_long[get <span class="op">==</span><span class="st"> </span>g_i,],</span>
<span id="cb350-76"><a href="plotting-functions-ggplotsci.html#cb350-76"></a>                <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">get</span>(x),</span>
<span id="cb350-77"><a href="plotting-functions-ggplotsci.html#cb350-77"></a>                    <span class="dt">y =</span> <span class="kw">get</span>(y),</span>
<span id="cb350-78"><a href="plotting-functions-ggplotsci.html#cb350-78"></a>                    <span class="dt">color =</span> <span class="kw">get</span>(g)</span>
<span id="cb350-79"><a href="plotting-functions-ggplotsci.html#cb350-79"></a>                ))</span>
<span id="cb350-80"><a href="plotting-functions-ggplotsci.html#cb350-80"></a>  }</span>
<span id="cb350-81"><a href="plotting-functions-ggplotsci.html#cb350-81"></a>  </span>
<span id="cb350-82"><a href="plotting-functions-ggplotsci.html#cb350-82"></a></span>
<span id="cb350-83"><a href="plotting-functions-ggplotsci.html#cb350-83"></a>  gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="co"># aesthetics</span></span>
<span id="cb350-84"><a href="plotting-functions-ggplotsci.html#cb350-84"></a><span class="st">    </span><span class="kw">xlab</span>(cov_label) <span class="op">+</span></span>
<span id="cb350-85"><a href="plotting-functions-ggplotsci.html#cb350-85"></a><span class="st">    </span><span class="kw">ylab</span>(y_label) <span class="op">+</span></span>
<span id="cb350-86"><a href="plotting-functions-ggplotsci.html#cb350-86"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>pal_nature_mod) <span class="op">+</span></span>
<span id="cb350-87"><a href="plotting-functions-ggplotsci.html#cb350-87"></a><span class="st">    </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb350-88"><a href="plotting-functions-ggplotsci.html#cb350-88"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb350-89"><a href="plotting-functions-ggplotsci.html#cb350-89"></a><span class="st">    </span></span>
<span id="cb350-90"><a href="plotting-functions-ggplotsci.html#cb350-90"></a><span class="st">    </span><span class="ot">NULL</span></span>
<span id="cb350-91"><a href="plotting-functions-ggplotsci.html#cb350-91"></a></span>
<span id="cb350-92"><a href="plotting-functions-ggplotsci.html#cb350-92"></a>  <span class="cf">if</span>(<span class="kw">is.null</span>(p_show)){p_show <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(fit_pairs_dt)}</span>
<span id="cb350-93"><a href="plotting-functions-ggplotsci.html#cb350-93"></a>  <span class="cf">if</span>(<span class="kw">sum</span>(p_show) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){</span>
<span id="cb350-94"><a href="plotting-functions-ggplotsci.html#cb350-94"></a>    <span class="cf">if</span>(p_pos <span class="op">==</span><span class="st"> &quot;center&quot;</span>){</span>
<span id="cb350-95"><a href="plotting-functions-ggplotsci.html#cb350-95"></a>      x_p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">range</span>(dt[, <span class="kw">get</span>(cov_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span>
<span id="cb350-96"><a href="plotting-functions-ggplotsci.html#cb350-96"></a>    }</span>
<span id="cb350-97"><a href="plotting-functions-ggplotsci.html#cb350-97"></a>    <span class="cf">if</span>(p_pos <span class="op">==</span><span class="st"> &quot;left&quot;</span>){</span>
<span id="cb350-98"><a href="plotting-functions-ggplotsci.html#cb350-98"></a>      x_p &lt;-<span class="st"> </span><span class="kw">min</span>(dt[, <span class="kw">get</span>(cov_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">diff</span>(<span class="kw">range</span>(dt[, <span class="kw">get</span>(cov_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))<span class="op">/</span><span class="dv">10</span></span>
<span id="cb350-99"><a href="plotting-functions-ggplotsci.html#cb350-99"></a>    }</span>
<span id="cb350-100"><a href="plotting-functions-ggplotsci.html#cb350-100"></a>    <span class="cf">if</span>(p_pos <span class="op">==</span><span class="st"> &quot;right&quot;</span>){</span>
<span id="cb350-101"><a href="plotting-functions-ggplotsci.html#cb350-101"></a>      x_p &lt;-<span class="st"> </span><span class="kw">max</span>(dt[, <span class="kw">get</span>(cov_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">-</span><span class="st"> </span><span class="kw">diff</span>(<span class="kw">range</span>(dt[, <span class="kw">get</span>(cov_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))<span class="op">/</span><span class="dv">10</span></span>
<span id="cb350-102"><a href="plotting-functions-ggplotsci.html#cb350-102"></a>    }</span>
<span id="cb350-103"><a href="plotting-functions-ggplotsci.html#cb350-103"></a>    </span>
<span id="cb350-104"><a href="plotting-functions-ggplotsci.html#cb350-104"></a>    pos_p &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(p_show)</span>
<span id="cb350-105"><a href="plotting-functions-ggplotsci.html#cb350-105"></a>    max_y &lt;-<span class="st"> </span><span class="kw">max</span>(dt[, <span class="kw">get</span>(y_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb350-106"><a href="plotting-functions-ggplotsci.html#cb350-106"></a>    min_y &lt;-<span class="st"> </span><span class="kw">min</span>(dt[, <span class="kw">get</span>(y_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb350-107"><a href="plotting-functions-ggplotsci.html#cb350-107"></a>    increment &lt;-<span class="st"> </span><span class="fl">0.075</span><span class="op">*</span>(max_y <span class="op">-</span><span class="st"> </span>min_y)</span>
<span id="cb350-108"><a href="plotting-functions-ggplotsci.html#cb350-108"></a></span>
<span id="cb350-109"><a href="plotting-functions-ggplotsci.html#cb350-109"></a>    <span class="cf">for</span>(i <span class="cf">in</span> pos_p){</span>
<span id="cb350-110"><a href="plotting-functions-ggplotsci.html#cb350-110"></a>      y_p &lt;-<span class="st"> </span>max_y <span class="op">+</span><span class="st"> </span>increment<span class="op">*</span>i</span>
<span id="cb350-111"><a href="plotting-functions-ggplotsci.html#cb350-111"></a>      row &lt;-<span class="st"> </span>p_show[i]</span>
<span id="cb350-112"><a href="plotting-functions-ggplotsci.html#cb350-112"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb350-113"><a href="plotting-functions-ggplotsci.html#cb350-113"></a>                        <span class="dt">x =</span> x_p,</span>
<span id="cb350-114"><a href="plotting-functions-ggplotsci.html#cb350-114"></a>                        <span class="dt">y =</span> y_p,</span>
<span id="cb350-115"><a href="plotting-functions-ggplotsci.html#cb350-115"></a>                        <span class="dt">label =</span> <span class="kw">paste0</span>(fit_pairs_dt[row, contrast],</span>
<span id="cb350-116"><a href="plotting-functions-ggplotsci.html#cb350-116"></a>                                       <span class="st">&quot;: &quot;</span>,</span>
<span id="cb350-117"><a href="plotting-functions-ggplotsci.html#cb350-117"></a>                                       fit_pairs_dt[row, p]))</span>
<span id="cb350-118"><a href="plotting-functions-ggplotsci.html#cb350-118"></a>    }</span>
<span id="cb350-119"><a href="plotting-functions-ggplotsci.html#cb350-119"></a>    </span>
<span id="cb350-120"><a href="plotting-functions-ggplotsci.html#cb350-120"></a>   </span>
<span id="cb350-121"><a href="plotting-functions-ggplotsci.html#cb350-121"></a>  }</span>
<span id="cb350-122"><a href="plotting-functions-ggplotsci.html#cb350-122"></a>  </span>
<span id="cb350-123"><a href="plotting-functions-ggplotsci.html#cb350-123"></a>    </span>
<span id="cb350-124"><a href="plotting-functions-ggplotsci.html#cb350-124"></a>    </span>
<span id="cb350-125"><a href="plotting-functions-ggplotsci.html#cb350-125"></a>  </span>
<span id="cb350-126"><a href="plotting-functions-ggplotsci.html#cb350-126"></a>  </span>
<span id="cb350-127"><a href="plotting-functions-ggplotsci.html#cb350-127"></a>  gg</span>
<span id="cb350-128"><a href="plotting-functions-ggplotsci.html#cb350-128"></a>  </span>
<span id="cb350-129"><a href="plotting-functions-ggplotsci.html#cb350-129"></a>  <span class="kw">return</span>(gg)</span>
<span id="cb350-130"><a href="plotting-functions-ggplotsci.html#cb350-130"></a>}</span></code></pre></div>
</div>
<div id="gg_mean_ci_ancova" class="section level2">
<h2><span class="header-section-number">19.7</span> gg_mean_ci_ancova</h2>
<p><code>gg_mean_ci_ancova</code> generates mean-and-CI plots that look like those published in most wet-bench experimental biology papers <em>except</em> that the dots are not the raw y-values but the y-values adjusted for the covariate (here “bw_02_05_18”). I describe this more in the output below.</p>
<p>The arguments to the function are (the bold face arguments are required):</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong> the data.table</li>
<li><strong>x_col</strong> the name of the treatment column (“diet” for this file) containing the treatment groups</li>
<li><strong>y_col</strong> the name of response column (<em>not</em> the column of ratios!)</li>
<li><strong>cov_col</strong>, the name of the column containing the covariate (“bw_02_05_18” for this file)</li>
<li>x_label = “none”, this is the label for the x-axis on the plot. “none” is the default (so no need to include) and results in no label (the plot looks better without it)</li>
<li>y_label = “Response (units)”, this is the label for the y-axis on the plot. You do want to replace the default with something meaningful and sense the y-variable is the <em>adjusted</em> response, it is important to include this in the label, so something like: y_label = “adj. SCAT (g)”</li>
<li>dots = “sina”, this controls how the dots are plotted. “sina” is clever.</li>
<li>dodge_width = 0.8, this controls how closely spaced the groups are in the plot</li>
<li>adjust = 0.5, this controls how wide the dots within each group</li>
<li>p_adjust = “none”, this controls p-value adjustment for multiple comparisons. This doesn’t matter for these data because there are only 2 groups in the diet treatment, so only 1 comparison (MR - CN).</li>
</ol>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="plotting-functions-ggplotsci.html#cb351-1"></a>gg_mean_ci_ancova &lt;-<span class="st"> </span><span class="cf">function</span>(data,</span>
<span id="cb351-2"><a href="plotting-functions-ggplotsci.html#cb351-2"></a>                       x_col,</span>
<span id="cb351-3"><a href="plotting-functions-ggplotsci.html#cb351-3"></a>                       y_col,</span>
<span id="cb351-4"><a href="plotting-functions-ggplotsci.html#cb351-4"></a>                       cov_col,</span>
<span id="cb351-5"><a href="plotting-functions-ggplotsci.html#cb351-5"></a>                       <span class="dt">x_label =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb351-6"><a href="plotting-functions-ggplotsci.html#cb351-6"></a>                       <span class="dt">y_label =</span> <span class="st">&quot;Response (units)&quot;</span>,</span>
<span id="cb351-7"><a href="plotting-functions-ggplotsci.html#cb351-7"></a>                       <span class="dt">dots =</span> <span class="st">&quot;sina&quot;</span>,</span>
<span id="cb351-8"><a href="plotting-functions-ggplotsci.html#cb351-8"></a>                       <span class="dt">dodge_width =</span> <span class="fl">0.8</span>,</span>
<span id="cb351-9"><a href="plotting-functions-ggplotsci.html#cb351-9"></a>                       <span class="dt">adjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb351-10"><a href="plotting-functions-ggplotsci.html#cb351-10"></a>                       <span class="dt">p_adjust =</span> <span class="st">&quot;none&quot;</span>){</span>
<span id="cb351-11"><a href="plotting-functions-ggplotsci.html#cb351-11"></a>  </span>
<span id="cb351-12"><a href="plotting-functions-ggplotsci.html#cb351-12"></a>  dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(data)[, .SD, .SDcols =<span class="st"> </span><span class="kw">c</span>(x_col, y_col, cov_col)]</span>
<span id="cb351-13"><a href="plotting-functions-ggplotsci.html#cb351-13"></a>  ref_group &lt;-<span class="st"> </span><span class="kw">levels</span>(dt[, <span class="kw">get</span>(x_col)])[<span class="dv">1</span>]</span>
<span id="cb351-14"><a href="plotting-functions-ggplotsci.html#cb351-14"></a>  </span>
<span id="cb351-15"><a href="plotting-functions-ggplotsci.html#cb351-15"></a>  <span class="co"># center the covariate by the mean of the reference, </span></span>
<span id="cb351-16"><a href="plotting-functions-ggplotsci.html#cb351-16"></a>  <span class="co"># which means the intercept of the model will be EXP[Y]_ref</span></span>
<span id="cb351-17"><a href="plotting-functions-ggplotsci.html#cb351-17"></a>  <span class="co"># at the average value of the covariate</span></span>
<span id="cb351-18"><a href="plotting-functions-ggplotsci.html#cb351-18"></a>  mean_cov_ref &lt;-<span class="st"> </span><span class="kw">mean</span>(dt[<span class="kw">get</span>(x_col)<span class="op">==</span>ref_group, <span class="kw">get</span>(cov_col)])</span>
<span id="cb351-19"><a href="plotting-functions-ggplotsci.html#cb351-19"></a>  dt[, cov_col_c <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">get</span>(cov_col) <span class="op">-</span><span class="st"> </span>mean_cov_ref]</span>
<span id="cb351-20"><a href="plotting-functions-ggplotsci.html#cb351-20"></a>  cov_col_c &lt;-<span class="st"> </span><span class="kw">paste0</span>(cov_col, <span class="st">&quot;_c&quot;</span>)</span>
<span id="cb351-21"><a href="plotting-functions-ggplotsci.html#cb351-21"></a>  <span class="kw">setnames</span>(dt, <span class="dt">old =</span> <span class="st">&quot;cov_col_c&quot;</span>, <span class="dt">new =</span> cov_col_c)</span>
<span id="cb351-22"><a href="plotting-functions-ggplotsci.html#cb351-22"></a>  </span>
<span id="cb351-23"><a href="plotting-functions-ggplotsci.html#cb351-23"></a>  <span class="co"># two ways for computing adjusted y</span></span>
<span id="cb351-24"><a href="plotting-functions-ggplotsci.html#cb351-24"></a>  <span class="co"># &quot;xside_xxx&quot; is the &quot;x side&quot; of the formula</span></span>
<span id="cb351-25"><a href="plotting-functions-ggplotsci.html#cb351-25"></a>  <span class="co"># xside_1 doesn&#39;t use centered covariate but uses predicted value at mean covariate</span></span>
<span id="cb351-26"><a href="plotting-functions-ggplotsci.html#cb351-26"></a>  <span class="co"># xside_2 uses the centered covariate</span></span>
<span id="cb351-27"><a href="plotting-functions-ggplotsci.html#cb351-27"></a>  xside_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">c</span>(cov_col, x_col), <span class="dt">collapse =</span> <span class="st">&quot; + &quot;</span>)</span>
<span id="cb351-28"><a href="plotting-functions-ggplotsci.html#cb351-28"></a>  xside_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">c</span>(cov_col_c, x_col), <span class="dt">collapse =</span> <span class="st">&quot; + &quot;</span>)</span>
<span id="cb351-29"><a href="plotting-functions-ggplotsci.html#cb351-29"></a>  </span>
<span id="cb351-30"><a href="plotting-functions-ggplotsci.html#cb351-30"></a>  form1 &lt;-<span class="st"> </span><span class="kw">formula</span>(<span class="kw">paste</span>(y_col, <span class="st">&quot;~&quot;</span>, xside_<span class="dv">1</span>))</span>
<span id="cb351-31"><a href="plotting-functions-ggplotsci.html#cb351-31"></a>  form2 &lt;-<span class="st"> </span><span class="kw">formula</span>(<span class="kw">paste</span>(y_col, <span class="st">&quot;~&quot;</span>, xside_<span class="dv">2</span>))</span>
<span id="cb351-32"><a href="plotting-functions-ggplotsci.html#cb351-32"></a>  </span>
<span id="cb351-33"><a href="plotting-functions-ggplotsci.html#cb351-33"></a>  m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(form1, <span class="dt">data =</span> dt)</span>
<span id="cb351-34"><a href="plotting-functions-ggplotsci.html#cb351-34"></a>  m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(form2, <span class="dt">data =</span> dt)</span>
<span id="cb351-35"><a href="plotting-functions-ggplotsci.html#cb351-35"></a></span>
<span id="cb351-36"><a href="plotting-functions-ggplotsci.html#cb351-36"></a>  <span class="co"># using model 2 - centered covariate in model</span></span>
<span id="cb351-37"><a href="plotting-functions-ggplotsci.html#cb351-37"></a>  b &lt;-<span class="st"> </span><span class="kw">coef</span>(m2)</span>
<span id="cb351-38"><a href="plotting-functions-ggplotsci.html#cb351-38"></a>  dummy &lt;-<span class="st"> </span><span class="kw">as.integer</span>(dt[, <span class="kw">get</span>(x_col)]) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb351-39"><a href="plotting-functions-ggplotsci.html#cb351-39"></a>  dt[, y_cond <span class="op">:</span><span class="er">=</span><span class="st"> </span>b[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>b[<span class="dv">3</span>]<span class="op">*</span>dummy <span class="op">+</span><span class="st"> </span><span class="kw">residuals</span>(m2)]</span>
<span id="cb351-40"><a href="plotting-functions-ggplotsci.html#cb351-40"></a>  </span>
<span id="cb351-41"><a href="plotting-functions-ggplotsci.html#cb351-41"></a>  <span class="co"># using model 1 - prediction at mean covariate</span></span>
<span id="cb351-42"><a href="plotting-functions-ggplotsci.html#cb351-42"></a>  new_data &lt;-<span class="st"> </span><span class="kw">copy</span>(dt)</span>
<span id="cb351-43"><a href="plotting-functions-ggplotsci.html#cb351-43"></a>  new_data[, bw_<span class="dv">02</span>_<span class="dv">05</span>_<span class="dv">18</span> <span class="op">:</span><span class="er">=</span><span class="st"> </span>mean_cov_ref]</span>
<span id="cb351-44"><a href="plotting-functions-ggplotsci.html#cb351-44"></a>  dt[, y_cond2 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">predict</span>(m1, new_data) <span class="op">+</span><span class="st"> </span><span class="kw">residuals</span>(m1)]</span>
<span id="cb351-45"><a href="plotting-functions-ggplotsci.html#cb351-45"></a>  </span>
<span id="cb351-46"><a href="plotting-functions-ggplotsci.html#cb351-46"></a>  <span class="co"># emmeans</span></span>
<span id="cb351-47"><a href="plotting-functions-ggplotsci.html#cb351-47"></a>  temp_emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(m1,</span>
<span id="cb351-48"><a href="plotting-functions-ggplotsci.html#cb351-48"></a>                     <span class="dt">specs =</span> x_col) <span class="op">%&gt;%</span></span>
<span id="cb351-49"><a href="plotting-functions-ggplotsci.html#cb351-49"></a><span class="st">    </span><span class="kw">summary</span>() <span class="op">%&gt;%</span></span>
<span id="cb351-50"><a href="plotting-functions-ggplotsci.html#cb351-50"></a><span class="st">    </span><span class="kw">data.table</span>()</span>
<span id="cb351-51"><a href="plotting-functions-ggplotsci.html#cb351-51"></a>  emm_offset &lt;-<span class="st"> </span>b[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>temp_emm[<span class="kw">get</span>(x_col) <span class="op">==</span><span class="st"> </span>ref_group, emmean]</span>
<span id="cb351-52"><a href="plotting-functions-ggplotsci.html#cb351-52"></a>  </span>
<span id="cb351-53"><a href="plotting-functions-ggplotsci.html#cb351-53"></a>  fit_emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(m1,</span>
<span id="cb351-54"><a href="plotting-functions-ggplotsci.html#cb351-54"></a>                     <span class="dt">specs =</span> x_col,</span>
<span id="cb351-55"><a href="plotting-functions-ggplotsci.html#cb351-55"></a>                     <span class="dt">offset =</span> emm_offset)</span>
<span id="cb351-56"><a href="plotting-functions-ggplotsci.html#cb351-56"></a>  </span>
<span id="cb351-57"><a href="plotting-functions-ggplotsci.html#cb351-57"></a>  fit_pairs &lt;-<span class="st"> </span><span class="kw">contrast</span>(fit_emm,</span>
<span id="cb351-58"><a href="plotting-functions-ggplotsci.html#cb351-58"></a>                        <span class="dt">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb351-59"><a href="plotting-functions-ggplotsci.html#cb351-59"></a>                        <span class="dt">adjust =</span> p_adjust) <span class="op">%&gt;%</span></span>
<span id="cb351-60"><a href="plotting-functions-ggplotsci.html#cb351-60"></a><span class="st">    </span><span class="kw">summary</span>(<span class="dt">infer =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>))</span>
<span id="cb351-61"><a href="plotting-functions-ggplotsci.html#cb351-61"></a>  </span>
<span id="cb351-62"><a href="plotting-functions-ggplotsci.html#cb351-62"></a>  fit_emm_dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="kw">summary</span>(fit_emm))</span>
<span id="cb351-63"><a href="plotting-functions-ggplotsci.html#cb351-63"></a>  fit_pairs_dt &lt;-<span class="st"> </span><span class="kw">pairs_table</span>(<span class="kw">data.table</span>(fit_pairs))</span>
<span id="cb351-64"><a href="plotting-functions-ggplotsci.html#cb351-64"></a>  </span>
<span id="cb351-65"><a href="plotting-functions-ggplotsci.html#cb351-65"></a>  x_col1 &lt;-<span class="st"> </span>x_col[<span class="dv">1</span>]</span>
<span id="cb351-66"><a href="plotting-functions-ggplotsci.html#cb351-66"></a>  <span class="cf">if</span>(<span class="kw">length</span>(x_col)<span class="op">==</span><span class="dv">2</span>){</span>
<span id="cb351-67"><a href="plotting-functions-ggplotsci.html#cb351-67"></a>    g_col &lt;-<span class="st"> </span>x_col[<span class="dv">2</span>]</span>
<span id="cb351-68"><a href="plotting-functions-ggplotsci.html#cb351-68"></a>  }<span class="cf">else</span>{</span>
<span id="cb351-69"><a href="plotting-functions-ggplotsci.html#cb351-69"></a>    g_col &lt;-<span class="st"> </span>x_col[<span class="dv">1</span>]</span>
<span id="cb351-70"><a href="plotting-functions-ggplotsci.html#cb351-70"></a>  }</span>
<span id="cb351-71"><a href="plotting-functions-ggplotsci.html#cb351-71"></a>  </span>
<span id="cb351-72"><a href="plotting-functions-ggplotsci.html#cb351-72"></a>  <span class="cf">if</span>(g_col <span class="op">==</span><span class="st"> </span>x_col1){</span>
<span id="cb351-73"><a href="plotting-functions-ggplotsci.html#cb351-73"></a>    pd &lt;-<span class="st"> </span><span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="dv">0</span>)</span>
<span id="cb351-74"><a href="plotting-functions-ggplotsci.html#cb351-74"></a>  }<span class="cf">else</span>{</span>
<span id="cb351-75"><a href="plotting-functions-ggplotsci.html#cb351-75"></a>    pd &lt;-<span class="st"> </span><span class="kw">position_dodge</span>(<span class="dt">width =</span> dodge_width)</span>
<span id="cb351-76"><a href="plotting-functions-ggplotsci.html#cb351-76"></a>  }</span>
<span id="cb351-77"><a href="plotting-functions-ggplotsci.html#cb351-77"></a>  </span>
<span id="cb351-78"><a href="plotting-functions-ggplotsci.html#cb351-78"></a>  gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>dt, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">get</span>(x_col1),</span>
<span id="cb351-79"><a href="plotting-functions-ggplotsci.html#cb351-79"></a>                            <span class="dt">y =</span> y_cond,</span>
<span id="cb351-80"><a href="plotting-functions-ggplotsci.html#cb351-80"></a>                            <span class="dt">color =</span> <span class="kw">get</span>(g_col)))</span>
<span id="cb351-81"><a href="plotting-functions-ggplotsci.html#cb351-81"></a>    <span class="co"># plot points</span></span>
<span id="cb351-82"><a href="plotting-functions-ggplotsci.html#cb351-82"></a>    <span class="cf">if</span>(dots <span class="op">==</span><span class="st"> &quot;sina&quot;</span>){</span>
<span id="cb351-83"><a href="plotting-functions-ggplotsci.html#cb351-83"></a>      gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">geom_sina</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb351-84"><a href="plotting-functions-ggplotsci.html#cb351-84"></a>                <span class="dt">position =</span> pd,</span>
<span id="cb351-85"><a href="plotting-functions-ggplotsci.html#cb351-85"></a>                <span class="dt">adjust =</span> adjust)</span>
<span id="cb351-86"><a href="plotting-functions-ggplotsci.html#cb351-86"></a>      </span>
<span id="cb351-87"><a href="plotting-functions-ggplotsci.html#cb351-87"></a>    }</span>
<span id="cb351-88"><a href="plotting-functions-ggplotsci.html#cb351-88"></a>    <span class="cf">if</span>(dots <span class="op">==</span><span class="st"> &quot;jitter&quot;</span>){</span>
<span id="cb351-89"><a href="plotting-functions-ggplotsci.html#cb351-89"></a>      gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">geom_dotplot</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb351-90"><a href="plotting-functions-ggplotsci.html#cb351-90"></a>                <span class="dt">position =</span> pd)</span>
<span id="cb351-91"><a href="plotting-functions-ggplotsci.html#cb351-91"></a>      </span>
<span id="cb351-92"><a href="plotting-functions-ggplotsci.html#cb351-92"></a>    }</span>
<span id="cb351-93"><a href="plotting-functions-ggplotsci.html#cb351-93"></a>  </span>
<span id="cb351-94"><a href="plotting-functions-ggplotsci.html#cb351-94"></a>  <span class="co"># plot means and CI</span></span>
<span id="cb351-95"><a href="plotting-functions-ggplotsci.html#cb351-95"></a>  gg &lt;-<span class="st"> </span>gg <span class="op">+</span></span>
<span id="cb351-96"><a href="plotting-functions-ggplotsci.html#cb351-96"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> fit_emm_dt, <span class="kw">aes</span>(<span class="dt">y =</span> emmean,</span>
<span id="cb351-97"><a href="plotting-functions-ggplotsci.html#cb351-97"></a>                                           <span class="dt">ymin =</span> lower.CL,</span>
<span id="cb351-98"><a href="plotting-functions-ggplotsci.html#cb351-98"></a>                                           <span class="dt">ymax =</span> upper.CL,</span>
<span id="cb351-99"><a href="plotting-functions-ggplotsci.html#cb351-99"></a>                                        <span class="dt">color =</span> <span class="kw">get</span>(g_col)),</span>
<span id="cb351-100"><a href="plotting-functions-ggplotsci.html#cb351-100"></a>               <span class="dt">width =</span> <span class="dv">0</span>,</span>
<span id="cb351-101"><a href="plotting-functions-ggplotsci.html#cb351-101"></a>              <span class="dt">position =</span> pd</span>
<span id="cb351-102"><a href="plotting-functions-ggplotsci.html#cb351-102"></a>    ) <span class="op">+</span></span>
<span id="cb351-103"><a href="plotting-functions-ggplotsci.html#cb351-103"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> fit_emm_dt, <span class="kw">aes</span>(<span class="dt">y =</span> emmean,</span>
<span id="cb351-104"><a href="plotting-functions-ggplotsci.html#cb351-104"></a>                                        <span class="dt">color =</span> <span class="kw">get</span>(g_col)),</span>
<span id="cb351-105"><a href="plotting-functions-ggplotsci.html#cb351-105"></a>               <span class="dt">size =</span> <span class="dv">3</span>,</span>
<span id="cb351-106"><a href="plotting-functions-ggplotsci.html#cb351-106"></a>              <span class="dt">position =</span> pd</span>
<span id="cb351-107"><a href="plotting-functions-ggplotsci.html#cb351-107"></a>    ) <span class="op">+</span></span>
<span id="cb351-108"><a href="plotting-functions-ggplotsci.html#cb351-108"></a><span class="st">    </span></span>
<span id="cb351-109"><a href="plotting-functions-ggplotsci.html#cb351-109"></a><span class="st">    </span><span class="co"># aesthetics</span></span>
<span id="cb351-110"><a href="plotting-functions-ggplotsci.html#cb351-110"></a><span class="st">    </span><span class="kw">ylab</span>(y_label) <span class="op">+</span></span>
<span id="cb351-111"><a href="plotting-functions-ggplotsci.html#cb351-111"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>pal_nature_mod) <span class="op">+</span></span>
<span id="cb351-112"><a href="plotting-functions-ggplotsci.html#cb351-112"></a><span class="st">    </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb351-113"><a href="plotting-functions-ggplotsci.html#cb351-113"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb351-114"><a href="plotting-functions-ggplotsci.html#cb351-114"></a><span class="st">    </span></span>
<span id="cb351-115"><a href="plotting-functions-ggplotsci.html#cb351-115"></a><span class="st">    </span><span class="ot">NULL</span></span>
<span id="cb351-116"><a href="plotting-functions-ggplotsci.html#cb351-116"></a>  </span>
<span id="cb351-117"><a href="plotting-functions-ggplotsci.html#cb351-117"></a>  <span class="co"># add p-value</span></span>
<span id="cb351-118"><a href="plotting-functions-ggplotsci.html#cb351-118"></a>  y_positions &lt;-<span class="st"> </span><span class="kw">max</span>(dt[, y_cond]) <span class="op">+</span><span class="st"> </span></span>
<span id="cb351-119"><a href="plotting-functions-ggplotsci.html#cb351-119"></a><span class="st">    </span><span class="fl">0.075</span><span class="op">*</span>(<span class="kw">max</span>(dt[, y_cond]) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(dt[, y_cond]))</span>
<span id="cb351-120"><a href="plotting-functions-ggplotsci.html#cb351-120"></a>  gg &lt;-<span class="st"> </span>gg <span class="op">+</span></span>
<span id="cb351-121"><a href="plotting-functions-ggplotsci.html#cb351-121"></a><span class="st">    </span><span class="kw">stat_pvalue_manual</span>(fit_pairs_dt, <span class="co"># only show sox effects</span></span>
<span id="cb351-122"><a href="plotting-functions-ggplotsci.html#cb351-122"></a>                       <span class="dt">label =</span> <span class="st">&quot;p&quot;</span>, </span>
<span id="cb351-123"><a href="plotting-functions-ggplotsci.html#cb351-123"></a>                       <span class="dt">y.position=</span>y_positions)</span>
<span id="cb351-124"><a href="plotting-functions-ggplotsci.html#cb351-124"></a>  </span>
<span id="cb351-125"><a href="plotting-functions-ggplotsci.html#cb351-125"></a>  <span class="co"># make sure ylim includes p-value</span></span>
<span id="cb351-126"><a href="plotting-functions-ggplotsci.html#cb351-126"></a>  ymax &lt;-<span class="st"> </span><span class="kw">max</span>(dt[, y_cond])</span>
<span id="cb351-127"><a href="plotting-functions-ggplotsci.html#cb351-127"></a>  ymin &lt;-<span class="st"> </span><span class="kw">min</span>(dt[, y_cond])</span>
<span id="cb351-128"><a href="plotting-functions-ggplotsci.html#cb351-128"></a>  y_hi &lt;-<span class="st"> </span>ymax <span class="op">+</span><span class="st"> </span><span class="fl">0.115</span><span class="op">*</span>(ymax <span class="op">-</span><span class="st"> </span>ymin)</span>
<span id="cb351-129"><a href="plotting-functions-ggplotsci.html#cb351-129"></a>  y_lo &lt;-<span class="st"> </span>ymin <span class="op">-</span><span class="st"> </span><span class="fl">0.05</span><span class="op">*</span>(ymax <span class="op">-</span><span class="st"> </span>ymin)</span>
<span id="cb351-130"><a href="plotting-functions-ggplotsci.html#cb351-130"></a>  gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(</span>
<span id="cb351-131"><a href="plotting-functions-ggplotsci.html#cb351-131"></a>    <span class="dt">ylim =</span> <span class="kw">c</span>(y_lo, y_hi),</span>
<span id="cb351-132"><a href="plotting-functions-ggplotsci.html#cb351-132"></a>  )  </span>
<span id="cb351-133"><a href="plotting-functions-ggplotsci.html#cb351-133"></a>  </span>
<span id="cb351-134"><a href="plotting-functions-ggplotsci.html#cb351-134"></a>  <span class="co"># remove x axis title</span></span>
<span id="cb351-135"><a href="plotting-functions-ggplotsci.html#cb351-135"></a>  <span class="cf">if</span>(x_label <span class="op">==</span><span class="st"> &quot;none&quot;</span>){</span>
<span id="cb351-136"><a href="plotting-functions-ggplotsci.html#cb351-136"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>())</span>
<span id="cb351-137"><a href="plotting-functions-ggplotsci.html#cb351-137"></a>  }<span class="cf">else</span>{</span>
<span id="cb351-138"><a href="plotting-functions-ggplotsci.html#cb351-138"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(x_label)}</span>
<span id="cb351-139"><a href="plotting-functions-ggplotsci.html#cb351-139"></a>  </span>
<span id="cb351-140"><a href="plotting-functions-ggplotsci.html#cb351-140"></a>  gg</span>
<span id="cb351-141"><a href="plotting-functions-ggplotsci.html#cb351-141"></a>  </span>
<span id="cb351-142"><a href="plotting-functions-ggplotsci.html#cb351-142"></a>  <span class="kw">return</span>(gg)</span>
<span id="cb351-143"><a href="plotting-functions-ggplotsci.html#cb351-143"></a>}</span></code></pre></div>
</div>
<div id="gg_effects" class="section level2">
<h2><span class="header-section-number">19.8</span> gg_effects</h2>
<p><code>gg_effects</code> generates an “effects” plot, which is common in the clinical medicine but not experimental biology literature. This is a function that you would directly call in the analysis pipeline if you wanted plots like these. The arguments to the function are (the bold face arguments are required):</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong> the data.table</li>
<li><strong>x_col</strong> the name of the treatment column (“diet” for this file) containing the treatment groups</li>
<li><strong>y_col</strong> the name of response column (<em>not</em> the column of ratios!)</li>
<li><strong>cov_col</strong>, the name of the column containing the covariate (“bw_02_05_18” for this file)</li>
<li>x_label = “none”, this is the label for the x-axis on the plot which is the name of the covariate column. You do want to replace the default with something meaningful. For these data, something like: cov_label = “Body Mass (g)”</li>
<li>y_label = “contrast”, this is the label for the y-axis on the plot. You do want to replace the default with something meaningful like: y_label = “SCAT (g)”</li>
<li>p_adjust = “none”, this controls p-value adjustment for multiple comparisons. This doesn’t matter for these data because there are only 2 groups in the diet treatment, so only 1 comparison (MR - CN).</li>
</ol>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="plotting-functions-ggplotsci.html#cb352-1"></a>gg_effects &lt;-<span class="st"> </span><span class="cf">function</span>(data,</span>
<span id="cb352-2"><a href="plotting-functions-ggplotsci.html#cb352-2"></a>                       x_col,</span>
<span id="cb352-3"><a href="plotting-functions-ggplotsci.html#cb352-3"></a>                       y_col,</span>
<span id="cb352-4"><a href="plotting-functions-ggplotsci.html#cb352-4"></a>                       cov_col,</span>
<span id="cb352-5"><a href="plotting-functions-ggplotsci.html#cb352-5"></a>                       <span class="dt">x_label =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb352-6"><a href="plotting-functions-ggplotsci.html#cb352-6"></a>                       <span class="dt">y_label =</span> <span class="st">&quot;contrast&quot;</span>,</span>
<span id="cb352-7"><a href="plotting-functions-ggplotsci.html#cb352-7"></a>                       <span class="dt">p_adjust =</span> <span class="st">&quot;none&quot;</span>){</span>
<span id="cb352-8"><a href="plotting-functions-ggplotsci.html#cb352-8"></a>  </span>
<span id="cb352-9"><a href="plotting-functions-ggplotsci.html#cb352-9"></a>  dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(data)[, .SD, .SDcols =<span class="st"> </span><span class="kw">c</span>(x_col, y_col, cov_col)]</span>
<span id="cb352-10"><a href="plotting-functions-ggplotsci.html#cb352-10"></a></span>
<span id="cb352-11"><a href="plotting-functions-ggplotsci.html#cb352-11"></a>  xside_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">c</span>(cov_col, x_col), <span class="dt">collapse =</span> <span class="st">&quot; + &quot;</span>)</span>
<span id="cb352-12"><a href="plotting-functions-ggplotsci.html#cb352-12"></a></span>
<span id="cb352-13"><a href="plotting-functions-ggplotsci.html#cb352-13"></a>  form1 &lt;-<span class="st"> </span><span class="kw">formula</span>(<span class="kw">paste</span>(y_col, <span class="st">&quot;~&quot;</span>, xside_<span class="dv">1</span>))</span>
<span id="cb352-14"><a href="plotting-functions-ggplotsci.html#cb352-14"></a></span>
<span id="cb352-15"><a href="plotting-functions-ggplotsci.html#cb352-15"></a>  m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(form1, <span class="dt">data =</span> dt)</span>
<span id="cb352-16"><a href="plotting-functions-ggplotsci.html#cb352-16"></a></span>
<span id="cb352-17"><a href="plotting-functions-ggplotsci.html#cb352-17"></a>  fit_emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(m1,</span>
<span id="cb352-18"><a href="plotting-functions-ggplotsci.html#cb352-18"></a>                     <span class="dt">specs =</span> x_col)</span>
<span id="cb352-19"><a href="plotting-functions-ggplotsci.html#cb352-19"></a>  </span>
<span id="cb352-20"><a href="plotting-functions-ggplotsci.html#cb352-20"></a>  fit_pairs &lt;-<span class="st"> </span><span class="kw">contrast</span>(fit_emm,</span>
<span id="cb352-21"><a href="plotting-functions-ggplotsci.html#cb352-21"></a>                        <span class="dt">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb352-22"><a href="plotting-functions-ggplotsci.html#cb352-22"></a>                        <span class="dt">adjust =</span> p_adjust) <span class="op">%&gt;%</span></span>
<span id="cb352-23"><a href="plotting-functions-ggplotsci.html#cb352-23"></a><span class="st">    </span><span class="kw">summary</span>(<span class="dt">infer =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>))</span>
<span id="cb352-24"><a href="plotting-functions-ggplotsci.html#cb352-24"></a>  </span>
<span id="cb352-25"><a href="plotting-functions-ggplotsci.html#cb352-25"></a>  fit_emm_dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="kw">summary</span>(fit_emm))</span>
<span id="cb352-26"><a href="plotting-functions-ggplotsci.html#cb352-26"></a>  fit_effect &lt;-<span class="st"> </span><span class="kw">pairs_table</span>(<span class="kw">data.table</span>(fit_pairs))</span>
<span id="cb352-27"><a href="plotting-functions-ggplotsci.html#cb352-27"></a>  </span>
<span id="cb352-28"><a href="plotting-functions-ggplotsci.html#cb352-28"></a>  <span class="cf">if</span>(y_label <span class="op">==</span><span class="st"> &quot;contrast&quot;</span>){</span>
<span id="cb352-29"><a href="plotting-functions-ggplotsci.html#cb352-29"></a>    y_label &lt;-<span class="st"> </span>fit_effect[<span class="dv">1</span>, contrast]</span>
<span id="cb352-30"><a href="plotting-functions-ggplotsci.html#cb352-30"></a>  }</span>
<span id="cb352-31"><a href="plotting-functions-ggplotsci.html#cb352-31"></a>  </span>
<span id="cb352-32"><a href="plotting-functions-ggplotsci.html#cb352-32"></a>  fit_effect[, contrast <span class="op">:</span><span class="er">=</span><span class="st"> </span>x_label]</span>
<span id="cb352-33"><a href="plotting-functions-ggplotsci.html#cb352-33"></a>  <span class="co"># # fit_effect[, contrast_pretty := paste(group1, &quot;\n-&quot;, group2)]</span></span>
<span id="cb352-34"><a href="plotting-functions-ggplotsci.html#cb352-34"></a>  <span class="co"># # fit_effect[, contrast_pretty := paste(group1, &quot;\n minus \n&quot;, group2)]</span></span>
<span id="cb352-35"><a href="plotting-functions-ggplotsci.html#cb352-35"></a>  <span class="co"># if(is.null(y_label)){</span></span>
<span id="cb352-36"><a href="plotting-functions-ggplotsci.html#cb352-36"></a>  <span class="co">#   y_label &lt;- &quot;Difference in means (units)&quot;</span></span>
<span id="cb352-37"><a href="plotting-functions-ggplotsci.html#cb352-37"></a>  <span class="co"># }</span></span>
<span id="cb352-38"><a href="plotting-functions-ggplotsci.html#cb352-38"></a>  </span>
<span id="cb352-39"><a href="plotting-functions-ggplotsci.html#cb352-39"></a>  min_bound &lt;-<span class="st"> </span><span class="kw">min</span>(fit_effect[, lower.CL])</span>
<span id="cb352-40"><a href="plotting-functions-ggplotsci.html#cb352-40"></a>  max_bound &lt;-<span class="st"> </span><span class="kw">min</span>(fit_effect[, upper.CL])</span>
<span id="cb352-41"><a href="plotting-functions-ggplotsci.html#cb352-41"></a>  y_lo &lt;-<span class="st"> </span><span class="kw">min</span>(min_bound<span class="op">+</span>min_bound<span class="op">*</span><span class="fl">0.2</span>,</span>
<span id="cb352-42"><a href="plotting-functions-ggplotsci.html#cb352-42"></a>              <span class="op">-</span>max_bound)</span>
<span id="cb352-43"><a href="plotting-functions-ggplotsci.html#cb352-43"></a>  y_hi &lt;-<span class="st"> </span><span class="kw">max</span>(max_bound <span class="op">+</span><span class="st"> </span>max_bound<span class="op">*</span><span class="fl">0.2</span>,</span>
<span id="cb352-44"><a href="plotting-functions-ggplotsci.html#cb352-44"></a>              <span class="op">-</span>min_bound)</span>
<span id="cb352-45"><a href="plotting-functions-ggplotsci.html#cb352-45"></a>  y_lims &lt;-<span class="st"> </span><span class="kw">c</span>(y_lo, y_hi)</span>
<span id="cb352-46"><a href="plotting-functions-ggplotsci.html#cb352-46"></a>  </span>
<span id="cb352-47"><a href="plotting-functions-ggplotsci.html#cb352-47"></a>  gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>fit_effect, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">fct_rev</span>(contrast),</span>
<span id="cb352-48"><a href="plotting-functions-ggplotsci.html#cb352-48"></a>                                    <span class="dt">y =</span> estimate)) <span class="op">+</span></span>
<span id="cb352-49"><a href="plotting-functions-ggplotsci.html#cb352-49"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>lower.CL, </span>
<span id="cb352-50"><a href="plotting-functions-ggplotsci.html#cb352-50"></a>                      <span class="dt">ymax=</span>upper.CL),</span>
<span id="cb352-51"><a href="plotting-functions-ggplotsci.html#cb352-51"></a>                  <span class="dt">width=</span><span class="dv">0</span>, </span>
<span id="cb352-52"><a href="plotting-functions-ggplotsci.html#cb352-52"></a>                  <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb352-53"><a href="plotting-functions-ggplotsci.html#cb352-53"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb352-54"><a href="plotting-functions-ggplotsci.html#cb352-54"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb352-55"><a href="plotting-functions-ggplotsci.html#cb352-55"></a><span class="st">    </span><span class="kw">coord_flip</span>(<span class="dt">ylim =</span> y_lims) <span class="op">+</span><span class="st"> </span></span>
<span id="cb352-56"><a href="plotting-functions-ggplotsci.html#cb352-56"></a><span class="st">    </span><span class="co">#coord_flip() + </span></span>
<span id="cb352-57"><a href="plotting-functions-ggplotsci.html#cb352-57"></a><span class="st">    </span><span class="co">#scale_y_continuous(position=&quot;right&quot;) +</span></span>
<span id="cb352-58"><a href="plotting-functions-ggplotsci.html#cb352-58"></a><span class="st">    </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb352-59"><a href="plotting-functions-ggplotsci.html#cb352-59"></a><span class="st">    </span><span class="kw">ylab</span>(y_label) <span class="op">+</span></span>
<span id="cb352-60"><a href="plotting-functions-ggplotsci.html#cb352-60"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb352-61"><a href="plotting-functions-ggplotsci.html#cb352-61"></a><span class="st">    </span><span class="ot">NULL</span></span>
<span id="cb352-62"><a href="plotting-functions-ggplotsci.html#cb352-62"></a>  gg</span>
<span id="cb352-63"><a href="plotting-functions-ggplotsci.html#cb352-63"></a>  </span>
<span id="cb352-64"><a href="plotting-functions-ggplotsci.html#cb352-64"></a>  <span class="kw">return</span>(gg)</span>
<span id="cb352-65"><a href="plotting-functions-ggplotsci.html#cb352-65"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="plotting-functions-ggplotsci.html#cb353-1"></a>gg_multiple_effects &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb353-2"><a href="plotting-functions-ggplotsci.html#cb353-2"></a>  </span>
<span id="cb353-3"><a href="plotting-functions-ggplotsci.html#cb353-3"></a>}</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix-1-getting-started-with-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/82-ggplotsci.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
