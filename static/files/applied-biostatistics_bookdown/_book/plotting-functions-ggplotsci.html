<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 22 Plotting functions (#ggplotsci) | Elements of Statistical Modeling for Experimental Biology</title>
  <meta name="description" content="A first course in statistical modeling for experimental biology researchers" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 22 Plotting functions (#ggplotsci) | Elements of Statistical Modeling for Experimental Biology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A first course in statistical modeling for experimental biology researchers" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 22 Plotting functions (#ggplotsci) | Elements of Statistical Modeling for Experimental Biology" />
  
  <meta name="twitter:description" content="A first course in statistical modeling for experimental biology researchers" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"/>
<link rel="next" href="appendix-1-getting-started-with-r.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#math"><i class="fa fa-check"></i><b>0.1</b> Math</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#r-and-programming"><i class="fa fa-check"></i><b>0.2</b> R and programming</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-getting-started.html"><a href="part-i-getting-started.html"><i class="fa fa-check"></i>Part I: Getting Started</a></li>
<li class="chapter" data-level="1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html"><i class="fa fa-check"></i><b>1</b> Getting Started – R Projects and R Markdown</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-vs-r-studio"><i class="fa fa-check"></i><b>1.1</b> R vs R Studio</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#download-and-install-r-and-r-studio"><i class="fa fa-check"></i><b>1.2</b> Download and install R and R studio</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#open-r-studio-and-modify-the-workspace-preference"><i class="fa fa-check"></i><b>1.3</b> Open R Studio and modify the workspace preference</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it"><i class="fa fa-check"></i><b>1.4</b> If you didn’t modify the workspace preferences from the previous section, go back and do it</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-markdown-in-a-nutshell"><i class="fa fa-check"></i><b>1.5</b> R Markdown in a nutshell</a></li>
<li class="chapter" data-level="1.6" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#install-r-markdown"><i class="fa fa-check"></i><b>1.6</b> Install R Markdown</a></li>
<li class="chapter" data-level="1.7" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#importing-packages"><i class="fa fa-check"></i><b>1.7</b> Importing Packages</a></li>
<li class="chapter" data-level="1.8" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-an-r-studio-project-for-this-textbook"><i class="fa fa-check"></i><b>1.8</b> Create an R Studio Project for this textbook</a></li>
<li class="chapter" data-level="1.9" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#working-on-a-project-in-a-nutshell"><i class="fa fa-check"></i><b>1.9</b> Working on a project, in a nutshell</a></li>
<li class="chapter" data-level="1.10" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-an-r-markdown-file-for-this-chapter"><i class="fa fa-check"></i><b>1.10</b> Create an R Markdown file for this Chapter</a><ul>
<li class="chapter" data-level="1.10.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#modify-the-yaml-header"><i class="fa fa-check"></i><b>1.10.1</b> Modify the yaml header</a></li>
<li class="chapter" data-level="1.10.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#modify-the-setup-chunk"><i class="fa fa-check"></i><b>1.10.2</b> Modify the “setup” chunk</a></li>
<li class="chapter" data-level="1.10.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-fake-data-chunk"><i class="fa fa-check"></i><b>1.10.3</b> Create a “fake-data” chunk</a></li>
<li class="chapter" data-level="1.10.4" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-plot-chunk"><i class="fa fa-check"></i><b>1.10.4</b> Create a “plot” chunk</a></li>
<li class="chapter" data-level="1.10.5" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#knit"><i class="fa fa-check"></i><b>1.10.5</b> Knit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analyzing-experimental-data-with-a-linear-model.html"><a href="analyzing-experimental-data-with-a-linear-model.html"><i class="fa fa-check"></i><b>2</b> Analyzing experimental data with a linear model</a><ul>
<li class="chapter" data-level="2.1" data-path="analyzing-experimental-data-with-a-linear-model.html"><a href="analyzing-experimental-data-with-a-linear-model.html#this-text-is-about-the-estimation-of-treatment-effects-and-the-uncertainty-in-our-estimates-using-linear-models.-this-raises-the-question-what-is-an-effect"><i class="fa fa-check"></i><b>2.1</b> This text is about the estimation of treatment effects and the uncertainty in our estimates using linear models. This, raises the question, what is “an effect”?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="background-physiology-to-the-experiments-in-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="background-physiology-to-the-experiments-in-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><i class="fa fa-check"></i>Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li class="chapter" data-level="" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><i class="fa fa-check"></i>Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a><ul>
<li class="chapter" data-level="2.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#setup"><i class="fa fa-check"></i><b>2.2</b> Setup</a></li>
<li class="chapter" data-level="2.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#data-source"><i class="fa fa-check"></i><b>2.3</b> Data source</a></li>
<li class="chapter" data-level="2.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#control-the-color-palette"><i class="fa fa-check"></i><b>2.4</b> control the color palette</a></li>
<li class="chapter" data-level="2.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#useful-functions"><i class="fa fa-check"></i><b>2.5</b> useful functions</a></li>
<li class="chapter" data-level="2.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2b-effect-of-ask1-deletion-on-growth-body-weight"><i class="fa fa-check"></i><b>2.6</b> figure 2b – effect of ASK1 deletion on growth (body weight)</a><ul>
<li class="chapter" data-level="2.6.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2b-import"><i class="fa fa-check"></i><b>2.6.1</b> figure 2b – import</a></li>
<li class="chapter" data-level="2.6.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2b-exploratory-plots"><i class="fa fa-check"></i><b>2.6.2</b> figure 2b – exploratory plots</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-effect-of-ask1-deletion-on-final-body-weight"><i class="fa fa-check"></i><b>2.7</b> Figure 2c – Effect of ASK1 deletion on final body weight</a><ul>
<li class="chapter" data-level="2.7.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-import"><i class="fa fa-check"></i><b>2.7.1</b> Figure 2c – import</a></li>
<li class="chapter" data-level="2.7.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-check-own-computation-of-weight-change-v-imported-value"><i class="fa fa-check"></i><b>2.7.2</b> Figure 2c – check own computation of weight change v imported value</a></li>
<li class="chapter" data-level="2.7.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-exploratory-plots"><i class="fa fa-check"></i><b>2.7.3</b> Figure 2c – exploratory plots</a></li>
<li class="chapter" data-level="2.7.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-fit-the-model-m1-lm"><i class="fa fa-check"></i><b>2.7.4</b> Figure 2c – fit the model: m1 (lm)</a></li>
<li class="chapter" data-level="2.7.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-check-the-model-m1"><i class="fa fa-check"></i><b>2.7.5</b> Figure 2c – check the model: m1</a></li>
<li class="chapter" data-level="2.7.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-fit-the-model-m2-gamma-glm"><i class="fa fa-check"></i><b>2.7.6</b> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li class="chapter" data-level="2.7.7" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-check-the-model-m2"><i class="fa fa-check"></i><b>2.7.7</b> Figure 2c – check the model, m2</a></li>
<li class="chapter" data-level="2.7.8" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-inference-from-the-model"><i class="fa fa-check"></i><b>2.7.8</b> Figure 2c – inference from the model</a></li>
<li class="chapter" data-level="2.7.9" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-plot-the-model"><i class="fa fa-check"></i><b>2.7.9</b> Figure 2c – plot the model</a></li>
<li class="chapter" data-level="2.7.10" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-report"><i class="fa fa-check"></i><b>2.7.10</b> Figure 2c – report</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><i class="fa fa-check"></i><b>2.8</b> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a><ul>
<li class="chapter" data-level="2.8.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-import"><i class="fa fa-check"></i><b>2.8.1</b> Figure 2d – Import</a></li>
<li class="chapter" data-level="2.8.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-exploratory-plots"><i class="fa fa-check"></i><b>2.8.2</b> Figure 2d – exploratory plots</a></li>
<li class="chapter" data-level="2.8.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-fit-the-model"><i class="fa fa-check"></i><b>2.8.3</b> Figure 2d – fit the model</a></li>
<li class="chapter" data-level="2.8.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-check-the-model"><i class="fa fa-check"></i><b>2.8.4</b> Figure 2d – check the model</a></li>
<li class="chapter" data-level="2.8.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-inference"><i class="fa fa-check"></i><b>2.8.5</b> Figure 2d – inference</a></li>
<li class="chapter" data-level="2.8.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-plot-the-model"><i class="fa fa-check"></i><b>2.8.6</b> Figure 2d – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure"><i class="fa fa-check"></i><b>2.9</b> Figure 2e – Effect of ASK1 deletion on glucose tolerance (summary measure)</a><ul>
<li class="chapter" data-level="2.9.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-message-the-data"><i class="fa fa-check"></i><b>2.9.1</b> Figure 2e – message the data</a></li>
<li class="chapter" data-level="2.9.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-exploratory-plots"><i class="fa fa-check"></i><b>2.9.2</b> Figure 2e – exploratory plots</a></li>
<li class="chapter" data-level="2.9.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-fit-the-model"><i class="fa fa-check"></i><b>2.9.3</b> Figure 2e – fit the model</a></li>
<li class="chapter" data-level="2.9.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-check-the-model"><i class="fa fa-check"></i><b>2.9.4</b> Figure 2e – check the model</a></li>
<li class="chapter" data-level="2.9.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-inference-from-the-model"><i class="fa fa-check"></i><b>2.9.5</b> Figure 2e – inference from the model</a></li>
<li class="chapter" data-level="2.9.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-plot-the-model"><i class="fa fa-check"></i><b>2.9.6</b> Figure 2e – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate"><i class="fa fa-check"></i><b>2.10</b> Figure 2f – Effect of ASK1 deletion on glucose infusion rate</a><ul>
<li class="chapter" data-level="2.10.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-import"><i class="fa fa-check"></i><b>2.10.1</b> Figure 2f – import</a></li>
<li class="chapter" data-level="2.10.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-exploratory-plots"><i class="fa fa-check"></i><b>2.10.2</b> Figure 2f – exploratory plots</a></li>
<li class="chapter" data-level="2.10.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-fit-the-model"><i class="fa fa-check"></i><b>2.10.3</b> Figure 2f – fit the model</a></li>
<li class="chapter" data-level="2.10.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-check-the-model"><i class="fa fa-check"></i><b>2.10.4</b> Figure 2f – check the model</a></li>
<li class="chapter" data-level="2.10.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-inference"><i class="fa fa-check"></i><b>2.10.5</b> Figure 2f – inference</a></li>
<li class="chapter" data-level="2.10.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-plot-the-model"><i class="fa fa-check"></i><b>2.10.6</b> Figure 2f – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake"><i class="fa fa-check"></i><b>2.11</b> Figure 2g – Effect of ASK1 deletion on tissue-specific glucose uptake</a><ul>
<li class="chapter" data-level="2.11.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-import"><i class="fa fa-check"></i><b>2.11.1</b> Figure 2g – import</a></li>
<li class="chapter" data-level="2.11.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-exploratory-plots"><i class="fa fa-check"></i><b>2.11.2</b> Figure 2g – exploratory plots</a></li>
<li class="chapter" data-level="2.11.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-fit-the-model"><i class="fa fa-check"></i><b>2.11.3</b> Figure 2g – fit the model</a></li>
<li class="chapter" data-level="2.11.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-check-the-model"><i class="fa fa-check"></i><b>2.11.4</b> Figure 2g – check the model</a></li>
<li class="chapter" data-level="2.11.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-inference"><i class="fa fa-check"></i><b>2.11.5</b> Figure 2g – inference</a></li>
<li class="chapter" data-level="2.11.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-plot-the-model"><i class="fa fa-check"></i><b>2.11.6</b> Figure 2g – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2h"><i class="fa fa-check"></i><b>2.12</b> Figure 2h</a></li>
<li class="chapter" data-level="2.13" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-effect-of-ask1-deletion-on-liver-tg"><i class="fa fa-check"></i><b>2.13</b> Figure 2i – Effect of ASK1 deletion on liver TG</a><ul>
<li class="chapter" data-level="2.13.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-fit-the-model"><i class="fa fa-check"></i><b>2.13.1</b> Figure 2i – fit the model</a></li>
<li class="chapter" data-level="2.13.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-check-the-model"><i class="fa fa-check"></i><b>2.13.2</b> Figure 2i – check the model</a></li>
<li class="chapter" data-level="2.13.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-inference"><i class="fa fa-check"></i><b>2.13.3</b> Figure 2i – inference</a></li>
<li class="chapter" data-level="2.13.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-plot-the-model"><i class="fa fa-check"></i><b>2.13.4</b> Figure 2i – plot the model</a></li>
<li class="chapter" data-level="2.13.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-report-the-model"><i class="fa fa-check"></i><b>2.13.5</b> Figure 2i – report the model</a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2j"><i class="fa fa-check"></i><b>2.14</b> Figure 2j</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-r-fundamentals.html"><a href="part-iii-r-fundamentals.html"><i class="fa fa-check"></i>Part III: R fundamentals</a></li>
<li class="chapter" data-level="3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html"><i class="fa fa-check"></i><b>3</b> Data – Reading, Wrangling, and Writing</a><ul>
<li class="chapter" data-level="3.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#learning-from-this-chapter"><i class="fa fa-check"></i><b>3.1</b> Learning from this chapter</a></li>
<li class="chapter" data-level="3.2" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#data-working-in-r"><i class="fa fa-check"></i><b>3.2</b> Working in R</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#importing-data"><i class="fa fa-check"></i><b>3.2.1</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#data-wrangling"><i class="fa fa-check"></i><b>3.3</b> Data wrangling</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#reshaping-data-wide-to-long"><i class="fa fa-check"></i><b>3.3.1</b> Reshaping data – Wide to long</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#reshaping-data-transpose-turning-the-columns-into-rows"><i class="fa fa-check"></i><b>3.3.2</b> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#combining-data"><i class="fa fa-check"></i><b>3.3.3</b> Combining data</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#subsetting-data"><i class="fa fa-check"></i><b>3.3.4</b> Subsetting data</a></li>
<li class="chapter" data-level="3.3.5" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#wrangling-columns"><i class="fa fa-check"></i><b>3.3.5</b> Wrangling columns</a></li>
<li class="chapter" data-level="3.3.6" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#missing-data"><i class="fa fa-check"></i><b>3.3.6</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#saving-data"><i class="fa fa-check"></i><b>3.4</b> Saving data</a></li>
<li class="chapter" data-level="3.5" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#exercises"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting-models.html"><a href="plotting-models.html"><i class="fa fa-check"></i><b>4</b> Plotting Models</a><ul>
<li class="chapter" data-level="4.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data"><i class="fa fa-check"></i><b>4.1</b> Pretty good plots show the model and the data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot"><i class="fa fa-check"></i><b>4.1.1</b> Pretty good plot component 1: Modeled effects plot</a></li>
<li class="chapter" data-level="4.1.2" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot"><i class="fa fa-check"></i><b>4.1.2</b> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li class="chapter" data-level="4.1.3" data-path="plotting-models.html"><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><i class="fa fa-check"></i><b>4.1.3</b> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
<li class="chapter" data-level="4.1.4" data-path="plotting-models.html"><a href="plotting-models.html#some-comments-on-plot-components"><i class="fa fa-check"></i><b>4.1.4</b> Some comments on plot components</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="plotting-models.html"><a href="plotting-models.html#working-in-r"><i class="fa fa-check"></i><b>4.2</b> Working in R</a><ul>
<li class="chapter" data-level="4.2.1" data-path="plotting-models.html"><a href="plotting-models.html#source-data"><i class="fa fa-check"></i><b>4.2.1</b> Source data</a></li>
<li class="chapter" data-level="4.2.2" data-path="plotting-models.html"><a href="plotting-models.html#how-to-plot-the-model"><i class="fa fa-check"></i><b>4.2.2</b> How to plot the model</a></li>
<li class="chapter" data-level="4.2.3" data-path="plotting-models.html"><a href="plotting-models.html#how-to-use-the-plot-the-model-functions"><i class="fa fa-check"></i><b>4.2.3</b> How to use the Plot the Model functions</a></li>
<li class="chapter" data-level="4.2.4" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-a-response-plot-using-ggpubr"><i class="fa fa-check"></i><b>4.2.4</b> How to generate a Response Plot using ggpubr</a></li>
<li class="chapter" data-level="4.2.5" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2"><i class="fa fa-check"></i><b>4.2.5</b> How to generate a Response Plot with a grid of treatments using ggplot2</a></li>
<li class="chapter" data-level="4.2.6" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-an-effects-plot"><i class="fa fa-check"></i><b>4.2.6</b> How to generate an Effects Plot</a></li>
<li class="chapter" data-level="4.2.7" data-path="plotting-models.html"><a href="plotting-models.html#how-to-combine-the-response-and-effects-plots"><i class="fa fa-check"></i><b>4.2.7</b> How to combine the response and effects plots</a></li>
<li class="chapter" data-level="4.2.8" data-path="plotting-models.html"><a href="plotting-models.html#how-to-add-the-interaction-effect-to-response-and-effects-plots"><i class="fa fa-check"></i><b>4.2.8</b> How to add the interaction effect to response and effects plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iv-some-fundamentals-of-statistical-modeling.html"><a href="part-iv-some-fundamentals-of-statistical-modeling.html"><i class="fa fa-check"></i>Part IV: Some Fundamentals of Statistical Modeling</a></li>
<li class="chapter" data-level="5" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><i class="fa fa-check"></i><b>5</b> Variability and Uncertainty (Standard Deviations, Standard Errors, Confidence Intervals) (#variability)</a><ul>
<li class="chapter" data-level="5.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#the-sample-standard-deviation-vs.-the-standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.1</b> The sample standard deviation vs. the standard error of the mean</a><ul>
<li class="chapter" data-level="5.1.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#sample-standard-deviation"><i class="fa fa-check"></i><b>5.1.1</b> Sample standard deviation</a></li>
<li class="chapter" data-level="5.1.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.2</b> Using Google Sheets to generate fake data to explore the standard error</a><ul>
<li class="chapter" data-level="5.2.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#steps"><i class="fa fa-check"></i><b>5.2.1</b> Steps</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#using-r-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.3</b> Using R to generate fake data to explore the standard error</a><ul>
<li class="chapter" data-level="5.3.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#part-i"><i class="fa fa-check"></i><b>5.3.1</b> part I</a></li>
<li class="chapter" data-level="5.3.2" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#part-ii---means"><i class="fa fa-check"></i><b>5.3.2</b> part II - means</a></li>
<li class="chapter" data-level="5.3.3" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#part-iii---how-do-sd-and-se-change-as-sample-size-n-increases"><i class="fa fa-check"></i><b>5.3.3</b> part III - how do SD and SE change as sample size (n) increases?</a></li>
<li class="chapter" data-level="5.3.4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#part-iv-generating-fake-data-with-for-loops"><i class="fa fa-check"></i><b>5.3.4</b> Part IV – Generating fake data with for-loops</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#bootstrap"><i class="fa fa-check"></i><b>5.4</b> Bootstrapped standard errors</a><ul>
<li class="chapter" data-level="5.4.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#an-example-of-bootstrapped-standard-errors-using-vole-data"><i class="fa fa-check"></i><b>5.4.1</b> An example of bootstrapped standard errors using vole data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#confidence-interval"><i class="fa fa-check"></i><b>5.5</b> Confidence Interval</a><ul>
<li class="chapter" data-level="5.5.1" data-path="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html"><a href="variability-and-uncertainty-standard-deviations-standard-errors-confidence-intervals-variability.html#interpretation-of-a-confidence-interval"><i class="fa fa-check"></i><b>5.5.1</b> Interpretation of a confidence interval</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="p-values.html"><a href="p-values.html"><i class="fa fa-check"></i><b>6</b> P-values</a><ul>
<li class="chapter" data-level="6.1" data-path="p-values.html"><a href="p-values.html#a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution"><i class="fa fa-check"></i><b>6.1</b> A <em>p</em>-value is the probability of sampling a value as or more extreme than the test statistic if sampling from a null distribution</a></li>
<li class="chapter" data-level="6.2" data-path="p-values.html"><a href="p-values.html#pump-your-intuition-creating-a-null-distribution"><i class="fa fa-check"></i><b>6.2</b> Pump your intuition – Creating a null distribution</a></li>
<li class="chapter" data-level="6.3" data-path="p-values.html"><a href="p-values.html#a-null-distribution-of-t-values-the-t-distribution"><i class="fa fa-check"></i><b>6.3</b> A null distribution of <em>t</em>-values – the <em>t</em> distribution</a></li>
<li class="chapter" data-level="6.4" data-path="p-values.html"><a href="p-values.html#p-values-from-the-perspective-of-permutation"><i class="fa fa-check"></i><b>6.4</b> P-values from the perspective of permutation</a></li>
<li class="chapter" data-level="6.5" data-path="p-values.html"><a href="p-values.html#parametric-vs.-non-parametric-statistics"><i class="fa fa-check"></i><b>6.5</b> Parametric vs. non-parametric statistics</a></li>
<li class="chapter" data-level="6.6" data-path="p-values.html"><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values"><i class="fa fa-check"></i><b>6.6</b> frequentist probability and the interpretation of p-values</a><ul>
<li class="chapter" data-level="6.6.1" data-path="p-values.html"><a href="p-values.html#background"><i class="fa fa-check"></i><b>6.6.1</b> Background</a></li>
<li class="chapter" data-level="6.6.2" data-path="p-values.html"><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><i class="fa fa-check"></i><b>6.6.2</b> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li class="chapter" data-level="6.6.3" data-path="p-values.html"><a href="p-values.html#two-interpretations-of-the-p-value"><i class="fa fa-check"></i><b>6.6.3</b> Two interpretations of the <em>p</em>-value</a></li>
<li class="chapter" data-level="6.6.4" data-path="p-values.html"><a href="p-values.html#nhst"><i class="fa fa-check"></i><b>6.6.4</b> NHST</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="p-values.html"><a href="p-values.html#some-major-misconceptions-of-the-p-value"><i class="fa fa-check"></i><b>6.7</b> Some major misconceptions of the <em>p</em>-value</a><ul>
<li class="chapter" data-level="6.7.1" data-path="p-values.html"><a href="p-values.html#misconception-p-is-the-probability-that-the-null-is-true-and-1-p-is-probability-that-the-alternative-is-true"><i class="fa fa-check"></i><b>6.7.1</b> Misconception: <em>p</em> is the probability that the null is true <em>and</em> <span class="math inline">\(1-p\)</span> is probability that the alternative is true</a></li>
<li class="chapter" data-level="6.7.2" data-path="p-values.html"><a href="p-values.html#misconception-a-p-value-is-repeatable"><i class="fa fa-check"></i><b>6.7.2</b> Misconception: a <em>p</em>-value is repeatable</a></li>
<li class="chapter" data-level="6.7.3" data-path="p-values.html"><a href="p-values.html#misconception-0.05-is-the-lifetime-rate-of-false-discoveries"><i class="fa fa-check"></i><b>6.7.3</b> Misconception: 0.05 is the lifetime rate of false discoveries</a></li>
<li class="chapter" data-level="6.7.4" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-an-important-effect"><i class="fa fa-check"></i><b>6.7.4</b> Misconception: a low <em>p</em>-value indicates an important effect</a></li>
<li class="chapter" data-level="6.7.5" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity"><i class="fa fa-check"></i><b>6.7.5</b> Misconception: a low <em>p</em>-value indicates high model fit or high predictive capacity</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="p-values.html"><a href="p-values.html#what-the-p-value-does-not-mean"><i class="fa fa-check"></i><b>6.8</b> What the <em>p</em>-value does not mean</a></li>
<li class="chapter" data-level="6.9" data-path="p-values.html"><a href="p-values.html#recommendations"><i class="fa fa-check"></i><b>6.9</b> Recommendations</a><ul>
<li class="chapter" data-level="6.9.1" data-path="p-values.html"><a href="p-values.html#primary-sources-for-recommendations"><i class="fa fa-check"></i><b>6.9.1</b> Primary sources for recommendations</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="p-values.html"><a href="p-values.html#problems"><i class="fa fa-check"></i><b>6.10</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="errors-in-inference.html"><a href="errors-in-inference.html"><i class="fa fa-check"></i><b>7</b> Errors in inference</a><ul>
<li class="chapter" data-level="7.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#classical-nhst-concepts-of-wrong"><i class="fa fa-check"></i><b>7.1</b> Classical NHST concepts of wrong</a><ul>
<li class="chapter" data-level="7.1.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-i-error"><i class="fa fa-check"></i><b>7.1.1</b> Type I error</a></li>
<li class="chapter" data-level="7.1.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#power"><i class="fa fa-check"></i><b>7.1.2</b> Power</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#a-non-neyman-pearson-concept-of-power"><i class="fa fa-check"></i><b>7.2</b> A non-Neyman-Pearson concept of power</a><ul>
<li class="chapter" data-level="7.2.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#estimation-error"><i class="fa fa-check"></i><b>7.2.1</b> Estimation error</a></li>
<li class="chapter" data-level="7.2.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#coverage"><i class="fa fa-check"></i><b>7.2.2</b> Coverage</a></li>
<li class="chapter" data-level="7.2.3" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-s-error"><i class="fa fa-check"></i><b>7.2.3</b> Type S error</a></li>
<li class="chapter" data-level="7.2.4" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-m-error"><i class="fa fa-check"></i><b>7.2.4</b> Type M error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-introduction-to-linear-models.html"><a href="part-v-introduction-to-linear-models.html"><i class="fa fa-check"></i>Part V: Introduction to Linear Models</a></li>
<li class="chapter" data-level="8" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html"><i class="fa fa-check"></i><b>8</b> An introduction to linear models</a><ul>
<li class="chapter" data-level="8.1" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#two-specifications-of-a-linear-model"><i class="fa fa-check"></i><b>8.1</b> Two specifications of a linear model</a><ul>
<li class="chapter" data-level="8.1.1" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#the-error-draw-specification"><i class="fa fa-check"></i><b>8.1.1</b> The “error draw” specification</a></li>
<li class="chapter" data-level="8.1.2" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#the-conditional-draw-specification"><i class="fa fa-check"></i><b>8.1.2</b> The “conditional draw” specification</a></li>
<li class="chapter" data-level="8.1.3" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model"><i class="fa fa-check"></i><b>8.1.3</b> Comparing the error-draw and conditional-draw ways of specifying the linear model</a></li>
<li class="chapter" data-level="8.1.4" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#anova-notation-of-a-linear-model"><i class="fa fa-check"></i><b>8.1.4</b> ANOVA notation of a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"><i class="fa fa-check"></i><b>8.2</b> A linear model can be fit to data with continuous, discrete, or categorical <span class="math inline">\(X\)</span> variables</a><ul>
<li class="chapter" data-level="8.2.1" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete"><i class="fa fa-check"></i><b>8.2.1</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is continuous or discrete</a></li>
<li class="chapter" data-level="8.2.2" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#slope"><i class="fa fa-check"></i><b>8.2.2</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is categorical</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#statistical-models-are-used-for-prediction-explanation-and-description"><i class="fa fa-check"></i><b>8.3</b> Statistical models are used for prediction, explanation, and description</a></li>
<li class="chapter" data-level="8.4" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#what-do-we-call-the-x-and-y-variables"><i class="fa fa-check"></i><b>8.4</b> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li class="chapter" data-level="8.5" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#modeling-strategy"><i class="fa fa-check"></i><b>8.5</b> Modeling strategy</a></li>
<li class="chapter" data-level="8.6" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#predictions-from-the-model"><i class="fa fa-check"></i><b>8.6</b> Predictions from the model</a></li>
<li class="chapter" data-level="8.7" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#inference-from-the-model"><i class="fa fa-check"></i><b>8.7</b> Inference from the model</a><ul>
<li class="chapter" data-level="8.7.1" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#assumptions-for-inference-with-a-statistical-model"><i class="fa fa-check"></i><b>8.7.1</b> Assumptions for inference with a statistical model</a></li>
<li class="chapter" data-level="8.7.2" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#specific-assumptions-for-inference-with-a-linear-model"><i class="fa fa-check"></i><b>8.7.2</b> Specific assumptions for inference with a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#linear-modelregression-model-orstatistical-model"><i class="fa fa-check"></i><b>8.8</b> “linear model,”regression model“, or”statistical model"?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html"><i class="fa fa-check"></i><b>9</b> Linear models with a single, continuous <em>X</em></a><ul>
<li class="chapter" data-level="9.1" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><i class="fa fa-check"></i><b>9.1</b> A linear model with a single, continuous <em>X</em> is classical “regression”</a><ul>
<li class="chapter" data-level="9.1.1" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#analysis-of-green-down-data"><i class="fa fa-check"></i><b>9.1.1</b> Analysis of “green-down” data</a></li>
<li class="chapter" data-level="9.1.2" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#learning-from-the-green-down-example"><i class="fa fa-check"></i><b>9.1.2</b> Learning from the green-down example</a></li>
<li class="chapter" data-level="9.1.3" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#using-a-regression-model-for-explanation-causal-models"><i class="fa fa-check"></i><b>9.1.3</b> Using a regression model for “explanation” – causal models</a></li>
<li class="chapter" data-level="9.1.4" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#using-a-regression-model-for-prediction-prediction-models"><i class="fa fa-check"></i><b>9.1.4</b> Using a regression model for prediction – prediction models</a></li>
<li class="chapter" data-level="9.1.5" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data"><i class="fa fa-check"></i><b>9.1.5</b> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</a></li>
<li class="chapter" data-level="9.1.6" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#using-a-regression-model-for-for-calibration"><i class="fa fa-check"></i><b>9.1.6</b> Using a regression model for for calibration</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#working-in-r-1"><i class="fa fa-check"></i><b>9.2</b> Working in R</a><ul>
<li class="chapter" data-level="9.2.1" data-path="plotting-models.html"><a href="plotting-models.html#fit-the-model"><i class="fa fa-check"></i><b>9.2.1</b> Fitting the linear model</a></li>
<li class="chapter" data-level="9.2.2" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#getting-to-know-the-linear-model-the-summary-function"><i class="fa fa-check"></i><b>9.2.2</b> Getting to know the linear model: the <code>summary</code> function</a></li>
<li class="chapter" data-level="9.2.3" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#inference-the-coefficient-table"><i class="fa fa-check"></i><b>9.2.3</b> Inference – the coefficient table</a></li>
<li class="chapter" data-level="9.2.4" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#how-good-is-our-model-model-checking"><i class="fa fa-check"></i><b>9.2.4</b> How good is our model? – Model checking</a></li>
<li class="chapter" data-level="9.2.5" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#plotting-models-with-continuous-x"><i class="fa fa-check"></i><b>9.2.5</b> Plotting models with continuous <em>X</em></a></li>
<li class="chapter" data-level="9.2.6" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#creating-a-table-of-predicted-values-and-95-prediction-intervals"><i class="fa fa-check"></i><b>9.2.6</b> Creating a table of predicted values and 95% prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#hidden-code"><i class="fa fa-check"></i><b>9.3</b> Hidden code</a><ul>
<li class="chapter" data-level="9.3.1" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#import-and-plot-of-fig2c-ecosystem-warming-experimental-data"><i class="fa fa-check"></i><b>9.3.1</b> Import and plot of fig2c (ecosystem warming experimental) data</a></li>
<li class="chapter" data-level="9.3.2" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#import-and-plot-efig_3d-ecosysem-warming-observational-data"><i class="fa fa-check"></i><b>9.3.2</b> Import and plot efig_3d (Ecosysem warming observational) data</a></li>
<li class="chapter" data-level="9.3.3" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#import-and-plot-of-fig1f-methionine-restriction-data"><i class="fa fa-check"></i><b>9.3.3</b> Import and plot of fig1f (methionine restriction) data</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#try-it"><i class="fa fa-check"></i><b>9.4</b> Try it</a><ul>
<li class="chapter" data-level="9.4.1" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#a-prediction-model-from-the-literature"><i class="fa fa-check"></i><b>9.4.1</b> A prediction model from the literature</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#intuition-pumps"><i class="fa fa-check"></i><b>9.5</b> Intuition pumps</a><ul>
<li class="chapter" data-level="9.5.1" data-path="linear-models-with-a-single-continuous-x.html"><a href="linear-models-with-a-single-continuous-x.html#correlation-and-r2"><i class="fa fa-check"></i><b>9.5.1</b> Correlation and $R^2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html"><i class="fa fa-check"></i><b>10</b> Linear models with a single, categorical <em>X</em></a><ul>
<li class="chapter" data-level="10.1" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#a-linear-model-with-a-single-categorical-x-variable-estimates-the-effects-of-the-levels-of-x-on-the-response."><i class="fa fa-check"></i><b>10.1</b> A linear model with a single, categorical <em>X</em> variable estimates the effects of the levels of <em>X</em> on the response.</a><ul>
<li class="chapter" data-level="10.1.1" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#example-1-two-treatment-levels-groups"><i class="fa fa-check"></i><b>10.1.1</b> Example 1 – two treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.2" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#understanding-the-analysis-with-two-treatment-levels"><i class="fa fa-check"></i><b>10.1.2</b> Understanding the analysis with two treatment levels</a></li>
<li class="chapter" data-level="10.1.3" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#example-2-three-treatment-levels-groups"><i class="fa fa-check"></i><b>10.1.3</b> Example 2 – three treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.4" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#understanding-the-analysis-with-three-or-more-treatment-levels"><i class="fa fa-check"></i><b>10.1.4</b> Understanding the analysis with three (or more) treatment levels</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#working-in-r-2"><i class="fa fa-check"></i><b>10.2</b> Working in R</a><ul>
<li class="chapter" data-level="10.2.1" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#fit-the-model-2"><i class="fa fa-check"></i><b>10.2.1</b> Fit the model</a></li>
<li class="chapter" data-level="10.2.2" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#controlling-the-output-in-tables-using-the-coefficient-table-as-an-example"><i class="fa fa-check"></i><b>10.2.2</b> Controlling the output in tables using the coefficient table as an example</a></li>
<li class="chapter" data-level="10.2.3" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#using-the-emmeans-function"><i class="fa fa-check"></i><b>10.2.3</b> Using the emmeans function</a></li>
<li class="chapter" data-level="10.2.4" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#using-the-contrast-function"><i class="fa fa-check"></i><b>10.2.4</b> Using the contrast function</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#issues-in-inference-in-models-with-a-single-categorical-x"><i class="fa fa-check"></i><b>10.3</b> Issues in inference in models with a single, categorical <span class="math inline">\(X\)</span></a><ul>
<li class="chapter" data-level="10.3.1" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#lack-of-independence-paired-t-test"><i class="fa fa-check"></i><b>10.3.1</b> Lack of independence (“paired t-test”)</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#heterogeneity-of-variances"><i class="fa fa-check"></i><b>10.3.2</b> Heterogeneity of variances</a></li>
<li class="chapter" data-level="10.3.3" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#the-conditional-response-isnt-normal"><i class="fa fa-check"></i><b>10.3.3</b> The conditional response isn’t Normal</a></li>
<li class="chapter" data-level="10.3.4" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#pre-post-designs"><i class="fa fa-check"></i><b>10.3.4</b> Pre-post designs</a></li>
<li class="chapter" data-level="10.3.5" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#longitudinal-designs"><i class="fa fa-check"></i><b>10.3.5</b> Longitudinal designs</a></li>
<li class="chapter" data-level="10.3.6" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#comparing-responses-normalized-to-a-standard"><i class="fa fa-check"></i><b>10.3.6</b> Comparing responses normalized to a standard</a></li>
<li class="chapter" data-level="10.3.7" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#comparing-responses-that-are-ratios"><i class="fa fa-check"></i><b>10.3.7</b> Comparing responses that are ratios</a></li>
<li class="chapter" data-level="10.3.8" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#researcher-degrees-of-freedom"><i class="fa fa-check"></i><b>10.3.8</b> Researcher degrees of freedom</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#hidden-code-1"><i class="fa fa-check"></i><b>10.4</b> Hidden Code</a><ul>
<li class="chapter" data-level="10.4.1" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#importing-and-wrangling-the-fig_3d-data-for-example-1"><i class="fa fa-check"></i><b>10.4.1</b> Importing and wrangling the fig_3d data for example 1</a></li>
<li class="chapter" data-level="10.4.2" data-path="linear-models-with-a-single-categorical-x.html"><a href="linear-models-with-a-single-categorical-x.html#importing-and-wrangling-the-fig2a-data-for-example-2"><i class="fa fa-check"></i><b>10.4.2</b> Importing and wrangling the fig2a data for example 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>11</b> Model Checking</a><ul>
<li class="chapter" data-level="11.1" data-path="model-checking.html"><a href="model-checking.html#all-statistical-analyses-should-be-followed-by-model-checking"><i class="fa fa-check"></i><b>11.1</b> All statistical analyses should be followed by model checking</a></li>
<li class="chapter" data-level="11.2" data-path="model-checking.html"><a href="model-checking.html#linear-model-assumptions"><i class="fa fa-check"></i><b>11.2</b> Linear model assumptions</a><ul>
<li class="chapter" data-level="11.2.1" data-path="model-checking.html"><a href="model-checking.html#a-bit-about-iid"><i class="fa fa-check"></i><b>11.2.1</b> A bit about IID</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="model-checking.html"><a href="model-checking.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>11.3</b> Diagnostic plots use the residuals from the model fit</a><ul>
<li class="chapter" data-level="11.3.1" data-path="model-checking.html"><a href="model-checking.html#residuals"><i class="fa fa-check"></i><b>11.3.1</b> Residuals</a></li>
<li class="chapter" data-level="11.3.2" data-path="model-checking.html"><a href="model-checking.html#a-normal-q-q-plot-is-used-to-check-for-characteristic-departures-from-normality"><i class="fa fa-check"></i><b>11.3.2</b> A Normal Q-Q plot is used to check for characteristic departures from Normality</a></li>
<li class="chapter" data-level="11.3.3" data-path="model-checking.html"><a href="model-checking.html#mapping-qq-plot-departures-from-normality"><i class="fa fa-check"></i><b>11.3.3</b> Mapping QQ-plot departures from Normality</a></li>
<li class="chapter" data-level="11.3.4" data-path="model-checking.html"><a href="model-checking.html#model-checking-homoskedasticity"><i class="fa fa-check"></i><b>11.3.4</b> Model checking homoskedasticity</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="model-checking.html"><a href="model-checking.html#using-r"><i class="fa fa-check"></i><b>11.4</b> Using R</a><ul>
<li class="chapter" data-level="11.4.1" data-path="model-checking.html"><a href="model-checking.html#normal-q-q-plots"><i class="fa fa-check"></i><b>11.4.1</b> Normal Q-Q plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html"><i class="fa fa-check"></i><b>12</b> Model Fitting and Model Fit (OLS)</a><ul>
<li class="chapter" data-level="12.1" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#least-squares-estimation-and-the-decomposition-of-variance"><i class="fa fa-check"></i><b>12.1</b> Least Squares Estimation and the Decomposition of Variance</a></li>
<li class="chapter" data-level="12.2" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#ols-regression"><i class="fa fa-check"></i><b>12.2</b> OLS regression</a></li>
<li class="chapter" data-level="12.3" data-path="model-fitting-and-model-fit-ols.html"><a href="model-fitting-and-model-fit-ols.html#how-well-does-the-model-fit-the-data-r2-and-variance-explained"><i class="fa fa-check"></i><b>12.3</b> How well does the model fit the data? <span class="math inline">\(R^2\)</span> and “variance explained”</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html"><i class="fa fa-check"></i><b>13</b> Best practices – issues in inference</a><ul>
<li class="chapter" data-level="13.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#multiple-testing"><i class="fa fa-check"></i><b>13.1</b> Multiple testing</a><ul>
<li class="chapter" data-level="13.1.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#some-background"><i class="fa fa-check"></i><b>13.1.1</b> Some background</a></li>
<li class="chapter" data-level="13.1.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#multiple-testing-working-in-r"><i class="fa fa-check"></i><b>13.1.2</b> Multiple testing – working in R</a></li>
<li class="chapter" data-level="13.1.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#false-discovery-rate-1"><i class="fa fa-check"></i><b>13.1.3</b> False Discovery Rate</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#difference-in-p-is-not-different"><i class="fa fa-check"></i><b>13.2</b> difference in p is not different</a></li>
<li class="chapter" data-level="13.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#inference-when-data-are-not-normal"><i class="fa fa-check"></i><b>13.3</b> Inference when data are not Normal</a><ul>
<li class="chapter" data-level="13.3.1" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#working-in-r-3"><i class="fa fa-check"></i><b>13.3.1</b> Working in R</a></li>
<li class="chapter" data-level="13.3.2" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>13.3.2</b> Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="13.3.3" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#permutation-test"><i class="fa fa-check"></i><b>13.3.3</b> Permutation test</a></li>
<li class="chapter" data-level="13.3.4" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#non-parametric-tests"><i class="fa fa-check"></i><b>13.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="13.3.5" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#log-transformations"><i class="fa fa-check"></i><b>13.3.5</b> Log transformations</a></li>
<li class="chapter" data-level="13.3.6" data-path="best-practices-issues-in-inference.html"><a href="best-practices-issues-in-inference.html#performance-of-parametric-tests-and-alternatives"><i class="fa fa-check"></i><b>13.3.6</b> Performance of parametric tests and alternatives</a></li>
</ul></li>
</ul></li>
<li><a href="part-vi-more-than-one-x-multivariable-models.html#part-vi-more-than-one-x-multivariable-models">Part VI: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li class="chapter" data-level="14" data-path="chapter-covariates.html"><a href="chapter-covariates.html"><i class="fa fa-check"></i><b>14</b> Adding covariates to a linear model</a><ul>
<li class="chapter" data-level="14.1" data-path="chapter-covariates.html"><a href="chapter-covariates.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><i class="fa fa-check"></i><b>14.1</b> Adding covariates can increases the precision of the effect of interest</a></li>
<li class="chapter" data-level="14.2" data-path="chapter-covariates.html"><a href="chapter-covariates.html#understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data"><i class="fa fa-check"></i><b>14.2</b> Understanding a linear model with an added covariate – heart necrosis data</a><ul>
<li class="chapter" data-level="14.2.1" data-path="chapter-covariates.html"><a href="chapter-covariates.html#fit-the-model-3"><i class="fa fa-check"></i><b>14.2.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.2.2" data-path="chapter-covariates.html"><a href="chapter-covariates.html#plot-the-model-1"><i class="fa fa-check"></i><b>14.2.2</b> Plot the model</a></li>
<li class="chapter" data-level="14.2.3" data-path="chapter-covariates.html"><a href="chapter-covariates.html#interpretation-of-the-model-coefficients"><i class="fa fa-check"></i><b>14.2.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.2.4" data-path="chapter-covariates.html"><a href="chapter-covariates.html#everything-adds-up"><i class="fa fa-check"></i><b>14.2.4</b> Everything adds up</a></li>
<li class="chapter" data-level="14.2.5" data-path="chapter-covariates.html"><a href="chapter-covariates.html#interpretation-of-the-estimated-marginal-means"><i class="fa fa-check"></i><b>14.2.5</b> Interpretation of the estimated marginal means</a></li>
<li class="chapter" data-level="14.2.6" data-path="chapter-covariates.html"><a href="chapter-covariates.html#interpretation-of-the-contrasts"><i class="fa fa-check"></i><b>14.2.6</b> Interpretation of the contrasts</a></li>
<li class="chapter" data-level="14.2.7" data-path="chapter-covariates.html"><a href="chapter-covariates.html#adding-the-covariate-improves-inference"><i class="fa fa-check"></i><b>14.2.7</b> Adding the covariate improves inference</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="chapter-covariates.html"><a href="chapter-covariates.html#understanding-interaction-effects-with-covariates"><i class="fa fa-check"></i><b>14.3</b> Understanding interaction effects with covariates</a><ul>
<li class="chapter" data-level="14.3.1" data-path="chapter-covariates.html"><a href="chapter-covariates.html#fit-the-model-4"><i class="fa fa-check"></i><b>14.3.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.3.2" data-path="chapter-covariates.html"><a href="chapter-covariates.html#plot-the-model-with-interaction-effect"><i class="fa fa-check"></i><b>14.3.2</b> Plot the model with interaction effect</a></li>
<li class="chapter" data-level="14.3.3" data-path="chapter-covariates.html"><a href="chapter-covariates.html#interpretation-of-the-model-coefficients-1"><i class="fa fa-check"></i><b>14.3.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.3.4" data-path="chapter-covariates.html"><a href="chapter-covariates.html#what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends."><i class="fa fa-check"></i><b>14.3.4</b> What is the effect of a treatment, if interactions are modeled? – it depends.</a></li>
<li class="chapter" data-level="14.3.5" data-path="chapter-covariates.html"><a href="chapter-covariates.html#which-model-do-we-use-mathcalm_1-or-mathcalm_2"><i class="fa fa-check"></i><b>14.3.5</b> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="chapter-covariates.html"><a href="chapter-covariates.html#understanding-ancova-tables"><i class="fa fa-check"></i><b>14.4</b> Understanding ANCOVA tables</a></li>
<li class="chapter" data-level="14.5" data-path="chapter-covariates.html"><a href="chapter-covariates.html#working-in-r-4"><i class="fa fa-check"></i><b>14.5</b> Working in R</a><ul>
<li class="chapter" data-level="14.5.1" data-path="chapter-covariates.html"><a href="chapter-covariates.html#importing-the-heart-necrosis-data"><i class="fa fa-check"></i><b>14.5.1</b> Importing the heart necrosis data</a></li>
<li class="chapter" data-level="14.5.2" data-path="chapter-covariates.html"><a href="chapter-covariates.html#fitting-the-model"><i class="fa fa-check"></i><b>14.5.2</b> Fitting the model</a></li>
<li class="chapter" data-level="14.5.3" data-path="chapter-covariates.html"><a href="chapter-covariates.html#using-the-emmeans-function-1"><i class="fa fa-check"></i><b>14.5.3</b> Using the emmeans function</a></li>
<li class="chapter" data-level="14.5.4" data-path="chapter-covariates.html"><a href="chapter-covariates.html#ancova-tables"><i class="fa fa-check"></i><b>14.5.4</b> ANCOVA tables</a></li>
<li class="chapter" data-level="14.5.5" data-path="chapter-covariates.html"><a href="chapter-covariates.html#plotting-the-model"><i class="fa fa-check"></i><b>14.5.5</b> Plotting the model</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="chapter-covariates.html"><a href="chapter-covariates.html#best-practices"><i class="fa fa-check"></i><b>14.6</b> Best practices</a><ul>
<li class="chapter" data-level="14.6.1" data-path="chapter-covariates.html"><a href="chapter-covariates.html#do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate"><i class="fa fa-check"></i><b>14.6.1</b> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</a></li>
<li class="chapter" data-level="14.6.2" data-path="chapter-covariates.html"><a href="chapter-covariates.html#do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate"><i class="fa fa-check"></i><b>14.6.2</b> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</a></li>
<li class="chapter" data-level="14.6.3" data-path="chapter-covariates.html"><a href="chapter-covariates.html#do-not-test-for-balance-of-baseline-measures"><i class="fa fa-check"></i><b>14.6.3</b> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="chapter-covariates.html"><a href="chapter-covariates.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><i class="fa fa-check"></i><b>14.7</b> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="models-for-two-or-more-categorical-x-factorial-designs.html"><a href="models-for-two-or-more-categorical-x-factorial-designs.html"><i class="fa fa-check"></i><b>15</b> Models for two (or more) categorical <span class="math inline">\(X\)</span> – Factorial designs</a><ul>
<li class="chapter" data-level="15.1" data-path="models-for-two-or-more-categorical-x-factorial-designs.html"><a href="models-for-two-or-more-categorical-x-factorial-designs.html#factorial-experiments"><i class="fa fa-check"></i><b>15.1</b> Factorial experiments</a></li>
<li class="chapter" data-level="15.2" data-path="models-for-two-or-more-categorical-x-factorial-designs.html"><a href="models-for-two-or-more-categorical-x-factorial-designs.html#example-1-maize-defense-response"><i class="fa fa-check"></i><b>15.2</b> Example 1: Maize defense response</a><ul>
<li class="chapter" data-level="15.2.1" data-path="models-for-two-or-more-categorical-x-factorial-designs.html"><a href="models-for-two-or-more-categorical-x-factorial-designs.html#analysis"><i class="fa fa-check"></i><b>15.2.1</b> Analysis</a></li>
<li class="chapter" data-level="15.2.2" data-path="models-for-two-or-more-categorical-x-factorial-designs.html"><a href="models-for-two-or-more-categorical-x-factorial-designs.html#a-factorial-model-adds-an-interaction-effect-to-the-coefficients-table"><i class="fa fa-check"></i><b>15.2.2</b> A factorial model adds an interaction effect to the coefficients table</a></li>
<li class="chapter" data-level="15.2.3" data-path="models-for-two-or-more-categorical-x-factorial-designs.html"><a href="models-for-two-or-more-categorical-x-factorial-designs.html#the-biological-interpretation-of-an-interaction-effect"><i class="fa fa-check"></i><b>15.2.3</b> The biological interpretation of an interaction effect</a></li>
<li class="chapter" data-level="15.2.4" data-path="models-for-two-or-more-categorical-x-factorial-designs.html"><a href="models-for-two-or-more-categorical-x-factorial-designs.html#conditional-and-marginal-means"><i class="fa fa-check"></i><b>15.2.4</b> Conditional and marginal means</a></li>
<li class="chapter" data-level="15.2.5" data-path="models-for-two-or-more-categorical-x-factorial-designs.html"><a href="models-for-two-or-more-categorical-x-factorial-designs.html#simple-conditional-effects"><i class="fa fa-check"></i><b>15.2.5</b> Simple (conditional) effects</a></li>
<li class="chapter" data-level="15.2.6" data-path="models-for-two-or-more-categorical-x-factorial-designs.html"><a href="models-for-two-or-more-categorical-x-factorial-designs.html#marginal-effects"><i class="fa fa-check"></i><b>15.2.6</b> Marginal effects</a></li>
<li class="chapter" data-level="15.2.7" data-path="models-for-two-or-more-categorical-x-factorial-designs.html"><a href="models-for-two-or-more-categorical-x-factorial-designs.html#the-additive-model"><i class="fa fa-check"></i><b>15.2.7</b> The additive model</a></li>
<li class="chapter" data-level="15.2.8" data-path="models-for-two-or-more-categorical-x-factorial-designs.html"><a href="models-for-two-or-more-categorical-x-factorial-designs.html#reduce-models-for-the-right-reason"><i class="fa fa-check"></i><b>15.2.8</b> Reduce models for the right reason</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="models-for-two-or-more-categorical-x-factorial-designs.html"><a href="models-for-two-or-more-categorical-x-factorial-designs.html#working-in-r-5"><i class="fa fa-check"></i><b>15.3</b> Working in R</a><ul>
<li class="chapter" data-level="15.3.1" data-path="models-for-two-or-more-categorical-x-factorial-designs.html"><a href="models-for-two-or-more-categorical-x-factorial-designs.html#model-formula"><i class="fa fa-check"></i><b>15.3.1</b> Model formula</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="anova-tables.html"><a href="anova-tables.html"><i class="fa fa-check"></i><b>16</b> ANOVA Tables</a><ul>
<li class="chapter" data-level="16.1" data-path="anova-tables.html"><a href="anova-tables.html#summary-of-usage"><i class="fa fa-check"></i><b>16.1</b> Summary of usage</a></li>
<li class="chapter" data-level="16.2" data-path="anova-tables.html"><a href="anova-tables.html#example-a-one-way-anova-using-the-vole-data"><i class="fa fa-check"></i><b>16.2</b> Example: a one-way ANOVA using the vole data</a></li>
<li class="chapter" data-level="16.3" data-path="anova-tables.html"><a href="anova-tables.html#example-a-two-way-anova-using-the-urchin-data"><i class="fa fa-check"></i><b>16.3</b> Example: a two-way ANOVA using the urchin data</a><ul>
<li class="chapter" data-level="16.3.1" data-path="anova-tables.html"><a href="anova-tables.html#how-to-read-an-anova-table"><i class="fa fa-check"></i><b>16.3.1</b> How to read an ANOVA table</a></li>
<li class="chapter" data-level="16.3.2" data-path="anova-tables.html"><a href="anova-tables.html#how-to-read-anova-results-reported-in-the-text"><i class="fa fa-check"></i><b>16.3.2</b> How to read ANOVA results reported in the text</a></li>
<li class="chapter" data-level="16.3.3" data-path="anova-tables.html"><a href="anova-tables.html#better-practice-estimates-and-their-uncertainty"><i class="fa fa-check"></i><b>16.3.3</b> Better practice – estimates and their uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="anova-tables.html"><a href="anova-tables.html#unbalanced-designs"><i class="fa fa-check"></i><b>16.4</b> Unbalanced designs</a><ul>
<li class="chapter" data-level="16.4.1" data-path="anova-tables.html"><a href="anova-tables.html#what-is-going-on-in-unbalanced-anova-type-i-ii-iii-sum-of-squares"><i class="fa fa-check"></i><b>16.4.1</b> What is going on in unbalanced ANOVA? – Type I, II, III sum of squares</a></li>
<li class="chapter" data-level="16.4.2" data-path="anova-tables.html"><a href="anova-tables.html#back-to-interpretation-of-main-effects"><i class="fa fa-check"></i><b>16.4.2</b> Back to interpretation of main effects</a></li>
<li class="chapter" data-level="16.4.3" data-path="anova-tables.html"><a href="anova-tables.html#the-anova-tables-for-type-i-ii-and-iii-sum-of-squares-are-the-same-if-the-design-is-balanced."><i class="fa fa-check"></i><b>16.4.3</b> The anova tables for Type I, II, and III sum of squares are the same if the design is balanced.</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="anova-tables.html"><a href="anova-tables.html#working-in-r-6"><i class="fa fa-check"></i><b>16.5</b> Working in R</a><ul>
<li class="chapter" data-level="16.5.1" data-path="anova-tables.html"><a href="anova-tables.html#type-i-sum-of-squares-in-r"><i class="fa fa-check"></i><b>16.5.1</b> Type I sum of squares in R</a></li>
<li class="chapter" data-level="16.5.2" data-path="anova-tables.html"><a href="anova-tables.html#type-ii-and-iii-sum-of-squares"><i class="fa fa-check"></i><b>16.5.2</b> Type II and III Sum of Squares</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="predictive-models.html"><a href="predictive-models.html"><i class="fa fa-check"></i><b>17</b> Predictive Models</a><ul>
<li class="chapter" data-level="17.1" data-path="predictive-models.html"><a href="predictive-models.html#overfitting"><i class="fa fa-check"></i><b>17.1</b> Overfitting</a></li>
<li class="chapter" data-level="17.2" data-path="predictive-models.html"><a href="predictive-models.html#model-building-vs.-variable-selection-vs.-model-selection"><i class="fa fa-check"></i><b>17.2</b> Model building vs. Variable selection vs. Model selection</a><ul>
<li class="chapter" data-level="17.2.1" data-path="predictive-models.html"><a href="predictive-models.html#stepwise-regression"><i class="fa fa-check"></i><b>17.2.1</b> Stepwise regression</a></li>
<li class="chapter" data-level="17.2.2" data-path="predictive-models.html"><a href="predictive-models.html#cross-validation"><i class="fa fa-check"></i><b>17.2.2</b> Cross-validation</a></li>
<li class="chapter" data-level="17.2.3" data-path="predictive-models.html"><a href="predictive-models.html#penalization"><i class="fa fa-check"></i><b>17.2.3</b> Penalization</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="predictive-models.html"><a href="predictive-models.html#shrinkage"><i class="fa fa-check"></i><b>17.3</b> Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-vii-expanding-the-linear-model.html"><a href="part-vii-expanding-the-linear-model.html"><i class="fa fa-check"></i>Part VII – Expanding the Linear Model</a></li>
<li class="chapter" data-level="18" data-path="models-with-random-effects-blocking-and-pseudoreplication.html"><a href="models-with-random-effects-blocking-and-pseudoreplication.html"><i class="fa fa-check"></i><b>18</b> Models with random effects – Blocking and pseudoreplication</a><ul>
<li class="chapter" data-level="18.1" data-path="models-with-random-effects-blocking-and-pseudoreplication.html"><a href="models-with-random-effects-blocking-and-pseudoreplication.html#random-effects"><i class="fa fa-check"></i><b>18.1</b> Random effects</a></li>
<li class="chapter" data-level="18.2" data-path="models-with-random-effects-blocking-and-pseudoreplication.html"><a href="models-with-random-effects-blocking-and-pseudoreplication.html#random-effects-in-statistical-models"><i class="fa fa-check"></i><b>18.2</b> Random effects in statistical models</a></li>
<li class="chapter" data-level="18.3" data-path="models-with-random-effects-blocking-and-pseudoreplication.html"><a href="models-with-random-effects-blocking-and-pseudoreplication.html#linear-mixed-models-are-flexible"><i class="fa fa-check"></i><b>18.3</b> Linear mixed models are flexible</a></li>
<li class="chapter" data-level="18.4" data-path="models-with-random-effects-blocking-and-pseudoreplication.html"><a href="models-with-random-effects-blocking-and-pseudoreplication.html#blocking"><i class="fa fa-check"></i><b>18.4</b> Blocking</a><ul>
<li class="chapter" data-level="18.4.1" data-path="models-with-random-effects-blocking-and-pseudoreplication.html"><a href="models-with-random-effects-blocking-and-pseudoreplication.html#visualing-variation-due-to-blocks"><i class="fa fa-check"></i><b>18.4.1</b> Visualing variation due to blocks</a></li>
<li class="chapter" data-level="18.4.2" data-path="models-with-random-effects-blocking-and-pseudoreplication.html"><a href="models-with-random-effects-blocking-and-pseudoreplication.html#blocking-increases-precision-of-point-estimates"><i class="fa fa-check"></i><b>18.4.2</b> Blocking increases precision of point estimates</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="models-with-random-effects-blocking-and-pseudoreplication.html"><a href="models-with-random-effects-blocking-and-pseudoreplication.html#pseudoreplication"><i class="fa fa-check"></i><b>18.5</b> Pseudoreplication</a><ul>
<li class="chapter" data-level="18.5.1" data-path="models-with-random-effects-blocking-and-pseudoreplication.html"><a href="models-with-random-effects-blocking-and-pseudoreplication.html#visualizing-pseduoreplication"><i class="fa fa-check"></i><b>18.5.1</b> Visualizing pseduoreplication</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="models-with-random-effects-blocking-and-pseudoreplication.html"><a href="models-with-random-effects-blocking-and-pseudoreplication.html#mapping-nhst-to-estimation-a-paired-t-test-is-a-special-case-of-a-linear-mixed-model"><i class="fa fa-check"></i><b>18.6</b> Mapping NHST to estimation: A paired t-test is a special case of a linear mixed model</a></li>
<li class="chapter" data-level="18.7" data-path="models-with-random-effects-blocking-and-pseudoreplication.html"><a href="models-with-random-effects-blocking-and-pseudoreplication.html#advanced-topic-linear-mixed-models-shrink-coefficients-by-partial-pooling"><i class="fa fa-check"></i><b>18.7</b> Advanced topic – Linear mixed models shrink coefficients by partial pooling</a></li>
<li class="chapter" data-level="18.8" data-path="models-with-random-effects-blocking-and-pseudoreplication.html"><a href="models-with-random-effects-blocking-and-pseudoreplication.html#working-in-r-7"><i class="fa fa-check"></i><b>18.8</b> Working in R</a><ul>
<li class="chapter" data-level="18.8.1" data-path="models-with-random-effects-blocking-and-pseudoreplication.html"><a href="models-with-random-effects-blocking-and-pseudoreplication.html#coral-data"><i class="fa fa-check"></i><b>18.8.1</b> coral data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html"><i class="fa fa-check"></i><b>19</b> Models for longitudinal experiments – I. pre-post designs</a><ul>
<li class="chapter" data-level="19.1" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#best-practice-models"><i class="fa fa-check"></i><b>19.1</b> Best practice models</a></li>
<li class="chapter" data-level="19.2" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#common-alternatives-that-are-not-recommended"><i class="fa fa-check"></i><b>19.2</b> Common alternatives that are not recommended</a></li>
<li class="chapter" data-level="19.3" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#advanced-models"><i class="fa fa-check"></i><b>19.3</b> Advanced models</a></li>
<li class="chapter" data-level="19.4" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#understanding-the-alternative-models"><i class="fa fa-check"></i><b>19.4</b> Understanding the alternative models</a><ul>
<li class="chapter" data-level="19.4.1" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model"><i class="fa fa-check"></i><b>19.4.1</b> (M1) Linear model with the baseline measure as the covariate (ANCOVA model)</a></li>
<li class="chapter" data-level="19.4.2" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#m2-linear-model-of-the-change-score-change-score-model"><i class="fa fa-check"></i><b>19.4.2</b> (M2) Linear model of the change score (change-score model)</a></li>
<li class="chapter" data-level="19.4.3" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model"><i class="fa fa-check"></i><b>19.4.3</b> (M3) Linear model of post-baseline values without the baseline as a covariate (post model)</a></li>
<li class="chapter" data-level="19.4.4" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#m4-linear-model-with-factorial-fixed-effects-fixed-effects-model"><i class="fa fa-check"></i><b>19.4.4</b> (M4) Linear model with factorial fixed effects (fixed-effects model)</a></li>
<li class="chapter" data-level="19.4.5" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#m5-repeated-measures-anova"><i class="fa fa-check"></i><b>19.4.5</b> (M5) Repeated measures ANOVA</a></li>
<li class="chapter" data-level="19.4.6" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#m6-linear-mixed-model"><i class="fa fa-check"></i><b>19.4.6</b> (M6) Linear mixed model</a></li>
<li class="chapter" data-level="19.4.7" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#m7-linear-model-with-correlated-error"><i class="fa fa-check"></i><b>19.4.7</b> (M7) Linear model with correlated error</a></li>
<li class="chapter" data-level="19.4.8" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#m8-constrained-fixed-effects-model-with-correlated-error-clda-model"><i class="fa fa-check"></i><b>19.4.8</b> (M8) Constrained fixed effects model with correlated error (cLDA model)</a></li>
<li class="chapter" data-level="19.4.9" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#comparison-table"><i class="fa fa-check"></i><b>19.4.9</b> Comparison table</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#example-1-a-single-post-baseline-measure-pre-post-design"><i class="fa fa-check"></i><b>19.5</b> Example 1 – a single post-baseline measure (pre-post design)</a></li>
<li class="chapter" data-level="19.6" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#working-in-r-8"><i class="fa fa-check"></i><b>19.6</b> Working in R</a></li>
<li class="chapter" data-level="19.7" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#hidden-code-2"><i class="fa fa-check"></i><b>19.7</b> Hidden code</a><ul>
<li class="chapter" data-level="19.7.1" data-path="models-for-longitudinal-experiments-i-pre-post-designs.html"><a href="models-for-longitudinal-experiments-i-pre-post-designs.html#import-and-wrangle-mouse-sociability-data"><i class="fa fa-check"></i><b>19.7.1</b> Import and wrangle mouse sociability data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html"><i class="fa fa-check"></i><b>20</b> Generalized linear models I: Count data</a><ul>
<li class="chapter" data-level="20.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#the-generalized-linear-model"><i class="fa fa-check"></i><b>20.1</b> The generalized linear model</a></li>
<li class="chapter" data-level="20.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish"><i class="fa fa-check"></i><b>20.2</b> Count data example – number of trematode worm larvae in eyes of threespine stickleback fish</a><ul>
<li class="chapter" data-level="20.2.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#modeling-strategy-1"><i class="fa fa-check"></i><b>20.2.1</b> Modeling strategy</a></li>
<li class="chapter" data-level="20.2.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#checking-the-model-i-a-normal-q-q-plot"><i class="fa fa-check"></i><b>20.2.2</b> Checking the model I – a Normal Q-Q plot</a></li>
<li class="chapter" data-level="20.2.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#checking-the-model-ii-scale-location-plot-for-checking-homoskedasticity"><i class="fa fa-check"></i><b>20.2.3</b> Checking the model II – scale-location plot for checking homoskedasticity</a></li>
<li class="chapter" data-level="20.2.4" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#two-distributions-for-count-data-poisson-and-negative-binomial"><i class="fa fa-check"></i><b>20.2.4</b> Two distributions for count data – Poisson and Negative Binomial</a></li>
<li class="chapter" data-level="20.2.5" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-with-a-poisson-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>20.2.5</b> Fitting a GLM with a Poisson distribution to the worm data</a></li>
<li class="chapter" data-level="20.2.6" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#model-checking-fits-to-count-data"><i class="fa fa-check"></i><b>20.2.6</b> Model checking fits to count data</a></li>
<li class="chapter" data-level="20.2.7" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-with-a-negative-binomial-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>20.2.7</b> Fitting a GLM with a Negative Binomial distribution to the worm data</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#working-in-r-9"><i class="fa fa-check"></i><b>20.3</b> Working in R</a><ul>
<li class="chapter" data-level="20.3.1" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-glm-to-count-data"><i class="fa fa-check"></i><b>20.3.1</b> Fitting a GLM to count data</a></li>
<li class="chapter" data-level="20.3.2" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-generalized-linear-mixed-model-glmm-to-count-data"><i class="fa fa-check"></i><b>20.3.2</b> Fitting a generalized linear mixed model (GLMM) to count data</a></li>
<li class="chapter" data-level="20.3.3" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#fitting-a-generalized-linear-model-to-continouus-data"><i class="fa fa-check"></i><b>20.3.3</b> Fitting a generalized linear model to continouus data</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="generalized-linear-models-i-count-data.html"><a href="generalized-linear-models-i-count-data.html#problems-1"><i class="fa fa-check"></i><b>20.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="linear-models-with-heterogenous-variance.html"><a href="linear-models-with-heterogenous-variance.html"><i class="fa fa-check"></i><b>21</b> Linear models with heterogenous variance</a><ul>
<li class="chapter" data-level="21.1" data-path="linear-models-with-heterogenous-variance.html"><a href="linear-models-with-heterogenous-variance.html#gls"><i class="fa fa-check"></i><b>21.1</b> gls</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"><a href="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html"><i class="fa fa-check"></i>Part V: Expanding the Linear Model – Generalized Linear Models and Multilevel (Linear Mixed) Models</a></li>
<li class="chapter" data-level="22" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html"><i class="fa fa-check"></i><b>22</b> Plotting functions (#ggplotsci)</a><ul>
<li class="chapter" data-level="22.1" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#odd-even"><i class="fa fa-check"></i><b>22.1</b> odd-even</a></li>
<li class="chapter" data-level="22.2" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#estimate-response-and-effects-with-emmeans"><i class="fa fa-check"></i><b>22.2</b> estimate response and effects with emmeans</a></li>
<li class="chapter" data-level="22.3" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#emm_table"><i class="fa fa-check"></i><b>22.3</b> emm_table</a></li>
<li class="chapter" data-level="22.4" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#pairs_table"><i class="fa fa-check"></i><b>22.4</b> pairs_table</a></li>
<li class="chapter" data-level="22.5" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#gg_mean_error"><i class="fa fa-check"></i><b>22.5</b> gg_mean_error</a></li>
<li class="chapter" data-level="22.6" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#gg_ancova"><i class="fa fa-check"></i><b>22.6</b> gg_ancova</a></li>
<li class="chapter" data-level="22.7" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#gg_mean_ci_ancova"><i class="fa fa-check"></i><b>22.7</b> gg_mean_ci_ancova</a></li>
<li class="chapter" data-level="22.8" data-path="plotting-functions-ggplotsci.html"><a href="plotting-functions-ggplotsci.html#gg_effects"><i class="fa fa-check"></i><b>22.8</b> gg_effects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html"><i class="fa fa-check"></i>Appendix 1: Getting Started with R</a><ul>
<li class="chapter" data-level="22.9" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready"><i class="fa fa-check"></i><b>22.9</b> Get your computer ready</a><ul>
<li class="chapter" data-level="22.9.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-here"><i class="fa fa-check"></i><b>22.9.1</b> Start here</a></li>
<li class="chapter" data-level="22.9.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r"><i class="fa fa-check"></i><b>22.9.2</b> Install R</a></li>
<li class="chapter" data-level="22.9.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-studio"><i class="fa fa-check"></i><b>22.9.3</b> Install R Studio</a></li>
<li class="chapter" data-level="22.9.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-markdown-1"><i class="fa fa-check"></i><b>22.9.4</b> Install R Markdown</a></li>
<li class="chapter" data-level="22.9.5" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#optional-alternative-latex-installations"><i class="fa fa-check"></i><b>22.9.5</b> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li class="chapter" data-level="22.10" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-learning-r-studio"><i class="fa fa-check"></i><b>22.10</b> Start learning R Studio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><i class="fa fa-check"></i>Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Elements of Statistical Modeling for Experimental Biology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-functions-ggplotsci" class="section level1">
<h1><span class="header-section-number">Chapter 22</span> Plotting functions (#ggplotsci)</h1>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="plotting-functions-ggplotsci.html#cb508-1"></a><span class="co"># palettes</span></span>
<span id="cb508-2"><a href="plotting-functions-ggplotsci.html#cb508-2"></a></span>
<span id="cb508-3"><a href="plotting-functions-ggplotsci.html#cb508-3"></a><span class="co"># http://mkweb.bcgsc.ca/colorblind/palettes.mhtml#page-container</span></span>
<span id="cb508-4"><a href="plotting-functions-ggplotsci.html#cb508-4"></a>pal_nature &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb508-5"><a href="plotting-functions-ggplotsci.html#cb508-5"></a>  <span class="st">&quot;#2271B2&quot;</span>, <span class="co"># honolulu blue</span></span>
<span id="cb508-6"><a href="plotting-functions-ggplotsci.html#cb508-6"></a>  <span class="st">&quot;#3DB7E9&quot;</span>, <span class="co"># summer sky</span></span>
<span id="cb508-7"><a href="plotting-functions-ggplotsci.html#cb508-7"></a>  <span class="st">&quot;#F748A5&quot;</span>, <span class="co"># barbi pink</span></span>
<span id="cb508-8"><a href="plotting-functions-ggplotsci.html#cb508-8"></a>  <span class="st">&quot;#359B73&quot;</span>, <span class="co"># ocean green</span></span>
<span id="cb508-9"><a href="plotting-functions-ggplotsci.html#cb508-9"></a>  <span class="st">&quot;#d55e00&quot;</span>, <span class="co"># bamboo</span></span>
<span id="cb508-10"><a href="plotting-functions-ggplotsci.html#cb508-10"></a>  <span class="st">&quot;#e69f00&quot;</span>, <span class="co"># gamboge, squash, buttercup</span></span>
<span id="cb508-11"><a href="plotting-functions-ggplotsci.html#cb508-11"></a>  <span class="st">&quot;#f0e442&quot;</span> <span class="co"># holiday, </span></span>
<span id="cb508-12"><a href="plotting-functions-ggplotsci.html#cb508-12"></a>)</span>
<span id="cb508-13"><a href="plotting-functions-ggplotsci.html#cb508-13"></a></span>
<span id="cb508-14"><a href="plotting-functions-ggplotsci.html#cb508-14"></a>pal_nature_black &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb508-15"><a href="plotting-functions-ggplotsci.html#cb508-15"></a>  <span class="st">&quot;#000000&quot;</span>, <span class="co"># black</span></span>
<span id="cb508-16"><a href="plotting-functions-ggplotsci.html#cb508-16"></a>  <span class="st">&quot;#2271B2&quot;</span>, <span class="co"># honolulu blue</span></span>
<span id="cb508-17"><a href="plotting-functions-ggplotsci.html#cb508-17"></a>  <span class="st">&quot;#3DB7E9&quot;</span>, <span class="co"># summer sky</span></span>
<span id="cb508-18"><a href="plotting-functions-ggplotsci.html#cb508-18"></a>  <span class="st">&quot;#F748A5&quot;</span>, <span class="co"># barbi pink</span></span>
<span id="cb508-19"><a href="plotting-functions-ggplotsci.html#cb508-19"></a>  <span class="st">&quot;#359B73&quot;</span>, <span class="co"># ocean green</span></span>
<span id="cb508-20"><a href="plotting-functions-ggplotsci.html#cb508-20"></a>  <span class="st">&quot;#d55e00&quot;</span>, <span class="co"># bamboo</span></span>
<span id="cb508-21"><a href="plotting-functions-ggplotsci.html#cb508-21"></a>  <span class="st">&quot;#e69f00&quot;</span>, <span class="co"># gamboge, squash, buttercup</span></span>
<span id="cb508-22"><a href="plotting-functions-ggplotsci.html#cb508-22"></a>  <span class="st">&quot;#f0e442&quot;</span> <span class="co"># holiday, </span></span>
<span id="cb508-23"><a href="plotting-functions-ggplotsci.html#cb508-23"></a>)</span>
<span id="cb508-24"><a href="plotting-functions-ggplotsci.html#cb508-24"></a></span>
<span id="cb508-25"><a href="plotting-functions-ggplotsci.html#cb508-25"></a>pal_nature_black_mod &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb508-26"><a href="plotting-functions-ggplotsci.html#cb508-26"></a>  <span class="st">&quot;#000000&quot;</span>, <span class="co"># black</span></span>
<span id="cb508-27"><a href="plotting-functions-ggplotsci.html#cb508-27"></a>  <span class="st">&quot;#3DB7E9&quot;</span>, <span class="co"># summer sky</span></span>
<span id="cb508-28"><a href="plotting-functions-ggplotsci.html#cb508-28"></a>  <span class="st">&quot;#e69f00&quot;</span>, <span class="co"># gamboge, squash, buttercup</span></span>
<span id="cb508-29"><a href="plotting-functions-ggplotsci.html#cb508-29"></a>  <span class="st">&quot;#359B73&quot;</span>, <span class="co"># ocean green</span></span>
<span id="cb508-30"><a href="plotting-functions-ggplotsci.html#cb508-30"></a>  <span class="st">&quot;#2271B2&quot;</span>, <span class="co"># honolulu blue</span></span>
<span id="cb508-31"><a href="plotting-functions-ggplotsci.html#cb508-31"></a>  <span class="st">&quot;#f0e442&quot;</span>, <span class="co"># holiday, </span></span>
<span id="cb508-32"><a href="plotting-functions-ggplotsci.html#cb508-32"></a>  <span class="st">&quot;#F748A5&quot;</span>, <span class="co"># barbi pink</span></span>
<span id="cb508-33"><a href="plotting-functions-ggplotsci.html#cb508-33"></a>  <span class="st">&quot;#d55e00&quot;</span> <span class="co"># bamboo</span></span>
<span id="cb508-34"><a href="plotting-functions-ggplotsci.html#cb508-34"></a>)</span>
<span id="cb508-35"><a href="plotting-functions-ggplotsci.html#cb508-35"></a></span>
<span id="cb508-36"><a href="plotting-functions-ggplotsci.html#cb508-36"></a>pal_nature_mod &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb508-37"><a href="plotting-functions-ggplotsci.html#cb508-37"></a>  <span class="st">&quot;#3DB7E9&quot;</span>, <span class="co"># summer sky</span></span>
<span id="cb508-38"><a href="plotting-functions-ggplotsci.html#cb508-38"></a>  <span class="st">&quot;#e69f00&quot;</span>, <span class="co"># gamboge, squash, buttercup</span></span>
<span id="cb508-39"><a href="plotting-functions-ggplotsci.html#cb508-39"></a>  <span class="st">&quot;#359B73&quot;</span>, <span class="co"># ocean green</span></span>
<span id="cb508-40"><a href="plotting-functions-ggplotsci.html#cb508-40"></a>  <span class="st">&quot;#2271B2&quot;</span>, <span class="co"># honolulu blue</span></span>
<span id="cb508-41"><a href="plotting-functions-ggplotsci.html#cb508-41"></a>  <span class="st">&quot;#f0e442&quot;</span>, <span class="co"># holiday, </span></span>
<span id="cb508-42"><a href="plotting-functions-ggplotsci.html#cb508-42"></a>  <span class="st">&quot;#F748A5&quot;</span>, <span class="co"># barbi pink</span></span>
<span id="cb508-43"><a href="plotting-functions-ggplotsci.html#cb508-43"></a>  <span class="st">&quot;#d55e00&quot;</span> <span class="co"># bamboo</span></span>
<span id="cb508-44"><a href="plotting-functions-ggplotsci.html#cb508-44"></a>)</span>
<span id="cb508-45"><a href="plotting-functions-ggplotsci.html#cb508-45"></a></span>
<span id="cb508-46"><a href="plotting-functions-ggplotsci.html#cb508-46"></a>pal_nature_alt &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb508-47"><a href="plotting-functions-ggplotsci.html#cb508-47"></a>  <span class="st">&quot;#AA0DB4&quot;</span>, <span class="co"># barney</span></span>
<span id="cb508-48"><a href="plotting-functions-ggplotsci.html#cb508-48"></a>  <span class="st">&quot;#FF54ED&quot;</span>, <span class="co"># light magenta</span></span>
<span id="cb508-49"><a href="plotting-functions-ggplotsci.html#cb508-49"></a>  <span class="st">&quot;#00B19F&quot;</span>, <span class="co"># strong opal</span></span>
<span id="cb508-50"><a href="plotting-functions-ggplotsci.html#cb508-50"></a>  <span class="st">&quot;#EB057A&quot;</span>, <span class="co"># vivid rose</span></span>
<span id="cb508-51"><a href="plotting-functions-ggplotsci.html#cb508-51"></a>  <span class="st">&quot;#F8071D&quot;</span>, <span class="co"># vivid red</span></span>
<span id="cb508-52"><a href="plotting-functions-ggplotsci.html#cb508-52"></a>  <span class="st">&quot;#FF8D1A&quot;</span>, <span class="co"># dark orange</span></span>
<span id="cb508-53"><a href="plotting-functions-ggplotsci.html#cb508-53"></a>  <span class="st">&quot;#9EFF37&quot;</span> <span class="co"># french lime, </span></span>
<span id="cb508-54"><a href="plotting-functions-ggplotsci.html#cb508-54"></a>)</span>
<span id="cb508-55"><a href="plotting-functions-ggplotsci.html#cb508-55"></a></span>
<span id="cb508-56"><a href="plotting-functions-ggplotsci.html#cb508-56"></a></span>
<span id="cb508-57"><a href="plotting-functions-ggplotsci.html#cb508-57"></a><span class="co"># https://mikemol.github.io/technique/colorblind/2018/02/11/color-safe-palette.html</span></span>
<span id="cb508-58"><a href="plotting-functions-ggplotsci.html#cb508-58"></a><span class="co"># https://thenode.biologists.com/data-visualization-with-flying-colors/research/</span></span>
<span id="cb508-59"><a href="plotting-functions-ggplotsci.html#cb508-59"></a></span>
<span id="cb508-60"><a href="plotting-functions-ggplotsci.html#cb508-60"></a>pal_okabe_ito &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb508-61"><a href="plotting-functions-ggplotsci.html#cb508-61"></a>  <span class="st">&quot;#E69F00&quot;</span>,</span>
<span id="cb508-62"><a href="plotting-functions-ggplotsci.html#cb508-62"></a>  <span class="st">&quot;#56B4E9&quot;</span>,</span>
<span id="cb508-63"><a href="plotting-functions-ggplotsci.html#cb508-63"></a>  <span class="st">&quot;#009E73&quot;</span>,</span>
<span id="cb508-64"><a href="plotting-functions-ggplotsci.html#cb508-64"></a>  <span class="st">&quot;#F0E442&quot;</span>,</span>
<span id="cb508-65"><a href="plotting-functions-ggplotsci.html#cb508-65"></a>  <span class="st">&quot;#0072B2&quot;</span>,</span>
<span id="cb508-66"><a href="plotting-functions-ggplotsci.html#cb508-66"></a>  <span class="st">&quot;#D55E00&quot;</span>,</span>
<span id="cb508-67"><a href="plotting-functions-ggplotsci.html#cb508-67"></a>  <span class="st">&quot;#CC79A7&quot;</span></span>
<span id="cb508-68"><a href="plotting-functions-ggplotsci.html#cb508-68"></a>)</span></code></pre></div>
<div id="odd-even" class="section level2">
<h2><span class="header-section-number">22.1</span> odd-even</h2>
<p>This is a function used in the funtion to create a p-value table that is used in the plots. A user is unlikely to ever directly call this function.</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="plotting-functions-ggplotsci.html#cb509-1"></a>odd &lt;-<span class="st"> </span><span class="cf">function</span>(x) x<span class="op">%%</span><span class="dv">2</span> <span class="op">!=</span><span class="st"> </span><span class="dv">0</span></span>
<span id="cb509-2"><a href="plotting-functions-ggplotsci.html#cb509-2"></a>even &lt;-<span class="st"> </span><span class="cf">function</span>(x) x<span class="op">%%</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span></span></code></pre></div>
</div>
<div id="estimate-response-and-effects-with-emmeans" class="section level2">
<h2><span class="header-section-number">22.2</span> estimate response and effects with emmeans</h2>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="plotting-functions-ggplotsci.html#cb510-1"></a>estimate &lt;-<span class="st"> </span><span class="cf">function</span>(fit, <span class="co"># model fit</span></span>
<span id="cb510-2"><a href="plotting-functions-ggplotsci.html#cb510-2"></a>                     specs, <span class="co"># factor(s)</span></span>
<span id="cb510-3"><a href="plotting-functions-ggplotsci.html#cb510-3"></a>                     <span class="dt">method =</span> <span class="st">&quot;revpairwise&quot;</span>, <span class="co"># revpairwise</span></span>
<span id="cb510-4"><a href="plotting-functions-ggplotsci.html#cb510-4"></a>                     <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="co"># &quot;link&quot;, &quot;response&quot;</span></span>
<span id="cb510-5"><a href="plotting-functions-ggplotsci.html#cb510-5"></a>                     <span class="dt">adjust =</span> <span class="st">&quot;none&quot;</span> <span class="co"># p-value</span></span>
<span id="cb510-6"><a href="plotting-functions-ggplotsci.html#cb510-6"></a>){</span>
<span id="cb510-7"><a href="plotting-functions-ggplotsci.html#cb510-7"></a>  <span class="co"># response table</span></span>
<span id="cb510-8"><a href="plotting-functions-ggplotsci.html#cb510-8"></a>  fit_emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(fit, <span class="dt">specs =</span> specs, <span class="dt">type =</span> type)</span>
<span id="cb510-9"><a href="plotting-functions-ggplotsci.html#cb510-9"></a>  response_table &lt;-<span class="st"> </span><span class="kw">emm_table</span>(fit_emm)</span>
<span id="cb510-10"><a href="plotting-functions-ggplotsci.html#cb510-10"></a>  </span>
<span id="cb510-11"><a href="plotting-functions-ggplotsci.html#cb510-11"></a>  <span class="co"># effect table</span></span>
<span id="cb510-12"><a href="plotting-functions-ggplotsci.html#cb510-12"></a>  fit_pairs &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">contrast</span>(fit_emm,</span>
<span id="cb510-13"><a href="plotting-functions-ggplotsci.html#cb510-13"></a>                                <span class="dt">method =</span> method,</span>
<span id="cb510-14"><a href="plotting-functions-ggplotsci.html#cb510-14"></a>                                <span class="dt">type =</span> type,</span>
<span id="cb510-15"><a href="plotting-functions-ggplotsci.html#cb510-15"></a>                                <span class="dt">adjust =</span> adjust,</span>
<span id="cb510-16"><a href="plotting-functions-ggplotsci.html#cb510-16"></a>                                <span class="dt">simple =</span> <span class="st">&quot;each&quot;</span>,</span>
<span id="cb510-17"><a href="plotting-functions-ggplotsci.html#cb510-17"></a>                                <span class="dt">combine =</span> <span class="ot">TRUE</span>),</span>
<span id="cb510-18"><a href="plotting-functions-ggplotsci.html#cb510-18"></a>                       <span class="dt">infer =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb510-19"><a href="plotting-functions-ggplotsci.html#cb510-19"></a><span class="st">    </span><span class="kw">data.table</span>()</span>
<span id="cb510-20"><a href="plotting-functions-ggplotsci.html#cb510-20"></a>  effect_table &lt;-<span class="st"> </span><span class="kw">pairs_table</span>(fit_pairs)</span>
<span id="cb510-21"><a href="plotting-functions-ggplotsci.html#cb510-21"></a>  </span>
<span id="cb510-22"><a href="plotting-functions-ggplotsci.html#cb510-22"></a>  <span class="kw">return</span>(<span class="kw">list</span>(</span>
<span id="cb510-23"><a href="plotting-functions-ggplotsci.html#cb510-23"></a>    <span class="dt">response =</span> response_table,</span>
<span id="cb510-24"><a href="plotting-functions-ggplotsci.html#cb510-24"></a>    <span class="dt">effect =</span> effect_table))</span>
<span id="cb510-25"><a href="plotting-functions-ggplotsci.html#cb510-25"></a>}</span></code></pre></div>
</div>
<div id="emm_table" class="section level2">
<h2><span class="header-section-number">22.3</span> emm_table</h2>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="plotting-functions-ggplotsci.html#cb511-1"></a>emm_table &lt;-<span class="st"> </span><span class="cf">function</span>(fit_emm){</span>
<span id="cb511-2"><a href="plotting-functions-ggplotsci.html#cb511-2"></a>  table_out &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="kw">summary</span>(fit_emm))</span>
<span id="cb511-3"><a href="plotting-functions-ggplotsci.html#cb511-3"></a>  <span class="cf">if</span>(<span class="st">&quot;response&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">colnames</span>(table_out)){</span>
<span id="cb511-4"><a href="plotting-functions-ggplotsci.html#cb511-4"></a>    <span class="co"># if the lm with log(y) or glm with log link, use &quot; / &quot;</span></span>
<span id="cb511-5"><a href="plotting-functions-ggplotsci.html#cb511-5"></a>    <span class="kw">setnames</span>(table_out,</span>
<span id="cb511-6"><a href="plotting-functions-ggplotsci.html#cb511-6"></a>             <span class="dt">old =</span> <span class="kw">c</span>(<span class="st">&quot;response&quot;</span>),</span>
<span id="cb511-7"><a href="plotting-functions-ggplotsci.html#cb511-7"></a>             <span class="dt">new =</span> <span class="kw">c</span>(<span class="st">&quot;emmean&quot;</span>))</span>
<span id="cb511-8"><a href="plotting-functions-ggplotsci.html#cb511-8"></a>  }</span>
<span id="cb511-9"><a href="plotting-functions-ggplotsci.html#cb511-9"></a>  <span class="cf">if</span>(<span class="st">&quot;asymp.LCL&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">colnames</span>(table_out)){</span>
<span id="cb511-10"><a href="plotting-functions-ggplotsci.html#cb511-10"></a>    <span class="co"># if the lm with log(y) or glm with log link, use &quot; / &quot;</span></span>
<span id="cb511-11"><a href="plotting-functions-ggplotsci.html#cb511-11"></a>    <span class="kw">setnames</span>(table_out,</span>
<span id="cb511-12"><a href="plotting-functions-ggplotsci.html#cb511-12"></a>             <span class="dt">old =</span> <span class="kw">c</span>(<span class="st">&quot;asymp.LCL&quot;</span>, <span class="st">&quot;asymp.UCL&quot;</span>),</span>
<span id="cb511-13"><a href="plotting-functions-ggplotsci.html#cb511-13"></a>             <span class="dt">new =</span> <span class="kw">c</span>(<span class="st">&quot;lower.CL&quot;</span>, <span class="st">&quot;upper.CL&quot;</span>))</span>
<span id="cb511-14"><a href="plotting-functions-ggplotsci.html#cb511-14"></a>  }</span>
<span id="cb511-15"><a href="plotting-functions-ggplotsci.html#cb511-15"></a>  <span class="kw">return</span>(table_out)</span>
<span id="cb511-16"><a href="plotting-functions-ggplotsci.html#cb511-16"></a>}</span></code></pre></div>
</div>
<div id="pairs_table" class="section level2">
<h2><span class="header-section-number">22.4</span> pairs_table</h2>
<p>This function takes the output from emmeans::contrast and creates a table used by the plot functions to show p-values on the plot. A user would only call this function directly if they wanted to do some major modifications of the template here.</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="plotting-functions-ggplotsci.html#cb512-1"></a>pairs_table &lt;-<span class="st"> </span><span class="cf">function</span>(fit_pairs){</span>
<span id="cb512-2"><a href="plotting-functions-ggplotsci.html#cb512-2"></a>  </span>
<span id="cb512-3"><a href="plotting-functions-ggplotsci.html#cb512-3"></a>   <span class="cf">if</span>(<span class="st">&quot;ratio&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">colnames</span>(fit_pairs)){</span>
<span id="cb512-4"><a href="plotting-functions-ggplotsci.html#cb512-4"></a>    <span class="co"># if the lm with log(y) or glm with log link, use &quot; / &quot;</span></span>
<span id="cb512-5"><a href="plotting-functions-ggplotsci.html#cb512-5"></a>    groups &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">str_split</span>(fit_pairs<span class="op">$</span>contrast, <span class="st">&quot; / &quot;</span>))</span>
<span id="cb512-6"><a href="plotting-functions-ggplotsci.html#cb512-6"></a>    <span class="kw">setnames</span>(fit_pairs, <span class="dt">old =</span> <span class="st">&quot;ratio&quot;</span>, <span class="dt">new =</span> <span class="st">&quot;estimate&quot;</span>)</span>
<span id="cb512-7"><a href="plotting-functions-ggplotsci.html#cb512-7"></a>  }<span class="cf">else</span>{</span>
<span id="cb512-8"><a href="plotting-functions-ggplotsci.html#cb512-8"></a>    <span class="co"># if lm use &quot; - &quot;</span></span>
<span id="cb512-9"><a href="plotting-functions-ggplotsci.html#cb512-9"></a>    groups &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">str_split</span>(fit_pairs<span class="op">$</span>contrast, <span class="st">&quot; - &quot;</span>))</span>
<span id="cb512-10"><a href="plotting-functions-ggplotsci.html#cb512-10"></a>  }</span>
<span id="cb512-11"><a href="plotting-functions-ggplotsci.html#cb512-11"></a>  </span>
<span id="cb512-12"><a href="plotting-functions-ggplotsci.html#cb512-12"></a>  <span class="cf">if</span>(<span class="st">&quot;asymp.LCL&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">colnames</span>(fit_pairs)){</span>
<span id="cb512-13"><a href="plotting-functions-ggplotsci.html#cb512-13"></a>    <span class="co"># if the lm with log(y) or glm with log link, use &quot; / &quot;</span></span>
<span id="cb512-14"><a href="plotting-functions-ggplotsci.html#cb512-14"></a>    <span class="kw">setnames</span>(fit_pairs,</span>
<span id="cb512-15"><a href="plotting-functions-ggplotsci.html#cb512-15"></a>             <span class="dt">old =</span> <span class="kw">c</span>(<span class="st">&quot;asymp.LCL&quot;</span>, <span class="st">&quot;asymp.UCL&quot;</span>),</span>
<span id="cb512-16"><a href="plotting-functions-ggplotsci.html#cb512-16"></a>             <span class="dt">new =</span> <span class="kw">c</span>(<span class="st">&quot;lower.CL&quot;</span>, <span class="st">&quot;upper.CL&quot;</span>))</span>
<span id="cb512-17"><a href="plotting-functions-ggplotsci.html#cb512-17"></a>  }</span>
<span id="cb512-18"><a href="plotting-functions-ggplotsci.html#cb512-18"></a>  </span>
<span id="cb512-19"><a href="plotting-functions-ggplotsci.html#cb512-19"></a>  <span class="co"># add the group1 and group 2 columns</span></span>
<span id="cb512-20"><a href="plotting-functions-ggplotsci.html#cb512-20"></a>  fit_pairs[, group1 <span class="op">:</span><span class="er">=</span><span class="st"> </span>groups[<span class="kw">odd</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(groups))]]</span>
<span id="cb512-21"><a href="plotting-functions-ggplotsci.html#cb512-21"></a>  fit_pairs[, group2 <span class="op">:</span><span class="er">=</span><span class="st"> </span>groups[<span class="kw">even</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(groups))]]</span>
<span id="cb512-22"><a href="plotting-functions-ggplotsci.html#cb512-22"></a>  </span>
<span id="cb512-23"><a href="plotting-functions-ggplotsci.html#cb512-23"></a>  <span class="co"># for simple = each, beautify contrast column and group1, group2</span></span>
<span id="cb512-24"><a href="plotting-functions-ggplotsci.html#cb512-24"></a>  <span class="cf">if</span>(<span class="kw">which</span>(<span class="kw">colnames</span>(fit_pairs)<span class="op">==</span><span class="st">&quot;contrast&quot;</span>) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>){</span>
<span id="cb512-25"><a href="plotting-functions-ggplotsci.html#cb512-25"></a>    <span class="co"># replace &quot;.&quot; with blank</span></span>
<span id="cb512-26"><a href="plotting-functions-ggplotsci.html#cb512-26"></a>    g_col &lt;-<span class="st"> </span><span class="kw">colnames</span>(fit_pairs)[<span class="dv">1</span>]</span>
<span id="cb512-27"><a href="plotting-functions-ggplotsci.html#cb512-27"></a>    x_col &lt;-<span class="st"> </span><span class="kw">colnames</span>(fit_pairs)[<span class="dv">2</span>]</span>
<span id="cb512-28"><a href="plotting-functions-ggplotsci.html#cb512-28"></a>    <span class="cf">for</span>(col <span class="cf">in</span> <span class="kw">names</span>(fit_pairs)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]){</span>
<span id="cb512-29"><a href="plotting-functions-ggplotsci.html#cb512-29"></a>      <span class="kw">set</span>(fit_pairs,</span>
<span id="cb512-30"><a href="plotting-functions-ggplotsci.html#cb512-30"></a>          <span class="dt">i=</span><span class="kw">which</span>(fit_pairs[[col]]<span class="op">==</span><span class="st">&quot;.&quot;</span>),</span>
<span id="cb512-31"><a href="plotting-functions-ggplotsci.html#cb512-31"></a>          <span class="dt">j=</span>col, <span class="dt">value=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb512-32"><a href="plotting-functions-ggplotsci.html#cb512-32"></a>    }</span>
<span id="cb512-33"><a href="plotting-functions-ggplotsci.html#cb512-33"></a> </span>
<span id="cb512-34"><a href="plotting-functions-ggplotsci.html#cb512-34"></a>    fit_pairs[, contrast <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(<span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">1</span>]),</span>
<span id="cb512-35"><a href="plotting-functions-ggplotsci.html#cb512-35"></a>                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">2</span>]),</span>
<span id="cb512-36"><a href="plotting-functions-ggplotsci.html#cb512-36"></a>                                 <span class="st">&quot;: &quot;</span>,</span>
<span id="cb512-37"><a href="plotting-functions-ggplotsci.html#cb512-37"></a>                                 contrast)]</span>
<span id="cb512-38"><a href="plotting-functions-ggplotsci.html#cb512-38"></a>    fit_pairs[<span class="kw">get</span>(g_col) <span class="op">==</span><span class="st"> &quot;&quot;</span>, group1 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(<span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">1</span>]),</span>
<span id="cb512-39"><a href="plotting-functions-ggplotsci.html#cb512-39"></a>                                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">2</span>]),</span>
<span id="cb512-40"><a href="plotting-functions-ggplotsci.html#cb512-40"></a>                                                 <span class="st">&quot;,&quot;</span>,</span>
<span id="cb512-41"><a href="plotting-functions-ggplotsci.html#cb512-41"></a>                                                 group1)]</span>
<span id="cb512-42"><a href="plotting-functions-ggplotsci.html#cb512-42"></a>    fit_pairs[<span class="kw">get</span>(g_col) <span class="op">==</span><span class="st"> &quot;&quot;</span>, group2 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(<span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">1</span>]),</span>
<span id="cb512-43"><a href="plotting-functions-ggplotsci.html#cb512-43"></a>                                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">2</span>]),</span>
<span id="cb512-44"><a href="plotting-functions-ggplotsci.html#cb512-44"></a>                                                 <span class="st">&quot;,&quot;</span>,</span>
<span id="cb512-45"><a href="plotting-functions-ggplotsci.html#cb512-45"></a>                                                 group2)]</span>
<span id="cb512-46"><a href="plotting-functions-ggplotsci.html#cb512-46"></a>    fit_pairs[<span class="kw">get</span>(x_col) <span class="op">==</span><span class="st"> &quot;&quot;</span>, group1 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(group1,</span>
<span id="cb512-47"><a href="plotting-functions-ggplotsci.html#cb512-47"></a>                                                 <span class="st">&quot;,&quot;</span>,</span>
<span id="cb512-48"><a href="plotting-functions-ggplotsci.html#cb512-48"></a>                                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">1</span>]),</span>
<span id="cb512-49"><a href="plotting-functions-ggplotsci.html#cb512-49"></a>                                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">2</span>]))]</span>
<span id="cb512-50"><a href="plotting-functions-ggplotsci.html#cb512-50"></a>    fit_pairs[<span class="kw">get</span>(x_col) <span class="op">==</span><span class="st"> &quot;&quot;</span>, group2 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(group2,</span>
<span id="cb512-51"><a href="plotting-functions-ggplotsci.html#cb512-51"></a>                                                 <span class="st">&quot;,&quot;</span>,</span>
<span id="cb512-52"><a href="plotting-functions-ggplotsci.html#cb512-52"></a>                                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">1</span>]),</span>
<span id="cb512-53"><a href="plotting-functions-ggplotsci.html#cb512-53"></a>                                                 <span class="kw">get</span>(<span class="kw">names</span>(fit_pairs)[<span class="dv">2</span>]))]</span>
<span id="cb512-54"><a href="plotting-functions-ggplotsci.html#cb512-54"></a></span>
<span id="cb512-55"><a href="plotting-functions-ggplotsci.html#cb512-55"></a> }</span>
<span id="cb512-56"><a href="plotting-functions-ggplotsci.html#cb512-56"></a>  </span>
<span id="cb512-57"><a href="plotting-functions-ggplotsci.html#cb512-57"></a>  <span class="co"># create a column of nicely formatted p-values for display.</span></span>
<span id="cb512-58"><a href="plotting-functions-ggplotsci.html#cb512-58"></a>  fit_pairs[, p <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">pvalString</span>(p.value)]</span>
<span id="cb512-59"><a href="plotting-functions-ggplotsci.html#cb512-59"></a>}</span></code></pre></div>
</div>
<div id="gg_mean_error" class="section level2">
<h2><span class="header-section-number">22.5</span> gg_mean_error</h2>
<p><code>gg_mean_error</code> generates mean-and-CI plots that look like those published in most wet-bench experimental biology papers. I describe this more in the output below.</p>
<p>The arguments to the function are (the bold face arguments are required):</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong> the data.table</li>
<li><strong>x_col</strong> the name of the treatment column (“diet” for this file) containing the treatment groups</li>
<li><strong>y_col</strong> the name of response column (<em>not</em> the column of ratios!)</li>
<li>x_label = “none”, this is the label for the x-axis on the plot. “none” is the default (so no need to include) and results in no label (the plot looks better without it)</li>
<li>y_label = “Response (units)”, this is the label for the y-axis on the plot. You do want to replace the default with something meaningful and sense the y-variable is the <em>adjusted</em> response, it is important to include this in the label, so something like: y_label = “adj. SCAT (g)”</li>
<li>dots = “sina”, this controls how the dots are plotted. “sina” is clever.</li>
<li>dodge_width = 0.8, this controls how closely spaced the groups are in the plot</li>
<li>adjust = 0.5, this controls how wide the dots within each group</li>
<li>p_adjust = “none”, this controls p-value adjustment for multiple comparisons. This doesn’t matter for these data because there are only 2 groups in the diet treatment, so only 1 comparison (MR - CN).</li>
<li>p_show = 0, is the row number in fit_pairs with the p-values to show</li>
<li>p_pos = NULL, is the relative vertical position (bottom to top) of the p-values - the order matches the row index in p_show.</li>
</ol>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="plotting-functions-ggplotsci.html#cb513-1"></a>gg_mean_error &lt;-<span class="st"> </span><span class="cf">function</span>(data,</span>
<span id="cb513-2"><a href="plotting-functions-ggplotsci.html#cb513-2"></a>                          fit, <span class="co"># model fit from lm, lmer, nlme, glmmTMB</span></span>
<span id="cb513-3"><a href="plotting-functions-ggplotsci.html#cb513-3"></a>                          fit_emm,</span>
<span id="cb513-4"><a href="plotting-functions-ggplotsci.html#cb513-4"></a>                          fit_pairs,</span>
<span id="cb513-5"><a href="plotting-functions-ggplotsci.html#cb513-5"></a>                          x_col,</span>
<span id="cb513-6"><a href="plotting-functions-ggplotsci.html#cb513-6"></a>                          y_col,</span>
<span id="cb513-7"><a href="plotting-functions-ggplotsci.html#cb513-7"></a>                          <span class="dt">g_col=</span><span class="ot">NULL</span>,</span>
<span id="cb513-8"><a href="plotting-functions-ggplotsci.html#cb513-8"></a>                          <span class="dt">wrap_col=</span><span class="ot">NULL</span>,</span>
<span id="cb513-9"><a href="plotting-functions-ggplotsci.html#cb513-9"></a>                          <span class="dt">x_label =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb513-10"><a href="plotting-functions-ggplotsci.html#cb513-10"></a>                          <span class="dt">y_label =</span> <span class="st">&quot;Response (units)&quot;</span>,</span>
<span id="cb513-11"><a href="plotting-functions-ggplotsci.html#cb513-11"></a>                          <span class="dt">g_label =</span> <span class="ot">NULL</span>,</span>
<span id="cb513-12"><a href="plotting-functions-ggplotsci.html#cb513-12"></a>                          <span class="dt">dots =</span> <span class="st">&quot;jitter&quot;</span>,</span>
<span id="cb513-13"><a href="plotting-functions-ggplotsci.html#cb513-13"></a>                          <span class="dt">dodge_width =</span> <span class="fl">0.8</span>,</span>
<span id="cb513-14"><a href="plotting-functions-ggplotsci.html#cb513-14"></a>                          <span class="dt">adjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb513-15"><a href="plotting-functions-ggplotsci.html#cb513-15"></a>                          <span class="dt">p_show =</span> <span class="dv">0</span>,</span>
<span id="cb513-16"><a href="plotting-functions-ggplotsci.html#cb513-16"></a>                          <span class="dt">p_pos =</span> <span class="ot">NULL</span>){</span>
<span id="cb513-17"><a href="plotting-functions-ggplotsci.html#cb513-17"></a> </span>
<span id="cb513-18"><a href="plotting-functions-ggplotsci.html#cb513-18"></a></span>
<span id="cb513-19"><a href="plotting-functions-ggplotsci.html#cb513-19"></a>  dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(data)</span>
<span id="cb513-20"><a href="plotting-functions-ggplotsci.html#cb513-20"></a>  gg &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb513-21"><a href="plotting-functions-ggplotsci.html#cb513-21"></a>  </span>
<span id="cb513-22"><a href="plotting-functions-ggplotsci.html#cb513-22"></a>  <span class="cf">if</span>(<span class="kw">is.factor</span>(dt[, <span class="kw">get</span>(x_col)]) <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>){</span>
<span id="cb513-23"><a href="plotting-functions-ggplotsci.html#cb513-23"></a>    dt[, (x_col) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(<span class="kw">get</span>(x_col))]</span>
<span id="cb513-24"><a href="plotting-functions-ggplotsci.html#cb513-24"></a>  }</span>
<span id="cb513-25"><a href="plotting-functions-ggplotsci.html#cb513-25"></a>  <span class="cf">if</span>(<span class="kw">is.factor</span>(dt[, <span class="kw">get</span>(g_col)]) <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>){</span>
<span id="cb513-26"><a href="plotting-functions-ggplotsci.html#cb513-26"></a>    dt[, (g_col) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(<span class="kw">get</span>(g_col))]</span>
<span id="cb513-27"><a href="plotting-functions-ggplotsci.html#cb513-27"></a>  }</span>
<span id="cb513-28"><a href="plotting-functions-ggplotsci.html#cb513-28"></a></span>
<span id="cb513-29"><a href="plotting-functions-ggplotsci.html#cb513-29"></a>  fit_emm_dt &lt;-<span class="st"> </span><span class="kw">emm_table</span>(fit_emm)</span>
<span id="cb513-30"><a href="plotting-functions-ggplotsci.html#cb513-30"></a>  fit_pairs_dt &lt;-<span class="st"> </span><span class="kw">pairs_table</span>(<span class="kw">data.table</span>(fit_pairs))</span>
<span id="cb513-31"><a href="plotting-functions-ggplotsci.html#cb513-31"></a></span>
<span id="cb513-32"><a href="plotting-functions-ggplotsci.html#cb513-32"></a>  <span class="cf">if</span>(g_col <span class="op">==</span><span class="st"> </span>x_col <span class="op">|</span><span class="st"> </span><span class="kw">is.null</span>(g_col)){</span>
<span id="cb513-33"><a href="plotting-functions-ggplotsci.html#cb513-33"></a>    pd &lt;-<span class="st"> </span><span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="dv">0</span>)</span>
<span id="cb513-34"><a href="plotting-functions-ggplotsci.html#cb513-34"></a>    fit_pairs_dt[, x_min_col <span class="op">:</span><span class="er">=</span><span class="st"> </span>group1]</span>
<span id="cb513-35"><a href="plotting-functions-ggplotsci.html#cb513-35"></a>    fit_pairs_dt[, x_max_col <span class="op">:</span><span class="er">=</span><span class="st"> </span>group2]</span>
<span id="cb513-36"><a href="plotting-functions-ggplotsci.html#cb513-36"></a>  }<span class="cf">else</span>{</span>
<span id="cb513-37"><a href="plotting-functions-ggplotsci.html#cb513-37"></a>    pd &lt;-<span class="st"> </span><span class="kw">position_dodge</span>(<span class="dt">width =</span> dodge_width)</span>
<span id="cb513-38"><a href="plotting-functions-ggplotsci.html#cb513-38"></a>    fit_pairs_dt[, x_min_col <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="ot">NA</span>]</span>
<span id="cb513-39"><a href="plotting-functions-ggplotsci.html#cb513-39"></a>    fit_pairs_dt[, x_max_col <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="ot">NA</span>]</span>
<span id="cb513-40"><a href="plotting-functions-ggplotsci.html#cb513-40"></a>    <span class="cf">if</span>(<span class="kw">is.null</span>(g_label)){</span>
<span id="cb513-41"><a href="plotting-functions-ggplotsci.html#cb513-41"></a>      g_label &lt;-<span class="st"> </span>g_col</span>
<span id="cb513-42"><a href="plotting-functions-ggplotsci.html#cb513-42"></a>    }</span>
<span id="cb513-43"><a href="plotting-functions-ggplotsci.html#cb513-43"></a>  }</span>
<span id="cb513-44"><a href="plotting-functions-ggplotsci.html#cb513-44"></a></span>
<span id="cb513-45"><a href="plotting-functions-ggplotsci.html#cb513-45"></a></span>
<span id="cb513-46"><a href="plotting-functions-ggplotsci.html#cb513-46"></a>  gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>dt, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">get</span>(x_col),</span>
<span id="cb513-47"><a href="plotting-functions-ggplotsci.html#cb513-47"></a>                            <span class="dt">y =</span> <span class="kw">get</span>(y_col),</span>
<span id="cb513-48"><a href="plotting-functions-ggplotsci.html#cb513-48"></a>                            <span class="dt">color =</span> <span class="kw">get</span>(g_col)))</span>
<span id="cb513-49"><a href="plotting-functions-ggplotsci.html#cb513-49"></a>  <span class="co"># plot points</span></span>
<span id="cb513-50"><a href="plotting-functions-ggplotsci.html#cb513-50"></a>  <span class="cf">if</span>(dots <span class="op">==</span><span class="st"> &quot;sina&quot;</span>){</span>
<span id="cb513-51"><a href="plotting-functions-ggplotsci.html#cb513-51"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">geom_sina</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb513-52"><a href="plotting-functions-ggplotsci.html#cb513-52"></a>                         <span class="dt">position =</span> pd,</span>
<span id="cb513-53"><a href="plotting-functions-ggplotsci.html#cb513-53"></a>                         <span class="dt">adjust =</span> adjust)</span>
<span id="cb513-54"><a href="plotting-functions-ggplotsci.html#cb513-54"></a>  }</span>
<span id="cb513-55"><a href="plotting-functions-ggplotsci.html#cb513-55"></a>  <span class="cf">if</span>(dots <span class="op">==</span><span class="st"> &quot;jitter&quot;</span>){</span>
<span id="cb513-56"><a href="plotting-functions-ggplotsci.html#cb513-56"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb513-57"><a href="plotting-functions-ggplotsci.html#cb513-57"></a>                         <span class="dt">position =</span> <span class="st">&quot;jitter&quot;</span>)</span>
<span id="cb513-58"><a href="plotting-functions-ggplotsci.html#cb513-58"></a>  }</span>
<span id="cb513-59"><a href="plotting-functions-ggplotsci.html#cb513-59"></a>  <span class="cf">if</span>(dots <span class="op">==</span><span class="st"> &quot;dotplot&quot;</span>){</span>
<span id="cb513-60"><a href="plotting-functions-ggplotsci.html#cb513-60"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">geom_dotplot</span>(<span class="dt">binaxis=</span><span class="st">&#39;y&#39;</span>,</span>
<span id="cb513-61"><a href="plotting-functions-ggplotsci.html#cb513-61"></a>                            <span class="dt">stackdir=</span><span class="st">&#39;center&#39;</span>,</span>
<span id="cb513-62"><a href="plotting-functions-ggplotsci.html#cb513-62"></a>                            <span class="dt">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb513-63"><a href="plotting-functions-ggplotsci.html#cb513-63"></a>                            <span class="dt">position =</span> pd)</span>
<span id="cb513-64"><a href="plotting-functions-ggplotsci.html#cb513-64"></a></span>
<span id="cb513-65"><a href="plotting-functions-ggplotsci.html#cb513-65"></a>  }</span>
<span id="cb513-66"><a href="plotting-functions-ggplotsci.html#cb513-66"></a></span>
<span id="cb513-67"><a href="plotting-functions-ggplotsci.html#cb513-67"></a>  <span class="co"># plot means and CI</span></span>
<span id="cb513-68"><a href="plotting-functions-ggplotsci.html#cb513-68"></a>  gg &lt;-<span class="st"> </span>gg <span class="op">+</span></span>
<span id="cb513-69"><a href="plotting-functions-ggplotsci.html#cb513-69"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> fit_emm_dt, <span class="kw">aes</span>(<span class="dt">y =</span> emmean,</span>
<span id="cb513-70"><a href="plotting-functions-ggplotsci.html#cb513-70"></a>                                           <span class="dt">ymin =</span> lower.CL,</span>
<span id="cb513-71"><a href="plotting-functions-ggplotsci.html#cb513-71"></a>                                           <span class="dt">ymax =</span> upper.CL,</span>
<span id="cb513-72"><a href="plotting-functions-ggplotsci.html#cb513-72"></a>                                        <span class="dt">color =</span> <span class="kw">get</span>(g_col)),</span>
<span id="cb513-73"><a href="plotting-functions-ggplotsci.html#cb513-73"></a>               <span class="dt">width =</span> <span class="dv">0</span>,</span>
<span id="cb513-74"><a href="plotting-functions-ggplotsci.html#cb513-74"></a>              <span class="dt">position =</span> pd</span>
<span id="cb513-75"><a href="plotting-functions-ggplotsci.html#cb513-75"></a>    ) <span class="op">+</span></span>
<span id="cb513-76"><a href="plotting-functions-ggplotsci.html#cb513-76"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> fit_emm_dt, <span class="kw">aes</span>(<span class="dt">y =</span> emmean,</span>
<span id="cb513-77"><a href="plotting-functions-ggplotsci.html#cb513-77"></a>                                        <span class="dt">color =</span> <span class="kw">get</span>(g_col)),</span>
<span id="cb513-78"><a href="plotting-functions-ggplotsci.html#cb513-78"></a>               <span class="dt">size =</span> <span class="dv">3</span>,</span>
<span id="cb513-79"><a href="plotting-functions-ggplotsci.html#cb513-79"></a>              <span class="dt">position =</span> pd</span>
<span id="cb513-80"><a href="plotting-functions-ggplotsci.html#cb513-80"></a>    ) <span class="op">+</span></span>
<span id="cb513-81"><a href="plotting-functions-ggplotsci.html#cb513-81"></a></span>
<span id="cb513-82"><a href="plotting-functions-ggplotsci.html#cb513-82"></a><span class="st">    </span><span class="co"># aesthetics</span></span>
<span id="cb513-83"><a href="plotting-functions-ggplotsci.html#cb513-83"></a><span class="st">    </span><span class="kw">ylab</span>(y_label) <span class="op">+</span></span>
<span id="cb513-84"><a href="plotting-functions-ggplotsci.html#cb513-84"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>pal_nature_mod,</span>
<span id="cb513-85"><a href="plotting-functions-ggplotsci.html#cb513-85"></a>                       <span class="dt">name =</span> g_col) <span class="op">+</span></span>
<span id="cb513-86"><a href="plotting-functions-ggplotsci.html#cb513-86"></a><span class="st">    </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb513-87"><a href="plotting-functions-ggplotsci.html#cb513-87"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb513-88"><a href="plotting-functions-ggplotsci.html#cb513-88"></a></span>
<span id="cb513-89"><a href="plotting-functions-ggplotsci.html#cb513-89"></a><span class="st">    </span><span class="ot">NULL</span></span>
<span id="cb513-90"><a href="plotting-functions-ggplotsci.html#cb513-90"></a>  </span>
<span id="cb513-91"><a href="plotting-functions-ggplotsci.html#cb513-91"></a>  </span>
<span id="cb513-92"><a href="plotting-functions-ggplotsci.html#cb513-92"></a>  <span class="cf">if</span>(g_col <span class="op">==</span><span class="st"> </span>x_col){</span>
<span id="cb513-93"><a href="plotting-functions-ggplotsci.html#cb513-93"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb513-94"><a href="plotting-functions-ggplotsci.html#cb513-94"></a>  }</span>
<span id="cb513-95"><a href="plotting-functions-ggplotsci.html#cb513-95"></a>  </span>
<span id="cb513-96"><a href="plotting-functions-ggplotsci.html#cb513-96"></a>  <span class="cf">if</span>(<span class="kw">is.null</span>(g_label)){</span>
<span id="cb513-97"><a href="plotting-functions-ggplotsci.html#cb513-97"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="ot">NULL</span>))</span>
<span id="cb513-98"><a href="plotting-functions-ggplotsci.html#cb513-98"></a>  }<span class="cf">else</span>{</span>
<span id="cb513-99"><a href="plotting-functions-ggplotsci.html#cb513-99"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title=</span>g_label))</span>
<span id="cb513-100"><a href="plotting-functions-ggplotsci.html#cb513-100"></a>  }</span>
<span id="cb513-101"><a href="plotting-functions-ggplotsci.html#cb513-101"></a></span>
<span id="cb513-102"><a href="plotting-functions-ggplotsci.html#cb513-102"></a>  <span class="cf">if</span>(<span class="kw">sum</span>(p_show) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){ <span class="co"># show p-values</span></span>
<span id="cb513-103"><a href="plotting-functions-ggplotsci.html#cb513-103"></a>    <span class="co"># get x positions for p-values</span></span>
<span id="cb513-104"><a href="plotting-functions-ggplotsci.html#cb513-104"></a>    <span class="co"># [[3]] is 3rd layer which is means</span></span>
<span id="cb513-105"><a href="plotting-functions-ggplotsci.html#cb513-105"></a>    <span class="cf">if</span>(<span class="kw">is.na</span>(fit_pairs_dt[<span class="dv">1</span>, x_min_col])){</span>
<span id="cb513-106"><a href="plotting-functions-ggplotsci.html#cb513-106"></a>      gg_data &lt;-<span class="st"> </span><span class="kw">cbind</span>(fit_emm_dt,</span>
<span id="cb513-107"><a href="plotting-functions-ggplotsci.html#cb513-107"></a>                       <span class="kw">ggplot_build</span>(gg)<span class="op">$</span>data[[<span class="dv">3</span>]])</span>
<span id="cb513-108"><a href="plotting-functions-ggplotsci.html#cb513-108"></a></span>
<span id="cb513-109"><a href="plotting-functions-ggplotsci.html#cb513-109"></a>      gg_data[, cell <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste</span>(<span class="kw">get</span>(x_col), <span class="kw">get</span>(g_col), <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)]</span>
<span id="cb513-110"><a href="plotting-functions-ggplotsci.html#cb513-110"></a>      match_it_ref &lt;-<span class="st"> </span><span class="kw">match</span>(fit_pairs_dt<span class="op">$</span>group1, gg_data<span class="op">$</span>cell)</span>
<span id="cb513-111"><a href="plotting-functions-ggplotsci.html#cb513-111"></a></span>
<span id="cb513-112"><a href="plotting-functions-ggplotsci.html#cb513-112"></a>      fit_pairs_dt[, rowa <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">match</span>(group1, gg_data<span class="op">$</span>cell)]</span>
<span id="cb513-113"><a href="plotting-functions-ggplotsci.html#cb513-113"></a>      fit_pairs_dt[, rowb <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">match</span>(group2, gg_data<span class="op">$</span>cell)]</span>
<span id="cb513-114"><a href="plotting-functions-ggplotsci.html#cb513-114"></a>      fit_pairs_dt[, x_min_col <span class="op">:</span><span class="er">=</span><span class="st"> </span>gg_data[rowa, x]]</span>
<span id="cb513-115"><a href="plotting-functions-ggplotsci.html#cb513-115"></a>      fit_pairs_dt[, x_max_col <span class="op">:</span><span class="er">=</span><span class="st"> </span>gg_data[rowb, x]]</span>
<span id="cb513-116"><a href="plotting-functions-ggplotsci.html#cb513-116"></a>    }</span>
<span id="cb513-117"><a href="plotting-functions-ggplotsci.html#cb513-117"></a></span>
<span id="cb513-118"><a href="plotting-functions-ggplotsci.html#cb513-118"></a>    <span class="cf">if</span>(<span class="kw">is.null</span>(p_pos)){</span>
<span id="cb513-119"><a href="plotting-functions-ggplotsci.html#cb513-119"></a>      p_pos &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(p_show)</span>
<span id="cb513-120"><a href="plotting-functions-ggplotsci.html#cb513-120"></a>    }</span>
<span id="cb513-121"><a href="plotting-functions-ggplotsci.html#cb513-121"></a>    max_y &lt;-<span class="st"> </span><span class="kw">max</span>(dt[, <span class="kw">get</span>(y_col)], <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb513-122"><a href="plotting-functions-ggplotsci.html#cb513-122"></a>    min_y &lt;-<span class="st"> </span><span class="kw">min</span>(dt[, <span class="kw">get</span>(y_col)], <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb513-123"><a href="plotting-functions-ggplotsci.html#cb513-123"></a>    increment &lt;-<span class="st"> </span><span class="fl">0.1</span><span class="op">*</span>(max_y <span class="op">-</span><span class="st"> </span>min_y)</span>
<span id="cb513-124"><a href="plotting-functions-ggplotsci.html#cb513-124"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(p_pos)){</span>
<span id="cb513-125"><a href="plotting-functions-ggplotsci.html#cb513-125"></a>      pos &lt;-<span class="st"> </span>p_pos[i]</span>
<span id="cb513-126"><a href="plotting-functions-ggplotsci.html#cb513-126"></a>      y_position &lt;-<span class="st"> </span>max_y <span class="op">+</span><span class="st"> </span>increment<span class="op">*</span>pos</span>
<span id="cb513-127"><a href="plotting-functions-ggplotsci.html#cb513-127"></a>      row &lt;-<span class="st"> </span>p_show[i]</span>
<span id="cb513-128"><a href="plotting-functions-ggplotsci.html#cb513-128"></a>      gg &lt;-<span class="st"> </span>gg <span class="op">+</span></span>
<span id="cb513-129"><a href="plotting-functions-ggplotsci.html#cb513-129"></a><span class="st">        </span><span class="kw">stat_pvalue_manual</span>(fit_pairs_dt[row],</span>
<span id="cb513-130"><a href="plotting-functions-ggplotsci.html#cb513-130"></a>                           <span class="dt">label =</span> <span class="st">&quot;p&quot;</span>,</span>
<span id="cb513-131"><a href="plotting-functions-ggplotsci.html#cb513-131"></a>                           <span class="dt">y.position=</span>y_position,</span>
<span id="cb513-132"><a href="plotting-functions-ggplotsci.html#cb513-132"></a>                           <span class="dt">xmin =</span> <span class="st">&quot;x_min_col&quot;</span>,</span>
<span id="cb513-133"><a href="plotting-functions-ggplotsci.html#cb513-133"></a>                           <span class="dt">xmax =</span> <span class="st">&quot;x_max_col&quot;</span>,</span>
<span id="cb513-134"><a href="plotting-functions-ggplotsci.html#cb513-134"></a>                           <span class="dt">tip.length =</span> <span class="fl">0.01</span>)</span>
<span id="cb513-135"><a href="plotting-functions-ggplotsci.html#cb513-135"></a>    }</span>
<span id="cb513-136"><a href="plotting-functions-ggplotsci.html#cb513-136"></a></span>
<span id="cb513-137"><a href="plotting-functions-ggplotsci.html#cb513-137"></a>    <span class="co"># make sure ylim includes p-value</span></span>
<span id="cb513-138"><a href="plotting-functions-ggplotsci.html#cb513-138"></a>    y_hi &lt;-<span class="st"> </span>max_y <span class="op">+</span><span class="st"> </span><span class="fl">0.05</span><span class="op">*</span>(max_y <span class="op">-</span><span class="st"> </span>min_y) <span class="op">+</span></span>
<span id="cb513-139"><a href="plotting-functions-ggplotsci.html#cb513-139"></a><span class="st">      </span>increment<span class="op">*</span><span class="kw">max</span>(p_pos)</span>
<span id="cb513-140"><a href="plotting-functions-ggplotsci.html#cb513-140"></a>    y_lo &lt;-<span class="st"> </span>min_y <span class="op">-</span><span class="st"> </span><span class="fl">0.05</span><span class="op">*</span>(max_y <span class="op">-</span><span class="st"> </span>min_y)</span>
<span id="cb513-141"><a href="plotting-functions-ggplotsci.html#cb513-141"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(y_lo, y_hi))</span>
<span id="cb513-142"><a href="plotting-functions-ggplotsci.html#cb513-142"></a>  }</span>
<span id="cb513-143"><a href="plotting-functions-ggplotsci.html#cb513-143"></a></span>
<span id="cb513-144"><a href="plotting-functions-ggplotsci.html#cb513-144"></a></span>
<span id="cb513-145"><a href="plotting-functions-ggplotsci.html#cb513-145"></a>  <span class="co"># remove x axis title</span></span>
<span id="cb513-146"><a href="plotting-functions-ggplotsci.html#cb513-146"></a>  <span class="cf">if</span>(x_label <span class="op">==</span><span class="st"> &quot;none&quot;</span>){</span>
<span id="cb513-147"><a href="plotting-functions-ggplotsci.html#cb513-147"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>())</span>
<span id="cb513-148"><a href="plotting-functions-ggplotsci.html#cb513-148"></a>  }<span class="cf">else</span>{</span>
<span id="cb513-149"><a href="plotting-functions-ggplotsci.html#cb513-149"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(x_label)}</span>
<span id="cb513-150"><a href="plotting-functions-ggplotsci.html#cb513-150"></a></span>
<span id="cb513-151"><a href="plotting-functions-ggplotsci.html#cb513-151"></a>  gg</span>
<span id="cb513-152"><a href="plotting-functions-ggplotsci.html#cb513-152"></a></span>
<span id="cb513-153"><a href="plotting-functions-ggplotsci.html#cb513-153"></a>  <span class="kw">return</span>(gg)</span>
<span id="cb513-154"><a href="plotting-functions-ggplotsci.html#cb513-154"></a>}</span></code></pre></div>
</div>
<div id="gg_ancova" class="section level2">
<h2><span class="header-section-number">22.6</span> gg_ancova</h2>
<p><code>gg_ancova</code> generates a classic <a href="presenting-results-as-ancova-plots">“ANCOVA” plot</a>. This function would be directly called by a user.</p>
<p>The arguments to the function are (the bold face arguments are required):</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong> the data.table</li>
<li><strong>x_col</strong> the name of the treatment column (“diet” for this file) containing the treatment groups</li>
<li><strong>y_col</strong> the name of response column (<em>not</em> the column of ratios!)</li>
<li><strong>cov_col</strong>, the name of the column containing the covariate (“bw_02_05_18” for this file)</li>
<li>cov_label = “covariate (units)”, this is the label for the x-axis on the plot which is the name of the covariate column. You do want to replace the default with something meaningful. For these data, something like: cov_label = “Body Mass (g)”</li>
<li>y_label = “Response (units)”, this is the label for the y-axis on the plot. You do want to replace the default with something meaningful like: y_label = “SCAT (g)”</li>
<li>add_p = TRUE, the defaults adds the p-value of the treatment (x_col) effect</li>
<li>p_pos = “center”, controls the x-position of the p-value on the graph</li>
<li>p_adjust = “none”, this controls p-value adjustment for multiple comparisons. This doesn’t matter for these data because there are only 2 groups in the diet treatment, so only 1 comparison (MR - CN).</li>
</ol>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="plotting-functions-ggplotsci.html#cb514-1"></a>gg_ancova &lt;-<span class="st"> </span><span class="cf">function</span>(data,</span>
<span id="cb514-2"><a href="plotting-functions-ggplotsci.html#cb514-2"></a>                      fit, <span class="co"># model fit from lm, lmer, nlme, glmmTMB</span></span>
<span id="cb514-3"><a href="plotting-functions-ggplotsci.html#cb514-3"></a>                      fit_emm,</span>
<span id="cb514-4"><a href="plotting-functions-ggplotsci.html#cb514-4"></a>                      fit_pairs,</span>
<span id="cb514-5"><a href="plotting-functions-ggplotsci.html#cb514-5"></a>                      x_col,</span>
<span id="cb514-6"><a href="plotting-functions-ggplotsci.html#cb514-6"></a>                      y_col,</span>
<span id="cb514-7"><a href="plotting-functions-ggplotsci.html#cb514-7"></a>                      cov_col,</span>
<span id="cb514-8"><a href="plotting-functions-ggplotsci.html#cb514-8"></a>                      <span class="dt">cov_label =</span> <span class="st">&quot;covariate (units)&quot;</span>,</span>
<span id="cb514-9"><a href="plotting-functions-ggplotsci.html#cb514-9"></a>                      <span class="dt">y_label =</span> <span class="st">&quot;Response (units)&quot;</span>,</span>
<span id="cb514-10"><a href="plotting-functions-ggplotsci.html#cb514-10"></a>                      <span class="dt">add_ci =</span> <span class="ot">TRUE</span>,</span>
<span id="cb514-11"><a href="plotting-functions-ggplotsci.html#cb514-11"></a>                      <span class="dt">add_p =</span> <span class="ot">TRUE</span>,</span>
<span id="cb514-12"><a href="plotting-functions-ggplotsci.html#cb514-12"></a>                      <span class="dt">p_show =</span> <span class="ot">NULL</span>,</span>
<span id="cb514-13"><a href="plotting-functions-ggplotsci.html#cb514-13"></a>                      <span class="dt">p_pos =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb514-14"><a href="plotting-functions-ggplotsci.html#cb514-14"></a>                      <span class="dt">p_adjust =</span> <span class="st">&quot;none&quot;</span>){</span>
<span id="cb514-15"><a href="plotting-functions-ggplotsci.html#cb514-15"></a>  </span>
<span id="cb514-16"><a href="plotting-functions-ggplotsci.html#cb514-16"></a>  dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(data)[, .SD, .SDcols =<span class="st"> </span><span class="kw">c</span>(x_col, y_col, cov_col)]</span>
<span id="cb514-17"><a href="plotting-functions-ggplotsci.html#cb514-17"></a>  </span>
<span id="cb514-18"><a href="plotting-functions-ggplotsci.html#cb514-18"></a>  dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(fit<span class="op">$</span>model)</span>
<span id="cb514-19"><a href="plotting-functions-ggplotsci.html#cb514-19"></a>  <span class="cf">if</span>(<span class="kw">is.factor</span>(dt[, <span class="kw">get</span>(x_col)]) <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>){</span>
<span id="cb514-20"><a href="plotting-functions-ggplotsci.html#cb514-20"></a>    dt[, (x_col) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(<span class="kw">get</span>(x_col))]</span>
<span id="cb514-21"><a href="plotting-functions-ggplotsci.html#cb514-21"></a>  }</span>
<span id="cb514-22"><a href="plotting-functions-ggplotsci.html#cb514-22"></a>  </span>
<span id="cb514-23"><a href="plotting-functions-ggplotsci.html#cb514-23"></a>  </span>
<span id="cb514-24"><a href="plotting-functions-ggplotsci.html#cb514-24"></a>  fit_emm_dt &lt;-<span class="st"> </span><span class="kw">emm_table</span>(fit_emm)</span>
<span id="cb514-25"><a href="plotting-functions-ggplotsci.html#cb514-25"></a>  fit_pairs_dt &lt;-<span class="st"> </span><span class="kw">pairs_table</span>(<span class="kw">data.table</span>(fit_pairs))</span>
<span id="cb514-26"><a href="plotting-functions-ggplotsci.html#cb514-26"></a></span>
<span id="cb514-27"><a href="plotting-functions-ggplotsci.html#cb514-27"></a>  g &lt;-<span class="st"> </span>x_col</span>
<span id="cb514-28"><a href="plotting-functions-ggplotsci.html#cb514-28"></a>  y &lt;-<span class="st"> </span>y_col</span>
<span id="cb514-29"><a href="plotting-functions-ggplotsci.html#cb514-29"></a>  x &lt;-<span class="st"> </span>cov_col</span>
<span id="cb514-30"><a href="plotting-functions-ggplotsci.html#cb514-30"></a>  </span>
<span id="cb514-31"><a href="plotting-functions-ggplotsci.html#cb514-31"></a>  new_wide &lt;-<span class="st"> </span>dt[, .(<span class="dt">xmin =</span> <span class="kw">min</span>(<span class="kw">get</span>(x)), <span class="dt">xmax =</span> <span class="kw">max</span>(<span class="kw">get</span>(x))), by =<span class="st"> </span><span class="kw">get</span>(g)]</span>
<span id="cb514-32"><a href="plotting-functions-ggplotsci.html#cb514-32"></a>  new_long &lt;-<span class="st"> </span><span class="kw">melt</span>(new_wide,</span>
<span id="cb514-33"><a href="plotting-functions-ggplotsci.html#cb514-33"></a>                   <span class="dt">measure.vars =</span> <span class="kw">c</span>(<span class="st">&quot;xmin&quot;</span>, <span class="st">&quot;xmax&quot;</span>),</span>
<span id="cb514-34"><a href="plotting-functions-ggplotsci.html#cb514-34"></a>                   <span class="dt">value.name =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb514-35"><a href="plotting-functions-ggplotsci.html#cb514-35"></a>  <span class="kw">setnames</span>(new_long, <span class="dt">old =</span> <span class="kw">c</span>(<span class="st">&quot;get&quot;</span>, <span class="st">&quot;x&quot;</span>), <span class="dt">new =</span> <span class="kw">c</span>(g, x))</span>
<span id="cb514-36"><a href="plotting-functions-ggplotsci.html#cb514-36"></a>  yhat &lt;-<span class="st"> </span><span class="kw">predict</span>(fit,</span>
<span id="cb514-37"><a href="plotting-functions-ggplotsci.html#cb514-37"></a>                  new_long,</span>
<span id="cb514-38"><a href="plotting-functions-ggplotsci.html#cb514-38"></a>                  <span class="dt">interval =</span> <span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb514-39"><a href="plotting-functions-ggplotsci.html#cb514-39"></a>  new_long &lt;-<span class="st"> </span><span class="kw">cbind</span>(new_long, yhat)</span>
<span id="cb514-40"><a href="plotting-functions-ggplotsci.html#cb514-40"></a>  <span class="kw">setnames</span>(new_long, <span class="dt">old =</span> <span class="kw">c</span>(<span class="st">&quot;fit&quot;</span>), <span class="dt">new =</span> <span class="kw">c</span>(y))</span>
<span id="cb514-41"><a href="plotting-functions-ggplotsci.html#cb514-41"></a>  </span>
<span id="cb514-42"><a href="plotting-functions-ggplotsci.html#cb514-42"></a>  gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dt, <span class="kw">aes</span>(</span>
<span id="cb514-43"><a href="plotting-functions-ggplotsci.html#cb514-43"></a>    <span class="dt">x =</span> <span class="kw">get</span>(x),</span>
<span id="cb514-44"><a href="plotting-functions-ggplotsci.html#cb514-44"></a>    <span class="dt">y =</span> <span class="kw">get</span>(y),</span>
<span id="cb514-45"><a href="plotting-functions-ggplotsci.html#cb514-45"></a>    <span class="dt">color =</span> <span class="kw">get</span>(g)</span>
<span id="cb514-46"><a href="plotting-functions-ggplotsci.html#cb514-46"></a>  )) <span class="op">+</span></span>
<span id="cb514-47"><a href="plotting-functions-ggplotsci.html#cb514-47"></a><span class="st">    </span></span>
<span id="cb514-48"><a href="plotting-functions-ggplotsci.html#cb514-48"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb514-49"><a href="plotting-functions-ggplotsci.html#cb514-49"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> x,</span>
<span id="cb514-50"><a href="plotting-functions-ggplotsci.html#cb514-50"></a>         <span class="dt">y =</span> y,</span>
<span id="cb514-51"><a href="plotting-functions-ggplotsci.html#cb514-51"></a>         <span class="dt">color =</span> g) <span class="op">+</span></span>
<span id="cb514-52"><a href="plotting-functions-ggplotsci.html#cb514-52"></a><span class="st">    </span><span class="ot">NULL</span></span>
<span id="cb514-53"><a href="plotting-functions-ggplotsci.html#cb514-53"></a>  </span>
<span id="cb514-54"><a href="plotting-functions-ggplotsci.html#cb514-54"></a>  g_levels &lt;-<span class="st"> </span><span class="kw">levels</span>(dt[, <span class="kw">get</span>(g)])</span>
<span id="cb514-55"><a href="plotting-functions-ggplotsci.html#cb514-55"></a>  new_long[, get <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">get</span>(g)] <span class="co"># not sure how to avoid this</span></span>
<span id="cb514-56"><a href="plotting-functions-ggplotsci.html#cb514-56"></a>  </span>
<span id="cb514-57"><a href="plotting-functions-ggplotsci.html#cb514-57"></a>  <span class="co"># add ci ribbons</span></span>
<span id="cb514-58"><a href="plotting-functions-ggplotsci.html#cb514-58"></a>  <span class="cf">if</span>(add_ci <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){</span>
<span id="cb514-59"><a href="plotting-functions-ggplotsci.html#cb514-59"></a>    <span class="cf">for</span>(g_i <span class="cf">in</span> g_levels){</span>
<span id="cb514-60"><a href="plotting-functions-ggplotsci.html#cb514-60"></a>      gg &lt;-<span class="st"> </span>gg <span class="op">+</span></span>
<span id="cb514-61"><a href="plotting-functions-ggplotsci.html#cb514-61"></a><span class="st">        </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> new_long[get <span class="op">==</span><span class="st"> </span>g_i,],</span>
<span id="cb514-62"><a href="plotting-functions-ggplotsci.html#cb514-62"></a>                    <span class="kw">aes</span>(<span class="dt">ymin =</span> lwr,</span>
<span id="cb514-63"><a href="plotting-functions-ggplotsci.html#cb514-63"></a>                        <span class="dt">ymax =</span> upr,</span>
<span id="cb514-64"><a href="plotting-functions-ggplotsci.html#cb514-64"></a>                        <span class="co">#                     fill = get(g),</span></span>
<span id="cb514-65"><a href="plotting-functions-ggplotsci.html#cb514-65"></a>                        <span class="dt">linetype =</span> <span class="ot">NA</span></span>
<span id="cb514-66"><a href="plotting-functions-ggplotsci.html#cb514-66"></a>                    ),</span>
<span id="cb514-67"><a href="plotting-functions-ggplotsci.html#cb514-67"></a>                    <span class="dt">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb514-68"><a href="plotting-functions-ggplotsci.html#cb514-68"></a>                    <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</span>
<span id="cb514-69"><a href="plotting-functions-ggplotsci.html#cb514-69"></a>    }</span>
<span id="cb514-70"><a href="plotting-functions-ggplotsci.html#cb514-70"></a>  }</span>
<span id="cb514-71"><a href="plotting-functions-ggplotsci.html#cb514-71"></a>  </span>
<span id="cb514-72"><a href="plotting-functions-ggplotsci.html#cb514-72"></a>  <span class="co"># add regression lines</span></span>
<span id="cb514-73"><a href="plotting-functions-ggplotsci.html#cb514-73"></a>  <span class="cf">for</span>(g_i <span class="cf">in</span> g_levels){</span>
<span id="cb514-74"><a href="plotting-functions-ggplotsci.html#cb514-74"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span></span>
<span id="cb514-75"><a href="plotting-functions-ggplotsci.html#cb514-75"></a><span class="st">      </span><span class="kw">geom_path</span>(<span class="dt">data =</span> new_long[get <span class="op">==</span><span class="st"> </span>g_i,],</span>
<span id="cb514-76"><a href="plotting-functions-ggplotsci.html#cb514-76"></a>                <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">get</span>(x),</span>
<span id="cb514-77"><a href="plotting-functions-ggplotsci.html#cb514-77"></a>                    <span class="dt">y =</span> <span class="kw">get</span>(y),</span>
<span id="cb514-78"><a href="plotting-functions-ggplotsci.html#cb514-78"></a>                    <span class="dt">color =</span> <span class="kw">get</span>(g)</span>
<span id="cb514-79"><a href="plotting-functions-ggplotsci.html#cb514-79"></a>                ))</span>
<span id="cb514-80"><a href="plotting-functions-ggplotsci.html#cb514-80"></a>  }</span>
<span id="cb514-81"><a href="plotting-functions-ggplotsci.html#cb514-81"></a>  </span>
<span id="cb514-82"><a href="plotting-functions-ggplotsci.html#cb514-82"></a></span>
<span id="cb514-83"><a href="plotting-functions-ggplotsci.html#cb514-83"></a>  gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="co"># aesthetics</span></span>
<span id="cb514-84"><a href="plotting-functions-ggplotsci.html#cb514-84"></a><span class="st">    </span><span class="kw">xlab</span>(cov_label) <span class="op">+</span></span>
<span id="cb514-85"><a href="plotting-functions-ggplotsci.html#cb514-85"></a><span class="st">    </span><span class="kw">ylab</span>(y_label) <span class="op">+</span></span>
<span id="cb514-86"><a href="plotting-functions-ggplotsci.html#cb514-86"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>pal_nature_mod) <span class="op">+</span></span>
<span id="cb514-87"><a href="plotting-functions-ggplotsci.html#cb514-87"></a><span class="st">    </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb514-88"><a href="plotting-functions-ggplotsci.html#cb514-88"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb514-89"><a href="plotting-functions-ggplotsci.html#cb514-89"></a><span class="st">    </span></span>
<span id="cb514-90"><a href="plotting-functions-ggplotsci.html#cb514-90"></a><span class="st">    </span><span class="ot">NULL</span></span>
<span id="cb514-91"><a href="plotting-functions-ggplotsci.html#cb514-91"></a></span>
<span id="cb514-92"><a href="plotting-functions-ggplotsci.html#cb514-92"></a>  <span class="cf">if</span>(<span class="kw">is.null</span>(p_show)){p_show <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(fit_pairs_dt)}</span>
<span id="cb514-93"><a href="plotting-functions-ggplotsci.html#cb514-93"></a>  <span class="cf">if</span>(<span class="kw">sum</span>(p_show) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){</span>
<span id="cb514-94"><a href="plotting-functions-ggplotsci.html#cb514-94"></a>    <span class="cf">if</span>(p_pos <span class="op">==</span><span class="st"> &quot;center&quot;</span>){</span>
<span id="cb514-95"><a href="plotting-functions-ggplotsci.html#cb514-95"></a>      x_p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">range</span>(dt[, <span class="kw">get</span>(cov_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span>
<span id="cb514-96"><a href="plotting-functions-ggplotsci.html#cb514-96"></a>    }</span>
<span id="cb514-97"><a href="plotting-functions-ggplotsci.html#cb514-97"></a>    <span class="cf">if</span>(p_pos <span class="op">==</span><span class="st"> &quot;left&quot;</span>){</span>
<span id="cb514-98"><a href="plotting-functions-ggplotsci.html#cb514-98"></a>      x_p &lt;-<span class="st"> </span><span class="kw">min</span>(dt[, <span class="kw">get</span>(cov_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">diff</span>(<span class="kw">range</span>(dt[, <span class="kw">get</span>(cov_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))<span class="op">/</span><span class="dv">10</span></span>
<span id="cb514-99"><a href="plotting-functions-ggplotsci.html#cb514-99"></a>    }</span>
<span id="cb514-100"><a href="plotting-functions-ggplotsci.html#cb514-100"></a>    <span class="cf">if</span>(p_pos <span class="op">==</span><span class="st"> &quot;right&quot;</span>){</span>
<span id="cb514-101"><a href="plotting-functions-ggplotsci.html#cb514-101"></a>      x_p &lt;-<span class="st"> </span><span class="kw">max</span>(dt[, <span class="kw">get</span>(cov_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">-</span><span class="st"> </span><span class="kw">diff</span>(<span class="kw">range</span>(dt[, <span class="kw">get</span>(cov_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))<span class="op">/</span><span class="dv">10</span></span>
<span id="cb514-102"><a href="plotting-functions-ggplotsci.html#cb514-102"></a>    }</span>
<span id="cb514-103"><a href="plotting-functions-ggplotsci.html#cb514-103"></a>    </span>
<span id="cb514-104"><a href="plotting-functions-ggplotsci.html#cb514-104"></a>    pos_p &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(p_show)</span>
<span id="cb514-105"><a href="plotting-functions-ggplotsci.html#cb514-105"></a>    max_y &lt;-<span class="st"> </span><span class="kw">max</span>(dt[, <span class="kw">get</span>(y_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb514-106"><a href="plotting-functions-ggplotsci.html#cb514-106"></a>    min_y &lt;-<span class="st"> </span><span class="kw">min</span>(dt[, <span class="kw">get</span>(y_col)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb514-107"><a href="plotting-functions-ggplotsci.html#cb514-107"></a>    increment &lt;-<span class="st"> </span><span class="fl">0.075</span><span class="op">*</span>(max_y <span class="op">-</span><span class="st"> </span>min_y)</span>
<span id="cb514-108"><a href="plotting-functions-ggplotsci.html#cb514-108"></a></span>
<span id="cb514-109"><a href="plotting-functions-ggplotsci.html#cb514-109"></a>    <span class="cf">for</span>(i <span class="cf">in</span> pos_p){</span>
<span id="cb514-110"><a href="plotting-functions-ggplotsci.html#cb514-110"></a>      y_p &lt;-<span class="st"> </span>max_y <span class="op">+</span><span class="st"> </span>increment<span class="op">*</span>i</span>
<span id="cb514-111"><a href="plotting-functions-ggplotsci.html#cb514-111"></a>      row &lt;-<span class="st"> </span>p_show[i]</span>
<span id="cb514-112"><a href="plotting-functions-ggplotsci.html#cb514-112"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb514-113"><a href="plotting-functions-ggplotsci.html#cb514-113"></a>                        <span class="dt">x =</span> x_p,</span>
<span id="cb514-114"><a href="plotting-functions-ggplotsci.html#cb514-114"></a>                        <span class="dt">y =</span> y_p,</span>
<span id="cb514-115"><a href="plotting-functions-ggplotsci.html#cb514-115"></a>                        <span class="dt">label =</span> <span class="kw">paste0</span>(fit_pairs_dt[row, contrast],</span>
<span id="cb514-116"><a href="plotting-functions-ggplotsci.html#cb514-116"></a>                                       <span class="st">&quot;: &quot;</span>,</span>
<span id="cb514-117"><a href="plotting-functions-ggplotsci.html#cb514-117"></a>                                       fit_pairs_dt[row, p]))</span>
<span id="cb514-118"><a href="plotting-functions-ggplotsci.html#cb514-118"></a>    }</span>
<span id="cb514-119"><a href="plotting-functions-ggplotsci.html#cb514-119"></a>    </span>
<span id="cb514-120"><a href="plotting-functions-ggplotsci.html#cb514-120"></a>   </span>
<span id="cb514-121"><a href="plotting-functions-ggplotsci.html#cb514-121"></a>  }</span>
<span id="cb514-122"><a href="plotting-functions-ggplotsci.html#cb514-122"></a>  </span>
<span id="cb514-123"><a href="plotting-functions-ggplotsci.html#cb514-123"></a>    </span>
<span id="cb514-124"><a href="plotting-functions-ggplotsci.html#cb514-124"></a>    </span>
<span id="cb514-125"><a href="plotting-functions-ggplotsci.html#cb514-125"></a>  </span>
<span id="cb514-126"><a href="plotting-functions-ggplotsci.html#cb514-126"></a>  </span>
<span id="cb514-127"><a href="plotting-functions-ggplotsci.html#cb514-127"></a>  gg</span>
<span id="cb514-128"><a href="plotting-functions-ggplotsci.html#cb514-128"></a>  </span>
<span id="cb514-129"><a href="plotting-functions-ggplotsci.html#cb514-129"></a>  <span class="kw">return</span>(gg)</span>
<span id="cb514-130"><a href="plotting-functions-ggplotsci.html#cb514-130"></a>}</span></code></pre></div>
</div>
<div id="gg_mean_ci_ancova" class="section level2">
<h2><span class="header-section-number">22.7</span> gg_mean_ci_ancova</h2>
<p><code>gg_mean_ci_ancova</code> generates mean-and-CI plots that look like those published in most wet-bench experimental biology papers <em>except</em> that the dots are not the raw y-values but the y-values adjusted for the covariate (here “bw_02_05_18”). I describe this more in the output below.</p>
<p>The arguments to the function are (the bold face arguments are required):</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong> the data.table</li>
<li><strong>x_col</strong> the name of the treatment column (“diet” for this file) containing the treatment groups</li>
<li><strong>y_col</strong> the name of response column (<em>not</em> the column of ratios!)</li>
<li><strong>cov_col</strong>, the name of the column containing the covariate (“bw_02_05_18” for this file)</li>
<li>x_label = “none”, this is the label for the x-axis on the plot. “none” is the default (so no need to include) and results in no label (the plot looks better without it)</li>
<li>y_label = “Response (units)”, this is the label for the y-axis on the plot. You do want to replace the default with something meaningful and sense the y-variable is the <em>adjusted</em> response, it is important to include this in the label, so something like: y_label = “adj. SCAT (g)”</li>
<li>dots = “sina”, this controls how the dots are plotted. “sina” is clever.</li>
<li>dodge_width = 0.8, this controls how closely spaced the groups are in the plot</li>
<li>adjust = 0.5, this controls how wide the dots within each group</li>
<li>p_adjust = “none”, this controls p-value adjustment for multiple comparisons. This doesn’t matter for these data because there are only 2 groups in the diet treatment, so only 1 comparison (MR - CN).</li>
</ol>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="plotting-functions-ggplotsci.html#cb515-1"></a>gg_mean_ci_ancova &lt;-<span class="st"> </span><span class="cf">function</span>(data,</span>
<span id="cb515-2"><a href="plotting-functions-ggplotsci.html#cb515-2"></a>                       x_col,</span>
<span id="cb515-3"><a href="plotting-functions-ggplotsci.html#cb515-3"></a>                       y_col,</span>
<span id="cb515-4"><a href="plotting-functions-ggplotsci.html#cb515-4"></a>                       cov_col,</span>
<span id="cb515-5"><a href="plotting-functions-ggplotsci.html#cb515-5"></a>                       <span class="dt">x_label =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb515-6"><a href="plotting-functions-ggplotsci.html#cb515-6"></a>                       <span class="dt">y_label =</span> <span class="st">&quot;Response (units)&quot;</span>,</span>
<span id="cb515-7"><a href="plotting-functions-ggplotsci.html#cb515-7"></a>                       <span class="dt">dots =</span> <span class="st">&quot;sina&quot;</span>,</span>
<span id="cb515-8"><a href="plotting-functions-ggplotsci.html#cb515-8"></a>                       <span class="dt">dodge_width =</span> <span class="fl">0.8</span>,</span>
<span id="cb515-9"><a href="plotting-functions-ggplotsci.html#cb515-9"></a>                       <span class="dt">adjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb515-10"><a href="plotting-functions-ggplotsci.html#cb515-10"></a>                       <span class="dt">p_adjust =</span> <span class="st">&quot;none&quot;</span>){</span>
<span id="cb515-11"><a href="plotting-functions-ggplotsci.html#cb515-11"></a>  </span>
<span id="cb515-12"><a href="plotting-functions-ggplotsci.html#cb515-12"></a>  dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(data)[, .SD, .SDcols =<span class="st"> </span><span class="kw">c</span>(x_col, y_col, cov_col)]</span>
<span id="cb515-13"><a href="plotting-functions-ggplotsci.html#cb515-13"></a>  ref_group &lt;-<span class="st"> </span><span class="kw">levels</span>(dt[, <span class="kw">get</span>(x_col)])[<span class="dv">1</span>]</span>
<span id="cb515-14"><a href="plotting-functions-ggplotsci.html#cb515-14"></a>  </span>
<span id="cb515-15"><a href="plotting-functions-ggplotsci.html#cb515-15"></a>  <span class="co"># center the covariate by the mean of the reference, </span></span>
<span id="cb515-16"><a href="plotting-functions-ggplotsci.html#cb515-16"></a>  <span class="co"># which means the intercept of the model will be EXP[Y]_ref</span></span>
<span id="cb515-17"><a href="plotting-functions-ggplotsci.html#cb515-17"></a>  <span class="co"># at the average value of the covariate</span></span>
<span id="cb515-18"><a href="plotting-functions-ggplotsci.html#cb515-18"></a>  mean_cov_ref &lt;-<span class="st"> </span><span class="kw">mean</span>(dt[<span class="kw">get</span>(x_col)<span class="op">==</span>ref_group, <span class="kw">get</span>(cov_col)])</span>
<span id="cb515-19"><a href="plotting-functions-ggplotsci.html#cb515-19"></a>  dt[, cov_col_c <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">get</span>(cov_col) <span class="op">-</span><span class="st"> </span>mean_cov_ref]</span>
<span id="cb515-20"><a href="plotting-functions-ggplotsci.html#cb515-20"></a>  cov_col_c &lt;-<span class="st"> </span><span class="kw">paste0</span>(cov_col, <span class="st">&quot;_c&quot;</span>)</span>
<span id="cb515-21"><a href="plotting-functions-ggplotsci.html#cb515-21"></a>  <span class="kw">setnames</span>(dt, <span class="dt">old =</span> <span class="st">&quot;cov_col_c&quot;</span>, <span class="dt">new =</span> cov_col_c)</span>
<span id="cb515-22"><a href="plotting-functions-ggplotsci.html#cb515-22"></a>  </span>
<span id="cb515-23"><a href="plotting-functions-ggplotsci.html#cb515-23"></a>  <span class="co"># two ways for computing adjusted y</span></span>
<span id="cb515-24"><a href="plotting-functions-ggplotsci.html#cb515-24"></a>  <span class="co"># &quot;xside_xxx&quot; is the &quot;x side&quot; of the formula</span></span>
<span id="cb515-25"><a href="plotting-functions-ggplotsci.html#cb515-25"></a>  <span class="co"># xside_1 doesn&#39;t use centered covariate but uses predicted value at mean covariate</span></span>
<span id="cb515-26"><a href="plotting-functions-ggplotsci.html#cb515-26"></a>  <span class="co"># xside_2 uses the centered covariate</span></span>
<span id="cb515-27"><a href="plotting-functions-ggplotsci.html#cb515-27"></a>  xside_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">c</span>(cov_col, x_col), <span class="dt">collapse =</span> <span class="st">&quot; + &quot;</span>)</span>
<span id="cb515-28"><a href="plotting-functions-ggplotsci.html#cb515-28"></a>  xside_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">c</span>(cov_col_c, x_col), <span class="dt">collapse =</span> <span class="st">&quot; + &quot;</span>)</span>
<span id="cb515-29"><a href="plotting-functions-ggplotsci.html#cb515-29"></a>  </span>
<span id="cb515-30"><a href="plotting-functions-ggplotsci.html#cb515-30"></a>  form1 &lt;-<span class="st"> </span><span class="kw">formula</span>(<span class="kw">paste</span>(y_col, <span class="st">&quot;~&quot;</span>, xside_<span class="dv">1</span>))</span>
<span id="cb515-31"><a href="plotting-functions-ggplotsci.html#cb515-31"></a>  form2 &lt;-<span class="st"> </span><span class="kw">formula</span>(<span class="kw">paste</span>(y_col, <span class="st">&quot;~&quot;</span>, xside_<span class="dv">2</span>))</span>
<span id="cb515-32"><a href="plotting-functions-ggplotsci.html#cb515-32"></a>  </span>
<span id="cb515-33"><a href="plotting-functions-ggplotsci.html#cb515-33"></a>  m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(form1, <span class="dt">data =</span> dt)</span>
<span id="cb515-34"><a href="plotting-functions-ggplotsci.html#cb515-34"></a>  m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(form2, <span class="dt">data =</span> dt)</span>
<span id="cb515-35"><a href="plotting-functions-ggplotsci.html#cb515-35"></a></span>
<span id="cb515-36"><a href="plotting-functions-ggplotsci.html#cb515-36"></a>  <span class="co"># using model 2 - centered covariate in model</span></span>
<span id="cb515-37"><a href="plotting-functions-ggplotsci.html#cb515-37"></a>  b &lt;-<span class="st"> </span><span class="kw">coef</span>(m2)</span>
<span id="cb515-38"><a href="plotting-functions-ggplotsci.html#cb515-38"></a>  dummy &lt;-<span class="st"> </span><span class="kw">as.integer</span>(dt[, <span class="kw">get</span>(x_col)]) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb515-39"><a href="plotting-functions-ggplotsci.html#cb515-39"></a>  dt[, y_cond <span class="op">:</span><span class="er">=</span><span class="st"> </span>b[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>b[<span class="dv">3</span>]<span class="op">*</span>dummy <span class="op">+</span><span class="st"> </span><span class="kw">residuals</span>(m2)]</span>
<span id="cb515-40"><a href="plotting-functions-ggplotsci.html#cb515-40"></a>  </span>
<span id="cb515-41"><a href="plotting-functions-ggplotsci.html#cb515-41"></a>  <span class="co"># using model 1 - prediction at mean covariate</span></span>
<span id="cb515-42"><a href="plotting-functions-ggplotsci.html#cb515-42"></a>  new_data &lt;-<span class="st"> </span><span class="kw">copy</span>(dt)</span>
<span id="cb515-43"><a href="plotting-functions-ggplotsci.html#cb515-43"></a>  new_data[, bw_<span class="dv">02</span>_<span class="dv">05</span>_<span class="dv">18</span> <span class="op">:</span><span class="er">=</span><span class="st"> </span>mean_cov_ref]</span>
<span id="cb515-44"><a href="plotting-functions-ggplotsci.html#cb515-44"></a>  dt[, y_cond2 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">predict</span>(m1, new_data) <span class="op">+</span><span class="st"> </span><span class="kw">residuals</span>(m1)]</span>
<span id="cb515-45"><a href="plotting-functions-ggplotsci.html#cb515-45"></a>  </span>
<span id="cb515-46"><a href="plotting-functions-ggplotsci.html#cb515-46"></a>  <span class="co"># emmeans</span></span>
<span id="cb515-47"><a href="plotting-functions-ggplotsci.html#cb515-47"></a>  temp_emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(m1,</span>
<span id="cb515-48"><a href="plotting-functions-ggplotsci.html#cb515-48"></a>                     <span class="dt">specs =</span> x_col) <span class="op">%&gt;%</span></span>
<span id="cb515-49"><a href="plotting-functions-ggplotsci.html#cb515-49"></a><span class="st">    </span><span class="kw">summary</span>() <span class="op">%&gt;%</span></span>
<span id="cb515-50"><a href="plotting-functions-ggplotsci.html#cb515-50"></a><span class="st">    </span><span class="kw">data.table</span>()</span>
<span id="cb515-51"><a href="plotting-functions-ggplotsci.html#cb515-51"></a>  emm_offset &lt;-<span class="st"> </span>b[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>temp_emm[<span class="kw">get</span>(x_col) <span class="op">==</span><span class="st"> </span>ref_group, emmean]</span>
<span id="cb515-52"><a href="plotting-functions-ggplotsci.html#cb515-52"></a>  </span>
<span id="cb515-53"><a href="plotting-functions-ggplotsci.html#cb515-53"></a>  fit_emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(m1,</span>
<span id="cb515-54"><a href="plotting-functions-ggplotsci.html#cb515-54"></a>                     <span class="dt">specs =</span> x_col,</span>
<span id="cb515-55"><a href="plotting-functions-ggplotsci.html#cb515-55"></a>                     <span class="dt">offset =</span> emm_offset)</span>
<span id="cb515-56"><a href="plotting-functions-ggplotsci.html#cb515-56"></a>  </span>
<span id="cb515-57"><a href="plotting-functions-ggplotsci.html#cb515-57"></a>  fit_pairs &lt;-<span class="st"> </span><span class="kw">contrast</span>(fit_emm,</span>
<span id="cb515-58"><a href="plotting-functions-ggplotsci.html#cb515-58"></a>                        <span class="dt">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb515-59"><a href="plotting-functions-ggplotsci.html#cb515-59"></a>                        <span class="dt">adjust =</span> p_adjust) <span class="op">%&gt;%</span></span>
<span id="cb515-60"><a href="plotting-functions-ggplotsci.html#cb515-60"></a><span class="st">    </span><span class="kw">summary</span>(<span class="dt">infer =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>))</span>
<span id="cb515-61"><a href="plotting-functions-ggplotsci.html#cb515-61"></a>  </span>
<span id="cb515-62"><a href="plotting-functions-ggplotsci.html#cb515-62"></a>  fit_emm_dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="kw">summary</span>(fit_emm))</span>
<span id="cb515-63"><a href="plotting-functions-ggplotsci.html#cb515-63"></a>  fit_pairs_dt &lt;-<span class="st"> </span><span class="kw">pairs_table</span>(<span class="kw">data.table</span>(fit_pairs))</span>
<span id="cb515-64"><a href="plotting-functions-ggplotsci.html#cb515-64"></a>  </span>
<span id="cb515-65"><a href="plotting-functions-ggplotsci.html#cb515-65"></a>  x_col1 &lt;-<span class="st"> </span>x_col[<span class="dv">1</span>]</span>
<span id="cb515-66"><a href="plotting-functions-ggplotsci.html#cb515-66"></a>  <span class="cf">if</span>(<span class="kw">length</span>(x_col)<span class="op">==</span><span class="dv">2</span>){</span>
<span id="cb515-67"><a href="plotting-functions-ggplotsci.html#cb515-67"></a>    g_col &lt;-<span class="st"> </span>x_col[<span class="dv">2</span>]</span>
<span id="cb515-68"><a href="plotting-functions-ggplotsci.html#cb515-68"></a>  }<span class="cf">else</span>{</span>
<span id="cb515-69"><a href="plotting-functions-ggplotsci.html#cb515-69"></a>    g_col &lt;-<span class="st"> </span>x_col[<span class="dv">1</span>]</span>
<span id="cb515-70"><a href="plotting-functions-ggplotsci.html#cb515-70"></a>  }</span>
<span id="cb515-71"><a href="plotting-functions-ggplotsci.html#cb515-71"></a>  </span>
<span id="cb515-72"><a href="plotting-functions-ggplotsci.html#cb515-72"></a>  <span class="cf">if</span>(g_col <span class="op">==</span><span class="st"> </span>x_col1){</span>
<span id="cb515-73"><a href="plotting-functions-ggplotsci.html#cb515-73"></a>    pd &lt;-<span class="st"> </span><span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="dv">0</span>)</span>
<span id="cb515-74"><a href="plotting-functions-ggplotsci.html#cb515-74"></a>  }<span class="cf">else</span>{</span>
<span id="cb515-75"><a href="plotting-functions-ggplotsci.html#cb515-75"></a>    pd &lt;-<span class="st"> </span><span class="kw">position_dodge</span>(<span class="dt">width =</span> dodge_width)</span>
<span id="cb515-76"><a href="plotting-functions-ggplotsci.html#cb515-76"></a>  }</span>
<span id="cb515-77"><a href="plotting-functions-ggplotsci.html#cb515-77"></a>  </span>
<span id="cb515-78"><a href="plotting-functions-ggplotsci.html#cb515-78"></a>  gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>dt, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">get</span>(x_col1),</span>
<span id="cb515-79"><a href="plotting-functions-ggplotsci.html#cb515-79"></a>                            <span class="dt">y =</span> y_cond,</span>
<span id="cb515-80"><a href="plotting-functions-ggplotsci.html#cb515-80"></a>                            <span class="dt">color =</span> <span class="kw">get</span>(g_col)))</span>
<span id="cb515-81"><a href="plotting-functions-ggplotsci.html#cb515-81"></a>    <span class="co"># plot points</span></span>
<span id="cb515-82"><a href="plotting-functions-ggplotsci.html#cb515-82"></a>    <span class="cf">if</span>(dots <span class="op">==</span><span class="st"> &quot;sina&quot;</span>){</span>
<span id="cb515-83"><a href="plotting-functions-ggplotsci.html#cb515-83"></a>      gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">geom_sina</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb515-84"><a href="plotting-functions-ggplotsci.html#cb515-84"></a>                <span class="dt">position =</span> pd,</span>
<span id="cb515-85"><a href="plotting-functions-ggplotsci.html#cb515-85"></a>                <span class="dt">adjust =</span> adjust)</span>
<span id="cb515-86"><a href="plotting-functions-ggplotsci.html#cb515-86"></a>      </span>
<span id="cb515-87"><a href="plotting-functions-ggplotsci.html#cb515-87"></a>    }</span>
<span id="cb515-88"><a href="plotting-functions-ggplotsci.html#cb515-88"></a>    <span class="cf">if</span>(dots <span class="op">==</span><span class="st"> &quot;jitter&quot;</span>){</span>
<span id="cb515-89"><a href="plotting-functions-ggplotsci.html#cb515-89"></a>      gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">geom_dotplot</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb515-90"><a href="plotting-functions-ggplotsci.html#cb515-90"></a>                <span class="dt">position =</span> pd)</span>
<span id="cb515-91"><a href="plotting-functions-ggplotsci.html#cb515-91"></a>      </span>
<span id="cb515-92"><a href="plotting-functions-ggplotsci.html#cb515-92"></a>    }</span>
<span id="cb515-93"><a href="plotting-functions-ggplotsci.html#cb515-93"></a>  </span>
<span id="cb515-94"><a href="plotting-functions-ggplotsci.html#cb515-94"></a>  <span class="co"># plot means and CI</span></span>
<span id="cb515-95"><a href="plotting-functions-ggplotsci.html#cb515-95"></a>  gg &lt;-<span class="st"> </span>gg <span class="op">+</span></span>
<span id="cb515-96"><a href="plotting-functions-ggplotsci.html#cb515-96"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> fit_emm_dt, <span class="kw">aes</span>(<span class="dt">y =</span> emmean,</span>
<span id="cb515-97"><a href="plotting-functions-ggplotsci.html#cb515-97"></a>                                           <span class="dt">ymin =</span> lower.CL,</span>
<span id="cb515-98"><a href="plotting-functions-ggplotsci.html#cb515-98"></a>                                           <span class="dt">ymax =</span> upper.CL,</span>
<span id="cb515-99"><a href="plotting-functions-ggplotsci.html#cb515-99"></a>                                        <span class="dt">color =</span> <span class="kw">get</span>(g_col)),</span>
<span id="cb515-100"><a href="plotting-functions-ggplotsci.html#cb515-100"></a>               <span class="dt">width =</span> <span class="dv">0</span>,</span>
<span id="cb515-101"><a href="plotting-functions-ggplotsci.html#cb515-101"></a>              <span class="dt">position =</span> pd</span>
<span id="cb515-102"><a href="plotting-functions-ggplotsci.html#cb515-102"></a>    ) <span class="op">+</span></span>
<span id="cb515-103"><a href="plotting-functions-ggplotsci.html#cb515-103"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> fit_emm_dt, <span class="kw">aes</span>(<span class="dt">y =</span> emmean,</span>
<span id="cb515-104"><a href="plotting-functions-ggplotsci.html#cb515-104"></a>                                        <span class="dt">color =</span> <span class="kw">get</span>(g_col)),</span>
<span id="cb515-105"><a href="plotting-functions-ggplotsci.html#cb515-105"></a>               <span class="dt">size =</span> <span class="dv">3</span>,</span>
<span id="cb515-106"><a href="plotting-functions-ggplotsci.html#cb515-106"></a>              <span class="dt">position =</span> pd</span>
<span id="cb515-107"><a href="plotting-functions-ggplotsci.html#cb515-107"></a>    ) <span class="op">+</span></span>
<span id="cb515-108"><a href="plotting-functions-ggplotsci.html#cb515-108"></a><span class="st">    </span></span>
<span id="cb515-109"><a href="plotting-functions-ggplotsci.html#cb515-109"></a><span class="st">    </span><span class="co"># aesthetics</span></span>
<span id="cb515-110"><a href="plotting-functions-ggplotsci.html#cb515-110"></a><span class="st">    </span><span class="kw">ylab</span>(y_label) <span class="op">+</span></span>
<span id="cb515-111"><a href="plotting-functions-ggplotsci.html#cb515-111"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>pal_nature_mod) <span class="op">+</span></span>
<span id="cb515-112"><a href="plotting-functions-ggplotsci.html#cb515-112"></a><span class="st">    </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb515-113"><a href="plotting-functions-ggplotsci.html#cb515-113"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb515-114"><a href="plotting-functions-ggplotsci.html#cb515-114"></a><span class="st">    </span></span>
<span id="cb515-115"><a href="plotting-functions-ggplotsci.html#cb515-115"></a><span class="st">    </span><span class="ot">NULL</span></span>
<span id="cb515-116"><a href="plotting-functions-ggplotsci.html#cb515-116"></a>  </span>
<span id="cb515-117"><a href="plotting-functions-ggplotsci.html#cb515-117"></a>  <span class="co"># add p-value</span></span>
<span id="cb515-118"><a href="plotting-functions-ggplotsci.html#cb515-118"></a>  y_positions &lt;-<span class="st"> </span><span class="kw">max</span>(dt[, y_cond]) <span class="op">+</span><span class="st"> </span></span>
<span id="cb515-119"><a href="plotting-functions-ggplotsci.html#cb515-119"></a><span class="st">    </span><span class="fl">0.075</span><span class="op">*</span>(<span class="kw">max</span>(dt[, y_cond]) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(dt[, y_cond]))</span>
<span id="cb515-120"><a href="plotting-functions-ggplotsci.html#cb515-120"></a>  gg &lt;-<span class="st"> </span>gg <span class="op">+</span></span>
<span id="cb515-121"><a href="plotting-functions-ggplotsci.html#cb515-121"></a><span class="st">    </span><span class="kw">stat_pvalue_manual</span>(fit_pairs_dt, <span class="co"># only show sox effects</span></span>
<span id="cb515-122"><a href="plotting-functions-ggplotsci.html#cb515-122"></a>                       <span class="dt">label =</span> <span class="st">&quot;p&quot;</span>, </span>
<span id="cb515-123"><a href="plotting-functions-ggplotsci.html#cb515-123"></a>                       <span class="dt">y.position=</span>y_positions)</span>
<span id="cb515-124"><a href="plotting-functions-ggplotsci.html#cb515-124"></a>  </span>
<span id="cb515-125"><a href="plotting-functions-ggplotsci.html#cb515-125"></a>  <span class="co"># make sure ylim includes p-value</span></span>
<span id="cb515-126"><a href="plotting-functions-ggplotsci.html#cb515-126"></a>  ymax &lt;-<span class="st"> </span><span class="kw">max</span>(dt[, y_cond])</span>
<span id="cb515-127"><a href="plotting-functions-ggplotsci.html#cb515-127"></a>  ymin &lt;-<span class="st"> </span><span class="kw">min</span>(dt[, y_cond])</span>
<span id="cb515-128"><a href="plotting-functions-ggplotsci.html#cb515-128"></a>  y_hi &lt;-<span class="st"> </span>ymax <span class="op">+</span><span class="st"> </span><span class="fl">0.115</span><span class="op">*</span>(ymax <span class="op">-</span><span class="st"> </span>ymin)</span>
<span id="cb515-129"><a href="plotting-functions-ggplotsci.html#cb515-129"></a>  y_lo &lt;-<span class="st"> </span>ymin <span class="op">-</span><span class="st"> </span><span class="fl">0.05</span><span class="op">*</span>(ymax <span class="op">-</span><span class="st"> </span>ymin)</span>
<span id="cb515-130"><a href="plotting-functions-ggplotsci.html#cb515-130"></a>  gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(</span>
<span id="cb515-131"><a href="plotting-functions-ggplotsci.html#cb515-131"></a>    <span class="dt">ylim =</span> <span class="kw">c</span>(y_lo, y_hi),</span>
<span id="cb515-132"><a href="plotting-functions-ggplotsci.html#cb515-132"></a>  )  </span>
<span id="cb515-133"><a href="plotting-functions-ggplotsci.html#cb515-133"></a>  </span>
<span id="cb515-134"><a href="plotting-functions-ggplotsci.html#cb515-134"></a>  <span class="co"># remove x axis title</span></span>
<span id="cb515-135"><a href="plotting-functions-ggplotsci.html#cb515-135"></a>  <span class="cf">if</span>(x_label <span class="op">==</span><span class="st"> &quot;none&quot;</span>){</span>
<span id="cb515-136"><a href="plotting-functions-ggplotsci.html#cb515-136"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>())</span>
<span id="cb515-137"><a href="plotting-functions-ggplotsci.html#cb515-137"></a>  }<span class="cf">else</span>{</span>
<span id="cb515-138"><a href="plotting-functions-ggplotsci.html#cb515-138"></a>    gg &lt;-<span class="st"> </span>gg <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(x_label)}</span>
<span id="cb515-139"><a href="plotting-functions-ggplotsci.html#cb515-139"></a>  </span>
<span id="cb515-140"><a href="plotting-functions-ggplotsci.html#cb515-140"></a>  gg</span>
<span id="cb515-141"><a href="plotting-functions-ggplotsci.html#cb515-141"></a>  </span>
<span id="cb515-142"><a href="plotting-functions-ggplotsci.html#cb515-142"></a>  <span class="kw">return</span>(gg)</span>
<span id="cb515-143"><a href="plotting-functions-ggplotsci.html#cb515-143"></a>}</span></code></pre></div>
</div>
<div id="gg_effects" class="section level2">
<h2><span class="header-section-number">22.8</span> gg_effects</h2>
<p><code>gg_effects</code> generates an “effects” plot, which is common in the clinical medicine but not experimental biology literature. This is a function that you would directly call in the analysis pipeline if you wanted plots like these. The arguments to the function are (the bold face arguments are required):</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong> the data.table</li>
<li><strong>x_col</strong> the name of the treatment column (“diet” for this file) containing the treatment groups</li>
<li><strong>y_col</strong> the name of response column (<em>not</em> the column of ratios!)</li>
<li><strong>cov_col</strong>, the name of the column containing the covariate (“bw_02_05_18” for this file)</li>
<li>x_label = “none”, this is the label for the x-axis on the plot which is the name of the covariate column. You do want to replace the default with something meaningful. For these data, something like: cov_label = “Body Mass (g)”</li>
<li>y_label = “contrast”, this is the label for the y-axis on the plot. You do want to replace the default with something meaningful like: y_label = “SCAT (g)”</li>
<li>p_adjust = “none”, this controls p-value adjustment for multiple comparisons. This doesn’t matter for these data because there are only 2 groups in the diet treatment, so only 1 comparison (MR - CN).</li>
</ol>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="plotting-functions-ggplotsci.html#cb516-1"></a>gg_effects &lt;-<span class="st"> </span><span class="cf">function</span>(data,</span>
<span id="cb516-2"><a href="plotting-functions-ggplotsci.html#cb516-2"></a>                       x_col,</span>
<span id="cb516-3"><a href="plotting-functions-ggplotsci.html#cb516-3"></a>                       y_col,</span>
<span id="cb516-4"><a href="plotting-functions-ggplotsci.html#cb516-4"></a>                       cov_col,</span>
<span id="cb516-5"><a href="plotting-functions-ggplotsci.html#cb516-5"></a>                       <span class="dt">x_label =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb516-6"><a href="plotting-functions-ggplotsci.html#cb516-6"></a>                       <span class="dt">y_label =</span> <span class="st">&quot;contrast&quot;</span>,</span>
<span id="cb516-7"><a href="plotting-functions-ggplotsci.html#cb516-7"></a>                       <span class="dt">p_adjust =</span> <span class="st">&quot;none&quot;</span>){</span>
<span id="cb516-8"><a href="plotting-functions-ggplotsci.html#cb516-8"></a>  </span>
<span id="cb516-9"><a href="plotting-functions-ggplotsci.html#cb516-9"></a>  dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(data)[, .SD, .SDcols =<span class="st"> </span><span class="kw">c</span>(x_col, y_col, cov_col)]</span>
<span id="cb516-10"><a href="plotting-functions-ggplotsci.html#cb516-10"></a></span>
<span id="cb516-11"><a href="plotting-functions-ggplotsci.html#cb516-11"></a>  xside_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">c</span>(cov_col, x_col), <span class="dt">collapse =</span> <span class="st">&quot; + &quot;</span>)</span>
<span id="cb516-12"><a href="plotting-functions-ggplotsci.html#cb516-12"></a></span>
<span id="cb516-13"><a href="plotting-functions-ggplotsci.html#cb516-13"></a>  form1 &lt;-<span class="st"> </span><span class="kw">formula</span>(<span class="kw">paste</span>(y_col, <span class="st">&quot;~&quot;</span>, xside_<span class="dv">1</span>))</span>
<span id="cb516-14"><a href="plotting-functions-ggplotsci.html#cb516-14"></a></span>
<span id="cb516-15"><a href="plotting-functions-ggplotsci.html#cb516-15"></a>  m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(form1, <span class="dt">data =</span> dt)</span>
<span id="cb516-16"><a href="plotting-functions-ggplotsci.html#cb516-16"></a></span>
<span id="cb516-17"><a href="plotting-functions-ggplotsci.html#cb516-17"></a>  fit_emm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(m1,</span>
<span id="cb516-18"><a href="plotting-functions-ggplotsci.html#cb516-18"></a>                     <span class="dt">specs =</span> x_col)</span>
<span id="cb516-19"><a href="plotting-functions-ggplotsci.html#cb516-19"></a>  </span>
<span id="cb516-20"><a href="plotting-functions-ggplotsci.html#cb516-20"></a>  fit_pairs &lt;-<span class="st"> </span><span class="kw">contrast</span>(fit_emm,</span>
<span id="cb516-21"><a href="plotting-functions-ggplotsci.html#cb516-21"></a>                        <span class="dt">method =</span> <span class="st">&quot;revpairwise&quot;</span>,</span>
<span id="cb516-22"><a href="plotting-functions-ggplotsci.html#cb516-22"></a>                        <span class="dt">adjust =</span> p_adjust) <span class="op">%&gt;%</span></span>
<span id="cb516-23"><a href="plotting-functions-ggplotsci.html#cb516-23"></a><span class="st">    </span><span class="kw">summary</span>(<span class="dt">infer =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>))</span>
<span id="cb516-24"><a href="plotting-functions-ggplotsci.html#cb516-24"></a>  </span>
<span id="cb516-25"><a href="plotting-functions-ggplotsci.html#cb516-25"></a>  fit_emm_dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="kw">summary</span>(fit_emm))</span>
<span id="cb516-26"><a href="plotting-functions-ggplotsci.html#cb516-26"></a>  fit_effect &lt;-<span class="st"> </span><span class="kw">pairs_table</span>(<span class="kw">data.table</span>(fit_pairs))</span>
<span id="cb516-27"><a href="plotting-functions-ggplotsci.html#cb516-27"></a>  </span>
<span id="cb516-28"><a href="plotting-functions-ggplotsci.html#cb516-28"></a>  <span class="cf">if</span>(y_label <span class="op">==</span><span class="st"> &quot;contrast&quot;</span>){</span>
<span id="cb516-29"><a href="plotting-functions-ggplotsci.html#cb516-29"></a>    y_label &lt;-<span class="st"> </span>fit_effect[<span class="dv">1</span>, contrast]</span>
<span id="cb516-30"><a href="plotting-functions-ggplotsci.html#cb516-30"></a>  }</span>
<span id="cb516-31"><a href="plotting-functions-ggplotsci.html#cb516-31"></a>  </span>
<span id="cb516-32"><a href="plotting-functions-ggplotsci.html#cb516-32"></a>  fit_effect[, contrast <span class="op">:</span><span class="er">=</span><span class="st"> </span>x_label]</span>
<span id="cb516-33"><a href="plotting-functions-ggplotsci.html#cb516-33"></a>  <span class="co"># # fit_effect[, contrast_pretty := paste(group1, &quot;\n-&quot;, group2)]</span></span>
<span id="cb516-34"><a href="plotting-functions-ggplotsci.html#cb516-34"></a>  <span class="co"># # fit_effect[, contrast_pretty := paste(group1, &quot;\n minus \n&quot;, group2)]</span></span>
<span id="cb516-35"><a href="plotting-functions-ggplotsci.html#cb516-35"></a>  <span class="co"># if(is.null(y_label)){</span></span>
<span id="cb516-36"><a href="plotting-functions-ggplotsci.html#cb516-36"></a>  <span class="co">#   y_label &lt;- &quot;Difference in means (units)&quot;</span></span>
<span id="cb516-37"><a href="plotting-functions-ggplotsci.html#cb516-37"></a>  <span class="co"># }</span></span>
<span id="cb516-38"><a href="plotting-functions-ggplotsci.html#cb516-38"></a>  </span>
<span id="cb516-39"><a href="plotting-functions-ggplotsci.html#cb516-39"></a>  min_bound &lt;-<span class="st"> </span><span class="kw">min</span>(fit_effect[, lower.CL])</span>
<span id="cb516-40"><a href="plotting-functions-ggplotsci.html#cb516-40"></a>  max_bound &lt;-<span class="st"> </span><span class="kw">min</span>(fit_effect[, upper.CL])</span>
<span id="cb516-41"><a href="plotting-functions-ggplotsci.html#cb516-41"></a>  y_lo &lt;-<span class="st"> </span><span class="kw">min</span>(min_bound<span class="op">+</span>min_bound<span class="op">*</span><span class="fl">0.2</span>,</span>
<span id="cb516-42"><a href="plotting-functions-ggplotsci.html#cb516-42"></a>              <span class="op">-</span>max_bound)</span>
<span id="cb516-43"><a href="plotting-functions-ggplotsci.html#cb516-43"></a>  y_hi &lt;-<span class="st"> </span><span class="kw">max</span>(max_bound <span class="op">+</span><span class="st"> </span>max_bound<span class="op">*</span><span class="fl">0.2</span>,</span>
<span id="cb516-44"><a href="plotting-functions-ggplotsci.html#cb516-44"></a>              <span class="op">-</span>min_bound)</span>
<span id="cb516-45"><a href="plotting-functions-ggplotsci.html#cb516-45"></a>  y_lims &lt;-<span class="st"> </span><span class="kw">c</span>(y_lo, y_hi)</span>
<span id="cb516-46"><a href="plotting-functions-ggplotsci.html#cb516-46"></a>  </span>
<span id="cb516-47"><a href="plotting-functions-ggplotsci.html#cb516-47"></a>  gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>fit_effect, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">fct_rev</span>(contrast),</span>
<span id="cb516-48"><a href="plotting-functions-ggplotsci.html#cb516-48"></a>                                    <span class="dt">y =</span> estimate)) <span class="op">+</span></span>
<span id="cb516-49"><a href="plotting-functions-ggplotsci.html#cb516-49"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>lower.CL, </span>
<span id="cb516-50"><a href="plotting-functions-ggplotsci.html#cb516-50"></a>                      <span class="dt">ymax=</span>upper.CL),</span>
<span id="cb516-51"><a href="plotting-functions-ggplotsci.html#cb516-51"></a>                  <span class="dt">width=</span><span class="dv">0</span>, </span>
<span id="cb516-52"><a href="plotting-functions-ggplotsci.html#cb516-52"></a>                  <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb516-53"><a href="plotting-functions-ggplotsci.html#cb516-53"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb516-54"><a href="plotting-functions-ggplotsci.html#cb516-54"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb516-55"><a href="plotting-functions-ggplotsci.html#cb516-55"></a><span class="st">    </span><span class="kw">coord_flip</span>(<span class="dt">ylim =</span> y_lims) <span class="op">+</span><span class="st"> </span></span>
<span id="cb516-56"><a href="plotting-functions-ggplotsci.html#cb516-56"></a><span class="st">    </span><span class="co">#coord_flip() + </span></span>
<span id="cb516-57"><a href="plotting-functions-ggplotsci.html#cb516-57"></a><span class="st">    </span><span class="co">#scale_y_continuous(position=&quot;right&quot;) +</span></span>
<span id="cb516-58"><a href="plotting-functions-ggplotsci.html#cb516-58"></a><span class="st">    </span><span class="kw">theme_pubr</span>() <span class="op">+</span></span>
<span id="cb516-59"><a href="plotting-functions-ggplotsci.html#cb516-59"></a><span class="st">    </span><span class="kw">ylab</span>(y_label) <span class="op">+</span></span>
<span id="cb516-60"><a href="plotting-functions-ggplotsci.html#cb516-60"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb516-61"><a href="plotting-functions-ggplotsci.html#cb516-61"></a><span class="st">    </span><span class="ot">NULL</span></span>
<span id="cb516-62"><a href="plotting-functions-ggplotsci.html#cb516-62"></a>  gg</span>
<span id="cb516-63"><a href="plotting-functions-ggplotsci.html#cb516-63"></a>  </span>
<span id="cb516-64"><a href="plotting-functions-ggplotsci.html#cb516-64"></a>  <span class="kw">return</span>(gg)</span>
<span id="cb516-65"><a href="plotting-functions-ggplotsci.html#cb516-65"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="plotting-functions-ggplotsci.html#cb517-1"></a>gg_multiple_effects &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb517-2"><a href="plotting-functions-ggplotsci.html#cb517-2"></a>  </span>
<span id="cb517-3"><a href="plotting-functions-ggplotsci.html#cb517-3"></a>}</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="part-v-expanding-the-linear-model-generalized-linear-models-and-multilevel-linear-mixed-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix-1-getting-started-with-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/82-ggplotsci.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
