<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Linear models with a single, continuous X (“regression”) | Elements of Statistical Modeling for Experimental Biology</title>
  <meta name="description" content="A first course in statistical modeling for experimental biology researchers" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Linear models with a single, continuous X (“regression”) | Elements of Statistical Modeling for Experimental Biology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A first course in statistical modeling for experimental biology researchers" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Linear models with a single, continuous X (“regression”) | Elements of Statistical Modeling for Experimental Biology" />
  
  <meta name="twitter:description" content="A first course in statistical modeling for experimental biology researchers" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="an-introduction-to-linear-models.html"/>
<link rel="next" href="oneway.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.6.1/DiagrammeR.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#math"><i class="fa fa-check"></i><b>0.1</b> Math</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#r-and-programming"><i class="fa fa-check"></i><b>0.2</b> R and programming</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-getting-started.html"><a href="part-i-getting-started.html"><i class="fa fa-check"></i>Part I: Getting Started</a></li>
<li class="chapter" data-level="1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html"><i class="fa fa-check"></i><b>1</b> Getting Started – R Projects and R Markdown</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-vs-r-studio"><i class="fa fa-check"></i><b>1.1</b> R vs R Studio</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#download-and-install-r-and-r-studio"><i class="fa fa-check"></i><b>1.2</b> Download and install R and R studio</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#open-r-studio-and-modify-the-workspace-preference"><i class="fa fa-check"></i><b>1.3</b> Open R Studio and modify the workspace preference</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it"><i class="fa fa-check"></i><b>1.4</b> If you didn’t modify the workspace preferences from the previous section, go back and do it</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#r-markdown-in-a-nutshell"><i class="fa fa-check"></i><b>1.5</b> R Markdown in a nutshell</a></li>
<li class="chapter" data-level="1.6" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#install-r-markdown"><i class="fa fa-check"></i><b>1.6</b> Install R Markdown</a></li>
<li class="chapter" data-level="1.7" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#importing-packages"><i class="fa fa-check"></i><b>1.7</b> Importing Packages</a></li>
<li class="chapter" data-level="1.8" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#setup-create-project"><i class="fa fa-check"></i><b>1.8</b> Create an R Studio Project for this textbook</a></li>
<li class="chapter" data-level="1.9" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#working-on-a-project-in-a-nutshell"><i class="fa fa-check"></i><b>1.9</b> Working on a project, in a nutshell</a></li>
<li class="chapter" data-level="1.10" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-an-r-markdown-file-for-this-chapter"><i class="fa fa-check"></i><b>1.10</b> Create an R Markdown file for this Chapter</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#modify-the-yaml-header"><i class="fa fa-check"></i><b>1.10.1</b> Modify the yaml header</a></li>
<li class="chapter" data-level="1.10.2" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#modify-the-setup-chunk"><i class="fa fa-check"></i><b>1.10.2</b> Modify the “setup” chunk</a></li>
<li class="chapter" data-level="1.10.3" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-fake-data-chunk"><i class="fa fa-check"></i><b>1.10.3</b> Create a “fake-data” chunk</a></li>
<li class="chapter" data-level="1.10.4" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#create-a-plot-chunk"><i class="fa fa-check"></i><b>1.10.4</b> Create a “plot” chunk</a></li>
<li class="chapter" data-level="1.10.5" data-path="getting-started-r-projects-and-r-markdown.html"><a href="getting-started-r-projects-and-r-markdown.html#knit"><i class="fa fa-check"></i><b>1.10.5</b> Knit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analyzing-experimental-data-with-a-linear-model.html"><a href="analyzing-experimental-data-with-a-linear-model.html"><i class="fa fa-check"></i><b>2</b> Analyzing experimental data with a linear model</a>
<ul>
<li class="chapter" data-level="2.1" data-path="analyzing-experimental-data-with-a-linear-model.html"><a href="analyzing-experimental-data-with-a-linear-model.html#this-text-is-about-the-estimation-of-treatment-effects-and-the-uncertainty-in-our-estimates-using-linear-models.-this-raises-the-question-what-is-an-effect"><i class="fa fa-check"></i><b>2.1</b> This text is about the estimation of treatment effects and the uncertainty in our estimates using linear models. This, raises the question, what is “an effect?”</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="background-physiology-to-the-experiments-in-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="background-physiology-to-the-experiments-in-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><i class="fa fa-check"></i>Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li class="chapter" data-level="" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><i class="fa fa-check"></i>Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a>
<ul>
<li class="chapter" data-level="2.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#setup"><i class="fa fa-check"></i><b>2.2</b> Setup</a></li>
<li class="chapter" data-level="2.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#data-source"><i class="fa fa-check"></i><b>2.3</b> Data source</a></li>
<li class="chapter" data-level="2.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#control-the-color-palette"><i class="fa fa-check"></i><b>2.4</b> control the color palette</a></li>
<li class="chapter" data-level="2.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#useful-functions"><i class="fa fa-check"></i><b>2.5</b> useful functions</a></li>
<li class="chapter" data-level="2.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2b-effect-of-ask1-deletion-on-growth-body-weight"><i class="fa fa-check"></i><b>2.6</b> figure 2b – effect of ASK1 deletion on growth (body weight)</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2b-import"><i class="fa fa-check"></i><b>2.6.1</b> figure 2b – import</a></li>
<li class="chapter" data-level="2.6.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2b-exploratory-plots"><i class="fa fa-check"></i><b>2.6.2</b> figure 2b – exploratory plots</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-effect-of-ask1-deletion-on-final-body-weight"><i class="fa fa-check"></i><b>2.7</b> Figure 2c – Effect of ASK1 deletion on final body weight</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-import"><i class="fa fa-check"></i><b>2.7.1</b> Figure 2c – import</a></li>
<li class="chapter" data-level="2.7.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-check-own-computation-of-weight-change-v-imported-value"><i class="fa fa-check"></i><b>2.7.2</b> Figure 2c – check own computation of weight change v imported value</a></li>
<li class="chapter" data-level="2.7.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-exploratory-plots"><i class="fa fa-check"></i><b>2.7.3</b> Figure 2c – exploratory plots</a></li>
<li class="chapter" data-level="2.7.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-fit-the-model-m1-lm"><i class="fa fa-check"></i><b>2.7.4</b> Figure 2c – fit the model: m1 (lm)</a></li>
<li class="chapter" data-level="2.7.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-check-the-model-m1"><i class="fa fa-check"></i><b>2.7.5</b> Figure 2c – check the model: m1</a></li>
<li class="chapter" data-level="2.7.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-fit-the-model-m2-gamma-glm"><i class="fa fa-check"></i><b>2.7.6</b> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li class="chapter" data-level="2.7.7" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-check-the-model-m2"><i class="fa fa-check"></i><b>2.7.7</b> Figure 2c – check the model, m2</a></li>
<li class="chapter" data-level="2.7.8" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-inference-from-the-model"><i class="fa fa-check"></i><b>2.7.8</b> Figure 2c – inference from the model</a></li>
<li class="chapter" data-level="2.7.9" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-plot-the-model"><i class="fa fa-check"></i><b>2.7.9</b> Figure 2c – plot the model</a></li>
<li class="chapter" data-level="2.7.10" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2c-report"><i class="fa fa-check"></i><b>2.7.10</b> Figure 2c – report</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><i class="fa fa-check"></i><b>2.8</b> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-import"><i class="fa fa-check"></i><b>2.8.1</b> Figure 2d – Import</a></li>
<li class="chapter" data-level="2.8.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-exploratory-plots"><i class="fa fa-check"></i><b>2.8.2</b> Figure 2d – exploratory plots</a></li>
<li class="chapter" data-level="2.8.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-fit-the-model"><i class="fa fa-check"></i><b>2.8.3</b> Figure 2d – fit the model</a></li>
<li class="chapter" data-level="2.8.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-check-the-model"><i class="fa fa-check"></i><b>2.8.4</b> Figure 2d – check the model</a></li>
<li class="chapter" data-level="2.8.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-inference"><i class="fa fa-check"></i><b>2.8.5</b> Figure 2d – inference</a></li>
<li class="chapter" data-level="2.8.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2d-plot-the-model"><i class="fa fa-check"></i><b>2.8.6</b> Figure 2d – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure"><i class="fa fa-check"></i><b>2.9</b> Figure 2e – Effect of ASK1 deletion on glucose tolerance (summary measure)</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-message-the-data"><i class="fa fa-check"></i><b>2.9.1</b> Figure 2e – message the data</a></li>
<li class="chapter" data-level="2.9.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-exploratory-plots"><i class="fa fa-check"></i><b>2.9.2</b> Figure 2e – exploratory plots</a></li>
<li class="chapter" data-level="2.9.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-fit-the-model"><i class="fa fa-check"></i><b>2.9.3</b> Figure 2e – fit the model</a></li>
<li class="chapter" data-level="2.9.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-check-the-model"><i class="fa fa-check"></i><b>2.9.4</b> Figure 2e – check the model</a></li>
<li class="chapter" data-level="2.9.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-inference-from-the-model"><i class="fa fa-check"></i><b>2.9.5</b> Figure 2e – inference from the model</a></li>
<li class="chapter" data-level="2.9.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2e-plot-the-model"><i class="fa fa-check"></i><b>2.9.6</b> Figure 2e – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate"><i class="fa fa-check"></i><b>2.10</b> Figure 2f – Effect of ASK1 deletion on glucose infusion rate</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-import"><i class="fa fa-check"></i><b>2.10.1</b> Figure 2f – import</a></li>
<li class="chapter" data-level="2.10.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-exploratory-plots"><i class="fa fa-check"></i><b>2.10.2</b> Figure 2f – exploratory plots</a></li>
<li class="chapter" data-level="2.10.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-fit-the-model"><i class="fa fa-check"></i><b>2.10.3</b> Figure 2f – fit the model</a></li>
<li class="chapter" data-level="2.10.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-check-the-model"><i class="fa fa-check"></i><b>2.10.4</b> Figure 2f – check the model</a></li>
<li class="chapter" data-level="2.10.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-inference"><i class="fa fa-check"></i><b>2.10.5</b> Figure 2f – inference</a></li>
<li class="chapter" data-level="2.10.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2f-plot-the-model"><i class="fa fa-check"></i><b>2.10.6</b> Figure 2f – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake"><i class="fa fa-check"></i><b>2.11</b> Figure 2g – Effect of ASK1 deletion on tissue-specific glucose uptake</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-import"><i class="fa fa-check"></i><b>2.11.1</b> Figure 2g – import</a></li>
<li class="chapter" data-level="2.11.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-exploratory-plots"><i class="fa fa-check"></i><b>2.11.2</b> Figure 2g – exploratory plots</a></li>
<li class="chapter" data-level="2.11.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-fit-the-model"><i class="fa fa-check"></i><b>2.11.3</b> Figure 2g – fit the model</a></li>
<li class="chapter" data-level="2.11.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-check-the-model"><i class="fa fa-check"></i><b>2.11.4</b> Figure 2g – check the model</a></li>
<li class="chapter" data-level="2.11.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-inference"><i class="fa fa-check"></i><b>2.11.5</b> Figure 2g – inference</a></li>
<li class="chapter" data-level="2.11.6" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2g-plot-the-model"><i class="fa fa-check"></i><b>2.11.6</b> Figure 2g – plot the model</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2h"><i class="fa fa-check"></i><b>2.12</b> Figure 2h</a></li>
<li class="chapter" data-level="2.13" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-effect-of-ask1-deletion-on-liver-tg"><i class="fa fa-check"></i><b>2.13</b> Figure 2i – Effect of ASK1 deletion on liver TG</a>
<ul>
<li class="chapter" data-level="2.13.1" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-fit-the-model"><i class="fa fa-check"></i><b>2.13.1</b> Figure 2i – fit the model</a></li>
<li class="chapter" data-level="2.13.2" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-check-the-model"><i class="fa fa-check"></i><b>2.13.2</b> Figure 2i – check the model</a></li>
<li class="chapter" data-level="2.13.3" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-inference"><i class="fa fa-check"></i><b>2.13.3</b> Figure 2i – inference</a></li>
<li class="chapter" data-level="2.13.4" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-plot-the-model"><i class="fa fa-check"></i><b>2.13.4</b> Figure 2i – plot the model</a></li>
<li class="chapter" data-level="2.13.5" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2i-report-the-model"><i class="fa fa-check"></i><b>2.13.5</b> Figure 2i – report the model</a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html"><a href="analyses-for-figure-2-of-ask1-inhibits-browning-of-white-adipose-tissue-in-obesity.html#figure-2j"><i class="fa fa-check"></i><b>2.14</b> Figure 2j</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-r-fundamentals.html"><a href="part-iii-r-fundamentals.html"><i class="fa fa-check"></i>Part III: R fundamentals</a></li>
<li class="chapter" data-level="3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html"><i class="fa fa-check"></i><b>3</b> Data – Reading, Wrangling, and Writing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#learning-from-this-chapter"><i class="fa fa-check"></i><b>3.1</b> Learning from this chapter</a></li>
<li class="chapter" data-level="3.2" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#data-working-in-r"><i class="fa fa-check"></i><b>3.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#importing-data"><i class="fa fa-check"></i><b>3.2.1</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#data-wrangling"><i class="fa fa-check"></i><b>3.3</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#reshaping-data-wide-to-long"><i class="fa fa-check"></i><b>3.3.1</b> Reshaping data – Wide to long</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#reshaping-data-transpose-turning-the-columns-into-rows"><i class="fa fa-check"></i><b>3.3.2</b> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#combining-data"><i class="fa fa-check"></i><b>3.3.3</b> Combining data</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#subsetting-data"><i class="fa fa-check"></i><b>3.3.4</b> Subsetting data</a></li>
<li class="chapter" data-level="3.3.5" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#wrangling-columns"><i class="fa fa-check"></i><b>3.3.5</b> Wrangling columns</a></li>
<li class="chapter" data-level="3.3.6" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#missing-data"><i class="fa fa-check"></i><b>3.3.6</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#saving-data"><i class="fa fa-check"></i><b>3.4</b> Saving data</a></li>
<li class="chapter" data-level="3.5" data-path="data-reading-wrangling-and-writing.html"><a href="data-reading-wrangling-and-writing.html#exercises"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting-models.html"><a href="plotting-models.html"><i class="fa fa-check"></i><b>4</b> Plotting Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data"><i class="fa fa-check"></i><b>4.1</b> Pretty good plots show the model and the data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot"><i class="fa fa-check"></i><b>4.1.1</b> Pretty good plot component 1: Modeled effects plot</a></li>
<li class="chapter" data-level="4.1.2" data-path="plotting-models.html"><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot"><i class="fa fa-check"></i><b>4.1.2</b> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li class="chapter" data-level="4.1.3" data-path="plotting-models.html"><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><i class="fa fa-check"></i><b>4.1.3</b> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
<li class="chapter" data-level="4.1.4" data-path="plotting-models.html"><a href="plotting-models.html#some-comments-on-plot-components"><i class="fa fa-check"></i><b>4.1.4</b> Some comments on plot components</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="plotting-models.html"><a href="plotting-models.html#working-in-r"><i class="fa fa-check"></i><b>4.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="plotting-models.html"><a href="plotting-models.html#source-data"><i class="fa fa-check"></i><b>4.2.1</b> Source data</a></li>
<li class="chapter" data-level="4.2.2" data-path="plotting-models.html"><a href="plotting-models.html#how-to-plot-the-model"><i class="fa fa-check"></i><b>4.2.2</b> How to plot the model</a></li>
<li class="chapter" data-level="4.2.3" data-path="plotting-models.html"><a href="plotting-models.html#be-sure-ggplot_the_model-is-in-your-r-folder"><i class="fa fa-check"></i><b>4.2.3</b> Be sure ggplot_the_model is in your R folder</a></li>
<li class="chapter" data-level="4.2.4" data-path="plotting-models.html"><a href="plotting-models.html#how-to-use-the-plot-the-model-functions"><i class="fa fa-check"></i><b>4.2.4</b> How to use the Plot the Model functions</a></li>
<li class="chapter" data-level="4.2.5" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-a-response-plot-using-ggpubr"><i class="fa fa-check"></i><b>4.2.5</b> How to generate a Response Plot using ggpubr</a></li>
<li class="chapter" data-level="4.2.6" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2"><i class="fa fa-check"></i><b>4.2.6</b> How to generate a Response Plot with a grid of treatments using ggplot2</a></li>
<li class="chapter" data-level="4.2.7" data-path="plotting-models.html"><a href="plotting-models.html#how-to-generate-an-effects-plot"><i class="fa fa-check"></i><b>4.2.7</b> How to generate an Effects Plot</a></li>
<li class="chapter" data-level="4.2.8" data-path="plotting-models.html"><a href="plotting-models.html#how-to-combine-the-response-and-effects-plots"><i class="fa fa-check"></i><b>4.2.8</b> How to combine the response and effects plots</a></li>
<li class="chapter" data-level="4.2.9" data-path="plotting-models.html"><a href="plotting-models.html#how-to-add-the-interaction-effect-to-response-and-effects-plots"><i class="fa fa-check"></i><b>4.2.9</b> How to add the interaction effect to response and effects plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iv-some-fundamentals-of-statistical-modeling.html"><a href="part-iv-some-fundamentals-of-statistical-modeling.html"><i class="fa fa-check"></i>Part IV: Some Fundamentals of Statistical Modeling</a></li>
<li class="chapter" data-level="5" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>5</b> Variability and Uncertainty (Standard Deviations, Standard Errors, Confidence Intervals)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="uncertainty.html"><a href="uncertainty.html#the-sample-standard-deviation-vs.-the-standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.1</b> The sample standard deviation vs. the standard error of the mean</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="uncertainty.html"><a href="uncertainty.html#sample-standard-deviation"><i class="fa fa-check"></i><b>5.1.1</b> Sample standard deviation</a></li>
<li class="chapter" data-level="5.1.2" data-path="uncertainty.html"><a href="uncertainty.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="uncertainty.html"><a href="uncertainty.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.2</b> Using Google Sheets to generate fake data to explore the standard error</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="uncertainty.html"><a href="uncertainty.html#steps"><i class="fa fa-check"></i><b>5.2.1</b> Steps</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="uncertainty.html"><a href="uncertainty.html#using-r-to-generate-fake-data-to-explore-the-standard-error"><i class="fa fa-check"></i><b>5.3</b> Using R to generate fake data to explore the standard error</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="uncertainty.html"><a href="uncertainty.html#part-i"><i class="fa fa-check"></i><b>5.3.1</b> part I</a></li>
<li class="chapter" data-level="5.3.2" data-path="uncertainty.html"><a href="uncertainty.html#part-ii---means"><i class="fa fa-check"></i><b>5.3.2</b> part II - means</a></li>
<li class="chapter" data-level="5.3.3" data-path="uncertainty.html"><a href="uncertainty.html#part-iii---how-do-sd-and-se-change-as-sample-size-n-increases"><i class="fa fa-check"></i><b>5.3.3</b> part III - how do SD and SE change as sample size (n) increases?</a></li>
<li class="chapter" data-level="5.3.4" data-path="uncertainty.html"><a href="uncertainty.html#part-iv-generating-fake-data-with-for-loops"><i class="fa fa-check"></i><b>5.3.4</b> Part IV – Generating fake data with for-loops</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="uncertainty.html"><a href="uncertainty.html#bootstrap"><i class="fa fa-check"></i><b>5.4</b> Bootstrapped standard errors</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="uncertainty.html"><a href="uncertainty.html#an-example-of-bootstrapped-standard-errors-using-vole-data"><i class="fa fa-check"></i><b>5.4.1</b> An example of bootstrapped standard errors using vole data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="uncertainty.html"><a href="uncertainty.html#confidence-interval"><i class="fa fa-check"></i><b>5.5</b> Confidence Interval</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="uncertainty.html"><a href="uncertainty.html#interpretation-of-a-confidence-interval"><i class="fa fa-check"></i><b>5.5.1</b> Interpretation of a confidence interval</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="p-values.html"><a href="p-values.html"><i class="fa fa-check"></i><b>6</b> P-values</a>
<ul>
<li class="chapter" data-level="6.1" data-path="p-values.html"><a href="p-values.html#a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution"><i class="fa fa-check"></i><b>6.1</b> A <em>p</em>-value is the probability of sampling a value as or more extreme than the test statistic if sampling from a null distribution</a></li>
<li class="chapter" data-level="6.2" data-path="p-values.html"><a href="p-values.html#pump-your-intuition-creating-a-null-distribution"><i class="fa fa-check"></i><b>6.2</b> Pump your intuition – Creating a null distribution</a></li>
<li class="chapter" data-level="6.3" data-path="p-values.html"><a href="p-values.html#a-null-distribution-of-t-values-the-t-distribution"><i class="fa fa-check"></i><b>6.3</b> A null distribution of <em>t</em>-values – the <em>t</em> distribution</a></li>
<li class="chapter" data-level="6.4" data-path="p-values.html"><a href="p-values.html#p-values-from-the-perspective-of-permutation"><i class="fa fa-check"></i><b>6.4</b> P-values from the perspective of permutation</a></li>
<li class="chapter" data-level="6.5" data-path="p-values.html"><a href="p-values.html#parametric-vs.-non-parametric-statistics"><i class="fa fa-check"></i><b>6.5</b> Parametric vs. non-parametric statistics</a></li>
<li class="chapter" data-level="6.6" data-path="p-values.html"><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values"><i class="fa fa-check"></i><b>6.6</b> frequentist probability and the interpretation of p-values</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="p-values.html"><a href="p-values.html#background"><i class="fa fa-check"></i><b>6.6.1</b> Background</a></li>
<li class="chapter" data-level="6.6.2" data-path="p-values.html"><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><i class="fa fa-check"></i><b>6.6.2</b> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li class="chapter" data-level="6.6.3" data-path="p-values.html"><a href="p-values.html#two-interpretations-of-the-p-value"><i class="fa fa-check"></i><b>6.6.3</b> Two interpretations of the <em>p</em>-value</a></li>
<li class="chapter" data-level="6.6.4" data-path="p-values.html"><a href="p-values.html#nhst"><i class="fa fa-check"></i><b>6.6.4</b> NHST</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="p-values.html"><a href="p-values.html#some-major-misconceptions-of-the-p-value"><i class="fa fa-check"></i><b>6.7</b> Some major misconceptions of the <em>p</em>-value</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="p-values.html"><a href="p-values.html#misconception-p-is-the-probability-that-the-null-is-true-and-1-p-is-probability-that-the-alternative-is-true"><i class="fa fa-check"></i><b>6.7.1</b> Misconception: <em>p</em> is the probability that the null is true <em>and</em> <span class="math inline">\(1-p\)</span> is probability that the alternative is true</a></li>
<li class="chapter" data-level="6.7.2" data-path="p-values.html"><a href="p-values.html#misconception-a-p-value-is-repeatable"><i class="fa fa-check"></i><b>6.7.2</b> Misconception: a <em>p</em>-value is repeatable</a></li>
<li class="chapter" data-level="6.7.3" data-path="p-values.html"><a href="p-values.html#misconception-0.05-is-the-lifetime-rate-of-false-discoveries"><i class="fa fa-check"></i><b>6.7.3</b> Misconception: 0.05 is the lifetime rate of false discoveries</a></li>
<li class="chapter" data-level="6.7.4" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-an-important-effect"><i class="fa fa-check"></i><b>6.7.4</b> Misconception: a low <em>p</em>-value indicates an important effect</a></li>
<li class="chapter" data-level="6.7.5" data-path="p-values.html"><a href="p-values.html#misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity"><i class="fa fa-check"></i><b>6.7.5</b> Misconception: a low <em>p</em>-value indicates high model fit or high predictive capacity</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="p-values.html"><a href="p-values.html#what-the-p-value-does-not-mean"><i class="fa fa-check"></i><b>6.8</b> What the <em>p</em>-value does not mean</a></li>
<li class="chapter" data-level="6.9" data-path="p-values.html"><a href="p-values.html#recommendations"><i class="fa fa-check"></i><b>6.9</b> Recommendations</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="p-values.html"><a href="p-values.html#primary-sources-for-recommendations"><i class="fa fa-check"></i><b>6.9.1</b> Primary sources for recommendations</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="p-values.html"><a href="p-values.html#problems"><i class="fa fa-check"></i><b>6.10</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="errors-in-inference.html"><a href="errors-in-inference.html"><i class="fa fa-check"></i><b>7</b> Errors in inference</a>
<ul>
<li class="chapter" data-level="7.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#classical-nhst-concepts-of-wrong"><i class="fa fa-check"></i><b>7.1</b> Classical NHST concepts of wrong</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-i-error"><i class="fa fa-check"></i><b>7.1.1</b> Type I error</a></li>
<li class="chapter" data-level="7.1.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#power"><i class="fa fa-check"></i><b>7.1.2</b> Power</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#a-non-neyman-pearson-concept-of-power"><i class="fa fa-check"></i><b>7.2</b> A non-Neyman-Pearson concept of power</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="errors-in-inference.html"><a href="errors-in-inference.html#estimation-error"><i class="fa fa-check"></i><b>7.2.1</b> Estimation error</a></li>
<li class="chapter" data-level="7.2.2" data-path="errors-in-inference.html"><a href="errors-in-inference.html#coverage"><i class="fa fa-check"></i><b>7.2.2</b> Coverage</a></li>
<li class="chapter" data-level="7.2.3" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-s-error"><i class="fa fa-check"></i><b>7.2.3</b> Type S error</a></li>
<li class="chapter" data-level="7.2.4" data-path="errors-in-inference.html"><a href="errors-in-inference.html#type-m-error"><i class="fa fa-check"></i><b>7.2.4</b> Type M error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-introduction-to-linear-models.html"><a href="part-v-introduction-to-linear-models.html"><i class="fa fa-check"></i>Part V: Introduction to Linear Models</a></li>
<li class="chapter" data-level="8" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html"><i class="fa fa-check"></i><b>8</b> An introduction to linear models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#two-specifications-of-a-linear-model"><i class="fa fa-check"></i><b>8.1</b> Two specifications of a linear model</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#the-error-draw-specification"><i class="fa fa-check"></i><b>8.1.1</b> The “error draw” specification</a></li>
<li class="chapter" data-level="8.1.2" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#the-conditional-draw-specification"><i class="fa fa-check"></i><b>8.1.2</b> The “conditional draw” specification</a></li>
<li class="chapter" data-level="8.1.3" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model"><i class="fa fa-check"></i><b>8.1.3</b> Comparing the error-draw and conditional-draw ways of specifying the linear model</a></li>
<li class="chapter" data-level="8.1.4" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#anova-notation-of-a-linear-model"><i class="fa fa-check"></i><b>8.1.4</b> ANOVA notation of a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"><i class="fa fa-check"></i><b>8.2</b> A linear model can be fit to data with continuous, discrete, or categorical <span class="math inline">\(X\)</span> variables</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete"><i class="fa fa-check"></i><b>8.2.1</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is continuous or discrete</a></li>
<li class="chapter" data-level="8.2.2" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#slope"><i class="fa fa-check"></i><b>8.2.2</b> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is categorical</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#statistical-models-are-used-for-prediction-explanation-and-description"><i class="fa fa-check"></i><b>8.3</b> Statistical models are used for prediction, explanation, and description</a></li>
<li class="chapter" data-level="8.4" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#what-do-we-call-the-x-and-y-variables"><i class="fa fa-check"></i><b>8.4</b> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li class="chapter" data-level="8.5" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#modeling-strategy"><i class="fa fa-check"></i><b>8.5</b> Modeling strategy</a></li>
<li class="chapter" data-level="8.6" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#predictions-from-the-model"><i class="fa fa-check"></i><b>8.6</b> Predictions from the model</a></li>
<li class="chapter" data-level="8.7" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#inference-from-the-model"><i class="fa fa-check"></i><b>8.7</b> Inference from the model</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#assumptions-for-inference-with-a-statistical-model"><i class="fa fa-check"></i><b>8.7.1</b> Assumptions for inference with a statistical model</a></li>
<li class="chapter" data-level="8.7.2" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#specific-assumptions-for-inference-with-a-linear-model"><i class="fa fa-check"></i><b>8.7.2</b> Specific assumptions for inference with a linear model</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="an-introduction-to-linear-models.html"><a href="an-introduction-to-linear-models.html#linear-modelregression-model-orstatistical-model"><i class="fa fa-check"></i><b>8.8</b> “linear model,”regression model“, or”statistical model"?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> Linear models with a single, continuous <em>X</em> (“regression”)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#a-linear-model-with-a-single-continuous-x-is-classical-regression"><i class="fa fa-check"></i><b>9.1</b> A linear model with a single, continuous <em>X</em> is classical “regression”</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="regression.html"><a href="regression.html#analysis-of-green-down-data"><i class="fa fa-check"></i><b>9.1.1</b> Analysis of “green-down” data</a></li>
<li class="chapter" data-level="9.1.2" data-path="regression.html"><a href="regression.html#learning-from-the-green-down-example"><i class="fa fa-check"></i><b>9.1.2</b> Learning from the green-down example</a></li>
<li class="chapter" data-level="9.1.3" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-explanation-causal-models"><i class="fa fa-check"></i><b>9.1.3</b> Using a regression model for “explanation” – causal models</a></li>
<li class="chapter" data-level="9.1.4" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-prediction-prediction-models"><i class="fa fa-check"></i><b>9.1.4</b> Using a regression model for prediction – prediction models</a></li>
<li class="chapter" data-level="9.1.5" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data"><i class="fa fa-check"></i><b>9.1.5</b> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</a></li>
<li class="chapter" data-level="9.1.6" data-path="regression.html"><a href="regression.html#using-a-regression-model-for-for-calibration"><i class="fa fa-check"></i><b>9.1.6</b> Using a regression model for for calibration</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#working-in-r-1"><i class="fa fa-check"></i><b>9.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="plotting-models.html"><a href="plotting-models.html#fit-the-model"><i class="fa fa-check"></i><b>9.2.1</b> Fitting the linear model</a></li>
<li class="chapter" data-level="9.2.2" data-path="regression.html"><a href="regression.html#getting-to-know-the-linear-model-the-summary-function"><i class="fa fa-check"></i><b>9.2.2</b> Getting to know the linear model: the <code>summary</code> function</a></li>
<li class="chapter" data-level="9.2.3" data-path="regression.html"><a href="regression.html#inference-the-coefficient-table"><i class="fa fa-check"></i><b>9.2.3</b> Inference – the coefficient table</a></li>
<li class="chapter" data-level="9.2.4" data-path="regression.html"><a href="regression.html#how-good-is-our-model-model-checking"><i class="fa fa-check"></i><b>9.2.4</b> How good is our model? – Model checking</a></li>
<li class="chapter" data-level="9.2.5" data-path="regression.html"><a href="regression.html#plotting-models-with-continuous-x"><i class="fa fa-check"></i><b>9.2.5</b> Plotting models with continuous <em>X</em></a></li>
<li class="chapter" data-level="9.2.6" data-path="regression.html"><a href="regression.html#creating-a-table-of-predicted-values-and-95-prediction-intervals"><i class="fa fa-check"></i><b>9.2.6</b> Creating a table of predicted values and 95% prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="regression.html"><a href="regression.html#hidden-code"><i class="fa fa-check"></i><b>9.3</b> Hidden code</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="regression.html"><a href="regression.html#import-and-plot-of-fig2c-ecosystem-warming-experimental-data"><i class="fa fa-check"></i><b>9.3.1</b> Import and plot of fig2c (ecosystem warming experimental) data</a></li>
<li class="chapter" data-level="9.3.2" data-path="regression.html"><a href="regression.html#import-and-plot-efig_3d-ecosysem-warming-observational-data"><i class="fa fa-check"></i><b>9.3.2</b> Import and plot efig_3d (Ecosysem warming observational) data</a></li>
<li class="chapter" data-level="9.3.3" data-path="regression.html"><a href="regression.html#import-and-plot-of-fig1f-methionine-restriction-data"><i class="fa fa-check"></i><b>9.3.3</b> Import and plot of fig1f (methionine restriction) data</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="regression.html"><a href="regression.html#try-it"><i class="fa fa-check"></i><b>9.4</b> Try it</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="regression.html"><a href="regression.html#a-prediction-model-from-the-literature"><i class="fa fa-check"></i><b>9.4.1</b> A prediction model from the literature</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="regression.html"><a href="regression.html#intuition-pumps"><i class="fa fa-check"></i><b>9.5</b> Intuition pumps</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="regression.html"><a href="regression.html#correlation-and-r2"><i class="fa fa-check"></i><b>9.5.1</b> Correlation and $R^2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="oneway.html"><a href="oneway.html"><i class="fa fa-check"></i><b>10</b> Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="oneway.html"><a href="oneway.html#oneway-data"><i class="fa fa-check"></i><b>10.1</b> A linear model with a single, categorical <em>X</em> variable estimates the effects of the levels of <em>X</em> on the response</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="oneway.html"><a href="oneway.html#example-1-fig3d-two-treatment-levels-groups"><i class="fa fa-check"></i><b>10.1.1</b> Example 1 (fig3d) – two treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.2" data-path="oneway.html"><a href="oneway.html#understanding-the-analysis-with-two-treatment-levels"><i class="fa fa-check"></i><b>10.1.2</b> Understanding the analysis with two treatment levels</a></li>
<li class="chapter" data-level="10.1.3" data-path="oneway.html"><a href="oneway.html#example-2-three-treatment-levels-groups"><i class="fa fa-check"></i><b>10.1.3</b> Example 2 – three treatment levels (“groups”)</a></li>
<li class="chapter" data-level="10.1.4" data-path="oneway.html"><a href="oneway.html#understanding-the-analysis-with-three-or-more-treatment-levels"><i class="fa fa-check"></i><b>10.1.4</b> Understanding the analysis with three (or more) treatment levels</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="oneway.html"><a href="oneway.html#working-in-r-2"><i class="fa fa-check"></i><b>10.2</b> Working in R</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="oneway.html"><a href="oneway.html#fit-the-model-1"><i class="fa fa-check"></i><b>10.2.1</b> Fit the model</a></li>
<li class="chapter" data-level="10.2.2" data-path="oneway.html"><a href="oneway.html#controlling-the-output-in-tables-using-the-coefficient-table-as-an-example"><i class="fa fa-check"></i><b>10.2.2</b> Controlling the output in tables using the coefficient table as an example</a></li>
<li class="chapter" data-level="10.2.3" data-path="oneway.html"><a href="oneway.html#using-the-emmeans-function"><i class="fa fa-check"></i><b>10.2.3</b> Using the emmeans function</a></li>
<li class="chapter" data-level="10.2.4" data-path="oneway.html"><a href="oneway.html#using-the-contrast-function"><i class="fa fa-check"></i><b>10.2.4</b> Using the contrast function</a></li>
<li class="chapter" data-level="10.2.5" data-path="oneway.html"><a href="oneway.html#how-to-generate-anova-tables"><i class="fa fa-check"></i><b>10.2.5</b> How to generate ANOVA tables</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="oneway.html"><a href="oneway.html#hidden-code-1"><i class="fa fa-check"></i><b>10.3</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="oneway.html"><a href="oneway.html#importing-and-wrangling-the-fig_3d-data-for-example-1"><i class="fa fa-check"></i><b>10.3.1</b> Importing and wrangling the fig_3d data for example 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="oneway.html"><a href="oneway.html#importing-and-wrangling-the-fig2a-data-for-example-2"><i class="fa fa-check"></i><b>10.3.2</b> Importing and wrangling the fig2a data for example 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>11</b> Model Checking</a>
<ul>
<li class="chapter" data-level="11.1" data-path="model-checking.html"><a href="model-checking.html#all-statistical-analyses-should-be-followed-by-model-checking"><i class="fa fa-check"></i><b>11.1</b> All statistical analyses should be followed by model checking</a></li>
<li class="chapter" data-level="11.2" data-path="model-checking.html"><a href="model-checking.html#linear-model-assumptions"><i class="fa fa-check"></i><b>11.2</b> Linear model assumptions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="model-checking.html"><a href="model-checking.html#a-bit-about-iid"><i class="fa fa-check"></i><b>11.2.1</b> A bit about IID</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="model-checking.html"><a href="model-checking.html#diagnostic-plots-use-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>11.3</b> Diagnostic plots use the residuals from the model fit</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="model-checking.html"><a href="model-checking.html#residuals"><i class="fa fa-check"></i><b>11.3.1</b> Residuals</a></li>
<li class="chapter" data-level="11.3.2" data-path="model-checking.html"><a href="model-checking.html#normal-qq"><i class="fa fa-check"></i><b>11.3.2</b> A Normal Q-Q plot is used to check for characteristic departures from Normality</a></li>
<li class="chapter" data-level="11.3.3" data-path="model-checking.html"><a href="model-checking.html#mapping-qq-plot-departures-from-normality"><i class="fa fa-check"></i><b>11.3.3</b> Mapping QQ-plot departures from Normality</a></li>
<li class="chapter" data-level="11.3.4" data-path="model-checking.html"><a href="model-checking.html#model-checking-homoskedasticity"><i class="fa fa-check"></i><b>11.3.4</b> Model checking homoskedasticity</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="model-checking.html"><a href="model-checking.html#using-r"><i class="fa fa-check"></i><b>11.4</b> Using R</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="model-checking.html"><a href="model-checking.html#normal-q-q-plots"><i class="fa fa-check"></i><b>11.4.1</b> Normal Q-Q plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="violations.html"><a href="violations.html"><i class="fa fa-check"></i><b>12</b> Violations of independence, homogeneity, or Normality</a>
<ul>
<li class="chapter" data-level="12.1" data-path="violations.html"><a href="violations.html#oneway-paired-t"><i class="fa fa-check"></i><b>12.1</b> Lack of independence</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="violations.html"><a href="violations.html#a-paired-t-test-is-a-special-case-of-a-linear-model-for-correlated-data-with-two-groups"><i class="fa fa-check"></i><b>12.1.1</b> A paired t-test is a special case of a linear model for correlated data with two groups</a></li>
<li class="chapter" data-level="12.1.2" data-path="violations.html"><a href="violations.html#inferences-from-the-linear-mixed-model-and-paired-t-tests-are-not-the-same-when-there-are-more-than-two-groups"><i class="fa fa-check"></i><b>12.1.2</b> Inferences from the linear mixed model and paired t-tests are not the same when there are more than two groups</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="violations.html"><a href="violations.html#oneway-welch"><i class="fa fa-check"></i><b>12.2</b> Heterogeneity of variances</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="violations.html"><a href="violations.html#when-groups-of-the-focal-test-have-variance"><i class="fa fa-check"></i><b>12.2.1</b> When groups of the focal test have &gt;&gt; variance</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="violations.html"><a href="violations.html#the-conditional-response-isnt-normal"><i class="fa fa-check"></i><b>12.3</b> The conditional response isn’t Normal</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="violations.html"><a href="violations.html#violations-6f"><i class="fa fa-check"></i><b>12.3.1</b> Example 1 (fig6f) – Linear models for non-normal count data</a></li>
<li class="chapter" data-level="12.3.2" data-path="violations.html"><a href="violations.html#my-data-arent-normal-what-is-the-best-practice"><i class="fa fa-check"></i><b>12.3.2</b> My data aren’t normal, what is the best practice?</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="violations.html"><a href="violations.html#hidden-code-2"><i class="fa fa-check"></i><b>12.4</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-fig1b-data"><i class="fa fa-check"></i><b>12.4.1</b> Importing and wrangling the fig1b data</a></li>
<li class="chapter" data-level="12.4.2" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-fig2a-data"><i class="fa fa-check"></i><b>12.4.2</b> Importing and wrangling the fig2a data</a></li>
<li class="chapter" data-level="12.4.3" data-path="violations.html"><a href="violations.html#importing-and-wrangling-the-fig6f-data"><i class="fa fa-check"></i><b>12.4.3</b> Importing and wrangling the fig6f data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="issues.html"><a href="issues.html"><i class="fa fa-check"></i><b>13</b> Issues in inference</a>
<ul>
<li class="chapter" data-level="13.1" data-path="issues.html"><a href="issues.html#replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means"><i class="fa fa-check"></i><b>13.1</b> Replicated experiments – include <span class="math inline">\(\texttt{Experiment}\)</span> as a random factor (better than one-way ANOVA of means)</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="issues.html"><a href="issues.html#issues-exp4d"><i class="fa fa-check"></i><b>13.1.1</b> Multiple experiments Example 1 (wound healing Exp4d)</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="issues.html"><a href="issues.html#issues-pre-post"><i class="fa fa-check"></i><b>13.2</b> Comparing change from baseline (pre-post)</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="issues.html"><a href="issues.html#pre-post-example-1-dpp4-fig4c"><i class="fa fa-check"></i><b>13.2.1</b> Pre-post example 1 (DPP4 fig4c)</a></li>
<li class="chapter" data-level="13.2.2" data-path="issues.html"><a href="issues.html#what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure"><i class="fa fa-check"></i><b>13.2.2</b> What if the data in example 1 were from from an experiment where the treatment was applied prior to the baseline measure?</a></li>
<li class="chapter" data-level="13.2.3" data-path="issues.html"><a href="issues.html#pre-post-example-2-xx-males-fig1c"><i class="fa fa-check"></i><b>13.2.3</b> Pre-post example 2 (XX males fig1c)</a></li>
<li class="chapter" data-level="13.2.4" data-path="issues.html"><a href="issues.html#issues-regression-to-mean"><i class="fa fa-check"></i><b>13.2.4</b> Regression to the mean</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="issues.html"><a href="issues.html#longitudinal-designs-with-more-than-one-post-baseline-measure"><i class="fa fa-check"></i><b>13.3</b> Longitudinal designs with more than one-post baseline measure</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="issues.html"><a href="issues.html#issues-auc"><i class="fa fa-check"></i><b>13.3.1</b> Area under the curve (AUC)</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="issues.html"><a href="issues.html#comparing-ratios"><i class="fa fa-check"></i><b>13.4</b> Comparing ratios</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="issues.html"><a href="issues.html#the-ratio-is-a-density"><i class="fa fa-check"></i><b>13.4.1</b> The ratio is a density</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="issues.html"><a href="issues.html#dont-do-this-stuff"><i class="fa fa-check"></i><b>13.5</b> Don’t do this stuff</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="issues.html"><a href="issues.html#normalize-the-response-so-that-all-control-values-are-equal-to-1."><i class="fa fa-check"></i><b>13.5.1</b> Normalize the response so that all control values are equal to 1.</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="issues.html"><a href="issues.html#researcher-degrees-of-freedom"><i class="fa fa-check"></i><b>13.6</b> Researcher degrees of freedom</a></li>
<li class="chapter" data-level="13.7" data-path="issues.html"><a href="issues.html#hidden-code-3"><i class="fa fa-check"></i><b>13.7</b> Hidden code</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="issues.html"><a href="issues.html#import-exp4d-vimentin-cell-count-data-replicate-experiments-example"><i class="fa fa-check"></i><b>13.7.1</b> Import exp4d vimentin cell count data (replicate experiments example)</a></li>
<li class="chapter" data-level="13.7.2" data-path="issues.html"><a href="issues.html#import-fig4c-data"><i class="fa fa-check"></i><b>13.7.2</b> Import Fig4c data</a></li>
<li class="chapter" data-level="13.7.3" data-path="issues.html"><a href="issues.html#xx-males-fig1c"><i class="fa fa-check"></i><b>13.7.3</b> XX males fig1c</a></li>
<li class="chapter" data-level="13.7.4" data-path="issues.html"><a href="issues.html#generation-of-fake-data-to-illustrate-regression-to-the-mean"><i class="fa fa-check"></i><b>13.7.4</b> Generation of fake data to illustrate regression to the mean</a></li>
<li class="chapter" data-level="13.7.5" data-path="issues.html"><a href="issues.html#import-fig3f"><i class="fa fa-check"></i><b>13.7.5</b> Import fig3f</a></li>
</ul></li>
</ul></li>
<li><a href="part-vi-more-than-one-x-multivariable-models.html#part-vi-more-than-one-x-multivariable-models">Part VI: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li class="chapter" data-level="14" data-path="covariates.html"><a href="covariates.html"><i class="fa fa-check"></i><b>14</b> Linear models with added covariates (“ANCOVA”)</a>
<ul>
<li class="chapter" data-level="14.1" data-path="covariates.html"><a href="covariates.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><i class="fa fa-check"></i><b>14.1</b> Adding covariates can increases the precision of the effect of interest</a></li>
<li class="chapter" data-level="14.2" data-path="covariates.html"><a href="covariates.html#understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data"><i class="fa fa-check"></i><b>14.2</b> Understanding a linear model with an added covariate – heart necrosis data</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="covariates.html"><a href="covariates.html#fit-the-model-5"><i class="fa fa-check"></i><b>14.2.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.2.2" data-path="covariates.html"><a href="covariates.html#plot-the-model-1"><i class="fa fa-check"></i><b>14.2.2</b> Plot the model</a></li>
<li class="chapter" data-level="14.2.3" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-model-coefficients"><i class="fa fa-check"></i><b>14.2.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.2.4" data-path="covariates.html"><a href="covariates.html#everything-adds-up"><i class="fa fa-check"></i><b>14.2.4</b> Everything adds up</a></li>
<li class="chapter" data-level="14.2.5" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-estimated-marginal-means"><i class="fa fa-check"></i><b>14.2.5</b> Interpretation of the estimated marginal means</a></li>
<li class="chapter" data-level="14.2.6" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-contrasts"><i class="fa fa-check"></i><b>14.2.6</b> Interpretation of the contrasts</a></li>
<li class="chapter" data-level="14.2.7" data-path="covariates.html"><a href="covariates.html#adding-the-covariate-improves-inference"><i class="fa fa-check"></i><b>14.2.7</b> Adding the covariate improves inference</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="covariates.html"><a href="covariates.html#understanding-interaction-effects-with-covariates"><i class="fa fa-check"></i><b>14.3</b> Understanding interaction effects with covariates</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="covariates.html"><a href="covariates.html#fit-the-model-6"><i class="fa fa-check"></i><b>14.3.1</b> Fit the model</a></li>
<li class="chapter" data-level="14.3.2" data-path="covariates.html"><a href="covariates.html#plot-the-model-with-interaction-effect"><i class="fa fa-check"></i><b>14.3.2</b> Plot the model with interaction effect</a></li>
<li class="chapter" data-level="14.3.3" data-path="covariates.html"><a href="covariates.html#interpretation-of-the-model-coefficients-1"><i class="fa fa-check"></i><b>14.3.3</b> Interpretation of the model coefficients</a></li>
<li class="chapter" data-level="14.3.4" data-path="covariates.html"><a href="covariates.html#what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends."><i class="fa fa-check"></i><b>14.3.4</b> What is the effect of a treatment, if interactions are modeled? – it depends.</a></li>
<li class="chapter" data-level="14.3.5" data-path="covariates.html"><a href="covariates.html#which-model-do-we-use-mathcalm_1-or-mathcalm_2"><i class="fa fa-check"></i><b>14.3.5</b> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="covariates.html"><a href="covariates.html#understanding-ancova-tables"><i class="fa fa-check"></i><b>14.4</b> Understanding ANCOVA tables</a></li>
<li class="chapter" data-level="14.5" data-path="covariates.html"><a href="covariates.html#working-in-r-3"><i class="fa fa-check"></i><b>14.5</b> Working in R</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="covariates.html"><a href="covariates.html#importing-the-heart-necrosis-data"><i class="fa fa-check"></i><b>14.5.1</b> Importing the heart necrosis data</a></li>
<li class="chapter" data-level="14.5.2" data-path="covariates.html"><a href="covariates.html#fitting-the-model"><i class="fa fa-check"></i><b>14.5.2</b> Fitting the model</a></li>
<li class="chapter" data-level="14.5.3" data-path="covariates.html"><a href="covariates.html#using-the-emmeans-function-1"><i class="fa fa-check"></i><b>14.5.3</b> Using the emmeans function</a></li>
<li class="chapter" data-level="14.5.4" data-path="covariates.html"><a href="covariates.html#ancova-tables"><i class="fa fa-check"></i><b>14.5.4</b> ANCOVA tables</a></li>
<li class="chapter" data-level="14.5.5" data-path="covariates.html"><a href="covariates.html#plotting-the-model"><i class="fa fa-check"></i><b>14.5.5</b> Plotting the model</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="covariates.html"><a href="covariates.html#best-practices"><i class="fa fa-check"></i><b>14.6</b> Best practices</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="covariates.html"><a href="covariates.html#do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate"><i class="fa fa-check"></i><b>14.6.1</b> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</a></li>
<li class="chapter" data-level="14.6.2" data-path="covariates.html"><a href="covariates.html#do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate"><i class="fa fa-check"></i><b>14.6.2</b> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</a></li>
<li class="chapter" data-level="14.6.3" data-path="covariates.html"><a href="covariates.html#do-not-test-for-balance-of-baseline-measures"><i class="fa fa-check"></i><b>14.6.3</b> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="covariates.html"><a href="covariates.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><i class="fa fa-check"></i><b>14.7</b> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="factorial.html"><a href="factorial.html"><i class="fa fa-check"></i><b>15</b> Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</a>
<ul>
<li class="chapter" data-level="15.1" data-path="factorial.html"><a href="factorial.html#a-linear-model-with-crossed-factors-estimates-interaction-effects"><i class="fa fa-check"></i><b>15.1</b> A linear model with crossed factors estimates interaction effects</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="factorial.html"><a href="factorial.html#an-interaction-is-a-difference-in-simple-effects"><i class="fa fa-check"></i><b>15.1.1</b> An interaction is a difference in simple effects</a></li>
<li class="chapter" data-level="15.1.2" data-path="factorial.html"><a href="factorial.html#a-linear-model-with-crossed-factors-includes-interaction-effects"><i class="fa fa-check"></i><b>15.1.2</b> A linear model with crossed factors includes interaction effects</a></li>
<li class="chapter" data-level="15.1.3" data-path="factorial.html"><a href="factorial.html#factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature"><i class="fa fa-check"></i><b>15.1.3</b> factorial experiments are frequently analyzed as flattened linear models in the experimental biology literature</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="factorial.html"><a href="factorial.html#example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data"><i class="fa fa-check"></i><b>15.2</b> Example 1 – Estimation of a treatment effect relative to a control effect (“Something different”) (Experiment 2j glucose uptake data)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="factorial.html"><a href="factorial.html#twoway-understand1"><i class="fa fa-check"></i><b>15.2.1</b> Understand the experimental design</a></li>
<li class="chapter" data-level="15.2.2" data-path="factorial.html"><a href="factorial.html#fit-the-linear-model"><i class="fa fa-check"></i><b>15.2.2</b> Fit the linear model</a></li>
<li class="chapter" data-level="15.2.3" data-path="factorial.html"><a href="factorial.html#twoway-exp2j-inf"><i class="fa fa-check"></i><b>15.2.3</b> Inference</a></li>
<li class="chapter" data-level="15.2.4" data-path="factorial.html"><a href="factorial.html#plot-the-model-2"><i class="fa fa-check"></i><b>15.2.4</b> Plot the model</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-1"><i class="fa fa-check"></i><b>15.3</b> Understanding the linear model with crossed factors 1</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="factorial.html"><a href="factorial.html#twoway-what-coefs-are"><i class="fa fa-check"></i><b>15.3.1</b> What the coefficients are</a></li>
<li class="chapter" data-level="15.3.2" data-path="factorial.html"><a href="factorial.html#the-interaction-effect-is-something-different"><i class="fa fa-check"></i><b>15.3.2</b> The interaction effect is something different</a></li>
<li class="chapter" data-level="15.3.3" data-path="factorial.html"><a href="factorial.html#why-we-want-to-compare-the-treatment-effect-to-a-control-effect"><i class="fa fa-check"></i><b>15.3.3</b> Why we want to compare the treatment effect to a control effect</a></li>
<li class="chapter" data-level="15.3.4" data-path="factorial.html"><a href="factorial.html#the-order-of-the-factors-in-the-model-tells-the-same-story-differently"><i class="fa fa-check"></i><b>15.3.4</b> The order of the factors in the model tells the same story differently</a></li>
<li class="chapter" data-level="15.3.5" data-path="factorial.html"><a href="factorial.html#power-for-the-interaction-effect-is-less-than-that-for-simple-effects"><i class="fa fa-check"></i><b>15.3.5</b> Power for the interaction effect is less than that for simple effects</a></li>
<li class="chapter" data-level="15.3.6" data-path="factorial.html"><a href="factorial.html#planned-comparisons-vs.-post-hoc-tests"><i class="fa fa-check"></i><b>15.3.6</b> Planned comparisons vs. post-hoc tests</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="factorial.html"><a href="factorial.html#example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data"><i class="fa fa-check"></i><b>15.4</b> Example 2: Estimation of the effect of background condition on an effect (“it depends”) (Experiment 3e lesian area data)</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="factorial.html"><a href="factorial.html#understand-the-experimental-design"><i class="fa fa-check"></i><b>15.4.1</b> Understand the experimental design</a></li>
<li class="chapter" data-level="15.4.2" data-path="factorial.html"><a href="factorial.html#fit-the-linear-model-1"><i class="fa fa-check"></i><b>15.4.2</b> Fit the linear model</a></li>
<li class="chapter" data-level="15.4.3" data-path="factorial.html"><a href="factorial.html#check-the-model-1"><i class="fa fa-check"></i><b>15.4.3</b> Check the model</a></li>
<li class="chapter" data-level="15.4.4" data-path="factorial.html"><a href="factorial.html#inference-from-the-model-2"><i class="fa fa-check"></i><b>15.4.4</b> Inference from the model</a></li>
<li class="chapter" data-level="15.4.5" data-path="factorial.html"><a href="factorial.html#plot-the-model-3"><i class="fa fa-check"></i><b>15.4.5</b> Plot the model</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-2"><i class="fa fa-check"></i><b>15.5</b> Understanding the linear model with crossed factors 2</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="factorial.html"><a href="factorial.html#twoway-marginal-means"><i class="fa fa-check"></i><b>15.5.1</b> Conditional and marginal means</a></li>
<li class="chapter" data-level="15.5.2" data-path="factorial.html"><a href="factorial.html#simple-conditional-effects"><i class="fa fa-check"></i><b>15.5.2</b> Simple (conditional) effects</a></li>
<li class="chapter" data-level="15.5.3" data-path="factorial.html"><a href="factorial.html#twoway-marginal-effects"><i class="fa fa-check"></i><b>15.5.3</b> Marginal effects</a></li>
<li class="chapter" data-level="15.5.4" data-path="factorial.html"><a href="factorial.html#the-additive-model"><i class="fa fa-check"></i><b>15.5.4</b> The additive model</a></li>
<li class="chapter" data-level="15.5.5" data-path="factorial.html"><a href="factorial.html#twoway-reduce"><i class="fa fa-check"></i><b>15.5.5</b> Reduce models for the right reason</a></li>
<li class="chapter" data-level="15.5.6" data-path="factorial.html"><a href="factorial.html#the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird"><i class="fa fa-check"></i><b>15.5.6</b> The marginal means of an additive linear model with two factors can be weird</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="factorial.html"><a href="factorial.html#example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data"><i class="fa fa-check"></i><b>15.6</b> Example 3: Estimation of synergy (“More than the sum of the parts”) (Experiment 1c JA data)</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="factorial.html"><a href="factorial.html#examine-the-data"><i class="fa fa-check"></i><b>15.6.1</b> Examine the data</a></li>
<li class="chapter" data-level="15.6.2" data-path="factorial.html"><a href="factorial.html#fit-the-model-7"><i class="fa fa-check"></i><b>15.6.2</b> Fit the model</a></li>
<li class="chapter" data-level="15.6.3" data-path="factorial.html"><a href="factorial.html#model-check"><i class="fa fa-check"></i><b>15.6.3</b> Model check</a></li>
<li class="chapter" data-level="15.6.4" data-path="factorial.html"><a href="factorial.html#inference-from-the-model-3"><i class="fa fa-check"></i><b>15.6.4</b> Inference from the model</a></li>
<li class="chapter" data-level="15.6.5" data-path="factorial.html"><a href="factorial.html#plot-the-model-4"><i class="fa fa-check"></i><b>15.6.5</b> Plot the model</a></li>
<li class="chapter" data-level="15.6.6" data-path="factorial.html"><a href="factorial.html#alternative-plot"><i class="fa fa-check"></i><b>15.6.6</b> Alternative plot</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="factorial.html"><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-3"><i class="fa fa-check"></i><b>15.7</b> Understanding the linear model with crossed factors 3</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="factorial.html"><a href="factorial.html#thinking-about-the-coefficients-of-the-linear-model"><i class="fa fa-check"></i><b>15.7.1</b> Thinking about the coefficients of the linear model</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="factorial.html"><a href="factorial.html#issues-in-inference"><i class="fa fa-check"></i><b>15.8</b> Issues in inference</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="factorial.html"><a href="factorial.html#for-pairwise-comparisons-it-doesnt-matter-if-you-analyze-the-data-with-a-factorial-or-a-flattened-linear-model"><i class="fa fa-check"></i><b>15.8.1</b> For pairwise comparisons, it doesn’t matter if you analyze the data with a factorial or a flattened linear model</a></li>
<li class="chapter" data-level="15.8.2" data-path="factorial.html"><a href="factorial.html#twoway-multiple-tests"><i class="fa fa-check"></i><b>15.8.2</b> Adjusting <em>p</em>-values for multiple tests</a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="factorial.html"><a href="factorial.html#two-way-anova"><i class="fa fa-check"></i><b>15.9</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="15.9.1" data-path="factorial.html"><a href="factorial.html#how-to-read-a-two-way-anova-table"><i class="fa fa-check"></i><b>15.9.1</b> How to read a two-way ANOVA table</a></li>
<li class="chapter" data-level="15.9.2" data-path="factorial.html"><a href="factorial.html#what-do-the-main-effects-in-an-anova-table-mean"><i class="fa fa-check"></i><b>15.9.2</b> What do the main effects in an ANOVA table mean?</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="factorial.html"><a href="factorial.html#more-issues-in-inference"><i class="fa fa-check"></i><b>15.10</b> More issues in inference</a>
<ul>
<li class="chapter" data-level="15.10.1" data-path="factorial.html"><a href="factorial.html#longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova"><i class="fa fa-check"></i><b>15.10.1</b> Longitudinal experiments – include Time as a random factor (better than repeated measures ANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="factorial.html"><a href="factorial.html#working-in-r-4"><i class="fa fa-check"></i><b>15.11</b> Working in R</a>
<ul>
<li class="chapter" data-level="15.11.1" data-path="factorial.html"><a href="factorial.html#model-formula"><i class="fa fa-check"></i><b>15.11.1</b> Model formula</a></li>
<li class="chapter" data-level="15.11.2" data-path="factorial.html"><a href="factorial.html#using-the-emmeans-function-2"><i class="fa fa-check"></i><b>15.11.2</b> Using the emmeans function</a></li>
<li class="chapter" data-level="15.11.3" data-path="factorial.html"><a href="factorial.html#contrasts"><i class="fa fa-check"></i><b>15.11.3</b> Contrasts</a></li>
<li class="chapter" data-level="15.11.4" data-path="factorial.html"><a href="factorial.html#practice-safe-anova"><i class="fa fa-check"></i><b>15.11.4</b> Practice safe ANOVA</a></li>
<li class="chapter" data-level="15.11.5" data-path="factorial.html"><a href="factorial.html#better-to-avoid-these"><i class="fa fa-check"></i><b>15.11.5</b> Better to avoid these</a></li>
</ul></li>
<li class="chapter" data-level="15.12" data-path="factorial.html"><a href="factorial.html#hidden-code-4"><i class="fa fa-check"></i><b>15.12</b> Hidden Code</a>
<ul>
<li class="chapter" data-level="15.12.1" data-path="factorial.html"><a href="factorial.html#import-exp2j-example-1"><i class="fa fa-check"></i><b>15.12.1</b> Import exp2j (Example 1)</a></li>
<li class="chapter" data-level="15.12.2" data-path="factorial.html"><a href="factorial.html#import-exp3e-lesian-area-data-example-2"><i class="fa fa-check"></i><b>15.12.2</b> Import exp3e lesian area data (Example 2)</a></li>
<li class="chapter" data-level="15.12.3" data-path="factorial.html"><a href="factorial.html#import-exp1c-ja-data-example-3"><i class="fa fa-check"></i><b>15.12.3</b> Import Exp1c JA data (Example 3)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-vii-expanding-the-linear-model.html"><a href="part-vii-expanding-the-linear-model.html"><i class="fa fa-check"></i>Part VII – Expanding the Linear Model</a></li>
<li class="chapter" data-level="16" data-path="lmm.html"><a href="lmm.html"><i class="fa fa-check"></i><b>16</b> Models with random factors – Blocking and pseudoreplication</a>
<ul>
<li class="chapter" data-level="16.1" data-path="lmm.html"><a href="lmm.html#most-experiments-in-bench-biology-generate-batched-data"><i class="fa fa-check"></i><b>16.1</b> Most experiments in bench biology generate batched data</a></li>
<li class="chapter" data-level="16.2" data-path="lmm.html"><a href="lmm.html#why-we-care-about-linear-mixed-models"><i class="fa fa-check"></i><b>16.2</b> Why we care about linear mixed models</a></li>
<li class="chapter" data-level="16.3" data-path="lmm.html"><a href="lmm.html#example-1-using-independent-experiments-as-blocks-to-increase-precision-and-power-germinal-centers-experiment-1g"><i class="fa fa-check"></i><b>16.3</b> Example 1 – Using independent experiments as blocks to increase precision and power (“germinal centers” – Experiment 1g)</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="lmm.html"><a href="lmm.html#understand-the-data"><i class="fa fa-check"></i><b>16.3.1</b> Understand the data</a></li>
<li class="chapter" data-level="16.3.2" data-path="lmm.html"><a href="lmm.html#examine-the-data-1"><i class="fa fa-check"></i><b>16.3.2</b> Examine the data</a></li>
<li class="chapter" data-level="16.3.3" data-path="lmm.html"><a href="lmm.html#fit-the-model-8"><i class="fa fa-check"></i><b>16.3.3</b> Fit the model</a></li>
<li class="chapter" data-level="16.3.4" data-path="lmm.html"><a href="lmm.html#inference-from-the-model-4"><i class="fa fa-check"></i><b>16.3.4</b> Inference from the model</a></li>
<li class="chapter" data-level="16.3.5" data-path="lmm.html"><a href="lmm.html#plot-the-model-5"><i class="fa fa-check"></i><b>16.3.5</b> Plot the model</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="lmm.html"><a href="lmm.html#understanding-linear-mixed-models-1"><i class="fa fa-check"></i><b>16.4</b> Understanding linear mixed models 1 –</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="lmm.html"><a href="lmm.html#linear-mixed-models-have-parameters-for-random-intercept-effects-and-random-slope-effects"><i class="fa fa-check"></i><b>16.4.1</b> Linear mixed models have parameters for random intercept effects and random slope effects</a></li>
<li class="chapter" data-level="16.4.2" data-path="lmm.html"><a href="lmm.html#a-reminder-of-what-fixed-effects-are"><i class="fa fa-check"></i><b>16.4.2</b> A reminder of what fixed effects are</a></li>
<li class="chapter" data-level="16.4.3" data-path="lmm.html"><a href="lmm.html#what-are-random-intercepts"><i class="fa fa-check"></i><b>16.4.3</b> What are random intercepts?</a></li>
<li class="chapter" data-level="16.4.4" data-path="lmm.html"><a href="lmm.html#what-are-random-slopes"><i class="fa fa-check"></i><b>16.4.4</b> What are random slopes?</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="lmm.html"><a href="lmm.html#example-2-using-a-blocked-design-to-increase-precision-and-power-no-subsampling-paired-t"><i class="fa fa-check"></i><b>16.5</b> Example 2 – Using a blocked design to increase precision and power (no subsampling) – paired t</a></li>
<li class="chapter" data-level="16.6" data-path="lmm.html"><a href="lmm.html#example-3---pseudoreplication"><i class="fa fa-check"></i><b>16.6</b> Example 3 - pseudoreplication</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="pre-post.html"><a href="pre-post.html"><i class="fa fa-check"></i><b>17</b> Linear models for longitudinal experiments – I. pre-post designs</a>
<ul>
<li class="chapter" data-level="17.1" data-path="pre-post.html"><a href="pre-post.html#best-practice-models"><i class="fa fa-check"></i><b>17.1</b> Best practice models</a></li>
<li class="chapter" data-level="17.2" data-path="pre-post.html"><a href="pre-post.html#common-alternatives-that-are-not-recommended"><i class="fa fa-check"></i><b>17.2</b> Common alternatives that are not recommended</a></li>
<li class="chapter" data-level="17.3" data-path="pre-post.html"><a href="pre-post.html#advanced-models"><i class="fa fa-check"></i><b>17.3</b> Advanced models</a></li>
<li class="chapter" data-level="17.4" data-path="pre-post.html"><a href="pre-post.html#understanding-the-alternative-models"><i class="fa fa-check"></i><b>17.4</b> Understanding the alternative models</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="pre-post.html"><a href="pre-post.html#m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model"><i class="fa fa-check"></i><b>17.4.1</b> (M1) Linear model with the baseline measure as the covariate (ANCOVA model)</a></li>
<li class="chapter" data-level="17.4.2" data-path="pre-post.html"><a href="pre-post.html#m2-linear-model-of-the-change-score-change-score-model"><i class="fa fa-check"></i><b>17.4.2</b> (M2) Linear model of the change score (change-score model)</a></li>
<li class="chapter" data-level="17.4.3" data-path="pre-post.html"><a href="pre-post.html#m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model"><i class="fa fa-check"></i><b>17.4.3</b> (M3) Linear model of post-baseline values without the baseline as a covariate (post model)</a></li>
<li class="chapter" data-level="17.4.4" data-path="pre-post.html"><a href="pre-post.html#m4-linear-model-with-factorial-fixed-effects-fixed-effects-model"><i class="fa fa-check"></i><b>17.4.4</b> (M4) Linear model with factorial fixed effects (fixed-effects model)</a></li>
<li class="chapter" data-level="17.4.5" data-path="pre-post.html"><a href="pre-post.html#m5-repeated-measures-anova"><i class="fa fa-check"></i><b>17.4.5</b> (M5) Repeated measures ANOVA</a></li>
<li class="chapter" data-level="17.4.6" data-path="pre-post.html"><a href="pre-post.html#m6-linear-mixed-model"><i class="fa fa-check"></i><b>17.4.6</b> (M6) Linear mixed model</a></li>
<li class="chapter" data-level="17.4.7" data-path="pre-post.html"><a href="pre-post.html#m7-linear-model-with-correlated-error"><i class="fa fa-check"></i><b>17.4.7</b> (M7) Linear model with correlated error</a></li>
<li class="chapter" data-level="17.4.8" data-path="pre-post.html"><a href="pre-post.html#m8-constrained-fixed-effects-model-with-correlated-error-clda-model"><i class="fa fa-check"></i><b>17.4.8</b> (M8) Constrained fixed effects model with correlated error (cLDA model)</a></li>
<li class="chapter" data-level="17.4.9" data-path="pre-post.html"><a href="pre-post.html#comparison-table"><i class="fa fa-check"></i><b>17.4.9</b> Comparison table</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="pre-post.html"><a href="pre-post.html#example-1-a-single-post-baseline-measure-pre-post-design"><i class="fa fa-check"></i><b>17.5</b> Example 1 – a single post-baseline measure (pre-post design)</a></li>
<li class="chapter" data-level="17.6" data-path="pre-post.html"><a href="pre-post.html#working-in-r-5"><i class="fa fa-check"></i><b>17.6</b> Working in R</a></li>
<li class="chapter" data-level="17.7" data-path="pre-post.html"><a href="pre-post.html#hidden-code-5"><i class="fa fa-check"></i><b>17.7</b> Hidden code</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="pre-post.html"><a href="pre-post.html#import-and-wrangle-mouse-sociability-data"><i class="fa fa-check"></i><b>17.7.1</b> Import and wrangle mouse sociability data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="counts.html"><a href="counts.html"><i class="fa fa-check"></i><b>18</b> Linear models for count data – Generalized Linear Models I</a>
<ul>
<li class="chapter" data-level="18.1" data-path="counts.html"><a href="counts.html#the-generalized-linear-model"><i class="fa fa-check"></i><b>18.1</b> The generalized linear model</a></li>
<li class="chapter" data-level="18.2" data-path="counts.html"><a href="counts.html#count-data-example-number-of-trematode-worm-larvae-in-eyes-of-threespine-stickleback-fish"><i class="fa fa-check"></i><b>18.2</b> Count data example – number of trematode worm larvae in eyes of threespine stickleback fish</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="counts.html"><a href="counts.html#modeling-strategy-1"><i class="fa fa-check"></i><b>18.2.1</b> Modeling strategy</a></li>
<li class="chapter" data-level="18.2.2" data-path="counts.html"><a href="counts.html#checking-the-model-i-a-normal-q-q-plot"><i class="fa fa-check"></i><b>18.2.2</b> Checking the model I – a Normal Q-Q plot</a></li>
<li class="chapter" data-level="18.2.3" data-path="counts.html"><a href="counts.html#checking-the-model-ii-scale-location-plot-for-checking-homoskedasticity"><i class="fa fa-check"></i><b>18.2.3</b> Checking the model II – scale-location plot for checking homoskedasticity</a></li>
<li class="chapter" data-level="18.2.4" data-path="counts.html"><a href="counts.html#two-distributions-for-count-data-poisson-and-negative-binomial"><i class="fa fa-check"></i><b>18.2.4</b> Two distributions for count data – Poisson and Negative Binomial</a></li>
<li class="chapter" data-level="18.2.5" data-path="counts.html"><a href="counts.html#fitting-a-glm-with-a-poisson-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>18.2.5</b> Fitting a GLM with a Poisson distribution to the worm data</a></li>
<li class="chapter" data-level="18.2.6" data-path="counts.html"><a href="counts.html#model-checking-fits-to-count-data"><i class="fa fa-check"></i><b>18.2.6</b> Model checking fits to count data</a></li>
<li class="chapter" data-level="18.2.7" data-path="counts.html"><a href="counts.html#fitting-a-glm-with-a-negative-binomial-distribution-to-the-worm-data"><i class="fa fa-check"></i><b>18.2.7</b> Fitting a GLM with a Negative Binomial distribution to the worm data</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="counts.html"><a href="counts.html#working-in-r-6"><i class="fa fa-check"></i><b>18.3</b> Working in R</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="counts.html"><a href="counts.html#fitting-a-glm-to-count-data"><i class="fa fa-check"></i><b>18.3.1</b> Fitting a GLM to count data</a></li>
<li class="chapter" data-level="18.3.2" data-path="counts.html"><a href="counts.html#fitting-a-generalized-linear-mixed-model-glmm-to-count-data"><i class="fa fa-check"></i><b>18.3.2</b> Fitting a generalized linear mixed model (GLMM) to count data</a></li>
<li class="chapter" data-level="18.3.3" data-path="counts.html"><a href="counts.html#fitting-a-generalized-linear-model-to-continouus-data"><i class="fa fa-check"></i><b>18.3.3</b> Fitting a generalized linear model to continouus data</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="counts.html"><a href="counts.html#problems-1"><i class="fa fa-check"></i><b>18.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="gls.html"><a href="gls.html"><i class="fa fa-check"></i><b>19</b> Linear models with heterogenous variance</a></li>
<li class="chapter" data-level="20" data-path="count-sim.html"><a href="count-sim.html"><i class="fa fa-check"></i><b>20</b> Simulations – Count data (alternatives to a t-test)</a>
<ul>
<li class="chapter" data-level="20.1" data-path="count-sim.html"><a href="count-sim.html#use-data-similar-to-figure-6f-from-example-1"><i class="fa fa-check"></i><b>20.1</b> Use data similar to Figure 6f from Example 1</a></li>
<li class="chapter" data-level="20.2" data-path="count-sim.html"><a href="count-sim.html#functions"><i class="fa fa-check"></i><b>20.2</b> Functions</a></li>
<li class="chapter" data-level="20.3" data-path="count-sim.html"><a href="count-sim.html#simulations"><i class="fa fa-check"></i><b>20.3</b> Simulations</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="count-sim.html"><a href="count-sim.html#type-i-pseudo-normal-distribution"><i class="fa fa-check"></i><b>20.3.1</b> Type I, Pseudo-Normal distribution</a></li>
<li class="chapter" data-level="20.3.2" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-equal-n"><i class="fa fa-check"></i><b>20.3.2</b> Type I, neg binom, equal n</a></li>
<li class="chapter" data-level="20.3.3" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-equal-n-small-theta"><i class="fa fa-check"></i><b>20.3.3</b> Type I, neg binom, equal n, small theta</a></li>
<li class="chapter" data-level="20.3.4" data-path="count-sim.html"><a href="count-sim.html#type-i-neg-binom-unequal-n"><i class="fa fa-check"></i><b>20.3.4</b> Type I, neg binom, unequal n</a></li>
<li class="chapter" data-level="20.3.5" data-path="count-sim.html"><a href="count-sim.html#power-pseudo-normal-distribution-equal-n"><i class="fa fa-check"></i><b>20.3.5</b> Power, Pseudo-Normal distribution, equal n</a></li>
<li class="chapter" data-level="20.3.6" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-equal-n"><i class="fa fa-check"></i><b>20.3.6</b> Power, neg binom, equal n</a></li>
<li class="chapter" data-level="20.3.7" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-small-theta"><i class="fa fa-check"></i><b>20.3.7</b> Power, neg binom, small theta</a></li>
<li class="chapter" data-level="20.3.8" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-unequal-n"><i class="fa fa-check"></i><b>20.3.8</b> Power, neg binom, unequal n</a></li>
<li class="chapter" data-level="20.3.9" data-path="count-sim.html"><a href="count-sim.html#power-neg-binom-unequal-n-unequal-theta"><i class="fa fa-check"></i><b>20.3.9</b> Power, neg binom, unequal n, unequal theta</a></li>
<li class="chapter" data-level="20.3.10" data-path="count-sim.html"><a href="count-sim.html#type-1-neg-binom-equal-n-unequal-theta"><i class="fa fa-check"></i><b>20.3.10</b> Type 1, neg binom, equal n, unequal theta</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="count-sim.html"><a href="count-sim.html#save-it-read-it"><i class="fa fa-check"></i><b>20.4</b> Save it, Read it</a></li>
<li class="chapter" data-level="20.5" data-path="count-sim.html"><a href="count-sim.html#analysis"><i class="fa fa-check"></i><b>20.5</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html"><i class="fa fa-check"></i>Appendix 1: Getting Started with R</a>
<ul>
<li class="chapter" data-level="20.6" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready"><i class="fa fa-check"></i><b>20.6</b> Get your computer ready</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-here"><i class="fa fa-check"></i><b>20.6.1</b> Start here</a></li>
<li class="chapter" data-level="20.6.2" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r"><i class="fa fa-check"></i><b>20.6.2</b> Install R</a></li>
<li class="chapter" data-level="20.6.3" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-studio"><i class="fa fa-check"></i><b>20.6.3</b> Install R Studio</a></li>
<li class="chapter" data-level="20.6.4" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#install-r-markdown-1"><i class="fa fa-check"></i><b>20.6.4</b> Install R Markdown</a></li>
<li class="chapter" data-level="20.6.5" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#optional-alternative-latex-installations"><i class="fa fa-check"></i><b>20.6.5</b> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="appendix-1-getting-started-with-r.html"><a href="appendix-1-getting-started-with-r.html#start-learning-r-studio"><i class="fa fa-check"></i><b>20.7</b> Start learning R Studio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html"><i class="fa fa-check"></i>Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Elements of Statistical Modeling for Experimental Biology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Linear models with a single, continuous <em>X</em> (“regression”)</h1>
<ol style="list-style-type: decimal">
<li>observation warming on phenology</li>
<li>experiment warming on phenology</li>
<li>using regression to compare longitudinal (dietary methionine)</li>
</ol>
<div id="a-linear-model-with-a-single-continuous-x-is-classical-regression" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> A linear model with a single, continuous <em>X</em> is classical “regression”</h2>
<div id="analysis-of-green-down-data" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Analysis of “green-down” data</h3>
<p>To introduce some principles of modeling with a single continuous <span class="math inline">\(X\)</span> variable, I’ll use a dataset from</p>
<p><a href="https://doi.org/10.1038/s41586-018-0399-1" target="_blank">Richardson, A.D., Hufkens, K., Milliman, T. et al. Ecosystem warming extends vegetation activity but heightens vulnerability to cold temperatures. Nature 560, 368–371 (2018).</a></p>
<p><a href="https://www.nature.com/articles/s41586-018-0399-1#Sec15" target="_blank">Source data</a></p>
<p>The data are from a <a href="https://mnspruce.ornl.gov" target="_blank">long-term experiment on the effects of warming and CO2 on a high-carbon northern temperate peatland</a> and is the focal dataset of the study. The experiment involves 10 large, temperature and CO2 controlled enclosures. CO2 is set to 400 ppm in five enclosures and 900 ppm in five enclosures. Temperature of the five enclosures within each CO2 level is set to 0, 2.25, 4.5, 6.75, or 9 °C above ambient temperature. The multiple temperature levels is a <strong>regression design</strong>, which allows a researcher to measure non-linear effects. Read more about the experimental design and the <a href="https://mnspruce.ornl.gov/design" target="_blank">beautiful implementation</a>.</p>
<p>The question pursued is in this study is, what is the causal effect of warming on the timing (or phenology) of the transition into photosynthetic activity (“green-up”) in the spring and of the transition out of photosynthetic activity (“green-down”) in the fall? The researchers measured these transition dates, or Day of Year (DOY), using foliage color. Here, we focus on the transition out of photosynthesis or “green-down” DOY.</p>
<p><strong>Import the data</strong></p>
<ol style="list-style-type: decimal">
<li><strong>Examine the data</strong></li>
</ol>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="regression.html#cb227-1" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(<span class="at">x =</span> temperature,</span>
<span id="cb227-2"><a href="regression.html#cb227-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> transition_date,</span>
<span id="cb227-3"><a href="regression.html#cb227-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> fig2c) <span class="sc">+</span></span>
<span id="cb227-4"><a href="regression.html#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span>
<span id="cb227-5"><a href="regression.html#cb227-5" aria-hidden="true" tabindex="-1"></a>gg2 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(<span class="at">x =</span> temperature,</span>
<span id="cb227-6"><a href="regression.html#cb227-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> transition_date,</span>
<span id="cb227-7"><a href="regression.html#cb227-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> fig2c) <span class="sc">+</span></span>
<span id="cb227-8"><a href="regression.html#cb227-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>))</span>
<span id="cb227-9"><a href="regression.html#cb227-9" aria-hidden="true" tabindex="-1"></a>gg3 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(<span class="at">x =</span> temperature,</span>
<span id="cb227-10"><a href="regression.html#cb227-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> transition_date,</span>
<span id="cb227-11"><a href="regression.html#cb227-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> fig2c) <span class="sc">+</span></span>
<span id="cb227-12"><a href="regression.html#cb227-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb227-13"><a href="regression.html#cb227-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(gg1, gg2, gg3, <span class="at">ncol=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-vet-1.png" width="576" /></p>
<p>No plot shows any obvious outlier that might be due to measurement blunders or curation error. The linear regression in the left-most plot clearly shows that a linear response is sufficient to capture the effect of temperature on day of green-down.</p>
<ol start="2" style="list-style-type: decimal">
<li><p><strong>choose a model</strong>. Because the <span class="math inline">\(X\)</span> variable (<span class="math inline">\(temperature\)</span>) was experimentally set to five levels, the data could reasonably be modeled using either a linear model with a categorical <span class="math inline">\(X\)</span> or a linear model with a continuous <span class="math inline">\(X\)</span>. The advantage of modeling <span class="math inline">\(temperature\)</span> as a continuous variable is that there is only one effect, the slope of the regression line. If modeled as a categorical factor with five levels, there are, at a minimum, four interesting effects (the difference in means between each non-reference level and reference (temperature = 0) level). Also, for inference, modeling <span class="math inline">\(temperature\)</span> as a continuous variable increases power for hypothesis tests.</p></li>
<li><p><strong>fit the model</strong></p></li>
</ol>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="regression.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: fit the model</span></span>
<span id="cb228-2"><a href="regression.html#cb228-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(transition_date <span class="sc">~</span> temperature, <span class="at">data =</span> fig2c)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><strong>check the model</strong></li>
</ol>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="regression.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check normality assumption</span></span>
<span id="cb229-2"><a href="regression.html#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb229-3"><a href="regression.html#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(m1, <span class="at">id=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-check-qq-1.png" width="576" /></p>
<p>The Q-Q plot indicates the distribution of residuals is well within that expected for a normal sample and there is no cause for concern with inference.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="regression.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check homogeneity assumption</span></span>
<span id="cb230-2"><a href="regression.html#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spreadLevelPlot</span>(m1, <span class="at">id=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-check-spread-1.png" width="576" /></p>
<pre><code>## 
## Suggested power transformation:  0.6721303</code></pre>
<p>The spread-location plot shows no conspicuous trend in how the spread changes with the conditonal mean. There is no cause for concern with inference.</p>
<ol start="5" style="list-style-type: decimal">
<li><strong>inference from the model</strong></li>
</ol>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="regression.html#cb232-1" aria-hidden="true" tabindex="-1"></a>m1_coeff <span class="ot">&lt;-</span> <span class="fu">summary</span>(m1) <span class="sc">%&gt;%</span></span>
<span id="cb232-2"><a href="regression.html#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span>
<span id="cb232-3"><a href="regression.html#cb232-3" aria-hidden="true" tabindex="-1"></a>m1_confint <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1)</span>
<span id="cb232-4"><a href="regression.html#cb232-4" aria-hidden="true" tabindex="-1"></a>m1_coeff <span class="ot">&lt;-</span> <span class="fu">cbind</span>(m1_coeff, m1_confint)</span>
<span id="cb232-5"><a href="regression.html#cb232-5" aria-hidden="true" tabindex="-1"></a>m1_coeff</span></code></pre></div>
<pre><code>##               Estimate Std. Error   t value     Pr(&gt;|t|)      2.5 %     97.5 %
## (Intercept) 289.458750  3.0593949 94.613071 1.738650e-13 282.403773 296.513728
## temperature   4.982745  0.5541962  8.990941 1.866888e-05   3.704767   6.260724</code></pre>
<p>The effect of added temperature on the day of green-down is 4.98 d per 1 °C (95% CI: 3.7, 6.3; p &lt; 0.001).</p>
<ol start="6" style="list-style-type: decimal">
<li><strong>plot the model</strong></li>
</ol>
<div class="figure"><span id="fig:continuous-x-plot"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-plot-1.png" alt="Modification of the published Figure 2c showing the experimental effect of warming on the date of autumn green-down (the transition to fall foliage color) in a mixed shrub community. The bottom panel is a scatterplot. The regression line shows the expected value of Y (transition day of year) given a value of X (added temperature). The slope of the regression line is the estimate of the effect. The estimate and 95% confidence interval of the estimate are given in the top panel." width="576" />
<p class="caption">
Figure 9.1: Modification of the published Figure 2c showing the experimental effect of warming on the date of autumn green-down (the transition to fall foliage color) in a mixed shrub community. The bottom panel is a scatterplot. The regression line shows the expected value of Y (transition day of year) given a value of X (added temperature). The slope of the regression line is the estimate of the effect. The estimate and 95% confidence interval of the estimate are given in the top panel.
</p>
</div>
<ol start="7" style="list-style-type: decimal">
<li>Report the results</li>
</ol>
<p>The modeled effect of added temperature is Slope: 4.98 (3.7, 6.26) d per 1 °C (<a href="regression.html#fig:continuous-x-plot">9.1</a>).</p>
</div>
<div id="learning-from-the-green-down-example" class="section level3" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Learning from the green-down example</h3>
<p>Figure <a href="regression.html#fig:continuous-x-plot">9.1</a> is a <strong>scatterplot</strong> with the green-down DOY for the mixed-shrub community on the <span class="math inline">\(Y\)</span> axis and added temperature on the <span class="math inline">\(X\)</span> axis. The line through the data is a regression line, which is the expected value of <em>Y</em> (green-down DOY) given a specific value of <em>X</em> (added temperature). The slope of the line is the <strong>effect</strong> of added temperature on timing of green-down. The intercept of the regression line is the value of the response (day of green-down) when <span class="math inline">\(X\)</span> is equal to zero. Very often, this value is not of interest although the value should be reported to allow predictions from the model. Also very often, the value of the intercept is not meaningful because a value of <span class="math inline">\(X = 0\)</span> is far outside the range of measured <span class="math inline">\(X\)</span>, or the value is absurd because it is impossible (for example, if investigating the effect of body weight on metabolic rate, the value <span class="math inline">\(weight = 0\)</span> is impossible).</p>
<p>The intercept and slope are the coefficients of the model fit to the data, which is</p>
<p><span class="math display" id="eq:continuous-x-fit">\[\begin{equation}
day_i = b_0 + b_1 temperature_i + e_i
\tag{9.1}
\end{equation}\]</span></p>
<p>where <em>day</em> is the day of green-down, <em>temperature</em> is the added temperature, and <em>i</em> refers (or “indexes”) the <em>i</em>th enclosure. This model completely reconstructs the day of green-down for all ten enclosures. For example, the day of green-down for enclosure 8 is</p>
<p><span class="math display">\[\begin{equation}
332 = 289.458750 + 4.982745 \times 6.73 + 9.00737
\end{equation}\]</span></p>
<p>The coefficients in the model are estimates of the parameters of the <strong>generating model</strong> fit to the data</p>
<p><span class="math display" id="eq:continuous-x-m1">\[\begin{align}
day &amp;= \beta_0 + \beta_1 temperature + \varepsilon\\
\varepsilon &amp;\sim N(0, \sigma^2)
\tag{9.2}
\end{align}\]</span></p>
<p>A generating model of the data is used to make inference, for example, a measure of uncertainty in a prediction in the timing of green-down with future warming, or a measure of uncertainty about the effect of temperature on green-down.</p>
</div>
<div id="using-a-regression-model-for-explanation-causal-models" class="section level3" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> Using a regression model for “explanation” – causal models</h3>
<p>In this text, “explanatory” means “causal” and a goal of explanatory modeling is the estimate of causal effects using a <strong>causal interpretation</strong> of the linear model (=regression) coefficients. “What what? I learned in my stats 101 course that we cannot interpret regression coefficients causally.”</p>
<p>Statisticians (and statistics textbooks) have been quite rigid that a regression coefficient has a descriptive (or “observational,” see below) interpretation but not a causal interpretation. At the same time, statisticians (and statistics textbooks) do not seem to have any issue with interpeting the modeled effects from an experiment causally, since this is how they are interpreted. But if the modeled effects are simply coefficients from a linear (= regression) model, then this historical practice is muddled.</p>
<p>Part of this muddled history arises from the use of “regression” for models fit to observational data with one or more continuous <span class="math inline">\(X\)</span> variables and the use of “ANOVA” for models fit to experimental data with one or more categorical <span class="math inline">\(X\)</span>. This separation seems to have blinded statisticians from working on the formal probabilistic statements underlying causal interpretations of effect estimates in ANOVA and the synthesis of these statements with the probabilistic statements in regression modeling. Two major approaches to developing formal, probabilistic statements of causal modeling in statistics are the <strong>Rubin causal model</strong> and the <strong>do-operator</strong> of Pearl. Despite the gigantic progress in these approaches, little to none of this has found its way into biostatistics textbooks.</p>
<div id="what-a-regression-coefficient-means" class="section level4" number="9.1.3.1">
<h4><span class="header-section-number">9.1.3.1</span> What a regression coefficient means</h4>
<p>A linear (“regression”) model coefficient, such as the coefficient for temperature, <span class="math inline">\(\beta_1\)</span>, has two interpretations, an <strong>observational</strong> interpretation and a <strong>causal interpretation</strong>. To understand these interpretations, it’s useful to remember that a predicted value from a regression model is a <strong>conditional mean</strong></p>
<p><span class="math display" id="eq:continuous-x-conditional-mean">\[\begin{equation}
\textrm{E}[day|temperature] = \beta_0 + \beta_1 temperature
\tag{9.3}
\end{equation}\]</span></p>
<p>In words “the expected value of day conditional on temperature is beta-knot plus beta-one times temperature.” An <strong>expected value</strong> is a long run average – if we had an infinite number of enclosures with <span class="math inline">\(temperature=x\)</span> (where <span class="math inline">\(x\)</span> is a specific value of added temperature, say 2.5 °C), the average <span class="math inline">\(day\)</span> of these enclosures is <span class="math inline">\(\beta_0 + \beta_1 x\)</span>.</p>
<p>The parameter <span class="math inline">\(\beta_1\)</span> is a <em>difference</em> in conditional means.</p>
<p><span class="math display" id="eq:beta">\[\begin{equation}
\beta_1 = \textrm{E}[day|temperature = x+1] - \textrm{E}[day|temperature = x]
\tag{9.4}
\end{equation}\]</span></p>
<p>In words, “beta-one is the expected value of day of green-down when the temperature equals x + 1 minus the expected value of day of green-down when the temperature equals x.” A very short way to state this is “beta-one is a difference in conditional means.”</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>tl;dr. Note that the “+ 1” in this definition is mere convenience. Since the slope of a line is <span class="math inline">\(\frac{y_2 - y_1}{x_2 - x_1}\)</span>, where (<span class="math inline">\(x_1\)</span>, <span class="math inline">\(y_1\)</span>) and (<span class="math inline">\(x_2\)</span>, <span class="math inline">\(y_2\)</span>) are the coordinates of any two points on the line, it is convenient to choose two points that differ in <span class="math inline">\(X\)</span> by one unit, which makes the fraction equal to the numerator only. The numerator is a difference in conditional means. It is also why the units of a regression coefficient are "per unit of <span class="math inline">\(X\)</span> even if defined as a difference in two <span class="math inline">\(Y\)</span> values.</p>
</div>
<p>The difference between observational and causal interpretations of <span class="math inline">\(\beta_1\)</span> depends on the “event” conditioned on in <span class="math inline">\(\textrm{E}[day|temperature]\)</span>. Let’s start with the causal interpretation, which is how we should think about the regression coefficients in the green-down experiment.</p>
</div>
<div id="causal-interpretation-conditional-on-doing-x-x" class="section level4" number="9.1.3.2">
<h4><span class="header-section-number">9.1.3.2</span> Causal interpretation – conditional on “doing” X = x</h4>
<p>In the causal interpretation of regression, <span class="math inline">\(\textrm{E}[day|temperature]\)</span> is conditioned on “doing” a real or hypothetical intervention in the system where we set the value of <span class="math inline">\(temperature\)</span> to a specific value <span class="math inline">\(x\)</span> ("<span class="math inline">\(temperature=x\)</span>), while keeping everything else about the system the same. This can be stated explicitly as <span class="math inline">\(\textrm{E}[day|\;do\;temperature = x]\)</span>. Using the do-operator, we can interpret <span class="math inline">\(\beta_1\)</span> as an <strong>effect coefficient</strong>.</p>
<p><span class="math display">\[\begin{equation}
\beta_1 = \textrm{E}[day|\;do\;temperature = x+1] - \textrm{E}[day|\;do\;temperature = x]
\end{equation}\]</span></p>
<p>In words, “beta-one is the expected value of day of green-down were we to set the temperature to x + 1, minus the expected value of day of green-down were we to set the temperature to x.”</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>tl;dr. In the green-down experiment, the researchers didn’t set the temperature in the intervened enclosures to the ambient temperature + 1 but to ambient + 2.25, ambient + 4.5, ambient + 6.75, and ambient + 9.0. Again (see tl;dr above), the + 1 is mere convenience in the definition.</p>
</div>
</div>
<div id="observational-interpretation-conditional-on-seeing-x-x." class="section level4" number="9.1.3.3">
<h4><span class="header-section-number">9.1.3.3</span> Observational interpretation – conditional on “seeing” X = x.</h4>
<p>In the observational interpretation of regression, <span class="math inline">\(\textrm{E}[day|temperature]\)</span> is conditioned on sampling data and “seeing” a value of <span class="math inline">\(temperature\)</span>. We can state this explicitly as <span class="math inline">\(\textrm{E}[day|\;see\;temperature]\)</span>. From this, we can interpret <span class="math inline">\(\beta_1\)</span> as an <strong>observational coefficient</strong></p>
<p><span class="math display">\[\begin{equation}
\beta_1 = \textrm{E}[day|\;see\;temperature = x+1] - \textrm{E}[day|\;see \;temperature = x]
\end{equation}\]</span></p>
<p>In words, “beta-one is the expected value of day of green-down when see that temperature equals x + 1 minus the expected value of day of green-down when we see that temperature equals x.” To understand what I mean by “observational,” let’s imagine that the green-down data do not come from an experiment in which the researchers intervened and set the added temperature to a specifc value but from ten sites that naturally vary in mean annual temperature. Or from a single site with 10 years of data, with some years warmer and some years colder. Data from this kind of study is <strong>observational</strong> – the researcher didn’t intervene and set the <span class="math inline">\(X\)</span> values but merely observed the <span class="math inline">\(X\)</span> values.</p>
<p>If we sample (or “see”) a site with a mean annual temperature that is 2.5 °C above a reference value, the expected day of green-down is <span class="math inline">\(\textrm{E}[day|temperature = 2.5 °C]\)</span>. That is, values near <span class="math inline">\(\textrm{E}[day|temperature = 2.5 °C]\)</span> are more probable than values away from <span class="math inline">\(\textrm{E}[day|temperature = 2.5 °C]\)</span>. Or, if the only information that we have about this site is a mean annual temperature that is 2.5 °C above some reference, then our best prediction of the day of green-down would be <span class="math inline">\(\textrm{E}[day|temperature = 2.5 °C]\)</span>. We do not claim that the 4.98 day delay in green-down is caused by the warmer temperature, only that this is the expected delay relative to the reference having seen the data.</p>
<p>The seeing interpretation of a regression coefficient is <strong>descriptive</strong>– it is a description of a mathematical relationship. In this interpretation, the coefficient is not causal in the sense of what the expected <strong>response</strong> in <span class="math inline">\(Y\)</span> would be were we to intervene in the system and change <span class="math inline">\(X\)</span> from <span class="math inline">\(x\)</span> to <span class="math inline">\(x+1\)</span>.</p>
</div>
<div id="omitted-variable-bias" class="section level4" number="9.1.3.4">
<h4><span class="header-section-number">9.1.3.4</span> Omitted variable bias</h4>
<p>What is the consequence of interpreting a regression coefficient causally instead of observationally?</p>
<div class="figure"><span id="fig:continuous-x-dag"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-dag-1.png" alt="a Directed Acyclic (or causal) Graph of a hypothetical world where the day of green-down is caused by two, correlated environmental variables, temperature and moisture, and to a noise factor (U) that represents an unspecified set of additional variables that are not correlated to either temperature or moisture." width="576" />
<p class="caption">
Figure 9.2: a Directed Acyclic (or causal) Graph of a hypothetical world where the day of green-down is caused by two, correlated environmental variables, temperature and moisture, and to a noise factor (U) that represents an unspecified set of additional variables that are not correlated to either temperature or moisture.
</p>
</div>
<p>Let’s expand the thought experiment where we have an observational data set of green down dates. In this thought experiment, only two variables systematically affect green-down DOY. The first is the temperature that the plants experience; the effect of <span class="math inline">\(temperature\)</span> is <span class="math inline">\(\beta_1\)</span>. The second is the soil moisture that the plants experience; the effect of <span class="math inline">\(moisture\)</span> is <span class="math inline">\(\beta_2\)</span>. <span class="math inline">\(temperature\)</span> and <span class="math inline">\(moisture\)</span> are correlated with a value <span class="math inline">\(\rho\)</span>. This causal model is graphically represented by the <strong>causal graph</strong> above.</p>
<p>Lets fit two linear models.</p>
<p><span class="math display">\[\begin{align}
(\mathcal{M}_1)\; day &amp;= b_0 + b_1 \; temperature + b_2 \; moisture + \varepsilon\\
(\mathcal{M}_2)\; day &amp;= b_0 + b_1 \; temperature + \varepsilon
\end{align}\]</span></p>
<p><span class="math inline">\(\mathcal{M}_1\)</span> the linear model including both <span class="math inline">\(temperature\)</span> and <span class="math inline">\(moisture\)</span> as <span class="math inline">\(X\)</span> variables and <span class="math inline">\(\mathcal{M}_2\)</span> the linear model including only <span class="math inline">\(temperature\)</span> as an <span class="math inline">\(X\)</span> variable. Given the true causal model above, <span class="math inline">\(b_1\)</span> is an <strong>unbiased</strong> estimate of the true causal effect of temperature <span class="math inline">\(\beta_1\)</span> in <span class="math inline">\(\mathcal{M}_1\)</span> because the expected value of <span class="math inline">\(b_1\)</span> is <span class="math inline">\(\beta_1\)</span>. By contrast, <span class="math inline">\(b_1\)</span> is a <strong>biased</strong> estimate of the true causal effect of temperature <span class="math inline">\(\beta_1\)</span> in <span class="math inline">\(\mathcal{M}_2\)</span>. The expected value of <span class="math inline">\(b_1\)</span> in <span class="math inline">\(\mathcal{M}_2\)</span> is the true, causal effect plus a bias term.</p>
<p><span class="math display">\[\begin{equation}
\mathrm{E}(b_1|\mathcal{M}_1) = \beta + \rho \alpha \frac{\sigma_{moisture}}{\sigma_{temperature}}
\end{equation}\]</span></p>
<p>This bias (<span class="math inline">\(\rho \alpha \frac{\sigma_{moisture}}{\sigma_{temperature}}\)</span>) is <strong>omitted variable bias</strong>. The omitted variable <span class="math inline">\(moisture\)</span> is an unmeasured, <strong>confounding variable</strong>. A variable <span class="math inline">\(X_2\)</span> is a confounder for variable <span class="math inline">\(X_1\)</span> if <span class="math inline">\(X_2\)</span> has both a correlation with <span class="math inline">\(X_1\)</span> and a path to the response <span class="math inline">\(Y\)</span> that is not through <span class="math inline">\(X_1\)</span>. With ommitted variable bias, as we sample more and more data, our estimate of the effect doesn’t converge on the truth but the truth plus some bias.</p>
</div>
<div id="causal-modeling-with-experimental-versus-observational-data" class="section level4" number="9.1.3.5">
<h4><span class="header-section-number">9.1.3.5</span> Causal modeling with experimental versus observational data</h4>
<p>Causal interpretation requires conditioning on “doing X=x.” For the green-down data, “doing X=x” is achieved by the random treatment assignment of the enclosures. How does random treatment assignment achieve this? Look again at Figure <a href="regression.html#fig:continuous-x-dag">9.2</a>. If the values of <span class="math inline">\(treatment\)</span> are randomly assigned, then, by definition, the expected value of the correlation between <span class="math inline">\(treatment\)</span> and <span class="math inline">\(moisture\)</span> is zero. In fact, the expected value of the correlation between <span class="math inline">\(treatment\)</span> and any measurable variable at the study site is zero. Given, this, the expected value of the regression coefficient for <span class="math inline">\(temperature\)</span> (<span class="math inline">\(b_1\)</span>) is <span class="math inline">\(\beta\)</span> because <span class="math inline">\(\rho=0\)</span>. That is, the estimate of the true effect is unbiased. It doesn’t matter if <span class="math inline">\(moisture\)</span>, or any other variable, is excluded from the model. (That said, we may want to include moisture or other variables in the model to increase precision of the causal effect. This is addressed in the chapter “Models with Covariates”). This is what an experiment does and why experiments are used to answer causal questions.</p>
<p>Can we use observational data for causal modeling? Yes, but the methods for this are outside of the scope of this text. The mathematical foundation for this is known as <strong>path analysis</strong>, which was developed by geneticist and evolutionary biologist Sewell Wright (I include this because this work has inspired much of how I think about biology and because he is both my academic grandfather and great-grandfather). Causal analysis of observational data in biology is rare outside of ecology and epidemiology. Good starting points for the modern development of causal analysis are <a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/" target="_blank">Hernán MA and Robins JM (2020)</a> and <a href="https://www.annualreviews.org/doi/abs/10.1146/annurev-genom-083117-021731" target="_blank">Burgess et al. (2018)</a>. A gentle introduction is <a href="https://www.basicbooks.com/titles/judea-pearl/the-book-of-why/9780465097609/" target="_blank">Pearl and Mackenzie (2018)</a>.</p>
</div>
</div>
<div id="using-a-regression-model-for-prediction-prediction-models" class="section level3" number="9.1.4">
<h3><span class="header-section-number">9.1.4</span> Using a regression model for prediction – prediction models</h3>
<p>The researchers in the green-down study also presented estimates of the effect of temperature on green-down using two observational datasets. Let’s use the one in Extended Data Figure 3d to explore using a regression model for prediction. The data are taken from measurements of the day of green-down over an 86 year period at a single site. The response variable is <span class="math inline">\(green\_down\_anomaly\)</span> (the difference between the day of green down for the year and the mean of these days over the 86 years). The predictor variable is <span class="math inline">\(autumn\_temp\_anomaly\)</span> (the difference between the mean temperature over the year and the mean of these means).</p>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-pred-fig-1.png" width="576" /></p>
<p>The plot in figure <a href="#fig:continuous-x-pred-fig"><strong>??</strong></a> shows the regression line of a linear model fit to the data. Two statistics are given in the plot.</p>
<ol style="list-style-type: decimal">
<li>The <em>p</em>-value of the slope (the coefficient <span class="math inline">\(b_1\)</span> of <span class="math inline">\(autumn\_temp\_anomaly\)</span>)</li>
<li>The <span class="math inline">\(R^2\)</span> of the model fit.</li>
</ol>
<p>In addition, two intervals are shown.</p>
<ol style="list-style-type: decimal">
<li>95% <strong>confidence interval</strong> of the expected values in blue. The width of this band is a measure of the precision of the estimates of expected values.</li>
<li>95% <strong>prediction interval</strong> of the predictions in gray. The width of this band is a measure of how well the model predicts.</li>
</ol>
<p>It is important that researchers knows what each of these statistics and bands are, when to compute them and when to ignore them them, and what to say about each when communicating the results.</p>
<div id="ci-and-p-value" class="section level4" number="9.1.4.1">
<h4><span class="header-section-number">9.1.4.1</span> 95% CI and <em>p</em>-value</h4>
<p>Both the 95% confidence interval of the expected values and the <em>p</em>-value are a function of the standard error of the slope coefficient <span class="math inline">\(b_1\)</span> and so are complimentary statistics. The <em>p</em>-value is the probability of sampling the null that results in a <span class="math inline">\(t\)</span>-value as or more extreme than the observed <em>t</em> for the coefficient <span class="math inline">\(b_1\)</span>. This null includes the hypothesis <span class="math inline">\(\beta_1 = 0\)</span>. The 95% confidence interval of the expected values is the band containing expected values (mean <span class="math inline">\(green\_down\_anomaly\)</span> conditional on <span class="math inline">\(autumn\_temp\_anomaly\)</span>) that are compatible with the data. There are a couple of useful ways of thinking about this band.</p>
<ol style="list-style-type: decimal">
<li>The band captures an infinite number of regression lines that are compatible with the data. Some are more steep and predict smaller expected values at the low end of <span class="math inline">\(autumn\_temp\_anomaly\)</span> and higher expected values at the high end of <span class="math inline">\(autumn\_temp\_anomaly\)</span>. Others are less steep and predict higher expected values at the low end of <span class="math inline">\(autumn\_temp\_anomaly\)</span> and lower expected values at the high end of <span class="math inline">\(autumn\_temp\_anomaly\)</span>.</li>
<li>The band captures the 95% CI of the conditional mean at every value of <span class="math inline">\(X\)</span>. Consider the 95% CI of the conditional mean at the mean value of <span class="math inline">\(X\)</span>. As we move away from this mean value (lower to higher <span class="math inline">\(X\)</span>), the 95% CI of the conditional mean increases.</li>
</ol>
<p>A 95% CI and <em>p</em>-value are useful statistics to report if the purpose is <em>causal modeling</em>, as in the example above using the experimental green-down data (where the 95% CI was not presented as a confidence band of the expected values but a CI of the estimate of the effect of added temperature). A 95% CI and <em>p</em>-value are also useful statistics to report if the purpose is <em>descriptive modeling</em>, simply wanting to know how the conditional mean of the response is related to an <span class="math inline">\(X\)</span> variable.</p>
</div>
<div id="prediction-interval-and-r2" class="section level4" number="9.1.4.2">
<h4><span class="header-section-number">9.1.4.2</span> 95% prediction interval and <span class="math inline">\(R^2\)</span></h4>
<p>Both the <span class="math inline">\(R^2\)</span> and the 95% prediction interval are a function of the <em>population</em> variability of <span class="math inline">\(green\_down\_anomaly\)</span> conditional on <span class="math inline">\(autumn\_temp\_anomaly\)</span> (the spread of points along a vertical axis about the regression line) and are complimentary statistics. Briefly,</p>
<ol style="list-style-type: decimal">
<li>the <span class="math inline">\(R^2\)</span> is a measure of the fraction of the variance in the response that is accounted by the model (some sources say “explained by the model” but this is an odd use of “explain”). It is a number between 0 and 1 and is a measure of “predictability” if the goal is prediction modeling.</li>
<li>The 95% prediction interval will contain a new observation 95% of the time. It provides bounds on a <strong>prediction</strong> – given a new observation, there is a 95% probability that the interval at <span class="math inline">\(x_{new}\)</span> will contain <span class="math inline">\(y_{new}\)</span>.</li>
</ol>
<p>To understand <span class="math inline">\(R^2\)</span> and the 95% prediction interval a bit better, let’s back up.</p>
<p><span class="math display">\[\begin{equation}
green\_down\_anomaly_i = b_0 + b_1 autumn\_temp\_anomaly_i + e_i
(\#eq:doy_fit)
\end{equation}\]</span></p>
<p>Model @ref(eq:eq:doy_fit) recovers the measured value of <span class="math inline">\(green\_down\_anomaly\)</span> for any year, given the <span class="math inline">\(autumn\_temp\_anomaly\)</span> for the year. The equation includes the linear predictor (<span class="math inline">\(b_0 + b_1 autumn\_temp\_anomaly_i\)</span>) and the <strong>residual</strong> from the predictor (<span class="math inline">\(e_i\)</span>). The predictor part of @ref(eq:doy_fit) is used to compute <span class="math inline">\(\hat{y}\)</span> (“y hat”).</p>
<p><span class="math display">\[\begin{equation}
\hat{y}_i = b_0 + b_1 autumn\_temp\_anomaly_i
(\#eq:doy_hat)
\end{equation}\]</span></p>
<p>The <span class="math inline">\(\hat{y}\)</span> are <strong>fitted values</strong>, if the values are computed from the data that were used for the fit, or <strong>predicted values</strong> (or simply the <strong>prediction</strong>), if the values are computed from values of the predictor variables outside the set used to fit the model. For the purpose of plotting, generally, with models with categorical factors as <span class="math inline">\(X\)</span>, I prefer either <strong>modeled values</strong> or <strong>conditional means</strong> to fitted values.</p>
</div>
<div id="r2" class="section level4" number="9.1.4.3">
<h4><span class="header-section-number">9.1.4.3</span> <span class="math inline">\(R^2\)</span></h4>
<p>A good model accounts for a sizable fraction of the total variance in the response. This fraction is the <span class="math inline">\(R^2\)</span> value, which is given in <code>summary(m1)</code> and accessed directly with</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="regression.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.1305754</code></pre>
<p><span class="math inline">\(R^2\)</span> is the fraction of the total variance of <span class="math inline">\(Y\)</span> that is generated by the linear predictor.</p>
<p><span class="math display">\[\begin{equation}
R^2 = \frac{\mathrm{VAR}(\hat{y})}{\mathrm{VAR}(y)}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="regression.html#cb236-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(m1)</span>
<span id="cb236-2"><a href="regression.html#cb236-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> efig_3d[, green_down_anomaly]</span>
<span id="cb236-3"><a href="regression.html#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(yhat)<span class="sc">/</span><span class="fu">var</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.1305754</code></pre>
<p><span class="math inline">\(R^2\)</span> will vary from zero (the model accounts for nothing) to one (the model accounts for everything). <span class="math inline">\(R^2\)</span> is often described as the fraction of total variation <em>explained</em> by the model" but the usage of “explain” is observational and not causal. Because of the ambiguous usage of “explain” in statistics, I prefer to avoid the word.</p>
<p>It can be useful sometimes to think of <span class="math inline">\(R^2\)</span> in terms of <strong>residual error</strong>, which is the variance of the residuals from the model. The larger the residual error, the smaller the <span class="math inline">\(R^2\)</span>, or</p>
<p><span class="math display">\[\begin{equation}
R^2 = 1 - \frac{\mathrm{VAR}(e)}{\mathrm{VAR}(y)}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="regression.html#cb238-1" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">residuals</span>(m1)</span>
<span id="cb238-2"><a href="regression.html#cb238-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> efig_3d[, green_down_anomaly]</span>
<span id="cb238-3"><a href="regression.html#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">var</span>(e)<span class="sc">/</span><span class="fu">var</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.1305754</code></pre>
<p>The smaller the residuals, the higher the <span class="math inline">\(R^2\)</span> and the closer the predicted values are to the measured values. The sum of the model variance and residual variance equals the total variance and, consequently, <span class="math inline">\(R^2\)</span> is a signal to signal + noise ratio. The noise in <span class="math inline">\(R^2\)</span> is the sampling variance of the individual measures. The noise in a <em>t</em>-value is the sampling variance of the parameter (for m1, this is the sampling variance of <span class="math inline">\(b_1\)</span>). This is an important distinction because it means that <em>t</em> and <span class="math inline">\(R^2\)</span> are not related 1:1. In a simple model with only a single <span class="math inline">\(X\)</span>, one might expect <span class="math inline">\(R^2\)</span> to be big if the <em>p</em>-value for the slope is tiny, but this isn’t necessarily true because of the different meaning of noise in each. A study with a very large sample size <span class="math inline">\(n\)</span> can have a tiny <em>p</em>-value <em>and</em> a small <span class="math inline">\(R^2\)</span>. A <em>p</em>-value is not a good indicator of predictability. <span class="math inline">\(R^2\)</span> is. This is explored more below.</p>
</div>
<div id="prediction-interval" class="section level4" number="9.1.4.4">
<h4><span class="header-section-number">9.1.4.4</span> Prediction interval</h4>
<p>A good prediction model has high predictability, meaning the range of predicted values is narrow. A 95% CI is a reasonable range to communicate. For any decision making using prediction, it is better to look at numbers than a band on a plot.</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
Autumn Temp Anomaly (°C)
</th>
<th style="text-align:right;">
Expected (days)
</th>
<th style="text-align:right;">
2.5% (days)
</th>
<th style="text-align:right;">
97.5% (days)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
-8.7
</td>
<td style="text-align:right;">
10.3
</td>
</tr>
<tr>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1.6
</td>
<td style="text-align:right;">
-7.9
</td>
<td style="text-align:right;">
11.1
</td>
</tr>
<tr>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
2.4
</td>
<td style="text-align:right;">
-7.2
</td>
<td style="text-align:right;">
12.0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
-6.4
</td>
<td style="text-align:right;">
12.8
</td>
</tr>
<tr>
<td style="text-align:right;">
2.5
</td>
<td style="text-align:right;">
4.0
</td>
<td style="text-align:right;">
-5.7
</td>
<td style="text-align:right;">
13.7
</td>
</tr>
</tbody>
</table>
<p>Given these data and the fit model, if we see a 2 °C increase in mean fall temperature, we expect the autumn green-down to extend 3.2 days. This expectation is an average. We’d expect 95% of actual values to range between -6.4 days and 12.8 days. This is a lot of variability. Any prediction has a reasonable probability of being over a week early or late. This may seem surprising given the <em>p</em>-value of the fit, which is 0.0006. But the <em>p</em>-value is not a reliable indicator of predictability. It is a statistic related to the blue band, not the gray band.</p>
<p>To understand this prediction interval a bit more, and why a <em>p</em>-value is not a good indicator of predictability, it’s useful to understand what makes a prediction interval “wide.” The width of the prediction interval is a function of two kinds of variability</p>
<ol style="list-style-type: decimal">
<li>The variance of the expected value at a specific value of <span class="math inline">\(X\)</span>. This is the square of the standard error of <span class="math inline">\(b_1\)</span>. The blue band is communicating the CI based on this variance. The <em>p</em>-value is related to the wideth of this band.</li>
<li>The variance of <span class="math inline">\(Y\)</span> at a specific value of <span class="math inline">\(X\)</span>. This variance is <span class="math inline">\(\sigma^2\)</span>. It is useful for learning to think about the equation for the estimate of this variance.</li>
</ol>
<p><span class="math display">\[\begin{equation}
\hat\sigma^2 = \frac{\sum{e_i^2}}{N-2}
\end{equation}\]</span></p>
<p>Again, <span class="math inline">\(e_i\)</span> is the residual for the <em>i</em>th case. The denominator (<span class="math inline">\(N-2\)</span>) is the degrees of freedom of the model. Computing <span class="math inline">\(\hat\sigma^2\)</span> manually helps to insure that we understand what is going on.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="regression.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)<span class="sc">$</span>sigma <span class="co"># R&#39;s calculation of sigma hat</span></span></code></pre></div>
<pre><code>## [1] 4.736643</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="regression.html#cb242-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">summary</span>(m1)<span class="sc">$</span>df[<span class="dv">2</span>] <span class="co"># R&#39;s calculation of df. Check that this is n-2!</span></span>
<span id="cb242-2"><a href="regression.html#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>(e<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>df)</span></code></pre></div>
<pre><code>## [1] 4.736643</code></pre>
<p>Remember that an assumption of the linear models that we are working with at this point is, this variance is constant for all values of <span class="math inline">\(X\)</span>, so we have a single <span class="math inline">\(\sigma\)</span>. Later, we will cover linear models that model heterogeneity in this variance. <span class="math inline">\(\sigma\)</span> is a function of variability in the population – it is the population standard deviation conditional on <span class="math inline">\(X\)</span>.</p>
<p>Importantly, predictability is a function of both these components of variability. As a consequence, it is <span class="math inline">\(R^2\)</span>, and not the <em>p</em>-value, that is the indicator of predictability. In the observational green-down data, even if we had thousands of years of data, we would still have a pretty low <span class="math inline">\(R^2\)</span> because of the population variability of <span class="math inline">\(green\_down\_anomaly\)</span> at a given <span class="math inline">\(autumn\_temp\_anomaly\)</span>.</p>
</div>
<div id="median-absolute-error-and-root-mean-square-error-are-absolute-measures-of-predictability" class="section level4" number="9.1.4.5">
<h4><span class="header-section-number">9.1.4.5</span> Median Absolute Error and Root Mean Square Error are absolute measures of predictability</h4>
<p>A <em>p</em>-value is not <em>at all</em> a good guide to predictability. <span class="math inline">\(R^2\)</span> is proportional to predictability but is not really useful in any absolute sense. If we want to predict the effect of warming on the day of green-down, I would like to have a measure of predictability in the units of green-down, which is days. The prediction interval gives this for any value of <span class="math inline">\(X\)</span>. But what about an overall measure of predictability?</p>
<p>Three overall measures of predictability are</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\hat{\sigma}\)</span>, the estimate of <span class="math inline">\(\sigma\)</span>. This is the standard deviation of the sample conditional on <span class="math inline">\(X\)</span>.</li>
<li><span class="math inline">\(RMSE\)</span>, the root mean squared error. This is</li>
</ol>
<p><span class="math display">\[\begin{align}
SSE &amp;= \sum{(y_i - \hat{y}_i)^2}\\
MSE &amp;= \frac{SSE}{N}\\
RMSE &amp;= \sqrt{MSE}
\end{align}\]</span></p>
<p><span class="math inline">\(SSE\)</span> (“sum of squared error”) is the sum of the squared residuals (<span class="math inline">\(y_i - \hat{y}_i\)</span>) of the model. <span class="math inline">\(MSE\)</span> (“mean squared error”) is the mean of the squared errors. <span class="math inline">\(RMSE\)</span> is the square root of the mean squared error. <span class="math inline">\(RMSE\)</span> is almost equal to <span class="math inline">\(\hat{\sigma}\)</span>. The difference is the denominator, which is <span class="math inline">\(N\)</span> in the computation of <span class="math inline">\(RMSE\)</span> and <span class="math inline">\(df\)</span> (the degrees of freedom of the model, which is <span class="math inline">\(N\)</span> minus the number of fit parameters) in the computation of <span class="math inline">\(\hat{\sigma}\)</span>.</p>
<ol start="3" style="list-style-type: decimal">
<li><span class="math inline">\(MAE\)</span>, the mean absolute error. This is</li>
</ol>
<p><span class="math display">\[\begin{equation}
MAE = \frac{1}{N}\sum{|y_i - \hat{y}_i|}
\end{equation}\]</span></p>
<table>
<thead>
<tr>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
RMSE
</th>
<th style="text-align:right;">
MAE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4.74
</td>
<td style="text-align:right;">
4.68
</td>
<td style="text-align:right;">
3.58
</td>
</tr>
</tbody>
</table>
<p>If the goal of an analysis is prediction, one of these statistics should be reported. For the model fit to the observational green-down data in Extended Figure 3d, these three statistics are given in Table <a href="#table:continuous-x-average-error"><strong>??</strong></a> above (to two decimal places simply to show numerical difference between <span class="math inline">\(\hat{\sigma}\)</span> and <span class="math inline">\(RMSE\)</span>). All of these are measures of an “average” prediction error in the units of the response. The average error is either 4.7 or 3.6 days, depending on which statistic we report. Why the difference? Both <span class="math inline">\(\hat{\sigma}\)</span> and <span class="math inline">\(RMSE\)</span> are functions of squared error and so big differences between predicted and actual value are emphasized. If an error of 6 days is more than twice as bad than an error of 3 days, report <span class="math inline">\(RMSE\)</span>. Why <span class="math inline">\(RMSE\)</span> and not <span class="math inline">\(\hat{\sigma}\)</span>? Simply because researchers using prediction models are more familiar with <span class="math inline">\(RMSE\)</span>. If an error of 6 days is <em>not</em> more than twice as bad than an error of 3 days, report <span class="math inline">\(MAE\)</span>.</p>
</div>
<div id="prediction-modeling-is-more-sophisticated-than-presented-here" class="section level4" number="9.1.4.6">
<h4><span class="header-section-number">9.1.4.6</span> Prediction modeling is more sophisticated than presented here</h4>
<p>For data where the response is a non-linear function of the predictor, or for data with many predictor variables, researchers will often build a model using a <strong>model selection</strong> method. Stepwise regression is a classical model selection method that is commonly taught in intro biostatistics and commonly used by researchers. Stepwise regression as a method of model selection has many well-known problems and should be avoided.</p>
<p>Some <em>excellent</em> books that are useful for building models and model selection are</p>
<ol style="list-style-type: decimal">
<li><a href="https://web.stanford.edu/~hastie/ElemStatLearn/" target="_blank">The Elements of Statistical Learning</a></li>
<li><a href="https://avehtari.github.io/ROS-Examples/" target="_blank">Regression and Other Stories</a></li>
<li><a href="http://hbiostat.org/doc/rms/4day.html" target="_blank">Regression Modeling Strategies</a></li>
</ol>
</div>
</div>
<div id="using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data" class="section level3" number="9.1.5">
<h3><span class="header-section-number">9.1.5</span> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</h3>
<p>In the study in this example, the researchers compared the growth rate of tumors in mice fed normal chow versus mice with a methionine restricted diet. Growth rate wasn’t actually compared. Instead, the researchers used a <em>t</em>-test to compare the size of the tumor measured at six different days. A problem with multiple <em>t</em>-tests for this dataset is that the errors (residuals from the model) on one day are correlated with the errors from another day because of the repeated measures on each mouse. This correlation will inflate Type I error rate.</p>
<p>Instead of six <em>t</em>-tests, a better strategy for these data is to use a regression to calculate a tumor growth rate for each mouse. There are sixteen mice so this is sixteen fit models. Here I use a “for loop” to fit the model to the data from a single mouse and use the slope (<span class="math inline">\(b_1\)</span>) as the estimate of the tumor growth rate for that mouse.</p>
<p>Use a for-loop to estimate growth rate for each mouse. In each pass through the loop</p>
<ol style="list-style-type: decimal">
<li>the subset of fig1f (the data in long format) belonging to mouse <em>i</em> is created</li>
<li>the linear model <code>volume ~ day</code> is fit to the subset</li>
<li>the coefficient of day (the slope, <span class="math inline">\(b_1\)</span>) is inserted in mouse <em>i</em>’s row in the column “growth” in the data.table “fig1f_wide.”</li>
</ol>
<p>At the end of the loop, we have the data.table fig1f_wide which has one row for each mouse, a column for the treatment factor (diet) and a column called “growth” containing each mouse’s growth rate. There are also columns of tumor volume for each mouse on each day but these are ignored.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="regression.html#cb244-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(fig1f_wide)</span>
<span id="cb244-2"><a href="regression.html#cb244-2" aria-hidden="true" tabindex="-1"></a>id_list <span class="ot">&lt;-</span> fig1f_wide[, id]</span>
<span id="cb244-3"><a href="regression.html#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb244-4"><a href="regression.html#cb244-4" aria-hidden="true" tabindex="-1"></a>  mouse_i_data <span class="ot">&lt;-</span> fig1f[id <span class="sc">==</span> id_list[i]] <span class="co"># subset</span></span>
<span id="cb244-5"><a href="regression.html#cb244-5" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(volume <span class="sc">~</span> day, <span class="at">data =</span> mouse_i_data)</span>
<span id="cb244-6"><a href="regression.html#cb244-6" aria-hidden="true" tabindex="-1"></a>  fig1f_wide[id <span class="sc">==</span> id_list[i], growth <span class="sc">:</span><span class="er">=</span> <span class="fu">coef</span>(fit)[<span class="dv">2</span>]]</span>
<span id="cb244-7"><a href="regression.html#cb244-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb244-8"><a href="regression.html#cb244-8" aria-hidden="true" tabindex="-1"></a><span class="co"># View(fig1f_wide)</span></span>
<span id="cb244-9"><a href="regression.html#cb244-9" aria-hidden="true" tabindex="-1"></a><span class="co"># qplot(x = treatment, y = growth, data = fig1f_wide)</span></span>
<span id="cb244-10"><a href="regression.html#cb244-10" aria-hidden="true" tabindex="-1"></a><span class="co"># qplot(x = day, y = volume, color = treatment, data = fig1f) + geom_smooth(aes(group = id), method = &quot;lm&quot;, se = FALSE)</span></span></code></pre></div>
<p>Step 3. <strong>fit the model</strong></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="regression.html#cb245-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> treatment, <span class="at">data =</span> fig1f_wide)</span></code></pre></div>
<p>Step 5. <strong>inference from the model</strong></p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="regression.html#cb246-1" aria-hidden="true" tabindex="-1"></a>m1_coef <span class="ot">&lt;-</span> <span class="fu">summary</span>(m1) <span class="sc">%&gt;%</span></span>
<span id="cb246-2"><a href="regression.html#cb246-2" aria-hidden="true" tabindex="-1"></a>  coef</span>
<span id="cb246-3"><a href="regression.html#cb246-3" aria-hidden="true" tabindex="-1"></a>m1_ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1)</span>
<span id="cb246-4"><a href="regression.html#cb246-4" aria-hidden="true" tabindex="-1"></a>(m1_coef_table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(m1_coef, m1_ci))</span></code></pre></div>
<pre><code>##              Estimate Std. Error   t value     Pr(&gt;|t|)     2.5 %    97.5 %
## (Intercept)  52.63406   3.102096 16.967258 9.865155e-11  45.98072  59.28739
## treatmentMR -23.57616   4.387026 -5.374065 9.809457e-05 -32.98540 -14.16693</code></pre>
<p>Step 6. <strong>plot the model</strong></p>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-long-plot-1.png" width="576" /></p>
</div>
<div id="using-a-regression-model-for-for-calibration" class="section level3" number="9.1.6">
<h3><span class="header-section-number">9.1.6</span> Using a regression model for for calibration</h3>
</div>
</div>
<div id="working-in-r-1" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Working in R</h2>
<div id="fit-the-model" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Fitting the linear model</h3>
<p>A linear model is fit with the <code>lm</code> function, which is very flexible and will be a workhorse in much of this text.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="regression.html#cb248-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(transition_date <span class="sc">~</span> temperature, <span class="at">data =</span> fig2c)</span></code></pre></div>
<p>m1 is an lm model object that contains many different kinds information, such as the model coefficients.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="regression.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m1)</span></code></pre></div>
<pre><code>## (Intercept) temperature 
##  289.458750    4.982745</code></pre>
<p>We’ll return to others, but first, let’s explore some of the flexibility of the <code>lm</code> function. Two arguments were sent to the function</p>
<ol style="list-style-type: decimal">
<li>the model formula <code>transition_date ~ temperature</code> with the form <code>Y ~ X</code>, where Y and X are names of columns in the data.</li>
</ol>
<ul>
<li>The model formula itself can be assigned to a variable, which is useful when building functions. An example</li>
</ul>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="regression.html#cb251-1" aria-hidden="true" tabindex="-1"></a>coef_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, data){</span>
<span id="cb251-2"><a href="regression.html#cb251-2" aria-hidden="true" tabindex="-1"></a>  m1_form <span class="ot">&lt;-</span> <span class="fu">formula</span>(<span class="fu">paste</span>(y, <span class="st">&quot;~&quot;</span>, x))</span>
<span id="cb251-3"><a href="regression.html#cb251-3" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m1_form, <span class="at">data =</span> data)</span>
<span id="cb251-4"><a href="regression.html#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(m1)))</span>
<span id="cb251-5"><a href="regression.html#cb251-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb251-6"><a href="regression.html#cb251-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-7"><a href="regression.html#cb251-7" aria-hidden="true" tabindex="-1"></a><span class="fu">coef_table</span>(<span class="at">x =</span> <span class="st">&quot;temperature&quot;</span>,</span>
<span id="cb251-8"><a href="regression.html#cb251-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="st">&quot;transition_date&quot;</span>,</span>
<span id="cb251-9"><a href="regression.html#cb251-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> fig2c)</span></code></pre></div>
<pre><code>##               Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 289.458750  3.0593949 94.613071 1.738650e-13
## temperature   4.982745  0.5541962  8.990941 1.866888e-05</code></pre>
<ul>
<li>Both Y and X can also be column names embedded within a function, for example</li>
</ul>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="regression.html#cb253-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(transition_date) <span class="sc">~</span> temperature, <span class="at">data =</span> fig2c)</span>
<span id="cb253-2"><a href="regression.html#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m2)</span></code></pre></div>
<pre><code>## (Intercept) temperature 
##   5.6690276   0.0160509</code></pre>
<p>or</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="regression.html#cb255-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">scale</span>(transition_date) <span class="sc">~</span> <span class="fu">scale</span>(temperature), <span class="at">data =</span> fig2c)</span>
<span id="cb255-2"><a href="regression.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m3)</span></code></pre></div>
<pre><code>##        (Intercept) scale(temperature) 
##       6.484929e-16       9.539117e-01</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>The data frame (remember that a data.table is a data frame) containing the columns with the variable names in the model formula. A data argument is not necessary but it is usually the better way (an exception is when a researcher wants to create a matrix of Y variables or to construct their own model matrix)</li>
</ol>
<p>type <code>?lm</code> into the console to see other arguments of the <code>lm</code> function.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="regression.html#cb257-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> fig2[, temperature]</span>
<span id="cb257-2"><a href="regression.html#cb257-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> fig2[, transition_date]</span>
<span id="cb257-3"><a href="regression.html#cb257-3" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb257-4"><a href="regression.html#cb257-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m4)</span></code></pre></div>
<pre><code>## (Intercept)           x 
## 204.8866185   0.4324755</code></pre>
</div>
<div id="getting-to-know-the-linear-model-the-summary-function" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Getting to know the linear model: the <code>summary</code> function</h3>
<p>The <code>lm</code> function returns an <code>lm</code> object, which we’ve assigned to the name <code>m1</code>. <code>m1</code> contains lots of information about our fit of the linear model to the data. Most of the information that we want for most purposes can be retrieved with the <code>summary</code> function, which is a general-purpose R command the works with many R objects.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="regression.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = transition_date ~ temperature, data = fig2c)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.5062 -3.8536  0.6645  2.7537  9.0074 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 289.4588     3.0594  94.613 1.74e-13 ***
## temperature   4.9827     0.5542   8.991 1.87e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.443 on 8 degrees of freedom
## Multiple R-squared:  0.9099, Adjusted R-squared:  0.8987 
## F-statistic: 80.84 on 1 and 8 DF,  p-value: 1.867e-05</code></pre>
<p>What is here:</p>
<p><strong>Call</strong>. This is the model that was fit</p>
<p><strong>Residuals</strong>. This is a summary of the distribution of the residuals. From this one can get a sense of the distribution (for inference, the model assumes a normal distribution with mean zero). More useful ways to examine this distribution will be introduced later in this chapter.</p>
<p><strong>Coefficients table</strong>. This contains the linear model coefficients and their standard error and associated <span class="math inline">\(t\)</span> and <span class="math inline">\(p\)</span> values.</p>
<ol style="list-style-type: decimal">
<li>The column of values under “Estimate” are the coefficients of the fitted model (equation <a href="regression.html#eq:continuous-x-fit">(9.1)</a>). Here, 289.4587503 is the intercept (<span class="math inline">\(b_0\)</span>) and 4.9827453 is the effect of <span class="math inline">\(temperature\)</span> (<span class="math inline">\(b_1\)</span>).</li>
<li>The column of values under “Std. Error” are the standard errors of the coefficients.</li>
<li>The column of values under “t value” are the <em>t-statistics</em> for each coefficient. A <em>t</em>-value is a <strong>signal to noise ratio</strong>. The coefficient <span class="math inline">\(b_1\)</span> is the “signal” and the SE is the noise. Get used to thinking about this ratio. A <em>t</em>-value greater than about 3 indicates a “pretty good” signal relative to noise, while one much below than 2 is not.</li>
<li>The column of values under “Pr(&gt;|t|)” is the <em>p</em>-value, which is the t-test of the estimate. What is the <em>p</em>-value a test of? The <em>p</em>-value tests the hypothesis “how probable are the data, or more extreme than than the data, if the true parameter is zero?” Formally <span class="math inline">\(p = \mathrm{freq(t&#39; \ge t|H_o)}\)</span>, where <span class="math inline">\(t&#39;\)</span> is the hypothetical <em>t</em>-value, <em>t</em> is the observed <span class="math inline">\(t\)</span>-value, and <span class="math inline">\(H_o\)</span> is the null hypothesis. We will return to <em>p</em>-values in Chapter xxx.</li>
</ol>
<p><strong>Signif. codes</strong>. Significance codes are extremely common in the wet bench experimental biology literature but do not have much to recommend. I’ll return to these in the <em>p</em>-values chapter.</p>
<p>Beneath the Signif. codes are some model statistics which are useful</p>
<p><strong>Residual standard error</strong> This is <span class="math inline">\(\sqrt{\sum{e_i^2}/(n-2)}\)</span>, where <span class="math inline">\(e_i\)</span> are the residuals in the fitted model. “degrees of freedom” is the number of <span class="math inline">\(e_i\)</span> that are “allowed to vary” after fitting the parameters, so is the total sample size (<span class="math inline">\(n\)</span>) minus the number of parameters in the model. The fit model has two fit parameters (<span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> so the df is <span class="math inline">\(n-2\)</span>. Note that this is the denominator in the residual standard error equation.</p>
<p><strong>Multiple R-squared</strong>. This is an important but imperfect summary measure of the whole model that effectively measures how much of the total variance in the response variable “is explained by” the model. Its value lies between zero and 1. <strong>It’s a good measure to report in a manuscript</strong>, especially for observational data.</p>
<p><strong>F-statistic and p-value</strong>. These are statistics for the whole model (not the individual coefficients) and I just don’t find these very useful.</p>
</div>
<div id="inference-the-coefficient-table" class="section level3" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Inference – the coefficient table</h3>
<p>There are different ways of</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="regression.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step by step</span></span>
<span id="cb261-2"><a href="regression.html#cb261-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-3"><a href="regression.html#cb261-3" aria-hidden="true" tabindex="-1"></a>m1_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(m1) <span class="co"># get summary</span></span>
<span id="cb261-4"><a href="regression.html#cb261-4" aria-hidden="true" tabindex="-1"></a>m1_coef_p1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(m1_summary) <span class="co"># extract coefficient table</span></span>
<span id="cb261-5"><a href="regression.html#cb261-5" aria-hidden="true" tabindex="-1"></a>m1_coef_p2 <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1) <span class="co"># get CIs</span></span>
<span id="cb261-6"><a href="regression.html#cb261-6" aria-hidden="true" tabindex="-1"></a>m1_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(m1_coef_p1, m1_coef_p2) <span class="co"># column bind the two</span></span>
<span id="cb261-7"><a href="regression.html#cb261-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-8"><a href="regression.html#cb261-8" aria-hidden="true" tabindex="-1"></a><span class="co"># this can be shortened (but still readable) using</span></span>
<span id="cb261-9"><a href="regression.html#cb261-9" aria-hidden="true" tabindex="-1"></a>m1_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(m1)),</span>
<span id="cb261-10"><a href="regression.html#cb261-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">confint</span>(m1))</span>
<span id="cb261-11"><a href="regression.html#cb261-11" aria-hidden="true" tabindex="-1"></a>m1_coef</span></code></pre></div>
<pre><code>##               Estimate Std. Error   t value     Pr(&gt;|t|)      2.5 %     97.5 %
## (Intercept) 289.458750  3.0593949 94.613071 1.738650e-13 282.403773 296.513728
## temperature   4.982745  0.5541962  8.990941 1.866888e-05   3.704767   6.260724</code></pre>
<p>Note that the <em>p</em>-value for the coefficient for <em>temperature</em> is very small and we could conclude that the data are not compatible with a model of no temperature effect on day of green-down. But did we need a formal hypothesis test for this? We haven’t learned much if we have only learned that the slope is “not likely to be exactly zero” (Temperature effects everything in biology). A far more important question is not <em>if</em> there is a relationship between <em>temperature</em> and <em>day</em> of green-down, but what is the sign and magnitude of the effect and what is the uncertainty in our estimate of this effect. For this, we we want the coefficient and its SE or confidence interval, both of which are in this table. Remember, our working definition of a confidence interval:</p>
<p><strong>A confidence interval contains the range of parameter values that are compatible with the data, in the sense that a <span class="math inline">\(t\)</span>-test would not reject the null hypothesis of a difference between the estimate and any value within the interval</strong></p>
<p>A more textbook way of defining a CI is: A 95% CI of a parameter has a 95% probability of including the true value of the parameter. It does not mean that there is a 95% probability that the true value lies in the interval. This is a subtle but important difference. Here is a way of thinking about the proper meaning of the textbook definition: we don’t know the true value of <span class="math inline">\(\beta_1\)</span> but we can 1) repeat the experiment or sampling, 2) re-estimate <span class="math inline">\(\beta_1\)</span>, and 3) re-compute a 95% CI. If we do 1-3 many times, 95% of the CIs will include <span class="math inline">\(\beta_1\)</span> within the interval.</p>
<p>Confidence intervals are often interpreted like <span class="math inline">\(p\)</span>-values. That is, the researcher looks to see if the CI overlaps with zero and if it does, concludes there is “no effect.” First, this conclusion is not correct – <strong>the inability to find sufficient evidence for an effect does not mean there is no effect, it simply means there is insufficient evidence to conclude there is an effect</strong>!</p>
<p>Second, what we want to use the CI for is to guide us about how big or small the effect might reasonably be, given the data. Again, A CI is a measure of parameter values that are “compatible” with the data. If our biological interpretations at the small-end and at the big-end of the interval’s range radically differ, then we don’t have enough <em>precision</em> in our analysis to reach an unambiguous conclusion.</p>
</div>
<div id="how-good-is-our-model-model-checking" class="section level3" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> How good is our model? – Model checking</h3>
<p>There are two, quite different senses of what is meant by a good model.</p>
<ol style="list-style-type: decimal">
<li>How good is the model at predicting? Or, how much of the variance in the response (the stuff to be “explained”) is accounted for by the model? This was described above.</li>
<li>How well do the data look like a sample from the modeled distribution? If not well, we should consider alternative models. This is <strong>model checking</strong>.</li>
</ol>
<p>For inference, a good model generates data that look like the real data. If this is true, our fit model will have well-behaved residuals. There are several aspects of “well-behaved” and each is checked with a diagnostic plot. This <strong>model checking</strong> is covered in more detail in chapter xxx.</p>
<p>Inference from model <a href="regression.html#eq:continuous-x-m1">(9.2)</a> assumes the data were sampled from a normal distribution. To check this, use a quantile-quantile or <strong>Q-Q plot</strong>. The <code>qqPlot</code> function from the car package generates a more useful plot than that from Base R.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="regression.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb263-2"><a href="regression.html#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(m1, <span class="at">id=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-123-1.png" width="576" /></p>
<p>Approximately normal residuals will track the solid line and stay largely within the boundaries marked by the dashed lines. The residuals from m1 fit to the green-down data track the solid line and remain within the dashed lines, indicating adequate model fit.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>Note that a formal test of normality is often recommended. Formal tests do not add value above a diagnostic check. Robustness of inference (for example, a <em>p</em>-value) is a function of the type and degree of “non-normalness,” not of a p-value. For a small sample, there is not much power to test for normality, so samples from non-normal distributions pass the test (<span class="math inline">\(p &gt; 0.05\)</span>) and are deemed “normal.” For large samples, samples from distributions that deviate slightly from normal fail the test (<span class="math inline">\(p &lt; 0.05\)</span>) and are deemed “not normal.” Inference with many non-normal samples with large <span class="math inline">\(n\)</span> are very robust (meaning infernece is not likely to fool you with randomness).</p>
</div>
<p>Inference from model <a href="regression.html#eq:continuous-x-m1">(9.2)</a> assumes homogeneity of the response conditional on <span class="math inline">\(X\)</span>. For a continuous <span class="math inline">\(X\)</span>, this means the residuals should have approximately equal variance at low, mid, and high values of <span class="math inline">\(X\)</span> (and everywhere in between). One can visually inspect the spread of points in the <span class="math inline">\(Y\)</span> direction across the groups for categorical <span class="math inline">\(X\)</span> or along the <em>X</em>-axis for continuous <span class="math inline">\(X\)</span>. A useful method for checking how residual variance changes (usually increases) with the conditional mean of <span class="math inline">\(Y\)</span> is a <strong>spread-location plot</strong>. The <code>spreadLevelPlot(m1)</code> function from the car package is useful.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="regression.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spreadLevelPlot</span>(m1)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-124-1.png" width="576" /></p>
<pre><code>## 
## Suggested power transformation:  0.6721303</code></pre>
<p>The dashed blue line shows linear trends while the magenta line shows non-linear trends. For the green-down data, the dashed line is very flat while the magenta-line shows what looks like random fluctations. Taken together, the two lines indicate adequate model fit.</p>
</div>
<div id="plotting-models-with-continuous-x" class="section level3" number="9.2.5">
<h3><span class="header-section-number">9.2.5</span> Plotting models with continuous <em>X</em></h3>
<div id="quick-plot" class="section level4" number="9.2.5.1">
<h4><span class="header-section-number">9.2.5.1</span> Quick plot</h4>
<p><code>qplot</code> from the ggplot package is useful for initial examinations of the data</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="regression.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> transition_date, <span class="at">data =</span> fig2c) <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-125-1.png" width="576" /></p>
<p>Some variations of this quick plot to explore include</p>
<ol style="list-style-type: decimal">
<li>use <code>geom_smooth(method = "lm")</code></li>
</ol>
</div>
<div id="ggpubr-plots" class="section level4" number="9.2.5.2">
<h4><span class="header-section-number">9.2.5.2</span> ggpubr plots</h4>
<p>ggpubr is a package with functions that automates the construction of publication-ready ggplots. <code>ggscatter</code> can generate a publishable plot with little effort.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="regression.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(<span class="at">data =</span> fig2c,</span>
<span id="cb267-2"><a href="regression.html#cb267-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;temperature&quot;</span>,</span>
<span id="cb267-3"><a href="regression.html#cb267-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;transition_date&quot;</span>,</span>
<span id="cb267-4"><a href="regression.html#cb267-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>,</span>
<span id="cb267-5"><a href="regression.html#cb267-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;Added Temperature (°C)&quot;</span>,</span>
<span id="cb267-6"><a href="regression.html#cb267-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;Day of Green-down (DOY)&quot;</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-126-1.png" width="576" /></p>
<p>It take only a little more effort to add useful modifications.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="regression.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(<span class="at">data =</span> fig2c,</span>
<span id="cb268-2"><a href="regression.html#cb268-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;temperature&quot;</span>,</span>
<span id="cb268-3"><a href="regression.html#cb268-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;transition_date&quot;</span>,</span>
<span id="cb268-4"><a href="regression.html#cb268-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb268-5"><a href="regression.html#cb268-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb268-6"><a href="regression.html#cb268-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb268-7"><a href="regression.html#cb268-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb268-8"><a href="regression.html#cb268-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>,</span>
<span id="cb268-9"><a href="regression.html#cb268-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb268-10"><a href="regression.html#cb268-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> <span class="st">&quot;lightgray&quot;</span>),</span>
<span id="cb268-11"><a href="regression.html#cb268-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb268-12"><a href="regression.html#cb268-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;Added Temperature (°C)&quot;</span>,</span>
<span id="cb268-13"><a href="regression.html#cb268-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;Day of Green-down (DOY)&quot;</span>) <span class="sc">+</span></span>
<span id="cb268-14"><a href="regression.html#cb268-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb268-15"><a href="regression.html#cb268-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_regline_equation</span>(<span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb268-16"><a href="regression.html#cb268-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label.y =</span> <span class="dv">340</span>) <span class="sc">+</span></span>
<span id="cb268-17"><a href="regression.html#cb268-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..rr.label.., ..p.label.., <span class="at">sep =</span> <span class="st">&quot;~`,`~&quot;</span>)),</span>
<span id="cb268-18"><a href="regression.html#cb268-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb268-19"><a href="regression.html#cb268-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">label.y =</span> <span class="dv">335</span>) <span class="sc">+</span></span>
<span id="cb268-20"><a href="regression.html#cb268-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-21"><a href="regression.html#cb268-21" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-127-1.png" width="576" /></p>
<p>Notes</p>
<ol class="example" style="list-style-type: decimal">
<li>The interval shown is the 95% confidence interval of the expected values, which is what we want to communicate with the experimental green-down data. Were we to want to use this as a prediction model, we would want the 95% prediction interval. I’m not sure that ggpubr can plot a prediction interval. To see how I plotted the prediction interval in Figure <a href="#fig:continuous-x-pred-fig"><strong>??</strong></a> above, see the Hidden Code section below.</li>
<li>The arguments of the <code>ggscatter</code> function are typed in explicitly (<code>x = "temperarture"</code> and not just <code>"temperature"</code>). Each argument starts on a new line to increase readability.</li>
<li>The <code>+</code> after the <code>ggscatter</code> function adds additional layers to the plot. Each additional component is started on a new line to increase readability.</li>
<li>The first line of the <code>stat_cor</code> function (everything within <code>aes()</code>) plots the <span class="math inline">\(R^2\)</span> instead of the correlation coefficient <span class="math inline">\(r\)</span>. Copy and pasting this whole line just works.</li>
<li>Comment out the line of the ggplot script starting with <code>stat_cor</code> and re-run (comment out by inserting a <code>#</code> at the front of the line. A consistent way to do this is to triple-click the line to highlight the line and then type command-shift-c on Mac OS). The script runs without error because <code>NULL</code> has been added as the final plot component. Adding “NULL” is a useful trick.</li>
</ol>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="regression.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(<span class="at">data =</span> efig_3d,</span>
<span id="cb269-2"><a href="regression.html#cb269-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;autumn_temp_anomaly&quot;</span>,</span>
<span id="cb269-3"><a href="regression.html#cb269-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;green_down_anomaly&quot;</span>,</span>
<span id="cb269-4"><a href="regression.html#cb269-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb269-5"><a href="regression.html#cb269-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb269-6"><a href="regression.html#cb269-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb269-7"><a href="regression.html#cb269-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb269-8"><a href="regression.html#cb269-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>,</span>
<span id="cb269-9"><a href="regression.html#cb269-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb269-10"><a href="regression.html#cb269-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> <span class="st">&quot;lightgray&quot;</span>),</span>
<span id="cb269-11"><a href="regression.html#cb269-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb269-12"><a href="regression.html#cb269-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;Added Temperature (°C)&quot;</span>,</span>
<span id="cb269-13"><a href="regression.html#cb269-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;Day of Green-down (DOY)&quot;</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-128-1.png" width="576" /></p>
</div>
<div id="ggplots" class="section level4" number="9.2.5.3">
<h4><span class="header-section-number">9.2.5.3</span> ggplots</h4>
<p>Use <code>ggplot</code> from the ggplot2 package for full control of plots. See the Hidden Code below for how I generated the plots in Figure <a href="regression.html#fig:continuous-x-plot">9.1</a> above.</p>
</div>
</div>
<div id="creating-a-table-of-predicted-values-and-95-prediction-intervals" class="section level3" number="9.2.6">
<h3><span class="header-section-number">9.2.6</span> Creating a table of predicted values and 95% prediction intervals</h3>
<p>efig_3d is the data.table created from importing the data in Extended Data Figure 3d above. The fit model is</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="regression.html#cb270-1" aria-hidden="true" tabindex="-1"></a>efig3d_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(green_down_anomaly <span class="sc">~</span> autumn_temp_anomaly, <span class="at">data =</span> efig_3d)</span></code></pre></div>
<p>The <code>predict(efig3d_m1)</code> function is used to compute either fitted or predicted values, and either the confidence or prediction interval of these values.</p>
<p>Unless specified by <code>newdata</code>, the default x-values used to generate the y in <code>predict(efig3d_m1)</code> are the x-values in the data used to fit the model. The returned values are the expected value for each <span class="math inline">\(x_i\)</span> in the data. The argument <code>newdata</code> passes a data.frame (remember a data.table is a data.frame!) with new x-values. Since these x-values were not in the data used to fit the model, the returned <span class="math inline">\(y_{hat}\)</span> are predicted values.</p>
<p>The range of x-values in the data is</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="regression.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(efig_3d[,autumn_temp_anomaly])</span></code></pre></div>
<pre><code>## [1] -2.673793  2.568045</code></pre>
<p>Let’s get predicted values for a value of <span class="math inline">\(autumn\_temp\_anomaly = 2\)</span>.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="regression.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(efig3d_m1, <span class="at">newdata =</span> <span class="fu">data.table</span>(<span class="at">autumn_temp_anomaly =</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>##        1 
## 3.192646</code></pre>
<p>And predicted values across the range of measured values</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="regression.html#cb275-1" aria-hidden="true" tabindex="-1"></a>new_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">autumn_temp_anomaly =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb275-2"><a href="regression.html#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(efig3d_m1, <span class="at">newdata =</span> new_dt)</span></code></pre></div>
<pre><code>##         1         2         3         4 
## -3.192646 -1.596323  1.596323  3.192646</code></pre>
<p>Add 95% confidence intervals (this could be used to create the band for plotting)</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="regression.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(efig3d_m1, </span>
<span id="cb277-2"><a href="regression.html#cb277-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata =</span> new_dt,</span>
<span id="cb277-3"><a href="regression.html#cb277-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>,</span>
<span id="cb277-4"><a href="regression.html#cb277-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">se.fit =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span></code></pre></div>
<pre><code>##         fit        lwr        upr
## 1 -3.192646 -5.2485713 -1.1367215
## 2 -1.596323 -2.9492686 -0.2433778
## 3  1.596323  0.2433778  2.9492686
## 4  3.192646  1.1367215  5.2485713</code></pre>
<p>Change to the 95% prediction intervals</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="regression.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(efig3d_m1, </span>
<span id="cb279-2"><a href="regression.html#cb279-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata =</span> new_dt,</span>
<span id="cb279-3"><a href="regression.html#cb279-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>,</span>
<span id="cb279-4"><a href="regression.html#cb279-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">se.fit =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span></code></pre></div>
<pre><code>##         fit        lwr       upr
## 1 -3.192646 -12.833739  6.448446
## 2 -1.596323 -11.112325  7.919679
## 3  1.596323  -7.919679 11.112325
## 4  3.192646  -6.448446 12.833739</code></pre>
<p>Put this all together in a pretty table. I’ve used knitr’s <code>kable</code> function but there are table packages in R that allow extensive control of the output.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="regression.html#cb281-1" aria-hidden="true" tabindex="-1"></a>efig3d_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(green_down_anomaly <span class="sc">~</span> autumn_temp_anomaly, <span class="at">data =</span> efig_3d)</span>
<span id="cb281-2"><a href="regression.html#cb281-2" aria-hidden="true" tabindex="-1"></a>new_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">autumn_temp_anomaly =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb281-3"><a href="regression.html#cb281-3" aria-hidden="true" tabindex="-1"></a>prediction_table <span class="ot">&lt;-</span> <span class="fu">predict</span>(efig3d_m1, </span>
<span id="cb281-4"><a href="regression.html#cb281-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">newdata =</span> new_dt,</span>
<span id="cb281-5"><a href="regression.html#cb281-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>,</span>
<span id="cb281-6"><a href="regression.html#cb281-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">se.fit =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span>
<span id="cb281-7"><a href="regression.html#cb281-7" aria-hidden="true" tabindex="-1"></a>prediction_table <span class="ot">&lt;-</span> <span class="fu">data.table</span>(new_dt, prediction_table)</span>
<span id="cb281-8"><a href="regression.html#cb281-8" aria-hidden="true" tabindex="-1"></a>pretty_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Autumn Temp Anomaly&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;2.5%&quot;</span>, <span class="st">&quot;97.5%&quot;</span>)</span>
<span id="cb281-9"><a href="regression.html#cb281-9" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(prediction_table, <span class="at">old =</span> <span class="fu">colnames</span>(prediction_table), <span class="at">new =</span> pretty_names)</span>
<span id="cb281-10"><a href="regression.html#cb281-10" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(prediction_table, <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
Autumn Temp Anomaly
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
97.5%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
-3.2
</td>
<td style="text-align:right;">
-12.8
</td>
<td style="text-align:right;">
6.4
</td>
</tr>
<tr>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1.6
</td>
<td style="text-align:right;">
-11.1
</td>
<td style="text-align:right;">
7.9
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.6
</td>
<td style="text-align:right;">
-7.9
</td>
<td style="text-align:right;">
11.1
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
-6.4
</td>
<td style="text-align:right;">
12.8
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="hidden-code" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Hidden code</h2>
<div id="import-and-plot-of-fig2c-ecosystem-warming-experimental-data" class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Import and plot of fig2c (ecosystem warming experimental) data</h3>
<p>Import</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="regression.html#cb282-1" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Ecosystem warming extends vegetation activity but heightens vulnerability to cold temperatures&quot;</span></span>
<span id="cb282-2"><a href="regression.html#cb282-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41586_2018_399_MOESM3_ESM.xlsx&quot;</span></span>
<span id="cb282-3"><a href="regression.html#cb282-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb282-4"><a href="regression.html#cb282-4" aria-hidden="true" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path) <span class="sc">%&gt;%</span> <span class="co"># import</span></span>
<span id="cb282-5"><a href="regression.html#cb282-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> <span class="co"># clean the column names</span></span>
<span id="cb282-6"><a href="regression.html#cb282-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="co"># convert to data.table</span></span>
<span id="cb282-7"><a href="regression.html#cb282-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View(fig2)</span></span>
<span id="cb282-8"><a href="regression.html#cb282-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-9"><a href="regression.html#cb282-9" aria-hidden="true" tabindex="-1"></a>fig2c <span class="ot">&lt;-</span> fig2[panel <span class="sc">==</span> <span class="st">&quot;2c&quot;</span>,]</span>
<span id="cb282-10"><a href="regression.html#cb282-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(fig2c)</span></span></code></pre></div>
<p>Creating the response plot (the bottom component)</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="regression.html#cb283-1" aria-hidden="true" tabindex="-1"></a>m1_b <span class="ot">&lt;-</span> <span class="fu">coef</span>(m1)</span>
<span id="cb283-2"><a href="regression.html#cb283-2" aria-hidden="true" tabindex="-1"></a>m1_ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1)</span>
<span id="cb283-3"><a href="regression.html#cb283-3" aria-hidden="true" tabindex="-1"></a>m1_b0_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Intercept: &quot;</span>,</span>
<span id="cb283-4"><a href="regression.html#cb283-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(m1_b[<span class="dv">1</span>],<span class="dv">1</span>),</span>
<span id="cb283-5"><a href="regression.html#cb283-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot; (&quot;</span>,</span>
<span id="cb283-6"><a href="regression.html#cb283-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(m1_ci[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dv">1</span>),</span>
<span id="cb283-7"><a href="regression.html#cb283-7" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;, &quot;</span>,</span>
<span id="cb283-8"><a href="regression.html#cb283-8" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(m1_ci[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dv">1</span>),</span>
<span id="cb283-9"><a href="regression.html#cb283-9" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;) d&quot;</span>)</span>
<span id="cb283-10"><a href="regression.html#cb283-10" aria-hidden="true" tabindex="-1"></a>m1_b1_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Slope: &quot;</span>,</span>
<span id="cb283-11"><a href="regression.html#cb283-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(m1_b[<span class="dv">2</span>],<span class="dv">2</span>),</span>
<span id="cb283-12"><a href="regression.html#cb283-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot; (&quot;</span>,</span>
<span id="cb283-13"><a href="regression.html#cb283-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(m1_ci[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dv">2</span>),</span>
<span id="cb283-14"><a href="regression.html#cb283-14" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;, &quot;</span>,</span>
<span id="cb283-15"><a href="regression.html#cb283-15" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(m1_ci[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dv">2</span>),</span>
<span id="cb283-16"><a href="regression.html#cb283-16" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;) d per 1 °C&quot;</span>)</span>
<span id="cb283-17"><a href="regression.html#cb283-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-18"><a href="regression.html#cb283-18" aria-hidden="true" tabindex="-1"></a><span class="co"># regression line</span></span>
<span id="cb283-19"><a href="regression.html#cb283-19" aria-hidden="true" tabindex="-1"></a>m1_x <span class="ot">&lt;-</span> <span class="fu">min</span>(fig2c[, temperature])</span>
<span id="cb283-20"><a href="regression.html#cb283-20" aria-hidden="true" tabindex="-1"></a>m1_xend <span class="ot">&lt;-</span> <span class="fu">max</span>(fig2c[, temperature])</span>
<span id="cb283-21"><a href="regression.html#cb283-21" aria-hidden="true" tabindex="-1"></a>m1_y <span class="ot">&lt;-</span> m1_b[<span class="dv">1</span>] <span class="sc">+</span> m1_b[<span class="dv">2</span>]<span class="sc">*</span>m1_x</span>
<span id="cb283-22"><a href="regression.html#cb283-22" aria-hidden="true" tabindex="-1"></a>m1_yend <span class="ot">&lt;-</span> m1_b[<span class="dv">1</span>] <span class="sc">+</span> m1_b[<span class="dv">2</span>]<span class="sc">*</span>m1_xend</span>
<span id="cb283-23"><a href="regression.html#cb283-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-24"><a href="regression.html#cb283-24" aria-hidden="true" tabindex="-1"></a>fig2c_gg_response <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fig2c,</span>
<span id="cb283-25"><a href="regression.html#cb283-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> temperature,</span>
<span id="cb283-26"><a href="regression.html#cb283-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> transition_date)) <span class="sc">+</span></span>
<span id="cb283-27"><a href="regression.html#cb283-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb283-28"><a href="regression.html#cb283-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># regression line first, to not block point</span></span>
<span id="cb283-29"><a href="regression.html#cb283-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> m1_x,</span>
<span id="cb283-30"><a href="regression.html#cb283-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> m1_y,</span>
<span id="cb283-31"><a href="regression.html#cb283-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">xend =</span> m1_xend,</span>
<span id="cb283-32"><a href="regression.html#cb283-32" aria-hidden="true" tabindex="-1"></a>               <span class="at">yend =</span> m1_yend) <span class="sc">+</span></span>
<span id="cb283-33"><a href="regression.html#cb283-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create black edge to points</span></span>
<span id="cb283-34"><a href="regression.html#cb283-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point(size = 4,</span></span>
<span id="cb283-35"><a href="regression.html#cb283-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#            color = &quot;black&quot;) +</span></span>
<span id="cb283-36"><a href="regression.html#cb283-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb283-37"><a href="regression.html#cb283-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pal_okabe_ito[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb283-38"><a href="regression.html#cb283-38" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.25</span>, <span class="fl">4.5</span>, <span class="fl">6.75</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb283-39"><a href="regression.html#cb283-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Plot temperature (ΔT, °C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb283-40"><a href="regression.html#cb283-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Autumn green-down (DOY)&quot;</span>) <span class="sc">+</span></span>
<span id="cb283-41"><a href="regression.html#cb283-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb283-42"><a href="regression.html#cb283-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb283-43"><a href="regression.html#cb283-43" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb283-44"><a href="regression.html#cb283-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-45"><a href="regression.html#cb283-45" aria-hidden="true" tabindex="-1"></a><span class="co"># fig2c_gg_response</span></span></code></pre></div>
<p>Creating the effects plot (the top component)</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="regression.html#cb284-1" aria-hidden="true" tabindex="-1"></a>m1_coeff_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">term =</span> <span class="fu">row.names</span>(m1_coeff),</span>
<span id="cb284-2"><a href="regression.html#cb284-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">data.table</span>(m1_coeff))[<span class="dv">2</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb284-3"><a href="regression.html#cb284-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb284-4"><a href="regression.html#cb284-4" aria-hidden="true" tabindex="-1"></a>m1_coeff_dt[ , p_pretty <span class="sc">:</span><span class="er">=</span> <span class="fu">pvalString</span>(pr_t)]</span>
<span id="cb284-5"><a href="regression.html#cb284-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-6"><a href="regression.html#cb284-6" aria-hidden="true" tabindex="-1"></a>min_bound <span class="ot">&lt;-</span> <span class="fu">min</span>(m1_coeff_dt[, x2_5_percent])</span>
<span id="cb284-7"><a href="regression.html#cb284-7" aria-hidden="true" tabindex="-1"></a>max_bound <span class="ot">&lt;-</span> <span class="fu">min</span>(m1_coeff_dt[, x97_5_percent])</span>
<span id="cb284-8"><a href="regression.html#cb284-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-9"><a href="regression.html#cb284-9" aria-hidden="true" tabindex="-1"></a>y_lo <span class="ot">&lt;-</span> <span class="fu">min</span>(min_bound<span class="sc">+</span>min_bound<span class="sc">*</span><span class="fl">0.2</span>,</span>
<span id="cb284-10"><a href="regression.html#cb284-10" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span>max_bound)</span>
<span id="cb284-11"><a href="regression.html#cb284-11" aria-hidden="true" tabindex="-1"></a>y_hi <span class="ot">&lt;-</span> <span class="fu">max</span>(max_bound <span class="sc">+</span> max_bound<span class="sc">*</span><span class="fl">0.2</span>,</span>
<span id="cb284-12"><a href="regression.html#cb284-12" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span>min_bound)</span>
<span id="cb284-13"><a href="regression.html#cb284-13" aria-hidden="true" tabindex="-1"></a>y_lims <span class="ot">&lt;-</span> <span class="fu">c</span>(y_lo, y_hi)</span>
<span id="cb284-14"><a href="regression.html#cb284-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-15"><a href="regression.html#cb284-15" aria-hidden="true" tabindex="-1"></a>fig2c_gg_effect <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>m1_coeff_dt, </span>
<span id="cb284-16"><a href="regression.html#cb284-16" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> term,</span>
<span id="cb284-17"><a href="regression.html#cb284-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb284-18"><a href="regression.html#cb284-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># confidence level of effect</span></span>
<span id="cb284-19"><a href="regression.html#cb284-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>x2_5_percent, </span>
<span id="cb284-20"><a href="regression.html#cb284-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax=</span>x97_5_percent),</span>
<span id="cb284-21"><a href="regression.html#cb284-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">width=</span><span class="dv">0</span>, </span>
<span id="cb284-22"><a href="regression.html#cb284-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb284-23"><a href="regression.html#cb284-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># estimate of effect</span></span>
<span id="cb284-24"><a href="regression.html#cb284-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb284-25"><a href="regression.html#cb284-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb284-26"><a href="regression.html#cb284-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># zero effect</span></span>
<span id="cb284-27"><a href="regression.html#cb284-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb284-28"><a href="regression.html#cb284-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb284-29"><a href="regression.html#cb284-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p-value</span></span>
<span id="cb284-30"><a href="regression.html#cb284-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb284-31"><a href="regression.html#cb284-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> m1_coeff_dt<span class="sc">$</span>p_pretty,</span>
<span id="cb284-32"><a href="regression.html#cb284-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>,</span>
<span id="cb284-33"><a href="regression.html#cb284-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fl">7.5</span>) <span class="sc">+</span></span>
<span id="cb284-34"><a href="regression.html#cb284-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb284-35"><a href="regression.html#cb284-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># aesthetics</span></span>
<span id="cb284-36"><a href="regression.html#cb284-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position=</span><span class="st">&quot;right&quot;</span>) <span class="sc">+</span></span>
<span id="cb284-37"><a href="regression.html#cb284-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="st">&quot;Temperature</span><span class="sc">\n</span><span class="st">effect&quot;</span>) <span class="sc">+</span></span>
<span id="cb284-38"><a href="regression.html#cb284-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Effects (day/°C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb284-39"><a href="regression.html#cb284-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">ylim =</span> y_lims) <span class="sc">+</span> </span>
<span id="cb284-40"><a href="regression.html#cb284-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb284-41"><a href="regression.html#cb284-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb284-42"><a href="regression.html#cb284-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb284-43"><a href="regression.html#cb284-43" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb284-44"><a href="regression.html#cb284-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-45"><a href="regression.html#cb284-45" aria-hidden="true" tabindex="-1"></a><span class="co">#fig2c_gg_effect</span></span></code></pre></div>
<p>Combining the response and effects plots into single plot</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="regression.html#cb285-1" aria-hidden="true" tabindex="-1"></a>fig3d_fig <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(fig2c_gg_effect,</span>
<span id="cb285-2"><a href="regression.html#cb285-2" aria-hidden="true" tabindex="-1"></a>                       fig2c_gg_response,</span>
<span id="cb285-3"><a href="regression.html#cb285-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nrow=</span><span class="dv">2</span>,</span>
<span id="cb285-4"><a href="regression.html#cb285-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb285-5"><a href="regression.html#cb285-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis =</span> <span class="st">&quot;lr&quot;</span>,</span>
<span id="cb285-6"><a href="regression.html#cb285-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="dv">1</span>))</span>
<span id="cb285-7"><a href="regression.html#cb285-7" aria-hidden="true" tabindex="-1"></a>fig3d_fig</span></code></pre></div>
</div>
<div id="import-and-plot-efig_3d-ecosysem-warming-observational-data" class="section level3" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Import and plot efig_3d (Ecosysem warming observational) data</h3>
<p>Import</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="regression.html#cb286-1" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Ecosystem warming extends vegetation activity but heightens vulnerability to cold temperatures&quot;</span></span>
<span id="cb286-2"><a href="regression.html#cb286-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41586_2018_399_MOESM6_ESM.xlsx&quot;</span></span>
<span id="cb286-3"><a href="regression.html#cb286-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb286-4"><a href="regression.html#cb286-4" aria-hidden="true" tabindex="-1"></a>efig_3d <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb286-5"><a href="regression.html#cb286-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">range =</span> <span class="st">&quot;J2:K87&quot;</span>,</span>
<span id="cb286-6"><a href="regression.html#cb286-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">col_names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="co"># header causing issues</span></span>
<span id="cb286-7"><a href="regression.html#cb286-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="co"># convert to data.table</span></span>
<span id="cb286-8"><a href="regression.html#cb286-8" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(efig_3d, <span class="at">old =</span> <span class="fu">colnames</span>(efig_3d), <span class="at">new =</span> <span class="fu">c</span>(<span class="st">&quot;autumn_temp_anomaly&quot;</span>, <span class="st">&quot;green_down_anomaly&quot;</span>))</span>
<span id="cb286-9"><a href="regression.html#cb286-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-10"><a href="regression.html#cb286-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(efig_3d)</span></span></code></pre></div>
<p>Plot</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="regression.html#cb287-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(green_down_anomaly <span class="sc">~</span> autumn_temp_anomaly, <span class="at">data =</span> efig_3d)</span>
<span id="cb287-2"><a href="regression.html#cb287-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-3"><a href="regression.html#cb287-3" aria-hidden="true" tabindex="-1"></a><span class="co"># get x for drawing slope</span></span>
<span id="cb287-4"><a href="regression.html#cb287-4" aria-hidden="true" tabindex="-1"></a>minx <span class="ot">&lt;-</span> <span class="fu">min</span>(efig_3d[,autumn_temp_anomaly])</span>
<span id="cb287-5"><a href="regression.html#cb287-5" aria-hidden="true" tabindex="-1"></a>maxx <span class="ot">&lt;-</span> <span class="fu">max</span>(efig_3d[,autumn_temp_anomaly])</span>
<span id="cb287-6"><a href="regression.html#cb287-6" aria-hidden="true" tabindex="-1"></a>new_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(minx, maxx, <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb287-7"><a href="regression.html#cb287-7" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">autumn_temp_anomaly =</span> new_x)</span>
<span id="cb287-8"><a href="regression.html#cb287-8" aria-hidden="true" tabindex="-1"></a>new_data[, yhat <span class="sc">:</span><span class="er">=</span> <span class="fu">predict</span>(m1, <span class="at">newdata =</span> new_data)]</span>
<span id="cb287-9"><a href="regression.html#cb287-9" aria-hidden="true" tabindex="-1"></a>new_data[, conf_lwr <span class="sc">:</span><span class="er">=</span> <span class="fu">predict</span>(m1, </span>
<span id="cb287-10"><a href="regression.html#cb287-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb287-11"><a href="regression.html#cb287-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>,</span>
<span id="cb287-12"><a href="regression.html#cb287-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">newdata =</span> new_data)<span class="sc">$</span>fit[, <span class="st">&quot;lwr&quot;</span>]]</span>
<span id="cb287-13"><a href="regression.html#cb287-13" aria-hidden="true" tabindex="-1"></a>new_data[, conf_upr <span class="sc">:</span><span class="er">=</span> <span class="fu">predict</span>(m1, </span>
<span id="cb287-14"><a href="regression.html#cb287-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb287-15"><a href="regression.html#cb287-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>,</span>
<span id="cb287-16"><a href="regression.html#cb287-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">newdata =</span> new_data)<span class="sc">$</span>fit[, <span class="st">&quot;upr&quot;</span>]]</span>
<span id="cb287-17"><a href="regression.html#cb287-17" aria-hidden="true" tabindex="-1"></a>new_data[, pred_lwr <span class="sc">:</span><span class="er">=</span> <span class="fu">predict</span>(m1, </span>
<span id="cb287-18"><a href="regression.html#cb287-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb287-19"><a href="regression.html#cb287-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>,</span>
<span id="cb287-20"><a href="regression.html#cb287-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">newdata =</span> new_data)<span class="sc">$</span>fit[, <span class="st">&quot;lwr&quot;</span>]]</span>
<span id="cb287-21"><a href="regression.html#cb287-21" aria-hidden="true" tabindex="-1"></a>new_data[, pred_upr <span class="sc">:</span><span class="er">=</span> <span class="fu">predict</span>(m1, </span>
<span id="cb287-22"><a href="regression.html#cb287-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb287-23"><a href="regression.html#cb287-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>,</span>
<span id="cb287-24"><a href="regression.html#cb287-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">newdata =</span> new_data)<span class="sc">$</span>fit[, <span class="st">&quot;upr&quot;</span>]]</span>
<span id="cb287-25"><a href="regression.html#cb287-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-26"><a href="regression.html#cb287-26" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(<span class="at">data =</span> efig_3d,</span>
<span id="cb287-27"><a href="regression.html#cb287-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;autumn_temp_anomaly&quot;</span>,</span>
<span id="cb287-28"><a href="regression.html#cb287-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;green_down_anomaly&quot;</span>,</span>
<span id="cb287-29"><a href="regression.html#cb287-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb287-30"><a href="regression.html#cb287-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb287-31"><a href="regression.html#cb287-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb287-32"><a href="regression.html#cb287-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>,</span>
<span id="cb287-33"><a href="regression.html#cb287-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb287-34"><a href="regression.html#cb287-34" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> <span class="st">&quot;lightgray&quot;</span>),</span>
<span id="cb287-35"><a href="regression.html#cb287-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;Temperature Anomaly (°C)&quot;</span>,</span>
<span id="cb287-36"><a href="regression.html#cb287-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;Day of Green-down Anomaly (DOY)&quot;</span>) <span class="sc">+</span></span>
<span id="cb287-37"><a href="regression.html#cb287-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-38"><a href="regression.html#cb287-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> new_data,</span>
<span id="cb287-39"><a href="regression.html#cb287-39" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> pred_lwr,</span>
<span id="cb287-40"><a href="regression.html#cb287-40" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> pred_upr,</span>
<span id="cb287-41"><a href="regression.html#cb287-41" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> yhat,</span>
<span id="cb287-42"><a href="regression.html#cb287-42" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">&quot;band&quot;</span>),</span>
<span id="cb287-43"><a href="regression.html#cb287-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb287-44"><a href="regression.html#cb287-44" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb287-45"><a href="regression.html#cb287-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb287-46"><a href="regression.html#cb287-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> new_data,</span>
<span id="cb287-47"><a href="regression.html#cb287-47" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> conf_lwr,</span>
<span id="cb287-48"><a href="regression.html#cb287-48" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> conf_upr,</span>
<span id="cb287-49"><a href="regression.html#cb287-49" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> yhat,</span>
<span id="cb287-50"><a href="regression.html#cb287-50" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">&quot;band&quot;</span>), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb287-51"><a href="regression.html#cb287-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb287-52"><a href="regression.html#cb287-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..rr.label.., ..p.label.., <span class="at">sep =</span> <span class="st">&quot;~`,`~&quot;</span>)),</span>
<span id="cb287-53"><a href="regression.html#cb287-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb287-54"><a href="regression.html#cb287-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">label.y =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb287-55"><a href="regression.html#cb287-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb287-56"><a href="regression.html#cb287-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal_okabe_ito) <span class="sc">+</span></span>
<span id="cb287-57"><a href="regression.html#cb287-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-58"><a href="regression.html#cb287-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb287-59"><a href="regression.html#cb287-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-60"><a href="regression.html#cb287-60" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span>  </span>
<span id="cb287-61"><a href="regression.html#cb287-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-62"><a href="regression.html#cb287-62" aria-hidden="true" tabindex="-1"></a>gg</span></code></pre></div>
</div>
<div id="import-and-plot-of-fig1f-methionine-restriction-data" class="section level3" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Import and plot of fig1f (methionine restriction) data</h3>
<p>Import</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="regression.html#cb288-1" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Dietary methionine influences therapy in mouse cancer models and alters human metabolism&quot;</span></span>
<span id="cb288-2"><a href="regression.html#cb288-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41586_2019_1437_MOESM2_ESM.xlsx&quot;</span></span>
<span id="cb288-3"><a href="regression.html#cb288-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb288-4"><a href="regression.html#cb288-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-5"><a href="regression.html#cb288-5" aria-hidden="true" tabindex="-1"></a>fig1f_wide <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb288-6"><a href="regression.html#cb288-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;f&quot;</span>,</span>
<span id="cb288-7"><a href="regression.html#cb288-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">range =</span> <span class="st">&quot;B7:R12&quot;</span>,</span>
<span id="cb288-8"><a href="regression.html#cb288-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col_names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb288-9"><a href="regression.html#cb288-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="co"># convert to data.table</span></span>
<span id="cb288-10"><a href="regression.html#cb288-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-11"><a href="regression.html#cb288-11" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(fig1f_wide,</span>
<span id="cb288-12"><a href="regression.html#cb288-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">old =</span> <span class="fu">colnames</span>(fig1f_wide),</span>
<span id="cb288-13"><a href="regression.html#cb288-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">c</span>(<span class="st">&quot;day&quot;</span>,</span>
<span id="cb288-14"><a href="regression.html#cb288-14" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">paste0</span>(<span class="st">&quot;Cn_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>),</span>
<span id="cb288-15"><a href="regression.html#cb288-15" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">paste0</span>(<span class="st">&quot;MR_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)))</span>
<span id="cb288-16"><a href="regression.html#cb288-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-17"><a href="regression.html#cb288-17" aria-hidden="true" tabindex="-1"></a>fig1f_wide <span class="ot">&lt;-</span> <span class="fu">transpose</span>(fig1f_wide, <span class="at">make.names =</span> <span class="dv">1</span>, <span class="at">keep.names =</span> <span class="st">&quot;id&quot;</span>)</span>
<span id="cb288-18"><a href="regression.html#cb288-18" aria-hidden="true" tabindex="-1"></a>fig1f_wide[, treatment <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(<span class="fu">substr</span>(id, <span class="dv">1</span>, <span class="dv">2</span>))]</span>
<span id="cb288-19"><a href="regression.html#cb288-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-20"><a href="regression.html#cb288-20" aria-hidden="true" tabindex="-1"></a>days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">25</span>, <span class="dv">28</span>, <span class="dv">30</span>, <span class="dv">34</span>, <span class="dv">39</span>)</span>
<span id="cb288-21"><a href="regression.html#cb288-21" aria-hidden="true" tabindex="-1"></a>fig1f <span class="ot">&lt;-</span> <span class="fu">melt</span>(fig1f_wide,</span>
<span id="cb288-22"><a href="regression.html#cb288-22" aria-hidden="true" tabindex="-1"></a>              id.vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;id&quot;</span>),</span>
<span id="cb288-23"><a href="regression.html#cb288-23" aria-hidden="true" tabindex="-1"></a>              measure.vars <span class="ot">&lt;-</span> <span class="fu">as.character</span>(days),</span>
<span id="cb288-24"><a href="regression.html#cb288-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">variable.name =</span> <span class="st">&quot;day&quot;</span>,</span>
<span id="cb288-25"><a href="regression.html#cb288-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">value.name =</span> <span class="st">&quot;volume&quot;</span>)</span>
<span id="cb288-26"><a href="regression.html#cb288-26" aria-hidden="true" tabindex="-1"></a>fig1f[, day <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(day))]</span>
<span id="cb288-27"><a href="regression.html#cb288-27" aria-hidden="true" tabindex="-1"></a><span class="co"># View(fig1f)</span></span>
<span id="cb288-28"><a href="regression.html#cb288-28" aria-hidden="true" tabindex="-1"></a><span class="co"># qplot(x = day, y = volume, color = treatment, data = fig1f) + geom_line(aes(group = id))</span></span></code></pre></div>
<p>Creating the response plot (the bottom component)</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="regression.html#cb289-1" aria-hidden="true" tabindex="-1"></a>fig1f_gg_response <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fig1f,</span>
<span id="cb289-2"><a href="regression.html#cb289-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> volume, <span class="at">color =</span> treatment)) <span class="sc">+</span></span>
<span id="cb289-3"><a href="regression.html#cb289-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb289-4"><a href="regression.html#cb289-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> id), <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb289-5"><a href="regression.html#cb289-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Day&quot;</span>) <span class="sc">+</span></span>
<span id="cb289-6"><a href="regression.html#cb289-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(Tumor<span class="sc">~</span>Volume<span class="sc">~</span>(mm<span class="sc">^</span><span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb289-7"><a href="regression.html#cb289-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> pal_okabe_ito) <span class="sc">+</span></span>
<span id="cb289-8"><a href="regression.html#cb289-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb289-9"><a href="regression.html#cb289-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb289-10"><a href="regression.html#cb289-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">98</span>),</span>
<span id="cb289-11"><a href="regression.html#cb289-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>),</span>
<span id="cb289-12"><a href="regression.html#cb289-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.just =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb289-13"><a href="regression.html#cb289-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>),</span>
<span id="cb289-14"><a href="regression.html#cb289-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb289-15"><a href="regression.html#cb289-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb289-16"><a href="regression.html#cb289-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-17"><a href="regression.html#cb289-17" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb289-18"><a href="regression.html#cb289-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-19"><a href="regression.html#cb289-19" aria-hidden="true" tabindex="-1"></a><span class="co"># fig1f_gg_response</span></span></code></pre></div>
<p>Creating the effects plot (the top component)</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="regression.html#cb290-1" aria-hidden="true" tabindex="-1"></a>m1_coeff_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">term =</span> <span class="fu">row.names</span>(m1_coef_table),</span>
<span id="cb290-2"><a href="regression.html#cb290-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">data.table</span>(m1_coef_table))[<span class="dv">2</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb290-3"><a href="regression.html#cb290-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb290-4"><a href="regression.html#cb290-4" aria-hidden="true" tabindex="-1"></a>m1_coeff_dt[ , p_pretty <span class="sc">:</span><span class="er">=</span> <span class="fu">pvalString</span>(pr_t)]</span>
<span id="cb290-5"><a href="regression.html#cb290-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-6"><a href="regression.html#cb290-6" aria-hidden="true" tabindex="-1"></a>min_bound <span class="ot">&lt;-</span> <span class="fu">min</span>(m1_coeff_dt[, x2_5_percent])</span>
<span id="cb290-7"><a href="regression.html#cb290-7" aria-hidden="true" tabindex="-1"></a>max_bound <span class="ot">&lt;-</span> <span class="fu">min</span>(m1_coeff_dt[, x97_5_percent])</span>
<span id="cb290-8"><a href="regression.html#cb290-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-9"><a href="regression.html#cb290-9" aria-hidden="true" tabindex="-1"></a>y_lo <span class="ot">&lt;-</span> <span class="fu">min</span>(min_bound<span class="sc">+</span>min_bound<span class="sc">*</span><span class="fl">0.2</span>,</span>
<span id="cb290-10"><a href="regression.html#cb290-10" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span>max_bound)</span>
<span id="cb290-11"><a href="regression.html#cb290-11" aria-hidden="true" tabindex="-1"></a>y_hi <span class="ot">&lt;-</span> <span class="fu">max</span>(max_bound <span class="sc">+</span> max_bound<span class="sc">*</span><span class="fl">0.2</span>,</span>
<span id="cb290-12"><a href="regression.html#cb290-12" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span>min_bound)</span>
<span id="cb290-13"><a href="regression.html#cb290-13" aria-hidden="true" tabindex="-1"></a>y_lims <span class="ot">&lt;-</span> <span class="fu">c</span>(y_lo, y_hi)</span>
<span id="cb290-14"><a href="regression.html#cb290-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-15"><a href="regression.html#cb290-15" aria-hidden="true" tabindex="-1"></a>fig1f_gg_effect <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>m1_coeff_dt, </span>
<span id="cb290-16"><a href="regression.html#cb290-16" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> term,</span>
<span id="cb290-17"><a href="regression.html#cb290-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb290-18"><a href="regression.html#cb290-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># confidence level of effect</span></span>
<span id="cb290-19"><a href="regression.html#cb290-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>x2_5_percent, </span>
<span id="cb290-20"><a href="regression.html#cb290-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax=</span>x97_5_percent),</span>
<span id="cb290-21"><a href="regression.html#cb290-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">width=</span><span class="dv">0</span>, </span>
<span id="cb290-22"><a href="regression.html#cb290-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb290-23"><a href="regression.html#cb290-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># estimate of effect</span></span>
<span id="cb290-24"><a href="regression.html#cb290-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb290-25"><a href="regression.html#cb290-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb290-26"><a href="regression.html#cb290-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># zero effect</span></span>
<span id="cb290-27"><a href="regression.html#cb290-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb290-28"><a href="regression.html#cb290-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb290-29"><a href="regression.html#cb290-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p-value</span></span>
<span id="cb290-30"><a href="regression.html#cb290-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb290-31"><a href="regression.html#cb290-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> m1_coeff_dt<span class="sc">$</span>p_pretty,</span>
<span id="cb290-32"><a href="regression.html#cb290-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>,</span>
<span id="cb290-33"><a href="regression.html#cb290-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fl">7.5</span>) <span class="sc">+</span></span>
<span id="cb290-34"><a href="regression.html#cb290-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb290-35"><a href="regression.html#cb290-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># aesthetics</span></span>
<span id="cb290-36"><a href="regression.html#cb290-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position=</span><span class="st">&quot;right&quot;</span>) <span class="sc">+</span></span>
<span id="cb290-37"><a href="regression.html#cb290-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="st">&quot;MR</span><span class="sc">\n</span><span class="st">effect&quot;</span>) <span class="sc">+</span></span>
<span id="cb290-38"><a href="regression.html#cb290-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(Growth<span class="sc">~</span>(mm<span class="sc">^</span><span class="dv">3</span><span class="sc">/</span>day))) <span class="sc">+</span></span>
<span id="cb290-39"><a href="regression.html#cb290-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">ylim =</span> y_lims) <span class="sc">+</span> </span>
<span id="cb290-40"><a href="regression.html#cb290-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb290-41"><a href="regression.html#cb290-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb290-42"><a href="regression.html#cb290-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb290-43"><a href="regression.html#cb290-43" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb290-44"><a href="regression.html#cb290-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-45"><a href="regression.html#cb290-45" aria-hidden="true" tabindex="-1"></a><span class="co">#fig1f_gg_effect</span></span></code></pre></div>
<p>Combining the response and effects plots into single plot</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="regression.html#cb291-1" aria-hidden="true" tabindex="-1"></a>fig1f_gg <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(fig1f_gg_effect,</span>
<span id="cb291-2"><a href="regression.html#cb291-2" aria-hidden="true" tabindex="-1"></a>                      fig1f_gg_response,</span>
<span id="cb291-3"><a href="regression.html#cb291-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">nrow=</span><span class="dv">2</span>,</span>
<span id="cb291-4"><a href="regression.html#cb291-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb291-5"><a href="regression.html#cb291-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">axis =</span> <span class="st">&quot;lr&quot;</span>,</span>
<span id="cb291-6"><a href="regression.html#cb291-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="dv">1</span>))</span>
<span id="cb291-7"><a href="regression.html#cb291-7" aria-hidden="true" tabindex="-1"></a>fig1f_gg</span></code></pre></div>
</div>
</div>
<div id="try-it" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Try it</h2>
<div id="a-prediction-model-from-the-literature" class="section level3" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> A prediction model from the literature</h3>
<p>The data come from the top, middle plot of Figure 1e of</p>
<p><a href="https://idp.nature.com/authorize/casa?redirect_uri=https://www.nature.com/articles/s41586-019-0984-y&amp;casa_token=9rpBLACc40cAAAAA:BzRKQHYdU9DOrzBS0f0lwrbp07MlfVqqL4yuyedE5b_xZ8geHuUCPFIDE3yQUBO-ibQLCrCI4t84aO8" target="_blank">Parker, B.L., Calkin, A.C., Seldin, M.M., Keating, M.F., Tarling, E.J., Yang, P., Moody, S.C., Liu, Y., Zerenturk, E.J., Needham, E.J. and Miller, M.L., 2019. An integrative systems genetic analysis of mammalian lipid metabolism. Nature, 567(7747), pp.187-193.</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6656374/" target="_blank">Public source</a></p>
<p><a href="https://www.nature.com/articles/s41586-019-0984-y#Sec35" target="_blank">Source data</a></p>
<p>The researchers built prediction models from a hybrid mouse diversity panel (HMDP) to predict liver lipid levels from measured plasma lipid levels in mice <em>and</em> in humans. The value of the predictor (<span class="math inline">\(X\)</span>) variable for an individual is not a measured value of a single plasma lipid but the predicted value, or <strong>score</strong>, from the prediction model based on an entire panel of lipid measurements in that individual. The <span class="math inline">\(Y\)</span> variable for the individual is the total measured level across a family of lipids (ceramides, triacylglycerols, diacylglycerols) in the liver of the individual. The question is, how well does the prediction score predict the actual liver level?</p>
<ol style="list-style-type: decimal">
<li>Use the data for TG (triacylglycerols) (the top, middle plot of Figure 1e). The column D is the “score” from the prediction model using plasma lipid levels. This is the <span class="math inline">\(X\)</span> variable (the column header is “fitted.total.Cer”). The column E is the total measured liver TG, so is the <span class="math inline">\(Y\)</span> variable.</li>
<li>Fit the linear model y ~ x.</li>
<li>Create a publication-quality plot of liver TG (<em>Y</em>-axis) against score (<em>X</em>-axis) – what the researchers labeled “fitted.total.Cer.” Include <span class="math inline">\(R^2\)</span> on the plot.</li>
<li>Advanced – add a 95% prediction interval to the plot (the template code for this is in the Hidden Code section for efig3d)</li>
<li>Create a table of expected liver TG and 95% prediction interval of liver TG of the score values (13.5, 14, 14.5, 15, 15.5, 16).</li>
<li>Comment on the predictability of liver TG using the plasma scores.</li>
</ol>
<p>`</p>
</div>
</div>
<div id="intuition-pumps" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Intuition pumps</h2>
<div id="correlation-and-r2" class="section level3" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> Correlation and $R^2</h3>
<p>In the code below</p>
<ol style="list-style-type: decimal">
<li>change the value of <code>n</code> to explore effect on the variability of the estimate. Look at this variability, and the magnitude of the SE, and the magnitude of the p-value.</li>
<li>change the value of <code>beta_1</code> to explore effect on what different slopes and correlations look like. Notice that if the variance is fixed (as in this simulation) the expected slope and expected correlation are equal. (Because I’ve fixed the variance in this simple simulation, this code will fail if abs(beta_1) &gt;= 1).</li>
</ol>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="regression.html#cb292-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># choose between 3 and 10^5</span></span>
<span id="cb292-2"><a href="regression.html#cb292-2" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fl">0.6</span> <span class="co"># choose a value between -0.99 and 0.99</span></span>
<span id="cb292-3"><a href="regression.html#cb292-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb292-4"><a href="regression.html#cb292-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> beta_1<span class="sc">*</span>x <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>beta_1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">rnorm</span>(n)</span>
<span id="cb292-5"><a href="regression.html#cb292-5" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb292-6"><a href="regression.html#cb292-6" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;b_1: &quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(m1)[<span class="dv">2</span>], <span class="dv">3</span>))</span>
<span id="cb292-7"><a href="regression.html#cb292-7" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;SE: &quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(m1))[<span class="dv">2</span>,<span class="dv">2</span>], <span class="dv">3</span>))</span>
<span id="cb292-8"><a href="regression.html#cb292-8" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;r: &quot;</span>, <span class="fu">round</span>(<span class="fu">cor</span>(x,y), <span class="dv">3</span>))</span>
<span id="cb292-9"><a href="regression.html#cb292-9" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;R^2: &quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared, <span class="dv">3</span>))</span>
<span id="cb292-10"><a href="regression.html#cb292-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(<span class="at">data =</span> <span class="fu">data.table</span>(<span class="at">x=</span>x, <span class="at">y=</span>y), <span class="at">x =</span> <span class="st">&quot;x&quot;</span>, <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb292-11"><a href="regression.html#cb292-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>) <span class="sc">+</span></span>
<span id="cb292-12"><a href="regression.html#cb292-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="fu">paste</span>(slope,se,r,r2,<span class="at">sep=</span><span class="st">&quot;;  &quot;</span>))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-138-1.png" width="576" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="an-introduction-to-linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="oneway.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/22-continuous_X.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
