<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Linear models with a single, continuous X (“regression”) | Applied Statistics for Experimental Biology</title>
  <meta name="description" content="An introduction to statistical modeling for experimental biology researchers" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Linear models with a single, continuous X (“regression”) | Applied Statistics for Experimental Biology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Linear models with a single, continuous X (“regression”) | Applied Statistics for Experimental Biology" />
  
  <meta name="twitter:description" content="An introduction to statistical modeling for experimental biology researchers" />
  

<meta name="author" content="Copyright 2018 Jeffrey A. Walker" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro-linear-models.html"/>
<link rel="next" href="oneway.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elements of Applied Biostatistics</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="index.html#why-bother-with-linear-models-arent-t-tests-and-anova-good-enough" id="toc-why-bother-with-linear-models-arent-t-tests-and-anova-good-enough">Why bother with linear models – aren’t <em>t</em>-tests and ANOVA good enough?</a></li>
<li><a href="index.html#what-is-unusual-about-this-book" id="toc-what-is-unusual-about-this-book">What is unusual about this book?</a></li>
</ul></li>
<li><a href="a-table-of-models.html#a-table-of-models" id="toc-a-table-of-models">A Table of Models</a>
<ul>
<li><a href="a-table-of-models.html#including-mapping-between-linear-models-and-classical-tests" id="toc-including-mapping-between-linear-models-and-classical-tests">including mapping between linear models and classical tests</a></li>
</ul></li>
<li><a href="ask1-intro.html#ask1-intro" id="toc-ask1-intro"><span class="toc-section-number">1</span> Analyzing experimental data with a linear model</a>
<ul>
<li><a href="ask1-intro.html#this-text-is-about-using-linear-models-to-estimate-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect" id="toc-this-text-is-about-using-linear-models-to-estimate-treatment-effects-and-the-uncertainty-in-our-estimates.-this-raises-the-question-what-is-an-effect"><span class="toc-section-number">1.1</span> This text is about using linear models to estimate treatment effects and the uncertainty in our estimates. This, raises the question, what is “an effect”?</a></li>
</ul></li>
<li><a href="part-i-getting-started.html#part-i-getting-started" id="toc-part-i-getting-started">Part I: Getting Started</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#getting-started-r-projects-and-r-markdown" id="toc-getting-started-r-projects-and-r-markdown"><span class="toc-section-number">2</span> Getting Started – R Projects and R Markdown</a>
<ul>
<li><a href="getting-started-r-projects-and-r-markdown.html#r-vs-r-studio" id="toc-r-vs-r-studio"><span class="toc-section-number">2.1</span> R vs R Studio</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#download-and-install-r-and-r-studio" id="toc-download-and-install-r-and-r-studio"><span class="toc-section-number">2.2</span> Download and install R and R studio</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#open-r-studio-and-modify-the-workspace-preference" id="toc-open-r-studio-and-modify-the-workspace-preference"><span class="toc-section-number">2.3</span> Open R Studio and modify the workspace preference</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it" id="toc-if-you-didnt-modify-the-workspace-preferences-from-the-previous-section-go-back-and-do-it"><span class="toc-section-number">2.4</span> If you didn’t modify the workspace preferences from the previous section, go back and do it</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#r-markdown-in-a-nutshell" id="toc-r-markdown-in-a-nutshell"><span class="toc-section-number">2.5</span> R Markdown in a nutshell</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#install-r-markdown" id="toc-install-r-markdown"><span class="toc-section-number">2.6</span> Install R Markdown</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#importing-packages" id="toc-importing-packages"><span class="toc-section-number">2.7</span> Importing Packages</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#setup-create-project" id="toc-setup-create-project"><span class="toc-section-number">2.8</span> Create an R Studio Project for this textbook</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#working-on-a-project-in-a-nutshell" id="toc-working-on-a-project-in-a-nutshell"><span class="toc-section-number">2.9</span> Working on a project, in a nutshell</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#setup-create-rmd" id="toc-setup-create-rmd"><span class="toc-section-number">2.10</span> Create and setup an R Markdown document (Rmd)</a>
<ul>
<li><a href="getting-started-r-projects-and-r-markdown.html#modify-the-yaml-header" id="toc-modify-the-yaml-header"><span class="toc-section-number">2.10.1</span> Modify the yaml header</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#modify-the-setup-chunk" id="toc-modify-the-setup-chunk"><span class="toc-section-number">2.10.2</span> Modify the “setup” chunk</a></li>
</ul></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#lets-play-around-with-an-r-markdown-file" id="toc-lets-play-around-with-an-r-markdown-file"><span class="toc-section-number">2.11</span> Let’s play around with an R Markdown file</a>
<ul>
<li><a href="getting-started-r-projects-and-r-markdown.html#create-a-fake-data-chunk" id="toc-create-a-fake-data-chunk"><span class="toc-section-number">2.11.1</span> Create a “fake-data” chunk</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#create-a-plot-chunk" id="toc-create-a-plot-chunk"><span class="toc-section-number">2.11.2</span> Create a “plot” chunk</a></li>
<li><a href="getting-started-r-projects-and-r-markdown.html#knit-the-rmd" id="toc-knit-the-rmd"><span class="toc-section-number">2.11.3</span> Knit the Rmd</a></li>
</ul></li>
</ul></li>
<li><a href="part-ii-r-fundamentals.html#part-ii-r-fundamentals" id="toc-part-ii-r-fundamentals">Part II: R fundamentals</a></li>
<li><a href="data.html#data" id="toc-data"><span class="toc-section-number">3</span> Data – Reading, Wrangling, and Writing</a>
<ul>
<li><a href="data.html#data-long" id="toc-data-long"><span class="toc-section-number">3.1</span> Long data format – the way data should be</a></li>
<li><a href="data.html#data-here" id="toc-data-here"><span class="toc-section-number">3.2</span> Use the here function to construct the file path</a></li>
<li><a href="data.html#learning-from-this-chapter" id="toc-learning-from-this-chapter"><span class="toc-section-number">3.3</span> Learning from this chapter</a></li>
<li><a href="data.html#data-working-in-r" id="toc-data-working-in-r"><span class="toc-section-number">3.4</span> Working in R</a>
<ul>
<li><a href="data.html#importing-data" id="toc-importing-data"><span class="toc-section-number">3.4.1</span> Importing data</a></li>
</ul></li>
<li><a href="data.html#data-wrangling" id="toc-data-wrangling"><span class="toc-section-number">3.5</span> Data wrangling</a>
<ul>
<li><a href="data.html#reshaping-data-wide-to-long" id="toc-reshaping-data-wide-to-long"><span class="toc-section-number">3.5.1</span> Reshaping data – Wide to long</a></li>
<li><a href="data.html#reshaping-data-transpose-turning-the-columns-into-rows" id="toc-reshaping-data-transpose-turning-the-columns-into-rows"><span class="toc-section-number">3.5.2</span> Reshaping data – Transpose (turning the columns into rows)</a></li>
<li><a href="data.html#combining-data" id="toc-combining-data"><span class="toc-section-number">3.5.3</span> Combining data</a></li>
<li><a href="data.html#data-subset" id="toc-data-subset"><span class="toc-section-number">3.5.4</span> Subsetting data</a></li>
<li><a href="data.html#wrangling-columns" id="toc-wrangling-columns"><span class="toc-section-number">3.5.5</span> Wrangling columns</a></li>
<li><a href="data.html#missing-data" id="toc-missing-data"><span class="toc-section-number">3.5.6</span> Missing data</a></li>
</ul></li>
<li><a href="data.html#saving-data" id="toc-saving-data"><span class="toc-section-number">3.6</span> Saving data</a></li>
<li><a href="data.html#exercises" id="toc-exercises"><span class="toc-section-number">3.7</span> Exercises</a></li>
</ul></li>
<li><a href="plotting-models.html#plotting-models" id="toc-plotting-models"><span class="toc-section-number">4</span> Plotting Models</a>
<ul>
<li><a href="plotting-models.html#pretty-good-plots-show-the-model-and-the-data" id="toc-pretty-good-plots-show-the-model-and-the-data"><span class="toc-section-number">4.1</span> Pretty good plots show the model and the data</a>
<ul>
<li><a href="plotting-models.html#pretty-good-plot-component-1-modeled-effects-plot" id="toc-pretty-good-plot-component-1-modeled-effects-plot"><span class="toc-section-number">4.1.1</span> Pretty good plot component 1: Modeled effects plot</a></li>
<li><a href="plotting-models.html#pretty-good-plot-component-2-modeled-mean-and-ci-plot" id="toc-pretty-good-plot-component-2-modeled-mean-and-ci-plot"><span class="toc-section-number">4.1.2</span> Pretty good plot component 2: Modeled mean and CI plot</a></li>
<li><a href="plotting-models.html#combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot." id="toc-combining-effects-and-modeled-mean-and-ci-plots-an-effects-and-response-plot."><span class="toc-section-number">4.1.3</span> Combining Effects and Modeled mean and CI plots – an Effects and response plot.</a></li>
<li><a href="plotting-models.html#some-comments-on-plot-components" id="toc-some-comments-on-plot-components"><span class="toc-section-number">4.1.4</span> Some comments on plot components</a></li>
</ul></li>
<li><a href="plotting-models.html#working-in-r" id="toc-working-in-r"><span class="toc-section-number">4.2</span> Working in R</a>
<ul>
<li><a href="plotting-models.html#source-data" id="toc-source-data"><span class="toc-section-number">4.2.1</span> Source data</a></li>
<li><a href="plotting-models.html#how-to-plot-the-model" id="toc-how-to-plot-the-model"><span class="toc-section-number">4.2.2</span> How to plot the model</a></li>
<li><a href="plotting-models.html#be-sure-ggplot_the_model-is-in-your-r-folder" id="toc-be-sure-ggplot_the_model-is-in-your-r-folder"><span class="toc-section-number">4.2.3</span> Be sure ggplot_the_model is in your R folder</a></li>
<li><a href="plotting-models.html#how-to-use-the-plot-the-model-functions" id="toc-how-to-use-the-plot-the-model-functions"><span class="toc-section-number">4.2.4</span> How to use the Plot the Model functions</a></li>
<li><a href="plotting-models.html#how-to-generate-a-response-plot-using-ggpubr" id="toc-how-to-generate-a-response-plot-using-ggpubr"><span class="toc-section-number">4.2.5</span> How to generate a Response Plot using ggpubr</a></li>
<li><a href="plotting-models.html#how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2" id="toc-how-to-generate-a-response-plot-with-a-grid-of-treatments-using-ggplot2"><span class="toc-section-number">4.2.6</span> How to generate a Response Plot with a grid of treatments using ggplot2</a></li>
<li><a href="plotting-models.html#how-to-generate-an-effects-plot" id="toc-how-to-generate-an-effects-plot"><span class="toc-section-number">4.2.7</span> How to generate an Effects Plot</a></li>
<li><a href="plotting-models.html#how-to-combine-the-response-and-effects-plots" id="toc-how-to-combine-the-response-and-effects-plots"><span class="toc-section-number">4.2.8</span> How to combine the response and effects plots</a></li>
<li><a href="plotting-models.html#how-to-add-the-interaction-effect-to-response-and-effects-plots" id="toc-how-to-add-the-interaction-effect-to-response-and-effects-plots"><span class="toc-section-number">4.2.9</span> How to add the interaction effect to response and effects plots</a></li>
</ul></li>
</ul></li>
<li><a href="part-iii-some-fundamentals-of-statistical-modeling.html#part-iii-some-fundamentals-of-statistical-modeling" id="toc-part-iii-some-fundamentals-of-statistical-modeling">Part III: Some Fundamentals of Statistical Modeling</a></li>
<li><a href="uncertainty.html#uncertainty" id="toc-uncertainty"><span class="toc-section-number">5</span> Variability and Uncertainty (Standard Deviations, Standard Errors, and Confidence Intervals)</a>
<ul>
<li><a href="uncertainty.html#standard-errors-are-used-to-compute-p-values-and-confidence-intervals" id="toc-standard-errors-are-used-to-compute-p-values-and-confidence-intervals"><span class="toc-section-number">5.1</span> Standard errors are used to compute <em>p</em>-values and confidence intervals</a></li>
<li><a href="uncertainty.html#background" id="toc-background"><span class="toc-section-number">5.2</span> Background</a>
<ul>
<li><a href="uncertainty.html#sample-standard-deviation" id="toc-sample-standard-deviation"><span class="toc-section-number">5.2.1</span> Sample standard deviation</a></li>
<li><a href="uncertainty.html#standard-error-of-the-mean" id="toc-standard-error-of-the-mean"><span class="toc-section-number">5.2.2</span> Standard error of the mean</a></li>
</ul></li>
<li><a href="uncertainty.html#simulations-using-fake-data-as-an-intuition-pump" id="toc-simulations-using-fake-data-as-an-intuition-pump"><span class="toc-section-number">5.3</span> Simulations – using fake data as an intuition pump</a>
<ul>
<li><a href="uncertainty.html#using-google-sheets-to-generate-fake-data-to-explore-the-standard-error" id="toc-using-google-sheets-to-generate-fake-data-to-explore-the-standard-error"><span class="toc-section-number">5.3.1</span> Using Google Sheets to generate fake data to explore the standard error</a></li>
<li><a href="uncertainty.html#using-r-to-generate-fake-data-to-explore-the-standard-error" id="toc-using-r-to-generate-fake-data-to-explore-the-standard-error"><span class="toc-section-number">5.3.2</span> Using R to generate fake data to explore the standard error</a></li>
</ul></li>
<li><a href="uncertainty.html#bootstrap" id="toc-bootstrap"><span class="toc-section-number">5.4</span> Bootstrapped standard errors</a>
<ul>
<li><a href="uncertainty.html#an-example-of-bootstrapped-standard-errors" id="toc-an-example-of-bootstrapped-standard-errors"><span class="toc-section-number">5.4.1</span> An example of bootstrapped standard errors</a></li>
</ul></li>
<li><a href="uncertainty.html#confidence-intervals" id="toc-confidence-intervals"><span class="toc-section-number">5.5</span> Confidence Intervals</a>
<ul>
<li><a href="uncertainty.html#just-the-math" id="toc-just-the-math"><span class="toc-section-number">5.5.1</span> Just the math</a></li>
<li><a href="uncertainty.html#interpretation-of-a-confidence-interval" id="toc-interpretation-of-a-confidence-interval"><span class="toc-section-number">5.5.2</span> Interpretation of a confidence interval</a></li>
<li><a href="uncertainty.html#bootstrap-confidence-interval" id="toc-bootstrap-confidence-interval"><span class="toc-section-number">5.5.3</span> Bootstrap confidence interval</a></li>
<li><a href="uncertainty.html#a-plot-of-a-parametric-ci-vs.-bootstrap-ci-of-the-means" id="toc-a-plot-of-a-parametric-ci-vs.-bootstrap-ci-of-the-means"><span class="toc-section-number">5.5.4</span> A plot of a “parametric” CI vs. bootstrap CI of the means</a></li>
</ul></li>
<li><a href="uncertainty.html#standard-error-of-a-difference-between-means" id="toc-standard-error-of-a-difference-between-means"><span class="toc-section-number">5.6</span> Standard error of a difference between means</a>
<ul>
<li><a href="uncertainty.html#the-standard-error-of-a-difference-between-means-is-the-standard-deviation-of-the-sampling-distribution-of-the-difference" id="toc-the-standard-error-of-a-difference-between-means-is-the-standard-deviation-of-the-sampling-distribution-of-the-difference"><span class="toc-section-number">5.6.1</span> The standard error of a difference between means is the standard deviation of the sampling distribution of the difference</a></li>
</ul></li>
<li><a href="uncertainty.html#confidence-limits-of-a-difference-between-means" id="toc-confidence-limits-of-a-difference-between-means"><span class="toc-section-number">5.7</span> Confidence limits of a difference between means</a>
<ul>
<li><a href="uncertainty.html#of-95-cis-of-the-difference-include-the-true-difference" id="toc-of-95-cis-of-the-difference-include-the-true-difference"><span class="toc-section-number">5.7.1</span> 95% of 95% CIs of the difference include the true difference</a></li>
</ul></li>
<li><a href="uncertainty.html#hidden-code" id="toc-hidden-code"><span class="toc-section-number">5.8</span> Hidden code</a>
<ul>
<li><a href="uncertainty.html#import-exp3b" id="toc-import-exp3b"><span class="toc-section-number">5.8.1</span> Import exp3b</a></li>
</ul></li>
</ul></li>
<li><a href="p-values.html#p-values" id="toc-p-values"><span class="toc-section-number">6</span> P-values</a>
<ul>
<li><a href="p-values.html#a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution" id="toc-a-p-value-is-the-probability-of-sampling-a-value-as-or-more-extreme-than-the-test-statistic-if-sampling-from-a-null-distribution"><span class="toc-section-number">6.1</span> A <em>p</em>-value is the probability of sampling a value as or more extreme than the test statistic if sampling from a null distribution</a></li>
<li><a href="p-values.html#pump-your-intuition-creating-a-null-distribution" id="toc-pump-your-intuition-creating-a-null-distribution"><span class="toc-section-number">6.2</span> Pump your intuition – Creating a null distribution</a></li>
<li><a href="p-values.html#a-null-distribution-of-t-values-the-t-distribution" id="toc-a-null-distribution-of-t-values-the-t-distribution"><span class="toc-section-number">6.3</span> A null distribution of <em>t</em>-values – the <em>t</em> distribution</a></li>
<li><a href="p-values.html#p-values-from-the-perspective-of-permutation" id="toc-p-values-from-the-perspective-of-permutation"><span class="toc-section-number">6.4</span> P-values from the perspective of permutation</a></li>
<li><a href="p-values.html#parametric-vs.-non-parametric-statistics" id="toc-parametric-vs.-non-parametric-statistics"><span class="toc-section-number">6.5</span> Parametric vs. non-parametric statistics</a></li>
<li><a href="p-values.html#frequentist-probability-and-the-interpretation-of-p-values" id="toc-frequentist-probability-and-the-interpretation-of-p-values"><span class="toc-section-number">6.6</span> frequentist probability and the interpretation of p-values</a>
<ul>
<li><a href="p-values.html#background-1" id="toc-background-1"><span class="toc-section-number">6.6.1</span> Background</a></li>
<li><a href="p-values.html#this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability." id="toc-this-book-covers-frequentist-approaches-to-statistical-modeling-and-when-a-probability-arises-such-as-the-p-value-of-a-test-statistic-this-will-be-a-frequentist-probability."><span class="toc-section-number">6.6.2</span> This book covers frequentist approaches to statistical modeling and when a probability arises, such as the <em>p</em>-value of a test statistic, this will be a frequentist probability.</a></li>
<li><a href="p-values.html#two-interpretations-of-the-p-value" id="toc-two-interpretations-of-the-p-value"><span class="toc-section-number">6.6.3</span> Two interpretations of the <em>p</em>-value</a></li>
<li><a href="p-values.html#nhst" id="toc-nhst"><span class="toc-section-number">6.6.4</span> NHST</a></li>
</ul></li>
<li><a href="p-values.html#some-major-misconceptions-of-the-p-value" id="toc-some-major-misconceptions-of-the-p-value"><span class="toc-section-number">6.7</span> Some major misconceptions of the <em>p</em>-value</a>
<ul>
<li><a href="p-values.html#misconception-p-0.05-means-there-is-no-effect-of-treatment" id="toc-misconception-p-0.05-means-there-is-no-effect-of-treatment"><span class="toc-section-number">6.7.1</span> Misconception: <span class="math inline">\(p &gt; 0.05\)</span> means there is no effect of treatment</a></li>
<li><a href="p-values.html#misconception-a-p-value-is-repeatable" id="toc-misconception-a-p-value-is-repeatable"><span class="toc-section-number">6.7.2</span> Misconception: a <em>p</em>-value is repeatable</a></li>
<li><a href="p-values.html#misconception-0.05-is-the-lifetime-rate-of-false-discoveries" id="toc-misconception-0.05-is-the-lifetime-rate-of-false-discoveries"><span class="toc-section-number">6.7.3</span> Misconception: 0.05 is the lifetime rate of false discoveries</a></li>
<li><a href="p-values.html#misconception-a-low-p-value-indicates-an-important-effect" id="toc-misconception-a-low-p-value-indicates-an-important-effect"><span class="toc-section-number">6.7.4</span> Misconception: a low <em>p</em>-value indicates an important effect</a></li>
<li><a href="p-values.html#misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity" id="toc-misconception-a-low-p-value-indicates-high-model-fit-or-high-predictive-capacity"><span class="toc-section-number">6.7.5</span> Misconception: a low <em>p</em>-value indicates high model fit or high predictive capacity</a></li>
</ul></li>
<li><a href="p-values.html#what-the-p-value-does-not-mean" id="toc-what-the-p-value-does-not-mean"><span class="toc-section-number">6.8</span> What the <em>p</em>-value does not mean</a></li>
<li><a href="p-values.html#on-using-p-values-in-experimental-biology" id="toc-on-using-p-values-in-experimental-biology"><span class="toc-section-number">6.9</span> On using <em>p</em>-values in experimental biology</a></li>
<li><a href="p-values.html#better-reproducibility" id="toc-better-reproducibility"><span class="toc-section-number">6.10</span> Better reproducibility</a></li>
<li><a href="p-values.html#multiple-testing-and-controlling-for-false-positives" id="toc-multiple-testing-and-controlling-for-false-positives"><span class="toc-section-number">6.11</span> Multiple testing and controlling for false positives</a>
<ul>
<li><a href="p-values.html#controlling-the-family-wise-error-rate-when-all-tests-are-testing-the-same-hypothesis" id="toc-controlling-the-family-wise-error-rate-when-all-tests-are-testing-the-same-hypothesis"><span class="toc-section-number">6.11.1</span> Controlling the family-wise error rate when all tests are testing the same hypothesis</a></li>
</ul></li>
<li><a href="p-values.html#recommendations" id="toc-recommendations"><span class="toc-section-number">6.12</span> Recommendations</a>
<ul>
<li><a href="p-values.html#primary-sources-for-recommendations" id="toc-primary-sources-for-recommendations"><span class="toc-section-number">6.12.1</span> Primary sources for recommendations</a></li>
</ul></li>
<li><a href="p-values.html#problems" id="toc-problems"><span class="toc-section-number">6.13</span> Problems</a></li>
</ul></li>
<li><a href="errors-in-inference.html#errors-in-inference" id="toc-errors-in-inference"><span class="toc-section-number">7</span> Errors in inference</a>
<ul>
<li><a href="errors-in-inference.html#classical-nhst-concepts-of-wrong" id="toc-classical-nhst-concepts-of-wrong"><span class="toc-section-number">7.1</span> Classical NHST concepts of wrong</a>
<ul>
<li><a href="errors-in-inference.html#type-i-error" id="toc-type-i-error"><span class="toc-section-number">7.1.1</span> Type I error</a></li>
<li><a href="errors-in-inference.html#power" id="toc-power"><span class="toc-section-number">7.1.2</span> Power</a></li>
</ul></li>
<li><a href="errors-in-inference.html#a-non-neyman-pearson-concept-of-power" id="toc-a-non-neyman-pearson-concept-of-power"><span class="toc-section-number">7.2</span> A non-Neyman-Pearson concept of power</a>
<ul>
<li><a href="errors-in-inference.html#estimation-error" id="toc-estimation-error"><span class="toc-section-number">7.2.1</span> Estimation error</a></li>
<li><a href="errors-in-inference.html#coverage" id="toc-coverage"><span class="toc-section-number">7.2.2</span> Coverage</a></li>
<li><a href="errors-in-inference.html#type-s-error" id="toc-type-s-error"><span class="toc-section-number">7.2.3</span> Type S error</a></li>
<li><a href="errors-in-inference.html#type-m-error" id="toc-type-m-error"><span class="toc-section-number">7.2.4</span> Type M error</a></li>
</ul></li>
</ul></li>
<li><a href="part-iv-introduction-to-linear-models.html#part-iv-introduction-to-linear-models" id="toc-part-iv-introduction-to-linear-models">Part IV: Introduction to Linear Models</a></li>
<li><a href="intro-linear-models.html#intro-linear-models" id="toc-intro-linear-models"><span class="toc-section-number">8</span> An introduction to linear models</a>
<ul>
<li><a href="intro-linear-models.html#lm-specifications" id="toc-lm-specifications"><span class="toc-section-number">8.1</span> Two specifications of a linear model</a>
<ul>
<li><a href="intro-linear-models.html#the-error-draw-specification" id="toc-the-error-draw-specification"><span class="toc-section-number">8.1.1</span> The “error draw” specification</a></li>
<li><a href="intro-linear-models.html#the-conditional-draw-specification" id="toc-the-conditional-draw-specification"><span class="toc-section-number">8.1.2</span> The “conditional draw” specification</a></li>
<li><a href="intro-linear-models.html#comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model" id="toc-comparing-the-error-draw-and-conditional-draw-ways-of-specifying-the-linear-model"><span class="toc-section-number">8.1.3</span> Comparing the error-draw and conditional-draw ways of specifying the linear model</a></li>
<li><a href="intro-linear-models.html#anova-notation-of-a-linear-model" id="toc-anova-notation-of-a-linear-model"><span class="toc-section-number">8.1.4</span> ANOVA notation of a linear model</a></li>
</ul></li>
<li><a href="intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables" id="toc-a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"><span class="toc-section-number">8.2</span> A linear model can be fit to data with continuous, discrete, or categorical <span class="math inline">\(X\)</span> variables</a>
<ul>
<li><a href="intro-linear-models.html#fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete" id="toc-fitting-linear-models-to-experimental-data-in-which-the-x-variable-is-continuous-or-discrete"><span class="toc-section-number">8.2.1</span> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is continuous or discrete</a></li>
<li><a href="intro-linear-models.html#slope" id="toc-slope"><span class="toc-section-number">8.2.2</span> Fitting linear models to experimental data in which the <span class="math inline">\(X\)</span> variable is categorical</a></li>
</ul></li>
<li><a href="intro-linear-models.html#statistical-models-are-used-for-prediction-explanation-and-description" id="toc-statistical-models-are-used-for-prediction-explanation-and-description"><span class="toc-section-number">8.3</span> Statistical models are used for prediction, explanation, and description</a></li>
<li><a href="intro-linear-models.html#what-is-the-interpretation-of-a-regression-coefficient" id="toc-what-is-the-interpretation-of-a-regression-coefficient"><span class="toc-section-number">8.4</span> What is the interpretation of a regression coefficient?</a></li>
<li><a href="intro-linear-models.html#what-do-we-call-the-x-and-y-variables" id="toc-what-do-we-call-the-x-and-y-variables"><span class="toc-section-number">8.5</span> What do we call the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables?</a></li>
<li><a href="intro-linear-models.html#modeling-strategy" id="toc-modeling-strategy"><span class="toc-section-number">8.6</span> Modeling strategy</a></li>
<li><a href="intro-linear-models.html#predictions-from-the-model" id="toc-predictions-from-the-model"><span class="toc-section-number">8.7</span> Predictions from the model</a></li>
<li><a href="intro-linear-models.html#inference-from-the-model" id="toc-inference-from-the-model"><span class="toc-section-number">8.8</span> Inference from the model</a>
<ul>
<li><a href="intro-linear-models.html#assumptions-for-inference-with-a-statistical-model" id="toc-assumptions-for-inference-with-a-statistical-model"><span class="toc-section-number">8.8.1</span> Assumptions for inference with a statistical model</a></li>
<li><a href="intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model" id="toc-specific-assumptions-for-inference-with-a-linear-model"><span class="toc-section-number">8.8.2</span> Specific assumptions for inference with a linear model</a></li>
</ul></li>
<li><a href="intro-linear-models.html#linear-modelregression-model-or-statistical-model" id="toc-linear-modelregression-model-or-statistical-model"><span class="toc-section-number">8.9</span> “linear model,”regression model”, or “statistical model”?</a></li>
</ul></li>
<li><a href="regression.html#regression" id="toc-regression"><span class="toc-section-number">9</span> Linear models with a single, continuous <em>X</em> (“regression”)</a>
<ul>
<li><a href="regression.html#a-linear-model-with-a-single-continuous-x-is-classical-regression" id="toc-a-linear-model-with-a-single-continuous-x-is-classical-regression"><span class="toc-section-number">9.1</span> A linear model with a single, continuous <em>X</em> is classical “regression”</a>
<ul>
<li><a href="regression.html#analysis-of-green-down-data" id="toc-analysis-of-green-down-data"><span class="toc-section-number">9.1.1</span> Analysis of “green-down” data</a></li>
<li><a href="regression.html#learning-from-the-green-down-example" id="toc-learning-from-the-green-down-example"><span class="toc-section-number">9.1.2</span> Learning from the green-down example</a></li>
<li><a href="regression.html#using-a-regression-model-for-explanation-causal-models" id="toc-using-a-regression-model-for-explanation-causal-models"><span class="toc-section-number">9.1.3</span> Using a regression model for “explanation” – causal models</a></li>
<li><a href="regression.html#using-a-regression-model-for-prediction-prediction-models" id="toc-using-a-regression-model-for-prediction-prediction-models"><span class="toc-section-number">9.1.4</span> Using a regression model for prediction – prediction models</a></li>
<li><a href="regression.html#using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data" id="toc-using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data"><span class="toc-section-number">9.1.5</span> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</a></li>
<li><a href="regression.html#using-a-regression-model-for-for-calibration" id="toc-using-a-regression-model-for-for-calibration"><span class="toc-section-number">9.1.6</span> Using a regression model for for calibration</a></li>
</ul></li>
<li><a href="regression.html#working-in-r-1" id="toc-working-in-r-1"><span class="toc-section-number">9.2</span> Working in R</a>
<ul>
<li><a href="plotting-models.html#fit-the-model" id="toc-fit-the-model"><span class="toc-section-number">9.2.1</span> Fitting the linear model</a></li>
<li><a href="regression.html#getting-to-know-the-linear-model-the-summary-function" id="toc-getting-to-know-the-linear-model-the-summary-function"><span class="toc-section-number">9.2.2</span> Getting to know the linear model: the <code>summary</code> function</a></li>
<li><a href="regression.html#inference-the-coefficient-table" id="toc-inference-the-coefficient-table"><span class="toc-section-number">9.2.3</span> Inference – the coefficient table</a></li>
<li><a href="regression.html#how-good-is-our-model-model-checking" id="toc-how-good-is-our-model-model-checking"><span class="toc-section-number">9.2.4</span> How good is our model? – Model checking</a></li>
<li><a href="regression.html#plotting-models-with-continuous-x" id="toc-plotting-models-with-continuous-x"><span class="toc-section-number">9.2.5</span> Plotting models with continuous <em>X</em></a></li>
<li><a href="regression.html#creating-a-table-of-predicted-values-and-95-prediction-intervals" id="toc-creating-a-table-of-predicted-values-and-95-prediction-intervals"><span class="toc-section-number">9.2.6</span> Creating a table of predicted values and 95% prediction intervals</a></li>
</ul></li>
<li><a href="regression.html#hidden-code-1" id="toc-hidden-code-1"><span class="toc-section-number">9.3</span> Hidden code</a>
<ul>
<li><a href="regression.html#import-and-plot-of-fig2c-ecosystem-warming-experimental-data" id="toc-import-and-plot-of-fig2c-ecosystem-warming-experimental-data"><span class="toc-section-number">9.3.1</span> Import and plot of fig2c (ecosystem warming experimental) data</a></li>
<li><a href="regression.html#import-and-plot-efig_3d-ecosysem-warming-observational-data" id="toc-import-and-plot-efig_3d-ecosysem-warming-observational-data"><span class="toc-section-number">9.3.2</span> Import and plot efig_3d (Ecosysem warming observational) data</a></li>
<li><a href="regression.html#import-and-plot-of-fig1f-methionine-restriction-data" id="toc-import-and-plot-of-fig1f-methionine-restriction-data"><span class="toc-section-number">9.3.3</span> Import and plot of fig1f (methionine restriction) data</a></li>
</ul></li>
<li><a href="regression.html#try-it" id="toc-try-it"><span class="toc-section-number">9.4</span> Try it</a>
<ul>
<li><a href="regression.html#a-prediction-model-from-the-literature" id="toc-a-prediction-model-from-the-literature"><span class="toc-section-number">9.4.1</span> A prediction model from the literature</a></li>
</ul></li>
<li><a href="regression.html#intuition-pumps" id="toc-intuition-pumps"><span class="toc-section-number">9.5</span> Intuition pumps</a>
<ul>
<li><a href="regression.html#correlation-and-r2" id="toc-correlation-and-r2"><span class="toc-section-number">9.5.1</span> Correlation and $R^2</a></li>
</ul></li>
</ul></li>
<li><a href="oneway.html#oneway" id="toc-oneway"><span class="toc-section-number">10</span> Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</a>
<ul>
<li><a href="oneway.html#oneway-data" id="toc-oneway-data"><span class="toc-section-number">10.1</span> A linear model with a single, categorical <em>X</em> variable estimates the effects of the levels of <em>X</em> on the response</a>
<ul>
<li><a href="oneway.html#oneway-example1" id="toc-oneway-example1"><span class="toc-section-number">10.1.1</span> Example 1 (fig3d) – two treatment levels (“groups”)</a></li>
<li><a href="oneway.html#understanding-the-analysis-with-two-treatment-levels" id="toc-understanding-the-analysis-with-two-treatment-levels"><span class="toc-section-number">10.1.2</span> Understanding the analysis with two treatment levels</a></li>
<li><a href="oneway.html#oneway-example2" id="toc-oneway-example2"><span class="toc-section-number">10.1.3</span> Example 2 – three treatment levels (“groups”)</a></li>
<li><a href="oneway.html#understanding-the-analysis-with-three-or-more-treatment-levels" id="toc-understanding-the-analysis-with-three-or-more-treatment-levels"><span class="toc-section-number">10.1.4</span> Understanding the analysis with three (or more) treatment levels</a></li>
</ul></li>
<li><a href="oneway.html#working-in-r-2" id="toc-working-in-r-2"><span class="toc-section-number">10.2</span> Working in R</a>
<ul>
<li><a href="oneway.html#fit-the-model-1" id="toc-fit-the-model-1"><span class="toc-section-number">10.2.1</span> Fit the model</a></li>
<li><a href="oneway.html#controlling-the-output-in-tables-using-the-coefficient-table-as-an-example" id="toc-controlling-the-output-in-tables-using-the-coefficient-table-as-an-example"><span class="toc-section-number">10.2.2</span> Controlling the output in tables using the coefficient table as an example</a></li>
<li><a href="oneway.html#using-the-emmeans-function" id="toc-using-the-emmeans-function"><span class="toc-section-number">10.2.3</span> Using the emmeans function</a></li>
<li><a href="oneway.html#using-the-contrast-function" id="toc-using-the-contrast-function"><span class="toc-section-number">10.2.4</span> Using the contrast function</a></li>
<li><a href="oneway.html#how-to-generate-anova-tables" id="toc-how-to-generate-anova-tables"><span class="toc-section-number">10.2.5</span> How to generate ANOVA tables</a></li>
</ul></li>
<li><a href="oneway.html#hidden-code-2" id="toc-hidden-code-2"><span class="toc-section-number">10.3</span> Hidden Code</a>
<ul>
<li><a href="oneway.html#importing-and-wrangling-the-fig_3d-data-for-example-1" id="toc-importing-and-wrangling-the-fig_3d-data-for-example-1"><span class="toc-section-number">10.3.1</span> Importing and wrangling the fig_3d data for example 1</a></li>
<li><a href="oneway.html#importing-and-wrangling-the-fig2a-data-for-example-2" id="toc-importing-and-wrangling-the-fig2a-data-for-example-2"><span class="toc-section-number">10.3.2</span> Importing and wrangling the fig2a data for example 2</a></li>
</ul></li>
</ul></li>
<li><a href="model-checking.html#model-checking" id="toc-model-checking"><span class="toc-section-number">11</span> Model Checking</a>
<ul>
<li><a href="model-checking.html#check-check" id="toc-check-check"><span class="toc-section-number">11.1</span> All statistical analyses should be followed by model checking</a></li>
<li><a href="model-checking.html#linear-model-assumptions" id="toc-linear-model-assumptions"><span class="toc-section-number">11.2</span> Linear model assumptions</a>
<ul>
<li><a href="model-checking.html#a-bit-about-iid" id="toc-a-bit-about-iid"><span class="toc-section-number">11.2.1</span> A bit about IID</a></li>
</ul></li>
<li><a href="model-checking.html#diagnostic-plots-use-the-residuals-from-the-model-fit" id="toc-diagnostic-plots-use-the-residuals-from-the-model-fit"><span class="toc-section-number">11.3</span> Diagnostic plots use the residuals from the model fit</a>
<ul>
<li><a href="model-checking.html#residuals" id="toc-residuals"><span class="toc-section-number">11.3.1</span> Residuals</a></li>
<li><a href="model-checking.html#normal-qq" id="toc-normal-qq"><span class="toc-section-number">11.3.2</span> A Normal Q-Q plot is used to check for characteristic departures from Normality</a></li>
<li><a href="model-checking.html#mapping-qq-plot-departures-from-normality" id="toc-mapping-qq-plot-departures-from-normality"><span class="toc-section-number">11.3.3</span> Mapping QQ-plot departures from Normality</a></li>
<li><a href="model-checking.html#model-checking-spread-level" id="toc-model-checking-spread-level"><span class="toc-section-number">11.3.4</span> Model checking homoskedasticity</a></li>
</ul></li>
<li><a href="model-checking.html#using-r" id="toc-using-r"><span class="toc-section-number">11.4</span> Using R</a></li>
<li><a href="model-checking.html#hidden-code-3" id="toc-hidden-code-3"><span class="toc-section-number">11.5</span> Hidden Code</a>
<ul>
<li><a href="model-checking.html#normal-q-q-plots" id="toc-normal-q-q-plots"><span class="toc-section-number">11.5.1</span> Normal Q-Q plots</a></li>
</ul></li>
</ul></li>
<li><a href="violations.html#violations" id="toc-violations"><span class="toc-section-number">12</span> Violations of independence, homogeneity, or Normality</a>
<ul>
<li><a href="violations.html#oneway-paired-t" id="toc-oneway-paired-t"><span class="toc-section-number">12.1</span> Lack of independence</a>
<ul>
<li><a href="violations.html#violations-paired-t" id="toc-violations-paired-t"><span class="toc-section-number">12.1.1</span> Example 1 (exp1b) – a paired t-test is a special case of a linear mixed model</a></li>
<li><a href="violations.html#violations-rmanova" id="toc-violations-rmanova"><span class="toc-section-number">12.1.2</span> Example 2 (diHOME exp2a) – A repeated measures ANOVA is a special case of a linear mixed model</a></li>
</ul></li>
<li><a href="violations.html#oneway-welch" id="toc-oneway-welch"><span class="toc-section-number">12.2</span> Heterogeneity of variances</a>
<ul>
<li><a href="violations.html#when-groups-of-the-focal-test-have-variance" id="toc-when-groups-of-the-focal-test-have-variance"><span class="toc-section-number">12.2.1</span> When groups of the focal test have &gt;&gt; variance</a></li>
</ul></li>
<li><a href="violations.html#the-conditional-response-isnt-normal" id="toc-the-conditional-response-isnt-normal"><span class="toc-section-number">12.3</span> The conditional response isn’t Normal</a>
<ul>
<li><a href="violations.html#violations-6f" id="toc-violations-6f"><span class="toc-section-number">12.3.1</span> Example 1 (fig6f) – Linear models for non-normal count data</a></li>
<li><a href="violations.html#my-data-arent-normal-what-is-the-best-practice" id="toc-my-data-arent-normal-what-is-the-best-practice"><span class="toc-section-number">12.3.2</span> My data aren’t normal, what is the best practice?</a></li>
</ul></li>
<li><a href="violations.html#hidden-code-4" id="toc-hidden-code-4"><span class="toc-section-number">12.4</span> Hidden Code</a>
<ul>
<li><a href="violations.html#importing-and-wrangling-the-exp1b-data" id="toc-importing-and-wrangling-the-exp1b-data"><span class="toc-section-number">12.4.1</span> Importing and wrangling the exp1b data</a></li>
<li><a href="violations.html#importing-and-wrangling-the-exp2a-data" id="toc-importing-and-wrangling-the-exp2a-data"><span class="toc-section-number">12.4.2</span> Importing and wrangling the exp2a data</a></li>
<li><a href="violations.html#importing-and-wrangling-the-fig6f-data" id="toc-importing-and-wrangling-the-fig6f-data"><span class="toc-section-number">12.4.3</span> Importing and wrangling the fig6f data</a></li>
</ul></li>
</ul></li>
<li><a href="issues.html#issues" id="toc-issues"><span class="toc-section-number">13</span> Issues in inference</a>
<ul>
<li><a href="issues.html#replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means" id="toc-replicated-experiments-include-textttexperiment-as-a-random-factor-better-than-one-way-anova-of-means"><span class="toc-section-number">13.1</span> Replicated experiments – include <span class="math inline">\(\texttt{Experiment}\)</span> as a random factor (better than one-way ANOVA of means)</a>
<ul>
<li><a href="issues.html#issues-exp4d" id="toc-issues-exp4d"><span class="toc-section-number">13.1.1</span> Multiple experiments Example 1 (wound healing Exp4d)</a></li>
<li><a href="issues.html#issues-combined-experiments" id="toc-issues-combined-experiments"><span class="toc-section-number">13.1.2</span> Models for combining replicated experiments</a></li>
<li><a href="issues.html#understanding-model-exp4d_m1" id="toc-understanding-model-exp4d_m1"><span class="toc-section-number">13.1.3</span> Understanding Model <code>exp4d_m1</code></a></li>
<li><a href="issues.html#the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2" id="toc-the-univariate-model-is-equivalent-to-a-linear-mixed-model-of-the-aggregated-data-model-exp4d_m2"><span class="toc-section-number">13.1.4</span> The univariate model is equivalent to a linear mixed model of the aggregated data (Model exp4d_m2)</a></li>
<li><a href="issues.html#a-linear-mixed-model-of-the-full-data" id="toc-a-linear-mixed-model-of-the-full-data"><span class="toc-section-number">13.1.5</span> A linear mixed model of the full data</a></li>
<li><a href="issues.html#analysis-of-the-experiment-means-has-less-precision-and-power" id="toc-analysis-of-the-experiment-means-has-less-precision-and-power"><span class="toc-section-number">13.1.6</span> Analysis of the experiment means has less precision and power</a></li>
<li><a href="issues.html#dont-do-this-a-t-testfixed-effect-anova-of-the-full-data" id="toc-dont-do-this-a-t-testfixed-effect-anova-of-the-full-data"><span class="toc-section-number">13.1.7</span> Don’t do this – a t-test/fixed-effect ANOVA of the full data</a></li>
</ul></li>
<li><a href="issues.html#issues-pre-post" id="toc-issues-pre-post"><span class="toc-section-number">13.2</span> Comparing change from baseline (pre-post)</a>
<ul>
<li><a href="issues.html#pre-post-example-1-dpp4-fig4c" id="toc-pre-post-example-1-dpp4-fig4c"><span class="toc-section-number">13.2.1</span> Pre-post example 1 (DPP4 fig4c)</a></li>
<li><a href="issues.html#what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure" id="toc-what-if-the-data-in-example-1-were-from-from-an-experiment-where-the-treatment-was-applied-prior-to-the-baseline-measure"><span class="toc-section-number">13.2.2</span> What if the data in example 1 were from from an experiment where the treatment was applied prior to the baseline measure?</a></li>
<li><a href="issues.html#pre-post-example-2-xx-males-fig1c" id="toc-pre-post-example-2-xx-males-fig1c"><span class="toc-section-number">13.2.3</span> Pre-post example 2 (XX males fig1c)</a></li>
<li><a href="issues.html#issues-regression-to-mean" id="toc-issues-regression-to-mean"><span class="toc-section-number">13.2.4</span> Regression to the mean</a></li>
</ul></li>
<li><a href="issues.html#longitudinal-designs-with-more-than-one-post-baseline-measure" id="toc-longitudinal-designs-with-more-than-one-post-baseline-measure"><span class="toc-section-number">13.3</span> Longitudinal designs with more than one-post baseline measure</a>
<ul>
<li><a href="issues.html#issues-auc" id="toc-issues-auc"><span class="toc-section-number">13.3.1</span> Area under the curve (AUC)</a></li>
</ul></li>
<li><a href="issues.html#normalization-the-analysis-of-ratios" id="toc-normalization-the-analysis-of-ratios"><span class="toc-section-number">13.4</span> Normalization – the analysis of ratios</a>
<ul>
<li><a href="issues.html#kinds-of-ratios-in-experimental-biology" id="toc-kinds-of-ratios-in-experimental-biology"><span class="toc-section-number">13.4.1</span> Kinds of ratios in experimental biology</a></li>
<li><a href="issues.html#issues-offset" id="toc-issues-offset"><span class="toc-section-number">13.4.2</span> Example 1 – The ratio is a density (number of something per area)</a></li>
<li><a href="issues.html#issues-size" id="toc-issues-size"><span class="toc-section-number">13.4.3</span> Example 2 – The ratio is normalizing for size differences</a></li>
</ul></li>
<li><a href="issues.html#dont-do-this-stuff" id="toc-dont-do-this-stuff"><span class="toc-section-number">13.5</span> Don’t do this stuff</a>
<ul>
<li><a href="issues.html#normalize-the-response-so-that-all-control-values-are-equal-to-1." id="toc-normalize-the-response-so-that-all-control-values-are-equal-to-1."><span class="toc-section-number">13.5.1</span> Normalize the response so that all control values are equal to 1.</a></li>
</ul></li>
<li><a href="issues.html#a-difference-in-significance-is-not-necessarily-significant" id="toc-a-difference-in-significance-is-not-necessarily-significant"><span class="toc-section-number">13.6</span> A difference in significance is not necessarily significant</a></li>
<li><a href="issues.html#researcher-degrees-of-freedom" id="toc-researcher-degrees-of-freedom"><span class="toc-section-number">13.7</span> Researcher degrees of freedom</a></li>
<li><a href="issues.html#hidden-code-5" id="toc-hidden-code-5"><span class="toc-section-number">13.8</span> Hidden code</a>
<ul>
<li><a href="issues.html#import-exp4d-vimentin-cell-count-data-replicate-experiments-example" id="toc-import-exp4d-vimentin-cell-count-data-replicate-experiments-example"><span class="toc-section-number">13.8.1</span> Import exp4d vimentin cell count data (replicate experiments example)</a></li>
<li><a href="issues.html#import-fig4c-data" id="toc-import-fig4c-data"><span class="toc-section-number">13.8.2</span> Import Fig4c data</a></li>
<li><a href="issues.html#xx-males-fig1c" id="toc-xx-males-fig1c"><span class="toc-section-number">13.8.3</span> XX males fig1c</a></li>
<li><a href="issues.html#generation-of-fake-data-to-illustrate-regression-to-the-mean" id="toc-generation-of-fake-data-to-illustrate-regression-to-the-mean"><span class="toc-section-number">13.8.4</span> Generation of fake data to illustrate regression to the mean</a></li>
<li><a href="issues.html#import-fig3f" id="toc-import-fig3f"><span class="toc-section-number">13.8.5</span> Import fig3f</a></li>
<li><a href="issues.html#issues-import-exp3b" id="toc-issues-import-exp3b"><span class="toc-section-number">13.8.6</span> Import exp3b</a></li>
<li><a href="issues.html#issues-exp3b-plot" id="toc-issues-exp3b-plot"><span class="toc-section-number">13.8.7</span> Plot the model of exp3b (glm offset data)</a></li>
</ul></li>
</ul></li>
<li><a href="part-v-more-than-one-x-multivariable-models.html#part-v-more-than-one-x-multivariable-models" id="toc-part-v-more-than-one-x-multivariable-models">Part V: More than one <span class="math inline">\(X\)</span> – Multivariable Models</a></li>
<li><a href="covariates.html#covariates" id="toc-covariates"><span class="toc-section-number">14</span> Linear models with added covariates (“ANCOVA”)</a>
<ul>
<li><a href="covariates.html#adding-covariates-can-increases-the-precision-of-the-effect-of-interest" id="toc-adding-covariates-can-increases-the-precision-of-the-effect-of-interest"><span class="toc-section-number">14.1</span> Adding covariates can increases the precision of the effect of interest</a></li>
<li><a href="covariates.html#understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data" id="toc-understanding-a-linear-model-with-an-added-covariate-heart-necrosis-data"><span class="toc-section-number">14.2</span> Understanding a linear model with an added covariate – heart necrosis data</a>
<ul>
<li><a href="covariates.html#fit-the-model-5" id="toc-fit-the-model-5"><span class="toc-section-number">14.2.1</span> Fit the model</a></li>
<li><a href="covariates.html#plot-the-model-2" id="toc-plot-the-model-2"><span class="toc-section-number">14.2.2</span> Plot the model</a></li>
<li><a href="covariates.html#interpretation-of-the-model-coefficients" id="toc-interpretation-of-the-model-coefficients"><span class="toc-section-number">14.2.3</span> Interpretation of the model coefficients</a></li>
<li><a href="covariates.html#everything-adds-up" id="toc-everything-adds-up"><span class="toc-section-number">14.2.4</span> Everything adds up</a></li>
<li><a href="covariates.html#interpretation-of-the-estimated-marginal-means" id="toc-interpretation-of-the-estimated-marginal-means"><span class="toc-section-number">14.2.5</span> Interpretation of the estimated marginal means</a></li>
<li><a href="covariates.html#interpretation-of-the-contrasts" id="toc-interpretation-of-the-contrasts"><span class="toc-section-number">14.2.6</span> Interpretation of the contrasts</a></li>
<li><a href="covariates.html#adding-the-covariate-improves-inference" id="toc-adding-the-covariate-improves-inference"><span class="toc-section-number">14.2.7</span> Adding the covariate improves inference</a></li>
</ul></li>
<li><a href="covariates.html#understanding-interaction-effects-with-covariates" id="toc-understanding-interaction-effects-with-covariates"><span class="toc-section-number">14.3</span> Understanding interaction effects with covariates</a>
<ul>
<li><a href="covariates.html#fit-the-model-6" id="toc-fit-the-model-6"><span class="toc-section-number">14.3.1</span> Fit the model</a></li>
<li><a href="covariates.html#plot-the-model-with-interaction-effect" id="toc-plot-the-model-with-interaction-effect"><span class="toc-section-number">14.3.2</span> Plot the model with interaction effect</a></li>
<li><a href="covariates.html#interpretation-of-the-model-coefficients-1" id="toc-interpretation-of-the-model-coefficients-1"><span class="toc-section-number">14.3.3</span> Interpretation of the model coefficients</a></li>
<li><a href="covariates.html#what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends." id="toc-what-is-the-effect-of-a-treatment-if-interactions-are-modeled-it-depends."><span class="toc-section-number">14.3.4</span> What is the effect of a treatment, if interactions are modeled? – it depends.</a></li>
<li><a href="covariates.html#which-model-do-we-use-mathcalm_1-or-mathcalm_2" id="toc-which-model-do-we-use-mathcalm_1-or-mathcalm_2"><span class="toc-section-number">14.3.5</span> Which model do we use, <span class="math inline">\(\mathcal{M}_1\)</span> or <span class="math inline">\(\mathcal{M}_2\)</span>?</a></li>
</ul></li>
<li><a href="covariates.html#understanding-ancova-tables" id="toc-understanding-ancova-tables"><span class="toc-section-number">14.4</span> Understanding ANCOVA tables</a></li>
<li><a href="covariates.html#working-in-r-3" id="toc-working-in-r-3"><span class="toc-section-number">14.5</span> Working in R</a>
<ul>
<li><a href="covariates.html#importing-the-heart-necrosis-data" id="toc-importing-the-heart-necrosis-data"><span class="toc-section-number">14.5.1</span> Importing the heart necrosis data</a></li>
<li><a href="covariates.html#fitting-the-model" id="toc-fitting-the-model"><span class="toc-section-number">14.5.2</span> Fitting the model</a></li>
<li><a href="covariates.html#using-the-emmeans-function-1" id="toc-using-the-emmeans-function-1"><span class="toc-section-number">14.5.3</span> Using the emmeans function</a></li>
<li><a href="covariates.html#ancova-tables" id="toc-ancova-tables"><span class="toc-section-number">14.5.4</span> ANCOVA tables</a></li>
<li><a href="covariates.html#plotting-the-model" id="toc-plotting-the-model"><span class="toc-section-number">14.5.5</span> Plotting the model</a></li>
</ul></li>
<li><a href="covariates.html#best-practices" id="toc-best-practices"><span class="toc-section-number">14.6</span> Best practices</a>
<ul>
<li><a href="covariates.html#do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate" id="toc-do-not-use-a-ratio-of-partwhole-as-a-response-variable-instead-add-the-denominator-as-a-covariate"><span class="toc-section-number">14.6.1</span> Do not use a ratio of part:whole as a response variable – instead add the denominator as a covariate</a></li>
<li><a href="covariates.html#do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate" id="toc-do-not-use-change-from-baseline-as-a-response-variable-instead-add-the-baseline-measure-as-a-covariate"><span class="toc-section-number">14.6.2</span> Do not use change from baseline as a response variable – instead add the baseline measure as a covariate</a></li>
<li><a href="covariates.html#do-not-test-for-balance-of-baseline-measures" id="toc-do-not-test-for-balance-of-baseline-measures"><span class="toc-section-number">14.6.3</span> Do not “test for balance” of baseline measures</a></li>
</ul></li>
<li><a href="covariates.html#best-practices-2-use-a-covariate-instead-of-normalizing-a-response" id="toc-best-practices-2-use-a-covariate-instead-of-normalizing-a-response"><span class="toc-section-number">14.7</span> Best practices 2: Use a covariate instead of normalizing a response</a></li>
</ul></li>
<li><a href="factorial.html#factorial" id="toc-factorial"><span class="toc-section-number">15</span> Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</a>
<ul>
<li><a href="factorial.html#a-linear-model-with-crossed-factors-estimates-interaction-effects" id="toc-a-linear-model-with-crossed-factors-estimates-interaction-effects"><span class="toc-section-number">15.1</span> A linear model with crossed factors estimates interaction effects</a>
<ul>
<li><a href="factorial.html#an-interaction-is-a-difference-in-simple-effects" id="toc-an-interaction-is-a-difference-in-simple-effects"><span class="toc-section-number">15.1.1</span> An interaction is a difference in simple effects</a></li>
<li><a href="factorial.html#a-linear-model-with-crossed-factors-includes-interaction-effects" id="toc-a-linear-model-with-crossed-factors-includes-interaction-effects"><span class="toc-section-number">15.1.2</span> A linear model with crossed factors includes interaction effects</a></li>
<li><a href="factorial.html#factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature" id="toc-factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature"><span class="toc-section-number">15.1.3</span> factorial experiments are frequently analyzed as flattened linear models in the experimental biology literature</a></li>
</ul></li>
<li><a href="factorial.html#example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data" id="toc-example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data"><span class="toc-section-number">15.2</span> Example 1 – Estimation of a treatment effect relative to a control effect (“Something different”) (Experiment 2j glucose uptake data)</a>
<ul>
<li><a href="factorial.html#twoway-understand1" id="toc-twoway-understand1"><span class="toc-section-number">15.2.1</span> Understand the experimental design</a></li>
<li><a href="factorial.html#fit-the-linear-model" id="toc-fit-the-linear-model"><span class="toc-section-number">15.2.2</span> Fit the linear model</a></li>
<li><a href="factorial.html#twoway-exp2j-inf" id="toc-twoway-exp2j-inf"><span class="toc-section-number">15.2.3</span> Inference</a></li>
<li><a href="factorial.html#plot-the-model-3" id="toc-plot-the-model-3"><span class="toc-section-number">15.2.4</span> Plot the model</a></li>
</ul></li>
<li><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-1" id="toc-understanding-the-linear-model-with-crossed-factors-1"><span class="toc-section-number">15.3</span> Understanding the linear model with crossed factors 1</a>
<ul>
<li><a href="factorial.html#twoway-what-coefs-are" id="toc-twoway-what-coefs-are"><span class="toc-section-number">15.3.1</span> What the coefficients are</a></li>
<li><a href="factorial.html#the-interaction-effect-is-something-different" id="toc-the-interaction-effect-is-something-different"><span class="toc-section-number">15.3.2</span> The interaction effect is something different</a></li>
<li><a href="factorial.html#why-we-want-to-compare-the-treatment-effect-to-a-control-effect" id="toc-why-we-want-to-compare-the-treatment-effect-to-a-control-effect"><span class="toc-section-number">15.3.3</span> Why we want to compare the treatment effect to a control effect</a></li>
<li><a href="factorial.html#the-order-of-the-factors-in-the-model-tells-the-same-story-differently" id="toc-the-order-of-the-factors-in-the-model-tells-the-same-story-differently"><span class="toc-section-number">15.3.4</span> The order of the factors in the model tells the same story differently</a></li>
<li><a href="factorial.html#power-for-the-interaction-effect-is-less-than-that-for-simple-effects" id="toc-power-for-the-interaction-effect-is-less-than-that-for-simple-effects"><span class="toc-section-number">15.3.5</span> Power for the interaction effect is less than that for simple effects</a></li>
<li><a href="factorial.html#planned-comparisons-vs.-post-hoc-tests" id="toc-planned-comparisons-vs.-post-hoc-tests"><span class="toc-section-number">15.3.6</span> Planned comparisons vs. post-hoc tests</a></li>
</ul></li>
<li><a href="factorial.html#example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data" id="toc-example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data"><span class="toc-section-number">15.4</span> Example 2: Estimation of the effect of background condition on an effect (“it depends”) (Experiment 3e lesian area data)</a>
<ul>
<li><a href="factorial.html#understand-the-experimental-design" id="toc-understand-the-experimental-design"><span class="toc-section-number">15.4.1</span> Understand the experimental design</a></li>
<li><a href="factorial.html#fit-the-linear-model-1" id="toc-fit-the-linear-model-1"><span class="toc-section-number">15.4.2</span> Fit the linear model</a></li>
<li><a href="factorial.html#check-the-model-1" id="toc-check-the-model-1"><span class="toc-section-number">15.4.3</span> Check the model</a></li>
<li><a href="factorial.html#inference-from-the-model-2" id="toc-inference-from-the-model-2"><span class="toc-section-number">15.4.4</span> Inference from the model</a></li>
<li><a href="factorial.html#plot-the-model-4" id="toc-plot-the-model-4"><span class="toc-section-number">15.4.5</span> Plot the model</a></li>
</ul></li>
<li><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-2" id="toc-understanding-the-linear-model-with-crossed-factors-2"><span class="toc-section-number">15.5</span> Understanding the linear model with crossed factors 2</a>
<ul>
<li><a href="factorial.html#twoway-marginal-means" id="toc-twoway-marginal-means"><span class="toc-section-number">15.5.1</span> Conditional and marginal means</a></li>
<li><a href="factorial.html#simple-conditional-effects" id="toc-simple-conditional-effects"><span class="toc-section-number">15.5.2</span> Simple (conditional) effects</a></li>
<li><a href="factorial.html#twoway-marginal-effects" id="toc-twoway-marginal-effects"><span class="toc-section-number">15.5.3</span> Marginal effects</a></li>
<li><a href="factorial.html#the-additive-model" id="toc-the-additive-model"><span class="toc-section-number">15.5.4</span> The additive model</a></li>
<li><a href="factorial.html#twoway-reduce" id="toc-twoway-reduce"><span class="toc-section-number">15.5.5</span> Reduce models for the right reason</a></li>
<li><a href="factorial.html#the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird" id="toc-the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird"><span class="toc-section-number">15.5.6</span> The marginal means of an additive linear model with two factors can be weird</a></li>
</ul></li>
<li><a href="factorial.html#example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data" id="toc-example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data"><span class="toc-section-number">15.6</span> Example 3: Estimation of synergy (“More than the sum of the parts”) (Experiment 1c JA data)</a>
<ul>
<li><a href="factorial.html#examine-the-data" id="toc-examine-the-data"><span class="toc-section-number">15.6.1</span> Examine the data</a></li>
<li><a href="factorial.html#fit-the-model-7" id="toc-fit-the-model-7"><span class="toc-section-number">15.6.2</span> Fit the model</a></li>
<li><a href="factorial.html#model-check" id="toc-model-check"><span class="toc-section-number">15.6.3</span> Model check</a></li>
<li><a href="factorial.html#inference-from-the-model-3" id="toc-inference-from-the-model-3"><span class="toc-section-number">15.6.4</span> Inference from the model</a></li>
<li><a href="factorial.html#plot-the-model-5" id="toc-plot-the-model-5"><span class="toc-section-number">15.6.5</span> Plot the model</a></li>
<li><a href="factorial.html#alternative-plot" id="toc-alternative-plot"><span class="toc-section-number">15.6.6</span> Alternative plot</a></li>
</ul></li>
<li><a href="factorial.html#understanding-the-linear-model-with-crossed-factors-3" id="toc-understanding-the-linear-model-with-crossed-factors-3"><span class="toc-section-number">15.7</span> Understanding the linear model with crossed factors 3</a>
<ul>
<li><a href="factorial.html#thinking-about-the-coefficients-of-the-linear-model" id="toc-thinking-about-the-coefficients-of-the-linear-model"><span class="toc-section-number">15.7.1</span> Thinking about the coefficients of the linear model</a></li>
</ul></li>
<li><a href="factorial.html#issues-in-inference" id="toc-issues-in-inference"><span class="toc-section-number">15.8</span> Issues in inference</a>
<ul>
<li><a href="factorial.html#for-pairwise-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model" id="toc-for-pairwise-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><span class="toc-section-number">15.8.1</span> For pairwise contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li><a href="factorial.html#for-interaction-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model" id="toc-for-interaction-contrasts-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model"><span class="toc-section-number">15.8.2</span> For interaction contrasts, it doesn’t matter if you fit a factorial or a flattened linear model</a></li>
<li><a href="factorial.html#twoway-multiple-tests" id="toc-twoway-multiple-tests"><span class="toc-section-number">15.8.3</span> Adjusting <em>p</em>-values for multiple tests</a></li>
</ul></li>
<li><a href="factorial.html#two-way-anova" id="toc-two-way-anova"><span class="toc-section-number">15.9</span> Two-way ANOVA</a>
<ul>
<li><a href="factorial.html#how-to-read-a-two-way-anova-table" id="toc-how-to-read-a-two-way-anova-table"><span class="toc-section-number">15.9.1</span> How to read a two-way ANOVA table</a></li>
<li><a href="factorial.html#what-do-the-main-effects-in-an-anova-table-mean" id="toc-what-do-the-main-effects-in-an-anova-table-mean"><span class="toc-section-number">15.9.2</span> What do the main effects in an ANOVA table mean?</a></li>
</ul></li>
<li><a href="factorial.html#more-issues-in-inference" id="toc-more-issues-in-inference"><span class="toc-section-number">15.10</span> More issues in inference</a>
<ul>
<li><a href="factorial.html#longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova" id="toc-longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova"><span class="toc-section-number">15.10.1</span> Longitudinal experiments – include Time as a random factor (better than repeated measures ANOVA)</a></li>
</ul></li>
<li><a href="factorial.html#working-in-r-4" id="toc-working-in-r-4"><span class="toc-section-number">15.11</span> Working in R</a>
<ul>
<li><a href="factorial.html#model-formula" id="toc-model-formula"><span class="toc-section-number">15.11.1</span> Model formula</a></li>
<li><a href="factorial.html#using-the-emmeans-function-2" id="toc-using-the-emmeans-function-2"><span class="toc-section-number">15.11.2</span> Using the emmeans function</a></li>
<li><a href="factorial.html#contrasts" id="toc-contrasts"><span class="toc-section-number">15.11.3</span> Contrasts</a></li>
<li><a href="factorial.html#practice-safe-anova" id="toc-practice-safe-anova"><span class="toc-section-number">15.11.4</span> Practice safe ANOVA</a></li>
<li><a href="factorial.html#better-to-avoid-these" id="toc-better-to-avoid-these"><span class="toc-section-number">15.11.5</span> Better to avoid these</a></li>
</ul></li>
<li><a href="factorial.html#hidden-code-6" id="toc-hidden-code-6"><span class="toc-section-number">15.12</span> Hidden Code</a>
<ul>
<li><a href="factorial.html#import-exp2j-example-1" id="toc-import-exp2j-example-1"><span class="toc-section-number">15.12.1</span> Import exp2j (Example 1)</a></li>
<li><a href="factorial.html#import-exp3e-lesian-area-data-example-2" id="toc-import-exp3e-lesian-area-data-example-2"><span class="toc-section-number">15.12.2</span> Import exp3e lesian area data (Example 2)</a></li>
<li><a href="factorial.html#import-exp1c-ja-data-example-3" id="toc-import-exp1c-ja-data-example-3"><span class="toc-section-number">15.12.3</span> Import Exp1c JA data (Example 3)</a></li>
</ul></li>
</ul></li>
<li><a href="part-vi-expanding-the-linear-model.html#part-vi-expanding-the-linear-model" id="toc-part-vi-expanding-the-linear-model">Part VI – Expanding the Linear Model</a></li>
<li><a href="lmm.html#lmm" id="toc-lmm"><span class="toc-section-number">16</span> Models with random factors – linear mixed models</a>
<ul>
<li><a href="lmm.html#lmm-demo" id="toc-lmm-demo"><span class="toc-section-number">16.1</span> Example 1 – A random intercepts and slopes explainer (demo1)</a>
<ul>
<li><a href="lmm.html#batched-measurements-result-in-clustered-residuals" id="toc-batched-measurements-result-in-clustered-residuals"><span class="toc-section-number">16.1.1</span> Batched measurements result in clustered residuals</a></li>
<li><a href="lmm.html#lmm-corerr" id="toc-lmm-corerr"><span class="toc-section-number">16.1.2</span> Clustered residuals result in correlated error</a></li>
<li><a href="lmm.html#in-blocked-designs-clustered-residuals-adds-a-variance-component-that-masks-treatment-effects" id="toc-in-blocked-designs-clustered-residuals-adds-a-variance-component-that-masks-treatment-effects"><span class="toc-section-number">16.1.3</span> In blocked designs, clustered residuals adds a variance component that masks treatment effects</a></li>
<li><a href="lmm.html#linear-mixed-models-are-linear-models-with-added-random-factors" id="toc-linear-mixed-models-are-linear-models-with-added-random-factors"><span class="toc-section-number">16.1.4</span> Linear mixed models are linear models with added random factors</a></li>
<li><a href="lmm.html#what-the-random-effects-are" id="toc-what-the-random-effects-are"><span class="toc-section-number">16.1.5</span> What the random effects are</a></li>
<li><a href="lmm.html#in-a-blocked-design-a-linear-model-with-added-random-effects-increases-precision-of-treatment-effects" id="toc-in-a-blocked-design-a-linear-model-with-added-random-effects-increases-precision-of-treatment-effects"><span class="toc-section-number">16.1.6</span> In a blocked design, a linear model with added random effects increases precision of treatment effects</a></li>
<li><a href="lmm.html#lmm-varcorr" id="toc-lmm-varcorr"><span class="toc-section-number">16.1.7</span> The correlation among random intercepts and slopes</a></li>
<li><a href="lmm.html#clustered-residuals-create-heterogeneity-among-treatments" id="toc-clustered-residuals-create-heterogeneity-among-treatments"><span class="toc-section-number">16.1.8</span> Clustered residuals create heterogeneity among treatments</a></li>
<li><a href="lmm.html#linear-mixed-models-are-flexible" id="toc-linear-mixed-models-are-flexible"><span class="toc-section-number">16.1.9</span> Linear mixed models are flexible</a></li>
<li><a href="lmm.html#a-random-intercept-only-model" id="toc-a-random-intercept-only-model"><span class="toc-section-number">16.1.10</span> A random intercept only model</a></li>
<li><a href="lmm.html#a-model-including-an-interaction-intercept" id="toc-a-model-including-an-interaction-intercept"><span class="toc-section-number">16.1.11</span> A model including an interaction intercept</a></li>
<li><a href="lmm.html#lmm-demo-aic" id="toc-lmm-demo-aic"><span class="toc-section-number">16.1.12</span> AIC and model selection – which model to report?</a></li>
<li><a href="lmm.html#the-specification-of-random-effects-matters" id="toc-the-specification-of-random-effects-matters"><span class="toc-section-number">16.1.13</span> The specification of random effects matters</a></li>
<li><a href="lmm.html#mixed-effect-and-repeated-measures-anova" id="toc-mixed-effect-and-repeated-measures-anova"><span class="toc-section-number">16.1.14</span> Mixed Effect and Repeated Measures ANOVA</a></li>
<li><a href="lmm.html#pseudoreplication" id="toc-pseudoreplication"><span class="toc-section-number">16.1.15</span> Pseudoreplication</a></li>
</ul></li>
<li><a href="lmm.html#lmm-example2" id="toc-lmm-example2"><span class="toc-section-number">16.2</span> Example 2 – experiments without subsampling replication (exp6g)</a>
<ul>
<li><a href="lmm.html#understand-the-data" id="toc-understand-the-data"><span class="toc-section-number">16.2.1</span> Understand the data</a></li>
<li><a href="lmm.html#model-fit-and-inference" id="toc-model-fit-and-inference"><span class="toc-section-number">16.2.2</span> Model fit and inference</a></li>
<li><a href="lmm.html#the-model-exp6g_m1-adds-a-random-intercept-but-not-a-random-slope" id="toc-the-model-exp6g_m1-adds-a-random-intercept-but-not-a-random-slope"><span class="toc-section-number">16.2.3</span> The model exp6g_m1 adds a random intercept but not a random slope</a></li>
<li><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp6g_m1" id="toc-the-fixed-effect-coefficients-of-model-exp6g_m1"><span class="toc-section-number">16.2.4</span> The fixed effect coefficients of model exp6g_m1</a></li>
<li><a href="lmm.html#the-random-intercept-coefficients-of-exp6g_m1" id="toc-the-random-intercept-coefficients-of-exp6g_m1"><span class="toc-section-number">16.2.5</span> The random intercept coefficients of exp6g_m1</a></li>
<li><a href="lmm.html#the-random-and-residual-variance-and-the-intraclass-correlation-of-model-exp6g_m1" id="toc-the-random-and-residual-variance-and-the-intraclass-correlation-of-model-exp6g_m1"><span class="toc-section-number">16.2.6</span> The random and residual variance and the intraclass correlation of model exp6g_m1</a></li>
<li><a href="lmm.html#the-linear-mixed-model-exp6g_m1-increases-precision-of-treatment-effects-relative-to-a-fixed-effects-model" id="toc-the-linear-mixed-model-exp6g_m1-increases-precision-of-treatment-effects-relative-to-a-fixed-effects-model"><span class="toc-section-number">16.2.7</span> The linear mixed model exp6g_m1 increases precision of treatment effects, relative to a fixed effects model</a></li>
<li><a href="lmm.html#lmm-exp6g-alt" id="toc-lmm-exp6g-alt"><span class="toc-section-number">16.2.8</span> Alternative models for exp6g</a></li>
<li><a href="lmm.html#paired-t-tests-and-repeated-measures-anova-are-special-cases-of-linear-mixed-models" id="toc-paired-t-tests-and-repeated-measures-anova-are-special-cases-of-linear-mixed-models"><span class="toc-section-number">16.2.9</span> Paired t-tests and repeated measures ANOVA are special cases of linear mixed models</a></li>
<li><a href="lmm.html#lmm-exp6g-rmanova" id="toc-lmm-exp6g-rmanova"><span class="toc-section-number">16.2.10</span> Classical (“univariate model”) repeated measures ANOVA of exp6g</a></li>
<li><a href="lmm.html#lmm-exp6g-rmanova-multi" id="toc-lmm-exp6g-rmanova-multi"><span class="toc-section-number">16.2.11</span> “Multivariate model” repeated measures ANOVA</a></li>
<li><a href="lmm.html#linear-mixed-models-vs-repeated-measures-anova" id="toc-linear-mixed-models-vs-repeated-measures-anova"><span class="toc-section-number">16.2.12</span> Linear mixed models vs repeated measures ANOVA</a></li>
<li><a href="lmm.html#modeling-textttmouse_id-as-a-fixed-effect" id="toc-modeling-textttmouse_id-as-a-fixed-effect"><span class="toc-section-number">16.2.13</span> Modeling <span class="math inline">\(\texttt{mouse_id}\)</span> as a fixed effect</a></li>
</ul></li>
<li><a href="lmm.html#example-3-factorial-experiments-and-no-subsampling-replicates-exp5c" id="toc-example-3-factorial-experiments-and-no-subsampling-replicates-exp5c"><span class="toc-section-number">16.3</span> Example 3 – Factorial experiments and no subsampling replicates (exp5c)</a>
<ul>
<li><a href="lmm.html#understand-the-data-1" id="toc-understand-the-data-1"><span class="toc-section-number">16.3.1</span> Understand the data</a></li>
<li><a href="lmm.html#examine-the-data-1" id="toc-examine-the-data-1"><span class="toc-section-number">16.3.2</span> Examine the data</a></li>
<li><a href="lmm.html#lmm-exp5c-m1" id="toc-lmm-exp5c-m1"><span class="toc-section-number">16.3.3</span> Model fit and inference</a></li>
<li><a href="lmm.html#why-we-care-about-modeling-batch-in-exp5c" id="toc-why-we-care-about-modeling-batch-in-exp5c"><span class="toc-section-number">16.3.4</span> Why we care about modeling batch in exp5c</a></li>
<li><a href="lmm.html#the-linear-mixed-model-exp5c_m1-adds-two-random-intercepts" id="toc-the-linear-mixed-model-exp5c_m1-adds-two-random-intercepts"><span class="toc-section-number">16.3.5</span> The linear mixed model exp5c_m1 adds two random intercepts</a></li>
<li><a href="lmm.html#the-fixed-effect-coefficients-of-model-exp5c_m1" id="toc-the-fixed-effect-coefficients-of-model-exp5c_m1"><span class="toc-section-number">16.3.6</span> The fixed effect coefficients of model exp5c_m1</a></li>
<li><a href="lmm.html#the-random-effect-coefficients-of-model-exp5c_m1" id="toc-the-random-effect-coefficients-of-model-exp5c_m1"><span class="toc-section-number">16.3.7</span> The random effect coefficients of model exp5c_m1</a></li>
<li><a href="lmm.html#lmm-exp5c-alt" id="toc-lmm-exp5c-alt"><span class="toc-section-number">16.3.8</span> Alternative models for exp5c</a></li>
<li><a href="lmm.html#lmm-rmanova-5c" id="toc-lmm-rmanova-5c"><span class="toc-section-number">16.3.9</span> Classical (“univariate model”) repeated measures ANOVA</a></li>
<li><a href="lmm.html#lmm-rmanova-5c-multi" id="toc-lmm-rmanova-5c-multi"><span class="toc-section-number">16.3.10</span> “Multivariate model” repeated measures ANOVA of exp5c</a></li>
<li><a href="lmm.html#modeling-textttdonor-as-a-fixed-effect" id="toc-modeling-textttdonor-as-a-fixed-effect"><span class="toc-section-number">16.3.11</span> Modeling <span class="math inline">\(\texttt{donor}\)</span> as a fixed effect</a></li>
</ul></li>
<li><a href="lmm.html#lmm-example4" id="toc-lmm-example4"><span class="toc-section-number">16.4</span> Example 4 – Experiments with subsampling replication (exp1g)</a>
<ul>
<li><a href="lmm.html#understand-the-data-2" id="toc-understand-the-data-2"><span class="toc-section-number">16.4.1</span> Understand the data</a></li>
<li><a href="lmm.html#examine-the-data-2" id="toc-examine-the-data-2"><span class="toc-section-number">16.4.2</span> Examine the data</a></li>
<li><a href="lmm.html#fit-the-model-9" id="toc-fit-the-model-9"><span class="toc-section-number">16.4.3</span> Fit the model</a></li>
<li><a href="lmm.html#inference-from-the-model-6" id="toc-inference-from-the-model-6"><span class="toc-section-number">16.4.4</span> Inference from the model</a></li>
<li><a href="lmm.html#plot-the-model-6" id="toc-plot-the-model-6"><span class="toc-section-number">16.4.5</span> Plot the model</a></li>
<li><a href="lmm.html#alternaplot-the-model-2" id="toc-alternaplot-the-model-2"><span class="toc-section-number">16.4.6</span> Alternaplot the model</a></li>
<li><a href="lmm.html#understanding-the-alternative-models" id="toc-understanding-the-alternative-models"><span class="toc-section-number">16.4.7</span> Understanding the alternative models</a></li>
<li><a href="lmm.html#the-varcorr-matrix-of-models-exp1g_m1a-and-exp1g_m1b" id="toc-the-varcorr-matrix-of-models-exp1g_m1a-and-exp1g_m1b"><span class="toc-section-number">16.4.8</span> The VarCorr matrix of models exp1g_m1a and exp1g_m1b</a></li>
<li><a href="lmm.html#the-linear-mixed-model-has-more-precision-and-power-than-the-fixed-effect-model-of-batch-means" id="toc-the-linear-mixed-model-has-more-precision-and-power-than-the-fixed-effect-model-of-batch-means"><span class="toc-section-number">16.4.9</span> The linear mixed model has more precision and power than the fixed effect model of batch means</a></li>
<li><a href="lmm.html#fixed-effect-models-and-pseudoreplication" id="toc-fixed-effect-models-and-pseudoreplication"><span class="toc-section-number">16.4.10</span> Fixed effect models and pseudoreplication</a></li>
<li><a href="lmm.html#mixed-effect-anova" id="toc-mixed-effect-anova"><span class="toc-section-number">16.4.11</span> Mixed-effect ANOVA</a></li>
</ul></li>
<li><a href="lmm.html#working-in-r-5" id="toc-working-in-r-5"><span class="toc-section-number">16.5</span> Working in R</a>
<ul>
<li><a href="lmm.html#fitting-linear-mixed-models" id="toc-fitting-linear-mixed-models"><span class="toc-section-number">16.5.1</span> Fitting linear mixed models</a></li>
<li><a href="lmm.html#plotting-models-fit-to-batched-data" id="toc-plotting-models-fit-to-batched-data"><span class="toc-section-number">16.5.2</span> Plotting models fit to batched data</a></li>
<li><a href="lmm.html#repeated-measures-anova-randomized-complete-block-with-no-subsampling" id="toc-repeated-measures-anova-randomized-complete-block-with-no-subsampling"><span class="toc-section-number">16.5.3</span> Repeated measures ANOVA (randomized complete block with no subsampling)</a></li>
</ul></li>
<li><a href="lmm.html#hidden-code-7" id="toc-hidden-code-7"><span class="toc-section-number">16.6</span> Hidden code</a>
<ul>
<li><a href="lmm.html#import-exp5c" id="toc-import-exp5c"><span class="toc-section-number">16.6.1</span> Import exp5c</a></li>
<li><a href="lmm.html#import-exp1g" id="toc-import-exp1g"><span class="toc-section-number">16.6.2</span> Import exp1g</a></li>
</ul></li>
</ul></li>
<li><a href="pre-post.html#pre-post" id="toc-pre-post"><span class="toc-section-number">17</span> Linear models for longitudinal experiments – I. pre-post designs</a>
<ul>
<li><a href="pre-post.html#best-practice-models" id="toc-best-practice-models"><span class="toc-section-number">17.1</span> Best practice models</a></li>
<li><a href="pre-post.html#common-alternatives-that-are-not-recommended" id="toc-common-alternatives-that-are-not-recommended"><span class="toc-section-number">17.2</span> Common alternatives that are not recommended</a></li>
<li><a href="pre-post.html#advanced-models" id="toc-advanced-models"><span class="toc-section-number">17.3</span> Advanced models</a></li>
<li><a href="pre-post.html#understanding-the-alternative-models-1" id="toc-understanding-the-alternative-models-1"><span class="toc-section-number">17.4</span> Understanding the alternative models</a>
<ul>
<li><a href="pre-post.html#m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model" id="toc-m1-linear-model-with-the-baseline-measure-as-the-covariate-ancova-model"><span class="toc-section-number">17.4.1</span> (M1) Linear model with the baseline measure as the covariate (ANCOVA model)</a></li>
<li><a href="pre-post.html#m2-linear-model-of-the-change-score-change-score-model" id="toc-m2-linear-model-of-the-change-score-change-score-model"><span class="toc-section-number">17.4.2</span> (M2) Linear model of the change score (change-score model)</a></li>
<li><a href="pre-post.html#m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model" id="toc-m3-linear-model-of-post-baseline-values-without-the-baseline-as-a-covariate-post-model"><span class="toc-section-number">17.4.3</span> (M3) Linear model of post-baseline values without the baseline as a covariate (post model)</a></li>
<li><a href="pre-post.html#m4-linear-model-with-factorial-fixed-effects-fixed-effects-model" id="toc-m4-linear-model-with-factorial-fixed-effects-fixed-effects-model"><span class="toc-section-number">17.4.4</span> (M4) Linear model with factorial fixed effects (fixed-effects model)</a></li>
<li><a href="pre-post.html#m5-repeated-measures-anova" id="toc-m5-repeated-measures-anova"><span class="toc-section-number">17.4.5</span> (M5) Repeated measures ANOVA</a></li>
<li><a href="pre-post.html#m6-linear-mixed-model" id="toc-m6-linear-mixed-model"><span class="toc-section-number">17.4.6</span> (M6) Linear mixed model</a></li>
<li><a href="pre-post.html#m7-linear-model-with-correlated-error" id="toc-m7-linear-model-with-correlated-error"><span class="toc-section-number">17.4.7</span> (M7) Linear model with correlated error</a></li>
<li><a href="pre-post.html#m8-constrained-fixed-effects-model-with-correlated-error-clda-model" id="toc-m8-constrained-fixed-effects-model-with-correlated-error-clda-model"><span class="toc-section-number">17.4.8</span> (M8) Constrained fixed effects model with correlated error (cLDA model)</a></li>
<li><a href="pre-post.html#comparison-table" id="toc-comparison-table"><span class="toc-section-number">17.4.9</span> Comparison table</a></li>
</ul></li>
<li><a href="pre-post.html#example-1-a-single-post-baseline-measure-pre-post-design" id="toc-example-1-a-single-post-baseline-measure-pre-post-design"><span class="toc-section-number">17.5</span> Example 1 – a single post-baseline measure (pre-post design)</a></li>
<li><a href="pre-post.html#working-in-r-6" id="toc-working-in-r-6"><span class="toc-section-number">17.6</span> Working in R</a></li>
<li><a href="pre-post.html#hidden-code-8" id="toc-hidden-code-8"><span class="toc-section-number">17.7</span> Hidden code</a>
<ul>
<li><a href="pre-post.html#import-and-wrangle-mouse-sociability-data" id="toc-import-and-wrangle-mouse-sociability-data"><span class="toc-section-number">17.7.1</span> Import and wrangle mouse sociability data</a></li>
</ul></li>
</ul></li>
<li><a href="counts.html#counts" id="toc-counts"><span class="toc-section-number">18</span> Linear models for counts, binary responses, skewed responses, and ratios – Generalized Linear Models</a>
<ul>
<li><a href="counts.html#glm-counts" id="toc-glm-counts"><span class="toc-section-number">18.1</span> Introducing Generalized Linear Models using count data examples</a>
<ul>
<li><a href="counts.html#the-generalized-linear-model-glm" id="toc-the-generalized-linear-model-glm"><span class="toc-section-number">18.1.1</span> The Generalized Linear Model (GLM)</a></li>
<li><a href="counts.html#kinds-of-data-that-are-modeled-by-a-glm" id="toc-kinds-of-data-that-are-modeled-by-a-glm"><span class="toc-section-number">18.1.2</span> Kinds of data that are modeled by a GLM</a></li>
</ul></li>
<li><a href="counts.html#glm-1" id="toc-glm-1"><span class="toc-section-number">18.2</span> Example 1 – GLM models for count responses (“angiogenic sprouts” exp3a)</a>
<ul>
<li><a href="counts.html#understand-the-data-3" id="toc-understand-the-data-3"><span class="toc-section-number">18.2.1</span> Understand the data</a></li>
<li><a href="counts.html#model-fit-and-inference-1" id="toc-model-fit-and-inference-1"><span class="toc-section-number">18.2.2</span> Model fit and inference</a></li>
</ul></li>
<li><a href="counts.html#understanding-example-1" id="toc-understanding-example-1"><span class="toc-section-number">18.3</span> Understanding Example 1</a>
<ul>
<li><a href="counts.html#modeling-strategy-1" id="toc-modeling-strategy-1"><span class="toc-section-number">18.3.1</span> Modeling strategy</a></li>
<li><a href="counts.html#model-checking-fits-to-count-data" id="toc-model-checking-fits-to-count-data"><span class="toc-section-number">18.3.2</span> Model checking fits to count data</a></li>
<li><a href="counts.html#biological-count-data-are-rarely-fit-well-by-a-poisson-glm.-instead-fit-a-quasi-poisson-or-negative-binomial-glm-model." id="toc-biological-count-data-are-rarely-fit-well-by-a-poisson-glm.-instead-fit-a-quasi-poisson-or-negative-binomial-glm-model."><span class="toc-section-number">18.3.3</span> Biological count data are rarely fit well by a Poisson GLM. Instead, fit a quasi-poisson or negative binomial GLM model.</a></li>
<li><a href="counts.html#a-glm-is-a-linear-model-on-the-link-scale" id="toc-a-glm-is-a-linear-model-on-the-link-scale"><span class="toc-section-number">18.3.4</span> A GLM is a linear model on the link scale</a></li>
<li><a href="counts.html#coeffecients-of-a-generalized-linear-model-with-a-log-link-function-are-on-the-link-scale." id="toc-coeffecients-of-a-generalized-linear-model-with-a-log-link-function-are-on-the-link-scale."><span class="toc-section-number">18.3.5</span> Coeffecients of a Generalized Linear Model with a log-link function are on the link scale.</a></li>
<li><a href="counts.html#modeled-means-in-the-emmeans-table-of-a-generalized-linear-model-can-be-on-the-link-scale-or-response-scale-report-the-response-scale" id="toc-modeled-means-in-the-emmeans-table-of-a-generalized-linear-model-can-be-on-the-link-scale-or-response-scale-report-the-response-scale"><span class="toc-section-number">18.3.6</span> Modeled means in the emmeans table of a Generalized Linear Model can be on the link scale or response scale – Report the response scale</a></li>
<li><a href="counts.html#some-consequences-of-fitting-a-linear-model-to-count-data" id="toc-some-consequences-of-fitting-a-linear-model-to-count-data"><span class="toc-section-number">18.3.7</span> Some consequences of fitting a linear model to count data</a></li>
</ul></li>
<li><a href="counts.html#example-2-use-a-glm-with-an-offset-instead-of-a-ratio-of-some-measurement-per-area-dna-damage-data-exp3b" id="toc-example-2-use-a-glm-with-an-offset-instead-of-a-ratio-of-some-measurement-per-area-dna-damage-data-exp3b"><span class="toc-section-number">18.4</span> Example 2 – Use a GLM with an offset instead of a ratio of some measurement per area (“dna damage” data exp3b)</a>
<ul>
<li><a href="counts.html#exp3b-dna-damage-data" id="toc-exp3b-dna-damage-data"><span class="toc-section-number">18.4.1</span> exp3b (“dna damage”) data</a></li>
<li><a href="counts.html#understand-the-data-4" id="toc-understand-the-data-4"><span class="toc-section-number">18.4.2</span> Understand the data</a></li>
<li><a href="counts.html#model-fit-and-inference-2" id="toc-model-fit-and-inference-2"><span class="toc-section-number">18.4.3</span> Model fit and inference</a></li>
</ul></li>
<li><a href="counts.html#understanding-example-2" id="toc-understanding-example-2"><span class="toc-section-number">18.5</span> Understanding Example 2</a>
<ul>
<li><a href="counts.html#an-offset-is-an-added-covariate-with-a-coefficient-fixed-at-1" id="toc-an-offset-is-an-added-covariate-with-a-coefficient-fixed-at-1"><span class="toc-section-number">18.5.1</span> An offset is an added covariate with a coefficient fixed at 1</a></li>
<li><a href="counts.html#glm-rate" id="toc-glm-rate"><span class="toc-section-number">18.5.2</span> A count GLM with an offset models the area-normalized means</a></li>
<li><a href="counts.html#compare-an-offset-to-an-added-covariate-with-an-estimated-coefficient" id="toc-compare-an-offset-to-an-added-covariate-with-an-estimated-coefficient"><span class="toc-section-number">18.5.3</span> Compare an offset to an added covariate with an estimated coefficient</a></li>
<li><a href="counts.html#issues-with-plotting" id="toc-issues-with-plotting"><span class="toc-section-number">18.5.4</span> Issues with plotting</a></li>
</ul></li>
<li><a href="counts.html#example-3-glm-models-for-binary-responses" id="toc-example-3-glm-models-for-binary-responses"><span class="toc-section-number">18.6</span> Example 3 – GLM models for binary responses</a></li>
<li><a href="counts.html#working-in-r-7" id="toc-working-in-r-7"><span class="toc-section-number">18.7</span> Working in R</a>
<ul>
<li><a href="counts.html#fitting-glms-to-count-data" id="toc-fitting-glms-to-count-data"><span class="toc-section-number">18.7.1</span> Fitting GLMs to count data</a></li>
<li><a href="counts.html#fitting-a-glm-to-a-continuous-conditional-response-with-right-skew." id="toc-fitting-a-glm-to-a-continuous-conditional-response-with-right-skew."><span class="toc-section-number">18.7.2</span> Fitting a GLM to a continuous conditional response with right skew.</a></li>
<li><a href="counts.html#fitting-a-glm-to-a-binary-success-or-failure-presence-or-absence-survived-or-died-response" id="toc-fitting-a-glm-to-a-binary-success-or-failure-presence-or-absence-survived-or-died-response"><span class="toc-section-number">18.7.3</span> Fitting a GLM to a binary (success or failure, presence or absence, survived or died) response</a></li>
<li><a href="counts.html#fitting-generalized-linear-mixed-models" id="toc-fitting-generalized-linear-mixed-models"><span class="toc-section-number">18.7.4</span> Fitting Generalized Linear Mixed Models</a></li>
</ul></li>
<li><a href="counts.html#model-checking-glms" id="toc-model-checking-glms"><span class="toc-section-number">18.8</span> Model checking GLMs</a></li>
<li><a href="counts.html#hidden-code-9" id="toc-hidden-code-9"><span class="toc-section-number">18.9</span> Hidden code</a>
<ul>
<li><a href="counts.html#import-example-1-data-exp3a-angiogenic-sprouts" id="toc-import-example-1-data-exp3a-angiogenic-sprouts"><span class="toc-section-number">18.9.1</span> Import Example 1 data (exp3a – “angiogenic sprouts”)</a></li>
</ul></li>
</ul></li>
<li><a href="gls.html#gls" id="toc-gls"><span class="toc-section-number">19</span> Linear models with heterogenous variance</a></li>
<li><a href="appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models.html#appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models" id="toc-appendix-an-example-set-of-analyses-of-experimental-data-with-linear-models">Appendix: An example set of analyses of experimental data with linear models</a></li>
<li><a href="ask1-bio.html#ask1-bio" id="toc-ask1-bio"><span class="toc-section-number">20</span> Background physiology to the experiments in Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a></li>
<li><a href="ask1-report.html#ask1-report" id="toc-ask1-report"><span class="toc-section-number">21</span> Analyses for Figure 2 of “ASK1 inhibits browning of white adipose tissue in obesity”</a>
<ul>
<li><a href="ask1-report.html#setup" id="toc-setup"><span class="toc-section-number">21.1</span> Setup</a></li>
<li><a href="ask1-report.html#data-source" id="toc-data-source"><span class="toc-section-number">21.2</span> Data source</a></li>
<li><a href="ask1-report.html#control-the-color-palette" id="toc-control-the-color-palette"><span class="toc-section-number">21.3</span> control the color palette</a></li>
<li><a href="ask1-report.html#useful-functions" id="toc-useful-functions"><span class="toc-section-number">21.4</span> useful functions</a></li>
<li><a href="ask1-report.html#figure-2b-effect-of-ask1-deletion-on-growth-body-weight" id="toc-figure-2b-effect-of-ask1-deletion-on-growth-body-weight"><span class="toc-section-number">21.5</span> figure 2b – effect of ASK1 deletion on growth (body weight)</a>
<ul>
<li><a href="ask1-report.html#figure-2b-import" id="toc-figure-2b-import"><span class="toc-section-number">21.5.1</span> figure 2b – import</a></li>
<li><a href="ask1-report.html#figure-2b-exploratory-plots" id="toc-figure-2b-exploratory-plots"><span class="toc-section-number">21.5.2</span> figure 2b – exploratory plots</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2c-effect-of-ask1-deletion-on-final-body-weight" id="toc-figure-2c-effect-of-ask1-deletion-on-final-body-weight"><span class="toc-section-number">21.6</span> Figure 2c – Effect of ASK1 deletion on final body weight</a>
<ul>
<li><a href="ask1-report.html#figure-2c-import" id="toc-figure-2c-import"><span class="toc-section-number">21.6.1</span> Figure 2c – import</a></li>
<li><a href="ask1-report.html#figure-2c-check-own-computation-of-weight-change-v-imported-value" id="toc-figure-2c-check-own-computation-of-weight-change-v-imported-value"><span class="toc-section-number">21.6.2</span> Figure 2c – check own computation of weight change v imported value</a></li>
<li><a href="ask1-report.html#figure-2c-exploratory-plots" id="toc-figure-2c-exploratory-plots"><span class="toc-section-number">21.6.3</span> Figure 2c – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2c-fit-the-model-m1-lm" id="toc-figure-2c-fit-the-model-m1-lm"><span class="toc-section-number">21.6.4</span> Figure 2c – fit the model: m1 (lm)</a></li>
<li><a href="ask1-report.html#figure-2c-check-the-model-m1" id="toc-figure-2c-check-the-model-m1"><span class="toc-section-number">21.6.5</span> Figure 2c – check the model: m1</a></li>
<li><a href="ask1-report.html#figure-2c-fit-the-model-m2-gamma-glm" id="toc-figure-2c-fit-the-model-m2-gamma-glm"><span class="toc-section-number">21.6.6</span> Figure 2c – fit the model: m2 (gamma glm)</a></li>
<li><a href="ask1-report.html#figure-2c-check-the-model-m2" id="toc-figure-2c-check-the-model-m2"><span class="toc-section-number">21.6.7</span> Figure 2c – check the model, m2</a></li>
<li><a href="ask1-report.html#figure-2c-inference-from-the-model" id="toc-figure-2c-inference-from-the-model"><span class="toc-section-number">21.6.8</span> Figure 2c – inference from the model</a></li>
<li><a href="ask1-report.html#figure-2c-plot-the-model" id="toc-figure-2c-plot-the-model"><span class="toc-section-number">21.6.9</span> Figure 2c – plot the model</a></li>
<li><a href="ask1-report.html#figure-2c-report" id="toc-figure-2c-report"><span class="toc-section-number">21.6.10</span> Figure 2c – report</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve" id="toc-figure-2d-effect-of-ask1-ko-on-glucose-tolerance-whole-curve"><span class="toc-section-number">21.7</span> Figure 2d – Effect of ASK1 KO on glucose tolerance (whole curve)</a>
<ul>
<li><a href="ask1-report.html#figure-2d-import" id="toc-figure-2d-import"><span class="toc-section-number">21.7.1</span> Figure 2d – Import</a></li>
<li><a href="ask1-report.html#figure-2d-exploratory-plots" id="toc-figure-2d-exploratory-plots"><span class="toc-section-number">21.7.2</span> Figure 2d – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2d-fit-the-model" id="toc-figure-2d-fit-the-model"><span class="toc-section-number">21.7.3</span> Figure 2d – fit the model</a></li>
<li><a href="ask1-report.html#figure-2d-check-the-model" id="toc-figure-2d-check-the-model"><span class="toc-section-number">21.7.4</span> Figure 2d – check the model</a></li>
<li><a href="ask1-report.html#figure-2d-inference" id="toc-figure-2d-inference"><span class="toc-section-number">21.7.5</span> Figure 2d – inference</a></li>
<li><a href="ask1-report.html#figure-2d-plot-the-model" id="toc-figure-2d-plot-the-model"><span class="toc-section-number">21.7.6</span> Figure 2d – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure" id="toc-figure-2e-effect-of-ask1-deletion-on-glucose-tolerance-summary-measure"><span class="toc-section-number">21.8</span> Figure 2e – Effect of ASK1 deletion on glucose tolerance (summary measure)</a>
<ul>
<li><a href="ask1-report.html#figure-2e-message-the-data" id="toc-figure-2e-message-the-data"><span class="toc-section-number">21.8.1</span> Figure 2e – message the data</a></li>
<li><a href="ask1-report.html#figure-2e-exploratory-plots" id="toc-figure-2e-exploratory-plots"><span class="toc-section-number">21.8.2</span> Figure 2e – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2e-fit-the-model" id="toc-figure-2e-fit-the-model"><span class="toc-section-number">21.8.3</span> Figure 2e – fit the model</a></li>
<li><a href="ask1-report.html#figure-2e-check-the-model" id="toc-figure-2e-check-the-model"><span class="toc-section-number">21.8.4</span> Figure 2e – check the model</a></li>
<li><a href="ask1-report.html#figure-2e-inference-from-the-model" id="toc-figure-2e-inference-from-the-model"><span class="toc-section-number">21.8.5</span> Figure 2e – inference from the model</a></li>
<li><a href="ask1-report.html#figure-2e-plot-the-model" id="toc-figure-2e-plot-the-model"><span class="toc-section-number">21.8.6</span> Figure 2e – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate" id="toc-figure-2f-effect-of-ask1-deletion-on-glucose-infusion-rate"><span class="toc-section-number">21.9</span> Figure 2f – Effect of ASK1 deletion on glucose infusion rate</a>
<ul>
<li><a href="ask1-report.html#figure-2f-import" id="toc-figure-2f-import"><span class="toc-section-number">21.9.1</span> Figure 2f – import</a></li>
<li><a href="ask1-report.html#figure-2f-exploratory-plots" id="toc-figure-2f-exploratory-plots"><span class="toc-section-number">21.9.2</span> Figure 2f – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2f-fit-the-model" id="toc-figure-2f-fit-the-model"><span class="toc-section-number">21.9.3</span> Figure 2f – fit the model</a></li>
<li><a href="ask1-report.html#figure-2f-check-the-model" id="toc-figure-2f-check-the-model"><span class="toc-section-number">21.9.4</span> Figure 2f – check the model</a></li>
<li><a href="ask1-report.html#figure-2f-inference" id="toc-figure-2f-inference"><span class="toc-section-number">21.9.5</span> Figure 2f – inference</a></li>
<li><a href="ask1-report.html#figure-2f-plot-the-model" id="toc-figure-2f-plot-the-model"><span class="toc-section-number">21.9.6</span> Figure 2f – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake" id="toc-figure-2g-effect-of-ask1-deletion-on-tissue-specific-glucose-uptake"><span class="toc-section-number">21.10</span> Figure 2g – Effect of ASK1 deletion on tissue-specific glucose uptake</a>
<ul>
<li><a href="ask1-report.html#figure-2g-import" id="toc-figure-2g-import"><span class="toc-section-number">21.10.1</span> Figure 2g – import</a></li>
<li><a href="ask1-report.html#figure-2g-exploratory-plots" id="toc-figure-2g-exploratory-plots"><span class="toc-section-number">21.10.2</span> Figure 2g – exploratory plots</a></li>
<li><a href="ask1-report.html#figure-2g-fit-the-model" id="toc-figure-2g-fit-the-model"><span class="toc-section-number">21.10.3</span> Figure 2g – fit the model</a></li>
<li><a href="ask1-report.html#figure-2g-check-the-model" id="toc-figure-2g-check-the-model"><span class="toc-section-number">21.10.4</span> Figure 2g – check the model</a></li>
<li><a href="ask1-report.html#figure-2g-inference" id="toc-figure-2g-inference"><span class="toc-section-number">21.10.5</span> Figure 2g – inference</a></li>
<li><a href="ask1-report.html#figure-2g-plot-the-model" id="toc-figure-2g-plot-the-model"><span class="toc-section-number">21.10.6</span> Figure 2g – plot the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2h" id="toc-figure-2h"><span class="toc-section-number">21.11</span> Figure 2h</a></li>
<li><a href="ask1-report.html#figure-2i-effect-of-ask1-deletion-on-liver-tg" id="toc-figure-2i-effect-of-ask1-deletion-on-liver-tg"><span class="toc-section-number">21.12</span> Figure 2i – Effect of ASK1 deletion on liver TG</a>
<ul>
<li><a href="ask1-report.html#figure-2i-fit-the-model" id="toc-figure-2i-fit-the-model"><span class="toc-section-number">21.12.1</span> Figure 2i – fit the model</a></li>
<li><a href="ask1-report.html#figure-2i-check-the-model" id="toc-figure-2i-check-the-model"><span class="toc-section-number">21.12.2</span> Figure 2i – check the model</a></li>
<li><a href="ask1-report.html#figure-2i-inference" id="toc-figure-2i-inference"><span class="toc-section-number">21.12.3</span> Figure 2i – inference</a></li>
<li><a href="ask1-report.html#figure-2i-plot-the-model" id="toc-figure-2i-plot-the-model"><span class="toc-section-number">21.12.4</span> Figure 2i – plot the model</a></li>
<li><a href="ask1-report.html#figure-2i-report-the-model" id="toc-figure-2i-report-the-model"><span class="toc-section-number">21.12.5</span> Figure 2i – report the model</a></li>
</ul></li>
<li><a href="ask1-report.html#figure-2j" id="toc-figure-2j"><span class="toc-section-number">21.13</span> Figure 2j</a></li>
</ul></li>
<li><a href="count-sim.html#count-sim" id="toc-count-sim"><span class="toc-section-number">22</span> Simulations – Count data (alternatives to a t-test)</a>
<ul>
<li><a href="count-sim.html#use-data-similar-to-figure-6f-from-example-1" id="toc-use-data-similar-to-figure-6f-from-example-1"><span class="toc-section-number">22.1</span> Use data similar to Figure 6f from Example 1</a></li>
<li><a href="count-sim.html#functions" id="toc-functions"><span class="toc-section-number">22.2</span> Functions</a></li>
<li><a href="count-sim.html#simulations" id="toc-simulations"><span class="toc-section-number">22.3</span> Simulations</a>
<ul>
<li><a href="count-sim.html#type-i-pseudo-normal-distribution" id="toc-type-i-pseudo-normal-distribution"><span class="toc-section-number">22.3.1</span> Type I, Pseudo-Normal distribution</a></li>
<li><a href="count-sim.html#type-i-neg-binom-equal-n" id="toc-type-i-neg-binom-equal-n"><span class="toc-section-number">22.3.2</span> Type I, neg binom, equal n</a></li>
<li><a href="count-sim.html#type-i-neg-binom-equal-n-small-theta" id="toc-type-i-neg-binom-equal-n-small-theta"><span class="toc-section-number">22.3.3</span> Type I, neg binom, equal n, small theta</a></li>
<li><a href="count-sim.html#type-i-neg-binom-unequal-n" id="toc-type-i-neg-binom-unequal-n"><span class="toc-section-number">22.3.4</span> Type I, neg binom, unequal n</a></li>
<li><a href="count-sim.html#power-pseudo-normal-distribution-equal-n" id="toc-power-pseudo-normal-distribution-equal-n"><span class="toc-section-number">22.3.5</span> Power, Pseudo-Normal distribution, equal n</a></li>
<li><a href="count-sim.html#power-neg-binom-equal-n" id="toc-power-neg-binom-equal-n"><span class="toc-section-number">22.3.6</span> Power, neg binom, equal n</a></li>
<li><a href="count-sim.html#power-neg-binom-small-theta" id="toc-power-neg-binom-small-theta"><span class="toc-section-number">22.3.7</span> Power, neg binom, small theta</a></li>
<li><a href="count-sim.html#power-neg-binom-unequal-n" id="toc-power-neg-binom-unequal-n"><span class="toc-section-number">22.3.8</span> Power, neg binom, unequal n</a></li>
<li><a href="count-sim.html#power-neg-binom-unequal-n-unequal-theta" id="toc-power-neg-binom-unequal-n-unequal-theta"><span class="toc-section-number">22.3.9</span> Power, neg binom, unequal n, unequal theta</a></li>
<li><a href="count-sim.html#type-1-neg-binom-equal-n-unequal-theta" id="toc-type-1-neg-binom-equal-n-unequal-theta"><span class="toc-section-number">22.3.10</span> Type 1, neg binom, equal n, unequal theta</a></li>
</ul></li>
<li><a href="count-sim.html#save-it-read-it" id="toc-save-it-read-it"><span class="toc-section-number">22.4</span> Save it, Read it</a></li>
<li><a href="count-sim.html#analysis" id="toc-analysis"><span class="toc-section-number">22.5</span> Analysis</a></li>
</ul></li>
<li><a href="appendix-1-getting-started-with-r.html#appendix-1-getting-started-with-r" id="toc-appendix-1-getting-started-with-r">Appendix 1: Getting Started with R</a>
<ul>
<li><a href="appendix-1-getting-started-with-r.html#get-your-computer-ready" id="toc-get-your-computer-ready"><span class="toc-section-number">22.6</span> Get your computer ready</a>
<ul>
<li><a href="appendix-1-getting-started-with-r.html#start-here" id="toc-start-here"><span class="toc-section-number">22.6.1</span> Start here</a></li>
<li><a href="appendix-1-getting-started-with-r.html#install-r" id="toc-install-r"><span class="toc-section-number">22.6.2</span> Install R</a></li>
<li><a href="appendix-1-getting-started-with-r.html#install-r-studio" id="toc-install-r-studio"><span class="toc-section-number">22.6.3</span> Install R Studio</a></li>
<li><a href="appendix-1-getting-started-with-r.html#install-r-markdown-1" id="toc-install-r-markdown-1"><span class="toc-section-number">22.6.4</span> Install R Markdown</a></li>
<li><a href="appendix-1-getting-started-with-r.html#optional-alternative-latex-installations" id="toc-optional-alternative-latex-installations"><span class="toc-section-number">22.6.5</span> (optional) Alternative LaTeX installations</a></li>
</ul></li>
<li><a href="appendix-1-getting-started-with-r.html#start-learning-r-studio" id="toc-start-learning-r-studio"><span class="toc-section-number">22.7</span> Start learning R Studio</a></li>
</ul></li>
<li><a href="appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r.html#appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r" id="toc-appendix-2-online-resources-for-getting-started-with-statistical-modeling-in-r">Appendix 2: Online Resources for Getting Started with Statistical Modeling in R</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics for Experimental Biology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Linear models with a single, continuous <em>X</em> (“regression”)</h1>
<div id="a-linear-model-with-a-single-continuous-x-is-classical-regression" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> A linear model with a single, continuous <em>X</em> is classical “regression”</h2>
<div id="analysis-of-green-down-data" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Analysis of “green-down” data</h3>
<p>To introduce some principles of modeling with a single continuous <span class="math inline">\(X\)</span> variable, I’ll use a dataset from</p>
<p><a href="https://doi.org/10.1038/s41586-018-0399-1" target="_blank">Richardson, A.D., Hufkens, K., Milliman, T. et al. Ecosystem warming extends vegetation activity but heightens vulnerability to cold temperatures. Nature 560, 368–371 (2018).</a></p>
<p><a href="https://www.nature.com/articles/s41586-018-0399-1#Sec15" target="_blank">Source data</a></p>
<p>The data are from a <a href="https://mnspruce.ornl.gov" target="_blank">long-term experiment on the effects of warming and CO2 on a high-carbon northern temperate peatland</a> and is the focal dataset of the study. The experiment involves 10 large, temperature and CO2 controlled enclosures. CO2 is set to 400 ppm in five enclosures and 900 ppm in five enclosures. Temperature of the five enclosures within each CO2 level is set to 0, 2.25, 4.5, 6.75, or 9 °C above ambient temperature. The multiple temperature levels is a <strong>regression design</strong>, which allows a researcher to measure non-linear effects. Read more about the experimental design and the <a href="https://mnspruce.ornl.gov/design" target="_blank">beautiful implementation</a>.</p>
<p>The question pursued is in this study is, what is the causal effect of warming on the timing (or phenology) of the transition into photosynthetic activity (“green-up”) in the spring and of the transition out of photosynthetic activity (“green-down”) in the fall? The researchers measured these transition dates, or Day of Year (DOY), using foliage color. Here, we focus on the transition out of photosynthesis or “green-down” DOY.</p>
<p><strong>Import the data</strong></p>
<ol style="list-style-type: decimal">
<li><strong>Examine the data</strong></li>
</ol>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="regression.html#cb186-1" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(<span class="at">x =</span> temperature,</span>
<span id="cb186-2"><a href="regression.html#cb186-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> transition_date,</span>
<span id="cb186-3"><a href="regression.html#cb186-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> fig2c) <span class="sc">+</span></span>
<span id="cb186-4"><a href="regression.html#cb186-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span>
<span id="cb186-5"><a href="regression.html#cb186-5" aria-hidden="true" tabindex="-1"></a>gg2 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(<span class="at">x =</span> temperature,</span>
<span id="cb186-6"><a href="regression.html#cb186-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> transition_date,</span>
<span id="cb186-7"><a href="regression.html#cb186-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> fig2c) <span class="sc">+</span></span>
<span id="cb186-8"><a href="regression.html#cb186-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>))</span>
<span id="cb186-9"><a href="regression.html#cb186-9" aria-hidden="true" tabindex="-1"></a>gg3 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(<span class="at">x =</span> temperature,</span>
<span id="cb186-10"><a href="regression.html#cb186-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> transition_date,</span>
<span id="cb186-11"><a href="regression.html#cb186-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> fig2c) <span class="sc">+</span></span>
<span id="cb186-12"><a href="regression.html#cb186-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb186-13"><a href="regression.html#cb186-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(gg1, gg2, gg3, <span class="at">ncol=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-vet-1.png" width="576" /></p>
<p>No plot shows any obvious outlier that might be due to measurement blunders or curation error. The linear regression in the left-most plot clearly shows that a linear response is sufficient to capture the effect of temperature on day of green-down.</p>
<ol start="2" style="list-style-type: decimal">
<li><p><strong>choose a model</strong>. Because the <span class="math inline">\(X\)</span> variable (<span class="math inline">\(temperature\)</span>) was experimentally set to five levels, the data could reasonably be modeled using either a linear model with a categorical <span class="math inline">\(X\)</span> or a linear model with a continuous <span class="math inline">\(X\)</span>. The advantage of modeling <span class="math inline">\(temperature\)</span> as a continuous variable is that there is only one effect, the slope of the regression line. If modeled as a categorical factor with five levels, there are, at a minimum, four interesting effects (the difference in means between each non-reference level and reference (temperature = 0) level). Also, for inference, modeling <span class="math inline">\(temperature\)</span> as a continuous variable increases power for hypothesis tests.</p></li>
<li><p><strong>fit the model</strong></p></li>
</ol>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="regression.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: fit the model</span></span>
<span id="cb187-2"><a href="regression.html#cb187-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(transition_date <span class="sc">~</span> temperature, <span class="at">data =</span> fig2c)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><strong>check the model</strong></li>
</ol>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="regression.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check normality assumption</span></span>
<span id="cb188-2"><a href="regression.html#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb188-3"><a href="regression.html#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(m1, <span class="at">id=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-check-qq-1.png" width="576" /></p>
<p>The Q-Q plot indicates the distribution of residuals is well within that expected for a normal sample and there is no cause for concern with inference.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="regression.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check homogeneity assumption</span></span>
<span id="cb189-2"><a href="regression.html#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spreadLevelPlot</span>(m1, <span class="at">id=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-check-spread-1.png" width="576" /></p>
<pre><code>## 
## Suggested power transformation:  0.6721303</code></pre>
<p>The spread-location plot shows no conspicuous trend in how the spread changes with the conditonal mean. There is no cause for concern with inference.</p>
<ol start="5" style="list-style-type: decimal">
<li><strong>inference from the model</strong></li>
</ol>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="regression.html#cb191-1" aria-hidden="true" tabindex="-1"></a>m1_coeff <span class="ot">&lt;-</span> <span class="fu">summary</span>(m1) <span class="sc">%&gt;%</span></span>
<span id="cb191-2"><a href="regression.html#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span>
<span id="cb191-3"><a href="regression.html#cb191-3" aria-hidden="true" tabindex="-1"></a>m1_confint <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1)</span>
<span id="cb191-4"><a href="regression.html#cb191-4" aria-hidden="true" tabindex="-1"></a>m1_coeff <span class="ot">&lt;-</span> <span class="fu">cbind</span>(m1_coeff, m1_confint)</span>
<span id="cb191-5"><a href="regression.html#cb191-5" aria-hidden="true" tabindex="-1"></a>m1_coeff</span></code></pre></div>
<pre><code>##               Estimate Std. Error   t value     Pr(&gt;|t|)      2.5 %     97.5 %
## (Intercept) 289.458750  3.0593949 94.613071 1.738650e-13 282.403773 296.513728
## temperature   4.982745  0.5541962  8.990941 1.866888e-05   3.704767   6.260724</code></pre>
<p>The effect of added temperature on the day of green-down is 4.98 d per 1 °C (95% CI: 3.7, 6.3; p &lt; 0.001).</p>
<ol start="6" style="list-style-type: decimal">
<li><strong>plot the model</strong></li>
</ol>
<div class="figure"><span style="display:block;" id="fig:continuous-x-plot"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-plot-1.png" alt="Modification of the published Figure 2c showing the experimental effect of warming on the date of autumn green-down (the transition to fall foliage color) in a mixed shrub community. The bottom panel is a scatterplot. The regression line shows the expected value of Y (transition day of year) given a value of X (added temperature). The slope of the regression line is the estimate of the effect. The estimate and 95% confidence interval of the estimate are given in the top panel." width="576" />
<p class="caption">
Figure 9.1: Modification of the published Figure 2c showing the experimental effect of warming on the date of autumn green-down (the transition to fall foliage color) in a mixed shrub community. The bottom panel is a scatterplot. The regression line shows the expected value of Y (transition day of year) given a value of X (added temperature). The slope of the regression line is the estimate of the effect. The estimate and 95% confidence interval of the estimate are given in the top panel.
</p>
</div>
<ol start="7" style="list-style-type: decimal">
<li>Report the results</li>
</ol>
<p>The modeled effect of added temperature is Slope: 4.98 (3.7, 6.26) d per 1 °C (<a href="regression.html#fig:continuous-x-plot">9.1</a>).</p>
</div>
<div id="learning-from-the-green-down-example" class="section level3" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Learning from the green-down example</h3>
<p>Figure <a href="regression.html#fig:continuous-x-plot">9.1</a> is a <strong>scatterplot</strong> with the green-down DOY for the mixed-shrub community on the <span class="math inline">\(Y\)</span> axis and added temperature on the <span class="math inline">\(X\)</span> axis. The line through the data is a regression line, which is the expected value of <em>Y</em> (green-down DOY) given a specific value of <em>X</em> (added temperature). The slope of the line is the <strong>effect</strong> of added temperature on timing of green-down. The intercept of the regression line is the value of the response (day of green-down) when <span class="math inline">\(X\)</span> is equal to zero. Very often, this value is not of interest although the value should be reported to allow predictions from the model. Also very often, the value of the intercept is not meaningful because a value of <span class="math inline">\(X = 0\)</span> is far outside the range of measured <span class="math inline">\(X\)</span>, or the value is absurd because it is impossible (for example, if investigating the effect of body weight on metabolic rate, the value <span class="math inline">\(weight = 0\)</span> is impossible).</p>
<p>The intercept and slope are the coefficients of the model fit to the data, which is</p>
<p><span class="math display" id="eq:continuous-x-fit">\[\begin{equation}
day_i = b_0 + b_1 temperature_i + e_i
\tag{9.1}
\end{equation}\]</span></p>
<p>where <em>day</em> is the day of green-down, <em>temperature</em> is the added temperature, and <em>i</em> refers (or “indexes”) the <em>i</em>th enclosure. This model completely reconstructs the day of green-down for all ten enclosures. For example, the day of green-down for enclosure 8 is</p>
<p><span class="math display">\[\begin{equation}
332 = 289.458750 + 4.982745 \times 6.73 + 9.00737
\end{equation}\]</span></p>
<p>The coefficients in the model are estimates of the parameters of the <strong>generating model</strong> fit to the data</p>
<p><span class="math display" id="eq:continuous-x-m1">\[\begin{align}
day &amp;= \beta_0 + \beta_1 temperature + \varepsilon\\
\varepsilon &amp;\sim N(0, \sigma^2)
\tag{9.2}
\end{align}\]</span></p>
<p>A generating model of the data is used to make inference, for example, a measure of uncertainty in a prediction in the timing of green-down with future warming, or a measure of uncertainty about the effect of temperature on green-down.</p>
</div>
<div id="using-a-regression-model-for-explanation-causal-models" class="section level3" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> Using a regression model for “explanation” – causal models</h3>
<p>In this text, “explanatory” means “causal” and a goal of explanatory modeling is the estimate of causal effects using a <strong>causal interpretation</strong> of the linear model (=regression) coefficients. “What what? I learned in my stats 101 course that we cannot interpret regression coefficients causally”.</p>
<p>Statisticians (and statistics textbooks) have been quite rigid that a regression coefficient has a descriptive (or “observational”, see below) interpretation but not a causal interpretation. At the same time, statisticians (and statistics textbooks) do not seem to have any issue with interpeting the modeled effects from an experiment causally, since this is how they are interpreted. But if the modeled effects are simply coefficients from a linear (= regression) model, then this historical practice is muddled.</p>
<p>Part of this muddled history arises from the use of “regression” for models fit to observational data with one or more continuous <span class="math inline">\(X\)</span> variables and the use of “ANOVA” for models fit to experimental data with one or more categorical <span class="math inline">\(X\)</span>. This separation seems to have blinded statisticians from working on the formal probabilistic statements underlying causal interpretations of effect estimates in ANOVA and the synthesis of these statements with the probabilistic statements in regression modeling. Two major approaches to developing formal, probabilistic statements of causal modeling in statistics are the <strong>Rubin causal model</strong> and the <strong>do-operator</strong> of Pearl. Despite the gigantic progress in these approaches, little to none of this has found its way into biostatistics textbooks.</p>
<div id="what-a-regression-coefficient-means" class="section level4" number="9.1.3.1">
<h4><span class="header-section-number">9.1.3.1</span> What a regression coefficient means</h4>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>Description: when we saw a one unit larger value in <em>X</em>, we saw, on average, a difference of <em>b</em> in <em>Y</em>.</p>
<p>Prediction: when we see a one unit larger value in <em>X</em>, we expect to see a difference of <em>b</em> in <em>Y</em>.</p>
<p>Explanation (causation): when we set <em>X</em> to have one unit larger value, we expect <em>Y</em> to change by <em>b</em>.</p>
</div>
<p>A linear (“regression”) model coefficient, such as the coefficient for temperature, <span class="math inline">\(\beta_1\)</span>, has three interpretations, an <strong>observational</strong> interpretation, a <strong>predictive interpretation</strong>, and a <strong>causal interpretation</strong>. This text is about causal interpretations, but to explain was is meant by this, I need to clarify the differences between causal and observational interpretations.</p>
<p>To clarify the differences, it’s useful to remember that an expected value from a regression model is a <strong>conditional mean</strong></p>
<p><span class="math display" id="eq:continuous-x-conditional-mean">\[\begin{equation}
\textrm{E}[day|temperature] = \beta_0 + \beta_1 temperature
\tag{9.3}
\end{equation}\]</span></p>
<p>In words “the expected value of day conditional on temperature is beta-knot plus beta-one times temperature”. An <strong>expected value</strong> is a long run average – if we had an infinite number of enclosures with <span class="math inline">\(temperature=x\)</span> (where <span class="math inline">\(x\)</span> is a specific value of added temperature, say 2.5 °C), the average <span class="math inline">\(day\)</span> of these enclosures is <span class="math inline">\(\beta_0 + \beta_1 x\)</span>.</p>
<p>The parameter <span class="math inline">\(\beta_1\)</span> is a <em>difference</em> in conditional means.</p>
<p><span class="math display" id="eq:beta">\[\begin{equation}
\beta_1 = \textrm{E}[day|temperature = x+1] - \textrm{E}[day|temperature = x]
\tag{9.4}
\end{equation}\]</span></p>
<p>In words, “beta-one is the expected value of day of green-down when the temperature equals x + 1 minus the expected value of day of green-down when the temperature equals x.” A very short way to state this is “beta-one is a difference in conditional means”.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>tl;dr. Note that the “+ 1” in this definition is mere convenience. Since the slope of a line is <span class="math inline">\(\frac{y_2 - y_1}{x_2 - x_1}\)</span>, where (<span class="math inline">\(x_1\)</span>, <span class="math inline">\(y_1\)</span>) and (<span class="math inline">\(x_2\)</span>, <span class="math inline">\(y_2\)</span>) are the coordinates of any two points on the line, it is convenient to choose two points that differ in <span class="math inline">\(X\)</span> by one unit, which makes the fraction equal to the numerator only. The numerator is a difference in conditional means. It is also why the units of a regression coefficient are “per unit of <span class="math inline">\(X\)</span> even if defined as a difference in two <span class="math inline">\(Y\)</span> values.</p>
</div>
<p>The difference between observational and causal interpretations of <span class="math inline">\(\beta_1\)</span> depends on the “event” conditioned on in <span class="math inline">\(\textrm{E}[day|temperature]\)</span>. Let’s start with the causal interpretation, which is how we should think about the regression coefficients in the green-down experiment.</p>
</div>
<div id="causal-interpretation-conditional-on-doing-x-x" class="section level4" number="9.1.3.2">
<h4><span class="header-section-number">9.1.3.2</span> Causal interpretation – conditional on “doing” X = x</h4>
<p>In the causal interpretation of regression, <span class="math inline">\(\textrm{E}[day|temperature]\)</span> is conditioned on “doing” a real or hypothetical intervention in the system where we set the value of <span class="math inline">\(temperature\)</span> to a specific value <span class="math inline">\(x\)</span> (“<span class="math inline">\(temperature=x\)</span>), while keeping everything else about the system the same. This can be stated explicitly as <span class="math inline">\(\textrm{E}[day|\;do\;temperature = x]\)</span>. Using the do-operator, we can interpret <span class="math inline">\(\beta_1\)</span> as an <strong>effect coefficient</strong>.</p>
<p><span class="math display">\[\begin{equation}
\beta_1 = \textrm{E}[day|\;do\;temperature = x+1] - \textrm{E}[day|\;do\;temperature = x]
\end{equation}\]</span></p>
<p>In words, “beta-one is the expected value of day of green-down were we to set the temperature to x + 1, minus the expected value of day of green-down were we to set the temperature to x.”</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>tl;dr. In the green-down experiment, the researchers didn’t set the temperature in the intervened enclosures to the ambient temperature + 1 but to ambient + 2.25, ambient + 4.5, ambient + 6.75, and ambient + 9.0. Again (see tl;dr above), the + 1 is mere convenience in the definition.</p>
</div>
</div>
<div id="observational-interpretation-conditional-on-seeing-x-x." class="section level4" number="9.1.3.3">
<h4><span class="header-section-number">9.1.3.3</span> Observational interpretation – conditional on “seeing” X = x.</h4>
<p>In the observational interpretation of regression, <span class="math inline">\(\textrm{E}[day|temperature]\)</span> is conditioned on sampling data and “seeing” a value of <span class="math inline">\(temperature\)</span>. We can state this explicitly as <span class="math inline">\(\textrm{E}[day|\;see\;temperature]\)</span>. From this, we can interpret <span class="math inline">\(\beta_1\)</span> as an <strong>observational coefficient</strong></p>
<p><span class="math display">\[\begin{equation}
\beta_1 = \textrm{E}[day|\;see\;temperature = x+1] - \textrm{E}[day|\;see \;temperature = x]
\end{equation}\]</span></p>
<p>In words, “beta-one is the expected value of day of green-down when see that temperature equals x + 1 minus the expected value of day of green-down when we see that temperature equals x.” To understand what I mean by “observational”, let’s imagine that the green-down data do not come from an experiment in which the researchers intervened and set the added temperature to a specifc value but from ten sites that naturally vary in mean annual temperature. Or from a single site with 10 years of data, with some years warmer and some years colder. Data from this kind of study is <strong>observational</strong> – the researcher didn’t intervene and set the <span class="math inline">\(X\)</span> values but merely observed the <span class="math inline">\(X\)</span> values.</p>
<p>If we sample (or “see”) a site with a mean annual temperature that is 2.5 °C above a reference value, the expected day of green-down is <span class="math inline">\(\textrm{E}[day|temperature = 2.5 °C]\)</span>. That is, values near <span class="math inline">\(\textrm{E}[day|temperature = 2.5 °C]\)</span> are more probable than values away from <span class="math inline">\(\textrm{E}[day|temperature = 2.5 °C]\)</span>. Or, if the only information that we have about this site is a mean annual temperature that is 2.5 °C above some reference, then our best prediction of the day of green-down would be <span class="math inline">\(\textrm{E}[day|temperature = 2.5 °C]\)</span>. We do not claim that the 4.98 day delay in green-down is caused by the warmer temperature, only that this is the expected delay relative to the reference having seen the data.</p>
<p>The seeing interpretation of a regression coefficient is <strong>descriptive</strong>– it is a description of a mathematical relationship. In this interpretation, the coefficient is not causal in the sense of what the expected <strong>response</strong> in <span class="math inline">\(Y\)</span> would be were we to intervene in the system and change <span class="math inline">\(X\)</span> from <span class="math inline">\(x\)</span> to <span class="math inline">\(x+1\)</span>.</p>
</div>
<div id="omitted-variable-bias" class="section level4" number="9.1.3.4">
<h4><span class="header-section-number">9.1.3.4</span> Omitted variable bias</h4>
<p>What is the consequence of interpreting a regression coefficient causally instead of observationally?</p>
<div class="figure"><span style="display:block;" id="fig:continuous-x-dag"></span>
<img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-dag-1.png" alt="a Directed Acyclic (or causal) Graph of a hypothetical world where the day of green-down is caused by two, correlated environmental variables, temperature and moisture, and to a noise factor (U) that represents an unspecified set of additional variables that are not correlated to either temperature or moisture." width="576" />
<p class="caption">
Figure 9.2: a Directed Acyclic (or causal) Graph of a hypothetical world where the day of green-down is caused by two, correlated environmental variables, temperature and moisture, and to a noise factor (U) that represents an unspecified set of additional variables that are not correlated to either temperature or moisture.
</p>
</div>
<p>Let’s expand the thought experiment where we have an observational data set of green down dates. In this thought experiment, only two variables systematically affect green-down DOY. The first is the temperature that the plants experience; the effect of <span class="math inline">\(temperature\)</span> is <span class="math inline">\(\beta_1\)</span>. The second is the soil moisture that the plants experience; the effect of <span class="math inline">\(moisture\)</span> is <span class="math inline">\(\beta_2\)</span>. <span class="math inline">\(temperature\)</span> and <span class="math inline">\(moisture\)</span> are correlated with a value <span class="math inline">\(\rho\)</span>. This causal model is graphically represented by the <strong>causal graph</strong> above.</p>
<p>Lets fit two linear models.</p>
<p><span class="math display">\[\begin{align}
(\mathcal{M}_1)\; day &amp;= b_0 + b_1 \; temperature + b_2 \; moisture + \varepsilon\\
(\mathcal{M}_2)\; day &amp;= b_0 + b_1 \; temperature + \varepsilon
\end{align}\]</span></p>
<p><span class="math inline">\(\mathcal{M}_1\)</span> the linear model including both <span class="math inline">\(temperature\)</span> and <span class="math inline">\(moisture\)</span> as <span class="math inline">\(X\)</span> variables and <span class="math inline">\(\mathcal{M}_2\)</span> the linear model including only <span class="math inline">\(temperature\)</span> as an <span class="math inline">\(X\)</span> variable. Given the true causal model above, <span class="math inline">\(b_1\)</span> is an <strong>unbiased</strong> estimate of the true causal effect of temperature <span class="math inline">\(\beta_1\)</span> in <span class="math inline">\(\mathcal{M}_1\)</span> because the expected value of <span class="math inline">\(b_1\)</span> is <span class="math inline">\(\beta_1\)</span>. By contrast, <span class="math inline">\(b_1\)</span> is a <strong>biased</strong> estimate of the true causal effect of temperature <span class="math inline">\(\beta_1\)</span> in <span class="math inline">\(\mathcal{M}_2\)</span>. The expected value of <span class="math inline">\(b_1\)</span> in <span class="math inline">\(\mathcal{M}_2\)</span> is the true, causal effect plus a bias term.</p>
<p><span class="math display">\[\begin{equation}
\mathrm{E}(b_1|\mathcal{M}_1) = \beta + \rho \alpha \frac{\sigma_{moisture}}{\sigma_{temperature}}
\end{equation}\]</span></p>
<p>This bias (<span class="math inline">\(\rho \alpha \frac{\sigma_{moisture}}{\sigma_{temperature}}\)</span>) is <strong>omitted variable bias</strong>. The omitted variable <span class="math inline">\(moisture\)</span> is an unmeasured, <strong>confounding variable</strong>. A variable <span class="math inline">\(X_2\)</span> is a confounder for variable <span class="math inline">\(X_1\)</span> if <span class="math inline">\(X_2\)</span> has both a correlation with <span class="math inline">\(X_1\)</span> and a path to the response <span class="math inline">\(Y\)</span> that is not through <span class="math inline">\(X_1\)</span>. With ommitted variable bias, as we sample more and more data, our estimate of the effect doesn’t converge on the truth but the truth plus some bias.</p>
</div>
<div id="causal-modeling-with-experimental-versus-observational-data" class="section level4" number="9.1.3.5">
<h4><span class="header-section-number">9.1.3.5</span> Causal modeling with experimental versus observational data</h4>
<p>Causal interpretation requires conditioning on “doing X=x”. For the green-down data, “doing X=x” is achieved by the random treatment assignment of the enclosures. How does random treatment assignment achieve this? Look again at Figure <a href="regression.html#fig:continuous-x-dag">9.2</a>. If the values of <span class="math inline">\(treatment\)</span> are randomly assigned, then, by definition, the expected value of the correlation between <span class="math inline">\(treatment\)</span> and <span class="math inline">\(moisture\)</span> is zero. In fact, the expected value of the correlation between <span class="math inline">\(treatment\)</span> and any measurable variable at the study site is zero. Given, this, the expected value of the regression coefficient for <span class="math inline">\(temperature\)</span> (<span class="math inline">\(b_1\)</span>) is <span class="math inline">\(\beta\)</span> because <span class="math inline">\(\rho=0\)</span>. That is, the estimate of the true effect is unbiased. It doesn’t matter if <span class="math inline">\(moisture\)</span>, or any other variable, is excluded from the model. (That said, we may want to include moisture or other variables in the model to increase precision of the causal effect. This is addressed in the chapter “Models with Covariates”). This is what an experiment does and why experiments are used to answer causal questions.</p>
<p>Can we use observational data for causal modeling? Yes, but the methods for this are outside of the scope of this text. The mathematical foundation for this is known as <strong>path analysis</strong>, which was developed by geneticist and evolutionary biologist Sewell Wright (I include this because this work has inspired much of how I think about biology and because he is both my academic grandfather and great-grandfather). Causal analysis of observational data in biology is rare outside of ecology and epidemiology. Good starting points for the modern development of causal analysis are <a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/" target="_blank">Hernán MA and Robins JM (2020)</a> and <a href="https://www.annualreviews.org/doi/abs/10.1146/annurev-genom-083117-021731" target="_blank">Burgess et al. (2018)</a>. A gentle introduction is <a href="https://www.basicbooks.com/titles/judea-pearl/the-book-of-why/9780465097609/" target="_blank">Pearl and Mackenzie (2018)</a>.</p>
</div>
</div>
<div id="using-a-regression-model-for-prediction-prediction-models" class="section level3" number="9.1.4">
<h3><span class="header-section-number">9.1.4</span> Using a regression model for prediction – prediction models</h3>
<p>The researchers in the green-down study also presented estimates of the effect of temperature on green-down using two observational datasets. Let’s use the one in Extended Data Figure 3d to explore using a regression model for prediction. The data are taken from measurements of the day of green-down over an 86 year period at a single site. The response variable is <span class="math inline">\(green\_down\_anomaly\)</span> (the difference between the day of green down for the year and the mean of these days over the 86 years). The predictor variable is <span class="math inline">\(autumn\_temp\_anomaly\)</span> (the difference between the mean temperature over the year and the mean of these means).</p>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-pred-fig-1.png" width="576" /></p>
<p>The plot in figure <a href="#fig:continuous-x-pred-fig"><strong>??</strong></a> shows the regression line of a linear model fit to the data. Two statistics are given in the plot.</p>
<ol style="list-style-type: decimal">
<li>The <em>p</em>-value of the slope (the coefficient <span class="math inline">\(b_1\)</span> of <span class="math inline">\(autumn\_temp\_anomaly\)</span>)</li>
<li>The <span class="math inline">\(R^2\)</span> of the model fit.</li>
</ol>
<p>In addition, two intervals are shown.</p>
<ol style="list-style-type: decimal">
<li>95% <strong>confidence interval</strong> of the expected values in blue. The width of this band is a measure of the precision of the estimates of expected values.</li>
<li>95% <strong>prediction interval</strong> of the predictions in gray. The width of this band is a measure of how well the model predicts.</li>
</ol>
<p>It is important that researchers knows what each of these statistics and bands are, when to compute them and when to ignore them them, and what to say about each when communicating the results.</p>
<div id="ci-and-p-value" class="section level4" number="9.1.4.1">
<h4><span class="header-section-number">9.1.4.1</span> 95% CI and <em>p</em>-value</h4>
<p>Both the 95% confidence interval of the expected values and the <em>p</em>-value are a function of the standard error of the slope coefficient <span class="math inline">\(b_1\)</span> and so are complimentary statistics. The <em>p</em>-value is the probability of sampling the null that results in a <span class="math inline">\(t\)</span>-value as or more extreme than the observed <em>t</em> for the coefficient <span class="math inline">\(b_1\)</span>. This null includes the hypothesis <span class="math inline">\(\beta_1 = 0\)</span>. The 95% confidence interval of the expected values is the band containing expected values (mean <span class="math inline">\(green\_down\_anomaly\)</span> conditional on <span class="math inline">\(autumn\_temp\_anomaly\)</span>) that are compatible with the data. There are a couple of useful ways of thinking about this band.</p>
<ol style="list-style-type: decimal">
<li>The band captures an infinite number of regression lines that are compatible with the data. Some are more steep and predict smaller expected values at the low end of <span class="math inline">\(autumn\_temp\_anomaly\)</span> and higher expected values at the high end of <span class="math inline">\(autumn\_temp\_anomaly\)</span>. Others are less steep and predict higher expected values at the low end of <span class="math inline">\(autumn\_temp\_anomaly\)</span> and lower expected values at the high end of <span class="math inline">\(autumn\_temp\_anomaly\)</span>.</li>
<li>The band captures the 95% CI of the conditional mean at every value of <span class="math inline">\(X\)</span>. Consider the 95% CI of the conditional mean at the mean value of <span class="math inline">\(X\)</span>. As we move away from this mean value (lower to higher <span class="math inline">\(X\)</span>), the 95% CI of the conditional mean increases.</li>
</ol>
<p>A 95% CI and <em>p</em>-value are useful statistics to report if the purpose is <em>causal modeling</em>, as in the example above using the experimental green-down data (where the 95% CI was not presented as a confidence band of the expected values but a CI of the estimate of the effect of added temperature). A 95% CI and <em>p</em>-value are also useful statistics to report if the purpose is <em>descriptive modeling</em>, simply wanting to know how the conditional mean of the response is related to an <span class="math inline">\(X\)</span> variable.</p>
</div>
<div id="prediction-interval-and-r2" class="section level4" number="9.1.4.2">
<h4><span class="header-section-number">9.1.4.2</span> 95% prediction interval and <span class="math inline">\(R^2\)</span></h4>
<p>Both the <span class="math inline">\(R^2\)</span> and the 95% prediction interval are a function of the <em>population</em> variability of <span class="math inline">\(green\_down\_anomaly\)</span> conditional on <span class="math inline">\(autumn\_temp\_anomaly\)</span> (the spread of points along a vertical axis about the regression line) and are complimentary statistics. Briefly,</p>
<ol style="list-style-type: decimal">
<li>the <span class="math inline">\(R^2\)</span> is a measure of the fraction of the variance in the response that is accounted by the model (some sources say “explained by the model” but this is an odd use of “explain”). It is a number between 0 and 1 and is a measure of “predictability” if the goal is prediction modeling.</li>
<li>The 95% prediction interval will contain a new observation 95% of the time. It provides bounds on a <strong>prediction</strong> – given a new observation, there is a 95% probability that the interval at <span class="math inline">\(x_{new}\)</span> will contain <span class="math inline">\(y_{new}\)</span>.</li>
</ol>
<p>To understand <span class="math inline">\(R^2\)</span> and the 95% prediction interval a bit better, let’s back up.</p>
<p><span class="math display">\[\begin{equation}
green\_down\_anomaly_i = b_0 + b_1 autumn\_temp\_anomaly_i + e_i
(\#eq:doy_fit)
\end{equation}\]</span></p>
<p>Model @ref(eq:eq:doy_fit) recovers the measured value of <span class="math inline">\(green\_down\_anomaly\)</span> for any year, given the <span class="math inline">\(autumn\_temp\_anomaly\)</span> for the year. The equation includes the linear predictor (<span class="math inline">\(b_0 + b_1 autumn\_temp\_anomaly_i\)</span>) and the <strong>residual</strong> from the predictor (<span class="math inline">\(e_i\)</span>). The predictor part of @ref(eq:doy_fit) is used to compute <span class="math inline">\(\hat{y}\)</span> (“y hat”).</p>
<p><span class="math display">\[\begin{equation}
\hat{y}_i = b_0 + b_1 autumn\_temp\_anomaly_i
(\#eq:doy_hat)
\end{equation}\]</span></p>
<p>The <span class="math inline">\(\hat{y}\)</span> are <strong>fitted values</strong>, if the values are computed from the data that were used for the fit, or <strong>predicted values</strong> (or simply the <strong>prediction</strong>), if the values are computed from values of the predictor variables outside the set used to fit the model. For the purpose of plotting, generally, with models with categorical factors as <span class="math inline">\(X\)</span>, I prefer either <strong>modeled values</strong> or <strong>conditional means</strong> to fitted values.</p>
</div>
<div id="r2" class="section level4" number="9.1.4.3">
<h4><span class="header-section-number">9.1.4.3</span> <span class="math inline">\(R^2\)</span></h4>
<p>A good model accounts for a sizable fraction of the total variance in the response. This fraction is the <span class="math inline">\(R^2\)</span> value, which is given in <code>summary(m1)</code> and accessed directly with</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="regression.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.1305754</code></pre>
<p><span class="math inline">\(R^2\)</span> is the fraction of the total variance of <span class="math inline">\(Y\)</span> that is generated by the linear predictor.</p>
<p><span class="math display">\[\begin{equation}
R^2 = \frac{\mathrm{VAR}(\hat{y})}{\mathrm{VAR}(y)}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="regression.html#cb195-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(m1)</span>
<span id="cb195-2"><a href="regression.html#cb195-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> efig_3d[, green_down_anomaly]</span>
<span id="cb195-3"><a href="regression.html#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(yhat)<span class="sc">/</span><span class="fu">var</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.1305754</code></pre>
<p><span class="math inline">\(R^2\)</span> will vary from zero (the model accounts for nothing) to one (the model accounts for everything). <span class="math inline">\(R^2\)</span> is often described as the fraction of total variation <em>explained</em> by the model” but the usage of “explain” is observational and not causal. Because of the ambiguous usage of “explain” in statistics, I prefer to avoid the word.</p>
<p>It can be useful sometimes to think of <span class="math inline">\(R^2\)</span> in terms of <strong>residual error</strong>, which is the variance of the residuals from the model. The larger the residual error, the smaller the <span class="math inline">\(R^2\)</span>, or</p>
<p><span class="math display">\[\begin{equation}
R^2 = 1 - \frac{\mathrm{VAR}(e)}{\mathrm{VAR}(y)}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="regression.html#cb197-1" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">residuals</span>(m1)</span>
<span id="cb197-2"><a href="regression.html#cb197-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> efig_3d[, green_down_anomaly]</span>
<span id="cb197-3"><a href="regression.html#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">var</span>(e)<span class="sc">/</span><span class="fu">var</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.1305754</code></pre>
<p>The smaller the residuals, the higher the <span class="math inline">\(R^2\)</span> and the closer the predicted values are to the measured values. The sum of the model variance and residual variance equals the total variance and, consequently, <span class="math inline">\(R^2\)</span> is a signal to signal + noise ratio. The noise in <span class="math inline">\(R^2\)</span> is the sampling variance of the individual measures. The noise in a <em>t</em>-value is the sampling variance of the parameter (for m1, this is the sampling variance of <span class="math inline">\(b_1\)</span>). This is an important distinction because it means that <em>t</em> and <span class="math inline">\(R^2\)</span> are not related 1:1. In a simple model with only a single <span class="math inline">\(X\)</span>, one might expect <span class="math inline">\(R^2\)</span> to be big if the <em>p</em>-value for the slope is tiny, but this isn’t necessarily true because of the different meaning of noise in each. A study with a very large sample size <span class="math inline">\(n\)</span> can have a tiny <em>p</em>-value <em>and</em> a small <span class="math inline">\(R^2\)</span>. A <em>p</em>-value is not a good indicator of predictability. <span class="math inline">\(R^2\)</span> is. This is explored more below.</p>
</div>
<div id="prediction-interval" class="section level4" number="9.1.4.4">
<h4><span class="header-section-number">9.1.4.4</span> Prediction interval</h4>
<p>A good prediction model has high predictability, meaning the range of predicted values is narrow. A 95% CI is a reasonable range to communicate. For any decision making using prediction, it is better to look at numbers than a band on a plot.</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
Autumn Temp Anomaly (°C)
</th>
<th style="text-align:right;">
Expected (days)
</th>
<th style="text-align:right;">
2.5% (days)
</th>
<th style="text-align:right;">
97.5% (days)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
-8.7
</td>
<td style="text-align:right;">
10.3
</td>
</tr>
<tr>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1.6
</td>
<td style="text-align:right;">
-7.9
</td>
<td style="text-align:right;">
11.1
</td>
</tr>
<tr>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
2.4
</td>
<td style="text-align:right;">
-7.2
</td>
<td style="text-align:right;">
12.0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
-6.4
</td>
<td style="text-align:right;">
12.8
</td>
</tr>
<tr>
<td style="text-align:right;">
2.5
</td>
<td style="text-align:right;">
4.0
</td>
<td style="text-align:right;">
-5.7
</td>
<td style="text-align:right;">
13.7
</td>
</tr>
</tbody>
</table>
<p>Given these data and the fit model, if we see a 2 °C increase in mean fall temperature, we expect the autumn green-down to extend 3.2 days. This expectation is an average. We’d expect 95% of actual values to range between -6.4 days and 12.8 days. This is a lot of variability. Any prediction has a reasonable probability of being over a week early or late. This may seem surprising given the <em>p</em>-value of the fit, which is 0.0006. But the <em>p</em>-value is not a reliable indicator of predictability. It is a statistic related to the blue band, not the gray band.</p>
<p>To understand this prediction interval a bit more, and why a <em>p</em>-value is not a good indicator of predictability, it’s useful to understand what makes a prediction interval “wide”. The width of the prediction interval is a function of two kinds of variability</p>
<ol style="list-style-type: decimal">
<li>The variance of the expected value at a specific value of <span class="math inline">\(X\)</span>. This is the square of the standard error of <span class="math inline">\(b_1\)</span>. The blue band is communicating the CI based on this variance. The <em>p</em>-value is related to the wideth of this band.</li>
<li>The variance of <span class="math inline">\(Y\)</span> at a specific value of <span class="math inline">\(X\)</span>. This variance is <span class="math inline">\(\sigma^2\)</span>. It is useful for learning to think about the equation for the estimate of this variance.</li>
</ol>
<p><span class="math display">\[\begin{equation}
\hat\sigma^2 = \frac{\sum{e_i^2}}{N-2}
\end{equation}\]</span></p>
<p>Again, <span class="math inline">\(e_i\)</span> is the residual for the <em>i</em>th case. The denominator (<span class="math inline">\(N-2\)</span>) is the degrees of freedom of the model. Computing <span class="math inline">\(\hat\sigma^2\)</span> manually helps to insure that we understand what is going on.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="regression.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)<span class="sc">$</span>sigma <span class="co"># R&#39;s calculation of sigma hat</span></span></code></pre></div>
<pre><code>## [1] 4.736643</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="regression.html#cb201-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">summary</span>(m1)<span class="sc">$</span>df[<span class="dv">2</span>] <span class="co"># R&#39;s calculation of df. Check that this is n-2!</span></span>
<span id="cb201-2"><a href="regression.html#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>(e<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>df)</span></code></pre></div>
<pre><code>## [1] 4.736643</code></pre>
<p>Remember that an assumption of the linear models that we are working with at this point is, this variance is constant for all values of <span class="math inline">\(X\)</span>, so we have a single <span class="math inline">\(\sigma\)</span>. Later, we will cover linear models that model heterogeneity in this variance. <span class="math inline">\(\sigma\)</span> is a function of variability in the population – it is the population standard deviation conditional on <span class="math inline">\(X\)</span>.</p>
<p>Importantly, predictability is a function of both these components of variability. As a consequence, it is <span class="math inline">\(R^2\)</span>, and not the <em>p</em>-value, that is the indicator of predictability. In the observational green-down data, even if we had thousands of years of data, we would still have a pretty low <span class="math inline">\(R^2\)</span> because of the population variability of <span class="math inline">\(green\_down\_anomaly\)</span> at a given <span class="math inline">\(autumn\_temp\_anomaly\)</span>.</p>
</div>
<div id="median-absolute-error-and-root-mean-square-error-are-absolute-measures-of-predictability" class="section level4" number="9.1.4.5">
<h4><span class="header-section-number">9.1.4.5</span> Median Absolute Error and Root Mean Square Error are absolute measures of predictability</h4>
<p>A <em>p</em>-value is not <em>at all</em> a good guide to predictability. <span class="math inline">\(R^2\)</span> is proportional to predictability but is not really useful in any absolute sense. If we want to predict the effect of warming on the day of green-down, I would like to have a measure of predictability in the units of green-down, which is days. The prediction interval gives this for any value of <span class="math inline">\(X\)</span>. But what about an overall measure of predictability?</p>
<p>Three overall measures of predictability are</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\hat{\sigma}\)</span>, the estimate of <span class="math inline">\(\sigma\)</span>. This is the standard deviation of the sample conditional on <span class="math inline">\(X\)</span>.</li>
<li><span class="math inline">\(RMSE\)</span>, the root mean squared error. This is</li>
</ol>
<p><span class="math display">\[\begin{align}
SSE &amp;= \sum{(y_i - \hat{y}_i)^2}\\
MSE &amp;= \frac{SSE}{N}\\
RMSE &amp;= \sqrt{MSE}
\end{align}\]</span></p>
<p><span class="math inline">\(SSE\)</span> (“sum of squared error”) is the sum of the squared residuals (<span class="math inline">\(y_i - \hat{y}_i\)</span>) of the model. <span class="math inline">\(MSE\)</span> (“mean squared error”) is the mean of the squared errors. <span class="math inline">\(RMSE\)</span> is the square root of the mean squared error. <span class="math inline">\(RMSE\)</span> is almost equal to <span class="math inline">\(\hat{\sigma}\)</span>. The difference is the denominator, which is <span class="math inline">\(N\)</span> in the computation of <span class="math inline">\(RMSE\)</span> and <span class="math inline">\(df\)</span> (the degrees of freedom of the model, which is <span class="math inline">\(N\)</span> minus the number of fit parameters) in the computation of <span class="math inline">\(\hat{\sigma}\)</span>.</p>
<ol start="3" style="list-style-type: decimal">
<li><span class="math inline">\(MAE\)</span>, the mean absolute error. This is</li>
</ol>
<p><span class="math display">\[\begin{equation}
MAE = \frac{1}{N}\sum{|y_i - \hat{y}_i|}
\end{equation}\]</span></p>
<table>
<thead>
<tr>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
RMSE
</th>
<th style="text-align:right;">
MAE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4.74
</td>
<td style="text-align:right;">
4.68
</td>
<td style="text-align:right;">
3.58
</td>
</tr>
</tbody>
</table>
<p>If the goal of an analysis is prediction, one of these statistics should be reported. For the model fit to the observational green-down data in Extended Figure 3d, these three statistics are given in Table <a href="#table:continuous-x-average-error"><strong>??</strong></a> above (to two decimal places simply to show numerical difference between <span class="math inline">\(\hat{\sigma}\)</span> and <span class="math inline">\(RMSE\)</span>). All of these are measures of an “average” prediction error in the units of the response. The average error is either 4.7 or 3.6 days, depending on which statistic we report. Why the difference? Both <span class="math inline">\(\hat{\sigma}\)</span> and <span class="math inline">\(RMSE\)</span> are functions of squared error and so big differences between predicted and actual value are emphasized. If an error of 6 days is more than twice as bad than an error of 3 days, report <span class="math inline">\(RMSE\)</span>. Why <span class="math inline">\(RMSE\)</span> and not <span class="math inline">\(\hat{\sigma}\)</span>? Simply because researchers using prediction models are more familiar with <span class="math inline">\(RMSE\)</span>. If an error of 6 days is <em>not</em> more than twice as bad than an error of 3 days, report <span class="math inline">\(MAE\)</span>.</p>
</div>
<div id="prediction-modeling-is-more-sophisticated-than-presented-here" class="section level4" number="9.1.4.6">
<h4><span class="header-section-number">9.1.4.6</span> Prediction modeling is more sophisticated than presented here</h4>
<p>For data where the response is a non-linear function of the predictor, or for data with many predictor variables, researchers will often build a model using a <strong>model selection</strong> method. Stepwise regression is a classical model selection method that is commonly taught in intro biostatistics and commonly used by researchers. Stepwise regression as a method of model selection has many well-known problems and should be avoided.</p>
<p>Some <em>excellent</em> books that are useful for building models and model selection are</p>
<ol style="list-style-type: decimal">
<li><a href="https://web.stanford.edu/~hastie/ElemStatLearn/" target="_blank">The Elements of Statistical Learning</a></li>
<li><a href="https://avehtari.github.io/ROS-Examples/" target="_blank">Regression and Other Stories</a></li>
<li><a href="http://hbiostat.org/doc/rms/4day.html" target="_blank">Regression Modeling Strategies</a></li>
</ol>
</div>
</div>
<div id="using-a-regression-model-for-creating-a-new-response-variable-comparing-slopes-of-longitudinal-data" class="section level3" number="9.1.5">
<h3><span class="header-section-number">9.1.5</span> Using a regression model for creating a new response variable – comparing slopes of longitudinal data</h3>
<p>In the study in this example, the researchers compared the growth rate of tumors in mice fed normal chow versus mice with a methionine restricted diet. Growth rate wasn’t actually compared. Instead, the researchers used a <em>t</em>-test to compare the size of the tumor measured at six different days. A problem with multiple <em>t</em>-tests for this dataset is that the errors (residuals from the model) on one day are correlated with the errors from another day because of the repeated measures on each mouse. This correlation will inflate Type I error rate.</p>
<p>Instead of six <em>t</em>-tests, a better strategy for these data is to use a regression to calculate a tumor growth rate for each mouse. There are sixteen mice so this is sixteen fit models. Here I use a “for loop” to fit the model to the data from a single mouse and use the slope (<span class="math inline">\(b_1\)</span>) as the estimate of the tumor growth rate for that mouse.</p>
<p>Use a for-loop to estimate growth rate for each mouse. In each pass through the loop</p>
<ol style="list-style-type: decimal">
<li>the subset of fig1f (the data in long format) belonging to mouse <em>i</em> is created</li>
<li>the linear model <code>volume ~ day</code> is fit to the subset</li>
<li>the coefficient of day (the slope, <span class="math inline">\(b_1\)</span>) is inserted in mouse <em>i</em>’s row in the column “growth” in the data.table “fig1f_wide”.</li>
</ol>
<p>At the end of the loop, we have the data.table fig1f_wide which has one row for each mouse, a column for the treatment factor (diet) and a column called “growth” containing each mouse’s growth rate. There are also columns of tumor volume for each mouse on each day but these are ignored.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="regression.html#cb203-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(fig1f_wide)</span>
<span id="cb203-2"><a href="regression.html#cb203-2" aria-hidden="true" tabindex="-1"></a>id_list <span class="ot">&lt;-</span> fig1f_wide[, id]</span>
<span id="cb203-3"><a href="regression.html#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb203-4"><a href="regression.html#cb203-4" aria-hidden="true" tabindex="-1"></a>  mouse_i_data <span class="ot">&lt;-</span> fig1f[id <span class="sc">==</span> id_list[i]] <span class="co"># subset</span></span>
<span id="cb203-5"><a href="regression.html#cb203-5" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(volume <span class="sc">~</span> day, <span class="at">data =</span> mouse_i_data)</span>
<span id="cb203-6"><a href="regression.html#cb203-6" aria-hidden="true" tabindex="-1"></a>  fig1f_wide[id <span class="sc">==</span> id_list[i], growth <span class="sc">:</span><span class="er">=</span> <span class="fu">coef</span>(fit)[<span class="dv">2</span>]]</span>
<span id="cb203-7"><a href="regression.html#cb203-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb203-8"><a href="regression.html#cb203-8" aria-hidden="true" tabindex="-1"></a><span class="co"># View(fig1f_wide)</span></span>
<span id="cb203-9"><a href="regression.html#cb203-9" aria-hidden="true" tabindex="-1"></a><span class="co"># qplot(x = treatment, y = growth, data = fig1f_wide)</span></span>
<span id="cb203-10"><a href="regression.html#cb203-10" aria-hidden="true" tabindex="-1"></a><span class="co"># qplot(x = day, y = volume, color = treatment, data = fig1f) + geom_smooth(aes(group = id), method = &quot;lm&quot;, se = FALSE)</span></span></code></pre></div>
<p>Step 3. <strong>fit the model</strong></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="regression.html#cb204-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> treatment, <span class="at">data =</span> fig1f_wide)</span></code></pre></div>
<p>Step 5. <strong>inference from the model</strong></p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="regression.html#cb205-1" aria-hidden="true" tabindex="-1"></a>m1_coef <span class="ot">&lt;-</span> <span class="fu">summary</span>(m1) <span class="sc">%&gt;%</span></span>
<span id="cb205-2"><a href="regression.html#cb205-2" aria-hidden="true" tabindex="-1"></a>  coef</span>
<span id="cb205-3"><a href="regression.html#cb205-3" aria-hidden="true" tabindex="-1"></a>m1_ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1)</span>
<span id="cb205-4"><a href="regression.html#cb205-4" aria-hidden="true" tabindex="-1"></a>(m1_coef_table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(m1_coef, m1_ci))</span></code></pre></div>
<pre><code>##              Estimate Std. Error   t value     Pr(&gt;|t|)     2.5 %    97.5 %
## (Intercept)  52.63406   3.102096 16.967258 9.865155e-11  45.98072  59.28739
## treatmentMR -23.57616   4.387026 -5.374065 9.809457e-05 -32.98540 -14.16693</code></pre>
<p>Step 6. <strong>plot the model</strong></p>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/continuous-x-long-plot-1.png" width="576" /></p>
</div>
<div id="using-a-regression-model-for-for-calibration" class="section level3" number="9.1.6">
<h3><span class="header-section-number">9.1.6</span> Using a regression model for for calibration</h3>
</div>
</div>
<div id="working-in-r-1" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Working in R</h2>
<div id="fit-the-model" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Fitting the linear model</h3>
<p>A linear model is fit with the <code>lm</code> function, which is very flexible and will be a workhorse in much of this text.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="regression.html#cb207-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(transition_date <span class="sc">~</span> temperature, <span class="at">data =</span> fig2c)</span></code></pre></div>
<p>m1 is an lm model object that contains many different kinds information, such as the model coefficients.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="regression.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m1)</span></code></pre></div>
<pre><code>## (Intercept) temperature 
##  289.458750    4.982745</code></pre>
<p>We’ll return to others, but first, let’s explore some of the flexibility of the <code>lm</code> function. Two arguments were sent to the function</p>
<ol style="list-style-type: decimal">
<li>the model formula <code>transition_date ~ temperature</code> with the form <code>Y ~ X</code>, where Y and X are names of columns in the data.</li>
</ol>
<ul>
<li>The model formula itself can be assigned to a variable, which is useful when building functions. An example</li>
</ul>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="regression.html#cb210-1" aria-hidden="true" tabindex="-1"></a>coef_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, data){</span>
<span id="cb210-2"><a href="regression.html#cb210-2" aria-hidden="true" tabindex="-1"></a>  m1_form <span class="ot">&lt;-</span> <span class="fu">formula</span>(<span class="fu">paste</span>(y, <span class="st">&quot;~&quot;</span>, x))</span>
<span id="cb210-3"><a href="regression.html#cb210-3" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m1_form, <span class="at">data =</span> data)</span>
<span id="cb210-4"><a href="regression.html#cb210-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(m1)))</span>
<span id="cb210-5"><a href="regression.html#cb210-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb210-6"><a href="regression.html#cb210-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-7"><a href="regression.html#cb210-7" aria-hidden="true" tabindex="-1"></a><span class="fu">coef_table</span>(<span class="at">x =</span> <span class="st">&quot;temperature&quot;</span>,</span>
<span id="cb210-8"><a href="regression.html#cb210-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="st">&quot;transition_date&quot;</span>,</span>
<span id="cb210-9"><a href="regression.html#cb210-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> fig2c)</span></code></pre></div>
<pre><code>##               Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 289.458750  3.0593949 94.613071 1.738650e-13
## temperature   4.982745  0.5541962  8.990941 1.866888e-05</code></pre>
<ul>
<li>Both Y and X can also be column names embedded within a function, for example</li>
</ul>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="regression.html#cb212-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(transition_date) <span class="sc">~</span> temperature, <span class="at">data =</span> fig2c)</span>
<span id="cb212-2"><a href="regression.html#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m2)</span></code></pre></div>
<pre><code>## (Intercept) temperature 
##   5.6690276   0.0160509</code></pre>
<p>or</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="regression.html#cb214-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">scale</span>(transition_date) <span class="sc">~</span> <span class="fu">scale</span>(temperature), <span class="at">data =</span> fig2c)</span>
<span id="cb214-2"><a href="regression.html#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m3)</span></code></pre></div>
<pre><code>##        (Intercept) scale(temperature) 
##       6.484929e-16       9.539117e-01</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>The data frame (remember that a data.table is a data frame) containing the columns with the variable names in the model formula. A data argument is not necessary but it is usually the better way (an exception is when a researcher wants to create a matrix of Y variables or to construct their own model matrix)</li>
</ol>
<p>type <code>?lm</code> into the console to see other arguments of the <code>lm</code> function.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="regression.html#cb216-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> fig2[, temperature]</span>
<span id="cb216-2"><a href="regression.html#cb216-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> fig2[, transition_date]</span>
<span id="cb216-3"><a href="regression.html#cb216-3" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb216-4"><a href="regression.html#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m4)</span></code></pre></div>
<pre><code>## (Intercept)           x 
## 204.8866185   0.4324755</code></pre>
</div>
<div id="getting-to-know-the-linear-model-the-summary-function" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Getting to know the linear model: the <code>summary</code> function</h3>
<p>The <code>lm</code> function returns an <code>lm</code> object, which we’ve assigned to the name <code>m1</code>. <code>m1</code> contains lots of information about our fit of the linear model to the data. Most of the information that we want for most purposes can be retrieved with the <code>summary</code> function, which is a general-purpose R command the works with many R objects.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="regression.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = transition_date ~ temperature, data = fig2c)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.5062 -3.8536  0.6645  2.7537  9.0074 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 289.4588     3.0594  94.613 1.74e-13 ***
## temperature   4.9827     0.5542   8.991 1.87e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.443 on 8 degrees of freedom
## Multiple R-squared:  0.9099, Adjusted R-squared:  0.8987 
## F-statistic: 80.84 on 1 and 8 DF,  p-value: 1.867e-05</code></pre>
<p>What is here:</p>
<p><strong>Call</strong>. This is the model that was fit</p>
<p><strong>Residuals</strong>. This is a summary of the distribution of the residuals. From this one can get a sense of the distribution (for inference, the model assumes a normal distribution with mean zero). More useful ways to examine this distribution will be introduced later in this chapter.</p>
<p><strong>Coefficients table</strong>. This contains the linear model coefficients and their standard error and associated <span class="math inline">\(t\)</span> and <span class="math inline">\(p\)</span> values.</p>
<ol style="list-style-type: decimal">
<li>The column of values under “Estimate” are the coefficients of the fitted model (equation <a href="regression.html#eq:continuous-x-fit">(9.1)</a>). Here, 289.4587503 is the intercept (<span class="math inline">\(b_0\)</span>) and 4.9827453 is the effect of <span class="math inline">\(temperature\)</span> (<span class="math inline">\(b_1\)</span>).</li>
<li>The column of values under “Std. Error” are the standard errors of the coefficients.</li>
<li>The column of values under “t value” are the <em>t-statistics</em> for each coefficient. A <em>t</em>-value is a <strong>signal to noise ratio</strong>. The coefficient <span class="math inline">\(b_1\)</span> is the “signal” and the SE is the noise. Get used to thinking about this ratio. A <em>t</em>-value greater than about 3 indicates a “pretty good” signal relative to noise, while one much below than 2 is not.</li>
<li>The column of values under “Pr(&gt;|t|)” is the <em>p</em>-value, which is the t-test of the estimate. What is the <em>p</em>-value a test of? The <em>p</em>-value tests the hypothesis “how probable are the data, or more extreme than than the data, if the true parameter is zero?”. Formally <span class="math inline">\(p = \mathrm{freq(t&#39; \ge t|H_o)}\)</span>, where <span class="math inline">\(t&#39;\)</span> is the hypothetical <em>t</em>-value, <em>t</em> is the observed <span class="math inline">\(t\)</span>-value, and <span class="math inline">\(H_o\)</span> is the null hypothesis. We will return to <em>p</em>-values in Chapter xxx.</li>
</ol>
<p><strong>Signif. codes</strong>. Significance codes are extremely common in the wet bench experimental biology literature but do not have much to recommend. I’ll return to these in the <em>p</em>-values chapter.</p>
<p>Beneath the Signif. codes are some model statistics which are useful</p>
<p><strong>Residual standard error</strong> This is <span class="math inline">\(\sqrt{\sum{e_i^2}/(n-2)}\)</span>, where <span class="math inline">\(e_i\)</span> are the residuals in the fitted model. “degrees of freedom” is the number of <span class="math inline">\(e_i\)</span> that are “allowed to vary” after fitting the parameters, so is the total sample size (<span class="math inline">\(n\)</span>) minus the number of parameters in the model. The fit model has two fit parameters (<span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> so the df is <span class="math inline">\(n-2\)</span>. Note that this is the denominator in the residual standard error equation.</p>
<p><strong>Multiple R-squared</strong>. This is an important but imperfect summary measure of the whole model that effectively measures how much of the total variance in the response variable “is explained by” the model. Its value lies between zero and 1. <strong>It’s a good measure to report in a manuscript</strong>, especially for observational data.</p>
<p><strong>F-statistic and p-value</strong>. These are statistics for the whole model (not the individual coefficients) and I just don’t find these very useful.</p>
</div>
<div id="inference-the-coefficient-table" class="section level3" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Inference – the coefficient table</h3>
<p>There are different ways of</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="regression.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step by step</span></span>
<span id="cb220-2"><a href="regression.html#cb220-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-3"><a href="regression.html#cb220-3" aria-hidden="true" tabindex="-1"></a>m1_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(m1) <span class="co"># get summary</span></span>
<span id="cb220-4"><a href="regression.html#cb220-4" aria-hidden="true" tabindex="-1"></a>m1_coef_p1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(m1_summary) <span class="co"># extract coefficient table</span></span>
<span id="cb220-5"><a href="regression.html#cb220-5" aria-hidden="true" tabindex="-1"></a>m1_coef_p2 <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1) <span class="co"># get CIs</span></span>
<span id="cb220-6"><a href="regression.html#cb220-6" aria-hidden="true" tabindex="-1"></a>m1_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(m1_coef_p1, m1_coef_p2) <span class="co"># column bind the two</span></span>
<span id="cb220-7"><a href="regression.html#cb220-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-8"><a href="regression.html#cb220-8" aria-hidden="true" tabindex="-1"></a><span class="co"># this can be shortened (but still readable) using</span></span>
<span id="cb220-9"><a href="regression.html#cb220-9" aria-hidden="true" tabindex="-1"></a>m1_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(m1)),</span>
<span id="cb220-10"><a href="regression.html#cb220-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">confint</span>(m1))</span>
<span id="cb220-11"><a href="regression.html#cb220-11" aria-hidden="true" tabindex="-1"></a>m1_coef</span></code></pre></div>
<pre><code>##               Estimate Std. Error   t value     Pr(&gt;|t|)      2.5 %     97.5 %
## (Intercept) 289.458750  3.0593949 94.613071 1.738650e-13 282.403773 296.513728
## temperature   4.982745  0.5541962  8.990941 1.866888e-05   3.704767   6.260724</code></pre>
<p>Note that the <em>p</em>-value for the coefficient for <em>temperature</em> is very small and we could conclude that the data are not compatible with a model of no temperature effect on day of green-down. But did we need a formal hypothesis test for this? We haven’t learned much if we have only learned that the slope is “not likely to be exactly zero” (Temperature effects everything in biology). A far more important question is not <em>if</em> there is a relationship between <em>temperature</em> and <em>day</em> of green-down, but what is the sign and magnitude of the effect and what is the uncertainty in our estimate of this effect. For this, we we want the coefficient and its SE or confidence interval, both of which are in this table. Remember, our working definition of a confidence interval:</p>
<p><strong>A confidence interval contains the range of parameter values that are compatible with the data, in the sense that a <span class="math inline">\(t\)</span>-test would not reject the null hypothesis of a difference between the estimate and any value within the interval</strong></p>
<p>A more textbook way of defining a CI is: A 95% CI of a parameter has a 95% probability of including the true value of the parameter. It does not mean that there is a 95% probability that the true value lies in the interval. This is a subtle but important difference. Here is a way of thinking about the proper meaning of the textbook definition: we don’t know the true value of <span class="math inline">\(\beta_1\)</span> but we can 1) repeat the experiment or sampling, 2) re-estimate <span class="math inline">\(\beta_1\)</span>, and 3) re-compute a 95% CI. If we do 1-3 many times, 95% of the CIs will include <span class="math inline">\(\beta_1\)</span> within the interval.</p>
<p>Confidence intervals are often interpreted like <span class="math inline">\(p\)</span>-values. That is, the researcher looks to see if the CI overlaps with zero and if it does, concludes there is “no effect”. First, this conclusion is not correct – <strong>the inability to find sufficient evidence for an effect does not mean there is no effect, it simply means there is insufficient evidence to conclude there is an effect</strong>!</p>
<p>Second, what we want to use the CI for is to guide us about how big or small the effect might reasonably be, given the data. Again, A CI is a measure of parameter values that are “compatible” with the data. If our biological interpretations at the small-end and at the big-end of the interval’s range radically differ, then we don’t have enough <em>precision</em> in our analysis to reach an unambiguous conclusion.</p>
</div>
<div id="how-good-is-our-model-model-checking" class="section level3" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> How good is our model? – Model checking</h3>
<p>There are two, quite different senses of what is meant by a good model.</p>
<ol style="list-style-type: decimal">
<li>How good is the model at predicting? Or, how much of the variance in the response (the stuff to be “explained”) is accounted for by the model? This was described above.</li>
<li>How well do the data look like a sample from the modeled distribution? If not well, we should consider alternative models. This is <strong>model checking</strong>.</li>
</ol>
<p>For inference, a good model generates data that look like the real data. If this is true, our fit model will have well-behaved residuals. There are several aspects of “well-behaved” and each is checked with a diagnostic plot. This <strong>model checking</strong> is covered in more detail in chapter xxx.</p>
<p>Inference from model <a href="regression.html#eq:continuous-x-m1">(9.2)</a> assumes the data were sampled from a normal distribution. To check this, use a quantile-quantile or <strong>Q-Q plot</strong>. The <code>qqPlot</code> function from the car package generates a more useful plot than that from Base R.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="regression.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb222-2"><a href="regression.html#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(m1, <span class="at">id=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-102-1.png" width="576" /></p>
<p>Approximately normal residuals will track the solid line and stay largely within the boundaries marked by the dashed lines. The residuals from m1 fit to the green-down data track the solid line and remain within the dashed lines, indicating adequate model fit.</p>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>Note that a formal test of normality is often recommended. Formal tests do not add value above a diagnostic check. Robustness of inference (for example, a <em>p</em>-value) is a function of the type and degree of “non-normalness”, not of a p-value. For a small sample, there is not much power to test for normality, so samples from non-normal distributions pass the test (<span class="math inline">\(p &gt; 0.05\)</span>) and are deemed “normal”. For large samples, samples from distributions that deviate slightly from normal fail the test (<span class="math inline">\(p &lt; 0.05\)</span>) and are deemed “not normal”. Inference with many non-normal samples with large <span class="math inline">\(n\)</span> are very robust (meaning infernece is not likely to fool you with randomness).</p>
</div>
<p>Inference from model <a href="regression.html#eq:continuous-x-m1">(9.2)</a> assumes homogeneity of the response conditional on <span class="math inline">\(X\)</span>. For a continuous <span class="math inline">\(X\)</span>, this means the residuals should have approximately equal variance at low, mid, and high values of <span class="math inline">\(X\)</span> (and everywhere in between). One can visually inspect the spread of points in the <span class="math inline">\(Y\)</span> direction across the groups for categorical <span class="math inline">\(X\)</span> or along the <em>X</em>-axis for continuous <span class="math inline">\(X\)</span>. A useful method for checking how residual variance changes (usually increases) with the conditional mean of <span class="math inline">\(Y\)</span> is a <strong>spread-location plot</strong>. The <code>spreadLevelPlot(m1)</code> function from the car package is useful.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="regression.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spreadLevelPlot</span>(m1)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-103-1.png" width="576" /></p>
<pre><code>## 
## Suggested power transformation:  0.6721303</code></pre>
<p>The dashed blue line shows linear trends while the magenta line shows non-linear trends. For the green-down data, the dashed line is very flat while the magenta-line shows what looks like random fluctations. Taken together, the two lines indicate adequate model fit.</p>
</div>
<div id="plotting-models-with-continuous-x" class="section level3" number="9.2.5">
<h3><span class="header-section-number">9.2.5</span> Plotting models with continuous <em>X</em></h3>
<div id="quick-plot" class="section level4" number="9.2.5.1">
<h4><span class="header-section-number">9.2.5.1</span> Quick plot</h4>
<p><code>qplot</code> from the ggplot package is useful for initial examinations of the data</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="regression.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> transition_date, <span class="at">data =</span> fig2c) <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-104-1.png" width="576" /></p>
<p>Some variations of this quick plot to explore include</p>
<ol style="list-style-type: decimal">
<li>use <code>geom_smooth(method = "lm")</code></li>
</ol>
</div>
<div id="ggpubr-plots" class="section level4" number="9.2.5.2">
<h4><span class="header-section-number">9.2.5.2</span> ggpubr plots</h4>
<p>ggpubr is a package with functions that automates the construction of publication-ready ggplots. <code>ggscatter</code> can generate a publishable plot with little effort.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="regression.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(<span class="at">data =</span> fig2c,</span>
<span id="cb226-2"><a href="regression.html#cb226-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;temperature&quot;</span>,</span>
<span id="cb226-3"><a href="regression.html#cb226-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;transition_date&quot;</span>,</span>
<span id="cb226-4"><a href="regression.html#cb226-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>,</span>
<span id="cb226-5"><a href="regression.html#cb226-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;Added Temperature (°C)&quot;</span>,</span>
<span id="cb226-6"><a href="regression.html#cb226-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;Day of Green-down (DOY)&quot;</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-105-1.png" width="576" /></p>
<p>It take only a little more effort to add useful modifications.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="regression.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(<span class="at">data =</span> fig2c,</span>
<span id="cb227-2"><a href="regression.html#cb227-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;temperature&quot;</span>,</span>
<span id="cb227-3"><a href="regression.html#cb227-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;transition_date&quot;</span>,</span>
<span id="cb227-4"><a href="regression.html#cb227-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb227-5"><a href="regression.html#cb227-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb227-6"><a href="regression.html#cb227-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb227-7"><a href="regression.html#cb227-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb227-8"><a href="regression.html#cb227-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>,</span>
<span id="cb227-9"><a href="regression.html#cb227-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb227-10"><a href="regression.html#cb227-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> <span class="st">&quot;lightgray&quot;</span>),</span>
<span id="cb227-11"><a href="regression.html#cb227-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb227-12"><a href="regression.html#cb227-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;Added Temperature (°C)&quot;</span>,</span>
<span id="cb227-13"><a href="regression.html#cb227-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;Day of Green-down (DOY)&quot;</span>) <span class="sc">+</span></span>
<span id="cb227-14"><a href="regression.html#cb227-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-15"><a href="regression.html#cb227-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_regline_equation</span>(<span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb227-16"><a href="regression.html#cb227-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label.y =</span> <span class="dv">340</span>) <span class="sc">+</span></span>
<span id="cb227-17"><a href="regression.html#cb227-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..rr.label.., ..p.label.., <span class="at">sep =</span> <span class="st">&quot;~`,`~&quot;</span>)),</span>
<span id="cb227-18"><a href="regression.html#cb227-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb227-19"><a href="regression.html#cb227-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">label.y =</span> <span class="dv">335</span>) <span class="sc">+</span></span>
<span id="cb227-20"><a href="regression.html#cb227-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-21"><a href="regression.html#cb227-21" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-106-1.png" width="576" /></p>
<p>Notes</p>
<ol class="example" style="list-style-type: decimal">
<li>The interval shown is the 95% confidence interval of the expected values, which is what we want to communicate with the experimental green-down data. Were we to want to use this as a prediction model, we would want the 95% prediction interval. I’m not sure that ggpubr can plot a prediction interval. To see how I plotted the prediction interval in Figure <a href="#fig:continuous-x-pred-fig"><strong>??</strong></a> above, see the Hidden Code section below.</li>
<li>The arguments of the <code>ggscatter</code> function are typed in explicitly (<code>x = "temperarture"</code> and not just <code>"temperature"</code>). Each argument starts on a new line to increase readability.</li>
<li>The <code>+</code> after the <code>ggscatter</code> function adds additional layers to the plot. Each additional component is started on a new line to increase readability.</li>
<li>The first line of the <code>stat_cor</code> function (everything within <code>aes()</code>) plots the <span class="math inline">\(R^2\)</span> instead of the correlation coefficient <span class="math inline">\(r\)</span>. Copy and pasting this whole line just works.</li>
<li>Comment out the line of the ggplot script starting with <code>stat_cor</code> and re-run (comment out by inserting a <code>#</code> at the front of the line. A consistent way to do this is to triple-click the line to highlight the line and then type command-shift-c on Mac OS). The script runs without error because <code>NULL</code> has been added as the final plot component. Adding “NULL” is a useful trick.</li>
</ol>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="regression.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(<span class="at">data =</span> efig_3d,</span>
<span id="cb228-2"><a href="regression.html#cb228-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;autumn_temp_anomaly&quot;</span>,</span>
<span id="cb228-3"><a href="regression.html#cb228-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;green_down_anomaly&quot;</span>,</span>
<span id="cb228-4"><a href="regression.html#cb228-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb228-5"><a href="regression.html#cb228-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb228-6"><a href="regression.html#cb228-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb228-7"><a href="regression.html#cb228-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb228-8"><a href="regression.html#cb228-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>,</span>
<span id="cb228-9"><a href="regression.html#cb228-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb228-10"><a href="regression.html#cb228-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> <span class="st">&quot;lightgray&quot;</span>),</span>
<span id="cb228-11"><a href="regression.html#cb228-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-12"><a href="regression.html#cb228-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;Added Temperature (°C)&quot;</span>,</span>
<span id="cb228-13"><a href="regression.html#cb228-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;Day of Green-down (DOY)&quot;</span>)</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-107-1.png" width="576" /></p>
</div>
<div id="ggplots" class="section level4" number="9.2.5.3">
<h4><span class="header-section-number">9.2.5.3</span> ggplots</h4>
<p>Use <code>ggplot</code> from the ggplot2 package for full control of plots. See the Hidden Code below for how I generated the plots in Figure <a href="regression.html#fig:continuous-x-plot">9.1</a> above.</p>
</div>
</div>
<div id="creating-a-table-of-predicted-values-and-95-prediction-intervals" class="section level3" number="9.2.6">
<h3><span class="header-section-number">9.2.6</span> Creating a table of predicted values and 95% prediction intervals</h3>
<p>efig_3d is the data.table created from importing the data in Extended Data Figure 3d above. The fit model is</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="regression.html#cb229-1" aria-hidden="true" tabindex="-1"></a>efig3d_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(green_down_anomaly <span class="sc">~</span> autumn_temp_anomaly, <span class="at">data =</span> efig_3d)</span></code></pre></div>
<p>The <code>predict(efig3d_m1)</code> function is used to compute either fitted or predicted values, and either the confidence or prediction interval of these values.</p>
<p>Unless specified by <code>newdata</code>, the default x-values used to generate the y in <code>predict(efig3d_m1)</code> are the x-values in the data used to fit the model. The returned values are the expected value for each <span class="math inline">\(x_i\)</span> in the data. The argument <code>newdata</code> passes a data.frame (remember a data.table is a data.frame!) with new x-values. Since these x-values were not in the data used to fit the model, the returned <span class="math inline">\(y_{hat}\)</span> are predicted values.</p>
<p>The range of x-values in the data is</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="regression.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(efig_3d[,autumn_temp_anomaly])</span></code></pre></div>
<pre><code>## [1] -2.673793  2.568045</code></pre>
<p>Let’s get predicted values for a value of <span class="math inline">\(autumn\_temp\_anomaly = 2\)</span>.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="regression.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(efig3d_m1, <span class="at">newdata =</span> <span class="fu">data.table</span>(<span class="at">autumn_temp_anomaly =</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>##        1 
## 3.192646</code></pre>
<p>And predicted values across the range of measured values</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="regression.html#cb234-1" aria-hidden="true" tabindex="-1"></a>new_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">autumn_temp_anomaly =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb234-2"><a href="regression.html#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(efig3d_m1, <span class="at">newdata =</span> new_dt)</span></code></pre></div>
<pre><code>##         1         2         3         4 
## -3.192646 -1.596323  1.596323  3.192646</code></pre>
<p>Add 95% confidence intervals (this could be used to create the band for plotting)</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="regression.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(efig3d_m1, </span>
<span id="cb236-2"><a href="regression.html#cb236-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata =</span> new_dt,</span>
<span id="cb236-3"><a href="regression.html#cb236-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>,</span>
<span id="cb236-4"><a href="regression.html#cb236-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">se.fit =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span></code></pre></div>
<pre><code>##         fit        lwr        upr
## 1 -3.192646 -5.2485713 -1.1367215
## 2 -1.596323 -2.9492686 -0.2433778
## 3  1.596323  0.2433778  2.9492686
## 4  3.192646  1.1367215  5.2485713</code></pre>
<p>Change to the 95% prediction intervals</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="regression.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(efig3d_m1, </span>
<span id="cb238-2"><a href="regression.html#cb238-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata =</span> new_dt,</span>
<span id="cb238-3"><a href="regression.html#cb238-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>,</span>
<span id="cb238-4"><a href="regression.html#cb238-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">se.fit =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span></code></pre></div>
<pre><code>##         fit        lwr       upr
## 1 -3.192646 -12.833739  6.448446
## 2 -1.596323 -11.112325  7.919679
## 3  1.596323  -7.919679 11.112325
## 4  3.192646  -6.448446 12.833739</code></pre>
<p>Put this all together in a pretty table. I’ve used knitr’s <code>kable</code> function but there are table packages in R that allow extensive control of the output.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="regression.html#cb240-1" aria-hidden="true" tabindex="-1"></a>efig3d_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(green_down_anomaly <span class="sc">~</span> autumn_temp_anomaly, <span class="at">data =</span> efig_3d)</span>
<span id="cb240-2"><a href="regression.html#cb240-2" aria-hidden="true" tabindex="-1"></a>new_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">autumn_temp_anomaly =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb240-3"><a href="regression.html#cb240-3" aria-hidden="true" tabindex="-1"></a>prediction_table <span class="ot">&lt;-</span> <span class="fu">predict</span>(efig3d_m1, </span>
<span id="cb240-4"><a href="regression.html#cb240-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">newdata =</span> new_dt,</span>
<span id="cb240-5"><a href="regression.html#cb240-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>,</span>
<span id="cb240-6"><a href="regression.html#cb240-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">se.fit =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span>
<span id="cb240-7"><a href="regression.html#cb240-7" aria-hidden="true" tabindex="-1"></a>prediction_table <span class="ot">&lt;-</span> <span class="fu">data.table</span>(new_dt, prediction_table)</span>
<span id="cb240-8"><a href="regression.html#cb240-8" aria-hidden="true" tabindex="-1"></a>pretty_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Autumn Temp Anomaly&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;2.5%&quot;</span>, <span class="st">&quot;97.5%&quot;</span>)</span>
<span id="cb240-9"><a href="regression.html#cb240-9" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(prediction_table, <span class="at">old =</span> <span class="fu">colnames</span>(prediction_table), <span class="at">new =</span> pretty_names)</span>
<span id="cb240-10"><a href="regression.html#cb240-10" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(prediction_table, <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
Autumn Temp Anomaly
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
97.5%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
-3.2
</td>
<td style="text-align:right;">
-12.8
</td>
<td style="text-align:right;">
6.4
</td>
</tr>
<tr>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1.6
</td>
<td style="text-align:right;">
-11.1
</td>
<td style="text-align:right;">
7.9
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.6
</td>
<td style="text-align:right;">
-7.9
</td>
<td style="text-align:right;">
11.1
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
-6.4
</td>
<td style="text-align:right;">
12.8
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="hidden-code-1" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Hidden code</h2>
<div id="import-and-plot-of-fig2c-ecosystem-warming-experimental-data" class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Import and plot of fig2c (ecosystem warming experimental) data</h3>
<p>Import</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="regression.html#cb241-1" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Ecosystem warming extends vegetation activity but heightens vulnerability to cold temperatures&quot;</span></span>
<span id="cb241-2"><a href="regression.html#cb241-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41586_2018_399_MOESM3_ESM.xlsx&quot;</span></span>
<span id="cb241-3"><a href="regression.html#cb241-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb241-4"><a href="regression.html#cb241-4" aria-hidden="true" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path) <span class="sc">%&gt;%</span> <span class="co"># import</span></span>
<span id="cb241-5"><a href="regression.html#cb241-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> <span class="co"># clean the column names</span></span>
<span id="cb241-6"><a href="regression.html#cb241-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="co"># convert to data.table</span></span>
<span id="cb241-7"><a href="regression.html#cb241-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View(fig2)</span></span>
<span id="cb241-8"><a href="regression.html#cb241-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-9"><a href="regression.html#cb241-9" aria-hidden="true" tabindex="-1"></a>fig2c <span class="ot">&lt;-</span> fig2[panel <span class="sc">==</span> <span class="st">&quot;2c&quot;</span>,]</span>
<span id="cb241-10"><a href="regression.html#cb241-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(fig2c)</span></span></code></pre></div>
<p>Creating the response plot (the bottom component)</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="regression.html#cb242-1" aria-hidden="true" tabindex="-1"></a>m1_b <span class="ot">&lt;-</span> <span class="fu">coef</span>(m1)</span>
<span id="cb242-2"><a href="regression.html#cb242-2" aria-hidden="true" tabindex="-1"></a>m1_ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1)</span>
<span id="cb242-3"><a href="regression.html#cb242-3" aria-hidden="true" tabindex="-1"></a>m1_b0_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Intercept: &quot;</span>,</span>
<span id="cb242-4"><a href="regression.html#cb242-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(m1_b[<span class="dv">1</span>],<span class="dv">1</span>),</span>
<span id="cb242-5"><a href="regression.html#cb242-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot; (&quot;</span>,</span>
<span id="cb242-6"><a href="regression.html#cb242-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(m1_ci[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dv">1</span>),</span>
<span id="cb242-7"><a href="regression.html#cb242-7" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;, &quot;</span>,</span>
<span id="cb242-8"><a href="regression.html#cb242-8" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(m1_ci[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dv">1</span>),</span>
<span id="cb242-9"><a href="regression.html#cb242-9" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;) d&quot;</span>)</span>
<span id="cb242-10"><a href="regression.html#cb242-10" aria-hidden="true" tabindex="-1"></a>m1_b1_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Slope: &quot;</span>,</span>
<span id="cb242-11"><a href="regression.html#cb242-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(m1_b[<span class="dv">2</span>],<span class="dv">2</span>),</span>
<span id="cb242-12"><a href="regression.html#cb242-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot; (&quot;</span>,</span>
<span id="cb242-13"><a href="regression.html#cb242-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(m1_ci[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dv">2</span>),</span>
<span id="cb242-14"><a href="regression.html#cb242-14" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;, &quot;</span>,</span>
<span id="cb242-15"><a href="regression.html#cb242-15" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(m1_ci[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dv">2</span>),</span>
<span id="cb242-16"><a href="regression.html#cb242-16" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;) d per 1 °C&quot;</span>)</span>
<span id="cb242-17"><a href="regression.html#cb242-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-18"><a href="regression.html#cb242-18" aria-hidden="true" tabindex="-1"></a><span class="co"># regression line</span></span>
<span id="cb242-19"><a href="regression.html#cb242-19" aria-hidden="true" tabindex="-1"></a>m1_x <span class="ot">&lt;-</span> <span class="fu">min</span>(fig2c[, temperature])</span>
<span id="cb242-20"><a href="regression.html#cb242-20" aria-hidden="true" tabindex="-1"></a>m1_xend <span class="ot">&lt;-</span> <span class="fu">max</span>(fig2c[, temperature])</span>
<span id="cb242-21"><a href="regression.html#cb242-21" aria-hidden="true" tabindex="-1"></a>m1_y <span class="ot">&lt;-</span> m1_b[<span class="dv">1</span>] <span class="sc">+</span> m1_b[<span class="dv">2</span>]<span class="sc">*</span>m1_x</span>
<span id="cb242-22"><a href="regression.html#cb242-22" aria-hidden="true" tabindex="-1"></a>m1_yend <span class="ot">&lt;-</span> m1_b[<span class="dv">1</span>] <span class="sc">+</span> m1_b[<span class="dv">2</span>]<span class="sc">*</span>m1_xend</span>
<span id="cb242-23"><a href="regression.html#cb242-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-24"><a href="regression.html#cb242-24" aria-hidden="true" tabindex="-1"></a>fig2c_gg_response <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fig2c,</span>
<span id="cb242-25"><a href="regression.html#cb242-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> temperature,</span>
<span id="cb242-26"><a href="regression.html#cb242-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> transition_date)) <span class="sc">+</span></span>
<span id="cb242-27"><a href="regression.html#cb242-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb242-28"><a href="regression.html#cb242-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># regression line first, to not block point</span></span>
<span id="cb242-29"><a href="regression.html#cb242-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> m1_x,</span>
<span id="cb242-30"><a href="regression.html#cb242-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> m1_y,</span>
<span id="cb242-31"><a href="regression.html#cb242-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">xend =</span> m1_xend,</span>
<span id="cb242-32"><a href="regression.html#cb242-32" aria-hidden="true" tabindex="-1"></a>               <span class="at">yend =</span> m1_yend) <span class="sc">+</span></span>
<span id="cb242-33"><a href="regression.html#cb242-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create black edge to points</span></span>
<span id="cb242-34"><a href="regression.html#cb242-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point(size = 4,</span></span>
<span id="cb242-35"><a href="regression.html#cb242-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#            color = &quot;black&quot;) +</span></span>
<span id="cb242-36"><a href="regression.html#cb242-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb242-37"><a href="regression.html#cb242-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pal_okabe_ito[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb242-38"><a href="regression.html#cb242-38" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.25</span>, <span class="fl">4.5</span>, <span class="fl">6.75</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb242-39"><a href="regression.html#cb242-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Plot temperature (ΔT, °C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb242-40"><a href="regression.html#cb242-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Autumn green-down (DOY)&quot;</span>) <span class="sc">+</span></span>
<span id="cb242-41"><a href="regression.html#cb242-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb242-42"><a href="regression.html#cb242-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb242-43"><a href="regression.html#cb242-43" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb242-44"><a href="regression.html#cb242-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-45"><a href="regression.html#cb242-45" aria-hidden="true" tabindex="-1"></a><span class="co"># fig2c_gg_response</span></span></code></pre></div>
<p>Creating the effects plot (the top component)</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="regression.html#cb243-1" aria-hidden="true" tabindex="-1"></a>m1_coeff_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">term =</span> <span class="fu">row.names</span>(m1_coeff),</span>
<span id="cb243-2"><a href="regression.html#cb243-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">data.table</span>(m1_coeff))[<span class="dv">2</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb243-3"><a href="regression.html#cb243-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb243-4"><a href="regression.html#cb243-4" aria-hidden="true" tabindex="-1"></a>m1_coeff_dt[ , p_pretty <span class="sc">:</span><span class="er">=</span> <span class="fu">pvalString</span>(pr_t)]</span>
<span id="cb243-5"><a href="regression.html#cb243-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-6"><a href="regression.html#cb243-6" aria-hidden="true" tabindex="-1"></a>min_bound <span class="ot">&lt;-</span> <span class="fu">min</span>(m1_coeff_dt[, x2_5_percent])</span>
<span id="cb243-7"><a href="regression.html#cb243-7" aria-hidden="true" tabindex="-1"></a>max_bound <span class="ot">&lt;-</span> <span class="fu">min</span>(m1_coeff_dt[, x97_5_percent])</span>
<span id="cb243-8"><a href="regression.html#cb243-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-9"><a href="regression.html#cb243-9" aria-hidden="true" tabindex="-1"></a>y_lo <span class="ot">&lt;-</span> <span class="fu">min</span>(min_bound<span class="sc">+</span>min_bound<span class="sc">*</span><span class="fl">0.2</span>,</span>
<span id="cb243-10"><a href="regression.html#cb243-10" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span>max_bound)</span>
<span id="cb243-11"><a href="regression.html#cb243-11" aria-hidden="true" tabindex="-1"></a>y_hi <span class="ot">&lt;-</span> <span class="fu">max</span>(max_bound <span class="sc">+</span> max_bound<span class="sc">*</span><span class="fl">0.2</span>,</span>
<span id="cb243-12"><a href="regression.html#cb243-12" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span>min_bound)</span>
<span id="cb243-13"><a href="regression.html#cb243-13" aria-hidden="true" tabindex="-1"></a>y_lims <span class="ot">&lt;-</span> <span class="fu">c</span>(y_lo, y_hi)</span>
<span id="cb243-14"><a href="regression.html#cb243-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-15"><a href="regression.html#cb243-15" aria-hidden="true" tabindex="-1"></a>fig2c_gg_effect <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>m1_coeff_dt, </span>
<span id="cb243-16"><a href="regression.html#cb243-16" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> term,</span>
<span id="cb243-17"><a href="regression.html#cb243-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb243-18"><a href="regression.html#cb243-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># confidence level of effect</span></span>
<span id="cb243-19"><a href="regression.html#cb243-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>x2_5_percent, </span>
<span id="cb243-20"><a href="regression.html#cb243-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax=</span>x97_5_percent),</span>
<span id="cb243-21"><a href="regression.html#cb243-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">width=</span><span class="dv">0</span>, </span>
<span id="cb243-22"><a href="regression.html#cb243-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb243-23"><a href="regression.html#cb243-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># estimate of effect</span></span>
<span id="cb243-24"><a href="regression.html#cb243-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb243-25"><a href="regression.html#cb243-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb243-26"><a href="regression.html#cb243-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># zero effect</span></span>
<span id="cb243-27"><a href="regression.html#cb243-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb243-28"><a href="regression.html#cb243-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb243-29"><a href="regression.html#cb243-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p-value</span></span>
<span id="cb243-30"><a href="regression.html#cb243-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb243-31"><a href="regression.html#cb243-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> m1_coeff_dt<span class="sc">$</span>p_pretty,</span>
<span id="cb243-32"><a href="regression.html#cb243-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>,</span>
<span id="cb243-33"><a href="regression.html#cb243-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fl">7.5</span>) <span class="sc">+</span></span>
<span id="cb243-34"><a href="regression.html#cb243-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb243-35"><a href="regression.html#cb243-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># aesthetics</span></span>
<span id="cb243-36"><a href="regression.html#cb243-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position=</span><span class="st">&quot;right&quot;</span>) <span class="sc">+</span></span>
<span id="cb243-37"><a href="regression.html#cb243-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="st">&quot;Temperature</span><span class="sc">\n</span><span class="st">effect&quot;</span>) <span class="sc">+</span></span>
<span id="cb243-38"><a href="regression.html#cb243-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Effects (day/°C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb243-39"><a href="regression.html#cb243-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">ylim =</span> y_lims) <span class="sc">+</span> </span>
<span id="cb243-40"><a href="regression.html#cb243-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb243-41"><a href="regression.html#cb243-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb243-42"><a href="regression.html#cb243-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb243-43"><a href="regression.html#cb243-43" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb243-44"><a href="regression.html#cb243-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-45"><a href="regression.html#cb243-45" aria-hidden="true" tabindex="-1"></a><span class="co">#fig2c_gg_effect</span></span></code></pre></div>
<p>Combining the response and effects plots into single plot</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="regression.html#cb244-1" aria-hidden="true" tabindex="-1"></a>fig3d_fig <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(fig2c_gg_effect,</span>
<span id="cb244-2"><a href="regression.html#cb244-2" aria-hidden="true" tabindex="-1"></a>                       fig2c_gg_response,</span>
<span id="cb244-3"><a href="regression.html#cb244-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nrow=</span><span class="dv">2</span>,</span>
<span id="cb244-4"><a href="regression.html#cb244-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb244-5"><a href="regression.html#cb244-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis =</span> <span class="st">&quot;lr&quot;</span>,</span>
<span id="cb244-6"><a href="regression.html#cb244-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="dv">1</span>))</span>
<span id="cb244-7"><a href="regression.html#cb244-7" aria-hidden="true" tabindex="-1"></a>fig3d_fig</span></code></pre></div>
</div>
<div id="import-and-plot-efig_3d-ecosysem-warming-observational-data" class="section level3" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Import and plot efig_3d (Ecosysem warming observational) data</h3>
<p>Import</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="regression.html#cb245-1" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Ecosystem warming extends vegetation activity but heightens vulnerability to cold temperatures&quot;</span></span>
<span id="cb245-2"><a href="regression.html#cb245-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41586_2018_399_MOESM6_ESM.xlsx&quot;</span></span>
<span id="cb245-3"><a href="regression.html#cb245-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb245-4"><a href="regression.html#cb245-4" aria-hidden="true" tabindex="-1"></a>efig_3d <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb245-5"><a href="regression.html#cb245-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">range =</span> <span class="st">&quot;J2:K87&quot;</span>,</span>
<span id="cb245-6"><a href="regression.html#cb245-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">col_names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="co"># header causing issues</span></span>
<span id="cb245-7"><a href="regression.html#cb245-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="co"># convert to data.table</span></span>
<span id="cb245-8"><a href="regression.html#cb245-8" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(efig_3d, <span class="at">old =</span> <span class="fu">colnames</span>(efig_3d), <span class="at">new =</span> <span class="fu">c</span>(<span class="st">&quot;autumn_temp_anomaly&quot;</span>, <span class="st">&quot;green_down_anomaly&quot;</span>))</span>
<span id="cb245-9"><a href="regression.html#cb245-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-10"><a href="regression.html#cb245-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(efig_3d)</span></span></code></pre></div>
<p>Plot</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="regression.html#cb246-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(green_down_anomaly <span class="sc">~</span> autumn_temp_anomaly, <span class="at">data =</span> efig_3d)</span>
<span id="cb246-2"><a href="regression.html#cb246-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-3"><a href="regression.html#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="co"># get x for drawing slope</span></span>
<span id="cb246-4"><a href="regression.html#cb246-4" aria-hidden="true" tabindex="-1"></a>minx <span class="ot">&lt;-</span> <span class="fu">min</span>(efig_3d[,autumn_temp_anomaly])</span>
<span id="cb246-5"><a href="regression.html#cb246-5" aria-hidden="true" tabindex="-1"></a>maxx <span class="ot">&lt;-</span> <span class="fu">max</span>(efig_3d[,autumn_temp_anomaly])</span>
<span id="cb246-6"><a href="regression.html#cb246-6" aria-hidden="true" tabindex="-1"></a>new_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(minx, maxx, <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb246-7"><a href="regression.html#cb246-7" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">autumn_temp_anomaly =</span> new_x)</span>
<span id="cb246-8"><a href="regression.html#cb246-8" aria-hidden="true" tabindex="-1"></a>new_data[, yhat <span class="sc">:</span><span class="er">=</span> <span class="fu">predict</span>(m1, <span class="at">newdata =</span> new_data)]</span>
<span id="cb246-9"><a href="regression.html#cb246-9" aria-hidden="true" tabindex="-1"></a>new_data[, conf_lwr <span class="sc">:</span><span class="er">=</span> <span class="fu">predict</span>(m1, </span>
<span id="cb246-10"><a href="regression.html#cb246-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb246-11"><a href="regression.html#cb246-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>,</span>
<span id="cb246-12"><a href="regression.html#cb246-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">newdata =</span> new_data)<span class="sc">$</span>fit[, <span class="st">&quot;lwr&quot;</span>]]</span>
<span id="cb246-13"><a href="regression.html#cb246-13" aria-hidden="true" tabindex="-1"></a>new_data[, conf_upr <span class="sc">:</span><span class="er">=</span> <span class="fu">predict</span>(m1, </span>
<span id="cb246-14"><a href="regression.html#cb246-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb246-15"><a href="regression.html#cb246-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>,</span>
<span id="cb246-16"><a href="regression.html#cb246-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">newdata =</span> new_data)<span class="sc">$</span>fit[, <span class="st">&quot;upr&quot;</span>]]</span>
<span id="cb246-17"><a href="regression.html#cb246-17" aria-hidden="true" tabindex="-1"></a>new_data[, pred_lwr <span class="sc">:</span><span class="er">=</span> <span class="fu">predict</span>(m1, </span>
<span id="cb246-18"><a href="regression.html#cb246-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb246-19"><a href="regression.html#cb246-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>,</span>
<span id="cb246-20"><a href="regression.html#cb246-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">newdata =</span> new_data)<span class="sc">$</span>fit[, <span class="st">&quot;lwr&quot;</span>]]</span>
<span id="cb246-21"><a href="regression.html#cb246-21" aria-hidden="true" tabindex="-1"></a>new_data[, pred_upr <span class="sc">:</span><span class="er">=</span> <span class="fu">predict</span>(m1, </span>
<span id="cb246-22"><a href="regression.html#cb246-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb246-23"><a href="regression.html#cb246-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>,</span>
<span id="cb246-24"><a href="regression.html#cb246-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">newdata =</span> new_data)<span class="sc">$</span>fit[, <span class="st">&quot;upr&quot;</span>]]</span>
<span id="cb246-25"><a href="regression.html#cb246-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-26"><a href="regression.html#cb246-26" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(<span class="at">data =</span> efig_3d,</span>
<span id="cb246-27"><a href="regression.html#cb246-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;autumn_temp_anomaly&quot;</span>,</span>
<span id="cb246-28"><a href="regression.html#cb246-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;green_down_anomaly&quot;</span>,</span>
<span id="cb246-29"><a href="regression.html#cb246-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb246-30"><a href="regression.html#cb246-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb246-31"><a href="regression.html#cb246-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb246-32"><a href="regression.html#cb246-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>,</span>
<span id="cb246-33"><a href="regression.html#cb246-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb246-34"><a href="regression.html#cb246-34" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> <span class="st">&quot;lightgray&quot;</span>),</span>
<span id="cb246-35"><a href="regression.html#cb246-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;Temperature Anomaly (°C)&quot;</span>,</span>
<span id="cb246-36"><a href="regression.html#cb246-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;Day of Green-down Anomaly (DOY)&quot;</span>) <span class="sc">+</span></span>
<span id="cb246-37"><a href="regression.html#cb246-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-38"><a href="regression.html#cb246-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> new_data,</span>
<span id="cb246-39"><a href="regression.html#cb246-39" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> pred_lwr,</span>
<span id="cb246-40"><a href="regression.html#cb246-40" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> pred_upr,</span>
<span id="cb246-41"><a href="regression.html#cb246-41" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> yhat,</span>
<span id="cb246-42"><a href="regression.html#cb246-42" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">&quot;band&quot;</span>),</span>
<span id="cb246-43"><a href="regression.html#cb246-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb246-44"><a href="regression.html#cb246-44" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb246-45"><a href="regression.html#cb246-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb246-46"><a href="regression.html#cb246-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> new_data,</span>
<span id="cb246-47"><a href="regression.html#cb246-47" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> conf_lwr,</span>
<span id="cb246-48"><a href="regression.html#cb246-48" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> conf_upr,</span>
<span id="cb246-49"><a href="regression.html#cb246-49" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> yhat,</span>
<span id="cb246-50"><a href="regression.html#cb246-50" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">&quot;band&quot;</span>), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb246-51"><a href="regression.html#cb246-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb246-52"><a href="regression.html#cb246-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..rr.label.., ..p.label.., <span class="at">sep =</span> <span class="st">&quot;~`,`~&quot;</span>)),</span>
<span id="cb246-53"><a href="regression.html#cb246-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb246-54"><a href="regression.html#cb246-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">label.y =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb246-55"><a href="regression.html#cb246-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb246-56"><a href="regression.html#cb246-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal_okabe_ito) <span class="sc">+</span></span>
<span id="cb246-57"><a href="regression.html#cb246-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-58"><a href="regression.html#cb246-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb246-59"><a href="regression.html#cb246-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-60"><a href="regression.html#cb246-60" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span>  </span>
<span id="cb246-61"><a href="regression.html#cb246-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-62"><a href="regression.html#cb246-62" aria-hidden="true" tabindex="-1"></a>gg</span></code></pre></div>
</div>
<div id="import-and-plot-of-fig1f-methionine-restriction-data" class="section level3" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Import and plot of fig1f (methionine restriction) data</h3>
<p>Import</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="regression.html#cb247-1" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">&quot;Dietary methionine influences therapy in mouse cancer models and alters human metabolism&quot;</span></span>
<span id="cb247-2"><a href="regression.html#cb247-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">&quot;41586_2019_1437_MOESM2_ESM.xlsx&quot;</span></span>
<span id="cb247-3"><a href="regression.html#cb247-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb247-4"><a href="regression.html#cb247-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-5"><a href="regression.html#cb247-5" aria-hidden="true" tabindex="-1"></a>fig1f_wide <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb247-6"><a href="regression.html#cb247-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sheet =</span> <span class="st">&quot;f&quot;</span>,</span>
<span id="cb247-7"><a href="regression.html#cb247-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">range =</span> <span class="st">&quot;B7:R12&quot;</span>,</span>
<span id="cb247-8"><a href="regression.html#cb247-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col_names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb247-9"><a href="regression.html#cb247-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="co"># convert to data.table</span></span>
<span id="cb247-10"><a href="regression.html#cb247-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-11"><a href="regression.html#cb247-11" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(fig1f_wide,</span>
<span id="cb247-12"><a href="regression.html#cb247-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">old =</span> <span class="fu">colnames</span>(fig1f_wide),</span>
<span id="cb247-13"><a href="regression.html#cb247-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">c</span>(<span class="st">&quot;day&quot;</span>,</span>
<span id="cb247-14"><a href="regression.html#cb247-14" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">paste0</span>(<span class="st">&quot;Cn_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>),</span>
<span id="cb247-15"><a href="regression.html#cb247-15" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">paste0</span>(<span class="st">&quot;MR_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)))</span>
<span id="cb247-16"><a href="regression.html#cb247-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-17"><a href="regression.html#cb247-17" aria-hidden="true" tabindex="-1"></a>fig1f_wide <span class="ot">&lt;-</span> <span class="fu">transpose</span>(fig1f_wide, <span class="at">make.names =</span> <span class="dv">1</span>, <span class="at">keep.names =</span> <span class="st">&quot;id&quot;</span>)</span>
<span id="cb247-18"><a href="regression.html#cb247-18" aria-hidden="true" tabindex="-1"></a>fig1f_wide[, treatment <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(<span class="fu">substr</span>(id, <span class="dv">1</span>, <span class="dv">2</span>))]</span>
<span id="cb247-19"><a href="regression.html#cb247-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-20"><a href="regression.html#cb247-20" aria-hidden="true" tabindex="-1"></a>days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">25</span>, <span class="dv">28</span>, <span class="dv">30</span>, <span class="dv">34</span>, <span class="dv">39</span>)</span>
<span id="cb247-21"><a href="regression.html#cb247-21" aria-hidden="true" tabindex="-1"></a>fig1f <span class="ot">&lt;-</span> <span class="fu">melt</span>(fig1f_wide,</span>
<span id="cb247-22"><a href="regression.html#cb247-22" aria-hidden="true" tabindex="-1"></a>              id.vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;id&quot;</span>),</span>
<span id="cb247-23"><a href="regression.html#cb247-23" aria-hidden="true" tabindex="-1"></a>              measure.vars <span class="ot">&lt;-</span> <span class="fu">as.character</span>(days),</span>
<span id="cb247-24"><a href="regression.html#cb247-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">variable.name =</span> <span class="st">&quot;day&quot;</span>,</span>
<span id="cb247-25"><a href="regression.html#cb247-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">value.name =</span> <span class="st">&quot;volume&quot;</span>)</span>
<span id="cb247-26"><a href="regression.html#cb247-26" aria-hidden="true" tabindex="-1"></a>fig1f[, day <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(day))]</span>
<span id="cb247-27"><a href="regression.html#cb247-27" aria-hidden="true" tabindex="-1"></a><span class="co"># View(fig1f)</span></span>
<span id="cb247-28"><a href="regression.html#cb247-28" aria-hidden="true" tabindex="-1"></a><span class="co"># qplot(x = day, y = volume, color = treatment, data = fig1f) + geom_line(aes(group = id))</span></span></code></pre></div>
<p>Creating the response plot (the bottom component)</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="regression.html#cb248-1" aria-hidden="true" tabindex="-1"></a>fig1f_gg_response <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fig1f,</span>
<span id="cb248-2"><a href="regression.html#cb248-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> volume, <span class="at">color =</span> treatment)) <span class="sc">+</span></span>
<span id="cb248-3"><a href="regression.html#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb248-4"><a href="regression.html#cb248-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> id), <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb248-5"><a href="regression.html#cb248-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Day&quot;</span>) <span class="sc">+</span></span>
<span id="cb248-6"><a href="regression.html#cb248-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(Tumor<span class="sc">~</span>Volume<span class="sc">~</span>(mm<span class="sc">^</span><span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb248-7"><a href="regression.html#cb248-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> pal_okabe_ito) <span class="sc">+</span></span>
<span id="cb248-8"><a href="regression.html#cb248-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb248-9"><a href="regression.html#cb248-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb248-10"><a href="regression.html#cb248-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">98</span>),</span>
<span id="cb248-11"><a href="regression.html#cb248-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>),</span>
<span id="cb248-12"><a href="regression.html#cb248-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.just =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb248-13"><a href="regression.html#cb248-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>),</span>
<span id="cb248-14"><a href="regression.html#cb248-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb248-15"><a href="regression.html#cb248-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb248-16"><a href="regression.html#cb248-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-17"><a href="regression.html#cb248-17" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb248-18"><a href="regression.html#cb248-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-19"><a href="regression.html#cb248-19" aria-hidden="true" tabindex="-1"></a><span class="co"># fig1f_gg_response</span></span></code></pre></div>
<p>Creating the effects plot (the top component)</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="regression.html#cb249-1" aria-hidden="true" tabindex="-1"></a>m1_coeff_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">term =</span> <span class="fu">row.names</span>(m1_coef_table),</span>
<span id="cb249-2"><a href="regression.html#cb249-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">data.table</span>(m1_coef_table))[<span class="dv">2</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb249-3"><a href="regression.html#cb249-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb249-4"><a href="regression.html#cb249-4" aria-hidden="true" tabindex="-1"></a>m1_coeff_dt[ , p_pretty <span class="sc">:</span><span class="er">=</span> <span class="fu">pvalString</span>(pr_t)]</span>
<span id="cb249-5"><a href="regression.html#cb249-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-6"><a href="regression.html#cb249-6" aria-hidden="true" tabindex="-1"></a>min_bound <span class="ot">&lt;-</span> <span class="fu">min</span>(m1_coeff_dt[, x2_5_percent])</span>
<span id="cb249-7"><a href="regression.html#cb249-7" aria-hidden="true" tabindex="-1"></a>max_bound <span class="ot">&lt;-</span> <span class="fu">min</span>(m1_coeff_dt[, x97_5_percent])</span>
<span id="cb249-8"><a href="regression.html#cb249-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-9"><a href="regression.html#cb249-9" aria-hidden="true" tabindex="-1"></a>y_lo <span class="ot">&lt;-</span> <span class="fu">min</span>(min_bound<span class="sc">+</span>min_bound<span class="sc">*</span><span class="fl">0.2</span>,</span>
<span id="cb249-10"><a href="regression.html#cb249-10" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span>max_bound)</span>
<span id="cb249-11"><a href="regression.html#cb249-11" aria-hidden="true" tabindex="-1"></a>y_hi <span class="ot">&lt;-</span> <span class="fu">max</span>(max_bound <span class="sc">+</span> max_bound<span class="sc">*</span><span class="fl">0.2</span>,</span>
<span id="cb249-12"><a href="regression.html#cb249-12" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span>min_bound)</span>
<span id="cb249-13"><a href="regression.html#cb249-13" aria-hidden="true" tabindex="-1"></a>y_lims <span class="ot">&lt;-</span> <span class="fu">c</span>(y_lo, y_hi)</span>
<span id="cb249-14"><a href="regression.html#cb249-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-15"><a href="regression.html#cb249-15" aria-hidden="true" tabindex="-1"></a>fig1f_gg_effect <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>m1_coeff_dt, </span>
<span id="cb249-16"><a href="regression.html#cb249-16" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> term,</span>
<span id="cb249-17"><a href="regression.html#cb249-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb249-18"><a href="regression.html#cb249-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># confidence level of effect</span></span>
<span id="cb249-19"><a href="regression.html#cb249-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>x2_5_percent, </span>
<span id="cb249-20"><a href="regression.html#cb249-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax=</span>x97_5_percent),</span>
<span id="cb249-21"><a href="regression.html#cb249-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">width=</span><span class="dv">0</span>, </span>
<span id="cb249-22"><a href="regression.html#cb249-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb249-23"><a href="regression.html#cb249-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># estimate of effect</span></span>
<span id="cb249-24"><a href="regression.html#cb249-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb249-25"><a href="regression.html#cb249-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb249-26"><a href="regression.html#cb249-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># zero effect</span></span>
<span id="cb249-27"><a href="regression.html#cb249-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb249-28"><a href="regression.html#cb249-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb249-29"><a href="regression.html#cb249-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p-value</span></span>
<span id="cb249-30"><a href="regression.html#cb249-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb249-31"><a href="regression.html#cb249-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> m1_coeff_dt<span class="sc">$</span>p_pretty,</span>
<span id="cb249-32"><a href="regression.html#cb249-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>,</span>
<span id="cb249-33"><a href="regression.html#cb249-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fl">7.5</span>) <span class="sc">+</span></span>
<span id="cb249-34"><a href="regression.html#cb249-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb249-35"><a href="regression.html#cb249-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># aesthetics</span></span>
<span id="cb249-36"><a href="regression.html#cb249-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position=</span><span class="st">&quot;right&quot;</span>) <span class="sc">+</span></span>
<span id="cb249-37"><a href="regression.html#cb249-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="st">&quot;MR</span><span class="sc">\n</span><span class="st">effect&quot;</span>) <span class="sc">+</span></span>
<span id="cb249-38"><a href="regression.html#cb249-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(Growth<span class="sc">~</span>(mm<span class="sc">^</span><span class="dv">3</span><span class="sc">/</span>day))) <span class="sc">+</span></span>
<span id="cb249-39"><a href="regression.html#cb249-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">ylim =</span> y_lims) <span class="sc">+</span> </span>
<span id="cb249-40"><a href="regression.html#cb249-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb249-41"><a href="regression.html#cb249-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb249-42"><a href="regression.html#cb249-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb249-43"><a href="regression.html#cb249-43" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb249-44"><a href="regression.html#cb249-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-45"><a href="regression.html#cb249-45" aria-hidden="true" tabindex="-1"></a><span class="co">#fig1f_gg_effect</span></span></code></pre></div>
<p>Combining the response and effects plots into single plot</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="regression.html#cb250-1" aria-hidden="true" tabindex="-1"></a>fig1f_gg <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(fig1f_gg_effect,</span>
<span id="cb250-2"><a href="regression.html#cb250-2" aria-hidden="true" tabindex="-1"></a>                      fig1f_gg_response,</span>
<span id="cb250-3"><a href="regression.html#cb250-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">nrow=</span><span class="dv">2</span>,</span>
<span id="cb250-4"><a href="regression.html#cb250-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb250-5"><a href="regression.html#cb250-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">axis =</span> <span class="st">&quot;lr&quot;</span>,</span>
<span id="cb250-6"><a href="regression.html#cb250-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="dv">1</span>))</span>
<span id="cb250-7"><a href="regression.html#cb250-7" aria-hidden="true" tabindex="-1"></a>fig1f_gg</span></code></pre></div>
</div>
</div>
<div id="try-it" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Try it</h2>
<div id="a-prediction-model-from-the-literature" class="section level3" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> A prediction model from the literature</h3>
<p>The data come from the top, middle plot of Figure 1e of</p>
<p><a href="https://idp.nature.com/authorize/casa?redirect_uri=https://www.nature.com/articles/s41586-019-0984-y&amp;casa_token=9rpBLACc40cAAAAA:BzRKQHYdU9DOrzBS0f0lwrbp07MlfVqqL4yuyedE5b_xZ8geHuUCPFIDE3yQUBO-ibQLCrCI4t84aO8" target="_blank">Parker, B.L., Calkin, A.C., Seldin, M.M., Keating, M.F., Tarling, E.J., Yang, P., Moody, S.C., Liu, Y., Zerenturk, E.J., Needham, E.J. and Miller, M.L., 2019. An integrative systems genetic analysis of mammalian lipid metabolism. Nature, 567(7747), pp.187-193.</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6656374/" target="_blank">Public source</a></p>
<p><a href="https://www.nature.com/articles/s41586-019-0984-y#Sec35" target="_blank">Source data</a></p>
<p>The researchers built prediction models from a hybrid mouse diversity panel (HMDP) to predict liver lipid levels from measured plasma lipid levels in mice <em>and</em> in humans. The value of the predictor (<span class="math inline">\(X\)</span>) variable for an individual is not a measured value of a single plasma lipid but the predicted value, or <strong>score</strong>, from the prediction model based on an entire panel of lipid measurements in that individual. The <span class="math inline">\(Y\)</span> variable for the individual is the total measured level across a family of lipids (ceramides, triacylglycerols, diacylglycerols) in the liver of the individual. The question is, how well does the prediction score predict the actual liver level?</p>
<ol style="list-style-type: decimal">
<li>Use the data for TG (triacylglycerols) (the top, middle plot of Figure 1e). The column D is the “score” from the prediction model using plasma lipid levels. This is the <span class="math inline">\(X\)</span> variable (the column header is “fitted.total.Cer”). The column E is the total measured liver TG, so is the <span class="math inline">\(Y\)</span> variable.</li>
<li>Fit the linear model y ~ x.</li>
<li>Create a publication-quality plot of liver TG (<em>Y</em>-axis) against score (<em>X</em>-axis) – what the researchers labeled “fitted.total.Cer”. Include <span class="math inline">\(R^2\)</span> on the plot.</li>
<li>Advanced – add a 95% prediction interval to the plot (the template code for this is in the Hidden Code section for efig3d)</li>
<li>Create a table of expected liver TG and 95% prediction interval of liver TG of the score values (13.5, 14, 14.5, 15, 15.5, 16).</li>
<li>Comment on the predictability of liver TG using the plasma scores.</li>
</ol>
<p>`</p>
</div>
</div>
<div id="intuition-pumps" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Intuition pumps</h2>
<div id="correlation-and-r2" class="section level3" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> Correlation and $R^2</h3>
<p>In the code below</p>
<ol style="list-style-type: decimal">
<li>change the value of <code>n</code> to explore effect on the variability of the estimate. Look at this variability, and the magnitude of the SE, and the magnitude of the p-value.</li>
<li>change the value of <code>beta_1</code> to explore effect on what different slopes and correlations look like. Notice that if the variance is fixed (as in this simulation) the expected slope and expected correlation are equal. (Because I’ve fixed the variance in this simple simulation, this code will fail if abs(beta_1) &gt;= 1).</li>
</ol>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="regression.html#cb251-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># choose between 3 and 10^5</span></span>
<span id="cb251-2"><a href="regression.html#cb251-2" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fl">0.6</span> <span class="co"># choose a value between -0.99 and 0.99</span></span>
<span id="cb251-3"><a href="regression.html#cb251-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb251-4"><a href="regression.html#cb251-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> beta_1<span class="sc">*</span>x <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>beta_1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">rnorm</span>(n)</span>
<span id="cb251-5"><a href="regression.html#cb251-5" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb251-6"><a href="regression.html#cb251-6" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;b_1: &quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(m1)[<span class="dv">2</span>], <span class="dv">3</span>))</span>
<span id="cb251-7"><a href="regression.html#cb251-7" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;SE: &quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(m1))[<span class="dv">2</span>,<span class="dv">2</span>], <span class="dv">3</span>))</span>
<span id="cb251-8"><a href="regression.html#cb251-8" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;r: &quot;</span>, <span class="fu">round</span>(<span class="fu">cor</span>(x,y), <span class="dv">3</span>))</span>
<span id="cb251-9"><a href="regression.html#cb251-9" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;R^2: &quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared, <span class="dv">3</span>))</span>
<span id="cb251-10"><a href="regression.html#cb251-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(<span class="at">data =</span> <span class="fu">data.table</span>(<span class="at">x=</span>x, <span class="at">y=</span>y), <span class="at">x =</span> <span class="st">&quot;x&quot;</span>, <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb251-11"><a href="regression.html#cb251-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">&quot;reg.line&quot;</span>) <span class="sc">+</span></span>
<span id="cb251-12"><a href="regression.html#cb251-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="fu">paste</span>(slope,se,r,r2,<span class="at">sep=</span><span class="st">&quot;;  &quot;</span>))</span></code></pre></div>
<p><img src="Walker-elementary-statistical-modeling-draft_files/figure-html/unnamed-chunk-117-1.png" width="576" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro-linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="oneway.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/chapters/22-continuous_X.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Walker-elementary-statistical-modeling-draft.pdf", "Walker-elementary-statistical-modeling-draft.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
