# Continuous $X$ ("Regression"" models) {#intro}

```{r prep, echo=FALSE}
file_path <- "data/"
library(ggplot2)
library(data.table)
```

## Modeling
### Mother's cortisol effects on pup's growth rate
@Dantzer_xxx showed that North American red squirrel (*Tamiasciurus hudsonicus*) mothers from Yukon, Alaska produce faster growing pups in years with increased squirrel density. Remarkably, they even showed that perceived (but not actual) density results in faster growing pups. To begin to investigate how mothers control future growth rate of pups, they measured the relationship between local squirrel density and the amount of fecal cortisol metabolites from pregnant mothers. Cortisol is a hormone that is secreted as part of stress response. Amazingly, in mammals, blood cortisol levels in pregnant mothers have numerous effects on offspring long past birth.

```{r squirrel, echo=FALSE, warning=FALSE, fig.cap="A scatterplot of Fecal cortisol matabolites and squirrel density."}
# Dantzer, B., Newman, A.E., Boonstra, R., Palme, R., Boutin, S., Humphries, M.M. and McAdam, A.G., 2013. Density triggers maternal hormones that increase adaptive offspring growth in a wild mammal. Science, p.1235765.
# https://datadryad.org/resource/doi:10.5061/dryad.b3h4q
# data for Fig 3A/Table S4
fn <- paste(file_path,'Dantzer/FCM.csv',sep='')
feces <- data.table(read.table(fn, sep=',', header=TRUE))
gg <- ggplot(data=feces, aes(x=Density, y=FCM)) +
  geom_point() +
  geom_smooth(method='lm') +
  xlab("Squirrel Density (squirrels per hectare)") +
  ylab("Fecal Cortisol Metabolites (ng per g dry mass)") +
  theme_minimal()
gg

```

Figure \@ref(fig:squirrel) is a **scatterplot** of the data with Fecal Cortisol Metabolite amount on the $Y$ axis and Squirrel Density on the $X$ axis. The line through the data is a graphical representation of a model fit to the data. This model is

\begin{equation}
\textrm{E}[FCM|Density] = \beta_0 + \beta_1 Density
(\#eq:regression)
\end{equation}

In words, model \@ref(eq:regression) reads "the expected value of $FCM$ conditional on density is beta-knot plus beta-one times density". An **expected value** is a long run average -- if we were to sample lots and lots of red squirrel populations with $Density=x$ (where $x$ is a specific value), we'd expect the average $FCM$ across these samples to be $\beta_0 + \beta_1 x$. Because we expect the value of $FCM$ to be $\beta_0 + \beta_1 x$ when $Density = x$, then the expected value is sometimes called the **predicted value**. Predicted values are usually denoted with a carot or "hat" symbol, $\widehat{FCM}$, which is read as "FCM-hat".

In model \@ref(eq:regression), $FCM$ is the **dependent variable**, which is often called the **response** or **outcome** variable. $Density$ is the independent variable, which is sometimes called the **predictor** or **explanatory** variable. More generally, think of the dependent variable as the $Y$ and the independent variable as the $X$ variable. In this model, the dependent variable $FCM$ does not "depend" on the independent variable $Density$ in any causal sense -- meaning if I were to intervene and set $Density$ to some value $x$, I would expect $FCM$ to equal $\beta_0 + \beta_1 x$. Rather, $FCM$ only "depends" on $Density$ in a probablistic sense -- if $Density = x$ then the most probable value of $FCM$ is $\beta_0 + \beta_1 x$. With some strong assumptions model \@ref(eq:regression) can be turned into a model of causal dependency, which is the focus of chapter xxx.

$\beta_0$ and $\beta_1$ are the coefficients of model \@ref(eq:regression). Specifically $\beta_0$ is the model **intercept** and $\beta_1$ is the modeled **effect** of $Density$. Graphically, these are the $Y$-intercept and **slope** of the line in Figure \@ref(fig:squirrel). Again, the effect ($\beta_1$) has a probabilistic, and not causal, interpretation. This interpretation is

\begin{equation}
\beta_1 = \textrm{E}[FCM|Density=x+1] - \textrm{E}[FCM|Density=x] 
(\#eq:b1)
\end{equation}

Or, in words, "beta-1 is the expected value of FCM when density equals x + 1 minus the expected value of FCM when the density equals x." Or, the effect is a difference in expected values given a one unit difference in $Density$. Take a moment and read this again and come back to it frequently. It is a very important concept to understand. With the strong assumptions explained in chapter xxx, $\beta_1$ can estimate a causal effect.

The goal of the statistical analysis is to estimate $\beta_1$ -- the probabalistic effect of $Density$ on $FCM$.

```{r squirrel_lm, echo=FALSE}

# table S4
fit <- lm(FCM ~ Density, data=feces)
coefficients(summary(fit))
```


### Kirk experimental data
### many regressions
loops
multiple-testing


## Why Regression

### Description

### Prediction

### Causal explanation

### Model testing
scaling static stress

